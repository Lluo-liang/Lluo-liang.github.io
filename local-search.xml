<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>JVMå…¥é—¨_åŸºç¡€æ¦‚å¿µ</title>
    <link href="/2023/11/15/JVM%E5%85%A5%E9%97%A8_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/"/>
    <url>/2023/11/15/JVM%E5%85%A5%E9%97%A8_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/</url>
    
    <content type="html"><![CDATA[<p>JVM å…¥é—¨</p>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>jvm</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Java é›†åˆ_è¿›é˜¶å†…å®¹</title>
    <link href="/2023/11/15/Java%E9%9B%86%E5%90%88_%E8%BF%9B%E9%98%B6%E5%86%85%E5%AE%B9/"/>
    <url>/2023/11/15/Java%E9%9B%86%E5%90%88_%E8%BF%9B%E9%98%B6%E5%86%85%E5%AE%B9/</url>
    
    <content type="html"><![CDATA[<h4 id="1ã€ä»€ä¹ˆæ˜¯-fail-fastæœºåˆ¶ï¼Œè®²è¿°ä¸€ä¸‹ä»–å’Œ-fail-safe-çš„å¼‚åŒã€‚"><a href="#1ã€ä»€ä¹ˆæ˜¯-fail-fastæœºåˆ¶ï¼Œè®²è¿°ä¸€ä¸‹ä»–å’Œ-fail-safe-çš„å¼‚åŒã€‚" class="headerlink" title="1ã€ä»€ä¹ˆæ˜¯ fail-fastæœºåˆ¶ï¼Œè®²è¿°ä¸€ä¸‹ä»–å’Œ fail-safe çš„å¼‚åŒã€‚"></a>1ã€ä»€ä¹ˆæ˜¯ fail-fastæœºåˆ¶ï¼Œè®²è¿°ä¸€ä¸‹ä»–å’Œ fail-safe çš„å¼‚åŒã€‚</h4><p>é”™è¯¯æ£€æŸ¥æœºåˆ¶</p><ul><li>å¿«é€Ÿå¤±è´¥ fail-fast<ul><li>å½“æ–¹æ³•æ£€æµ‹åˆ°å¯¹è±¡çš„å¹¶å‘ä¿®æ”¹ï¼Œä½†ä¸å…è®¸è¿™ç§ä¿®æ”¹æ—¶å°±æŠ›å‡ºè¯¥å¼‚å¸¸</li></ul></li><li>fail-safe æœºåˆ¶<ul><li>fail-safe ä»»ä½•å¯¹é›†åˆç»“æ„çš„ä¿®æ”¹éƒ½ä¼šåœ¨ä¸€ä¸ªå¤åˆ¶çš„é›†åˆä¸Šè¿›è¡Œï¼Œå› æ­¤ä¸ä¼šæŠ›å‡ºConcurrentModificationException</li></ul></li></ul><p><strong>fail-fast è§£å†³æ–¹æ³•</strong></p><ul><li>æ–¹æ¡ˆä¸€ï¼šåœ¨éå†è¿‡ç¨‹ä¸­æ‰€æœ‰æ¶‰åŠåˆ°æ”¹å˜modCount å€¼çš„åœ°æ–¹å…¨éƒ¨åŠ ä¸Šsynchronized æˆ–è€…ç›´æ¥ä½¿ç”¨ Collection  synchronizedListï¼Œè¿™æ ·å°±å¯ä»¥è§£å†³é—®é¢˜ï¼Œä½†æ˜¯ä¸æ¨èï¼Œå› ä¸ºå¢åˆ é€ æˆçš„åŒæ­¥é”å¯èƒ½ä¼šé˜»å¡éå†æ“ä½œã€‚</li><li>æ–¹æ¡ˆäºŒï¼šä½¿ç”¨CopyOnWriteArrayList æ›¿æ¢ ArrayLIstï¼Œæ¨èä½¿ç”¨è¯¥æ–¹æ¡ˆï¼ˆå³fail-safeï¼‰ã€‚</li></ul><p><strong>fail-fastå’Œ fail-safe çš„åŒºåˆ«</strong></p><table><thead><tr><th></th><th>Fail Fast Iterator</th><th>Fail Safe Iterator</th></tr></thead><tbody><tr><td>Throw ConcurrentModification Exception</td><td>Yes</td><td>No</td></tr><tr><td>Clone object</td><td>No</td><td>Yes</td></tr><tr><td>Memory Overhead</td><td>No</td><td>Yes</td></tr><tr><td>Examples</td><td>HashMap,Vector,ArrayList,HashSet</td><td>CopyOnWriteArrayList,  <br>ConcurrentHashMap</td></tr><tr><td></td><td></td><td></td></tr></tbody></table><h4 id="2ã€é€šè¿‡å®ç°-Comparable-æˆ–è€…-Comparator-æ¥å£æ¥è¿›è¡Œæ’åº"><a href="#2ã€é€šè¿‡å®ç°-Comparable-æˆ–è€…-Comparator-æ¥å£æ¥è¿›è¡Œæ’åº" class="headerlink" title="2ã€é€šè¿‡å®ç° Comparable æˆ–è€… Comparator æ¥å£æ¥è¿›è¡Œæ’åº"></a>2ã€é€šè¿‡å®ç° Comparable æˆ–è€… Comparator æ¥å£æ¥è¿›è¡Œæ’åº</h4><p><strong>ä¸€ç§æƒ…å†µæ˜¯é›†åˆç±»æœ¬èº«è‡ªå¸¦æ’åºåŠŸèƒ½</strong>ï¼Œå¦‚å‰é¢è¯´è¿‡çš„TreeSetã€SortedSetã€SortedMapç­‰ï¼Œ</p><p>å¦ä¸€ç§å°±æ˜¯æœ¬èº«ä¸å¸¦æ’åºåŠŸèƒ½ï¼Œæˆ‘ä»¬é€šè¿‡ä¸ºéœ€è¦æ’åºçš„ç±»å®ç° Comparable æˆ–è€… Comparator æ¥å£æ¥å®ç°ã€‚</p><p>å…ˆæ¥çœ‹ä¸¤ä¸ªä¾‹å­ï¼Œä¸€ä¸ªæ˜¯å®ç°Comparableçš„ï¼Œä¸€ä¸ªæ˜¯å®ç° Comparator çš„</p><p>ï¼ˆ1ï¼‰å®ç°Comparableçš„ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xtfggef.list.test;<br> <br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.Arrays;<br><span class="hljs-keyword">import</span> java.util.Collections;<br><span class="hljs-keyword">import</span> java.util.List;<br> <br><span class="hljs-meta">@SuppressWarnings(&quot;unchecked&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ComparableTest</span> &#123;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;  <br>    List&lt;User&gt; users = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>();  <br>    users.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">&quot;egg&quot;</span>, <span class="hljs-number">23</span>));  <br>    users.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">&quot;niu&quot;</span>, <span class="hljs-number">22</span>));  <br>    users.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">&quot;qing&quot;</span>, <span class="hljs-number">28</span>));  <br>  <br>    Collections.sort(users);  <br>    <span class="hljs-keyword">for</span> (User user : users) &#123;  <br>        System.out.println(user.getName() + <span class="hljs-string">&quot; &quot;</span> + user.getAge());  <br>    &#125;  <br>&#125;<br>&#125;<br> <br><span class="hljs-meta">@SuppressWarnings(&quot;unchecked&quot;)</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Comparable</span> &#123;<br><span class="hljs-keyword">private</span> String name;<br><span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;<br> <br><span class="hljs-keyword">public</span> <span class="hljs-title function_">User</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> age)</span> &#123;<br><span class="hljs-built_in">super</span>();<br><span class="hljs-built_in">this</span>.name = name;<br><span class="hljs-built_in">this</span>.age = age;<br>&#125;<br> <br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">return</span> name;<br>&#125;<br> <br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> &#123;<br><span class="hljs-built_in">this</span>.name = name;<br>&#125;<br> <br><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAge</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">return</span> age;<br>&#125;<br> <br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAge</span><span class="hljs-params">(<span class="hljs-type">int</span> age)</span> &#123;<br><span class="hljs-built_in">this</span>.age = age;<br>&#125;<br> <br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compareTo</span><span class="hljs-params">(Object o)</span> &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.age - ((User) o).getAge();<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰ä¸‹é¢æ˜¯å®ç°Comparatoræ¥å£çš„ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xtfggef.comparator.test;<br> <br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.Collections;<br><span class="hljs-keyword">import</span> java.util.Comparator;<br><span class="hljs-keyword">import</span> java.util.List;<br> <br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ComparatorTest</span> &#123;  <br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;  <br>        List&lt;User&gt; users = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>();  <br>        users.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">&quot;egg&quot;</span>, <span class="hljs-number">21</span>));  <br>        users.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">&quot;niu&quot;</span>, <span class="hljs-number">22</span>));  <br>        users.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">&quot;gg&quot;</span>, <span class="hljs-number">29</span>));  <br>        <span class="hljs-type">UserComparator</span> <span class="hljs-variable">comparator</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserComparator</span>();  <br>        Collections.sort(users, comparator);  <br>        <span class="hljs-keyword">for</span> (User user : users) &#123;  <br>            System.out.println(user.getUsername() + <span class="hljs-string">&quot; &quot;</span> + user.getAge());  <br>        &#125;  <br>    &#125;  <br>  <br>&#125;  <br><span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> &#123;  <br>    <span class="hljs-keyword">private</span> String username;  <br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;  <br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">User</span><span class="hljs-params">(String username, <span class="hljs-type">int</span> age)</span> &#123;  <br>        <span class="hljs-built_in">super</span>();  <br>        <span class="hljs-built_in">this</span>.username = username;  <br>        <span class="hljs-built_in">this</span>.age = age;  <br>    &#125;  <br>  <br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getUsername</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> username;  <br>    &#125;  <br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setUsername</span><span class="hljs-params">(String username)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.username = username;  <br>    &#125;  <br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAge</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> age;  <br>    &#125;  <br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAge</span><span class="hljs-params">(<span class="hljs-type">int</span> age)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.age = age;  <br>    &#125;  <br>&#125;  <br>  <br>  <br><span class="hljs-keyword">class</span> <span class="hljs-title class_">UserComparator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Comparator</span>&lt;User&gt; &#123;  <br>    <span class="hljs-meta">@Override</span>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compare</span><span class="hljs-params">(User user1, User user2)</span> &#123;  <br>        <span class="hljs-type">int</span> <span class="hljs-variable">age1</span> <span class="hljs-operator">=</span> user1.getAge();  <br>        <span class="hljs-type">int</span> <span class="hljs-variable">age2</span> <span class="hljs-operator">=</span> user2.getAge();  <br>        <span class="hljs-keyword">if</span> (age1 &lt; age2) &#123;  <br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;  <br>        &#125;  <br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p>ğŸ‘† ä¸Šé¢è¿™ç§ Comparator å®ç°è¿™ä¸ªæ¥å£çš„æ—¶å€™ï¼Œ ğŸ‘‰ Comparatoræ˜¯ä¸€ä¸ªæ³›å‹æ¥å£ï¼Œæ‰€ä»¥åœ¨å®ç°Comparatoræ¥å£æ—¶ï¼Œç±»çš„æ³›å‹ç±»å‹éœ€è¦æŒ‡å®šå…·ä½“ç±»å‹ï¼Œä»¥é¿å…ç±»å‹æ“¦é™¤å¸¦æ¥çš„é—®é¢˜ã€‚</p><hr><p>é€šè¿‡ä¸Šé¢çš„è¿™ä¸¤ä¸ªå°ä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼ŒComparatorå’ŒComparableç”¨äºä¸åŒçš„åœºæ™¯ï¼Œå®ç°å¯¹å¯¹è±¡çš„æ¯”è¾ƒä»è€Œè¿›è¡Œæ’åºã€‚</p><p>æ€»ç»“ä¸ºï¼š</p><p><strong>ç›¸åŒç‚¹ï¼š</strong> äºŒè€…éƒ½å¯ä»¥å®ç°å¯¹è±¡çš„æ’åºï¼Œä¸è®ºç”¨ Arraysçš„æ–¹æ³•è¿˜æ˜¯ç”¨ Collectionsçš„sort()æ–¹æ³•ã€‚</p><p><strong>ä¸åŒç‚¹ï¼š</strong></p><p>ï¼ˆ1ï¼‰å®ç°Comparableæ¥å£çš„ç±»ï¼Œä¼¼ä¹æ˜¯<strong>é¢„å…ˆçŸ¥é“è¯¥ç±»å°†è¦è¿›è¡Œæ’åº</strong>ï¼Œéœ€è¦æ’åºçš„ç±»å®ç°Comparableæ¥å£ï¼Œæ˜¯ä¸€ç§â€œé™æ€ç»‘å®šæ’åºâ€ã€‚</p><p>ï¼ˆ2ï¼‰å®ç°Comparatorçš„ç±»ä¸éœ€è¦ï¼Œè®¾è®¡è€…æ— éœ€äº‹å…ˆä¸ºéœ€è¦æ’åºçš„ç±»å®ç°ä»»ä½•æ¥å£ã€‚</p><p>ï¼ˆ3ï¼‰Comparatoræ¥å£é‡Œæœ‰ä¸¤ä¸ªæŠ½è±¡æ–¹æ³•compare()å’Œequals()ï¼Œ<strong>è€ŒComparableæ¥å£é‡Œåªæœ‰ä¸€ä¸ªæ–¹æ³•</strong>ï¼šcompareTo()ã€‚</p><p>ï¼ˆ4ï¼‰Comparatoræ¥å£æ— éœ€æ”¹å˜æ’åºç±»çš„å†…éƒ¨ï¼Œä¹Ÿå°±æ˜¯è¯´å®ç°ç®—æ³•å’Œæ•°æ®åˆ†ç¦»ï¼Œæ˜¯ä¸€ä¸ªè‰¯å¥½çš„è®¾è®¡ï¼Œæ˜¯ä¸€ç§â€œåŠ¨æ€ç»‘å®šæ’åºâ€ã€‚</p><p>ï¼ˆ5ï¼‰Comparatoræ¥å£å¯ä»¥ä½¿ç”¨å¤šç§æ’åºæ ‡å‡†ï¼Œæ¯”å¦‚å‡åºã€é™åºç­‰ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaå¤šçº¿ç¨‹_åŸºç¡€æ¦‚å¿µ</title>
    <link href="/2023/11/15/Java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/"/>
    <url>/2023/11/15/Java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/</url>
    
    <content type="html"><![CDATA[<p>Javaå¤šçº¿ç¨‹</p>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>thread</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaå¹¶å‘ç¼–ç¨‹_è¿›é˜¶å†…å®¹</title>
    <link href="/2023/11/15/Java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B_%E8%BF%9B%E9%98%B6%E5%86%85%E5%AE%B9/"/>
    <url>/2023/11/15/Java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B_%E8%BF%9B%E9%98%B6%E5%86%85%E5%AE%B9/</url>
    
    <content type="html"><![CDATA[<p>Javaå¤šçº¿ç¨‹</p>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>thread</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaé›†åˆ_HashMapå­¦ä¹ </title>
    <link href="/2023/11/15/Java%E9%9B%86%E5%90%88_HashMap%E5%AD%A6%E4%B9%A0/"/>
    <url>/2023/11/15/Java%E9%9B%86%E5%90%88_HashMap%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h3 id="1ã€åŸºç¡€æ¦‚å¿µ"><a href="#1ã€åŸºç¡€æ¦‚å¿µ" class="headerlink" title="1ã€åŸºç¡€æ¦‚å¿µ"></a>1ã€åŸºç¡€æ¦‚å¿µ</h3><p>HashMap ä¸»è¦ç”¨æ¥å­˜æ”¾é”®å€¼å¯¹ï¼ŒåŸºäºå“ˆå¸Œè¡¨çš„ Map æ¥å£å®ç°ï¼Œæ˜¯å¸¸ç”¨çš„ Java é›†åˆä¹‹ä¸€ã€‚</p><p>HashMapæ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼Œæ•ˆç‡è¾ƒé«˜ã€‚</p><p>å®ƒå¯ä»¥å­˜å‚¨ null çš„ key å’Œ valueï¼Œä½† null ä½œä¸ºé”®åªèƒ½æœ‰ä¸€ä¸ªï¼Œnull ä½œä¸ºå€¼å¯ä»¥æœ‰å¤šä¸ª</p><p><strong>åº•å±‚æ•°æ®ç»“æ„</strong>ï¼š</p><ul><li>JDK1.8 ä¹‹å‰ HashMap ç”± æ•°ç»„+é“¾è¡¨ ç»„æˆçš„ï¼Œæ•°ç»„æ˜¯ HashMap çš„ä¸»ä½“ï¼Œé“¾è¡¨åˆ™æ˜¯ä¸»è¦ä¸ºäº†è§£å†³å“ˆå¸Œå†²çªè€Œå­˜åœ¨çš„ï¼ˆâ€œæ‹‰é“¾æ³•â€è§£å†³å†²çªï¼‰ã€‚</li><li>JDK1.8 ä»¥åçš„ <code>HashMap</code> åœ¨è§£å†³å“ˆå¸Œå†²çªæ—¶æœ‰äº†è¾ƒå¤§çš„å˜åŒ–ï¼Œå½“é“¾è¡¨é•¿åº¦å¤§äºç­‰äºé˜ˆå€¼ï¼ˆé»˜è®¤ä¸º 8ï¼‰ï¼ˆå°†é“¾è¡¨è½¬æ¢æˆçº¢é»‘æ ‘å‰ä¼šåˆ¤æ–­ï¼Œå¦‚æœå½“å‰æ•°ç»„çš„é•¿åº¦å°äº 64ï¼Œé‚£ä¹ˆä¼šé€‰æ‹©å…ˆè¿›è¡Œæ•°ç»„æ‰©å®¹ï¼Œè€Œä¸æ˜¯è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼‰æ—¶ï¼Œå°†é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œä»¥å‡å°‘æœç´¢æ—¶é—´ã€‚</li></ul><p><strong>æ‰©å……æœºåˆ¶</strong>ï¼š<code>HashMap</code> é»˜è®¤çš„åˆå§‹åŒ–å¤§å°ä¸º 16ã€‚ä¹‹åæ¯æ¬¡æ‰©å……ï¼Œå®¹é‡å˜ä¸ºåŸæ¥çš„ 2 å€ã€‚å¹¶ä¸”ï¼Œ <code>HashMap</code> æ€»æ˜¯ä½¿ç”¨ 2 çš„å¹‚ä½œä¸ºå“ˆå¸Œè¡¨çš„å¤§å°ã€‚</p><blockquote><p>HashMapçš„å¸¸ç”¨æ–¹æ³•</p></blockquote><p>1ã€put(K key, V value)ï¼š å°†é”®ï¼ˆkeyï¼‰&#x2F;å€¼ï¼ˆvalueï¼‰æ˜ å°„å­˜æ”¾åˆ°Mapé›†åˆä¸­ã€‚</p><p>2ã€get(Object key)ï¼š è¿”å›æŒ‡å®šé”®æ‰€æ˜ å°„çš„å€¼ï¼Œæ²¡æœ‰è¯¥keyå¯¹åº”çš„å€¼åˆ™è¿”å› nullã€‚</p><p>3ã€size()ï¼š è¿”å›Mapé›†åˆä¸­æ•°æ®æ•°é‡ã€‚</p><p>4ã€clear()ï¼š æ¸…ç©ºMapé›†åˆã€‚</p><p>5ã€isEmpty()ï¼š åˆ¤æ–­Mapé›†åˆä¸­æ˜¯å¦æœ‰æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰åˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚</p><p>6ã€remove(Object key)ï¼š åˆ é™¤Mapé›†åˆä¸­é”®ä¸ºkeyçš„æ•°æ®å¹¶è¿”å›å…¶æ‰€å¯¹åº”valueå€¼ã€‚</p><p>7ã€values()ï¼š è¿”å›Mapé›†åˆä¸­æ‰€æœ‰valueç»„æˆçš„ä»¥Collectionæ•°æ®ç±»å‹æ ¼å¼æ•°æ®ã€‚</p><p>8ã€containsKey(Object key)ï¼š åˆ¤æ–­é›†åˆä¸­æ˜¯å¦åŒ…å«æŒ‡å®šé”®ï¼ŒåŒ…å«è¿”å› trueï¼Œå¦åˆ™è¿”å›falseã€‚</p><p>9ã€containsValue(Object value)ï¼š åˆ¤æ–­é›†åˆä¸­æ˜¯å¦åŒ…å«æŒ‡å®šå€¼ï¼ŒåŒ…å«è¿”å› trueï¼Œå¦åˆ™è¿”å›falseã€‚</p><p>10ã€keySet()ï¼š è¿”å›Mapé›†åˆä¸­æ‰€æœ‰keyç»„æˆçš„Seté›†åˆã€‚</p><p>11ã€entrySet()ï¼š å°†Mapé›†åˆæ¯ä¸ªkey-valueè½¬æ¢ä¸ºä¸€ä¸ªEntryå¯¹è±¡å¹¶è¿”å›ç”±æ‰€æœ‰çš„Entryå¯¹è±¡ç»„æˆçš„Seté›†åˆã€‚</p><blockquote><p>HashMap å¸¸ç”¨æ–¹æ³•æµ‹è¯•</p></blockquote><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs sas">package map;<br><br>import java.util.Collection;<br>import java.util.HashMap;<br>import java.util.<span class="hljs-keyword">Set</span>;<br><br>public class HashMapDemo &#123;<br><br>    public static void mai<span class="hljs-meta">n</span>(String[] args) &#123;<br>        HashMap&lt;String, String&gt; map = new HashMap&lt;String, String&gt;();<br>        // é”®ä¸èƒ½é‡å¤ï¼Œå€¼å¯ä»¥é‡å¤<br>        map.<span class="hljs-meta">put</span>(<span class="hljs-string">&quot;san&quot;</span>, <span class="hljs-string">&quot;å¼ ä¸‰&quot;</span>);<br>        map.<span class="hljs-meta">put</span>(<span class="hljs-string">&quot;si&quot;</span>, <span class="hljs-string">&quot;æå››&quot;</span>);<br>        map.<span class="hljs-meta">put</span>(<span class="hljs-string">&quot;wu&quot;</span>, <span class="hljs-string">&quot;ç‹äº”&quot;</span>);<br>        map.<span class="hljs-meta">put</span>(<span class="hljs-string">&quot;wang&quot;</span>, <span class="hljs-string">&quot;è€ç‹&quot;</span>);<br>        map.<span class="hljs-meta">put</span>(<span class="hljs-string">&quot;wang&quot;</span>, <span class="hljs-string">&quot;è€ç‹2&quot;</span>);// è€ç‹è¢«è¦†ç›–<br>        map.<span class="hljs-meta">put</span>(<span class="hljs-string">&quot;lao&quot;</span>, <span class="hljs-string">&quot;è€ç‹&quot;</span>);<br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;-------ç›´æ¥è¾“å‡ºhashmap:-------&quot;</span>);<br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(map);<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * éå†HashMap</span><br><span class="hljs-comment">         */</span><br>        // 1.è·å–Mapä¸­çš„æ‰€æœ‰é”®<br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;-------foreachè·å–Mapä¸­æ‰€æœ‰çš„é”®:------&quot;</span>);<br>        <span class="hljs-keyword">Set</span>&lt;String&gt; keys = map.keySet();<br>        for (String <span class="hljs-keyword">key</span> : keys) &#123;<br>            System.<span class="hljs-keyword">out</span>.pr<span class="hljs-meta">int</span>(<span class="hljs-keyword">key</span>+<span class="hljs-string">&quot;  &quot;</span>);<br>        &#125;<br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>();//æ¢è¡Œ<br>        // 2.è·å–Mapä¸­æ‰€æœ‰å€¼<br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;-------foreachè·å–Mapä¸­æ‰€æœ‰çš„å€¼:------&quot;</span>);<br>        Collection&lt;String&gt; values = map.values();<br>        for (String value : values) &#123;<br>            System.<span class="hljs-keyword">out</span>.pr<span class="hljs-meta">int</span>(value+<span class="hljs-string">&quot;  &quot;</span>);<br>        &#125;<br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>();//æ¢è¡Œ<br>        // 3.å¾—åˆ°<span class="hljs-keyword">key</span>çš„å€¼çš„åŒæ—¶å¾—åˆ°<span class="hljs-keyword">key</span>æ‰€å¯¹åº”çš„å€¼<br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;-------å¾—åˆ°keyçš„å€¼çš„åŒæ—¶å¾—åˆ°keyæ‰€å¯¹åº”çš„å€¼:-------&quot;</span>);<br>        <span class="hljs-keyword">Set</span>&lt;String&gt; keys2 = map.keySet();<br>        for (String <span class="hljs-keyword">key</span> : keys2) &#123;<br>            System.<span class="hljs-keyword">out</span>.pr<span class="hljs-meta">int</span>(<span class="hljs-keyword">key</span> + <span class="hljs-string">&quot;ï¼š&quot;</span> + map.get(<span class="hljs-keyword">key</span>)+<span class="hljs-string">&quot;   &quot;</span>);<br><br>        &#125;<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * å¦‚æœæ—¢è¦éå†keyåˆè¦valueï¼Œé‚£ä¹ˆå»ºè®®è¿™ç§æ–¹å¼ï¼Œå› ä¸ºå¦‚æœå…ˆè·å–keySetç„¶åå†æ‰§è¡Œmap.get(key)ï¼Œmapå†…éƒ¨ä¼šæ‰§è¡Œä¸¤æ¬¡éå†ã€‚</span><br><span class="hljs-comment">         * ä¸€æ¬¡æ˜¯åœ¨è·å–keySetçš„æ—¶å€™ï¼Œä¸€æ¬¡æ˜¯åœ¨éå†æ‰€æœ‰keyçš„æ—¶å€™ã€‚</span><br><span class="hljs-comment">         */</span><br>        // å½“æˆ‘è°ƒç”¨<span class="hljs-meta">put</span>(<span class="hljs-keyword">key</span>,value)æ–¹æ³•çš„æ—¶å€™ï¼Œé¦–å…ˆä¼šæŠŠ<span class="hljs-keyword">key</span>å’Œvalueå°è£…åˆ°<br>        // Entryè¿™ä¸ªé™æ€å†…éƒ¨ç±»å¯¹è±¡ä¸­ï¼ŒæŠŠEntryå¯¹è±¡å†æ·»åŠ åˆ°æ•°ç»„ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬æƒ³è·å–<br>        // mapä¸­çš„æ‰€æœ‰é”®å€¼å¯¹ï¼Œæˆ‘ä»¬åªè¦è·å–æ•°ç»„ä¸­çš„æ‰€æœ‰Entryå¯¹è±¡ï¼Œæ¥ä¸‹æ¥<br>        // è°ƒç”¨Entryå¯¹è±¡ä¸­çš„getKey()å’ŒgetValue()æ–¹æ³•å°±èƒ½è·å–é”®å€¼å¯¹äº†<br>        <span class="hljs-keyword">Set</span>&lt;java.util.Map.Entry&lt;String, String&gt;&gt; entrys = map.entrySet();<br>        for (java.util.Map.Entry&lt;String, String&gt; entry : entrys) &#123;<br>            System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(entry.getKey() + <span class="hljs-string">&quot;--&quot;</span> + entry.getValue());<br>        &#125;<br><br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * HashMapå…¶ä»–å¸¸ç”¨æ–¹æ³•</span><br><span class="hljs-comment">         */</span><br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;after map.size()ï¼š&quot;</span>+map.size());<br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;after map.isEmpty()ï¼š&quot;</span>+map.isEmpty());<br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(map.<span class="hljs-keyword">remove</span>(<span class="hljs-string">&quot;san&quot;</span>));<br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;after map.remove()ï¼š&quot;</span>+map);<br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;after map.get(si)ï¼š&quot;</span>+map.get(<span class="hljs-string">&quot;si&quot;</span>));<br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;after map.containsKey(si)ï¼š&quot;</span>+map.containsKey(<span class="hljs-string">&quot;si&quot;</span>));<br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;after containsValue(æå››)ï¼š&quot;</span>+map.containsValue(<span class="hljs-string">&quot;æå››&quot;</span>));<br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(map.<span class="hljs-keyword">replace</span>(<span class="hljs-string">&quot;si&quot;</span>, <span class="hljs-string">&quot;æå››2&quot;</span>));<br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;after map.replace(si, æå››2):&quot;</span>+map);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2ã€åº•å±‚æ•°æ®ç»“æ„"><a href="#2ã€åº•å±‚æ•°æ®ç»“æ„" class="headerlink" title="2ã€åº•å±‚æ•°æ®ç»“æ„"></a>2ã€åº•å±‚æ•°æ®ç»“æ„</h3><h4 id="JDK1-8-ä¹‹å‰"><a href="#JDK1-8-ä¹‹å‰" class="headerlink" title="JDK1.8 ä¹‹å‰"></a>JDK1.8 ä¹‹å‰</h4><p>JDK1.8 ä¹‹å‰ HashMap åº•å±‚æ˜¯ <strong>æ•°ç»„å’Œé“¾è¡¨</strong> ç»“åˆåœ¨ä¸€èµ·ä½¿ç”¨ï¼ˆ <strong>é“¾è¡¨æ•£åˆ—</strong>ï¼‰ã€‚</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231115224010.png" alt="image.png"></p><p>HashMap é€šè¿‡ key çš„ hashCode ç»è¿‡æ‰°åŠ¨å‡½æ•°å¤„ç†è¿‡åå¾—åˆ° hash å€¼ï¼Œç„¶åé€šè¿‡ <code>(n - 1) &amp; hash</code> åˆ¤æ–­å½“å‰å…ƒç´ å­˜æ”¾çš„ä½ç½®ï¼ˆè¿™é‡Œçš„ n æŒ‡çš„æ˜¯æ•°ç»„çš„é•¿åº¦ï¼‰ï¼Œå¦‚æœå½“å‰ä½ç½®å­˜åœ¨å…ƒç´ çš„è¯ï¼Œå°±åˆ¤æ–­è¯¥å…ƒç´ ä¸è¦å­˜å…¥çš„å…ƒç´ çš„ hash å€¼ä»¥åŠ key æ˜¯å¦ç›¸åŒï¼Œ<strong>å¦‚æœç›¸åŒçš„è¯ï¼Œç›´æ¥è¦†ç›–</strong>ï¼Œä¸ç›¸åŒå°±é€šè¿‡æ‹‰é“¾æ³•è§£å†³å†²çªã€‚</p><p>æ‰€è°“æ‰°åŠ¨å‡½æ•°æŒ‡çš„å°±æ˜¯ HashMap çš„ hash æ–¹æ³•ã€‚</p><p>ä½¿ç”¨ hash æ–¹æ³•ï¼ˆæ‰°åŠ¨å‡½æ•°ï¼‰æ˜¯ä¸ºäº†é˜²æ­¢ä¸€äº›å®ç°æ¯”è¾ƒå·®çš„ hashCode() æ–¹æ³• ï¼Œä½¿ç”¨æ‰°åŠ¨å‡½æ•°ä¹‹åå¯ä»¥å‡å°‘ç¢°æ’ã€‚</p><p>æ‰€è°“ <strong>â€œæ‹‰é“¾æ³•â€</strong> æ˜¯ï¼šå°†é“¾è¡¨å’Œæ•°ç»„ç›¸ç»“åˆã€‚ä¹Ÿå°±æ˜¯è¯´åˆ›å»ºä¸€ä¸ªé“¾è¡¨æ•°ç»„ï¼Œ<strong>æ•°ç»„ä¸­æ¯ä¸€æ ¼å°±æ˜¯ä¸€ä¸ªé“¾è¡¨</strong>ã€‚è‹¥é‡åˆ°å“ˆå¸Œå†²çªï¼Œåˆ™å°†å†²çªçš„å€¼åŠ åˆ°é“¾è¡¨ä¸­å³å¯ã€‚</p><p><strong>hash æ–¹æ³•</strong></p><p>JDK 1.8 HashMap çš„ hash æ–¹æ³•æºç :</p><p>JDK 1.8 çš„ hash æ–¹æ³• ç›¸æ¯”äº JDK 1.7 hash æ–¹æ³•æ›´åŠ ç®€åŒ–ï¼Œä½†æ˜¯åŸç†ä¸å˜</p><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs processing">  <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">hash</span>(<span class="hljs-built_in">Object</span> <span class="hljs-built_in">key</span>) &#123;<br>    <span class="hljs-type">int</span> h;<br>    <span class="hljs-comment">// key.hashCode()ï¼šè¿”å›æ•£åˆ—å€¼ä¹Ÿå°±æ˜¯hashcode</span><br>    <span class="hljs-comment">// ^ï¼šæŒ‰ä½å¼‚æˆ–</span><br>    <span class="hljs-comment">// &gt;&gt;&gt;:æ— ç¬¦å·å³ç§»ï¼Œå¿½ç•¥ç¬¦å·ä½ï¼Œç©ºä½éƒ½ä»¥0è¡¥é½</span><br>    <span class="hljs-title function_">return</span> (<span class="hljs-built_in">key</span> == <span class="hljs-literal">null</span>) ? <span class="hljs-number">0</span> : (h = <span class="hljs-built_in">key</span>.<span class="hljs-property">hashCode</span>()) ^ (h &gt;&gt;&gt; <span class="hljs-number">16</span>);<br>&#125;<br><br></code></pre></td></tr></table></figure><p> JDK1.7 çš„ HashMap çš„ hash æ–¹æ³•æºç .</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs arduino"><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">int</span> <span class="hljs-title">hash</span><span class="hljs-params">(<span class="hljs-type">int</span> h)</span> </span>&#123;<br>    <span class="hljs-comment">// This function ensures that hashCodes that differ only by</span><br>    <span class="hljs-comment">// constant multiples at each bit position have a bounded</span><br>    <span class="hljs-comment">// number of collisions (approximately 8 at default load factor).</span><br><br>    h ^= (h &gt;&gt;&gt; <span class="hljs-number">20</span>) ^ (h &gt;&gt;&gt; <span class="hljs-number">12</span>);<br>    <span class="hljs-keyword">return</span> h ^ (h &gt;&gt;&gt; <span class="hljs-number">7</span>) ^ (h &gt;&gt;&gt; <span class="hljs-number">4</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>ç›¸æ¯”äº JDK1.8 çš„ hash æ–¹æ³• ï¼ŒJDK 1.7 çš„ hash æ–¹æ³•çš„æ€§èƒ½ç¨å·®ä¸€ç‚¹ï¼Œå› ä¸ºæ¯•ç«Ÿæ‰°åŠ¨äº† 4 æ¬¡ã€‚</p><h4 id="JDK1-8-ä¹‹å"><a href="#JDK1-8-ä¹‹å" class="headerlink" title="JDK1.8 ä¹‹å"></a>JDK1.8 ä¹‹å</h4><p>å½“é“¾è¡¨é•¿åº¦å¤§äºé˜ˆå€¼ï¼ˆé»˜è®¤ä¸º 8ï¼‰æ—¶ï¼Œä¼šé¦–å…ˆè°ƒç”¨ <code>treeifyBin()</code>æ–¹æ³•ã€‚</p><p>è¿™ä¸ªæ–¹æ³•ä¼šæ ¹æ® HashMap æ•°ç»„æ¥å†³å®šæ˜¯å¦è½¬æ¢ä¸ºçº¢é»‘æ ‘ã€‚åªæœ‰å½“æ•°ç»„é•¿åº¦å¤§äºæˆ–è€…ç­‰äº 64 çš„æƒ…å†µä¸‹ï¼Œæ‰ä¼šæ‰§è¡Œè½¬æ¢çº¢é»‘æ ‘æ“ä½œï¼Œä»¥å‡å°‘æœç´¢æ—¶é—´ã€‚</p><p>å¦åˆ™ï¼Œå°±æ˜¯åªæ˜¯æ‰§è¡Œ <code>resize()</code> æ–¹æ³•å¯¹æ•°ç»„æ‰©å®¹ã€‚</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231115223309.png" alt="image.png"></p><h4 id="HashMap-çš„ç±»å±æ€§"><a href="#HashMap-çš„ç±»å±æ€§" class="headerlink" title="HashMap çš„ç±»å±æ€§"></a>HashMap çš„ç±»å±æ€§</h4><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-symbol">HashMap</span>&lt;<span class="hljs-symbol">K,<span class="hljs-symbol">V</span></span>&gt; <span class="hljs-symbol">extends</span> <span class="hljs-symbol">AbstractMap</span>&lt;<span class="hljs-symbol">K,<span class="hljs-symbol">V</span></span>&gt; <span class="hljs-symbol">implements</span> <span class="hljs-symbol">Map</span>&lt;<span class="hljs-symbol">K,<span class="hljs-symbol">V</span></span>&gt;, <span class="hljs-symbol">Cloneable, <span class="hljs-symbol">Serializable</span></span> &#123;<br>    <span class="hljs-comment">// åºåˆ—å·</span><br>    <span class="hljs-keyword">private</span> static <span class="hljs-keyword">final</span> long serialVersionUID = <span class="hljs-number">362498820763181265</span>L;<br>    <span class="hljs-comment">// é»˜è®¤çš„åˆå§‹å®¹é‡æ˜¯16</span><br>    static <span class="hljs-keyword">final</span> <span class="hljs-built_in">int</span> DEFAULT_INITIAL_CAPACITY = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">4</span>;<br>    <span class="hljs-comment">// æœ€å¤§å®¹é‡</span><br>    static <span class="hljs-keyword">final</span> <span class="hljs-built_in">int</span> MAXIMUM_CAPACITY = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">30</span>;<br>    <span class="hljs-comment">// é»˜è®¤çš„è´Ÿè½½å› å­</span><br>    static <span class="hljs-keyword">final</span> <span class="hljs-built_in">float</span> DEFAULT_LOAD_FACTOR = <span class="hljs-number">0.75f</span>;<br>    <span class="hljs-comment">// å½“æ¡¶(bucket)ä¸Šçš„ç»“ç‚¹æ•°å¤§äºç­‰äºè¿™ä¸ªå€¼æ—¶ä¼šè½¬æˆçº¢é»‘æ ‘</span><br>    static <span class="hljs-keyword">final</span> <span class="hljs-built_in">int</span> TREEIFY_THRESHOLD = <span class="hljs-number">8</span>;<br>    <span class="hljs-comment">// å½“æ¡¶(bucket)ä¸Šçš„ç»“ç‚¹æ•°å°äºç­‰äºè¿™ä¸ªå€¼æ—¶æ ‘è½¬é“¾è¡¨</span><br>    static <span class="hljs-keyword">final</span> <span class="hljs-built_in">int</span> UNTREEIFY_THRESHOLD = <span class="hljs-number">6</span>;<br>    <span class="hljs-comment">// æ¡¶ä¸­ç»“æ„è½¬åŒ–ä¸ºçº¢é»‘æ ‘å¯¹åº”çš„tableçš„æœ€å°å®¹é‡</span><br>    static <span class="hljs-keyword">final</span> <span class="hljs-built_in">int</span> MIN_TREEIFY_CAPACITY = <span class="hljs-number">64</span>;<br>    <span class="hljs-comment">// å­˜å‚¨å…ƒç´ çš„æ•°ç»„ï¼Œæ€»æ˜¯2çš„å¹‚æ¬¡å€</span><br>    transient Node&lt;k,v&gt;[] table;<br>    <span class="hljs-comment">// å­˜æ”¾å…·ä½“å…ƒç´ çš„é›†</span><br>    transient Set&lt;map.entry&lt;k,v&gt;&gt; entrySet;<br>    <span class="hljs-comment">// å­˜æ”¾å…ƒç´ çš„ä¸ªæ•°ï¼Œæ³¨æ„è¿™ä¸ªä¸ç­‰äºæ•°ç»„çš„é•¿åº¦ã€‚</span><br>    transient <span class="hljs-built_in">int</span> size;<br>    <span class="hljs-comment">// æ¯æ¬¡æ‰©å®¹å’Œæ›´æ”¹mapç»“æ„çš„è®¡æ•°å™¨</span><br>    transient <span class="hljs-built_in">int</span> modCount;<br>    <span class="hljs-comment">// é˜ˆå€¼(å®¹é‡*è´Ÿè½½å› å­) å½“å®é™…å¤§å°è¶…è¿‡é˜ˆå€¼æ—¶ï¼Œä¼šè¿›è¡Œæ‰©å®¹</span><br>    <span class="hljs-built_in">int</span> threshold;<br>    <span class="hljs-comment">// è´Ÿè½½å› å­</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-built_in">float</span> loadFactor;<br>&#125;<br></code></pre></td></tr></table></figure><p>å‡ ä¸ªé‡è¦çš„å­—æ®µ</p><ul><li>loadFactor   è´Ÿè½½å› å­</li><li>threshold   é˜ˆå€¼ï¼ˆHashMap å®é™…èƒ½å­˜å‚¨çš„å¤§å°ï¼‰</li><li>DEFAULT_INITIAL_CAPACITY  é»˜è®¤åˆå§‹å®¹é‡</li><li>MAXIMUM_CAPACITY  æœ€å¤§å®¹é‡</li><li>size   HashMapå®é™…å­˜å‚¨çš„å…ƒç´ ä¸ªæ•°</li><li>modCount     HashMapçš„ç»“æ„è¢«ä¿®æ”¹çš„æ¬¡æ•°ï¼Œç”¨äºè¿­ä»£å™¨</li></ul><blockquote><p>loadFactor è´Ÿè½½å› å­</p></blockquote><p>loadFactor è´Ÿè½½å› å­ æ˜¯æ§åˆ¶æ•°ç»„å­˜æ”¾æ•°æ®çš„ç–å¯†ç¨‹åº¦ï¼ŒloadFactor è¶Šè¶‹è¿‘äº 1ï¼Œé‚£ä¹ˆ æ•°ç»„ä¸­å­˜æ”¾çš„æ•°æ®(entry)ä¹Ÿå°±è¶Šå¤šï¼Œä¹Ÿå°±è¶Šå¯†ï¼Œä¹Ÿå°±æ˜¯ä¼šè®©é“¾è¡¨çš„é•¿åº¦å¢åŠ ï¼ŒloadFactor è¶Šå°ï¼Œä¹Ÿå°±æ˜¯è¶‹è¿‘äº 0ï¼Œæ•°ç»„ä¸­å­˜æ”¾çš„æ•°æ®(entry)ä¹Ÿå°±è¶Šå°‘ï¼Œä¹Ÿå°±è¶Šç¨€ç–ã€‚</p><p>loadFactor å¤ªå¤§å¯¼è‡´æŸ¥æ‰¾å…ƒç´ æ•ˆç‡ä½ï¼Œå¤ªå°å¯¼è‡´æ•°ç»„çš„åˆ©ç”¨ç‡ä½ï¼Œå­˜æ”¾çš„æ•°æ®ä¼šå¾ˆåˆ†æ•£ã€‚<strong>loadFactor çš„é»˜è®¤å€¼ä¸º 0.75f</strong> ï¼Œæ˜¯å®˜æ–¹ç»™å‡ºçš„ä¸€ä¸ªæ¯”è¾ƒå¥½çš„ä¸´ç•Œå€¼ã€‚</p><p>HashMap ç»™å®šçš„é»˜è®¤å®¹é‡ä¸º 16ï¼Œè´Ÿè½½å› å­ä¸º 0.75ã€‚<br>Map åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä¸æ–­çš„å¾€é‡Œé¢å­˜æ”¾æ•°æ®ï¼Œå½“æ•°é‡è¶…è¿‡äº† 16 * 0.75 &#x3D; 12 , å°±éœ€è¦å°†å½“å‰ 16 çš„å®¹é‡è¿›è¡Œæ‰©å®¹ï¼Œè€Œæ‰©å®¹è¿™ä¸ªè¿‡ç¨‹æ¶‰åŠåˆ° rehashã€å¤åˆ¶æ•°æ®ç­‰æ“ä½œï¼Œæ‰€ä»¥éå¸¸æ¶ˆè€—æ€§èƒ½ã€‚</p><blockquote><p>threshold   é˜ˆå€¼</p></blockquote><p><strong>threshold &#x3D; capacity * loadFactor</strong>ï¼Œé˜ˆå€¼(å®¹é‡ * è´Ÿè½½å› å­) </p><p>å½“å®é™…å¤§å°è¶…è¿‡é˜ˆå€¼æ—¶ï¼Œå°±è¦è€ƒè™‘å¯¹æ•°ç»„çš„æ‰©å¢ã€‚é˜ˆå€¼æ˜¯è¡¡é‡æ•°ç»„æ˜¯å¦éœ€è¦æ‰©å¢çš„ä¸€ä¸ªæ ‡å‡†ã€‚</p><h4 id="Node-èŠ‚ç‚¹ç±»æºç "><a href="#Node-èŠ‚ç‚¹ç±»æºç " class="headerlink" title="Node èŠ‚ç‚¹ç±»æºç "></a>Node èŠ‚ç‚¹ç±»æºç </h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">// ç»§æ‰¿è‡ª Map.Entry&lt;K,V&gt;</span><br>static <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span>&lt;<span class="hljs-type">K,V</span>&gt; <span class="hljs-title">implements</span> <span class="hljs-title">Map</span>.<span class="hljs-title">Entry</span>&lt;<span class="hljs-type">K,V</span>&gt; &#123;<br>       <span class="hljs-keyword">final</span> int hash;<span class="hljs-comment">// å“ˆå¸Œå€¼ï¼Œå­˜æ”¾å…ƒç´ åˆ°hashmapä¸­æ—¶ç”¨æ¥ä¸å…¶ä»–å…ƒç´ hashå€¼æ¯”è¾ƒ</span><br>       <span class="hljs-keyword">final</span> K key;<span class="hljs-comment">//é”®</span><br>       V value;<span class="hljs-comment">//å€¼</span><br>       <span class="hljs-comment">// æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span><br>       Node&lt;K,V&gt; next;<br>       <br>       Node(int hash, K key, V value, Node&lt;K,V&gt; next) &#123;<br>            <span class="hljs-keyword">this</span>.hash = hash;<br>            <span class="hljs-keyword">this</span>.key = key;<br>            <span class="hljs-keyword">this</span>.value = value;<br>            <span class="hljs-keyword">this</span>.next = next;<br>        &#125;<br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> K getKey()        &#123; <span class="hljs-keyword">return</span> key; &#125;<br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> V getValue()      &#123; <span class="hljs-keyword">return</span> value; &#125;<br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> String toString() &#123; <span class="hljs-keyword">return</span> key + <span class="hljs-string">&quot;=&quot;</span> + value; &#125;<br>        <span class="hljs-comment">// é‡å†™hashCode()æ–¹æ³•</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> int hashCode() &#123;<br>            <span class="hljs-keyword">return</span> Objects.hashCode(key) ^ Objects.hashCode(value);<br>        &#125;<br><br><span class="hljs-comment">//ç›¸å½“äºæŠŠåŸæ¥çš„å€¼ç»™è¦†ç›–æ‰ï¼Œä½†æ˜¯è¿”å›è¢«è¦†ç›–æ‰çš„å€¼</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> V setValue(V newValue) &#123;<br>            V oldValue = value;<br>            value = newValue;<br>            <span class="hljs-keyword">return</span> oldValue;<br>        &#125;<br>        <br>        <span class="hljs-comment">// é‡å†™ equals() æ–¹æ³•</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> boolean equals(Object o) &#123;<br>            <span class="hljs-keyword">if</span> (o == <span class="hljs-keyword">this</span>)<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            <span class="hljs-keyword">if</span> (o instanceof Map.Entry) &#123;<br>                Map.Entry&lt;?,?&gt; e = (Map.Entry&lt;?,?&gt;)o;<br>                <span class="hljs-keyword">if</span> (Objects.equals(key, e.getKey()) &amp;&amp;<br>                    Objects.equals(value, e.getValue()))<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            &#125;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="æ ‘èŠ‚ç‚¹ç±»æºç "><a href="#æ ‘èŠ‚ç‚¹ç±»æºç " class="headerlink" title="æ ‘èŠ‚ç‚¹ç±»æºç "></a>æ ‘èŠ‚ç‚¹ç±»æºç </h4><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs scala">static <span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TreeNode&lt;K</span>,<span class="hljs-title">V&gt;</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">LinkedHashMap</span>.<span class="hljs-title">Entry&lt;K</span>,<span class="hljs-title">V&gt;</span> </span>&#123;<br>        <span class="hljs-type">TreeNode</span>&lt;<span class="hljs-type">K</span>,<span class="hljs-type">V</span>&gt; parent;  <span class="hljs-comment">// çˆ¶</span><br>        <span class="hljs-type">TreeNode</span>&lt;<span class="hljs-type">K</span>,<span class="hljs-type">V</span>&gt; left;    <span class="hljs-comment">// å·¦</span><br>        <span class="hljs-type">TreeNode</span>&lt;<span class="hljs-type">K</span>,<span class="hljs-type">V</span>&gt; right;   <span class="hljs-comment">// å³</span><br>        <span class="hljs-type">TreeNode</span>&lt;<span class="hljs-type">K</span>,<span class="hljs-type">V</span>&gt; prev;    <span class="hljs-comment">// needed to unlink next upon deletion</span><br>        boolean red;           <span class="hljs-comment">// åˆ¤æ–­é¢œè‰²</span><br>        <span class="hljs-type">TreeNode</span>(int hash, <span class="hljs-type">K</span> key, <span class="hljs-type">V</span> <span class="hljs-keyword">val</span>, <span class="hljs-type">Node</span>&lt;<span class="hljs-type">K</span>,<span class="hljs-type">V</span>&gt; next) &#123;<br>            <span class="hljs-keyword">super</span>(hash, key, <span class="hljs-keyword">val</span>, next);<br>        &#125;<br>        <br>        <span class="hljs-comment">// è¿”å›æ ¹èŠ‚ç‚¹</span><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">TreeNode</span>&lt;<span class="hljs-type">K</span>,<span class="hljs-type">V</span>&gt; root() &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">TreeNode</span>&lt;<span class="hljs-type">K</span>,<span class="hljs-type">V</span>&gt; r = <span class="hljs-keyword">this</span>, p;;) &#123;<br>                <span class="hljs-keyword">if</span> ((p = r.parent) == <span class="hljs-literal">null</span>)<br>                    <span class="hljs-keyword">return</span> r;<br>                r = p;<br>       &#125;<br><br></code></pre></td></tr></table></figure><h3 id="3ã€HashMap-æºç åˆ†æ"><a href="#3ã€HashMap-æºç åˆ†æ" class="headerlink" title="3ã€HashMap æºç åˆ†æ"></a>3ã€HashMap æºç åˆ†æ</h3><h4 id="æ„é€ æ–¹æ³•"><a href="#æ„é€ æ–¹æ³•" class="headerlink" title="æ„é€ æ–¹æ³•"></a>æ„é€ æ–¹æ³•</h4><p>HashMap ä¸­æœ‰å››ä¸ªæ„é€ æ–¹æ³•ï¼Œå®ƒä»¬åˆ†åˆ«å¦‚ä¸‹ï¼š</p><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs aspectj">   <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">float</span> DEFAULT_LOAD_FACTOR = <span class="hljs-number">0.75</span>f;<br><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> MAXIMUM_CAPACITY = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">30</span>;<br><br><span class="hljs-keyword">int</span> threshold;<br>   <br>   <span class="hljs-comment">// é»˜è®¤æ„é€ å‡½æ•°ã€‚</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">HashMap</span><span class="hljs-params">()</span> </span>&#123;<br>       <span class="hljs-keyword">this</span>.loadFactor = DEFAULT_LOAD_FACTOR; <span class="hljs-comment">// all   other fields defaulted</span><br>    &#125;<br><br>    <span class="hljs-comment">// åŒ…å«å¦ä¸€ä¸ªâ€œMapâ€çš„æ„é€ å‡½æ•°</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">HashMap</span><span class="hljs-params">(Map&lt;? <span class="hljs-keyword">extends</span> K, ? <span class="hljs-keyword">extends</span> V&gt; m)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.loadFactor = DEFAULT_LOAD_FACTOR;<br>        putMapEntries(m, <span class="hljs-keyword">false</span>);<span class="hljs-comment">//ä¸‹é¢ä¼šåˆ†æ</span><br>    &#125;<br><br>    <span class="hljs-comment">// æŒ‡å®šâ€œå®¹é‡å¤§å°â€çš„æ„é€ å‡½æ•°</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">HashMap</span><span class="hljs-params">(<span class="hljs-keyword">int</span> initialCapacity)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>(initialCapacity, DEFAULT_LOAD_FACTOR);<br>    &#125;<br><br>    <span class="hljs-comment">// æŒ‡å®šâ€œå®¹é‡å¤§å°â€å’Œâ€œè´Ÿè½½å› å­â€çš„æ„é€ å‡½æ•°</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">HashMap</span><span class="hljs-params">(<span class="hljs-keyword">int</span> initialCapacity, <span class="hljs-keyword">float</span> loadFactor)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (initialCapacity &lt; <span class="hljs-number">0</span>)<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(<span class="hljs-string">&quot;Illegal initial capacity: &quot;</span> + initialCapacity);<br>        <span class="hljs-keyword">if</span> (initialCapacity &gt; MAXIMUM_CAPACITY)<br>            initialCapacity = MAXIMUM_CAPACITY;<br>        <span class="hljs-keyword">if</span> (loadFactor &lt;= <span class="hljs-number">0</span> || Float.isNaN(loadFactor))<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(<span class="hljs-string">&quot;Illegal load factor: &quot;</span> + loadFactor);<br>        <span class="hljs-comment">//æŒ‡å®šè´Ÿè½½å› å­</span><br>        <span class="hljs-keyword">this</span>.loadFactor = loadFactor;<br>        <span class="hljs-comment">// åˆå§‹å®¹é‡æš‚æ—¶å­˜æ”¾åˆ° threshold ï¼Œåœ¨ resize ä¸­å†èµ‹å€¼ç»™ newCap è¿›è¡Œtableåˆå§‹åŒ–</span><br>        <span class="hljs-keyword">this</span>.threshold = tableSizeFor(initialCapacity);<br>    &#125;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢ç¬¬äºŒä¸ªæ„é€ å‡½æ•°ä¸­è°ƒç”¨äº† putMapEntries æ–¹æ³•ï¼Œä¸‹é¢è¿›è¡Œåˆ†æï¼š</p><p><strong>putMapEntries æ–¹æ³•</strong></p><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs aspectj"><span class="hljs-keyword">transient</span> Node&lt;K,V&gt;[] table;<br><br><span class="hljs-keyword">final</span> <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">putMapEntries</span><span class="hljs-params">(Map&lt;? <span class="hljs-keyword">extends</span> K, ? <span class="hljs-keyword">extends</span> V&gt; m, <span class="hljs-keyword">boolean</span> evict)</span> </span>&#123;  <br>    <span class="hljs-keyword">int</span> s = m.size();  <br>    <span class="hljs-keyword">if</span> (s &gt; <span class="hljs-number">0</span>) &#123;  <br>        <span class="hljs-comment">// åˆ¤æ–­tableæ˜¯å¦å·²ç»åˆå§‹åŒ–</span><br>        <span class="hljs-keyword">if</span> (table == <span class="hljs-keyword">null</span>) &#123; <span class="hljs-comment">// pre-size  </span><br>            <span class="hljs-comment">//å¦‚æœæœªåˆå§‹åŒ–ï¼Œs ä¸º m çš„å®é™…å…ƒç´ ä¸ªæ•°ï¼›ft=s/loadFactor =&gt; s=ft*loadFactorï¼›å…¶ä¸­ ft æŒ‡çš„æ˜¯è¦æ·»åŠ  s ä¸ªå…ƒç´ æ‰€éœ€è¦çš„æœ€å°çš„å®¹é‡</span><br>            <span class="hljs-keyword">float</span> ft = ((<span class="hljs-keyword">float</span>)s / loadFactor) + <span class="hljs-number">1.0</span>F;  <br>            <span class="hljs-comment">//ä¸æœ€å¤§å®¹é‡ä½œæ¯”è¾ƒï¼Œå¦‚æœå°äºåˆ™ t ä¸º ftï¼Œå¦åˆ™ä¸º MAXIMUM_CAPACITY</span><br>            <span class="hljs-keyword">int</span> t = ((ft &lt; (<span class="hljs-keyword">float</span>)MAXIMUM_CAPACITY) ?  <br>                     (<span class="hljs-keyword">int</span>)ft : MAXIMUM_CAPACITY);  <br>            <span class="hljs-comment">//æ ¹æ®ä¸Šé¢çš„æ„é€ å‡½æ•°ï¼Œå¯ä»¥å¾—çŸ¥æ­¤æ—¶ table æœªåˆå§‹åŒ–ï¼Œthreshold å®é™…ä¸Šæ˜¯å­˜æ”¾çš„åˆå§‹åŒ–å®¹é‡</span><br>            <span class="hljs-comment">//å¦‚æœæ·»åŠ sä¸ªå…ƒç´ æ‰€éœ€çš„æœ€å°å®¹é‡å¤§äºåˆå§‹åŒ–å®¹é‡ï¼Œåˆ™å°†æœ€å°å®¹é‡æ‰©å®¹ä¸ºæœ€æ¥è¿‘çš„2çš„å¹‚æ¬¡æ–¹å¤§å°ä½œä¸ºåˆå§‹åŒ–ã€‚ï¼ˆæ³¨æ„è¿™é‡Œä¸æ˜¯åˆå§‹åŒ–é˜ˆå€¼ï¼‰</span><br>            <span class="hljs-keyword">if</span> (t &gt; threshold)  <br>                threshold = tableSizeFor(t);  <br>        &#125;  <br>        <span class="hljs-comment">// å¦‚æœå·²ç»åˆå§‹åŒ–ï¼Œå¹¶ä¸”må…ƒç´ ä¸ªæ•°å¤§äºé˜ˆå€¼ï¼Œè¿›è¡Œæ‰©å®¹å¤„ç†</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (s &gt; threshold)  <br>            resize();  <br>        <span class="hljs-comment">// å°†mä¸­çš„æ‰€æœ‰å…ƒç´ æ·»åŠ è‡³HashMapä¸­ï¼Œå¦‚æœtableæœªåˆå§‹åŒ–ï¼ŒputValä¸­ä¼šè°ƒç”¨resizeåˆå§‹åŒ–æˆ–æ‰©å®¹    </span><br>        <span class="hljs-keyword">for</span> (Map.Entry&lt;? <span class="hljs-keyword">extends</span> K, ? <span class="hljs-keyword">extends</span> V&gt; e : m.entrySet()) &#123;  <br>            K key = e.getKey();  <br>            V value = e.getValue();  <br>            putVal(hash(key), key, value, <span class="hljs-keyword">false</span>, evict);  <br>        &#125;  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p>tableSizeFor æ–¹æ³•ï¼šè¿”å›ä¸€ä¸ªæœ€æ¥è¿‘ cap çš„2çš„å¹‚æ¬¡æ–¹å¤§å°æ•°å€¼</p><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs excel">static final <span class="hljs-built_in">int</span> tableSizeFor(<span class="hljs-built_in">int</span> cap) &#123;  <br>    <span class="hljs-built_in">int</span> <span class="hljs-built_in">n</span> = cap - <span class="hljs-number">1</span>;  <br>    <span class="hljs-built_in">n</span> |= <span class="hljs-built_in">n</span> &gt;&gt;&gt; <span class="hljs-number">1</span>;  <br>    <span class="hljs-built_in">n</span> |= <span class="hljs-built_in">n</span> &gt;&gt;&gt; <span class="hljs-number">2</span>;  <br>    <span class="hljs-built_in">n</span> |= <span class="hljs-built_in">n</span> &gt;&gt;&gt; <span class="hljs-number">4</span>;  <br>    <span class="hljs-built_in">n</span> |= <span class="hljs-built_in">n</span> &gt;&gt;&gt; <span class="hljs-number">8</span>;  <br>    <span class="hljs-built_in">n</span> |= <span class="hljs-built_in">n</span> &gt;&gt;&gt; <span class="hljs-number">16</span>;  <br>    return (<span class="hljs-built_in">n</span> &lt; <span class="hljs-number">0</span>) ? <span class="hljs-number">1</span> <span class="hljs-symbol">:</span> (<span class="hljs-built_in">n</span> &gt;= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY <span class="hljs-symbol">:</span> <span class="hljs-built_in">n</span> + <span class="hljs-number">1</span>;  <br>&#125;<br></code></pre></td></tr></table></figure><h4 id="put-æ–¹æ³•"><a href="#put-æ–¹æ³•" class="headerlink" title="put æ–¹æ³•"></a>put æ–¹æ³•</h4><p>HashMap åªæä¾›äº† put ç”¨äºæ·»åŠ å…ƒç´ ï¼ŒputVal æ–¹æ³•æ˜¯ put æ–¹æ³•è°ƒç”¨çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¹¶æ²¡æœ‰æä¾›ç»™ç”¨æˆ·ä½¿ç”¨ã€‚</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs maxima">public V <span class="hljs-built_in">put</span>(K <span class="hljs-built_in">key</span>, V value) &#123;<br>    <span class="hljs-built_in">return</span> putVal(hash(<span class="hljs-built_in">key</span>), <span class="hljs-built_in">key</span>, value, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>putVal æ–¹æ³• å›¾è§£</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231115230931.png" alt="image.png"></p><p>putVal æ–¹æ³•æ·»åŠ å…ƒç´ åˆ†æï¼š</p><ul><li>å¦‚æœå®šä½åˆ°çš„æ•°ç»„ä½ç½®æ²¡æœ‰å…ƒç´  å°±ç›´æ¥æ’å…¥ã€‚</li><li>å¦‚æœå®šä½åˆ°çš„æ•°ç»„ä½ç½®æœ‰å…ƒç´ å°±å’Œè¦æ’å…¥çš„ key æ¯”è¾ƒï¼Œ<ul><li>å¦‚æœ key ç›¸åŒå°±ç›´æ¥è¦†ç›–ï¼Œ</li><li>å¦‚æœ key ä¸ç›¸åŒï¼Œå°±åˆ¤æ–­ p æ˜¯å¦æ˜¯ä¸€ä¸ªæ ‘èŠ‚ç‚¹ï¼Œ<ul><li>å¦‚æœæ˜¯å°±è°ƒç”¨<code>e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value)</code>å°†å…ƒç´ æ·»åŠ è¿›å…¥ã€‚</li><li>å¦‚æœä¸æ˜¯å°±éå†é“¾è¡¨æ’å…¥(æ’å…¥çš„æ˜¯é“¾è¡¨å°¾éƒ¨)ã€‚</li></ul></li></ul></li></ul><blockquote><p>putVal æ–¹æ³•</p></blockquote><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs arcade">final V putVal(int <span class="hljs-built_in">hash</span>, K key, V value, <span class="hljs-built_in">boolean</span> onlyIfAbsent,<br>                   <span class="hljs-built_in">boolean</span> evict) &#123;<br>    Node&lt;K,V&gt;[] <span class="hljs-literal">tab</span>; Node&lt;K,V&gt; p; int n, i;<br>    <span class="hljs-comment">// tableæœªåˆå§‹åŒ–æˆ–è€…é•¿åº¦ä¸º0ï¼Œè¿›è¡Œæ‰©å®¹</span><br>    <span class="hljs-keyword">if</span> ((<span class="hljs-literal">tab</span> = table) == <span class="hljs-literal">null</span> || (n = <span class="hljs-literal">tab</span>.<span class="hljs-built_in">length</span>) == <span class="hljs-number">0</span>)<br>        n = (<span class="hljs-literal">tab</span> = <span class="hljs-built_in">resize</span>()).<span class="hljs-built_in">length</span>;<br>    <span class="hljs-comment">// (n - 1) &amp; hash ç¡®å®šå…ƒç´ å­˜æ”¾åœ¨å“ªä¸ªæ¡¶ä¸­ï¼Œæ¡¶ä¸ºç©ºï¼Œæ–°ç”Ÿæˆç»“ç‚¹æ”¾å…¥æ¡¶ä¸­(æ­¤æ—¶ï¼Œè¿™ä¸ªç»“ç‚¹æ˜¯æ”¾åœ¨æ•°ç»„ä¸­)</span><br>    <span class="hljs-keyword">if</span> ((p = <span class="hljs-literal">tab</span>[i = (n - <span class="hljs-number">1</span>) &amp; <span class="hljs-built_in">hash</span>]) == <span class="hljs-literal">null</span>)<br>        <span class="hljs-literal">tab</span>[i] = newNode(<span class="hljs-built_in">hash</span>, key, value, <span class="hljs-literal">null</span>);<br>    <span class="hljs-comment">// æ¡¶ä¸­å·²ç»å­˜åœ¨å…ƒç´ ï¼ˆå¤„ç†hashå†²çªï¼‰</span><br>    <span class="hljs-keyword">else</span> &#123;<br>        Node&lt;K,V&gt; e; K k;<br>        <span class="hljs-comment">//å¿«é€Ÿåˆ¤æ–­ç¬¬ä¸€ä¸ªèŠ‚ç‚¹table[i]çš„keyæ˜¯å¦ä¸æ’å…¥çš„keyä¸€æ ·ï¼Œè‹¥ç›¸åŒå°±ç›´æ¥ä½¿ç”¨æ’å…¥çš„å€¼pæ›¿æ¢æ‰æ—§çš„å€¼eã€‚</span><br>        <span class="hljs-keyword">if</span> (p.<span class="hljs-built_in">hash</span> == <span class="hljs-built_in">hash</span> &amp;&amp;<br>            ((k = p.key) == key || (key != <span class="hljs-literal">null</span> &amp;&amp; key.<span class="hljs-built_in">equals</span>(k))))<br>                e = p;<br>        <span class="hljs-comment">// åˆ¤æ–­æ’å…¥çš„æ˜¯å¦æ˜¯çº¢é»‘æ ‘èŠ‚ç‚¹</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (p instanceof TreeNode)<br>            <span class="hljs-comment">// æ”¾å…¥æ ‘ä¸­</span><br>            e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, <span class="hljs-literal">tab</span>, <span class="hljs-built_in">hash</span>, key, value);<br>        <span class="hljs-comment">// ä¸æ˜¯çº¢é»‘æ ‘èŠ‚ç‚¹åˆ™è¯´æ˜ä¸ºé“¾è¡¨ç»“ç‚¹</span><br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// åœ¨é“¾è¡¨æœ€æœ«æ’å…¥ç»“ç‚¹</span><br>            <span class="hljs-keyword">for</span> (int binCount = <span class="hljs-number">0</span>; ; ++binCount) &#123;<br>                <span class="hljs-comment">// åˆ°è¾¾é“¾è¡¨çš„å°¾éƒ¨</span><br>                <span class="hljs-keyword">if</span> ((e = p.next) == <span class="hljs-literal">null</span>) &#123;<br>                    <span class="hljs-comment">// åœ¨å°¾éƒ¨æ’å…¥æ–°ç»“ç‚¹</span><br>                    p.next = newNode(<span class="hljs-built_in">hash</span>, key, value, <span class="hljs-literal">null</span>);<br>                    <span class="hljs-comment">// ç»“ç‚¹æ•°é‡è¾¾åˆ°é˜ˆå€¼(é»˜è®¤ä¸º 8 )ï¼Œæ‰§è¡Œ treeifyBin æ–¹æ³•</span><br>                    <span class="hljs-comment">// è¿™ä¸ªæ–¹æ³•ä¼šæ ¹æ® HashMap æ•°ç»„æ¥å†³å®šæ˜¯å¦è½¬æ¢ä¸ºçº¢é»‘æ ‘ã€‚</span><br>                    <span class="hljs-comment">// åªæœ‰å½“æ•°ç»„é•¿åº¦å¤§äºæˆ–è€…ç­‰äº 64 çš„æƒ…å†µä¸‹ï¼Œæ‰ä¼šæ‰§è¡Œè½¬æ¢çº¢é»‘æ ‘æ“ä½œï¼Œä»¥å‡å°‘æœç´¢æ—¶é—´ã€‚å¦åˆ™ï¼Œå°±æ˜¯åªæ˜¯å¯¹æ•°ç»„æ‰©å®¹ã€‚</span><br>                    <span class="hljs-keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class="hljs-number">1</span>) <span class="hljs-comment">// -1 for 1st</span><br>                        treeifyBin(<span class="hljs-literal">tab</span>, <span class="hljs-built_in">hash</span>);<br>                    <span class="hljs-comment">// è·³å‡ºå¾ªç¯</span><br>                    <span class="hljs-keyword">break</span>;<br>                &#125;<br>                <span class="hljs-comment">// åˆ¤æ–­é“¾è¡¨ä¸­ç»“ç‚¹çš„keyå€¼ä¸æ’å…¥çš„å…ƒç´ çš„keyå€¼æ˜¯å¦ç›¸ç­‰</span><br>                <span class="hljs-keyword">if</span> (e.<span class="hljs-built_in">hash</span> == <span class="hljs-built_in">hash</span> &amp;&amp;<br>                    ((k = e.key) == key || (key != <span class="hljs-literal">null</span> &amp;&amp; key.<span class="hljs-built_in">equals</span>(k))))<br>                    <span class="hljs-comment">// ç›¸ç­‰ï¼Œè·³å‡ºå¾ªç¯</span><br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-comment">// ç”¨äºéå†æ¡¶ä¸­çš„é“¾è¡¨ï¼Œä¸å‰é¢çš„e = p.nextç»„åˆï¼Œå¯ä»¥éå†é“¾è¡¨</span><br>                p = e;<br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">// è¡¨ç¤ºåœ¨æ¡¶ä¸­æ‰¾åˆ°keyå€¼ã€hashå€¼ä¸æ’å…¥å…ƒç´ ç›¸ç­‰çš„ç»“ç‚¹</span><br>        <span class="hljs-keyword">if</span> (e != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-comment">// è®°å½•eçš„value</span><br>            V oldValue = e.value;<br>            <span class="hljs-comment">// onlyIfAbsentä¸ºfalseæˆ–è€…æ—§å€¼ä¸ºnull</span><br>            <span class="hljs-keyword">if</span> (!onlyIfAbsent || oldValue == <span class="hljs-literal">null</span>)<br>                <span class="hljs-comment">//ç”¨æ–°å€¼æ›¿æ¢æ—§å€¼</span><br>                e.value = value;<br>            <span class="hljs-comment">// è®¿é—®åå›è°ƒ</span><br>            afterNodeAccess(e);<br>            <span class="hljs-comment">// è¿”å›æ—§å€¼</span><br>            <span class="hljs-keyword">return</span> oldValue;<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">// ç»“æ„æ€§ä¿®æ”¹</span><br>    ++modCount;<br>    <span class="hljs-comment">// å®é™…å¤§å°å¤§äºé˜ˆå€¼åˆ™æ‰©å®¹</span><br>    <span class="hljs-keyword">if</span> (++size &gt; threshold)<br>        <span class="hljs-built_in">resize</span>();<br>    <span class="hljs-comment">// æ’å…¥åå›è°ƒ</span><br>    afterNodeInsertion(evict);<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p><strong>å¯¹æ¯” JDK1.7 put æ–¹æ³•çš„ä»£ç </strong></p></blockquote><p><strong>å¯¹äº put æ–¹æ³•çš„åˆ†æå¦‚ä¸‹ï¼š</strong></p><ul><li>â‘  å¦‚æœå®šä½åˆ°çš„æ•°ç»„ä½ç½®æ²¡æœ‰å…ƒç´  å°±ç›´æ¥æ’å…¥ã€‚</li><li>â‘¡ å¦‚æœå®šä½åˆ°çš„æ•°ç»„ä½ç½®æœ‰å…ƒç´ ï¼Œéå†ä»¥è¿™ä¸ªå…ƒç´ ä¸ºå¤´ç»“ç‚¹çš„é“¾è¡¨ï¼Œä¾æ¬¡å’Œæ’å…¥çš„ key æ¯”è¾ƒï¼Œå¦‚æœ key ç›¸åŒå°±ç›´æ¥è¦†ç›–ï¼Œä¸åŒå°±é‡‡ç”¨å¤´æ’æ³•æ’å…¥å…ƒç´ ã€‚</li></ul><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs processing"><span class="hljs-keyword">public</span> V <span class="hljs-title function_">put</span>(K <span class="hljs-built_in">key</span>, V value)<br>    <span class="hljs-keyword">if</span> (table == EMPTY_TABLE) &#123;<br>    <span class="hljs-title function_">inflateTable</span>(threshold);<br>&#125;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">key</span> == <span class="hljs-literal">null</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">putForNullKey</span>(value);<br>    <span class="hljs-type">int</span> hash = <span class="hljs-title function_">hash</span>(<span class="hljs-built_in">key</span>);<br>    <span class="hljs-type">int</span> i = <span class="hljs-title function_">indexFor</span>(hash, table.<span class="hljs-property">length</span>);<br>    <span class="hljs-keyword">for</span> (Entry&lt;K,V&gt; e = table[i]; e != <span class="hljs-literal">null</span>; e = e.<span class="hljs-property">next</span>) &#123; <span class="hljs-comment">// å…ˆéå†</span><br>        <span class="hljs-built_in">Object</span> k;<br>        <span class="hljs-keyword">if</span> (e.<span class="hljs-property">hash</span> == hash &amp;&amp; ((k = e.<span class="hljs-property">key</span>) == <span class="hljs-built_in">key</span> || <span class="hljs-built_in">key</span>.<span class="hljs-property">equals</span>(k))) &#123;<br>            V oldValue = e.<span class="hljs-property">value</span>;<br>            e.<span class="hljs-property">value</span> = value;<br>            e.<span class="hljs-property">recordAccess</span>(<span class="hljs-variable">this</span>);<br>            <span class="hljs-keyword">return</span> oldValue;<br>        &#125;<br>    &#125;<br><br>    modCount++;<br>    <span class="hljs-title function_">addEntry</span>(hash, <span class="hljs-built_in">key</span>, value, i);  <span class="hljs-comment">// å†æ’å…¥</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="get-æ–¹æ³•"><a href="#get-æ–¹æ³•" class="headerlink" title="get æ–¹æ³•"></a>get æ–¹æ³•</h4><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs arcade">public V get(Object key) &#123;<br>    Node&lt;K,V&gt; e;<br>    <span class="hljs-keyword">return</span> (e = getNode(<span class="hljs-built_in">hash</span>(key), key)) == <span class="hljs-literal">null</span> ? <span class="hljs-literal">null</span> : e.value;<br>&#125;<br><br>final Node&lt;K,V&gt; getNode(int <span class="hljs-built_in">hash</span>, Object key) &#123;<br>    Node&lt;K,V&gt;[] <span class="hljs-literal">tab</span>; Node&lt;K,V&gt; <span class="hljs-built_in">first</span>, e; int n; K k;<br>    <span class="hljs-keyword">if</span> ((<span class="hljs-literal">tab</span> = table) != <span class="hljs-literal">null</span> &amp;&amp; (n = <span class="hljs-literal">tab</span>.<span class="hljs-built_in">length</span>) &gt; <span class="hljs-number">0</span> &amp;&amp;<br>        (<span class="hljs-built_in">first</span> = <span class="hljs-literal">tab</span>[(n - <span class="hljs-number">1</span>) &amp; <span class="hljs-built_in">hash</span>]) != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-comment">// æ•°ç»„å…ƒç´ ç›¸ç­‰</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">first</span>.<span class="hljs-built_in">hash</span> == <span class="hljs-built_in">hash</span> &amp;&amp; <span class="hljs-comment">// always check first node</span><br>            ((k = <span class="hljs-built_in">first</span>.key) == key || (key != <span class="hljs-literal">null</span> &amp;&amp; key.<span class="hljs-built_in">equals</span>(k))))<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">first</span>;<br>        <span class="hljs-comment">// æ¡¶ä¸­ä¸æ­¢ä¸€ä¸ªèŠ‚ç‚¹</span><br>        <span class="hljs-keyword">if</span> ((e = <span class="hljs-built_in">first</span>.next) != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-comment">// åœ¨æ ‘ä¸­get</span><br>            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">first</span> instanceof TreeNode)<br>                <span class="hljs-keyword">return</span> ((TreeNode&lt;K,V&gt;)<span class="hljs-built_in">first</span>).getTreeNode(<span class="hljs-built_in">hash</span>, key);<br>            <span class="hljs-comment">// åœ¨é“¾è¡¨ä¸­get</span><br>            <span class="hljs-keyword">do</span> &#123;<br>                <span class="hljs-keyword">if</span> (e.<span class="hljs-built_in">hash</span> == <span class="hljs-built_in">hash</span> &amp;&amp;<br>                    ((k = e.key) == key || (key != <span class="hljs-literal">null</span> &amp;&amp; key.<span class="hljs-built_in">equals</span>(k))))<br>                    <span class="hljs-keyword">return</span> e;<br>            &#125; <span class="hljs-keyword">while</span> ((e = e.next) != <span class="hljs-literal">null</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="resize-æ–¹æ³•"><a href="#resize-æ–¹æ³•" class="headerlink" title="resize æ–¹æ³•"></a>resize æ–¹æ³•</h4><p>è¿›è¡Œæ‰©å®¹ï¼Œä¼šä¼´éšç€ä¸€æ¬¡é‡æ–° hash åˆ†é…ï¼Œå¹¶ä¸”ä¼šéå† hash è¡¨ä¸­æ‰€æœ‰çš„å…ƒç´ ï¼Œæ˜¯éå¸¸è€—æ—¶çš„ã€‚åœ¨ç¼–å†™ç¨‹åºä¸­ï¼Œè¦å°½é‡é¿å… resizeã€‚</p><p>resize æ–¹æ³•å®é™…ä¸Šæ˜¯å°† table åˆå§‹åŒ–å’Œ table æ‰©å®¹ è¿›è¡Œäº†æ•´åˆï¼Œåº•å±‚çš„è¡Œä¸ºéƒ½æ˜¯ç»™ table èµ‹å€¼ä¸€ä¸ªæ–°çš„æ•°ç»„ã€‚</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><code class="hljs haxe"><span class="hljs-keyword">final</span> Node&lt;K,V&gt;[] resize() &#123;<br>    Node&lt;K,V&gt;[] oldTab = table;<br>    int oldCap = (oldTab == <span class="hljs-literal">null</span>) ? <span class="hljs-number">0</span> : <span class="hljs-type">oldTab</span>.length;<br>    int oldThr = threshold;<br>    int <span class="hljs-keyword">new</span><span class="hljs-type">Cap</span>, <span class="hljs-keyword">new</span><span class="hljs-type">Thr</span> = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">if</span> (oldCap &gt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-comment">// è¶…è¿‡æœ€å¤§å€¼å°±ä¸å†æ‰©å……äº†ï¼Œå°±åªå¥½éšä½ ç¢°æ’å»å§</span><br>        <span class="hljs-keyword">if</span> (oldCap &gt;= MAXIMUM_CAPACITY) &#123;<br>            threshold = Integer.MAX_VALUE;<br>            <span class="hljs-keyword">return</span> oldTab;<br>        &#125;<br>        <span class="hljs-comment">// æ²¡è¶…è¿‡æœ€å¤§å€¼ï¼Œå°±æ‰©å……ä¸ºåŸæ¥çš„2å€</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((<span class="hljs-keyword">new</span><span class="hljs-type">Cap</span> = oldCap &lt;&lt; <span class="hljs-number">1</span>) &lt; MAXIMUM_CAPACITY &amp;&amp; oldCap &gt;= DEFAULT_INITIAL_CAPACITY)<br>            <span class="hljs-keyword">new</span><span class="hljs-type">Thr</span> = oldThr &lt;&lt; <span class="hljs-number">1</span>; <span class="hljs-comment">// double threshold</span><br>    &#125;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (oldThr &gt; <span class="hljs-number">0</span>) <span class="hljs-comment">// initial capacity was placed in threshold</span><br>        <span class="hljs-comment">// åˆ›å»ºå¯¹è±¡æ—¶åˆå§‹åŒ–å®¹é‡å¤§å°æ”¾åœ¨thresholdä¸­ï¼Œæ­¤æ—¶åªéœ€è¦å°†å…¶ä½œä¸ºæ–°çš„æ•°ç»„å®¹é‡</span><br>        <span class="hljs-keyword">new</span><span class="hljs-type">Cap</span> = oldThr;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// signifies using defaults æ— å‚æ„é€ å‡½æ•°åˆ›å»ºçš„å¯¹è±¡åœ¨è¿™é‡Œè®¡ç®—å®¹é‡å’Œé˜ˆå€¼</span><br>        <span class="hljs-keyword">new</span><span class="hljs-type">Cap</span> = DEFAULT_INITIAL_CAPACITY;<br>        <span class="hljs-keyword">new</span><span class="hljs-type">Thr</span> = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);<br>    &#125;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">new</span><span class="hljs-type">Thr</span> == <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-comment">// åˆ›å»ºæ—¶æŒ‡å®šäº†åˆå§‹åŒ–å®¹é‡æˆ–è€…è´Ÿè½½å› å­ï¼Œåœ¨è¿™é‡Œè¿›è¡Œé˜ˆå€¼åˆå§‹åŒ–ï¼Œ</span><br>    <span class="hljs-comment">// æˆ–è€…æ‰©å®¹å‰çš„æ—§å®¹é‡å°äº16ï¼Œåœ¨è¿™é‡Œè®¡ç®—æ–°çš„resizeä¸Šé™</span><br>        float ft = (float)<span class="hljs-keyword">new</span><span class="hljs-type">Cap</span> * loadFactor;<br>        <span class="hljs-keyword">new</span><span class="hljs-type">Thr</span> = (<span class="hljs-keyword">new</span><span class="hljs-type">Cap</span> &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (float)MAXIMUM_CAPACITY ? (int)ft : <span class="hljs-type">Integer</span>.MAX_VALUE);<br>    &#125;<br>    threshold = <span class="hljs-keyword">new</span><span class="hljs-type">Thr</span>;<br>    <span class="hljs-meta">@SuppressWarnings</span>(&#123;<span class="hljs-string">&quot;rawtypes&quot;</span>,<span class="hljs-string">&quot;unchecked&quot;</span>&#125;)<br>        Node&lt;K,V&gt;[] <span class="hljs-keyword">new</span><span class="hljs-type">Tab</span> = (Node&lt;K,V&gt;[])<span class="hljs-keyword">new</span> <span class="hljs-type">Node</span>[<span class="hljs-keyword">new</span><span class="hljs-type">Cap</span>];<br>    table = <span class="hljs-keyword">new</span><span class="hljs-type">Tab</span>;<br>    <span class="hljs-keyword">if</span> (oldTab != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-comment">// æŠŠæ¯ä¸ªbucketéƒ½ç§»åŠ¨åˆ°æ–°çš„bucketsä¸­</span><br>        <span class="hljs-keyword">for</span> (int j = <span class="hljs-number">0</span>; j &lt; oldCap; ++j) &#123;<br>            Node&lt;K,V&gt; e;<br>            <span class="hljs-keyword">if</span> ((e = oldTab[j]) != <span class="hljs-literal">null</span>) &#123;<br>                oldTab[j] = <span class="hljs-literal">null</span>;<br>                <span class="hljs-keyword">if</span> (e.next == <span class="hljs-literal">null</span>)<br>                    <span class="hljs-comment">// åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç›´æ¥è®¡ç®—å…ƒç´ æ–°çš„ä½ç½®å³å¯</span><br>                    <span class="hljs-keyword">new</span><span class="hljs-type">Tab</span>[e.hash &amp; (<span class="hljs-keyword">new</span><span class="hljs-type">Cap</span> - <span class="hljs-number">1</span>)] = e;<br>                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (e instanceof TreeNode)<br>                    <span class="hljs-comment">// å°†çº¢é»‘æ ‘æ‹†åˆ†æˆ2æ£µå­æ ‘ï¼Œå¦‚æœå­æ ‘èŠ‚ç‚¹æ•°å°äºç­‰äº UNTREEIFY_THRESHOLDï¼ˆé»˜è®¤ä¸º 6ï¼‰ï¼Œåˆ™å°†å­æ ‘è½¬æ¢ä¸ºé“¾è¡¨ã€‚</span><br>                    <span class="hljs-comment">// å¦‚æœå­æ ‘èŠ‚ç‚¹æ•°å¤§äº UNTREEIFY_THRESHOLDï¼Œåˆ™ä¿æŒå­æ ‘çš„æ ‘ç»“æ„ã€‚</span><br>                    ((TreeNode&lt;K,V&gt;)e).split(<span class="hljs-built_in">this</span>, <span class="hljs-keyword">new</span><span class="hljs-type">Tab</span>, j, oldCap);<br>                <span class="hljs-keyword">else</span> &#123;<br>                    Node&lt;K,V&gt; loHead = <span class="hljs-literal">null</span>, loTail = <span class="hljs-literal">null</span>;<br>                    Node&lt;K,V&gt; hiHead = <span class="hljs-literal">null</span>, hiTail = <span class="hljs-literal">null</span>;<br>                    Node&lt;K,V&gt; next;<br>                    <span class="hljs-keyword">do</span> &#123;<br>                        next = e.next;<br>                        <span class="hljs-comment">// åŸç´¢å¼•</span><br>                        <span class="hljs-keyword">if</span> ((e.hash &amp; oldCap) == <span class="hljs-number">0</span>) &#123;<br>                            <span class="hljs-keyword">if</span> (loTail == <span class="hljs-literal">null</span>)<br>                                loHead = e;<br>                            <span class="hljs-keyword">else</span><br>                                loTail.next = e;<br>                            loTail = e;<br>                        &#125;<br>                        <span class="hljs-comment">// åŸç´¢å¼•+oldCap</span><br>                        <span class="hljs-keyword">else</span> &#123;<br>                            <span class="hljs-keyword">if</span> (hiTail == <span class="hljs-literal">null</span>)<br>                                hiHead = e;<br>                            <span class="hljs-keyword">else</span><br>                                hiTail.next = e;<br>                            hiTail = e;<br>                        &#125;<br>                    &#125; <span class="hljs-keyword">while</span> ((e = next) != <span class="hljs-literal">null</span>);<br>                    <span class="hljs-comment">// åŸç´¢å¼•æ”¾åˆ°bucketé‡Œ</span><br>                    <span class="hljs-keyword">if</span> (loTail != <span class="hljs-literal">null</span>) &#123;<br>                        loTail.next = <span class="hljs-literal">null</span>;<br>                        <span class="hljs-keyword">new</span><span class="hljs-type">Tab</span>[j] = loHead;<br>                    &#125;<br>                    <span class="hljs-comment">// åŸç´¢å¼•+oldCapæ”¾åˆ°bucketé‡Œ</span><br>                    <span class="hljs-keyword">if</span> (hiTail != <span class="hljs-literal">null</span>) &#123;<br>                        hiTail.next = <span class="hljs-literal">null</span>;<br>                        <span class="hljs-keyword">new</span><span class="hljs-type">Tab</span>[j + oldCap] = hiHead;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span><span class="hljs-type">Tab</span>;<br>&#125;<br></code></pre></td></tr></table></figure><hr><p>å‚è€ƒï¼š</p><ul><li><a href="https://javaguide.cn/java/collection/hashmap-source-code.html">https://javaguide.cn/java/collection/hashmap-source-code.html</a></li><li><a href="https://blog.csdn.net/xiao_a_ruo_ya/article/details/98882507">https://blog.csdn.net/xiao_a_ruo_ya/article/details/98882507</a></li><li><a href="https://blog.csdn.net/rain67/article/details/124043769">https://blog.csdn.net/rain67/article/details/124043769</a></li><li><a href="https://segmentfault.com/a/1190000039302830">https://segmentfault.com/a/1190000039302830</a></li><li><a href="https://blog.csdn.net/weixin_47257050/article/details/118926555">https://blog.csdn.net/weixin_47257050/article/details/118926555</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>é›†åˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaå­¦ä¹ çš„è½»æ¾ä¹‹æ—…</title>
    <link href="/2023/11/15/Java%E5%AD%A6%E4%B9%A0%E7%9A%84%E8%BD%BB%E6%9D%BE%E4%B9%8B%E6%97%85/"/>
    <url>/2023/11/15/Java%E5%AD%A6%E4%B9%A0%E7%9A%84%E8%BD%BB%E6%9D%BE%E4%B9%8B%E6%97%85/</url>
    
    <content type="html"><![CDATA[<h3 id="JavaåŸºç¡€"><a href="#JavaåŸºç¡€" class="headerlink" title="JavaåŸºç¡€"></a>JavaåŸºç¡€</h3><p><strong>Java é›†åˆ</strong></p><ul><li><a href="/2023/11/14/Java%E9%9B%86%E5%90%88_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/" title="Java é›†åˆ_åŸºç¡€æ¦‚å¿µ">Java é›†åˆ_åŸºç¡€æ¦‚å¿µ</a></li><li><a href="/2023/11/15/Java%E9%9B%86%E5%90%88_%E8%BF%9B%E9%98%B6%E5%86%85%E5%AE%B9/" title="Java é›†åˆ_è¿›é˜¶å†…å®¹">Java é›†åˆ_è¿›é˜¶å†…å®¹</a></li><li><a href="/2023/11/14/Java%E9%9B%86%E5%90%88_%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/" title="Javaé›†åˆ_ç›¸å…³é—®é¢˜">Javaé›†åˆ_ç›¸å…³é—®é¢˜</a></li><li><a href="/2023/11/14/Java%E9%9B%86%E5%90%88_ArrayList%E5%AD%A6%E4%B9%A0/" title="Javaé›†åˆ_ArrayList å­¦ä¹ ">Javaé›†åˆ_ArrayList å­¦ä¹ </a></li><li><a href="/2023/11/15/Java%E9%9B%86%E5%90%88_HashMap%E5%AD%A6%E4%B9%A0/" title="Javaé›†åˆ_HashMapå­¦ä¹ ">Javaé›†åˆ_HashMapå­¦ä¹ </a></li></ul><p><strong>Javaå¤šçº¿ç¨‹</strong></p>]]></content>
    
    
    
    <tags>
      
      <tag>index</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaé›†åˆ_ArrayList å­¦ä¹ </title>
    <link href="/2023/11/14/Java%E9%9B%86%E5%90%88_ArrayList%E5%AD%A6%E4%B9%A0/"/>
    <url>/2023/11/14/Java%E9%9B%86%E5%90%88_ArrayList%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h3 id="1ã€åŸºç¡€æ¦‚å¿µ"><a href="#1ã€åŸºç¡€æ¦‚å¿µ" class="headerlink" title="1ã€åŸºç¡€æ¦‚å¿µ"></a>1ã€åŸºç¡€æ¦‚å¿µ</h3><p>ArrayList æ˜¯ List çš„ä¸»è¦å®ç°ç±»ï¼Œå†…éƒ¨åŸºäºåŠ¨æ€æ•°ç»„å®ç°ï¼Œæ”¯æŒæ’å…¥ã€åˆ é™¤ã€éå†ç­‰å¸¸è§æ“ä½œï¼Œå¹¶ä¸”æä¾›äº†ä¸°å¯Œçš„ API æ“ä½œæ–¹æ³•ï¼Œæ¯”å¦‚ <code>add()</code>ã€<code>remove()</code>ç­‰ã€‚</p><p><code>ArrayList</code> ä¸­å¯ä»¥å­˜å‚¨ä»»ä½•ç±»å‹çš„å¯¹è±¡ï¼ŒåŒ…æ‹¬ <code>null</code> å€¼ã€‚ä¸è¿‡ä¸å»ºè®®å‘<code>ArrayList</code> ä¸­æ·»åŠ  <code>null</code> å€¼ï¼Œ <code>null</code> å€¼æ— æ„ä¹‰ã€‚</p><p><code>ArrayList</code> ä¸­åªèƒ½å­˜å‚¨å¯¹è±¡ã€‚å¯¹äºåŸºæœ¬ç±»å‹æ•°æ®ï¼Œéœ€è¦ä½¿ç”¨å…¶å¯¹åº”çš„åŒ…è£…ç±»ï¼ˆå¦‚ Integerã€Double ç­‰ï¼‰ã€‚</p><p><code>ArrayList</code>åˆ›å»ºæ—¶ä¸éœ€è¦æŒ‡å®šå¤§å°ï¼Œä¸‹é¢æ˜¯å¸¸ç”¨æ–¹æ³•ç¤ºä¾‹ä»£ç ï¼š</p><p>ArrayList</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-comment">// åˆå§‹åŒ–ä¸€ä¸ª String ç±»å‹çš„ ArrayList</span><br> ArrayList&lt;String&gt; stringList = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;(Arrays.asList(<span class="hljs-string">&quot;hello&quot;</span>, <span class="hljs-string">&quot;world&quot;</span>, <span class="hljs-string">&quot;!&quot;</span>));<br><span class="hljs-comment">// æ·»åŠ å…ƒç´ åˆ° ArrayList ä¸­</span><br> stringList.<span class="hljs-keyword">add</span>(<span class="hljs-string">&quot;goodbye&quot;</span>);<br> System.<span class="hljs-keyword">out</span>.println(stringList);<span class="hljs-comment">// [hello, world, !, goodbye]</span><br> <span class="hljs-comment">// ä¿®æ”¹ ArrayList ä¸­çš„å…ƒç´ </span><br> stringList.<span class="hljs-keyword">set</span>(<span class="hljs-number">0</span>, <span class="hljs-string">&quot;hi&quot;</span>);<br> System.<span class="hljs-keyword">out</span>.println(stringList);<span class="hljs-comment">// [hi, world, !, goodbye]</span><br> <span class="hljs-comment">// åˆ é™¤ ArrayList ä¸­çš„å…ƒç´ </span><br> stringList.<span class="hljs-keyword">remove</span>(<span class="hljs-number">0</span>);<br> System.<span class="hljs-keyword">out</span>.println(stringList); <span class="hljs-comment">// [world, !, goodbye]</span><br></code></pre></td></tr></table></figure><h3 id="2ã€ArrayList-æ‰©å®¹æœºåˆ¶"><a href="#2ã€ArrayList-æ‰©å®¹æœºåˆ¶" class="headerlink" title="2ã€ArrayList æ‰©å®¹æœºåˆ¶"></a>2ã€ArrayList æ‰©å®¹æœºåˆ¶</h3><p>ä»¥æ— å‚æ„é€ å‡½æ•°åˆ›å»ºçš„ ArrayList ä¸ºä¾‹åˆ†æ, ï¼ˆJDK8ï¼‰</p><h4 id="add-æ–¹æ³•"><a href="#add-æ–¹æ³•" class="headerlink" title="add æ–¹æ³•"></a>add æ–¹æ³•</h4><p>æˆ‘ä»¬æ¥çœ‹ add æ–¹æ³•</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs arduino"><span class="hljs-keyword">private</span> <span class="hljs-type">int</span> size;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * å°†æŒ‡å®šçš„å…ƒç´ è¿½åŠ åˆ°æ­¤åˆ—è¡¨çš„æœ«å°¾ã€‚</span><br><span class="hljs-comment"> */</span> <br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title">add</span><span class="hljs-params">(E e)</span> </span>&#123; <br><span class="hljs-comment">//æ·»åŠ å…ƒç´ ä¹‹å‰ï¼Œå…ˆè°ƒç”¨ensureCapacityInternal æ–¹æ³•</span><br>    <span class="hljs-built_in">ensureCapacityInternal</span>(size + <span class="hljs-number">1</span>);  <span class="hljs-comment">// Increments modCount!!  </span><br>    <span class="hljs-comment">//è¿™é‡Œçœ‹åˆ°ArrayListæ·»åŠ å…ƒç´ çš„å®è´¨å°±ç›¸å½“äºä¸ºæ•°ç»„èµ‹å€¼</span><br>    elementData[size++] = e;  <br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;  <br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p><strong>æ³¨æ„</strong>ï¼šJDK11 ç§»é™¤äº† <code>ensureCapacityInternal()</code> å’Œ <code>ensureExplicitCapacity()</code> æ–¹æ³•</p></blockquote><h4 id="ensureCapacityInternal-æ–¹æ³•"><a href="#ensureCapacityInternal-æ–¹æ³•" class="headerlink" title="ensureCapacityInternal æ–¹æ³•"></a>ensureCapacityInternal æ–¹æ³•</h4><p>è¿›å…¥ ensureCapacityInternal æ–¹æ³•</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">//å¾—åˆ°æœ€å°æ‰©å®¹é‡</span><br><span class="hljs-keyword">private</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">ensureCapacityInternal</span>(<span class="hljs-params">int minCapacity</span>) &#123;  <br>    <span class="hljs-keyword">if</span> (elementData == <span class="hljs-variable constant_">DEFAULTCAPACITY_EMPTY_ELEMENTDATA</span>) &#123;  <br>    <span class="hljs-comment">// è·å–é»˜è®¤çš„å®¹é‡å’Œä¼ å…¥å‚æ•°çš„æ¯”è¾ƒæœ€å¤§å€¼</span><br>        minCapacity = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-variable constant_">DEFAULT_CAPACITY</span>, minCapacity);  <br>    &#125;  <br>  <br>    <span class="hljs-title function_">ensureExplicitCapacity</span>(minCapacity);  <br>&#125;<br></code></pre></td></tr></table></figure><p><code>add</code> æ–¹æ³• é¦–å…ˆè°ƒç”¨äº†<code>ensureCapacityInternal(size + 1)</code>,  ArrayList çš„é»˜è®¤å®¹é‡æ˜¯ 10ï¼›</p><p>å½“ è¦ add è¿›ç¬¬ 1 ä¸ªå…ƒç´ æ—¶ï¼ŒminCapacity ä¸º 1ï¼Œåœ¨ Math.max( )æ–¹æ³•æ¯”è¾ƒåï¼ŒminCapacity ä¸º 10ã€‚</p><h4 id="ensureExplicitCapacity-æ–¹æ³•"><a href="#ensureExplicitCapacity-æ–¹æ³•" class="headerlink" title="ensureExplicitCapacity() æ–¹æ³•"></a><code>ensureExplicitCapacity()</code> æ–¹æ³•</h4><p>è¿›å…¥åˆ° <code>ensureExplicitCapacity()</code> æ–¹æ³•</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-comment">//åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹</span><br>private void <span class="hljs-built_in">ensureExplicitCapacity</span>(int minCapacity) &#123;  <br>    modCount++;  <br>  <br>    <span class="hljs-comment">// overflow-conscious code  </span><br>    if (minCapacity - elementData.length &gt; <span class="hljs-number">0</span>)  <br>    <span class="hljs-comment">//è°ƒç”¨growæ–¹æ³•è¿›è¡Œæ‰©å®¹ï¼Œè°ƒç”¨æ­¤æ–¹æ³•ä»£è¡¨å·²ç»å¼€å§‹æ‰©å®¹äº†</span><br>        <span class="hljs-built_in">grow</span>(minCapacity);  <br>&#125;<br></code></pre></td></tr></table></figure><ul><li>å½“ add æ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ åˆ° ArrayList æ—¶ï¼Œ<ul><li>elementData.length ä¸º 0 ï¼ˆæ­¤æ—¶è¿˜æ˜¯ä¸€ä¸ªç©ºçš„ listï¼‰ï¼›</li><li>æ‰§è¡Œ <code>ensureCapacityInternal()</code> æ–¹æ³• ï¼Œ minCapacity æ­¤æ—¶ä¸º 10ã€‚</li><li>æ­¤æ—¶ï¼Œ<code>minCapacity - elementData.length &gt; 0</code>æˆç«‹ï¼Œä¼šè¿›å…¥ <code>grow(minCapacity)</code> æ–¹æ³•ã€‚</li></ul></li><li>å½“ add ç¬¬ 2 ä¸ªå…ƒç´ æ—¶ï¼Œ<ul><li>minCapacity ä¸º 2ï¼Œæ­¤æ—¶ elementData.length(å®¹é‡)åœ¨æ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ åæ‰©å®¹æˆ 10 äº†ã€‚</li><li>æ­¤æ—¶ï¼Œ<code>minCapacity - elementData.length &gt; 0</code> ä¸æˆç«‹ï¼Œæ‰€ä»¥ä¸ä¼šè¿›å…¥ ï¼ˆæ‰§è¡Œï¼‰<code>grow(minCapacity)</code> æ–¹æ³•ã€‚</li></ul></li><li>æ·»åŠ ç¬¬ 3ã€4Â·Â·Â·åˆ°ç¬¬ 10 ä¸ªå…ƒç´ æ—¶ï¼Œä¾ç„¶ä¸ä¼šæ‰§è¡Œ grow æ–¹æ³•ï¼Œæ•°ç»„å®¹é‡éƒ½ä¸º 10ã€‚</li></ul><p>ç›´åˆ°æ·»åŠ ç¬¬ 11 ä¸ªå…ƒç´ ï¼ŒminCapacity(ä¸º 11)æ¯” elementData.lengthï¼ˆä¸º 10ï¼‰è¦å¤§ã€‚è¿›å…¥ grow æ–¹æ³•è¿›è¡Œæ‰©å®¹ã€‚</p><h4 id="grow-æ–¹æ³•"><a href="#grow-æ–¹æ³•" class="headerlink" title="grow æ–¹æ³•"></a><code>grow æ–¹æ³•</code></h4><p>è¿›å…¥åˆ° <code>grow æ–¹æ³•</code></p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs haxe"><span class="hljs-comment">//è¦åˆ†é…çš„æœ€å¤§æ•°ç»„å¤§å°</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> int MAX_ARRAY_SIZE = Integer.MAX_VALUE - <span class="hljs-number">8</span>;<br><br><br><span class="hljs-comment">/**  </span><br><span class="hljs-comment"> * Increases the capacity to ensure that it can hold at least the number of elements specified by the minimum capacity argument. </span><br><span class="hljs-comment"> * @param minCapacity - the desired minimum capacity  </span><br><span class="hljs-comment"> * ArrayListæ‰©å®¹çš„æ ¸å¿ƒæ–¹æ³•ã€‚</span><br><span class="hljs-comment">*/</span><br> <span class="hljs-keyword">private</span> void grow(int minCapacity) &#123;  <br>    <span class="hljs-comment">// overflow-conscious code  </span><br>    <span class="hljs-comment">// oldCapacityä¸ºæ—§å®¹é‡ï¼ŒnewCapacityä¸ºæ–°å®¹é‡</span><br>    int oldCapacity = elementData.length;  <br>    <span class="hljs-comment">//å°†oldCapacity å³ç§»ä¸€ä½ï¼Œå…¶æ•ˆæœç›¸å½“äºoldCapacity /2ï¼Œ</span><br>    <span class="hljs-comment">//ä½è¿ç®—çš„é€Ÿåº¦è¿œè¿œå¿«äºæ•´é™¤è¿ç®—ï¼Œæ•´å¥è¿ç®—å¼çš„ç»“æœå°±æ˜¯å°†æ–°å®¹é‡æ›´æ–°ä¸ºæ—§å®¹é‡çš„1.5å€ï¼Œ</span><br>    int <span class="hljs-keyword">new</span><span class="hljs-type">Capacity</span> = oldCapacity + (oldCapacity &gt;&gt; <span class="hljs-number">1</span>);  <br>    <span class="hljs-comment">//æ£€æŸ¥æ–°å®¹é‡æ˜¯å¦å¤§äºæœ€å°éœ€è¦å®¹é‡ï¼Œè‹¥è¿˜æ˜¯å°äºæœ€å°éœ€è¦å®¹é‡ï¼Œé‚£ä¹ˆå°±æŠŠæœ€å°éœ€è¦å®¹é‡å½“ä½œæ•°ç»„çš„æ–°å®¹é‡ï¼Œ</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">new</span><span class="hljs-type">Capacity</span> - minCapacity &lt; <span class="hljs-number">0</span>)  <br>        <span class="hljs-keyword">new</span><span class="hljs-type">Capacity</span> = minCapacity;  <br>    <span class="hljs-comment">// å¦‚æœæ–°å®¹é‡å¤§äº MAX_ARRAY_SIZE,è¿›å…¥(æ‰§è¡Œ) `hugeCapacity()` æ–¹æ³•æ¥æ¯”è¾ƒ minCapacity å’Œ MAX_ARRAY_SIZEï¼Œ</span><br>    <span class="hljs-comment">//å¦‚æœminCapacityå¤§äºæœ€å¤§å®¹é‡ï¼Œåˆ™æ–°å®¹é‡åˆ™ä¸º`Integer.MAX_VALUE`ï¼Œå¦åˆ™ï¼Œæ–°å®¹é‡å¤§å°åˆ™ä¸º MAX_ARRAY_SIZE å³ä¸º `Integer.MAX_VALUE - 8`ã€‚</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">new</span><span class="hljs-type">Capacity</span> - MAX_ARRAY_SIZE &gt; <span class="hljs-number">0</span>)  <br>        <span class="hljs-keyword">new</span><span class="hljs-type">Capacity</span> = hugeCapacity(minCapacity);  <br>    <span class="hljs-comment">// minCapacity is usually close to size, so this is a win:  </span><br>    elementData = Arrays.copyOf(elementData, <span class="hljs-keyword">new</span><span class="hljs-type">Capacity</span>);  <br>&#125;<br></code></pre></td></tr></table></figure><ul><li>å½“ add ç¬¬ 1 ä¸ªå…ƒç´ æ—¶ï¼Œ<ul><li>oldCapacity ä¸º 0ï¼Œç»æ¯”è¾ƒåç¬¬ä¸€ä¸ª if åˆ¤æ–­æˆç«‹ï¼Œ**newCapacity &#x3D; minCapacity(ä¸º 10)**ã€‚</li><li>ä½†æ˜¯ç¬¬äºŒä¸ª if åˆ¤æ–­ä¸ä¼šæˆç«‹ï¼Œå³ newCapacity ä¸æ¯” MAX_ARRAY_SIZE å¤§ï¼Œåˆ™ä¸ä¼šè¿›å…¥ <code>hugeCapacity</code> æ–¹æ³•ã€‚</li><li>æ•°ç»„å®¹é‡ä¸º 10ï¼Œadd æ–¹æ³•ä¸­ return true, </li><li>size å¢ä¸º 1ã€‚ã€elementData[size++] &#x3D; e;  ã€‘</li></ul></li><li>å½“ add ç¬¬ 11 ä¸ªå…ƒç´ è¿›å…¥ grow æ–¹æ³•æ—¶ï¼Œ<ul><li>newCapacity ä¸º 15ï¼Œæ¯” minCapacityï¼ˆä¸º 11ï¼‰å¤§ï¼Œç¬¬ä¸€ä¸ª if åˆ¤æ–­ä¸æˆç«‹ã€‚</li><li>æ–°å®¹é‡æ²¡æœ‰å¤§äºæ•°ç»„æœ€å¤§ sizeï¼Œä¸ä¼šè¿›å…¥ hugeCapacity æ–¹æ³•ã€‚æ•°ç»„å®¹é‡æ‰©ä¸º 15ï¼Œ</li><li>add æ–¹æ³•ä¸­ return true,  size å¢ä¸º 11ã€‚</li></ul></li><li>ä»¥æ­¤ç±»æ¨Â·Â·Â·Â·Â·Â·</li></ul><h4 id="hugeCapacity-æ–¹æ³•"><a href="#hugeCapacity-æ–¹æ³•" class="headerlink" title="hugeCapacity() æ–¹æ³•"></a><code>hugeCapacity()</code> æ–¹æ³•</h4><p>å¦‚æœæ–°å®¹é‡å¤§äº MAX_ARRAY_SIZE,è¿›å…¥(æ‰§è¡Œ) <code>hugeCapacity()</code> æ–¹æ³•</p><p>å¦‚æœ minCapacity å¤§äºæœ€å¤§å®¹é‡ï¼Œåˆ™æ–°å®¹é‡åˆ™ä¸º<code>Integer.MAX_VALUE</code>ï¼Œå¦åˆ™ï¼Œæ–°å®¹é‡å¤§å°åˆ™ä¸º MAX_ARRAY_SIZE å³ä¸º <code>Integer.MAX_VALUE - 8</code>ã€‚</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs arduino"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-type">static</span> <span class="hljs-type">int</span> <span class="hljs-title">hugeCapacity</span><span class="hljs-params">(<span class="hljs-type">int</span> minCapacity)</span> </span>&#123;  <br>    <span class="hljs-keyword">if</span> (minCapacity &lt; <span class="hljs-number">0</span>) <span class="hljs-comment">// overflow  </span><br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">OutOfMemoryError</span>();  <br><span class="hljs-comment">//å¯¹minCapacityå’ŒMAX_ARRAY_SIZEè¿›è¡Œæ¯”è¾ƒ</span><br><span class="hljs-comment">//è‹¥minCapacityå¤§ï¼Œå°†Integer.MAX_VALUEä½œä¸ºæ–°æ•°ç»„çš„å¤§å°</span><br><span class="hljs-comment">//è‹¥MAX_ARRAY_SIZEå¤§ï¼Œå°†MAX_ARRAY_SIZEä½œä¸ºæ–°æ•°ç»„çš„å¤§å°</span><br><span class="hljs-comment">//MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8;</span><br>    <span class="hljs-keyword">return</span> (minCapacity &gt; MAX_ARRAY_SIZE) ?  <br>        Integer.MAX_VALUE :  <br>        MAX_ARRAY_SIZE;  <br>&#125;<br></code></pre></td></tr></table></figure><p>æµç¨‹å›¾è¾“å‡ºï¼š</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311151356624.png" alt="image.png"></p><h3 id="3ã€ç›¸å…³å†…å®¹"><a href="#3ã€ç›¸å…³å†…å®¹" class="headerlink" title="3ã€ç›¸å…³å†…å®¹"></a>3ã€ç›¸å…³å†…å®¹</h3><h4 id="å…³äº-oldCapacity-oldCapacity-1-çš„è¯´æ˜ï¼š"><a href="#å…³äº-oldCapacity-oldCapacity-1-çš„è¯´æ˜ï¼š" class="headerlink" title="å…³äº oldCapacity + (oldCapacity &gt;&gt; 1) çš„è¯´æ˜ï¼š"></a>å…³äº oldCapacity + (oldCapacity &gt;&gt; 1) çš„è¯´æ˜ï¼š</h4><p><strong>int newCapacity &#x3D; oldCapacity + (oldCapacity &gt;&gt; 1),æ‰€ä»¥ ArrayList æ¯æ¬¡æ‰©å®¹ä¹‹åå®¹é‡éƒ½ä¼šå˜ä¸ºåŸæ¥çš„ 1.5 å€å·¦å³ï¼ˆoldCapacity ä¸ºå¶æ•°å°±æ˜¯ 1.5 å€ï¼Œå¦åˆ™æ˜¯ 1.5 å€å·¦å³ï¼‰ï¼</strong> å¥‡å¶ä¸åŒï¼Œæ¯”å¦‚ï¼š10+10&#x2F;2 &#x3D; 15, 33+33&#x2F;2&#x3D;49ã€‚å¦‚æœæ˜¯å¥‡æ•°çš„è¯ä¼šä¸¢æ‰å°æ•°.</p><blockquote><p>â€œ&gt;&gt;â€ï¼ˆç§»ä½è¿ç®—ç¬¦ï¼‰ï¼š&gt;&gt;1 å³ç§»ä¸€ä½ç›¸å½“äºé™¤ 2ï¼Œå³ç§» n ä½ç›¸å½“äºé™¤ä»¥ 2 çš„ n æ¬¡æ–¹ã€‚è¿™é‡Œ oldCapacity æ˜æ˜¾å³ç§»äº† 1 ä½æ‰€ä»¥ç›¸å½“äº oldCapacity &#x2F;2ã€‚å¯¹äºå¤§æ•°æ®çš„ 2 è¿›åˆ¶è¿ç®—,ä½ç§»è¿ç®—ç¬¦æ¯”é‚£äº›æ™®é€šè¿ç®—ç¬¦çš„è¿ç®—è¦å¿«å¾ˆå¤š,å› ä¸ºç¨‹åºä»…ä»…ç§»åŠ¨ä¸€ä¸‹è€Œå·²,ä¸å»è®¡ç®—,è¿™æ ·æé«˜äº†æ•ˆç‡,èŠ‚çœäº†èµ„æº</p></blockquote><h4 id="å…³äº-Arrays-copyOf-æ–¹æ³•"><a href="#å…³äº-Arrays-copyOf-æ–¹æ³•" class="headerlink" title="å…³äº Arrays.copyOf()æ–¹æ³•"></a>å…³äº <code>Arrays.copyOf()</code>æ–¹æ³•</h4><p>æºç ï¼š</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs haxe"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T,U&gt; T[] copyOf(U[] original, int <span class="hljs-keyword">new</span><span class="hljs-type">Length</span>, Class&lt;? extends T[]&gt; <span class="hljs-keyword">new</span><span class="hljs-type">Type</span>) &#123;  <br><span class="hljs-comment">// ç”³è¯·ä¸€ä¸ªæ–°çš„æ•°ç»„</span><br>    <span class="hljs-meta">@SuppressWarnings</span>(<span class="hljs-string">&quot;unchecked&quot;</span>)  <br>    T[] copy = ((Object)<span class="hljs-keyword">new</span><span class="hljs-type">Type</span> == (Object)Object[].class)  <br>        ? (T[]) <span class="hljs-keyword">new</span> <span class="hljs-type">Object</span>[<span class="hljs-keyword">new</span><span class="hljs-type">Length</span>]  <br>        : <span class="hljs-type"></span>(T[]) <span class="hljs-keyword">Array</span>.<span class="hljs-keyword">new</span><span class="hljs-type">Instance</span>(<span class="hljs-keyword">new</span><span class="hljs-type">Type</span>.getComponentType(), <span class="hljs-keyword">new</span><span class="hljs-type">Length</span>); <br>    <span class="hljs-comment">// è°ƒç”¨System.arraycopy,å°†æºæ•°ç»„ä¸­çš„æ•°æ®è¿›è¡Œæ‹·è´,å¹¶è¿”å›æ–°çš„æ•°ç»„     </span><br>    System.arraycopy(original, <span class="hljs-number">0</span>, copy, <span class="hljs-number">0</span>,  <br>                     Math.min(original.length, <span class="hljs-keyword">new</span><span class="hljs-type">Length</span>));  <br>    <span class="hljs-keyword">return</span> copy;  <br>&#125;<br></code></pre></td></tr></table></figure><p><code>System.arraycopy()</code> æ–¹æ³•</p><p>æºç ï¼š</p><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs aspectj"><span class="hljs-comment">// arraycopy æ˜¯ä¸€ä¸ª native æ–¹æ³•,æ¥ä¸‹æ¥è§£é‡Šä¸€ä¸‹å„ä¸ªå‚æ•°çš„å…·ä½“æ„ä¹‰</span><br><span class="hljs-comment">/**</span><br><span class="hljs-comment">*   å¤åˆ¶æ•°ç»„</span><br><span class="hljs-comment">* <span class="hljs-doctag">@param</span> src æºæ•°ç»„</span><br><span class="hljs-comment">* <span class="hljs-doctag">@param</span> srcPos æºæ•°ç»„ä¸­çš„èµ·å§‹ä½ç½®</span><br><span class="hljs-comment">* <span class="hljs-doctag">@param</span> dest ç›®æ ‡æ•°ç»„</span><br><span class="hljs-comment">* <span class="hljs-doctag">@param</span> destPos ç›®æ ‡æ•°ç»„ä¸­çš„èµ·å§‹ä½ç½®</span><br><span class="hljs-comment">* <span class="hljs-doctag">@param</span> length è¦å¤åˆ¶çš„æ•°ç»„å…ƒç´ çš„æ•°é‡</span><br><span class="hljs-comment">*/</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">native</span> <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">arraycopy</span><span class="hljs-params">(Object src,  <span class="hljs-keyword">int</span>  srcPos,</span></span><br><span class="hljs-params"><span class="hljs-function">                                    Object dest, <span class="hljs-keyword">int</span> destPos,</span></span><br><span class="hljs-params"><span class="hljs-function">                                    <span class="hljs-keyword">int</span> length)</span></span>;<br></code></pre></td></tr></table></figure><hr><p>å‚è€ƒï¼š</p><ul><li><a href="https://javaguide.cn/java/collection/arraylist-source-code.html">https://javaguide.cn/java/collection/arraylist-source-code.html</a></li><li><a href="https://blog.csdn.net/czxlylc/article/details/106892156">https://blog.csdn.net/czxlylc/article/details/106892156</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>é›†åˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaé›†åˆ_ç›¸å…³é—®é¢˜</title>
    <link href="/2023/11/14/Java%E9%9B%86%E5%90%88_%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    <url>/2023/11/14/Java%E9%9B%86%E5%90%88_%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h4 id="1ã€Seté›†åˆæ˜¯å¦‚ä½•ä¿è¯å¯¹è±¡ä¸é‡å¤çš„ï¼Ÿ"><a href="#1ã€Seté›†åˆæ˜¯å¦‚ä½•ä¿è¯å¯¹è±¡ä¸é‡å¤çš„ï¼Ÿ" class="headerlink" title="1ã€Seté›†åˆæ˜¯å¦‚ä½•ä¿è¯å¯¹è±¡ä¸é‡å¤çš„ï¼Ÿ"></a>1ã€Seté›†åˆæ˜¯å¦‚ä½•ä¿è¯å¯¹è±¡ä¸é‡å¤çš„ï¼Ÿ</h4><p>HashSet çš„åº•å±‚é‡‡ç”¨HashMapæ¥å­˜æ”¾æ•°æ®,  ä»–æ‰§è¡Œæ·»åŠ å…ƒç´ æ“ä½œçš„æ—¶å€™æ˜¯å°†å…ƒç´ ä½œä¸º Map çš„Keyï¼›</p><p>HashMapä¿è¯keyçš„ä¸é‡å¤æ€§ï¼Œå¯¹äºé‡å¤çš„keyï¼ŒHashMapä¼šæ ¹æ®å‚æ•°onlyIfAbsentçš„è®¾ç½®å’ŒåŸvalueæ˜¯å¦ä¸ºç©ºä¸¤ä¸ªæ¡ä»¶æ¥<strong>åˆ¤æ–­æ˜¯å¦æ›¿æ¢æ–°value</strong>ï¼Œ</p><p>ä½†è¦æ³¨æ„çš„æ˜¯ï¼Œå¯¹äºHashSetï¼Œè¿™ä¸ªvalueåªæ˜¯ä¸ªç©ºçš„Objectç±»çš„å¯¹è±¡ï¼Œæ²¡æœ‰ä»»ä½•å®é™…ä½œç”¨ï¼ŒHashSetä¸­çš„å…ƒç´ å®é™…ä¸Šæ˜¯å­˜å‚¨åœ¨keyä¸Šçš„ã€‚é’ˆå¯¹é‡å¤çš„keyï¼Œ<strong>HashMapåªæœ‰å¯¹äºvalueçš„å¤„ç†ï¼Œå¹¶ä¸ä¼šæ›¿æ¢key</strong>ï¼Œå› æ­¤åœ¨HashSetä¸­åŠ å…¥ç›¸åŒå…ƒç´ ä¸ä¼šè¦†ç›–ã€‚</p><p>æºç ç›¸å…³å†…å®¹ï¼š</p><p>HashSet çš„æ·»åŠ æ–¹æ³•</p><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs processing"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-built_in">add</span>(E e) &#123;  <br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">map</span>.<span class="hljs-property">put</span>(e, PRESENT)==<span class="hljs-literal">null</span>;  <br>&#125;<br></code></pre></td></tr></table></figure><p>hashmap çš„ put æ–¹æ³•</p><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs processing"><span class="hljs-keyword">public</span> V <span class="hljs-title function_">put</span>(K <span class="hljs-built_in">key</span>, V value) &#123;<br>      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">key</span> == <span class="hljs-literal">null</span>)<br>          <span class="hljs-keyword">return</span> <span class="hljs-title function_">putForNullKey</span>(value);<br>      <span class="hljs-type">int</span> hash = <span class="hljs-title function_">hash</span>(<span class="hljs-built_in">key</span>.<span class="hljs-property">hashCode</span>());<span class="hljs-comment">//----------1----------</span><br>      <span class="hljs-type">int</span> i = <span class="hljs-title function_">indexFor</span>(hash, table.<span class="hljs-property">length</span>);<span class="hljs-comment">//-----------2---------</span><br>      <span class="hljs-keyword">for</span> (Entry e = table[i]; e != <span class="hljs-literal">null</span>; e = e.<span class="hljs-property">next</span>) &#123;<span class="hljs-comment">//-----------3---------</span><br>          <span class="hljs-built_in">Object</span> k;<br>          <span class="hljs-keyword">if</span> (e.<span class="hljs-property">hash</span> == hash &amp;&amp; ((k = e.<span class="hljs-property">key</span>) == <span class="hljs-built_in">key</span> || <span class="hljs-built_in">key</span>.<span class="hljs-property">equals</span>(k))) &#123;<br>              V oldValue = e.<span class="hljs-property">value</span>;<br>              e.<span class="hljs-property">value</span> = value;<br>              e.<span class="hljs-property">recordAccess</span>(<span class="hljs-variable">this</span>);<br>              <span class="hljs-keyword">return</span> oldValue;<br>          &#125;<br>      &#125;<span class="hljs-comment">//------------------4--------------------</span><br>      modCount++;<br>      <span class="hljs-title function_">addEntry</span>(hash, <span class="hljs-built_in">key</span>, value, i);<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>  &#125;<br></code></pre></td></tr></table></figure><p>å½“å‘HashMapä¸­æ·»åŠ å…ƒç´ çš„æ—¶å€™ï¼Œ</p><ul><li><strong>é¦–å…ˆè®¡ç®—å…ƒç´ çš„hashcodeå€¼</strong>ï¼Œç„¶åæ ¹æ®1å¤„çš„ä»£ç è®¡ç®—å‡ºHashcodeçš„å€¼ï¼Œ</li><li>å†æ ¹æ®2å¤„çš„ä»£ç è®¡ç®—å‡ºè¿™ä¸ªå…ƒç´ çš„å­˜å‚¨ä½ç½®ï¼Œ<ul><li>å¦‚æœ<strong>è¿™ä¸ªä½ç½®ä¸ºç©ºï¼Œå°±å°†å…ƒç´ æ·»åŠ è¿›å»</strong>ï¼›</li><li>å¦‚æœä¸ä¸ºç©ºï¼Œåˆ™çœ‹3-4çš„ä»£ç ï¼Œéå†ç´¢å¼•ä¸ºiçš„é“¾ä¸Šçš„å…ƒç´ ï¼Œ<strong>å¦‚æœkeyé‡å¤ï¼Œåˆ™æ›¿æ¢å¹¶è¿”å›oldValueå€¼ã€‚</strong></li></ul></li></ul><p><strong>æ€»ç»“</strong>ï¼šç»“æœå‘HashSetä¸­åŠ å…¥ç›¸åŒå…ƒç´ ä¸ä¼šè¿›è¡Œè¦†ç›–ã€‚å› ä¸ºHashSetåº•å±‚ä½¿ç”¨HashMapå®ç°ï¼Œå…ƒç´ å­˜åœ¨HashMapçš„keyä¸­ã€‚åœ¨HashMapä¸­ï¼Œå¤šæ¬¡putç›¸åŒçš„keyï¼Œåªä¼šè¦†ç›–valueï¼Œè€Œä¸å­˜åœ¨keyçš„æƒ…å†µã€‚</p><h4 id="2ã€ä½¿ç”¨forå¾ªç¯åˆ é™¤å…ƒç´ é™·é˜±"><a href="#2ã€ä½¿ç”¨forå¾ªç¯åˆ é™¤å…ƒç´ é™·é˜±" class="headerlink" title="2ã€ä½¿ç”¨forå¾ªç¯åˆ é™¤å…ƒç´ é™·é˜±"></a>2ã€ä½¿ç”¨forå¾ªç¯åˆ é™¤å…ƒç´ é™·é˜±</h4><p>å…ˆæ¥çœ‹çœ‹ä¸‹é¢è¿™ä¸ªç¨‹åºï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> &#123;<br> <br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] args</span>)</span> &#123;<br>List&lt;String&gt; list = <span class="hljs-keyword">new</span> LinkedList&lt;String&gt;();<br>list.<span class="hljs-keyword">add</span>(<span class="hljs-string">&quot;A&quot;</span>);<br>list.<span class="hljs-keyword">add</span>(<span class="hljs-string">&quot;B&quot;</span>);<br>list.<span class="hljs-keyword">add</span>(<span class="hljs-string">&quot;C&quot;</span>);<br><br><span class="hljs-keyword">for</span>(<span class="hljs-built_in">int</span> i=<span class="hljs-number">0</span>; i&lt;list.size(); i++)&#123;<br>list.<span class="hljs-keyword">remove</span>(i);<br>&#125;<br><br><span class="hljs-keyword">for</span>(String item:list)&#123;<br>System.<span class="hljs-keyword">out</span>.println(item);<br>&#125;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥å…ˆçŒœçŒœè¿™ä¸ªç¨‹åºè¾“å‡ºä»€ä¹ˆï¼Ÿ</p><p>æŒ‰æˆ‘ä»¬çš„æ€è·¯ï¼Œåº”è¯¥æ˜¯è¾“ä¸å‡ºä»€ä¹ˆï¼Œ<strong>ä½†æ˜¯æ‰§è¡Œå®ƒï¼Œè¾“å‡ºçš„å´æ˜¯ï¼šB</strong>ã€‚</p><p>åˆ†æä¸‹è¿™ä¸ªç¨‹åºï¼Œå½“ç¬¬ä¸€æ­¥removeå®Œåï¼Œé›†åˆå†…è¿˜å‰©2ä¸ªå…ƒç´ ï¼Œæ­¤æ—¶iä¸º1ï¼Œè€Œlist.size()çš„å€¼ä¸º2ï¼Œä»0å¼€å§‹çš„è¯ï¼Œiä¸º1æ—¶ï¼Œæ­£å¥½æŒ‡å‘ç¬¬äºŒä¸ªå…ƒç´ ï¼Œä¹Ÿå°±æ˜¯è¯´å½“removeå®ŒAåï¼Œç›´æ¥å°±è·³åˆ°Cï¼Œå°†Bæ¼äº†ã€‚</p><p>è§£å†³åŠæ³•ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> &#123;<br> <br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] args</span>)</span> &#123;<br>List&lt;String&gt; list = <span class="hljs-keyword">new</span> LinkedList&lt;String&gt;();<br>list.<span class="hljs-keyword">add</span>(<span class="hljs-string">&quot;A&quot;</span>);<br>list.<span class="hljs-keyword">add</span>(<span class="hljs-string">&quot;B&quot;</span>);<br>list.<span class="hljs-keyword">add</span>(<span class="hljs-string">&quot;C&quot;</span>);<br><br><span class="hljs-keyword">for</span>(<span class="hljs-built_in">int</span> i=<span class="hljs-number">0</span>; i&lt;list.size(); i++)&#123;<br>list.<span class="hljs-keyword">remove</span>(i);<br>i -= <span class="hljs-number">1</span>;<span class="hljs-comment">//æ¯æ¬¡åˆ é™¤å®Œåï¼Œiå‡å°‘1</span><br>&#125;<br><br><span class="hljs-keyword">for</span>(String item:list)&#123;<br>System.<span class="hljs-keyword">out</span>.println(item);<br>&#125;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="3ã€è®²è¿°ä¸€ä¸‹-lengthã€length-ã€size-çš„åŒºåˆ«ã€‚"><a href="#3ã€è®²è¿°ä¸€ä¸‹-lengthã€length-ã€size-çš„åŒºåˆ«ã€‚" class="headerlink" title="3ã€è®²è¿°ä¸€ä¸‹ lengthã€length()ã€size() çš„åŒºåˆ«ã€‚"></a>3ã€è®²è¿°ä¸€ä¸‹ lengthã€length()ã€size() çš„åŒºåˆ«ã€‚</h4><ul><li>java ä¸­çš„ <code>length</code>å±æ€§æ˜¯é’ˆå¯¹æ•°ç»„è¯´çš„,æ¯”å¦‚è¯´ä½ å£°æ˜äº†ä¸€ä¸ªæ•°ç»„,æƒ³çŸ¥é“è¿™ä¸ªæ•°ç»„çš„é•¿åº¦åˆ™ç”¨åˆ°äº† length è¿™ä¸ªå±æ€§.</li><li>java ä¸­çš„ <code>length()</code> æ–¹æ³•æ˜¯é’ˆå¯¹å­—ç¬¦ä¸²è¯´çš„,å¦‚æœæƒ³çœ‹è¿™ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦åˆ™ç”¨åˆ° <code>length()</code> è¿™ä¸ªæ–¹æ³•.</li><li>java ä¸­çš„ <code>size()</code> æ–¹æ³•æ˜¯é’ˆå¯¹æ³›å‹é›†åˆè¯´çš„,å¦‚æœæƒ³çœ‹è¿™ä¸ªæ³›å‹æœ‰å¤šå°‘ä¸ªå…ƒç´ ,å°±è°ƒç”¨æ­¤æ–¹æ³•æ¥æŸ¥çœ‹!</li></ul><h4 id="4ã€åœ¨-HashMap-ä¸­ï¼Œä¸ºä»€ä¹ˆä¸ä¸€ä¸‹å­æŠŠæ•´ä¸ªé“¾è¡¨å˜ä¸ºçº¢é»‘æ ‘å‘¢"><a href="#4ã€åœ¨-HashMap-ä¸­ï¼Œä¸ºä»€ä¹ˆä¸ä¸€ä¸‹å­æŠŠæ•´ä¸ªé“¾è¡¨å˜ä¸ºçº¢é»‘æ ‘å‘¢" class="headerlink" title="4ã€åœ¨ HashMap ä¸­ï¼Œä¸ºä»€ä¹ˆä¸ä¸€ä¸‹å­æŠŠæ•´ä¸ªé“¾è¡¨å˜ä¸ºçº¢é»‘æ ‘å‘¢"></a>4ã€åœ¨ HashMap ä¸­ï¼Œä¸ºä»€ä¹ˆä¸ä¸€ä¸‹å­æŠŠæ•´ä¸ªé“¾è¡¨å˜ä¸ºçº¢é»‘æ ‘å‘¢</h4><p>ä¸ºä»€ä¹ˆéè¦ç­‰åˆ°é“¾è¡¨çš„é•¿åº¦å¤§äºç­‰äº8çš„æ—¶å€™ï¼Œæ‰è½¬å˜æˆçº¢é»‘æ ‘ï¼Ÿ</p><p>ï¼ˆ1ï¼‰æ„é€ çº¢é»‘æ ‘è¦æ¯”æ„é€ é“¾è¡¨å¤æ‚ï¼Œåœ¨é“¾è¡¨çš„èŠ‚ç‚¹ä¸å¤šçš„æ—¶å€™ï¼Œä»æ•´ä½“çš„æ€§èƒ½çœ‹æ¥ï¼Œ æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘çš„ç»“æ„å¯èƒ½ä¸ä¸€å®šæ¯”æ•°ç»„+é“¾è¡¨çš„ç»“æ„æ€§èƒ½é«˜ã€‚å°±å¥½æ¯”æ€é¸¡ç„‰ç”¨ç‰›åˆ€çš„æ„æ€ã€‚</p><p>ï¼ˆ2ï¼‰HashMapé¢‘ç¹çš„æ‰©å®¹ï¼Œä¼šé€ æˆåº•éƒ¨çº¢é»‘æ ‘ä¸æ–­çš„è¿›è¡Œæ‹†åˆ†å’Œé‡ç»„ï¼Œè¿™æ˜¯éå¸¸è€—æ—¶çš„ã€‚å› æ­¤ï¼Œä¹Ÿå°±æ˜¯é“¾è¡¨é•¿åº¦æ¯”è¾ƒé•¿çš„æ—¶å€™è½¬å˜æˆçº¢é»‘æ ‘æ‰ä¼š<strong>æ˜¾è‘—æé«˜æ•ˆç‡</strong>ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ—¥è®°_20231114</title>
    <link href="/2023/11/14/%E6%97%A5%E8%AE%B0_20231114/"/>
    <url>/2023/11/14/%E6%97%A5%E8%AE%B0_20231114/</url>
    
    <content type="html"><![CDATA[<p>è¿‘æœŸè®¡åˆ’</p><ul><li><input disabled="" type="checkbox"> Javaé›†åˆã€Javaå¤šçº¿ç¨‹ã€MySQLæ•°æ®åº“ã€Spring è¿›è¡Œå¤ä¹ </li><li><input disabled="" type="checkbox"> Redisã€MQ </li><li><input disabled="" type="checkbox"> å¾®æœåŠ¡ SpringCloud Alibaba é€šè¿‡å­¦ä¹ å­¦æˆåœ¨çº¿é¡¹ç›®è¿›è¡Œ</li><li><input disabled="" type="checkbox"> é¡¹ç›®ï¼šè˜‘è‡åšå®¢çš„å­¦ä¹ ï¼ˆä¸ªäººä¸€ç›´è¶‹å‘å­¦ä¹ è¿™ä¸ªé¡¹ç›®ï¼Œè¶è¿™æ®µæ—¶é—´æœ‰ç©ºï¼Œå­¦ä¹ ä¸€ä¸‹ï¼‰</li></ul>]]></content>
    
    
    <categories>
      
      <category>Diary</category>
      
    </categories>
    
    
    <tags>
      
      <tag>blog</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Java é›†åˆ_åŸºç¡€æ¦‚å¿µ</title>
    <link href="/2023/11/14/Java%E9%9B%86%E5%90%88_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/"/>
    <url>/2023/11/14/Java%E9%9B%86%E5%90%88_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/</url>
    
    <content type="html"><![CDATA[<h4 id="1ã€æˆå‘˜å…³ç³»"><a href="#1ã€æˆå‘˜å…³ç³»" class="headerlink" title="1ã€æˆå‘˜å…³ç³»"></a>1ã€æˆå‘˜å…³ç³»</h4><p>Java é›†åˆç›¸å…³çš„æˆå‘˜å…³ç³»å›¾<br><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311141122413.png" alt="image.png"></p><ul><li>Collection<ul><li>Set<ul><li>HashSet<ul><li>LinkedHashSet</li></ul></li><li>SortedSet<ul><li>TreeSet</li></ul></li></ul></li><li>List<ul><li>ArrayList</li><li>Vector<ul><li>Stack</li></ul></li><li>LinkedList</li></ul></li><li>Queue<ul><li>Deque<ul><li>ArrayDeque</li></ul></li><li>PriorityQueue</li></ul></li></ul></li><li>Map<ul><li>HashMap<ul><li>LinkedHashMap</li></ul></li><li>Hashtable</li><li>SortedMap<ul><li>TreeMap</li></ul></li></ul></li></ul><p>é€šè¿‡ä¸‹é¢è¡¨æ ¼å¯è¯´æ˜ä¹‹é—´éƒ¨åˆ†çš„åŒºåˆ«å’Œè”ç³»</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311141123120.png" alt="image.png"><br><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311141123036.png" alt="image.png"></p><h4 id="2ã€åŸºç¡€æ¦‚å¿µ"><a href="#2ã€åŸºç¡€æ¦‚å¿µ" class="headerlink" title="2ã€åŸºç¡€æ¦‚å¿µ"></a>2ã€åŸºç¡€æ¦‚å¿µ</h4><h5 id="Collection"><a href="#Collection" class="headerlink" title="Collection"></a>Collection</h5><p>Collectionæ¥å£ï¼šæœ€åŸºæœ¬çš„é›†åˆæ¥å£ï¼Œæ‰€ä»£è¡¨çš„æ˜¯ä¸€ç§è§„åˆ™ï¼Œå®ƒæ‰€åŒ…å«çš„å…ƒç´ éƒ½å¿…é¡»éµå¾ªä¸€æ¡æˆ–è€…å¤šæ¡è§„åˆ™ã€‚å¦‚æœ‰äº›å…è®¸é‡å¤è€Œæœ‰äº›åˆ™ä¸èƒ½é‡å¤ã€æœ‰äº›å¿…é¡»è¦æŒ‰ç…§é¡ºåºæ’å…¥è€Œæœ‰äº›åˆ™æ˜¯æ•£åˆ—ï¼Œæœ‰äº›æ”¯æŒæ’åºä½†æ˜¯æœ‰äº›åˆ™ä¸æ”¯æŒã€‚</p><p>åœ¨Javaä¸­æ‰€æœ‰å®ç°äº†Collectionæ¥å£çš„ç±»éƒ½å¿…é¡»æä¾›ä¸¤å¥—æ ‡å‡†çš„æ„é€ å‡½æ•°ï¼Œä¸€ä¸ªæ˜¯æ— å‚ï¼Œç”¨äºåˆ›å»ºä¸€ä¸ªç©ºçš„Collectionï¼Œä¸€ä¸ªæ˜¯å¸¦æœ‰Collectionå‚æ•°çš„æœ‰å‚æ„é€ å‡½æ•°ï¼Œç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„Collectionï¼Œè¿™ä¸ªæ–°çš„Collectionä¸ä¼ å…¥è¿›æ¥çš„Collectionå…·å¤‡ç›¸åŒçš„å…ƒç´ ã€‚</p><h5 id="List"><a href="#List" class="headerlink" title="List"></a>List</h5><p>Listæ¥å£ï¼šæœ‰åºçš„Collectionï¼Œç”¨æŸç§ç‰¹å®šçš„æ’å…¥é¡ºåºæ¥ç»´æŠ¤å…ƒç´ é¡ºåºï¼›ç”¨æˆ·å¯ä»¥å¯¹åˆ—è¡¨ä¸­æ¯ä¸ªå…ƒç´ çš„æ’å…¥ä½ç½®è¿›è¡Œç²¾ç¡®åœ°æ§åˆ¶ï¼ŒåŒæ—¶å¯ä»¥æ ¹æ®å…ƒç´ çš„æ•´æ•°ç´¢å¼•ï¼ˆåœ¨åˆ—è¡¨ä¸­çš„ä½ç½®ï¼‰è®¿é—®å…ƒç´ ï¼Œå¹¶æœç´¢åˆ—è¡¨ä¸­çš„å…ƒç´ ã€‚</p><p>å®ç°Listæ¥å£çš„é›†åˆä¸»è¦æœ‰ï¼šArrayListã€LinkedListã€Vectorã€Stackã€‚</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311141634443.png" alt="image.png"></p><h5 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h5><p>Mapæ¥å£ï¼šç”±ä¸€ç³»åˆ—é”®å€¼å¯¹ç»„æˆçš„é›†åˆï¼Œæä¾›äº†keyåˆ°Valueçš„æ˜ å°„ã€‚åŒæ—¶å®ƒæ²¡æœ‰ç»§æ‰¿Collectionï¼›å®ƒä¿è¯äº†keyä¸valueä¹‹é—´çš„ä¸€ä¸€å¯¹åº”å…³ç³»ï¼Œä¸€ä¸ªkeyå¯¹åº”ä¸€ä¸ªvalueï¼Œå®ƒä¸èƒ½å­˜åœ¨ç›¸åŒçš„keyå€¼ï¼Œvalueå€¼å¯ä»¥ç›¸åŒã€‚</p><p>å®ç°mapçš„æœ‰ï¼šHashMapã€TreeMapã€HashTableã€Propertiesã€EnumMapã€‚</p><ul><li>HashMapï¼ˆJDK1.8åŠä»¥ä¸Šï¼‰<ul><li>åŸºäºå“ˆå¸Œè¡¨çš„Mapæ¥å£çš„éåŒæ­¥å®ç°</li><li>å…è®¸ä½¿ç”¨ null å€¼å’Œ null é”®</li><li>æ•°æ®ç»“æ„å¯ä»¥çœ‹æˆæ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘</li><li>é‡‡ç”¨äº†Fail-  Fastæœºåˆ¶</li></ul></li><li>Hashtable<ul><li>åŸºäºå“ˆå¸Œè¡¨çš„Mapæ¥å£çš„åŒæ­¥å®ç°, ä½¿ç”¨synchronizedå®ç°çº¿ç¨‹å®‰å…¨</li><li>ä¸å…è®¸ä½¿ç”¨nullå€¼å’Œnullé”®</li><li>åº•å±‚ä½¿ç”¨æ•°ç»„å®ç°ï¼Œæ•°ç»„ä¸­æ¯ä¸€é¡¹æ˜¯ä¸ªå•é“¾è¡¨ï¼Œå³æ•°ç»„å’Œé“¾è¡¨çš„ç»“åˆä½“</li></ul></li><li>ConcurrentHashMapï¼ˆJDK1.7ç‰ˆæœ¬ï¼‰<ul><li>é‡‡ç”¨æ•°ç»„+åˆ†æ®µé”çš„æ–¹å¼å®ç°</li><li>æ•°æ®ç»“æ„ï¼šSegment æ•°ç»„ + HashEntry æ•°ç»„ + é“¾è¡¨</li></ul></li><li>ConcurrentHashMapï¼ˆJDK1.8ç‰ˆæœ¬ï¼‰<ul><li>æ•°æ®ç»“æ„ï¼šNode æ•°ç»„ + é“¾è¡¨ &#x2F; çº¢é»‘æ ‘ã€‚</li><li>å½“å†²çªé“¾è¡¨è¾¾åˆ°ä¸€å®šé•¿åº¦æ—¶ï¼Œé“¾è¡¨ä¼šè½¬æ¢æˆçº¢é»‘æ ‘ã€‚</li></ul></li><li>TreeMap<ul><li>å®ç°äº†SortedMapæ¥å£ï¼Œé”®ä»¥æŸç§æ’åºè§„åˆ™æ’åº</li><li>å†…éƒ¨ä»¥red-blackï¼ˆçº¢-é»‘ï¼‰æ ‘æ•°æ®ç»“æ„å®ç°</li></ul></li><li>LinkedHashMap<ul><li>ç»§æ‰¿äºHashMap</li><li>éåŒæ­¥ï¼Œå…è®¸ä½¿ç”¨nullå€¼å’Œnullé”®</li><li>åº•å±‚ä½¿ç”¨å“ˆå¸Œè¡¨å’ŒåŒå‘é“¾è¡¨æ¥ä¿å­˜æ‰€æœ‰å…ƒç´ </li></ul></li><li>WeakHashMap<ul><li>æ”¯æŒnullå€¼å’Œnullé”®ï¼Œfast-failæœºåˆ¶ï¼Œä¸å…è®¸é‡å¤</li><li>keyåªä¿ç•™å¯¹å®é™…å¯¹è±¡çš„å¼±å¼•ç”¨ï¼Œå½“keyæ‰€å¼•ç”¨çš„å¯¹è±¡æ²¡æœ‰è¢«å…¶ä»–å¼ºå¼•ç”¨å˜é‡æ‰€å¼•ç”¨ï¼Œåˆ™è¿™äº›keyæ‰€å¼•ç”¨çš„å¯¹è±¡å¯èƒ½è¢«åƒåœ¾å›æ”¶ï¼ŒWeakHashMapä¹Ÿå¯èƒ½è‡ªåŠ¨åˆ é™¤è¿™äº›keyæ‰€å¯¹åº”çš„key-valueå¯¹ã€‚</li></ul></li><li>IdentifyHashMap<ul><li>åœ¨IdentityHashMapä¸­ï¼Œå½“ä¸”ä»…å½“ä¸¤ä¸ªkeyä¸¥æ ¼ç›¸ç­‰ï¼ˆkey1&#x3D;&#x3D; key2ï¼‰æ—¶ï¼ŒIdentityHashMapæ‰è®¤ä¸ºä¸¤ä¸ªkeyç›¸ç­‰ï¼›ç›¸å¯¹äºæ™®é€šHashMapè€Œè¨€ï¼Œåªè¦key1å’Œkey2é€šè¿‡equals()æ–¹æ³•è¿”å›trueï¼Œä¸”å®ƒä»¬çš„hashCodeå€¼ç›¸ç­‰å³å¯ã€‚</li></ul></li><li>EnumMap<ul><li>EnumMapæ˜¯ä¸€ä¸ªä¸æšä¸¾ç±»ä¸€èµ·ä½¿ç”¨çš„Mapå®ç°ï¼ŒEnumMapä¸­çš„æ‰€æœ‰keyéƒ½å¿…é¡»æ˜¯å•ä¸ªæšä¸¾ç±»çš„æšä¸¾å€¼ã€‚åˆ›å»ºEnumMapæ—¶å¿…é¡»æ˜¾ç¤ºæˆ–éšå¼çš„æŒ‡å®šå®ƒå¯¹åº”çš„æšä¸¾ç±»ã€‚</li></ul></li></ul><h5 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h5><p>Set æ¥å£ï¼šä¸åŒ…æ‹¬é‡å¤å…ƒç´ çš„Collectionï¼ŒåŒæ ·å…è®¸ nullçš„å­˜åœ¨ä½†æ˜¯ä»…æœ‰ä¸€ä¸ª</p><p>å®ç°äº†Setæ¥å£çš„é›†åˆæœ‰ï¼šEnumSetã€HashSetã€TreeSetã€‚</p><ul><li>HashSet<ul><li>åŸºäºHashMapå®ç°ï¼ŒAPI å¯¹ HashMapçš„è¡Œä¸ºè¿›è¡Œäº†å°è£…</li><li>å…è®¸ä½¿ç”¨nullå…ƒç´ </li></ul></li><li>LinkedHashSet<ul><li>ç»§æ‰¿äº HashSetã€åˆåŸºäºLinkedHashMapæ¥å®ç°</li><li>åº•å±‚ä½¿ç”¨LinkedHashMapæ¥ä¿å­˜æ‰€æœ‰å…ƒç´ ï¼Œå®ƒç»§æ‰¿äºHashSetï¼Œå…¶æ‰€æœ‰çš„æ–¹æ³•æ“ä½œä¸Šä¸HashSetç›¸åŒ</li></ul></li><li>TreeSet<ul><li>åŸºäºTreeMapï¼Œç”Ÿæˆä¸€ä¸ªæ€»æ˜¯å¤„äºæ’åºçŠ¶æ€çš„setï¼Œå†…éƒ¨ä»¥TreeMapæ¥å®ç°ã€‚</li><li>ä½¿ç”¨å…ƒç´ çš„è‡ªç„¶é¡ºåºå¯¹å…ƒç´ è¿›è¡Œæ’åºï¼Œæˆ–è€…æ ¹æ®åˆ›å»ºSet æ—¶æä¾›çš„  <code>Comparator</code> è¿›è¡Œæ’åº</li></ul></li><li>EnumSet<ul><li>æšä¸¾çš„ä¸“ç”¨Setã€‚æ‰€æœ‰çš„å…ƒç´ éƒ½æ˜¯æšä¸¾ç±»å‹</li></ul></li></ul><h5 id="Queue"><a href="#Queue" class="headerlink" title="Queue"></a>Queue</h5><p>é˜Ÿåˆ—ï¼Œä¸»è¦åˆ†ä¸ºä¸¤å¤§ç±»ï¼Œ</p><p>ä¸€ç±»æ˜¯é˜»å¡å¼é˜Ÿåˆ—ï¼Œé˜Ÿåˆ—æ»¡äº†ä»¥åå†æ’å…¥å…ƒç´ åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œä¸»è¦åŒ…æ‹¬ArrayBlockQueueã€PriorityBlockingQueueã€LinkedBlockingQueueã€‚</p><p>å¦ä¸€ç§é˜Ÿåˆ—åˆ™æ˜¯åŒç«¯é˜Ÿåˆ—ï¼Œæ”¯æŒåœ¨å¤´ã€å°¾ä¸¤ç«¯æ’å…¥å’Œç§»é™¤å…ƒç´ ï¼Œä¸»è¦åŒ…æ‹¬ï¼šArrayDequeã€LinkedBlockingDequeã€LinkedListã€‚</p>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>é›†åˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>hexoå®Œæˆgithub actionè‡ªåŠ¨éƒ¨ç½²</title>
    <link href="/2023/11/13/hexo%E5%AE%8C%E6%88%90github%20action%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2/"/>
    <url>/2023/11/13/hexo%E5%AE%8C%E6%88%90github%20action%E8%87%AA%E5%8A%A8%E9%83%A8%E7%BD%B2/</url>
    
    <content type="html"><![CDATA[<h3 id="hexoå®Œæˆgithub-actionè‡ªåŠ¨éƒ¨ç½²"><a href="#hexoå®Œæˆgithub-actionè‡ªåŠ¨éƒ¨ç½²" class="headerlink" title="hexoå®Œæˆgithub actionè‡ªåŠ¨éƒ¨ç½²"></a>hexoå®Œæˆgithub actionè‡ªåŠ¨éƒ¨ç½²</h3><p>è¿™é‡Œå®ç°çš„åŠŸèƒ½æ˜¯å»ºç«‹äº†ä¸€ä¸ªåˆ†æ”¯ ph-pages ï¼Œæºé¡¹ç›®å†…å®¹æ”¾åœ¨ master ä¸»åˆ†æ”¯ä¸‹ï¼Œå®ç°è‡ªåŠ¨éƒ¨ç½²ä¸»åˆ†æ”¯åˆ°åˆ†æ”¯ä¸Šï¼ˆåŒä¸€ä¸ªä»“åº“ä¸‹ï¼‰</p><p>åœ¨å®ç°è¿™ä¸ªå‰ï¼Œå…ˆè·å–ä¸€ä¸ªæˆæƒ tokenï¼Œè¿™é‡Œå¿…é¡»å‹¾é€‰repo é¡¹ å’Œ workflows é¡¹</p><p>è®¿é—® Github-&gt;å¤´åƒï¼ˆå³ä¸Šè§’ï¼‰-&gt;Settings-&gt;Developer Settings-&gt;Personal access tokens-&gt;generate new token,</p><p>åˆ›å»ºçš„ Token åç§°éšæ„ï¼Œæœ‰æ•ˆæœŸå»ºè®®æ— é™æœŸé™ã€‚</p><p>â€‹<img src="https://blogpublishpicture.oss-cn-guangzhou.aliyuncs.com/cnblogs/202306051602954.png" alt="image">â€‹</p><p>ç‚¹å‡»ç”Ÿæˆ</p><blockquote><p>token åªä¼šæ˜¾ç¤ºè¿™ä¸€æ¬¡ï¼Œä¹‹åå°†æ— æ³•æŸ¥çœ‹ï¼Œæ‰€ä»¥åŠ¡å¿…ä¿è¯ä½ å·²ç»è®°å½•ä¸‹äº† Tokenã€‚ä¹‹åå¦‚æœå¿˜è®°äº†å°±åªèƒ½é‡æ–°ç”Ÿæˆé‡æ–°é…ç½®äº†ã€‚</p></blockquote><p>åœ¨é¡¹ç›® master åˆ†æ”¯ä¸‹æ–°å»ºæ–‡ä»¶å¤¹</p><p>åœ¨ hexo é¡¹ç›® ä¸­æ–°å»º<code>.github</code>â€‹æ–‡ä»¶å¤¹,ç„¶ååœ¨<code>.github</code>â€‹ å†…æ–°å»º <code>workflows</code>â€‹ æ–‡ä»¶å¤¹ï¼Œå†åœ¨ <code>workflows</code>â€‹ æ–‡ä»¶å¤¹å†…æ–°å»º <code>autodeploy.yml</code>â€‹,</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs undefined">workflows<br>autodeploy.yml<br></code></pre></td></tr></table></figure><p>åœ¨<code>[Blogroot]/.github/workflows/autodeploy.yml</code>â€‹ é‡Œé¢è¾“å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs undefined">name: è‡ªåŠ¨éƒ¨ç½²<br># å½“æœ‰æ”¹åŠ¨æ¨é€åˆ°masteråˆ†æ”¯æ—¶ï¼Œå¯åŠ¨Action<br>on:<br>  push:<br>    branches:<br>      - master<br>      # ä½ æäº¤çš„ä¸»åˆ†æ”¯åç§°<br>  release:<br>    types:<br>      - published<br><br>jobs:<br>  # éƒ¨ç½²æ‰§è¡Œçš„è‡ªåŠ¨å·¥ä½œ<br>  deploy:<br>    runs-on: ubuntu-latest<br>    steps:<br>      - name: æ£€æŸ¥åˆ†æ”¯<br>        uses: actions/checkout@v3<br>        with:<br>          ref: master<br><br>      - name: å®‰è£… Node<br>        uses: actions/setup-node@v3<br>        with:<br>          node-version: &quot;16.x&quot;<br><br>      - name: å®‰è£… Hexo<br>        run: |<br>          export TZ=&#x27;Asia/Shanghai&#x27;<br>          npm install hexo-cli -g<br><br>      - name: ç¼“å­˜ Hexo<br>        id: cache-npm<br>        uses: actions/cache@v3<br>        env:<br>          cache-name: cache-node-modules<br>        with:<br>          path: node_modules<br>          key: $&#123;&#123; runner.os &#125;&#125;-build-$&#123;&#123; env.cache-name &#125;&#125;-$&#123;&#123; hashFiles(&#x27;**/package-lock.json&#x27;) &#125;&#125;<br>          restore-keys: |<br>            $&#123;&#123; runner.os &#125;&#125;-build-$&#123;&#123; env.cache-name &#125;&#125;-<br>            $&#123;&#123; runner.os &#125;&#125;-build-<br>            $&#123;&#123; runner.os &#125;&#125;-<br><br>      - name: å®‰è£…ä¾èµ–<br>        if: $&#123;&#123; steps.cache-npm.outputs.cache-hit != &#x27;true&#x27; &#125;&#125;<br>        run: |<br>          npm install gulp-cli -g #å…¨å±€å®‰è£…gulp<br>          npm install --save<br><br>      - name: ç”Ÿæˆé™æ€æ–‡ä»¶<br>        run: |<br>          hexo clean<br>          hexo generate<br><br>      - name: éƒ¨ç½²åˆ°Github<br>        uses: JamesIves/github-pages-deploy-action@v4<br>        with:<br>          token:  $&#123;&#123; secrets.ACTION_TOKEN &#125;&#125;<br>          repository-name: Lluo-liang/Lluo-liang.github.io<br>          branch: ph-pages<br>          folder: public<br>          commit-message: &quot;$&#123;&#123; github.event.head_commit.message &#125;&#125; Updated By Github Actions&quot;<br></code></pre></td></tr></table></figure><p>éƒ¨ç½²åˆ° Github ä¸‹å‡ ä¸ªé…ç½®æ³¨æ„ä¸€ä¸‹ï¼Œå…¶ä»–å†…å®¹å¤§å·®ä¸å·®</p><p>â€‹<img src="https://blogpublishpicture.oss-cn-guangzhou.aliyuncs.com/cnblogs/202306051602033.png" alt="image">â€‹</p><p>ä¹‹åå¦‚æœéœ€è¦è‡ªå·±åˆ°ä»“åº“çš„ Settings-&gt;Secrets-&gt;actions ä¸‹æ·»åŠ ç¯å¢ƒå˜é‡ï¼Œå˜é‡åå‚è€ƒè„šæœ¬ä¸­å‡ºç°çš„ï¼Œä¾æ¬¡æ·»åŠ ï¼ˆæœ‰äº›ç¯å¢ƒå˜é‡æ˜¯GitHub Actionsè‡ªå¸¦çš„ä¸€ä¸ªç¯å¢ƒå˜é‡ï¼‰ã€‚</p><p>è¿™é‡Œé…ç½®äº†ä¸€ä¸ª ACTION_TOKEN çš„ç¯å¢ƒå˜é‡</p><p>â€‹<img src="https://blogpublishpicture.oss-cn-guangzhou.aliyuncs.com/cnblogs/202306051602094.png" alt="image">â€‹</p><p>è¿™é‡Œçš„GitHub Pagesçš„è®¾ç½®ä¸­ æ˜¯ ph-pagesåˆ†æ”¯ã€‚</p><p>ç¼–è¾‘ä¸€ä¸‹ git ä¸Šä¼ çš„å±è”½é¡¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs undefined">.DS_Store<br>Thumbs.db<br>db.json<br>*.log<br>node_modules/<br>public/<br>.deploy*/<br>.deploy_git*/<br>.idea<br>themes/ocean/.git<br></code></pre></td></tr></table></figure><p>æ›¿æ¢æœ€åä¸€è¡Œå†…å®¹ä¸ºè‡ªå·±å½“å‰ä½¿ç”¨çš„ä¸»é¢˜</p><p>é…ç½®å®Œåè¿›è¡Œæäº¤æ¨é€</p><p>â€</p><p>éƒ¨ç½²è¿›åº¦æŸ¥çœ‹</p><p>çœ‹å®é™…çš„ä¸€ä¸ªéƒ¨ç½²æƒ…å†µï¼Œå¯ä»¥åœ¨ Action ä¸­ æŸ¥çœ‹</p><p>â€‹<img src="https://blogpublishpicture.oss-cn-guangzhou.aliyuncs.com/cnblogs/202306051602171.png" alt="image">â€‹</p><p>é€‰æ‹©ç¬¬ä¸€ä¸ªï¼Œç‚¹å‡»è¿›å»çœ‹ï¼Œç‚¹å‡» deploy å¯ä»¥æŸ¥çœ‹çª—å£è¿›åº¦å’Œå®é™…å®Œæˆæƒ…å†µ</p><p>â€‹<img src="https://blogpublishpicture.oss-cn-guangzhou.aliyuncs.com/cnblogs/202306051602232.png" alt="image">â€‹</p><p>â€</p><p>å¦‚æœæ˜¯éœ€è¦å®‰å…¨æ–¹é¢è€ƒè™‘ï¼Œä¸æ‰“ç®—å°†è‡ªå·±çš„æºæ–‡ä»¶å†…å®¹æ³„éœ²ï¼Œä¹Ÿå¯ä»¥å»ºç«‹å¦å¤–ä¸€ä¸ªä»“åº“ï¼Œè¿™ä¸ªä»“åº“è®¾ç½®ä¸ºç§æœ‰ï¼Œ</p><p>ä¹Ÿå¯ä»¥è¿›è¡Œè‡ªåŠ¨éƒ¨ç½²åˆ°è¿™ä¸ªå…¬å…±ä»“åº“ä¸­</p><p>â€</p>]]></content>
    
    
    <categories>
      
      <category>status pages</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Git å‘½ä»¤åŸºæœ¬æ“ä½œ</title>
    <link href="/2023/11/13/Git%20%E5%91%BD%E4%BB%A4%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/"/>
    <url>/2023/11/13/Git%20%E5%91%BD%E4%BB%A4%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/</url>
    
    <content type="html"><![CDATA[<h2 id="å°†æŸä¸ªç›®å½•æ–‡ä»¶ä¸Šä¼ åˆ°-Github-æŸä¸ªä»“åº“"><a href="#å°†æŸä¸ªç›®å½•æ–‡ä»¶ä¸Šä¼ åˆ°-Github-æŸä¸ªä»“åº“" class="headerlink" title="å°†æŸä¸ªç›®å½•æ–‡ä»¶ä¸Šä¼ åˆ° Github æŸä¸ªä»“åº“"></a>å°†æŸä¸ªç›®å½•æ–‡ä»¶ä¸Šä¼ åˆ° Github æŸä¸ªä»“åº“</h2><p>è¦å°†æŸä¸ªç›®å½•æ–‡ä»¶ä¸Šä¼ åˆ°GithubæŸä¸ªä»“åº“ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œæ“ä½œï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs undefined"># åˆå§‹åŒ–ä»“åº“<br>git init<br># æäº¤åˆ°æœ¬åœ°gitä»“åº“ å°†æ–‡ä»¶å¤¹ä¸­çš„å†…å®¹æ·»åŠ åˆ°gitä»“åº“<br>git add .<br># æäº¤åˆ°æœ¬åœ°gitä»“åº“,å¹¶æ·»åŠ ä¸€æ¡æäº¤ä¿¡æ¯<br>git commit -m &quot;Initial commit&quot;<br>#åœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå°†æœ¬åœ°gitä»“åº“ä¸Githubä¸Šçš„ä»“åº“è¿›è¡Œå…³è”<br>git remote add origin &lt;Githubä»“åº“URL&gt;<br># è¿›è¡Œæ¨é€<br>git push -u origin master<br># å¦‚æœç›®æ ‡ä»“åº“å’Œæœ¬åœ°ç›®å½•æ–‡ä»¶å†²çªï¼Œå¯ä»¥å…ˆæ‹‰å»æœ€æ–°ä»“åº“ä»£ç å†è¿›è¡Œæ¨é€<br>git pull origin master<br># æˆ–è€…ç›´æ¥å¼ºåˆ¶æ¨é€ï¼ˆä¼šç›´æ¥è¦†ç›–è¿œç¨‹ä»“åº“å†…å®¹ï¼‰ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¼ºåˆ¶æ¨é€å¯èƒ½ä¼šè¦†ç›–å…¶ä»–äººæäº¤çš„ä»£ç ï¼Œå› æ­¤éœ€è¦è°¨æ…ä½¿ç”¨ã€‚<br>git push --force origin master<br></code></pre></td></tr></table></figure><p>â€</p>]]></content>
    
    
    <categories>
      
      <category>éƒ¨ç½²</category>
      
    </categories>
    
    
    <tags>
      
      <tag>git</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Git é…ç½® SSH è¿æ¥</title>
    <link href="/2023/11/13/Git%20%E9%85%8D%E7%BD%AE%20SSH%20%E8%BF%9E%E6%8E%A5/"/>
    <url>/2023/11/13/Git%20%E9%85%8D%E7%BD%AE%20SSH%20%E8%BF%9E%E6%8E%A5/</url>
    
    <content type="html"><![CDATA[<h4 id="é…ç½®-SSH-è¿æ¥"><a href="#é…ç½®-SSH-è¿æ¥" class="headerlink" title="é…ç½® SSH è¿æ¥"></a>é…ç½® SSH è¿æ¥</h4><p>å›åˆ°Git Bashä¸­ï¼Œé…ç½®Githubè´¦æˆ·ä¿¡æ¯ï¼ˆ<code>ç”¨æˆ·å</code>â€‹å’Œ<code>é‚®ç®±</code>â€‹éƒ½æ›¿æ¢æˆä½ è‡ªå·±Githubä¸Šçš„ï¼‰ï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs text">git config --global user.name &quot;`ç”¨æˆ·å`&quot;<br>git config --global user.email &quot;é‚®ç®±&quot;<br></code></pre></td></tr></table></figure><p>åœ¨Git Bashä¸­è¾“å…¥ï¼š<code>ssh-keygen -t rsa -C &quot;ä½ çš„Githubé‚®ç®±&quot;</code>â€‹ ç”Ÿæˆssh</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">ssh-keygen -t rsa -C &quot;é‚®ç®±&quot;<br></code></pre></td></tr></table></figure><p>ç„¶åæŒ‰Git Bashç»™å‡ºçš„è·¯å¾„<code>(C:\Users\Lete.ssh)</code>â€‹æ‰¾åˆ°<code>id_rsa.pub</code>â€‹æ–‡ä»¶ å¹¶å¤åˆ¶å…¶ä¸­çš„å†…å®¹</p><p>è¿›åˆ°æ–°å»ºçš„Githubä»“åº“ ç‚¹å‡»å³ä¸Šè§’<code>setting</code>â€‹è¿›å…¥è®¾ç½®æ‰¾åˆ°<code>Deploykeys</code>â€‹é€‰æ‹© <code>Add Deploy keys</code>â€‹ <code>Title</code>â€‹éšä¾¿å¡«å†™ <code>Key</code>â€‹çš„å†…å®¹å¡«åˆšæ‰<code>id_rsa.pub</code>â€‹æ–‡ä»¶ä¸­å¤åˆ¶çš„å†…å®¹</p><p>â€</p><p>ä¿®æ”¹æœ¬åœ°Gité…ç½®ï¼Œè®¾ç½®ä½¿ç”¨SSHåè®®è¿æ¥GitHubã€‚ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä¿®æ”¹æœ¬åœ°Gité…ç½®ï¼š</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scss">git config <span class="hljs-attr">--global</span> url.&quot;git<span class="hljs-keyword">@github</span>.<span class="hljs-attribute">com</span>:<span class="hljs-string">&quot;.insteadOf &quot;</span><span class="hljs-attribute">https</span>://github.com/<span class="hljs-string">&quot;</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªå‘½ä»¤ä¼šå°†Gité…ç½®ä¸­çš„ <code>https://github.com/</code>â€‹ æ›¿æ¢ä¸º <code>git@github.com:</code>â€‹ï¼Œä»è€Œä½¿ç”¨SSHåè®®è¿æ¥GitHubã€‚</p><p>é…ç½®åå†éƒ¨ç½²æäº¤</p>]]></content>
    
    
    <categories>
      
      <category>éƒ¨ç½²</category>
      
    </categories>
    
    
    <tags>
      
      <tag>git</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
