<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>obsidianå¸¸ç”¨æ’ä»¶ä½¿ç”¨è®°å½•</title>
    <link href="/2024/01/12/obsidian%E5%B8%B8%E7%94%A8%E6%8F%92%E4%BB%B6%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/"/>
    <url>/2024/01/12/obsidian%E5%B8%B8%E7%94%A8%E6%8F%92%E4%BB%B6%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<p>æ’ä»¶åŠŸèƒ½</p><ul><li>å¯¼å‡º pdf å¸¦ä¸Šç›®å½•</li></ul><hr><h4 id="1ã€å¯¼å‡º-pdf-å¸¦ä¸Šç›®å½•"><a href="#1ã€å¯¼å‡º-pdf-å¸¦ä¸Šç›®å½•" class="headerlink" title="1ã€å¯¼å‡º pdf å¸¦ä¸Šç›®å½•"></a>1ã€å¯¼å‡º pdf å¸¦ä¸Šç›®å½•</h4><p>ä½¿ç”¨ better-export-pdf å¯¼å‡º pdf å¸¦ä¸Šç›®å½•</p><p>è¿™ä¸ªæ’ä»¶éœ€è¦ä¸‹è½½ä½¿ç”¨ï¼Œä¸‹è½½åœ°å€ï¼š  <a href="https://github.com/l1xnan/obsidian-better-export-pdf/releases">https://github.com/l1xnan/obsidian-better-export-pdf/releases</a></p><p>ä¸‹è½½å¯¹åº”çš„ obsidian-better-export-pdf.zip æ–‡ä»¶å³å¯ã€‚</p><p>å‚è€ƒï¼š <a href="https://pkmer.cn/Pkmer-Docs/10-obsidian/obsidian%E7%A4%BE%E5%8C%BA%E6%8F%92%E4%BB%B6/better-export-pdf/">https://pkmer.cn/Pkmer-Docs/10-obsidian/obsidian%E7%A4%BE%E5%8C%BA%E6%8F%92%E4%BB%B6/better-export-pdf/</a></p><hr>]]></content>
    
    
    <categories>
      
      <category>å·¥å…·</category>
      
    </categories>
    
    
    <tags>
      
      <tag>obsidian</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>centos7ç³»ç»Ÿ_å¸¸ç”¨æ“ä½œ</title>
    <link href="/2024/01/12/centos7%E7%B3%BB%E7%BB%9F_%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/"/>
    <url>/2024/01/12/centos7%E7%B3%BB%E7%BB%9F_%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/</url>
    
    <content type="html"><![CDATA[<h3 id="1ã€é˜²ç«å¢™"><a href="#1ã€é˜²ç«å¢™" class="headerlink" title="1ã€é˜²ç«å¢™"></a>1ã€é˜²ç«å¢™</h3><blockquote><p>æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€</p></blockquote><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">firewall-cmd <span class="hljs-comment">--state</span><br></code></pre></td></tr></table></figure><p>å¸¸ç”¨æ“ä½œ</p><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs nsis"><span class="hljs-params">system</span>ctl stop firewalld   <span class="hljs-comment"># å…³é—­é˜²ç«å¢™</span><br><span class="hljs-params">system</span>ctl start firewalld  <span class="hljs-comment"># å¯åŠ¨é˜²ç«å¢™</span><br>firewall-cmd --reload      <span class="hljs-comment"># é‡å¯é˜²ç«å¢™</span><br><span class="hljs-params">system</span>ctl disable firewalld  <span class="hljs-comment"># ç¦ç”¨é˜²ç«å¢™</span><br></code></pre></td></tr></table></figure><blockquote><p>å¼€æ”¾é˜²ç«å¢™ç«¯å£</p></blockquote><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">firewall-<span class="hljs-keyword">cmd</span><span class="language-bash"> --query-port=80/tcp   <span class="hljs-comment">#ç«¯å£å¼€æ”¾æƒ…å†µ</span></span><br>firewall-<span class="hljs-keyword">cmd</span><span class="language-bash"> --permanent --list-ports  <span class="hljs-comment">#æŸ¥çœ‹å¼€æ”¾çš„ç«¯å£</span></span><br><br><span class="hljs-comment">#å¼€æ”¾ç«¯å£</span><br>firewall-<span class="hljs-keyword">cmd</span><span class="language-bash"> --permanent --add-port=8080/tcp</span><br>firewall-<span class="hljs-keyword">cmd</span><span class="language-bash"> --permanent --add-port=8083-8085/tcp</span><br><br><span class="hljs-comment">#å…³é—­ç«¯å£</span><br>firewall-<span class="hljs-keyword">cmd</span><span class="language-bash"> --permanent --remove-port=8083-8085/tcp</span><br></code></pre></td></tr></table></figure><p>ç«¯å£å¼€æ”¾åå»ºè®®é‡å¯ä¸€ä¸‹é˜²ç«å¢™</p><h3 id="2ã€æŸ¥çœ‹æœåŠ¡å™¨çŠ¶æ€"><a href="#2ã€æŸ¥çœ‹æœåŠ¡å™¨çŠ¶æ€" class="headerlink" title="2ã€æŸ¥çœ‹æœåŠ¡å™¨çŠ¶æ€"></a>2ã€æŸ¥çœ‹æœåŠ¡å™¨çŠ¶æ€</h3><p>å¸¸ç”¨çš„Linuxå‘½ä»¤ï¼š</p><h4 id="CPUä½¿ç”¨æƒ…å†µ"><a href="#CPUä½¿ç”¨æƒ…å†µ" class="headerlink" title="CPUä½¿ç”¨æƒ…å†µ"></a>CPUä½¿ç”¨æƒ…å†µ</h4><ol><li><p><strong>top</strong>:</p><ul><li><code>top</code> å‘½ä»¤ç”¨äºå®æ—¶æ˜¾ç¤ºç³»ç»Ÿä¸­å„ä¸ªè¿›ç¨‹çš„èµ„æºå ç”¨çŠ¶å†µã€‚</li><li>å®ƒæ˜¾ç¤ºçš„ä¿¡æ¯åŒ…æ‹¬ç³»ç»Ÿè¿è¡Œæ—¶é—´ã€å½“å‰ç™»å½•ç”¨æˆ·æ•°ã€ç³»ç»Ÿè´Ÿè½½ã€è¿›ç¨‹æ€»æ•°ã€CPUä½¿ç”¨ç‡ã€å†…å­˜ä½¿ç”¨ç‡ç­‰ã€‚</li></ul></li><li><p><strong>vmstat</strong>:</p><ul><li><code>vmstat</code>ï¼ˆVirtual Memory Statisticsï¼‰å‘½ä»¤ç”¨äºå±•ç¤ºè™šæ‹Ÿå†…å­˜ã€è¿›ç¨‹ã€CPUæ´»åŠ¨ç­‰ä¿¡æ¯ã€‚</li><li>ä¾‹å¦‚ï¼š<code>vmstat 1 5</code> æ¯1ç§’åˆ·æ–°ä¸€æ¬¡ï¼Œå…±æ˜¾ç¤º5æ¬¡æ•°æ®ã€‚</li></ul></li></ol><h4 id="å†…å­˜ä½¿ç”¨æƒ…å†µ"><a href="#å†…å­˜ä½¿ç”¨æƒ…å†µ" class="headerlink" title="å†…å­˜ä½¿ç”¨æƒ…å†µ"></a>å†…å­˜ä½¿ç”¨æƒ…å†µ</h4><ol><li><p><strong>free</strong>:</p><ul><li><code>free</code> å‘½ä»¤ç”¨äºæ˜¾ç¤ºç³»ç»Ÿçš„ç©ºé—²ã€ä½¿ç”¨ä¸­å’Œäº¤æ¢å†…å­˜çš„ä¿¡æ¯ã€‚</li><li>ä¾‹å¦‚ï¼š<code>free -h</code> æ˜¾ç¤ºæ˜“äºé˜…è¯»çš„æ ¼å¼ã€‚</li></ul></li><li><p><strong>htop</strong>:</p><ul><li><code>htop</code> æ˜¯ <code>top</code> å‘½ä»¤çš„ä¸€ä¸ªå¢å¼ºç‰ˆæœ¬ï¼Œæä¾›äº†æ›´å¤šä¿¡æ¯ï¼Œç•Œé¢æ›´å‹å¥½ã€‚</li><li>å®ƒéœ€è¦åœ¨æŸäº›Linuxå‘è¡Œç‰ˆä¸Šå•ç‹¬å®‰è£…ã€‚</li></ul></li></ol><h4 id="ç£ç›˜ä½¿ç”¨æƒ…å†µ"><a href="#ç£ç›˜ä½¿ç”¨æƒ…å†µ" class="headerlink" title="ç£ç›˜ä½¿ç”¨æƒ…å†µ"></a>ç£ç›˜ä½¿ç”¨æƒ…å†µ</h4><ol><li><p><strong>df</strong>:</p><ul><li><code>df</code>ï¼ˆDisk Freeï¼‰å‘½ä»¤ç”¨äºæ˜¾ç¤ºç³»ç»Ÿä¸­æ¯ä¸ªæ–‡ä»¶ç³»ç»Ÿçš„æ€»ç©ºé—´ã€å·²ç”¨ç©ºé—´å’Œå¯ç”¨ç©ºé—´ã€‚</li><li>ä¾‹å¦‚ï¼š<code>df -h</code> æ˜¾ç¤ºæ˜“äºé˜…è¯»çš„æ ¼å¼ã€‚</li></ul></li><li><p><strong>du</strong>:</p><ul><li><code>du</code>ï¼ˆDisk Usageï¼‰å‘½ä»¤ç”¨äºæ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶æˆ–ç›®å½•å ç”¨çš„ç£ç›˜ç©ºé—´ã€‚</li><li>ä¾‹å¦‚ï¼š<code>du -sh /path/to/directory</code> æ˜¾ç¤ºæŒ‡å®šç›®å½•çš„æ€»ç©ºé—´å ç”¨ã€‚</li></ul></li></ol><h4 id="ç½‘ç»œä½¿ç”¨æƒ…å†µ"><a href="#ç½‘ç»œä½¿ç”¨æƒ…å†µ" class="headerlink" title="ç½‘ç»œä½¿ç”¨æƒ…å†µ"></a>ç½‘ç»œä½¿ç”¨æƒ…å†µ</h4><ol><li><p><strong>netstat</strong>:</p><ul><li><code>netstat</code> å‘½ä»¤ç”¨äºæ˜¾ç¤ºç½‘ç»œè¿æ¥ã€è·¯ç”±è¡¨ã€æ¥å£ç»Ÿè®¡ç­‰ç½‘ç»œä¿¡æ¯ã€‚</li><li>ä¾‹å¦‚ï¼š<code>netstat -tulnp</code> æ˜¾ç¤ºæ‰€æœ‰ç›‘å¬ç«¯å£ã€‚</li></ul></li><li><p><strong>ss</strong>:</p><ul><li><code>ss</code>ï¼ˆSocket Statisticsï¼‰å‘½ä»¤æ˜¯ <code>netstat</code> çš„ä¸€ä¸ªç°ä»£æ›¿ä»£å“ï¼Œç”¨äºæ˜¾ç¤ºå¥—æ¥å­—ç»Ÿè®¡ä¿¡æ¯ã€‚</li><li>ä¾‹å¦‚ï¼š<code>ss -tuln</code> æ˜¾ç¤ºç›‘å¬ç«¯å£ã€‚</li></ul></li></ol><h4 id="ç³»ç»Ÿæ´»åŠ¨å’Œæ€§èƒ½"><a href="#ç³»ç»Ÿæ´»åŠ¨å’Œæ€§èƒ½" class="headerlink" title="ç³»ç»Ÿæ´»åŠ¨å’Œæ€§èƒ½"></a>ç³»ç»Ÿæ´»åŠ¨å’Œæ€§èƒ½</h4><ol><li><p><strong>sar</strong>:</p><ul><li><code>sar</code> å‘½ä»¤ç”¨äºæ”¶é›†ã€æŠ¥å‘Šæˆ–ä¿å­˜ç³»ç»Ÿæ´»åŠ¨ä¿¡æ¯ï¼Œå®ƒæ˜¯sysstatåŒ…çš„ä¸€éƒ¨åˆ†ã€‚</li><li>ä¾‹å¦‚ï¼š<code>sar -u 1 5</code> æ¯ç§’æŠ¥å‘Šä¸€æ¬¡CPUä½¿ç”¨æƒ…å†µï¼Œå…±æŠ¥å‘Š5æ¬¡ã€‚</li></ul></li><li><p><strong>iostat</strong>:</p><ul><li><code>iostat</code> å‘½ä»¤ç”¨äºæ˜¾ç¤ºCPUç»Ÿè®¡ä¿¡æ¯å’Œæ‰€æœ‰åˆ†åŒºçš„I&#x2F;Oç»Ÿè®¡ä¿¡æ¯ã€‚</li><li>å®ƒæœ‰åŠ©äºç›‘æ§ç³»ç»Ÿçš„è¾“å…¥&#x2F;è¾“å‡ºè®¾å¤‡è´Ÿè½½ã€‚</li></ul></li></ol>]]></content>
    
    
    <categories>
      
      <category>æ“ä½œç³»ç»Ÿ</category>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Dockerå…¥é—¨_Dockerçš„åŸºæœ¬ä½¿ç”¨</title>
    <link href="/2024/01/12/Docker%E5%85%A5%E9%97%A8_Docker%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/"/>
    <url>/2024/01/12/Docker%E5%85%A5%E9%97%A8_Docker%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h3 id="1ã€å®‰è£…-Dockeræ“ä½œ-centosç³»åˆ—å®‰è£…"><a href="#1ã€å®‰è£…-Dockeræ“ä½œ-centosç³»åˆ—å®‰è£…" class="headerlink" title="1ã€å®‰è£… Dockeræ“ä½œ (centosç³»åˆ—å®‰è£…)"></a>1ã€å®‰è£… Dockeræ“ä½œ (centosç³»åˆ—å®‰è£…)</h3><p>å®‰è£…æ“ä½œ</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs vim">yum install -<span class="hljs-keyword">y</span> yum-utils<br><br>yum-config-manager --<span class="hljs-built_in">add</span>-repo http://mirrors.aliyun.<span class="hljs-keyword">com</span>/docker-<span class="hljs-keyword">ce</span>/linux/centos/docker-<span class="hljs-keyword">ce</span>.repo<br><br><br>yum install docker-<span class="hljs-keyword">ce</span> docker-<span class="hljs-keyword">ce</span>-cli containerd.io<br></code></pre></td></tr></table></figure><p>å¯åŠ¨docerå¹¶è®¾ç½®å¼€æœºè‡ªå¯</p><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs nsis"><span class="hljs-params">system</span>ctl start docker<br><br><span class="hljs-params">system</span>ctl enable docker<br></code></pre></td></tr></table></figure><p>dockeré…ç½®åŠ é€Ÿåº¦</p><p>ä¿®æ”¹ &#x2F;etc&#x2F;docker&#x2F;daemon.json æ–‡ä»¶å¹¶æ·»åŠ ä¸Š registry-mirrors é”®å€¼ï¼›æ³¨å†Œé˜¿é‡Œäº‘ï¼Œå¯è·å–è‡ªå·±çš„åŠ é€Ÿå™¨</p><p>å®¹å™¨é•œåƒæœåŠ¡ â†’  å®¹å™¨åŠ é€Ÿå™¨</p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs prolog">&#123;. <br>    <span class="hljs-string">&quot;registry-mirrors&quot;</span>: [<span class="hljs-string">&quot;https://registry.docker-cn.com&quot;</span>]<br>&#125;<br></code></pre></td></tr></table></figure><p>dockerå®‰è£…éªŒè¯</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">docker <span class="hljs-comment">--version</span><br></code></pre></td></tr></table></figure><h3 id="2ã€docker-composeå®‰è£…"><a href="#2ã€docker-composeå®‰è£…" class="headerlink" title="2ã€docker-composeå®‰è£…"></a>2ã€docker-composeå®‰è£…</h3><p>Compose æ˜¯ç”¨äºå®šä¹‰å’Œè¿è¡Œå¤šå®¹å™¨ Docker åº”ç”¨ç¨‹åºçš„å·¥å…·ã€‚é€šè¿‡ Composeï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ YML æ–‡ä»¶æ¥é…ç½®åº”ç”¨ç¨‹åºéœ€è¦çš„æ‰€æœ‰æœåŠ¡ã€‚</p><p>ä½¿ç”¨ä¸€ä¸ªå‘½ä»¤ï¼Œå°±å¯ä»¥ä» YML æ–‡ä»¶é…ç½®ä¸­åˆ›å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡</p><blockquote><p>å®‰è£…æ“ä½œ</p></blockquote><p>å…ˆéœ€è¦ä¸‹è½½ä¸€ä¸‹äºŒè¿›åˆ¶æ–‡ä»¶</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/docker/</span>compose<span class="hljs-regexp">/releases/</span>download<span class="hljs-regexp">/v2.5.0/</span>docker-compose-linux-x86_64<br></code></pre></td></tr></table></figure><p>æ”¾å…¥&#x2F;usr&#x2F;local&#x2F;bin&#x2F; è·¯å¾„ä¸‹å¹¶é‡æ–°å‘½åæ·»åŠ å¯æ‰§è¡Œæƒé™</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mv</span> docker-compose-linux-x86_64 docker-compose<br><span class="hljs-built_in">chmod</span> +x docker-compose<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªä¹Ÿå¯ä»¥æ¨èçœ‹ä¸€ä¸‹</p><p>å°†è„šæœ¬ä¸‹è½½ï¼Œé˜¿é‡Œäº‘çš„ä¸‹è½½é€Ÿåº¦è¾ƒå¿«ï¼Œæ¨èé€‚ç”¨</p><p><a href="https://mirrors.aliyun.com/docker-toolbox/linux/compose/1.21.2/">https://mirrors.aliyun.com/docker-toolbox/linux/compose/1.21.2/</a></p><p>æŠŠè„šæœ¬æ”¾åœ¨&#x2F;usr&#x2F;local&#x2F;bin&#x2F;ä¸‹.åå­—ä¸ºdocker-compose ,åŠ æ‰§è¡Œæƒé™ ï¼Œdocker-composeå‘½ä»¤å°±æœ‰äº†</p><h3 id="3ã€docker-å®‰è£…-redis-æ“ä½œ"><a href="#3ã€docker-å®‰è£…-redis-æ“ä½œ" class="headerlink" title="3ã€docker å®‰è£… redis æ“ä½œ"></a>3ã€docker å®‰è£… redis æ“ä½œ</h3><p>å®‰è£… Redis ä½¿ç”¨ Docker æ˜¯ä¸€ä¸ªéå¸¸ç®€å•ä¸”å¿«æ·çš„è¿‡ç¨‹ã€‚ä»¥ä¸‹æ˜¯é€šè¿‡ Docker å®‰è£…å’Œè¿è¡Œ Redis çš„åŸºæœ¬æ­¥éª¤ï¼š</p><ol><li><p><strong>æ‹‰å– Redis é•œåƒ</strong>ï¼š é¦–å…ˆï¼Œä½ éœ€è¦ä» Docker Hub æ‹‰å–æœ€æ–°çš„ Redis é•œåƒã€‚æ‰“å¼€å‘½ä»¤è¡Œç•Œé¢ï¼Œç„¶åè¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š</p><p> <code>docker pull redis</code></p><p> è¿™ä¸ªå‘½ä»¤ä¼šä» Docker Hub ä¸‹è½½æœ€æ–°çš„ Redis é•œåƒã€‚</p></li><li><p><strong>è¿è¡Œ Redis å®¹å™¨</strong>ï¼š æ¥ç€ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥å¯åŠ¨ä¸€ä¸ª Redis å®¹å™¨ï¼š</p><p> <code>docker run --name redis -d redis</code></p><p> è¿™é‡Œï¼Œ<code>--name redis</code> è®¾ç½®å®¹å™¨çš„åç§°ä¸º <code>some-redis</code>ã€‚ä½ å¯ä»¥æ ¹æ®éœ€è¦æ›´æ”¹è¿™ä¸ªåç§°ã€‚<code>-d</code> å‚æ•°è¡¨ç¤ºå®¹å™¨å°†åœ¨åå°è¿è¡Œã€‚</p></li><li><p><strong>æš´éœ²å’Œæ˜ å°„ç«¯å£</strong>ï¼ˆå¯é€‰ï¼‰ï¼š å¦‚æœä½ æ‰“ç®—ä»å®¿ä¸»æœºå¤–éƒ¨è®¿é—® Redisï¼Œä½ éœ€è¦æ˜ å°„ç«¯å£ã€‚Redis é»˜è®¤ç«¯å£æ˜¯ <code>6379</code>ï¼Œæ‰€ä»¥ä½ å¯ä»¥è¿™æ ·æ˜ å°„ç«¯å£ï¼š</p><p> <code>docker run --name redis -d -p 6379:6379 redis</code></p><p> <code>-p 6379:6379</code> è¡¨ç¤ºå°†å®¹å™¨çš„ 6379 ç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœºçš„ 6379 ç«¯å£ã€‚</p></li><li><p><strong>è®¿é—® Redis</strong>ï¼š ä¸€æ—¦ Redis å®¹å™¨åœ¨è¿è¡Œï¼Œä½ å¯ä»¥é€šè¿‡ Redis å®¢æˆ·ç«¯æˆ–ä»»ä½•æ”¯æŒ Redis çš„ç¨‹åºè®¿é—®å®ƒã€‚å¦‚æœä½ åªæ˜¯åœ¨æœ¬åœ°æœºå™¨ä¸Šè¿è¡Œå’Œè®¿é—® Redisï¼Œä½ å¯ä»¥é€šè¿‡ <code>localhost:6379</code> æ¥è®¿é—®å®ƒã€‚</p></li><li><p><strong>ä½¿ç”¨ Redis CLI è¿›è¡Œäº¤äº’</strong>ï¼ˆå¯é€‰ï¼‰ï¼š å¦‚æœä½ æƒ³è¦é€šè¿‡ Redis å‘½ä»¤è¡Œç•Œé¢ä¸ Redis å®¹å™¨äº¤äº’ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿›å…¥ Redis å®¹å™¨ï¼š</p><p> <code>docker exec -it some-redis redis-cli</code></p></li></ol><p>å°ç»“ï¼š</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">docker pull redis<br>docker <span class="hljs-keyword">run</span><span class="language-bash"> --name redis -d -p 6379:6379 redis</span><br>firewall-<span class="hljs-keyword">cmd</span><span class="language-bash"> --permanent --add-port=6379/tcp</span><br>firewall-<span class="hljs-keyword">cmd</span><span class="language-bash"> --reload      <span class="hljs-comment"># é‡å¯é˜²ç«å¢™</span></span><br></code></pre></td></tr></table></figure><h3 id="4ã€docker-çš„ä¸€äº›å¸¸ç”¨å‘½ä»¤-ğŸ¦Œ"><a href="#4ã€docker-çš„ä¸€äº›å¸¸ç”¨å‘½ä»¤-ğŸ¦Œ" class="headerlink" title="4ã€docker çš„ä¸€äº›å¸¸ç”¨å‘½ä»¤   ğŸ¦Œ"></a>4ã€docker çš„ä¸€äº›å¸¸ç”¨å‘½ä»¤   ğŸ¦Œ</h3><p>å¸¸ç”¨çš„Dockerå‘½ä»¤ï¼š</p><h4 id="å®¹å™¨ç®¡ç†"><a href="#å®¹å™¨ç®¡ç†" class="headerlink" title="å®¹å™¨ç®¡ç†"></a>å®¹å™¨ç®¡ç†</h4><p>1ã€ <strong>å¯åŠ¨å®¹å™¨</strong>:</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">docker run <span class="hljs-selector-attr">[OPTIONS]</span> IMAGE <span class="hljs-selector-attr">[COMMAND]</span> <span class="hljs-selector-attr">[ARG...]</span><br></code></pre></td></tr></table></figure><p>ä¾‹å¦‚ï¼š<code>docker run -d -p 80:80 nginx</code> ä¼šä»¥å®ˆæŠ¤æ€è¿è¡Œä¸€ä¸ªnginxå®¹å™¨ï¼Œå¹¶å°†æœ¬æœºçš„80ç«¯å£æ˜ å°„åˆ°å®¹å™¨çš„80ç«¯å£ã€‚</p><p>2ã€<strong>åˆ—å‡ºå®¹å™¨</strong>:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">docker</span> ps<span class="hljs-meta"> [OPTIONS]</span><br></code></pre></td></tr></table></figure><ul><li>åªæ˜¾ç¤ºè¿è¡Œä¸­çš„å®¹å™¨ï¼š<code>docker ps</code></li><li>æ˜¾ç¤ºæ‰€æœ‰å®¹å™¨ï¼ˆåŒ…æ‹¬æœªè¿è¡Œçš„ï¼‰ï¼š<code>docker ps -a</code></li></ul><p>3ã€ <strong>åœæ­¢å®¹å™¨</strong>:</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs inform7">docker stop <span class="hljs-comment">[OPTIONS]</span> <span class="hljs-keyword">CONTAINER</span> <span class="hljs-comment">[CONTAINER...]</span><br></code></pre></td></tr></table></figure><ul><li>ä¾‹å¦‚ï¼š<code>docker stop my_container</code> åœæ­¢åä¸º <code>my_container</code> çš„å®¹å™¨ã€‚</li></ul><p>4ã€<strong>åˆ é™¤å®¹å™¨</strong>:</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs inform7">docker rm <span class="hljs-comment">[OPTIONS]</span> <span class="hljs-keyword">CONTAINER</span> <span class="hljs-comment">[CONTAINER...]</span><br></code></pre></td></tr></table></figure><ul><li>ä¾‹å¦‚ï¼š<code>docker rm my_container</code> åˆ é™¤åä¸º <code>my_container</code> çš„å®¹å™¨ã€‚</li></ul><p>5ã€<strong>æŸ¥çœ‹å®¹å™¨æ—¥å¿—</strong>:</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs inform7">docker logs <span class="hljs-comment">[OPTIONS]</span> <span class="hljs-keyword">CONTAINER</span><br></code></pre></td></tr></table></figure><ul><li>ä¾‹å¦‚ï¼š<code>docker logs my_container</code> æŸ¥çœ‹åä¸º <code>my_container</code> çš„å®¹å™¨çš„æ—¥å¿—ã€‚</li></ul><p>6ã€é‡å¯ docker å®¹å™¨</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs inform7">docker restart <span class="hljs-comment">[OPTIONS]</span> <span class="hljs-keyword">CONTAINER</span> <span class="hljs-comment">[CONTAINER...]</span><br></code></pre></td></tr></table></figure><p>å¦‚æœä½ çš„å®¹å™¨åç§°æ˜¯ <code>my_container</code>ï¼Œé‚£ä¹ˆé‡å¯è¿™ä¸ªå®¹å™¨çš„å‘½ä»¤å°†æ˜¯ï¼š</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">docker restart my_container</span><br></code></pre></td></tr></table></figure><h4 id="é•œåƒç®¡ç†"><a href="#é•œåƒç®¡ç†" class="headerlink" title="é•œåƒç®¡ç†"></a>é•œåƒç®¡ç†</h4><p>1ã€<strong>åˆ—å‡ºé•œåƒ</strong>:</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs inform7">docker images <span class="hljs-comment">[OPTIONS]</span> <span class="hljs-comment">[REPOSITORY<span class="hljs-comment">[:TAG]</span>]</span><br></code></pre></td></tr></table></figure><ul><li>ä¾‹å¦‚ï¼š<code>docker images</code> åˆ—å‡ºæ‰€æœ‰æœ¬åœ°é•œåƒã€‚</li></ul><p>2ã€<strong>æ‹‰å–é•œåƒ</strong>:</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs elixir">docker pull [<span class="hljs-title class_">OPTIONS</span>] <span class="hljs-title class_">NAME</span>[<span class="hljs-symbol">:TAG|</span><span class="hljs-variable">@DIGEST</span>]<br></code></pre></td></tr></table></figure><ul><li>ä¾‹å¦‚ï¼š<code>docker pull nginx</code> æ‹‰å–æœ€æ–°çš„nginxé•œåƒã€‚</li></ul><p>3ã€<strong>æ„å»ºé•œåƒ</strong>:</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">docker build [OPTIONS] PATH |<span class="hljs-string"> URL </span>|<span class="hljs-string"> -</span><br></code></pre></td></tr></table></figure><ul><li>ä¾‹å¦‚ï¼š<code>docker build -t my_image .</code> ä¼šæ ¹æ®å½“å‰ç›®å½•ä¸‹çš„ <code>Dockerfile</code> æ„å»ºä¸€ä¸ªåä¸º <code>my_image</code> çš„é•œåƒã€‚</li></ul><p>4ã€ <strong>åˆ é™¤é•œåƒ</strong>:</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">docker rmi <span class="hljs-selector-attr">[OPTIONS]</span> IMAGE <span class="hljs-selector-attr">[IMAGE...]</span><br></code></pre></td></tr></table></figure><ul><li>ä¾‹å¦‚ï¼š<code>docker rmi my_image</code> åˆ é™¤åä¸º <code>my_image</code> çš„é•œåƒã€‚</li></ul><h4 id="ç½‘ç»œç®¡ç†"><a href="#ç½‘ç»œç®¡ç†" class="headerlink" title="ç½‘ç»œç®¡ç†"></a>ç½‘ç»œç®¡ç†</h4><ol><li><p><strong>åˆ—å‡ºç½‘ç»œ</strong>:</p><p> <code>docker network ls</code></p></li><li><p><strong>åˆ›å»ºç½‘ç»œ</strong>:</p><p> <code>docker network create [OPTIONS] NETWORK  </code></p><ul><li>ä¾‹å¦‚ï¼š<code>docker network create my_network</code> åˆ›å»ºä¸€ä¸ªåä¸º <code>my_network</code> çš„ç½‘ç»œã€‚</li></ul></li><li><p><strong>åˆ é™¤ç½‘ç»œ</strong>:</p><p> <code>docker network rm NETWORK</code></p><ul><li>ä¾‹å¦‚ï¼š<code>docker network rm my_network</code> åˆ é™¤åä¸º <code>my_network</code> çš„ç½‘ç»œã€‚</li></ul></li></ol><h4 id="å·ç®¡ç†"><a href="#å·ç®¡ç†" class="headerlink" title="å·ç®¡ç†"></a>å·ç®¡ç†</h4><ol><li><p><strong>åˆ›å»ºå·</strong>:</p><p> <code>docker volume create [OPTIONS] [VOLUME]</code></p><ul><li>ä¾‹å¦‚ï¼š<code>docker volume create my_volume</code> åˆ›å»ºä¸€ä¸ªåä¸º <code>my_volume</code> çš„å·ã€‚</li></ul></li><li><p><strong>åˆ—å‡ºå·</strong>:</p><p> <code>docker volume ls</code></p></li><li><p><strong>åˆ é™¤å·</strong>:</p><p> <code>docker volume rm VOLUME</code></p><ul><li>ä¾‹å¦‚ï¼š<code>docker volume rm my_volume</code> åˆ é™¤åä¸º <code>my_volume</code> çš„å·ã€‚</li></ul></li></ol><h4 id="å…¶ä»–å¸¸ç”¨å‘½ä»¤"><a href="#å…¶ä»–å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å…¶ä»–å¸¸ç”¨å‘½ä»¤"></a>å…¶ä»–å¸¸ç”¨å‘½ä»¤</h4><ol><li><p><strong>æŸ¥çœ‹Dockerç‰ˆæœ¬</strong>:</p><p> <code>docker version</code></p></li><li><p><strong>æŸ¥çœ‹Dockerç³»ç»Ÿä¿¡æ¯</strong>:</p><p> <code>docker info</code></p></li><li><p><strong>æŸ¥çœ‹å®¹å™¨&#x2F;é•œåƒ&#x2F;å·ç­‰çš„è¯¦ç»†ä¿¡æ¯</strong>:</p><p> <code>docker inspect NAME|ID</code></p></li></ol><h3 id="5ã€docker-å®‰è£…-Mysql-æ“ä½œ"><a href="#5ã€docker-å®‰è£…-Mysql-æ“ä½œ" class="headerlink" title="5ã€docker å®‰è£… Mysql æ“ä½œ"></a>5ã€docker å®‰è£… Mysql æ“ä½œ</h3><p>ä»¥ä¸‹æ˜¯ä½¿ç”¨Dockerå®‰è£…å’Œè¿è¡ŒMySQL 5.7å’Œ8.0ç‰ˆæœ¬çš„æ­¥éª¤ï¼š</p><blockquote><ol><li><strong>è¿è¡ŒMySQL 5.7</strong></li></ol></blockquote><ol><li><p><strong>æ‹‰å–MySQL 5.7é•œåƒ</strong>:</p><p> <code>docker pull mysql:5.7</code></p></li><li><p><strong>å¯åŠ¨MySQL 5.7å®¹å™¨</strong>:</p></li></ol><p>ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ä¸€ä¸ªåä¸º <code>mysql57</code> çš„MySQL 5.7å®¹å™¨ï¼Œè®¾ç½®rootå¯†ç ï¼ˆåœ¨æ­¤ç¤ºä¾‹ä¸­ä¸º<code>yourpassword</code>ï¼‰ï¼Œå¹¶æ˜ å°„ç«¯å£3306ï¼ˆæˆ–é€‰æ‹©å…¶ä»–æœªä½¿ç”¨çš„ç«¯å£ï¼‰åˆ°å®¿ä¸»æœºã€‚<br>åŒæ—¶ï¼Œä½ å¯ä»¥æŒ‡å®šä¸€ä¸ªæ•°æ®å·æ¥æŒä¹…åŒ–MySQLæ•°æ®ã€‚</p><p><code>docker run --name mysql57 -e MYSQL_ROOT_PASSWORD=yourpassword -p 3306:3306 -d mysql:5.7</code></p><ul><li>å¦‚æœéœ€è¦æŒä¹…åŒ–æ•°æ®åˆ°ç‰¹å®šè·¯å¾„ï¼Œå¯ä»¥æ·»åŠ  <code>-v</code> å‚æ•°ï¼Œå¦‚:</li></ul><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">docker</span> run --name mysql57 -e MYSQL_ROOT_PASSWORD=yourpassword -p <span class="hljs-number">3306</span>:<span class="hljs-number">3306</span> -v /my/own/datadir:/var/lib/mysql -d mysql:<span class="hljs-number">5</span>.<span class="hljs-number">7</span><br></code></pre></td></tr></table></figure><blockquote><ol start="2"><li><strong>è¿è¡ŒMySQL 8.0</strong></li></ol></blockquote><ol><li><p><strong>æ‹‰å–MySQL 8.0é•œåƒ</strong>:</p><p> <code>docker pull mysql:8.0</code></p></li><li><p><strong>å¯åŠ¨MySQL 8.0å®¹å™¨</strong>:</p></li></ol><ul><li>ç”±äºMySQL 5.7å·²ç»ä½¿ç”¨äº†3306ç«¯å£ï¼Œæ‰€ä»¥å¯¹äºMySQL 8.0ï¼Œä½ éœ€è¦æ˜ å°„åˆ°å®¿ä¸»æœºçš„å¦ä¸€ä¸ªç«¯å£ï¼Œä¾‹å¦‚3307ã€‚</li></ul><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">docker</span> run --name mysql8 -e MYSQL_ROOT_PASSWORD=yourpassword -p <span class="hljs-number">3307</span>:<span class="hljs-number">3306</span> -d mysql:<span class="hljs-number">8</span>.<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><ul><li>åŒæ ·ï¼Œä½ ä¹Ÿå¯ä»¥æŒ‡å®šæ•°æ®å·æ¥æŒä¹…åŒ–MySQL 8.0çš„æ•°æ®ã€‚</li><li><code>mysql:8.0</code> æŒ‡çš„æ˜¯Dockeré•œåƒçš„åç§°å’Œæ ‡ç­¾ã€‚åœ¨è¿™é‡Œï¼Œ<code>mysql</code> æ˜¯é•œåƒçš„åç§°ï¼Œ<code>8.0</code> æ˜¯é•œåƒçš„æ ‡ç­¾ï¼Œå®ƒæŒ‡å®šäº†MySQLçš„å…·ä½“ç‰ˆæœ¬ã€‚</li></ul><ol start="3"><li><p><strong>éªŒè¯å’Œè¿æ¥</strong></p></li><li><p><strong>éªŒè¯å®¹å™¨è¿è¡ŒçŠ¶æ€</strong>:</p><p> <code>docker ps</code></p></li><li><p><strong>è¿æ¥åˆ°MySQLå®¹å™¨</strong>:</p></li></ol><p>ä½¿ç”¨Dockerå†…ç½®çš„å‘½ä»¤è¡Œæˆ–è€…ä½¿ç”¨ä»»ä½•MySQLå®¢æˆ·ç«¯è¿æ¥åˆ°æ•°æ®åº“ã€‚ä¾‹å¦‚ï¼Œè¦è¿æ¥åˆ°MySQL 5.7å®ä¾‹ï¼Œå¯ä»¥ä½¿ç”¨ï¼š<br><code>docker exec -it mysql57 mysql -uroot -pyourpassword</code></p><ul><li>å¯¹äºMySQL 8.0ï¼Œè¿æ¥å‘½ä»¤ç±»ä¼¼ï¼Œåªæ˜¯å®¹å™¨åç§°ä¸åŒã€‚</li></ul><blockquote><p>æ³¨æ„äº‹é¡¹</p></blockquote><ul><li>æ›¿æ¢ä¸Šè¿°å‘½ä»¤ä¸­çš„ <code>yourpassword</code> ä¸ºä½ è‡ªå·±çš„å¼ºå¯†ç ã€‚</li><li>å¦‚æœä½ ä½¿ç”¨äº†è‡ªå®šä¹‰æ•°æ®å·è·¯å¾„ï¼ˆå¦‚ <code>/my/own/datadir</code>ï¼‰ï¼Œç¡®ä¿è¯¥è·¯å¾„åœ¨å®¿ä¸»æœºä¸Šå­˜åœ¨ï¼Œå¹¶ä¸”Dockeræœ‰æƒé™è®¿é—®ã€‚</li><li>MySQL 8.0 é»˜è®¤ä½¿ç”¨äº†æ›´å¼ºçš„å¯†ç åŠ å¯†ç­–ç•¥ï¼ˆcaching_sha2_passwordï¼‰ï¼ŒæŸäº›å®¢æˆ·ç«¯å¯èƒ½éœ€è¦æ›´æ–°æˆ–é…ç½®ä»¥æ”¯æŒæ–°çš„åŠ å¯†æ–¹å¼ã€‚</li></ul><hr><p>å‚è€ƒ</p><ul><li><a href="https://blog.csdn.net/qq_45868731/article/details/131743699">https://blog.csdn.net/qq_45868731/article/details/131743699</a></li><li><a href="https://blog.csdn.net/ninimino/article/details/113388745">https://blog.csdn.net/ninimino/article/details/113388745</a></li><li><a href="https://blog.csdn.net/weixin_45821811/article/details/116211724">https://blog.csdn.net/weixin_45821811/article/details/116211724</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>éƒ¨ç½²</category>
      
    </categories>
    
    
    <tags>
      
      <tag>docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é¢è¯•é¢˜_JavaåŸºç¡€_Stringå¸¸è§é¢è¯•é¢˜</title>
    <link href="/2024/01/11/%E9%9D%A2%E8%AF%95%E9%A2%98_Java%E5%9F%BA%E7%A1%80_String%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    <url>/2024/01/11/%E9%9D%A2%E8%AF%95%E9%A2%98_Java%E5%9F%BA%E7%A1%80_String%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<p>è¿™ç§å¥‡æ€ªçš„é¢˜ç›®è¿˜ä¸å°‘ï¼Œå¾…è®°å½•å’Œç†è§£ä¸€ä¸‹ã€‚</p><p>to be continedâ€¦</p>]]></content>
    
    
    <categories>
      
      <category>é¢è¯•é¢˜</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>é¢è¯•é¢˜</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringBooté¡¹ç›®éƒ¨ç½²æ–¹æ¡ˆ</title>
    <link href="/2024/01/11/SpringBoot%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88/"/>
    <url>/2024/01/11/SpringBoot%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2%E6%96%B9%E6%A1%88/</url>
    
    <content type="html"><![CDATA[<p>è®°å½•ä¸€äº›å¸¸ç”¨æ“ä½œï¼š</p><h3 id="1ã€profilesæŒ‡å®šä¸åŒç¯å¢ƒçš„é…ç½®"><a href="#1ã€profilesæŒ‡å®šä¸åŒç¯å¢ƒçš„é…ç½®" class="headerlink" title="1ã€profilesæŒ‡å®šä¸åŒç¯å¢ƒçš„é…ç½®"></a>1ã€profilesæŒ‡å®šä¸åŒç¯å¢ƒçš„é…ç½®</h3><p>ä¸€èˆ¬ç”¨äºåŒºåˆ«ä¸åŒçš„ç¯å¢ƒï¼Œå¸¸è§çš„ å¼€å‘ã€æµ‹è¯•ã€æ­£å¼</p><p>ç¯å¢ƒåŒºåˆ†é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼ï¼š</p><ul><li><p>é€šè¿‡application.ymlä¸­ç¼–ç æŒ‡å®šÂ <code>profile.active=uat</code>Â æ–¹å¼æŒ‡å®š</p></li><li><p>é€šè¿‡mvnä¸­profilesæ¥åŒºåˆ†ä¸åŒç¯å¢ƒå¯¹åº”çš„é…ç½®æ–‡ä»¶å¤¹ï¼Œäººå·¥å¯ä»¥æ‰‹åŠ¨åœ¨ideaå‹¾é€‰ç”Ÿæˆä¸åŒç¯å¢ƒçš„åŒ…(æ¨è)</p></li></ul><h4 id="application-yml-ç¼–ç æŒ‡å®š"><a href="#application-yml-ç¼–ç æŒ‡å®š" class="headerlink" title="application.yml ç¼–ç æŒ‡å®š"></a>application.yml ç¼–ç æŒ‡å®š</h4><p>ç•¥</p><h4 id="mvn-â†’-profiles-åŒºåˆ†"><a href="#mvn-â†’-profiles-åŒºåˆ†" class="headerlink" title="mvn â†’ profiles åŒºåˆ†"></a>mvn â†’ profiles åŒºåˆ†</h4><p>åœ¨mvnä¸­é…ç½®å¦‚ä¸‹å†…å®¹</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">profiles</span>&gt;</span>  </span><br><span class="language-xml">Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">profile</span>&gt;</span>  </span><br><span class="language-xml">Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>node<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span>  </span><br><span class="language-xml">Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span>  </span><br><span class="language-xml">Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">&lt;!--ä¼ é€’ç»™è„šæœ¬çš„å‚æ•°å€¼--&gt;</span>  </span><br><span class="language-xml">Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">activeProfile</span>&gt;</span>node<span class="hljs-tag">&lt;/<span class="hljs-name">activeProfile</span>&gt;</span>  </span><br><span class="language-xml">Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">package-name</span>&gt;</span>$</span><span class="hljs-template-variable">&#123;scripts_packageName&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">package-name</span>&gt;</span>  </span><br><span class="language-xml">Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">boot-main</span>&gt;</span>$</span><span class="hljs-template-variable">&#123;scripts_bootMain&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">boot-main</span>&gt;</span>  </span><br><span class="language-xml">Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span>  </span><br><span class="language-xml">Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">activation</span>&gt;</span>  </span><br><span class="language-xml">Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">activeByDefault</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">activeByDefault</span>&gt;</span>  </span><br><span class="language-xml">Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">activation</span>&gt;</span>  </span><br><span class="language-xml">Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">profile</span>&gt;</span>  </span><br><span class="language-xml">Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">profile</span>&gt;</span>  </span><br><span class="language-xml">Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>node1<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span>  </span><br><span class="language-xml">Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span>  </span><br><span class="language-xml">Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">activeProfile</span>&gt;</span>node1<span class="hljs-tag">&lt;/<span class="hljs-name">activeProfile</span>&gt;</span>  </span><br><span class="language-xml">Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">package-name</span>&gt;</span>$</span><span class="hljs-template-variable">&#123;scripts_packageName&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">package-name</span>&gt;</span>  </span><br><span class="language-xml">Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">boot-main</span>&gt;</span>$</span><span class="hljs-template-variable">&#123;scripts_bootMain&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">boot-main</span>&gt;</span>  </span><br><span class="language-xml">Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span>  </span><br><span class="language-xml">Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">profile</span>&gt;</span>  </span><br><span class="language-xml">Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">profile</span>&gt;</span>  </span><br><span class="language-xml">Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>node2<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span>  </span><br><span class="language-xml">Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span>  </span><br><span class="language-xml">Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">activeProfile</span>&gt;</span>node2<span class="hljs-tag">&lt;/<span class="hljs-name">activeProfile</span>&gt;</span>  </span><br><span class="language-xml">Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">package-name</span>&gt;</span>$</span><span class="hljs-template-variable">&#123;scripts_packageName&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">package-name</span>&gt;</span>  </span><br><span class="language-xml">Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">boot-main</span>&gt;</span>$</span><span class="hljs-template-variable">&#123;scripts_bootMain&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">boot-main</span>&gt;</span>  </span><br><span class="language-xml">Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span>  </span><br><span class="language-xml">Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">profile</span>&gt;</span>  </span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">profiles</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p>çœ‹ä¸€ä¸‹ä¸‹é¢è¿™ä¸ªè§£é‡Š</p><p><strong>èŠ‚ç‚¹ç²—è§£ï¼š</strong></p><p><strong>idï¼š</strong>Â ç”¨æ¥æŒ‡å®šä¸åŒç¯å¢ƒé…ç½®æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•:</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202401110850243.png" alt="image.png"></p><p>è€Œåœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œåœ¨ç»™å®šçš„é…ç½®ä¸­ï¼Œå®šä¹‰äº†ä¸‰ä¸ª <code>profile</code>ï¼Œåˆ†åˆ«æ˜¯ <code>node</code>, <code>node1</code>, å’Œ <code>node2</code>ã€‚æ¯ä¸ª <code>profile</code> ä¸­å®šä¹‰äº†ä¸€äº› <code>properties</code>ï¼Œè¿™äº›å±æ€§å¯ä»¥åœ¨æ„å»ºè¿‡ç¨‹ä¸­ä½¿ç”¨</p><p><strong>propertiesï¼š</strong>Â </p><p>è¯¥èŠ‚ç‚¹ä¸­çš„èŠ‚ç‚¹æ˜¯å¯ä½œä¸ºå‚æ•°ä¼ é€’ç»™å…¶ä»–é…ç½®æ–‡ä»¶ï¼Œä¸Šé¢ä»£ç ä¸­çš„package-nameèŠ‚ç‚¹å€¼å¯ä»¥åœ¨å¦å¤–çš„assembly.xmlæˆ–è€…shellè„šæœ¬æ–‡ä»¶ä¸­é€šè¿‡<code>$&#123;package-name&#125;</code>è·å–åˆ°ï¼Œå¦‚ä¸‹</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202401110851350.png" alt="image.png"></p><p><strong>activeByDefaultï¼š</strong>Â æŒ‡å®šé»˜è®¤ç¯å¢ƒé…ç½®æ–‡ä»¶å¤¹</p><p>â†‘ çœ‹äº†ä¸€ä¸‹å¤§æ¦‚çš„è§£é‡Šï¼Œè¿™é‡Œçš„ç”¨æ³•å¤§æ¦‚æ˜¯åœ¨ pom ä¾èµ–é…ç½®æ–‡ä»¶ä¸­å®šä¹‰ä¸€ä¸‹å¯¹åº”çš„ profile çš„èŠ‚ç‚¹ id ï¼›å¹¶é…ç½®å¯¹åº”æ–‡ä»¶å¤¹ï¼ˆåœ¨ profiles æ–‡ä»¶å¤¹ä¸‹ï¼‰</p><p>é€šè¿‡ä¸åŒçš„æ–‡ä»¶å¤¹å¯¹åº”ä¸åŒçš„ yml é…ç½®æ–‡ä»¶</p><p>ç„¶ååœ¨æ‰“åŒ…æˆ–è€…è¿è¡Œçš„æ—¶å€™é€šè¿‡ ç±»ä¼¼è¿™ç§å‘½ä»¤æ¥æ“ä½œ <code>mvn clean install -Pnode1</code>  ï¼›å…·ä½“å¾…å®è·µä¸€ä¸‹ã€‚</p><h3 id="2ã€maven-assembly-pluginæ‰“-å‘å¸ƒå‹ç¼©åŒ…"><a href="#2ã€maven-assembly-pluginæ‰“-å‘å¸ƒå‹ç¼©åŒ…" class="headerlink" title="2ã€maven-assembly-pluginæ‰“  å‘å¸ƒå‹ç¼©åŒ…"></a>2ã€maven-assembly-pluginæ‰“  å‘å¸ƒå‹ç¼©åŒ…</h3><p>å…ˆè®°å½•ä¸€ä¸‹ï¼Œå…·ä½“æ²¡ç”¨è¿‡ï¼Œæš‚æ—¶ä¸å¤ªæ¸…æ¥š</p><p>å…·ä½“å†…å®¹çœ‹å‚è€ƒé“¾æ¥ï¼š <a href="https://mp.weixin.qq.com/s/yGPnk-bTkcBUiVq2FZsrBQ">https://mp.weixin.qq.com/s/yGPnk-bTkcBUiVq2FZsrBQ</a></p><p>to be continedâ€¦.</p><p>åç»­å†…å®¹å¾…å®é™…éƒ¨ç½²çš„æ—¶å€™ä½¿ç”¨ä¸€ä¸‹ï¼Œå†è¿›è¡Œè®°å½•</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://mp.weixin.qq.com/s/yGPnk-bTkcBUiVq2FZsrBQ">https://mp.weixin.qq.com/s/yGPnk-bTkcBUiVq2FZsrBQ</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>é¡¹ç›®</category>
      
    </categories>
    
    
    <tags>
      
      <tag>project</tag>
      
      <tag>springboot</tag>
      
      <tag>Build</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ—¥è®°_20240110</title>
    <link href="/2024/01/10/%E6%97%A5%E8%AE%B0_%E8%BF%91%E6%9C%9F%E8%AE%A1%E5%88%9220240110/"/>
    <url>/2024/01/10/%E6%97%A5%E8%AE%B0_%E8%BF%91%E6%9C%9F%E8%AE%A1%E5%88%9220240110/</url>
    
    <content type="html"><![CDATA[<p>è¿‘æœŸè®¡åˆ’</p><ul><li><input disabled="" type="checkbox"> é¢è¯•é¢˜å­¦ä¹ ï¼Œå‡†å¤‡ä¸€ä¸‹å…«è‚¡ï¼ˆä¸»è¦æ ¹æ®é¢è¯•æŒ‡åŒ—å’ŒJavaé¢è¯•åº“å­¦ä¹ ï¼‰ï¼Œç»§ç»­å®Œå–„çŸ¥è¯†åº“å†…å®¹</li><li><input disabled="" type="checkbox"> è˜‘è‡é¡¹ç›®ç»§ç»­å­¦ä¹ ï¼Œå®é™…ç»ƒä¹ ï¼Œä»éœ€æ±‚åˆ†æåˆ°æ¶æ„è®¾è®¡ï¼Œåˆ°æœ€åçš„å®ç°ï¼Œå†™ä¸€ä¸‹ä¸»è¦è¿‡ç¨‹ã€‚éƒ¨åˆ†å†…å®¹å¾…å­¦ä¹ ã€‚</li><li><input disabled="" type="checkbox"> å­¦ä¹ ä¸€ä¸‹ç å†œä¼šé”çŸ¥è¯†æ˜Ÿçƒé‡Œé¢çš„é¡¹ç›®ï¼Œå¹¶çœŸæ­£åŠ å¼ºè‡ªå·±çš„å®é™…ä»£ç èƒ½åŠ›å’Œç¼–ç¨‹èƒ½åŠ›</li><li><input disabled="" type="checkbox"> å†™ä¸€ä¸ªè‡ªä¹ å®¤é¡¹ç›®å’Œé…’åº—ç®¡ç†é¡¹ç›®ã€‚ï¼ˆå¯é€‰ï¼‰</li><li><input disabled="" type="checkbox"> æœ‰ç©ºå¯ä»¥æ¨¡ä»¿å†™ä¸€ä¸ªJavaé¢è¯•åº“é¡¹ç›®ï¼ŒåŒ…æ‹¬å°ç¨‹åºç‰ˆæœ¬ã€‚ï¼ˆå¯é€‰ï¼‰</li><li><input disabled="" type="checkbox"> é¡¹ç›®ä¼˜åŒ–ï¼ˆExcel ä¼˜åŒ–å¯¼å…¥å’Œ æ¥å£é…ç½®ï¼‰</li><li><input disabled="" type="checkbox"> ç®€å†å‡†å¤‡å’Œå®Œå–„ï¼ˆæŒç»­ä¼˜åŒ–ï¼‰ï¼Œå‡†å¤‡æŠ•é€’</li></ul>]]></content>
    
    
    <categories>
      
      <category>Diary</category>
      
    </categories>
    
    
    <tags>
      
      <tag>blog</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è˜‘è‡åšå®¢é¡¹ç›®_Day05</title>
    <link href="/2024/01/08/%E8%98%91%E8%8F%87%E5%8D%9A%E5%AE%A2%E9%A1%B9%E7%9B%AE_Day05/"/>
    <url>/2024/01/08/%E8%98%91%E8%8F%87%E5%8D%9A%E5%AE%A2%E9%A1%B9%E7%9B%AE_Day05/</url>
    
    <content type="html"><![CDATA[<h4 id="1ã€é˜²æ­¢é‡å¤æäº¤"><a href="#1ã€é˜²æ­¢é‡å¤æäº¤" class="headerlink" title="1ã€é˜²æ­¢é‡å¤æäº¤"></a>1ã€é˜²æ­¢é‡å¤æäº¤</h4><p><code>AvoidRepeatableCommitAspect</code> ç±»æ˜¯ä¸€ä¸ªSpring AOPåˆ‡é¢ï¼Œç”¨äºé˜²æ­¢æ¥å£çš„é‡å¤æäº¤ã€‚</p><p>è¿™ä¸ªåˆ‡é¢é€šè¿‡æ‹¦æˆªè¢« <code>@AvoidRepeatableCommit</code> æ³¨è§£æ ‡è®°çš„æ–¹æ³•ï¼Œå¹¶åœ¨Redisä¸­è®°å½•è¯·æ±‚çš„çŠ¶æ€æ¥å®ç°ã€‚</p><p>ä¸‹é¢æ˜¯å¯¹è¿™ä¸ªåˆ‡é¢ç±»å®ç°çš„è¯¦ç»†è§£é‡Šå’Œæ³¨é‡Šï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Aspect</span><br><span class="hljs-meta">@Component</span><br><span class="hljs-meta">@Slf4j</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AvoidRepeatableCommitAspect</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> RedisUtil redisUtil;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ç¯ç»•é€šçŸ¥ï¼šæ‹¦æˆªæ‰€æœ‰æ ‡è®°äº†<span class="hljs-doctag">@AvoidRepeatableCommit</span>çš„æ–¹æ³•</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> point è¿æ¥ç‚¹ï¼Œæä¾›å¯¹æ‹¦æˆªæ–¹æ³•çš„è®¿é—®</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æ–¹æ³•æ‰§è¡Œçš„ç»“æœ</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> Throwable å¯èƒ½æŠ›å‡ºçš„ä»»ä½•å¼‚å¸¸</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Around(&quot;@annotation(com.moxi.mogublog.admin.annotion.AvoidRepeatableCommit.AvoidRepeatableCommit)&quot;)</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">around</span><span class="hljs-params">(ProceedingJoinPoint point)</span> <span class="hljs-keyword">throws</span> Throwable &#123;<br>        <span class="hljs-type">HttpServletRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> RequestHolder.getRequest();<br><br>        <span class="hljs-comment">// è·å–è¯·æ±‚è€…çš„IPåœ°å€</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">ip</span> <span class="hljs-operator">=</span> IpUtils.getIpAddr(request);<br><br>        <span class="hljs-comment">// è·å–æ³¨è§£çš„æ–¹æ³•</span><br>        <span class="hljs-type">MethodSignature</span> <span class="hljs-variable">signature</span> <span class="hljs-operator">=</span> (MethodSignature) point.getSignature();<br>        <span class="hljs-type">Method</span> <span class="hljs-variable">method</span> <span class="hljs-operator">=</span> signature.getMethod();<br><br>        <span class="hljs-comment">// è·å–ç›®æ ‡ç±»åå’Œæ–¹æ³•å</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">className</span> <span class="hljs-operator">=</span> method.getDeclaringClass().getName();<br>        <span class="hljs-type">String</span> <span class="hljs-variable">methodName</span> <span class="hljs-operator">=</span> method.getName();<br><br>        <span class="hljs-comment">// æ„å»ºä¸€ä¸ªåŸºäºç±»åå’Œæ–¹æ³•åçš„å”¯ä¸€æ ‡è¯†</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">ipKey</span> <span class="hljs-operator">=</span> String.format(<span class="hljs-string">&quot;%s#%s&quot;</span>, className, methodName);<br><br>        <span class="hljs-comment">// è½¬æ¢æˆHashCodeï¼Œç”¨äºç”ŸæˆRedis key</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">hashCode</span> <span class="hljs-operator">=</span> Math.abs(ipKey.hashCode());<br>        <span class="hljs-type">String</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> String.format(<span class="hljs-string">&quot;%s:%s_%d&quot;</span>, RedisConf.AVOID_REPEATABLE_COMMIT, ip, hashCode);<br><br>        log.info(<span class="hljs-string">&quot;ipKey=&#123;&#125;, hashCode=&#123;&#125;, key=&#123;&#125;&quot;</span>, ipKey, hashCode, key);<br><br>        <span class="hljs-comment">// è·å–æ³¨è§£å®ä¾‹ï¼Œä»¥åŠæ³¨è§£ä¸­çš„è¶…æ—¶æ—¶é—´</span><br>        <span class="hljs-type">AvoidRepeatableCommit</span> <span class="hljs-variable">avoidRepeatableCommit</span> <span class="hljs-operator">=</span> method.getAnnotation(AvoidRepeatableCommit.class);<br>        <span class="hljs-type">long</span> <span class="hljs-variable">timeout</span> <span class="hljs-operator">=</span> avoidRepeatableCommit.timeout();<br><br>        <span class="hljs-comment">// æ£€æŸ¥Redisä¸­æ˜¯å¦å­˜åœ¨è¯¥key</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> redisUtil.get(key);<br>        <span class="hljs-keyword">if</span> (StringUtils.isNotBlank(value)) &#123;<br>            log.info(<span class="hljs-string">&quot;è¯·å‹¿é‡å¤æäº¤è¡¨å•&quot;</span>);<br>            <span class="hljs-keyword">return</span> ResultUtil.result(SysConf.ERROR, <span class="hljs-string">&quot;è¯·å‹¿é‡å¤æäº¤è¡¨å•&quot;</span>);<br>        &#125;<br><br>        <span class="hljs-comment">// è®¾ç½®Redis keyä»¥é˜²æ­¢çŸ­æ—¶é—´å†…çš„é‡å¤æäº¤</span><br>        redisUtil.setEx(key, StringUtils.getUUID(), timeout, TimeUnit.MILLISECONDS);<br><br>        <span class="hljs-comment">// æ‰§è¡ŒåŸæ–¹æ³•</span><br>        <span class="hljs-keyword">return</span> point.proceed();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªç±»ä¸­ï¼š</p><ol><li>ä½¿ç”¨ <code>@Aspect</code> æ ‡è®°è¿™ä¸ªç±»ä¸ºä¸€ä¸ªåˆ‡é¢ï¼Œå¹¶é€šè¿‡ <code>@Component</code> æ³¨å†Œåˆ°Springå®¹å™¨ã€‚</li><li><code>@Around</code> æ³¨è§£å®šä¹‰äº†ä¸€ä¸ªç¯ç»•é€šçŸ¥ï¼Œæ‹¦æˆªæ‰€æœ‰ä½¿ç”¨ <code>@AvoidRepeatableCommit</code> æ³¨è§£çš„æ–¹æ³•ã€‚</li><li>åœ¨é€šçŸ¥æ–¹æ³•å†…ï¼Œé¦–å…ˆè·å–è¯·æ±‚è€…çš„IPåœ°å€å’Œç›®æ ‡æ–¹æ³•çš„ä¿¡æ¯ï¼Œç„¶åæ„å»ºä¸€ä¸ªå”¯ä¸€çš„Redis keyã€‚</li><li>é€šè¿‡æ£€æŸ¥Redisä¸­è¯¥keyçš„å­˜åœ¨ä¸å¦æ¥åˆ¤æ–­æ˜¯å¦å·²ç»æäº¤è¿‡ç›¸åŒçš„è¯·æ±‚ã€‚å¦‚æœå·²ç»æäº¤è¿‡ï¼Œè¿”å›é”™è¯¯ä¿¡æ¯ï¼Œé˜²æ­¢é‡å¤å¤„ç†ã€‚</li><li>å¦‚æœæ²¡æœ‰æäº¤è¿‡ï¼Œå°†è¯¥keyå­˜å‚¨åˆ°Redisä¸­ï¼Œå¹¶è®¾ç½®è¿‡æœŸæ—¶é—´ä¸ºæ³¨è§£ä¸­æŒ‡å®šçš„è¶…æ—¶æ—¶é—´ã€‚</li><li>æœ€åï¼Œæ‰§è¡Œè¢«æ‹¦æˆªçš„æ–¹æ³•ã€‚</li></ol><p>è¿™ç§å®ç°æ–¹å¼æœ‰æ•ˆåœ°åˆ©ç”¨äº†Redisæ¥é˜²æ­¢çŸ­æ—¶é—´å†…çš„é‡å¤æäº¤ï¼Œé€‚ç”¨äºè¡¨å•æäº¤ç­‰éœ€è¦é˜²æ­¢é‡å¤æ“ä½œçš„åœºæ™¯ã€‚<br>é€šè¿‡è¿™ä¸ªåˆ‡é¢ï¼Œå¯ä»¥å¢å¼ºåº”ç”¨çš„å¥å£®æ€§ï¼Œé˜²æ­¢ç”±äºé‡å¤æäº¤å¯¼è‡´çš„æ•°æ®é—®é¢˜æˆ–èµ„æºæµªè´¹ã€‚</p><h4 id="2ã€é‚®ä»¶åŠŸèƒ½"><a href="#2ã€é‚®ä»¶åŠŸèƒ½" class="headerlink" title="2ã€é‚®ä»¶åŠŸèƒ½"></a>2ã€é‚®ä»¶åŠŸèƒ½</h4><p>ç•¥ï¼Œåç»­å®é™…è¿è¡Œçœ‹ä¸€ä¸‹å¹¶è¿›è¡Œåˆ†æã€‚</p><p>ç±»ï¼š RabbitMqUtilã€SendMailUtilsã€SmsUtil</p><p>é€šè¿‡è¿™ä¸ªå·¥å…·ç±»æ¥è¿›è¡Œå‘é€é‚®ä»¶ã€‚</p><h4 id="3ã€åˆ‡é¢ï¼šé™åˆ¶è¯·æ±‚è®¿é—®"><a href="#3ã€åˆ‡é¢ï¼šé™åˆ¶è¯·æ±‚è®¿é—®" class="headerlink" title="3ã€åˆ‡é¢ï¼šé™åˆ¶è¯·æ±‚è®¿é—®"></a>3ã€åˆ‡é¢ï¼šé™åˆ¶è¯·æ±‚è®¿é—®</h4><p><code>RequestLimitAspect</code> ç±»æ˜¯ä¸€ä¸ªSpring AOPåˆ‡é¢ï¼Œç”¨äºé™åˆ¶æ¥å£è¯·æ±‚çš„é¢‘ç‡ã€‚è¿™ä¸ªåˆ‡é¢é€šè¿‡Rediså®ç°è¯·æ±‚çš„è®¡æ•°å’Œæ—¶é—´é™åˆ¶ã€‚</p><p>ä¸‹é¢æ˜¯å¯¹è¿™ä¸ªåˆ‡é¢ç±»å®ç°çš„è¯¦ç»†è§£é‡Šå’Œæ³¨é‡Šï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Aspect</span><br><span class="hljs-meta">@RefreshScope</span><br><span class="hljs-meta">@Component</span><br><span class="hljs-meta">@Slf4j</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RequestLimitAspect</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">POINT</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;execution(* com.moxi.mogublog.web.restapi..*.*(..))&quot;</span>;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> RedisUtil redisUtil;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> RequestLimitConfig requestLimitConfig;<br><br>    <span class="hljs-meta">@Pointcut(POINT)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">pointcut</span><span class="hljs-params">()</span> &#123;<br><br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ç¯ç»•é€šçŸ¥ï¼šç”¨äºåœ¨æ–¹æ³•æ‰§è¡Œå‰åè¿›è¡Œè¯·æ±‚é™åˆ¶çš„æ£€æŸ¥ã€‚</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> point è¿æ¥ç‚¹ï¼Œæä¾›å¯¹æ‹¦æˆªæ–¹æ³•çš„è®¿é—®</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æ–¹æ³•æ‰§è¡Œç»“æœ</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> Throwable å¯èƒ½æŠ›å‡ºçš„ä»»ä½•å¼‚å¸¸</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Around(&quot;pointcut()&quot;)</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">around</span><span class="hljs-params">(ProceedingJoinPoint point)</span> <span class="hljs-keyword">throws</span> Throwable &#123;<br>        <span class="hljs-keyword">if</span> (requestLimitConfig.getStart()) &#123;<br>            <span class="hljs-type">ServletRequestAttributes</span> <span class="hljs-variable">attribute</span> <span class="hljs-operator">=</span> (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();<br>            <span class="hljs-type">HttpServletRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> attribute.getRequest();<br><br>            <span class="hljs-comment">// è·å–IPå’Œè¯·æ±‚è·¯å¾„</span><br>            <span class="hljs-type">String</span> <span class="hljs-variable">ip</span> <span class="hljs-operator">=</span> IpUtils.getIpAddr(request);<br>            <span class="hljs-type">String</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> request.getRequestURL().toString();<br><br>            <span class="hljs-comment">// è·å–æ–¹æ³•åç§°</span><br>            <span class="hljs-type">String</span> <span class="hljs-variable">methodName</span> <span class="hljs-operator">=</span> point.getSignature().getName();<br>            <span class="hljs-type">String</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> RedisConf.REQUEST_LIMIT + RedisConf.SEGMENTATION + ip + RedisConf.SEGMENTATION + methodName;<br><br>            <span class="hljs-type">Method</span> <span class="hljs-variable">currentMethod</span> <span class="hljs-operator">=</span> AspectUtil.INSTANCE.getMethod(point);<br><br>            <span class="hljs-comment">// æ£€æŸ¥æ–¹æ³•æ˜¯å¦æœ‰RequestLimitæ³¨è§£</span><br>            <span class="hljs-keyword">if</span> (currentMethod.isAnnotationPresent(RequestLimit.class)) &#123;<br>                <span class="hljs-type">RequestLimit</span> <span class="hljs-variable">requestLimit</span> <span class="hljs-operator">=</span> currentMethod.getAnnotation(RequestLimit.class);<br>                <span class="hljs-type">boolean</span> <span class="hljs-variable">checkResult</span> <span class="hljs-operator">=</span> checkWithRedis(requestLimit.amount(), requestLimit.time(), key);<br>                <span class="hljs-keyword">if</span> (checkResult) &#123;<br>                    log.info(<span class="hljs-string">&quot;requestLimited, [ç”¨æˆ·ip:&#123;&#125;], [è®¿é—®åœ°å€:&#123;&#125;]è¶…è¿‡äº†é™å®šçš„æ¬¡æ•°[&#123;&#125;]æ¬¡&quot;</span>, ip, url, requestLimit.amount());<br>                    <span class="hljs-keyword">return</span> ResultUtil.result(ECode.REQUEST_OVER_LIMIT, <span class="hljs-string">&quot;æ¥å£è¯·æ±‚è¿‡äºé¢‘ç¹&quot;</span>);<br>                &#125;<br>                <span class="hljs-keyword">return</span> point.proceed();<br>            &#125;<br>            <span class="hljs-type">boolean</span> <span class="hljs-variable">checkResult</span> <span class="hljs-operator">=</span> checkWithRedis(requestLimitConfig.getAmount(), requestLimitConfig.getTime(), key);<br>            <span class="hljs-keyword">if</span> (checkResult) &#123;<br>                log.info(<span class="hljs-string">&quot;requestLimited, [ç”¨æˆ·ip:&#123;&#125;], [è®¿é—®åœ°å€:&#123;&#125;]è¶…è¿‡äº†é™å®šçš„æ¬¡æ•°[&#123;&#125;]æ¬¡&quot;</span>, ip, url, requestLimitConfig.getAmount());<br>                <span class="hljs-keyword">return</span> ResultUtil.result(ECode.REQUEST_OVER_LIMIT, <span class="hljs-string">&quot;æ¥å£è¯·æ±‚è¿‡äºé¢‘ç¹&quot;</span>);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> point.proceed();<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * é€šè¿‡Redisè®°å½•å’Œæ£€æŸ¥è¯·æ±‚æ¬¡æ•°ï¼Œå®ç°è¯·æ±‚é™åˆ¶ã€‚</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> amount å…è®¸çš„æœ€å¤§è¯·æ±‚æ¬¡æ•°</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> time   æ—¶é—´é™åˆ¶ï¼ˆæ¯«ç§’ï¼‰</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> key    Redisé”®</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æ˜¯å¦è¶…è¿‡è¯·æ±‚é™åˆ¶</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">checkWithRedis</span><span class="hljs-params">(<span class="hljs-type">int</span> amount, <span class="hljs-type">long</span> time, String key)</span> &#123;<br>        <span class="hljs-type">long</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> redisUtil.incrBy(key, <span class="hljs-number">1</span>);<br>        <span class="hljs-keyword">if</span> (count == <span class="hljs-number">1</span>) &#123;<br>            redisUtil.expire(key, time, TimeUnit.MILLISECONDS);<br>        &#125;<br>        <span class="hljs-keyword">return</span> count &gt; amount;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªç±»ä¸­ï¼š</p><ol><li><strong>å®šä¹‰åˆ‡ç‚¹</strong>ï¼šé€šè¿‡ <code>@Pointcut</code> å®šä¹‰äº†ä¸€ä¸ªåˆ‡ç‚¹ï¼Œæ‹¦æˆªç‰¹å®šåŒ…ä¸‹çš„æ‰€æœ‰æ–¹æ³•ã€‚</li><li><strong>ç¯ç»•é€šçŸ¥</strong>ï¼š<code>@Around(&quot;pointcut()&quot;)</code> è¡¨æ˜ <code>around</code> æ–¹æ³•ä¼šåœ¨åˆ‡ç‚¹åŒ¹é…çš„æ–¹æ³•æ‰§è¡Œå‰åè¿›è¡Œã€‚</li><li><strong>è¯·æ±‚é™åˆ¶é€»è¾‘</strong>ï¼š<ul><li>è·å–è¯·æ±‚çš„IPåœ°å€å’ŒURLã€‚</li><li>æ„é€ ä¸€ä¸ªRedisé”®ï¼ŒåŸºäºIPåœ°å€å’Œæ–¹æ³•åç§°ã€‚</li><li>æ£€æŸ¥å½“å‰æ–¹æ³•æ˜¯å¦æœ‰ <code>@RequestLimit</code> æ³¨è§£ï¼Œå¦‚æœæœ‰ï¼Œä½¿ç”¨æ³¨è§£ä¸­çš„å‚æ•°è¿›è¡Œè¯·æ±‚é™åˆ¶æ£€æŸ¥ã€‚</li><li>å¦‚æœæ²¡æœ‰è¯¥æ³¨è§£ï¼Œä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­å®šä¹‰çš„å‚æ•°è¿›è¡Œæ£€æŸ¥ã€‚</li><li>ä½¿ç”¨ <code>checkWithRedis</code> æ–¹æ³•æ£€æŸ¥æ˜¯å¦è¶…è¿‡è¯·æ±‚é™åˆ¶ã€‚å¦‚æœè¶…è¿‡ï¼Œè¿”å›é”™è¯¯ä¿¡æ¯ã€‚</li></ul></li><li><strong>Redisè®¡æ•°å’Œè¿‡æœŸæ—¶é—´</strong>ï¼š<ul><li><code>checkWithRedis</code> æ–¹æ³•ä½¿ç”¨Redisæ¥è®¡æ•°æ¯ä¸ªè¯·æ±‚çš„é¢‘ç‡</li></ul></li></ol>]]></content>
    
    
    <categories>
      
      <category>é¡¹ç›®</category>
      
    </categories>
    
    
    <tags>
      
      <tag>project</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JavaåŸºç¡€_åŸºç¡€å†…å®¹02</title>
    <link href="/2024/01/08/Java%E5%9F%BA%E7%A1%80_%E5%9F%BA%E7%A1%80%E5%86%85%E5%AE%B902/"/>
    <url>/2024/01/08/Java%E5%9F%BA%E7%A1%80_%E5%9F%BA%E7%A1%80%E5%86%85%E5%AE%B902/</url>
    
    <content type="html"><![CDATA[<p>é¢å‘å¯¹è±¡åŸºç¡€</p><ul><li>é¢å‘å¯¹è±¡ vs é¢å‘è¿‡ç¨‹</li><li>åˆ›å»ºå¯¹è±¡ï¼›å¯¹è±¡å®ä½“ä¸å¯¹è±¡å¼•ç”¨çš„åŒºåˆ«</li><li>å¯¹è±¡çš„ç›¸ç­‰å’Œå¼•ç”¨ç›¸ç­‰çš„åŒºåˆ«</li><li>å½“ç±»æ²¡æœ‰å£°æ˜æ„é€ æ–¹æ³•</li><li>æ„é€ æ–¹æ³•çš„ç‰¹ç‚¹</li><li>é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹å¾</li><li>æ¥å£ä¸æŠ½è±¡ç±»</li><li>æ·±æ‹·è´ä¸æµ…æ‹·è´ï¼›å¼•ç”¨æ‹·è´</li></ul><p>Object</p><ul><li>Obect ç±»çš„å¸¸ç”¨æ–¹æ³•</li><li>&#x3D; &#x3D; å’Œ equals() çš„åŒºåˆ«</li><li>hashCode()  çš„ä½œç”¨</li></ul><p>String</p><ul><li>Stringã€StringBufferã€StringBuilder çš„åŒºåˆ«</li><li>ä¸å¯å˜çš„ String</li><li>å­—ç¬¦ä¸²æ‹¼æ¥ï¼š ä½¿ç”¨â€œ+â€ è¿˜æ˜¯ä½¿ç”¨ StringBuilder</li><li>String#equals() å’Œ Object#equals() æœ‰ä½•åŒºåˆ«ï¼Ÿ</li><li>å­—ç¬¦ä¸²å¸¸é‡æ± </li><li>String s1 &#x3D; new String(â€œabcâ€);è¿™å¥è¯åˆ›å»ºäº†å‡ ä¸ªå­—ç¬¦ä¸²å¯¹è±¡ï¼Ÿ</li><li>String#intern æ–¹æ³•</li><li>String ç±»å‹çš„å˜é‡å’Œå¸¸é‡åšâ€œ+â€è¿ç®—æ—¶å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</li></ul><p>å¼‚å¸¸</p><ul><li>Exception å’Œ Error æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</li><li>Checked Exception å’Œ Unchecked Exception</li><li>Throwable ç±»å¸¸ç”¨æ–¹æ³•</li><li>try-catch-finally å¦‚ä½•ä½¿ç”¨ï¼Ÿ</li><li>finally ä¸­çš„ä»£ç ä¸€å®šä¼šæ‰§è¡Œå—ï¼Ÿ</li><li>å¦‚ä½•ä½¿ç”¨ try-with-resources ä»£æ›¿try-catch-finallyï¼Ÿ</li><li>å¼‚å¸¸ä½¿ç”¨æœ‰å“ªäº›éœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼Ÿ</li></ul><h3 id="ä¸€ã€é¢å‘å¯¹è±¡åŸºç¡€"><a href="#ä¸€ã€é¢å‘å¯¹è±¡åŸºç¡€" class="headerlink" title="ä¸€ã€é¢å‘å¯¹è±¡åŸºç¡€"></a>ä¸€ã€é¢å‘å¯¹è±¡åŸºç¡€</h3><h4 id="1-1ã€é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„åŒºåˆ«"><a href="#1-1ã€é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„åŒºåˆ«" class="headerlink" title="1.1ã€é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„åŒºåˆ«"></a>1.1ã€é¢å‘å¯¹è±¡å’Œé¢å‘è¿‡ç¨‹çš„åŒºåˆ«</h4><p>ä¸¤è€…çš„ä¸»è¦åŒºåˆ«åœ¨äºè§£å†³é—®é¢˜çš„æ–¹å¼ä¸åŒï¼š</p><ul><li>é¢å‘è¿‡ç¨‹æŠŠè§£å†³é—®é¢˜çš„è¿‡ç¨‹æ‹†æˆä¸€ä¸ªä¸ªæ–¹æ³•ï¼Œé€šè¿‡ä¸€ä¸ªä¸ªæ–¹æ³•çš„æ‰§è¡Œè§£å†³é—®é¢˜ã€‚</li><li>é¢å‘å¯¹è±¡ä¼šå…ˆæŠ½è±¡å‡ºå¯¹è±¡ï¼Œç„¶åç”¨å¯¹è±¡æ‰§è¡Œæ–¹æ³•çš„æ–¹å¼è§£å†³é—®é¢˜ã€‚</li></ul><h4 id="1-2ã€åˆ›å»ºå¯¹è±¡"><a href="#1-2ã€åˆ›å»ºå¯¹è±¡" class="headerlink" title="1.2ã€åˆ›å»ºå¯¹è±¡"></a>1.2ã€åˆ›å»ºå¯¹è±¡</h4><p>new è¿ç®—ç¬¦ï¼Œnew åˆ›å»ºå¯¹è±¡å®ä¾‹ï¼ˆå¯¹è±¡å®ä¾‹åœ¨å †å†…å­˜ä¸­ï¼‰ï¼Œå¯¹è±¡å¼•ç”¨æŒ‡å‘å¯¹è±¡å®ä¾‹ï¼ˆå¯¹è±¡å¼•ç”¨å­˜æ”¾åœ¨æ ˆå†…å­˜ä¸­ï¼‰ã€‚</p><ul><li>ä¸€ä¸ªå¯¹è±¡å¼•ç”¨å¯ä»¥æŒ‡å‘ 0 ä¸ªæˆ– 1 ä¸ªå¯¹è±¡ï¼ˆä¸€æ ¹ç»³å­å¯ä»¥ä¸ç³»æ°”çƒï¼Œä¹Ÿå¯ä»¥ç³»ä¸€ä¸ªæ°”çƒï¼‰ï¼›</li><li>ä¸€ä¸ªå¯¹è±¡å¯ä»¥æœ‰ n ä¸ªå¼•ç”¨æŒ‡å‘å®ƒï¼ˆå¯ä»¥ç”¨ n æ¡ç»³å­ç³»ä½ä¸€ä¸ªæ°”çƒï¼‰ã€‚</li></ul><blockquote><p>å¯¹è±¡çš„ç›¸ç­‰å’Œå¼•ç”¨ç›¸ç­‰çš„åŒºåˆ«</p></blockquote><ul><li>å¯¹è±¡çš„ç›¸ç­‰ä¸€èˆ¬æ¯”è¾ƒçš„æ˜¯å†…å­˜ä¸­å­˜æ”¾çš„å†…å®¹æ˜¯å¦ç›¸ç­‰ã€‚</li><li>å¼•ç”¨ç›¸ç­‰ä¸€èˆ¬æ¯”è¾ƒçš„æ˜¯ä»–ä»¬æŒ‡å‘çš„å†…å­˜åœ°å€æ˜¯å¦ç›¸ç­‰ã€‚</li></ul><p>å¯¹è±¡æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>å¯¹è±¡æ˜¯ç±»çš„ä¸€ä¸ªå®ä¾‹ï¼Œç±»å®šä¹‰äº†å¯¹è±¡çš„çŠ¶æ€ï¼ˆå±æ€§ï¼‰å’Œè¡Œä¸ºï¼ˆæ–¹æ³•ï¼‰</p><p>åˆ›å»ºå¯¹è±¡çš„æ­¥éª¤ï¼š</p><ol><li><strong>å®šä¹‰ç±»</strong>: é¦–å…ˆï¼Œéœ€è¦å®šä¹‰ä¸€ä¸ªç±»ï¼Œä½œä¸ºå¯¹è±¡çš„è“å›¾ã€‚ç±»å®šä¹‰äº†å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ã€‚</li><li><strong>å£°æ˜å¯¹è±¡</strong>: æ¥ä¸‹æ¥ï¼Œå£°æ˜ä¸€ä¸ªç±»çš„å˜é‡ã€‚è¿™ä¸ªå˜é‡å°†å¼•ç”¨æ–°åˆ›å»ºçš„å¯¹è±¡ã€‚</li><li><strong>å®ä¾‹åŒ–å¯¹è±¡</strong>: ä½¿ç”¨ <code>new</code> å…³é”®å­—åˆ›å»ºç±»çš„ä¸€ä¸ªå®ä¾‹ã€‚</li><li><strong>åˆå§‹åŒ–å¯¹è±¡</strong>: é€šè¿‡è°ƒç”¨ç±»çš„æ„é€ å™¨æ¥åˆå§‹åŒ–æ–°åˆ›å»ºçš„å¯¹è±¡</li></ol><p>åˆ›å»ºå¯¹è±¡ç¤ºä¾‹ï¼š</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs arduino"><span class="hljs-comment">// å®šä¹‰Personç±»</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> &#123;<br>    <span class="hljs-type">String</span> name;<br>    <span class="hljs-type">int</span> age;<br><br>    <span class="hljs-built_in">Person</span>(<span class="hljs-type">String</span> name, <span class="hljs-type">int</span> age) &#123;<br>        <span class="hljs-keyword">this</span>.name = name;<br>        <span class="hljs-keyword">this</span>.age = age;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// åœ¨å¦ä¸€ä¸ªç±»ä¸­åˆ›å»ºPersonçš„å¯¹è±¡</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">static</span> <span class="hljs-type">void</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">String</span>[] args)</span> </span>&#123;<br>        <span class="hljs-comment">// åˆ›å»ºPersonå¯¹è±¡</span><br>        Person person = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Person</span>(<span class="hljs-string">&quot;Alice&quot;</span>, <span class="hljs-number">30</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>new Person(&quot;Alice&quot;, 30);</code> åˆ›å»ºäº†ä¸€ä¸ª <code>Person</code> ç±»çš„å®ä¾‹ï¼Œå¹¶ä¸”ç”¨ <code>Alice</code> å’Œ <code>30</code> åˆå§‹åŒ–è¿™ä¸ªå¯¹è±¡çš„ <code>name</code> å’Œ <code>age</code> å±æ€§ã€‚</p><h4 id="1-3ã€æ„é€ æ–¹æ³•"><a href="#1-3ã€æ„é€ æ–¹æ³•" class="headerlink" title="1.3ã€æ„é€ æ–¹æ³•"></a>1.3ã€æ„é€ æ–¹æ³•</h4><p>æ„é€ æ–¹æ³•çš„ä½œç”¨ï¼šæ„é€ æ–¹æ³•æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–¹æ³•ï¼Œä¸»è¦ä½œç”¨æ˜¯å®Œæˆå¯¹è±¡çš„åˆå§‹åŒ–å·¥ä½œã€‚</p><p>å¦‚æœæ²¡æœ‰å£°æ˜æ„é€ æ–¹æ³•ï¼Œç±»ä¼šæœ‰ä¸€ä¸ªé»˜è®¤çš„ä¸å¸¦å‚æ•°çš„æ”¹é€ æ–¹æ³•ã€‚</p><p>æ„é€ æ–¹æ³•çš„ç‰¹ç‚¹ï¼š</p><ul><li>åå­—ä¸ç±»åç›¸åŒã€‚</li><li>æ²¡æœ‰è¿”å›å€¼ï¼Œä½†ä¸èƒ½ç”¨ void å£°æ˜æ„é€ å‡½æ•°ã€‚</li><li>ç”Ÿæˆç±»çš„å¯¹è±¡æ—¶è‡ªåŠ¨æ‰§è¡Œï¼Œæ— éœ€è°ƒç”¨ã€‚</li></ul><p>æ„é€ æ–¹æ³•ä¸èƒ½è¢« overrideï¼ˆé‡å†™ï¼‰,ä½†æ˜¯å¯ä»¥ overloadï¼ˆé‡è½½ï¼‰,æ‰€ä»¥ä½ å¯ä»¥çœ‹åˆ°ä¸€ä¸ªç±»ä¸­æœ‰å¤šä¸ªæ„é€ å‡½æ•°çš„æƒ…å†µ</p><h4 id="1-4ã€é¢å‘å¯¹è±¡ç‰¹å¾"><a href="#1-4ã€é¢å‘å¯¹è±¡ç‰¹å¾" class="headerlink" title="1.4ã€é¢å‘å¯¹è±¡ç‰¹å¾"></a>1.4ã€é¢å‘å¯¹è±¡ç‰¹å¾</h4><p>é¢å‘å¯¹è±¡çš„ä¸‰å¤§ç‰¹å¾ï¼š</p><ul><li>å°è£…</li><li>ç»§æ‰¿</li><li>å¤šæ€</li></ul><p>é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰çš„ä¸‰å¤§ç‰¹å¾æ˜¯å°è£…ã€ç»§æ‰¿å’Œå¤šæ€ã€‚è¿™äº›ç‰¹å¾å…±åŒä¸ºåˆ›å»ºæ¨¡å—åŒ–ã€å¯é‡ç”¨å’Œæ˜“äºç»´æŠ¤çš„ä»£ç æä¾›äº†åŸºç¡€ã€‚</p><table><thead><tr><th>ç‰¹å¾</th><th>æè¿°</th><th>ä¼˜ç‚¹</th></tr></thead><tbody><tr><td>å°è£…</td><td>å°è£…æ˜¯æŠŠæ•°æ®ï¼ˆå±æ€§ï¼‰å’Œè¡Œä¸ºï¼ˆæ–¹æ³•ï¼‰ç»„åˆæˆä¸€ä¸ªå•å…ƒï¼ˆç±»ï¼‰ï¼Œå¹¶å¯¹æ•°æ®çš„è®¿é—®è¿›è¡Œé™åˆ¶å’Œä¿æŠ¤ã€‚åœ¨Javaä¸­ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨è®¿é—®ä¿®é¥°ç¬¦ï¼ˆå¦‚<code>private</code>, <code>public</code>ï¼‰æ¥å®ç°ã€‚</td><td>- æé«˜äº†æ•°æ®å®‰å…¨æ€§<br>- å‡å°‘äº†ä»£ç é—´çš„è€¦åˆ<br>- å¢å¼ºäº†ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§</td></tr><tr><td>ç»§æ‰¿</td><td>ç»§æ‰¿æ˜¯ä¸€ç§ä½¿å¾—ä¸€ä¸ªç±»ï¼ˆå­ç±»ï¼‰èƒ½å¤Ÿç»§æ‰¿å¦ä¸€ä¸ªç±»ï¼ˆçˆ¶ç±»ï¼‰çš„å±æ€§å’Œæ–¹æ³•çš„æœºåˆ¶ã€‚å­ç±»å¯ä»¥æ‰©å±•æˆ–ä¿®æ”¹ç»§æ‰¿è‡ªçˆ¶ç±»çš„è¡Œä¸ºã€‚</td><td>- ä¿ƒè¿›äº†ä»£ç çš„é‡ç”¨<br>- å»ºç«‹äº†ç±»ä¹‹é—´çš„å±‚æ¬¡å…³ç³»<br>- æé«˜äº†ä»£ç çš„å¯ç»´æŠ¤æ€§</td></tr><tr><td>å¤šæ€</td><td>å¤šæ€æ˜¯æŒ‡å…è®¸ä¸åŒç±»çš„å¯¹è±¡å¯¹åŒä¸€æ¶ˆæ¯ä½œå‡ºå“åº”çš„èƒ½åŠ›ï¼Œå³åŒä¸€æ“ä½œä½œç”¨äºä¸åŒçš„å¯¹è±¡æ—¶å¯ä»¥æœ‰ä¸åŒçš„è§£é‡Šå’Œè¡Œä¸ºã€‚</td><td>- å¢å¼ºäº†ç¨‹åºçš„çµæ´»æ€§å’Œæ‰©å±•æ€§<br>- å…è®¸ä¸åŒç±»çš„å¯¹è±¡è¢«ç»Ÿä¸€å¤„ç†</td></tr></tbody></table><blockquote><p>ç±»æ¯”</p></blockquote><ol><li><strong>å°è£…</strong>: å°±åƒä¸€ä¸ªå’–å•¡æœºï¼Œå®ƒéšè—äº†å†…éƒ¨çš„å¤æ‚æœºæ¢°è¿‡ç¨‹ï¼Œåªæš´éœ²å‡ºç®€å•çš„æ¥å£ï¼ˆæŒ‰é’®ï¼‰ç»™ç”¨æˆ·ä½¿ç”¨ã€‚</li><li><strong>ç»§æ‰¿</strong>: ç±»ä¼¼äºçˆ¶æ¯ä¸å­©å­çš„å…³ç³»ã€‚å­©å­ä¼šç»§æ‰¿çˆ¶æ¯çš„ä¸€äº›ç‰¹å¾ï¼ˆå¦‚çœ¼ç›çš„é¢œè‰²ï¼‰ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å‘å±•è‡ªå·±ç‹¬ç‰¹çš„ç‰¹æ€§ï¼ˆå¦‚ä¸åŒçš„èŒä¸šæŠ€èƒ½ï¼‰ã€‚</li><li><strong>å¤šæ€</strong>: å¯ä»¥æ¯”ä½œä¸€ä¸ªé€šç”¨çš„ç”µæºæ’åº§ã€‚ä¸åŒçš„ç”µå™¨ï¼ˆå³ä½¿æ˜¯ä¸åŒç±»å‹çš„ç”µå™¨ï¼‰éƒ½å¯ä»¥æ’å…¥åŒä¸€ä¸ªæ’åº§ï¼Œä½†æ’å…¥åçš„è¡Œä¸ºï¼ˆå¦‚å……ç”µã€è¿è½¬ï¼‰ä¾èµ–äºæ¥å…¥çš„å…·ä½“ç”µå™¨ã€‚</li></ol><h4 id="1-5ã€æ¥å£ä¸æŠ½è±¡ç±»"><a href="#1-5ã€æ¥å£ä¸æŠ½è±¡ç±»" class="headerlink" title="1.5ã€æ¥å£ä¸æŠ½è±¡ç±»"></a>1.5ã€æ¥å£ä¸æŠ½è±¡ç±»</h4><p>æ¥å£ï¼ˆInterfacesï¼‰å’ŒæŠ½è±¡ç±»ï¼ˆAbstract Classesï¼‰æ˜¯ç”¨äºå®ç°æŠ½è±¡å±‚æ¬¡çš„ä¸¤ç§ä¸»è¦æ–¹å¼ã€‚</p><p>å®ƒä»¬éƒ½ä¸èƒ½è¢«å®ä¾‹åŒ–ï¼Œä½†åœ¨ç”¨æ³•å’Œç›®çš„ä¸Šå­˜åœ¨ä¸€äº›å…³é”®åŒºåˆ«ã€‚</p><blockquote><p>å¯¹æ¯”</p></blockquote><table><thead><tr><th>ç‰¹å¾</th><th>æ¥å£ï¼ˆInterfacesï¼‰</th><th>æŠ½è±¡ç±»ï¼ˆAbstract Classesï¼‰</th></tr></thead><tbody><tr><td>å®ä¾‹åŒ–</td><td>ä¸èƒ½ç›´æ¥å®ä¾‹åŒ–ã€‚</td><td>ä¹Ÿä¸èƒ½ç›´æ¥å®ä¾‹åŒ–ã€‚</td></tr><tr><td>æ–¹æ³•å®šä¹‰</td><td>å¯ä»¥æœ‰é»˜è®¤æ–¹æ³•å’Œé™æ€æ–¹æ³•ã€‚æ‰€æœ‰æ–¹æ³•é»˜è®¤ä¸ºpublicã€‚ä¸éœ€è¦ä½¿ç”¨<code>abstract</code>å…³é”®å­—ã€‚</td><td>å¯ä»¥åŒ…å«æŠ½è±¡æ–¹æ³•ï¼ˆæ²¡æœ‰å®ç°ä½“çš„æ–¹æ³•ï¼‰å’ŒéæŠ½è±¡æ–¹æ³•ã€‚æŠ½è±¡æ–¹æ³•ä½¿ç”¨<code>abstract</code>å…³é”®å­—ã€‚</td></tr><tr><td>å±æ€§å®šä¹‰</td><td>åªèƒ½å®šä¹‰å¸¸é‡ï¼ˆé»˜è®¤ä¸ºpublic static finalï¼‰ã€‚</td><td>å¯ä»¥åŒ…å«éå¸¸é‡å­—æ®µï¼Œä¸”è¿™äº›å­—æ®µå¯ä»¥æœ‰å„ç§è®¿é—®æ§åˆ¶ã€‚</td></tr><tr><td>å®ç°&#x2F;æ‰©å±•</td><td>ä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ã€‚</td><td>ä¸€ä¸ªç±»åªèƒ½ç»§æ‰¿ä¸€ä¸ªæŠ½è±¡ç±»ã€‚</td></tr><tr><td>æ„é€ å™¨</td><td>ä¸èƒ½æœ‰æ„é€ å™¨ã€‚</td><td>å¯ä»¥æœ‰æ„é€ å™¨ã€‚</td></tr><tr><td>å¤šé‡ç»§æ‰¿çš„æ”¯æŒ</td><td>æ”¯æŒï¼ˆä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ï¼‰ã€‚</td><td>ä¸æ”¯æŒï¼ˆä¸€ä¸ªç±»åªèƒ½ç»§æ‰¿ä¸€ä¸ªç±»ï¼Œä½†å¯ä»¥å®ç°å¤šä¸ªæ¥å£ï¼‰ã€‚</td></tr><tr><td>é»˜è®¤æ–¹æ³•</td><td>Java 8ä¹‹åï¼Œæ¥å£å¯ä»¥æœ‰é»˜è®¤æ–¹æ³•ï¼ˆæœ‰æ–¹æ³•ä½“ï¼‰ã€‚</td><td>æŠ½è±¡ç±»å¯ä»¥æœ‰å…·æœ‰å®ç°çš„æ–¹æ³•ã€‚</td></tr><tr><td>è®¿é—®ä¿®é¥°ç¬¦é™åˆ¶</td><td>æ¥å£ä¸­çš„æ–¹æ³•é»˜è®¤æ˜¯publicçš„ï¼Œå±æ€§é»˜è®¤æ˜¯public static finalçš„ã€‚</td><td>æŠ½è±¡ç±»ä¸­çš„æ–¹æ³•å’Œå±æ€§å¯ä»¥æœ‰å¤šç§è®¿é—®ä¿®é¥°ç¬¦ã€‚</td></tr><tr><td>ä½¿ç”¨åœºæ™¯</td><td>å½“å„ä¸ªå®ç°ä¹‹é—´æ²¡æœ‰å…±äº«çš„ä»£ç ï¼Œä½†éœ€è¦å…±åŒéµå®ˆæŸäº›è§„åˆ™ï¼ˆæ–¹æ³•ï¼‰æ—¶ä½¿ç”¨ã€‚</td><td>å½“å„ä¸ªå®ç°ä¹‹é—´æœ‰å¤§é‡å…±äº«çš„ä»£ç æˆ–å±æ€§æ—¶ä½¿ç”¨ã€‚</td></tr></tbody></table><p>ç±»æ¯”</p><ol><li><strong>æ¥å£</strong>: å°±åƒä¸€ä¸ªæ ‡å‡†æˆ–åè®®ï¼Œå®ƒå®šä¹‰äº†è§„èŒƒï¼Œä½†ä¸æä¾›å®Œæ•´çš„å®ç°ã€‚å°±åƒç”µå™¨çš„æ’å¤´å’Œæ’åº§çš„æ ‡å‡†ï¼Œåˆ¶é€ å•†éœ€è¦æŒ‰ç…§è¿™ä¸ªæ ‡å‡†åˆ¶é€ äº§å“ã€‚</li><li><strong>æŠ½è±¡ç±»</strong>: å¯ä»¥çœ‹ä½œæ˜¯åŠæˆå“ï¼Œå®ƒå®šä¹‰äº†ä¸€äº›åŸºæœ¬åŠŸèƒ½å’Œç»“æ„ï¼Œä½†ç•™ä¸‹äº†ä¸€äº›ç©ºç™½ï¼ˆæŠ½è±¡æ–¹æ³•ï¼‰ä¾›ç»§æ‰¿å®ƒçš„å­ç±»å®Œæˆã€‚</li></ol><h4 id="1-6ã€æ·±æ‹·è´ä¸æµ…æ‹·è´ï¼Œå¼•ç”¨æ‹·è´"><a href="#1-6ã€æ·±æ‹·è´ä¸æµ…æ‹·è´ï¼Œå¼•ç”¨æ‹·è´" class="headerlink" title="1.6ã€æ·±æ‹·è´ä¸æµ…æ‹·è´ï¼Œå¼•ç”¨æ‹·è´"></a>1.6ã€æ·±æ‹·è´ä¸æµ…æ‹·è´ï¼Œå¼•ç”¨æ‹·è´</h4><p>åŒºåˆ«ï¼š</p><ul><li><strong>æµ…æ‹·è´</strong>ï¼šæµ…æ‹·è´ä¼šåœ¨å †ä¸Šåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼ˆåŒºåˆ«äºå¼•ç”¨æ‹·è´çš„ä¸€ç‚¹ï¼‰ï¼Œä¸è¿‡ï¼Œå¦‚æœåŸå¯¹è±¡å†…éƒ¨çš„å±æ€§æ˜¯å¼•ç”¨ç±»å‹çš„è¯ï¼Œæµ…æ‹·è´ä¼šç›´æ¥å¤åˆ¶å†…éƒ¨å¯¹è±¡çš„å¼•ç”¨åœ°å€ï¼Œä¹Ÿå°±æ˜¯è¯´æ‹·è´å¯¹è±¡å’ŒåŸå¯¹è±¡å…±ç”¨åŒä¸€ä¸ªå†…éƒ¨å¯¹è±¡ã€‚</li><li><strong>æ·±æ‹·è´</strong>ï¼šæ·±æ‹·è´ä¼šå®Œå…¨å¤åˆ¶æ•´ä¸ªå¯¹è±¡ï¼ŒåŒ…æ‹¬è¿™ä¸ªå¯¹è±¡æ‰€åŒ…å«çš„å†…éƒ¨å¯¹è±¡</li></ul><p>å¯¹æ¯”</p><table><thead><tr><th>ç±»å‹</th><th>æè¿°</th><th>ç»“æœ</th></tr></thead><tbody><tr><td>æµ…æ‹·è´</td><td>åªå¤åˆ¶å¯¹è±¡çš„åŸºæœ¬ç±»å‹å­—æ®µå’Œå¼•ç”¨ç±»å‹å­—æ®µçš„å¼•ç”¨ï¼Œä¸å¤åˆ¶å¼•ç”¨å¯¹è±¡æœ¬èº«ã€‚</td><td>ä¸¤ä¸ªå¯¹è±¡å…±äº«å¼•ç”¨ç±»å‹çš„æˆå‘˜ã€‚</td></tr><tr><td>æ·±æ‹·è´</td><td>å¤åˆ¶å¯¹è±¡çš„æ‰€æœ‰å­—æ®µï¼ŒåŒ…æ‹¬åŸºæœ¬ç±»å‹å’Œå¼•ç”¨ç±»å‹å­—æ®µï¼Œå¼•ç”¨ç±»å‹çš„å¯¹è±¡ä¹Ÿä¼šè¢«å¤åˆ¶ã€‚</td><td>ä¸¤ä¸ªå¯¹è±¡å®Œå…¨ç‹¬ç«‹ï¼Œä¸å…±äº«ä»»ä½•æˆå‘˜ã€‚</td></tr><tr><td>å¼•ç”¨æ‹·è´</td><td>åªå¤åˆ¶å¯¹è±¡çš„å¼•ç”¨ï¼Œä¸å¤åˆ¶å¯¹è±¡æœ¬èº«ã€‚</td><td>ä¸¤ä¸ªå¼•ç”¨æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ï¼Œä»»ä½•ä¸€ä¸ªå¯¹è±¡çš„æ”¹å˜éƒ½ä¼šå½±å“åˆ°å¦ä¸€ä¸ªã€‚</td></tr></tbody></table><p> ç±»æ¯”</p><ul><li><strong>æµ…æ‹·è´</strong>: å°±åƒæ‹æ‘„ä¸€å¼ ç”»ä½œçš„ç…§ç‰‡ï¼Œä½ å¾—åˆ°çš„æ˜¯ç”»ä½œçš„è¡¨é¢å¤åˆ¶å“ï¼Œä½†å®ƒä»ç„¶è¿æ¥ç€åŸæ¥çš„ç”»ã€‚</li><li><strong>æ·±æ‹·è´</strong>: å°±åƒå¤åˆ¶ä¸€ä¸ªç”»ä½œçš„æ¯ä¸€ç¬”ç»†èŠ‚æ¥åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„ç”»ä½œï¼Œå®Œå…¨ç‹¬ç«‹äºåŸä½œã€‚</li><li><strong>å¼•ç”¨æ‹·è´</strong>: å°±åƒç»™åˆ«äººç”»ä½œçš„ä¸€ä¸ªæŒ‡å‘åœ°å€ï¼Œä¸¤äººçœ‹çš„æ˜¯åŒä¸€å¹…ç”»ã€‚</li></ul><p>å›¾æè¿°ï¼š</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20240109211507.png" alt="image.png"></p><h3 id="äºŒã€Object"><a href="#äºŒã€Object" class="headerlink" title="äºŒã€Object"></a>äºŒã€Object</h3><h4 id="2-1-Object-ç±»çš„å¸¸ç”¨æ–¹æ³•"><a href="#2-1-Object-ç±»çš„å¸¸ç”¨æ–¹æ³•" class="headerlink" title="2.1 Object ç±»çš„å¸¸ç”¨æ–¹æ³•"></a>2.1 Object ç±»çš„å¸¸ç”¨æ–¹æ³•</h4><p>Object ç±»æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç±»ï¼Œæ˜¯æ‰€æœ‰ç±»çš„çˆ¶ç±»ã€‚å®ƒä¸»è¦æä¾›äº†ä»¥ä¸‹ 11 ä¸ªæ–¹æ³•ï¼š</p><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs processing"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * native æ–¹æ³•ï¼Œç”¨äºè¿”å›å½“å‰è¿è¡Œæ—¶å¯¹è±¡çš„ Class å¯¹è±¡ï¼Œä½¿ç”¨äº† final å…³é”®å­—ä¿®é¥°ï¼Œæ•…ä¸å…è®¸å­ç±»é‡å†™ã€‚</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">native</span> Class&lt;?&gt; <span class="hljs-title function_">getClass</span>()<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * native æ–¹æ³•ï¼Œç”¨äºè¿”å›å¯¹è±¡çš„å“ˆå¸Œç ï¼Œä¸»è¦ä½¿ç”¨åœ¨å“ˆå¸Œè¡¨ä¸­ï¼Œæ¯”å¦‚ JDK ä¸­çš„HashMapã€‚</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-type">int</span> <span class="hljs-title function_">hashCode</span>()<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * ç”¨äºæ¯”è¾ƒ 2 ä¸ªå¯¹è±¡çš„å†…å­˜åœ°å€æ˜¯å¦ç›¸ç­‰ï¼ŒString ç±»å¯¹è¯¥æ–¹æ³•è¿›è¡Œäº†é‡å†™ä»¥ç”¨äºæ¯”è¾ƒå­—ç¬¦ä¸²çš„å€¼æ˜¯å¦ç›¸ç­‰ã€‚</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">equals</span>(<span class="hljs-built_in">Object</span> obj)<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * native æ–¹æ³•ï¼Œç”¨äºåˆ›å»ºå¹¶è¿”å›å½“å‰å¯¹è±¡çš„ä¸€ä»½æ‹·è´ã€‚</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">native</span> <span class="hljs-built_in">Object</span> <span class="hljs-title function_">clone</span>() <span class="hljs-keyword">throws</span> CloneNotSupportedException<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * è¿”å›ç±»çš„åå­—å®ä¾‹çš„å“ˆå¸Œç çš„ 16 è¿›åˆ¶çš„å­—ç¬¦ä¸²ã€‚å»ºè®® Object æ‰€æœ‰çš„å­ç±»éƒ½é‡å†™è¿™ä¸ªæ–¹æ³•ã€‚</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-built_in">String</span> <span class="hljs-title function_">toString</span>()<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * native æ–¹æ³•ï¼Œå¹¶ä¸”ä¸èƒ½é‡å†™ã€‚å”¤é†’ä¸€ä¸ªåœ¨æ­¤å¯¹è±¡ç›‘è§†å™¨ä¸Šç­‰å¾…çš„çº¿ç¨‹(ç›‘è§†å™¨ç›¸å½“äºå°±æ˜¯é”çš„æ¦‚å¿µ)ã€‚å¦‚æœæœ‰å¤šä¸ªçº¿ç¨‹åœ¨ç­‰å¾…åªä¼šä»»æ„å”¤é†’ä¸€ä¸ªã€‚</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">notify</span>()<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * native æ–¹æ³•ï¼Œå¹¶ä¸”ä¸èƒ½é‡å†™ã€‚è·Ÿ notify ä¸€æ ·ï¼Œå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯ä¼šå”¤é†’åœ¨æ­¤å¯¹è±¡ç›‘è§†å™¨ä¸Šç­‰å¾…çš„æ‰€æœ‰çº¿ç¨‹ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªçº¿ç¨‹ã€‚</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">notifyAll</span>()<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * nativeæ–¹æ³•ï¼Œå¹¶ä¸”ä¸èƒ½é‡å†™ã€‚æš‚åœçº¿ç¨‹çš„æ‰§è¡Œã€‚æ³¨æ„ï¼šsleep æ–¹æ³•æ²¡æœ‰é‡Šæ”¾é”ï¼Œè€Œ wait æ–¹æ³•é‡Šæ”¾äº†é” ï¼Œtimeout æ˜¯ç­‰å¾…æ—¶é—´ã€‚</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">native</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">wait</span>(<span class="hljs-type">long</span> timeout) <span class="hljs-keyword">throws</span> InterruptedException<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * å¤šäº† nanos å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°è¡¨ç¤ºé¢å¤–æ—¶é—´ï¼ˆä»¥çº³ç§’ä¸ºå•ä½ï¼ŒèŒƒå›´æ˜¯ 0-999999ï¼‰ã€‚ æ‰€ä»¥è¶…æ—¶çš„æ—¶é—´è¿˜éœ€è¦åŠ ä¸Š nanos çº³ç§’ã€‚ã€‚</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">wait</span>(<span class="hljs-type">long</span> timeout, <span class="hljs-type">int</span> nanos) <span class="hljs-keyword">throws</span> InterruptedException<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * è·Ÿä¹‹å‰çš„2ä¸ªwaitæ–¹æ³•ä¸€æ ·ï¼Œåªä¸è¿‡è¯¥æ–¹æ³•ä¸€ç›´ç­‰å¾…ï¼Œæ²¡æœ‰è¶…æ—¶æ—¶é—´è¿™ä¸ªæ¦‚å¿µ</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">wait</span>() <span class="hljs-keyword">throws</span> InterruptedException<br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * å®ä¾‹è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶çš„æ—¶å€™è§¦å‘çš„æ“ä½œ</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">finalize</span>() <span class="hljs-keyword">throws</span> Throwable &#123; &#125;<br></code></pre></td></tr></table></figure><p>ä»¥ä¸‹æ˜¯Javaä¸­ <code>Object</code> ç±»çš„å¸¸ç”¨æ–¹æ³•çš„æ€»ç»“ï¼ŒåŒ…æ‹¬æ¯ä¸ªæ–¹æ³•çš„åŠŸèƒ½å’Œç‰¹æ€§ï¼š</p><table><thead><tr><th>æ–¹æ³•ç­¾å</th><th>è¿”å›ç±»å‹</th><th>æè¿°</th><th>ç‰¹æ€§</th></tr></thead><tbody><tr><td><code>public final native Class&lt;?&gt; getClass()</code></td><td><code>Class&lt;?&gt;</code></td><td>è¿”å›å½“å‰è¿è¡Œæ—¶å¯¹è±¡çš„Classå¯¹è±¡ã€‚</td><td>ä½¿ç”¨ <code>final</code> å’Œ <code>native</code> å…³é”®å­—ï¼Œä¸èƒ½è¢«å­ç±»é‡å†™</td></tr><tr><td><code>public native int hashCode()</code></td><td>int</td><td>è¿”å›å¯¹è±¡çš„å“ˆå¸Œç ï¼Œä¸»è¦ç”¨äºå“ˆå¸Œè¡¨ã€‚</td><td><code>native</code> æ–¹æ³•ï¼Œé€šå¸¸ä¸ <code>equals()</code> æ–¹æ³•ä¸€èµ·ä½¿ç”¨ã€‚</td></tr><tr><td><code>public boolean equals(Object obj)</code></td><td>boolean</td><td>æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„å†…å­˜åœ°å€æ˜¯å¦ç›¸ç­‰ã€‚Stringç±»é‡å†™äº†æ­¤æ–¹æ³•æ¥æ¯”è¾ƒå­—ç¬¦ä¸²å€¼ã€‚</td><td>å¯è¢«å­ç±»é‡å†™ä»¥æä¾›ç›¸ç­‰æ€§é€»è¾‘ã€‚</td></tr><tr><td><code>protected native Object clone()</code></td><td>Object</td><td>åˆ›å»ºå¹¶è¿”å›å½“å‰å¯¹è±¡çš„ä¸€ä»½æ‹·è´ã€‚</td><td><code>native</code> æ–¹æ³•ï¼Œç±»å¿…é¡»å®ç° <code>Cloneable</code> æ¥å£æ‰èƒ½ä½¿ç”¨æ­¤æ–¹æ³•ã€‚</td></tr><tr><td><code>public String toString()</code></td><td>String</td><td>è¿”å›å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºï¼Œé€šå¸¸åŒ…æ‹¬ç±»åå’Œå“ˆå¸Œç çš„16è¿›åˆ¶å­—ç¬¦ä¸²ã€‚</td><td>å»ºè®®æ‰€æœ‰å­ç±»é‡å†™æ­¤æ–¹æ³•ã€‚</td></tr><tr><td><code>public final native void notify()</code></td><td>void</td><td>å”¤é†’åœ¨æ­¤å¯¹è±¡ç›‘è§†å™¨ä¸Šç­‰å¾…çš„å•ä¸ªçº¿ç¨‹ã€‚</td><td>ä½¿ç”¨ <code>final</code> å’Œ <code>native</code> å…³é”®å­—ï¼Œä¸èƒ½è¢«å­ç±»é‡å†™ã€‚</td></tr><tr><td><code>public final native void notifyAll()</code></td><td>void</td><td>å”¤é†’åœ¨æ­¤å¯¹è±¡ç›‘è§†å™¨ä¸Šç­‰å¾…çš„æ‰€æœ‰çº¿ç¨‹ã€‚</td><td>ä½¿ç”¨ <code>final</code> å’Œ <code>native</code> å…³é”®å­—ï¼Œä¸èƒ½è¢«å­ç±»é‡å†™ã€‚</td></tr><tr><td><code>public final native void wait(long timeout)</code></td><td>void</td><td>ä½¿å½“å‰çº¿ç¨‹ç­‰å¾…ç›´åˆ°å¦ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ <code>notify()</code> æˆ– <code>notifyAll()</code>ï¼Œæˆ–è¶…æ—¶ã€‚</td><td>ä½¿ç”¨ <code>final</code> å’Œ <code>native</code> å…³é”®å­—ï¼Œä¸èƒ½è¢«å­ç±»é‡å†™ã€‚é‡Šæ”¾å¯¹è±¡çš„é”ã€‚</td></tr><tr><td><code>public final void wait(long timeout, int nanos)</code></td><td>void</td><td>ä½¿å½“å‰çº¿ç¨‹ç­‰å¾…ç›´åˆ°å¦ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ <code>notify()</code> æˆ– <code>notifyAll()</code>ï¼Œæˆ–è¶…æ—¶åŠ é¢å¤–çº³ç§’ã€‚</td><td>ä½¿ç”¨ <code>final</code> å…³é”®å­—ï¼Œä¸èƒ½è¢«å­ç±»é‡å†™ã€‚é‡Šæ”¾å¯¹è±¡çš„é”ã€‚</td></tr><tr><td><code>public final void wait()</code></td><td>void</td><td>ä½¿å½“å‰çº¿ç¨‹æ— é™æœŸç­‰å¾…ï¼Œç›´åˆ°å¦ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ <code>notify()</code> æˆ– <code>notifyAll()</code>ã€‚</td><td>ä½¿ç”¨ <code>final</code> å…³é”®å­—ï¼Œä¸èƒ½è¢«å­ç±»é‡å†™ã€‚é‡Šæ”¾å¯¹è±¡çš„é”ã€‚</td></tr><tr><td><code>protected void finalize()</code></td><td>void</td><td>åœ¨å¯¹è±¡è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶æ—¶è§¦å‘çš„æ“ä½œã€‚</td><td>åœ¨Java 9ä¸­è¢«å¼ƒç”¨ï¼Œä½†å­ç±»å¯ä»¥é‡å†™ä»¥è¿›è¡Œæ¸…ç†æ“ä½œã€‚</td></tr></tbody></table><p>è¿™äº›æ–¹æ³•æä¾›äº†å¯¹è±¡è¡Œä¸ºçš„åŸºæœ¬æ¡†æ¶ï¼Œä»å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†åˆ°çº¿ç¨‹é—´çš„é€šä¿¡ã€‚</p><h4 id="2-2-å’Œ-equals-çš„åŒºåˆ«"><a href="#2-2-å’Œ-equals-çš„åŒºåˆ«" class="headerlink" title="2.2 &#x3D;&#x3D; å’Œ equals() çš„åŒºåˆ«"></a>2.2 &#x3D;&#x3D; å’Œ equals() çš„åŒºåˆ«</h4><p>&#x3D;&#x3D;Â å¯¹äºåŸºæœ¬ç±»å‹å’Œå¼•ç”¨ç±»å‹çš„ä½œç”¨æ•ˆæœæ˜¯ä¸åŒçš„ï¼š</p><ul><li>å¯¹äºåŸºæœ¬æ•°æ®ç±»å‹æ¥è¯´ï¼Œ&#x3D;&#x3D;Â æ¯”è¾ƒçš„æ˜¯å€¼ã€‚</li><li>å¯¹äºå¼•ç”¨æ•°æ®ç±»å‹æ¥è¯´ï¼Œ&#x3D;&#x3D;Â æ¯”è¾ƒçš„æ˜¯å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚</li></ul><p>åœ¨Javaä¸­ï¼Œ&#x3D;&#x3D; è¿ç®—ç¬¦å’Œ<code>equals()</code>æ–¹æ³•ç”¨äºæ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡ï¼Œä½†å®ƒä»¬åœ¨æ¯”è¾ƒæ–¹å¼ä¸Šæœ‰æœ¬è´¨çš„ä¸åŒã€‚</p><blockquote><p>&#x3D;&#x3D; è¿ç®—ç¬¦</p></blockquote><ol><li><p><strong>ç”¨é€”</strong>: ä¸»è¦ç”¨äºæ¯”è¾ƒåŸºæœ¬æ•°æ®ç±»å‹çš„å€¼å’Œå¼•ç”¨ç±»å‹çš„åœ°å€ã€‚</p></li><li><p><strong>å¯¹åŸºæœ¬ç±»å‹</strong>: æ¯”è¾ƒä¸¤ä¸ªåŸºæœ¬ç±»å‹çš„å€¼æ˜¯å¦ç›¸åŒï¼ˆä¾‹å¦‚ï¼Œ<code>int</code>, <code>char</code>, <code>double</code>ç­‰ï¼‰ã€‚</p></li><li><p><strong>å¯¹å¼•ç”¨ç±»å‹</strong>: æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡å¼•ç”¨æ˜¯å¦æŒ‡å‘å†…å­˜ä¸­çš„åŒä¸€ä½ç½®ã€‚</p></li></ol><blockquote><p><code>equals()</code> æ–¹æ³•</p></blockquote><ol><li><p><strong>ç”¨é€”</strong>: ä¸»è¦ç”¨äºæ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„å†…å®¹æˆ–çŠ¶æ€æ˜¯å¦ç›¸ç­‰ã€‚</p></li><li><p><strong>é»˜è®¤è¡Œä¸º</strong>: åœ¨ <code>Object</code> ç±»ä¸­å®šä¹‰çš„ <code>equals()</code> æ–¹æ³•é»˜è®¤è¡Œä¸ºä¸  &#x3D;&#x3D; ç›¸åŒï¼Œå³æ¯”è¾ƒå¯¹è±¡çš„å†…å­˜åœ°å€ã€‚</p></li><li><p><strong>é‡å†™</strong>: å¤šæ•°ç±»ï¼Œå¦‚ <code>String</code>, <code>Date</code> ç­‰ï¼Œéƒ½é‡å†™äº† <code>equals()</code> æ–¹æ³•æ¥è¿›è¡Œé€»è¾‘æ¯”è¾ƒï¼Œå³æ¯”è¾ƒå¯¹è±¡çš„å†…å®¹è€Œä¸æ˜¯å†…å­˜åœ°å€ã€‚</p></li></ol><blockquote><p>è¡¨æ ¼æ¯”è¾ƒ</p></blockquote><table><thead><tr><th>ç‰¹æ€§</th><th>&#x3D;&#x3D; è¿ç®—ç¬¦</th><th><code>equals()</code> æ–¹æ³•</th></tr></thead><tbody><tr><td>æ¯”è¾ƒç±»å‹</td><td>åŸºæœ¬æ•°æ®ç±»å‹çš„å€¼ &#x2F; å¼•ç”¨ç±»å‹çš„å†…å­˜åœ°å€</td><td>å¯¹è±¡å†…å®¹ï¼ˆå¯é‡å†™ï¼‰</td></tr><tr><td>é»˜è®¤è¡Œä¸º</td><td>æ¯”è¾ƒå†…å­˜åœ°å€ï¼ˆå¯¹äºå¼•ç”¨ç±»å‹ï¼‰</td><td>åœ¨ <code>Object</code> ç±»ä¸­ä¹Ÿæ˜¯æ¯”è¾ƒå†…å­˜åœ°å€</td></tr><tr><td>å¯é‡å†™æ€§</td><td>ä¸å¯é‡å†™</td><td>å¯ä»¥é‡å†™ä»¥æä¾›è‡ªå®šä¹‰æ¯”è¾ƒé€»è¾‘</td></tr><tr><td>ä½¿ç”¨åœºæ™¯</td><td>å½“éœ€è¦æ£€æŸ¥ä¸¤ä¸ªå˜é‡æ˜¯å¦æŒ‡å‘ç›¸åŒçš„å¯¹è±¡æ—¶ä½¿ç”¨</td><td>å½“éœ€è¦æ£€æŸ¥ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦åœ¨é€»è¾‘ä¸Šç›¸ç­‰æ—¶ä½¿ç”¨</td></tr><tr><td>ä¾‹å­</td><td><code>a == b</code>ï¼ˆå¯¹äºåŸºæœ¬ç±»å‹æˆ–æ£€æŸ¥ä¸¤ä¸ªå¼•ç”¨æ˜¯å¦æŒ‡å‘åŒä¸€å¯¹è±¡ï¼‰</td><td><code>a.equals(b)</code>ï¼ˆå¯¹äºæ£€æŸ¥ä¸¤ä¸ªå¯¹è±¡çš„å†…å®¹æ˜¯å¦ç›¸ç­‰ï¼‰</td></tr></tbody></table><blockquote><p>ç±»æ¯”</p></blockquote><ul><li><p><strong>&#x3D;&#x3D; è¿ç®—ç¬¦</strong>: å°±åƒæ£€æŸ¥ä¸¤å¼ åç‰‡ä¸Šçš„åœ°å€æ˜¯å¦ä¸€æ ·ï¼Œå³ä½¿ä¸¤å¼ åç‰‡å±äºåŒä¸€äººï¼Œä½†å¦‚æœåœ°å€ä¸åŒï¼Œç»“æœå°±æ˜¯ä¸ç›¸ç­‰ã€‚</p></li><li><p><strong><code>equals()</code> æ–¹æ³•</strong>: å°±åƒæ¯”è¾ƒä¸¤ä¸ªäººçš„é¢è²Œï¼Œå³ä½¿ä»–ä»¬ä½åœ¨ä¸åŒçš„åœ°æ–¹ï¼ˆä¸åŒçš„å†…å­˜åœ°å€ï¼‰ï¼Œåªè¦é¢è²Œç›¸åŒï¼ˆå†…å®¹ç›¸åŒï¼‰ï¼Œå°±è®¤ä¸ºä»–ä»¬ç›¸ç­‰ã€‚</p></li></ul><p>æ‰©å±•çš„ä¸€äº›é—®é¢˜ï¼š</p><p>to be conteindâ€¦</p><h4 id="2-3-hashCode-æœ‰ä»€ä¹ˆç”¨"><a href="#2-3-hashCode-æœ‰ä»€ä¹ˆç”¨" class="headerlink" title="2.3 hashCode æœ‰ä»€ä¹ˆç”¨"></a>2.3 hashCode æœ‰ä»€ä¹ˆç”¨</h4><p><code>hashCode()</code>Â çš„ä½œç”¨æ˜¯è·å–å“ˆå¸Œç ï¼ˆ<code>int</code>Â æ•´æ•°ï¼‰ï¼Œä¹Ÿç§°ä¸ºæ•£åˆ—ç ã€‚è¿™ä¸ªå“ˆå¸Œç çš„ä½œç”¨æ˜¯ç¡®å®šè¯¥å¯¹è±¡åœ¨å“ˆå¸Œè¡¨ä¸­çš„ç´¢å¼•ä½ç½®ã€‚</p><p><code>hashCode()</code> å®šä¹‰åœ¨ JDK çš„ <code>Object</code> ç±»ä¸­ï¼Œè¿™å°±æ„å‘³ç€ Java ä¸­çš„ä»»ä½•ç±»éƒ½åŒ…å«æœ‰ <code>hashCode()</code> å‡½æ•°ã€‚å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼š<code>Object</code> çš„ <code>hashCode()</code> æ–¹æ³•æ˜¯æœ¬åœ°æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯ç”¨ C è¯­è¨€æˆ– C++ å®ç°çš„ã€‚</p><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs aspectj"><span class="hljs-keyword">public</span> <span class="hljs-keyword">native</span> <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">hashCode</span><span class="hljs-params">()</span></span>;<br></code></pre></td></tr></table></figure><p>æ•£åˆ—è¡¨å­˜å‚¨çš„æ˜¯é”®å€¼å¯¹(key-value)ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯ï¼š<strong>èƒ½æ ¹æ®â€œé”®â€å¿«é€Ÿçš„æ£€ç´¢å‡ºå¯¹åº”çš„â€œå€¼â€ã€‚è¿™å…¶ä¸­å°±åˆ©ç”¨åˆ°äº†æ•£åˆ—ç ï¼ï¼ˆå¯ä»¥å¿«é€Ÿæ‰¾åˆ°æ‰€éœ€è¦çš„å¯¹è±¡ï¼‰</strong></p><p>hashCode() å’Œ  equals() æ–¹æ³•</p><ul><li>å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„<code>hashCode</code> å€¼ç›¸ç­‰ï¼Œé‚£è¿™ä¸¤ä¸ªå¯¹è±¡ä¸ä¸€å®šç›¸ç­‰ï¼ˆå“ˆå¸Œç¢°æ’ï¼‰ã€‚</li><li>å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„<code>hashCode</code> å€¼ç›¸ç­‰å¹¶ä¸”<code>equals()</code>æ–¹æ³•ä¹Ÿè¿”å› <code>true</code>ï¼Œæˆ‘ä»¬æ‰è®¤ä¸ºè¿™ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰ã€‚</li><li>å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„<code>hashCode</code> å€¼ä¸ç›¸ç­‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥è®¤ä¸ºè¿™ä¸¤ä¸ªå¯¹è±¡ä¸ç›¸ç­‰ã€‚</li></ul><blockquote><p>ä¸ºä»€ä¹ˆé‡å†™ equals() æ—¶å¿…é¡»é‡å†™ hashCode() æ–¹æ³•ï¼Ÿ</p></blockquote><p>å› ä¸ºä¸¤ä¸ªç›¸ç­‰çš„å¯¹è±¡çš„ <code>hashCode</code> å€¼å¿…é¡»æ˜¯ç›¸ç­‰ã€‚ä¹Ÿå°±æ˜¯è¯´å¦‚æœ <code>equals</code> æ–¹æ³•åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡æ˜¯ç›¸ç­‰çš„ï¼Œé‚£è¿™ä¸¤ä¸ªå¯¹è±¡çš„ <code>hashCode</code> å€¼ä¹Ÿè¦ç›¸ç­‰ã€‚</p><p>å¦‚æœé‡å†™ <code>equals()</code> æ—¶æ²¡æœ‰é‡å†™ <code>hashCode()</code> æ–¹æ³•çš„è¯å°±å¯èƒ½ä¼šå¯¼è‡´ <code>equals</code> æ–¹æ³•åˆ¤æ–­æ˜¯ç›¸ç­‰çš„ä¸¤ä¸ªå¯¹è±¡ï¼Œ<code>hashCode</code> å€¼å´ä¸ç›¸ç­‰ã€‚</p><p><strong>æ€è€ƒ</strong>ï¼šé‡å†™ <code>equals()</code> æ—¶æ²¡æœ‰é‡å†™ <code>hashCode()</code> æ–¹æ³•çš„è¯ï¼Œä½¿ç”¨ <code>HashMap</code> å¯èƒ½ä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜ã€‚</p><p>å¦‚æœæ²¡æœ‰é‡å†™å“ˆå¸Œå‡½æ•°çš„è¯ï¼Œä¸¤ä¸ªé”®è·å–å“ˆå¸Œè¡¨ä½ç½®ç´¢å¼•å¯èƒ½ä¼šä¸å¯¹ï¼Œé€ æˆä¸€äº›ç°è±¡ï¼Œæ¯”å¦‚ï¼šåœ¨é›†åˆä¸­æŸ¥æ‰¾å¯¹è±¡æ—¶å¯èƒ½ä¼šå¤±è´¥ï¼Œå³ä½¿è¯¥å¯¹è±¡å·²ç»å­˜åœ¨ï¼›å³ä½¿ä½¿ç”¨ä¸€ä¸ªé€»è¾‘ä¸Šç›¸ç­‰çš„é”®å»æŸ¥æ‰¾ï¼Œä¹Ÿå¯èƒ½æ— æ³•æ‰¾åˆ°å¯¹åº”çš„å€¼ï¼Œå¯¼è‡´æ•°æ®è®¿é—®ä¸Šçš„é—®é¢˜ç­‰ã€‚</p><blockquote><p>æ•£åˆ—è¡¨</p></blockquote><p>æ•£åˆ—è¡¨ï¼ˆHash tableï¼Œä¹Ÿå«å“ˆå¸Œè¡¨ï¼‰ï¼Œæ˜¯æ ¹æ®é”®ï¼ˆKeyï¼‰è€Œç›´æ¥è®¿é—®åœ¨å­˜å‚¨å™¨å­˜å‚¨ä½ç½®çš„æ•°æ®ç»“æ„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒé€šè¿‡è®¡ç®—å‡ºä¸€ä¸ªé”®å€¼çš„å‡½æ•°ï¼Œå°†æ‰€éœ€æŸ¥è¯¢çš„æ•°æ®æ˜ å°„åˆ°è¡¨ä¸­ä¸€ä¸ªä½ç½®æ¥è®©äººè®¿é—®ï¼Œè¿™åŠ å¿«äº†æŸ¥æ‰¾é€Ÿåº¦ã€‚</p><p>è¿™ä¸ªæ˜ å°„å‡½æ•°ç§°åšæ•£åˆ—å‡½æ•°ï¼Œå­˜æ”¾è®°å½•çš„æ•°ç»„ç§°åšæ•£åˆ—è¡¨ã€‚</p><p>ä¸€ä¸ªé€šä¿—çš„ä¾‹å­æ˜¯ï¼Œ</p><p>ä¸ºäº†æŸ¥æ‰¾ç”µè¯ç°¿ä¸­æŸäººçš„å·ç ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªæŒ‰ç…§äººåé¦–å­—æ¯é¡ºåºæ’åˆ—çš„è¡¨ï¼ˆå³å»ºç«‹äººå x åˆ°é¦–å­—æ¯ F(x) çš„ä¸€ä¸ªå‡½æ•°å…³ç³»ï¼‰ï¼Œåœ¨é¦–å­—æ¯ä¸ºWçš„è¡¨ä¸­æŸ¥æ‰¾â€œç‹â€å§“çš„ç”µè¯å·ç ï¼Œæ˜¾ç„¶æ¯”ç›´æ¥æŸ¥æ‰¾å°±è¦å¿«å¾—å¤šã€‚è¿™é‡Œä½¿ç”¨äººåä½œä¸ºå…³é”®å­—ï¼Œâ€œå–é¦–å­—æ¯â€æ˜¯è¿™ä¸ªä¾‹å­ä¸­æ•£åˆ—å‡½æ•°çš„å‡½æ•°æ³•åˆ™ F( )ï¼Œå­˜æ”¾é¦–å­—æ¯çš„è¡¨å¯¹åº”æ•£åˆ—è¡¨ã€‚å…³é”®å­—å’Œå‡½æ•°æ³•åˆ™ç†è®ºä¸Šå¯ä»¥ä»»æ„ç¡®å®šã€‚</p><blockquote><p>å“ˆå¸Œè¡¨</p></blockquote><p>å“ˆå¸Œè¡¨ï¼ˆHash Tableï¼‰å…¶å®ä¹Ÿå«æ•£åˆ—è¡¨ï¼Œæ˜¯ä¸€ä¸ªæ•°æ®ç»“æ„ã€‚</p><p>å“ˆå¸Œè¡¨æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œåªä¸è¿‡æ•°ç»„å­˜æ”¾çš„æ˜¯å•ä¸€çš„æ•°æ®ï¼Œè€Œå“ˆå¸Œè¡¨ä¸­å­˜æ”¾çš„æ˜¯é”®å€¼å¯¹ï¼ˆkey - value pairï¼‰</p><p>key é€šè¿‡å“ˆå¸Œå‡½æ•°ï¼ˆhash functionï¼‰å¾—åˆ°æ•°ç»„çš„ç´¢å¼•ï¼Œè¿›è€Œå­˜å–ç´¢å¼•ä½ç½®çš„å€¼ã€‚</p><p>ä¸åŒçš„ key é€šè¿‡å“ˆå¸Œå‡½æ•°å¯èƒ½å¾—åˆ°ç›¸åŒçš„ç´¢å¼•å€¼ï¼Œæ­¤æ—¶ï¼Œäº§ç”Ÿäº†å“ˆå¸Œç¢°æ’ã€‚</p><p>é€šè¿‡åœ¨æ•°ç»„ä¸­æ’å…¥é“¾è¡¨æˆ–è€…äºŒå‰æ ‘ï¼Œå¯ä»¥è§£å†³å“ˆå¸Œç¢°æ’é—®é¢˜ã€‚</p><h3 id="ä¸‰ã€String"><a href="#ä¸‰ã€String" class="headerlink" title="ä¸‰ã€String"></a>ä¸‰ã€String</h3><h4 id="3-1-Stringã€StringBufferã€StringBuilder-çš„åŒºåˆ«ï¼Ÿ"><a href="#3-1-Stringã€StringBufferã€StringBuilder-çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="3.1  Stringã€StringBufferã€StringBuilder çš„åŒºåˆ«ï¼Ÿ"></a>3.1  Stringã€StringBufferã€StringBuilder çš„åŒºåˆ«ï¼Ÿ</h4><table><thead><tr><th>ç‰¹æ€§</th><th><code>String</code></th><th><code>StringBuffer</code></th><th><code>StringBuilder</code></th></tr></thead><tbody><tr><td>å¯å˜æ€§</td><td>ä¸å¯å˜</td><td>å¯å˜</td><td>å¯å˜</td></tr><tr><td>çº¿ç¨‹å®‰å…¨</td><td>æ˜¯</td><td>æ˜¯</td><td>å¦</td></tr><tr><td>æ€§èƒ½</td><td>è¾ƒä½ï¼ˆå¯¹äºé¢‘ç¹ä¿®æ”¹ï¼‰</td><td>é«˜ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰</td><td>é«˜ï¼ˆéçº¿ç¨‹å®‰å…¨ï¼‰</td></tr><tr><td>ç”¨é€”</td><td>æ–‡æœ¬ä¸é¢‘ç¹æ”¹å˜æ—¶</td><td>å¤šçº¿ç¨‹ä¸­æ–‡æœ¬é¢‘ç¹æ”¹å˜</td><td>å•çº¿ç¨‹ä¸­æ–‡æœ¬é¢‘ç¹æ”¹å˜</td></tr></tbody></table><h4 id="3-2-String-ä¸ºä»€ä¹ˆæ˜¯ä¸å¯å˜çš„"><a href="#3-2-String-ä¸ºä»€ä¹ˆæ˜¯ä¸å¯å˜çš„" class="headerlink" title="3.2 String ä¸ºä»€ä¹ˆæ˜¯ä¸å¯å˜çš„"></a>3.2 String ä¸ºä»€ä¹ˆæ˜¯ä¸å¯å˜çš„</h4><p><code>String</code> çœŸæ­£ä¸å¯å˜æœ‰ä¸‹é¢å‡ ç‚¹åŸå› ï¼š</p><ol><li>ä¿å­˜å­—ç¬¦ä¸²çš„æ•°ç»„è¢« <code>final</code> ä¿®é¥°ä¸”ä¸ºç§æœ‰çš„ï¼Œå¹¶ä¸”<code>String</code> ç±»æ²¡æœ‰æä¾›&#x2F;æš´éœ²ä¿®æ”¹è¿™ä¸ªå­—ç¬¦ä¸²çš„æ–¹æ³•ã€‚</li><li><code>String</code> ç±»è¢« <code>final</code> ä¿®é¥°å¯¼è‡´å…¶ä¸èƒ½è¢«ç»§æ‰¿ï¼Œè¿›è€Œé¿å…äº†å­ç±»ç ´å <code>String</code> ä¸å¯å˜</li></ol><h4 id="3-3-å­—ç¬¦ä¸²æ‹¼æ¥ç”¨â€œ-â€-è¿˜æ˜¯-StringBuilder"><a href="#3-3-å­—ç¬¦ä¸²æ‹¼æ¥ç”¨â€œ-â€-è¿˜æ˜¯-StringBuilder" class="headerlink" title="3.3  å­—ç¬¦ä¸²æ‹¼æ¥ç”¨â€œ+â€ è¿˜æ˜¯ StringBuilder?"></a>3.3  å­—ç¬¦ä¸²æ‹¼æ¥ç”¨â€œ+â€ è¿˜æ˜¯ StringBuilder?</h4><p>Java è¯­è¨€æœ¬èº«å¹¶ä¸æ”¯æŒè¿ç®—ç¬¦é‡è½½ï¼Œâ€œ+â€å’Œâ€œ+&#x3D;â€æ˜¯ä¸“é—¨ä¸º String ç±»é‡è½½è¿‡çš„è¿ç®—ç¬¦ï¼Œä¹Ÿæ˜¯ Java ä¸­ä»…æœ‰çš„ä¸¤ä¸ªé‡è½½è¿‡çš„è¿ç®—ç¬¦ã€‚</p><p>åœ¨JDK8ä¸­ï¼Œå­—ç¬¦ä¸²å¯¹è±¡é€šè¿‡â€œ+â€çš„å­—ç¬¦ä¸²æ‹¼æ¥æ–¹å¼ï¼Œå®é™…ä¸Šæ˜¯é€šè¿‡ <code>StringBuilder</code> è°ƒç”¨ <code>append()</code> æ–¹æ³•å®ç°çš„ï¼Œæ‹¼æ¥å®Œæˆä¹‹åè°ƒç”¨ <code>toString()</code> å¾—åˆ°ä¸€ä¸ª <code>String</code> å¯¹è±¡ ã€‚</p><p>ä¸è¿‡ï¼Œåœ¨å¾ªç¯å†…ä½¿ç”¨â€œ+â€è¿›è¡Œå­—ç¬¦ä¸²çš„æ‹¼æ¥çš„è¯ï¼Œå­˜åœ¨æ¯”è¾ƒæ˜æ˜¾çš„ç¼ºé™·ï¼š<strong>ç¼–è¯‘å™¨ä¸ä¼šåˆ›å»ºå•ä¸ª <code>StringBuilder</code> ä»¥å¤ç”¨ï¼Œä¼šå¯¼è‡´åˆ›å»ºè¿‡å¤šçš„ <code>StringBuilder</code> å¯¹è±¡</strong>ã€‚</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs arduino"><span class="hljs-type">String</span> str1 = <span class="hljs-string">&quot;he&quot;</span>;<br><span class="hljs-type">String</span> str2 = <span class="hljs-string">&quot;llo&quot;</span>;<br><span class="hljs-type">String</span> str3 = <span class="hljs-string">&quot;world&quot;</span>;<br><span class="hljs-type">String</span> str4 = str1 + str2 + str3;<br></code></pre></td></tr></table></figure><p>å¯¹åº”å­—èŠ‚ç </p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202401101412356.png" alt="image.png"></p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs arduino"><span class="hljs-type">String</span>[] arr = &#123;<span class="hljs-string">&quot;he&quot;</span>, <span class="hljs-string">&quot;llo&quot;</span>, <span class="hljs-string">&quot;world&quot;</span>&#125;;<br><span class="hljs-type">String</span> s = <span class="hljs-string">&quot;&quot;</span>;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; arr.length; i++) &#123;<br>    s += arr[i];<br>&#125;<br>System.out.<span class="hljs-built_in">println</span>(s);<br></code></pre></td></tr></table></figure><p><code>StringBuilder</code>Â å¯¹è±¡æ˜¯åœ¨å¾ªç¯å†…éƒ¨è¢«åˆ›å»ºçš„ï¼Œè¿™æ„å‘³ç€æ¯å¾ªç¯ä¸€æ¬¡å°±ä¼šåˆ›å»ºä¸€ä¸ªÂ <code>StringBuilder</code>Â å¯¹è±¡</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202401101412821.png" alt="image.png"></p><p>å¦‚æœç›´æ¥ä½¿ç”¨Â <code>StringBuilder</code>Â å¯¹è±¡è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥çš„è¯ï¼Œå°±ä¸ä¼šå­˜åœ¨è¿™ä¸ªé—®é¢˜ã€‚</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs haxe"><span class="hljs-keyword">String</span>[] arr = &#123;<span class="hljs-string">&quot;he&quot;</span>, <span class="hljs-string">&quot;llo&quot;</span>, <span class="hljs-string">&quot;world&quot;</span>&#125;;<br>StringBuilder s = <span class="hljs-keyword">new</span> <span class="hljs-type">StringBuilder</span>();<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">String</span> value : <span class="hljs-type">arr</span>) &#123;<br>    s.append(value);<br>&#125;<br>System.out.println(s);<br></code></pre></td></tr></table></figure><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202401101413874.png" alt="image.png"></p><p>è€Œåœ¨ JDK9ä¸­ï¼Œå­—ç¬¦ä¸²ç›¸åŠ  â€œ+â€ æ”¹ä¸ºäº†ç”¨åŠ¨æ€æ–¹æ³•Â <code>makeConcatWithConstants()</code>Â æ¥å®ç°ï¼Œè€Œä¸æ˜¯å¤§é‡çš„Â <code>StringBuilder</code>ï¼›è¿™ä¹Ÿæ„å‘³ç€ JDK 9 ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥æ”¾å¿ƒä½¿ç”¨â€œ+â€ è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥ã€‚</p><h4 id="3-4-String-equals-å’Œ-Object-equals-æœ‰ä½•åŒºåˆ«"><a href="#3-4-String-equals-å’Œ-Object-equals-æœ‰ä½•åŒºåˆ«" class="headerlink" title="3.4  String#equals() å’Œ Object#equals() æœ‰ä½•åŒºåˆ«"></a>3.4  String#equals() å’Œ Object#equals() æœ‰ä½•åŒºåˆ«</h4><p><code>String</code>Â ä¸­çš„Â <code>equals</code>Â æ–¹æ³•æ˜¯è¢«é‡å†™è¿‡çš„ï¼Œæ¯”è¾ƒçš„æ˜¯ String å­—ç¬¦ä¸²çš„å€¼æ˜¯å¦ç›¸ç­‰ã€‚Â <code>Object</code>Â çš„Â <code>equals</code>Â æ–¹æ³•æ˜¯æ¯”è¾ƒçš„å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚</p><h4 id="3-5-å­—ç¬¦ä¸²å¸¸é‡æ± -ğŸ"><a href="#3-5-å­—ç¬¦ä¸²å¸¸é‡æ± -ğŸ" class="headerlink" title="3.5 å­—ç¬¦ä¸²å¸¸é‡æ±    ğŸ"></a>3.5 å­—ç¬¦ä¸²å¸¸é‡æ±    ğŸ</h4><p><strong>å­—ç¬¦ä¸²å¸¸é‡æ± </strong>Â æ˜¯ JVM ä¸ºäº†æå‡æ€§èƒ½å’Œå‡å°‘å†…å­˜æ¶ˆè€—é’ˆå¯¹å­—ç¬¦ä¸²ï¼ˆString ç±»ï¼‰ä¸“é—¨å¼€è¾Ÿçš„ä¸€å—åŒºåŸŸï¼Œä¸»è¦ç›®çš„æ˜¯ä¸ºäº†é¿å…å­—ç¬¦ä¸²çš„é‡å¤åˆ›å»ºã€‚</p><p>to be continedâ€¦.</p><h4 id="3-6-String-s1-new-String-â€œabcâ€-è¿™å¥è¯åˆ›å»ºäº†å‡ ä¸ªå­—ç¬¦ä¸²å¯¹è±¡-ğŸ•"><a href="#3-6-String-s1-new-String-â€œabcâ€-è¿™å¥è¯åˆ›å»ºäº†å‡ ä¸ªå­—ç¬¦ä¸²å¯¹è±¡-ğŸ•" class="headerlink" title="3.6 String s1 &#x3D; new String(â€œabcâ€);è¿™å¥è¯åˆ›å»ºäº†å‡ ä¸ªå­—ç¬¦ä¸²å¯¹è±¡  ğŸ•"></a>3.6 String s1 &#x3D; new String(â€œabcâ€);è¿™å¥è¯åˆ›å»ºäº†å‡ ä¸ªå­—ç¬¦ä¸²å¯¹è±¡  ğŸ•</h4><p>ä¼šåˆ›å»º 1 æˆ– 2 ä¸ªå­—ç¬¦ä¸²å¯¹è±¡ã€‚</p><p>to be continedâ€¦</p><h4 id="3-7-intern-æ–¹æ³•"><a href="#3-7-intern-æ–¹æ³•" class="headerlink" title="3.7 intern æ–¹æ³•"></a>3.7 intern æ–¹æ³•</h4><p><code>String.intern()</code>Â æ˜¯ä¸€ä¸ª nativeï¼ˆæœ¬åœ°ï¼‰æ–¹æ³•ï¼Œå…¶ä½œç”¨æ˜¯å°†æŒ‡å®šçš„å­—ç¬¦ä¸²å¯¹è±¡çš„å¼•ç”¨ä¿å­˜åœ¨å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­</p><p>to be continedâ€¦</p><h4 id="3-8-String-ç±»å‹çš„å˜é‡å’Œå¸¸é‡åšâ€œ-â€è¿ç®—æ—¶å‘ç”Ÿäº†ä»€ä¹ˆ"><a href="#3-8-String-ç±»å‹çš„å˜é‡å’Œå¸¸é‡åšâ€œ-â€è¿ç®—æ—¶å‘ç”Ÿäº†ä»€ä¹ˆ" class="headerlink" title="3.8 String ç±»å‹çš„å˜é‡å’Œå¸¸é‡åšâ€œ+â€è¿ç®—æ—¶å‘ç”Ÿäº†ä»€ä¹ˆ"></a>3.8 String ç±»å‹çš„å˜é‡å’Œå¸¸é‡åšâ€œ+â€è¿ç®—æ—¶å‘ç”Ÿäº†ä»€ä¹ˆ</h4><p>to be continedâ€¦</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://javaguide.cn/java/basis/java-basic-questions-02.html">https://javaguide.cn/java/basis/java-basic-questions-02.html</a></li><li><a href="https://zh.wikipedia.org/wiki/%E5%93%88%E5%B8%8C%E8%A1%A8">https://zh.wikipedia.org/wiki/%E5%93%88%E5%B8%8C%E8%A1%A8</a></li><li><a href="https://www.cnblogs.com/Steven-HU/p/14505316.html">https://www.cnblogs.com/Steven-HU/p/14505316.html</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
      <category>Base</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JavaåŸºç¡€_åŸºç¡€å†…å®¹01</title>
    <link href="/2024/01/07/Java%E5%9F%BA%E7%A1%80_%E5%9F%BA%E7%A1%80%E5%86%85%E5%AE%B901/"/>
    <url>/2024/01/07/Java%E5%9F%BA%E7%A1%80_%E5%9F%BA%E7%A1%80%E5%86%85%E5%AE%B901/</url>
    
    <content type="html"><![CDATA[<h3 id="ä¸€ã€åŸºç¡€æ¦‚å¿µå’Œå¸¸è¯†"><a href="#ä¸€ã€åŸºç¡€æ¦‚å¿µå’Œå¸¸è¯†" class="headerlink" title="ä¸€ã€åŸºç¡€æ¦‚å¿µå’Œå¸¸è¯†"></a>ä¸€ã€åŸºç¡€æ¦‚å¿µå’Œå¸¸è¯†</h3><h4 id="1-1ã€Javaè¯­è¨€çš„ç‰¹ç‚¹"><a href="#1-1ã€Javaè¯­è¨€çš„ç‰¹ç‚¹" class="headerlink" title="1.1ã€Javaè¯­è¨€çš„ç‰¹ç‚¹"></a>1.1ã€Javaè¯­è¨€çš„ç‰¹ç‚¹</h4><p>æ¯”è¾ƒå¤šçš„ç‰¹ç‚¹ï¼Œç›®å‰ Java ä¸­åœ¨å®é™…é¡¹ç›®å¼€å‘ä¸­çœŸæ­£å¼ºå¤§çš„æ˜¯Java çš„ç”Ÿæ€ï¼›</p><p>ä¸”æŠ€æœ¯æ˜¯æœåŠ¡äºä¸šåŠ¡çš„ï¼Œå°±ä¸šç‡å’Œä½¿ç”¨ç‡åœ¨å›½å†…å æ¯”è¾ƒå¤§ã€‚</p><p>ç‰¹ç‚¹ï¼š</p><ul><li>å¹³å°æ— å…³æ€§</li><li>é¢å‘å¯¹è±¡ï¼ˆå°è£…ã€ç»§æ‰¿ã€å¤šæ€ï¼‰</li><li>æ”¯æŒå¤šçº¿ç¨‹</li><li>å¯é æ€§</li><li>å®‰å…¨æ€§</li><li>â€¦â€¦</li></ul><h4 id="1-2ã€Java-SE-vs-Java-EE"><a href="#1-2ã€Java-SE-vs-Java-EE" class="headerlink" title="1.2ã€Java SE  vs Java EE"></a>1.2ã€Java SE  vs Java EE</h4><p>Java SE ï¼ˆJava Platformï¼ŒStandard Editionï¼‰ æ˜¯ Java çš„åŸºç¡€ç‰ˆæœ¬ï¼ŒJava EE  ï¼ˆJava Platform, Enterprise Edition ï¼‰æ˜¯ Java çš„é«˜çº§ç‰ˆæœ¬ã€‚</p><blockquote><p>åŸºæœ¬ä»‹ç»ï¼š</p></blockquote><p>Java SEæ˜¯Javaç¼–ç¨‹è¯­è¨€çš„æ ‡å‡†ç‰ˆï¼Œå®ƒæä¾›äº†Javaè¯­è¨€çš„æ ¸å¿ƒåŠŸèƒ½ï¼ŒåŒ…æ‹¬ï¼š</p><ul><li><strong>åŸºæœ¬è¯­è¨€ç‰¹æ€§</strong>ï¼šå¦‚å˜é‡ã€æ•°ç»„ã€å¾ªç¯ã€æ¡ä»¶è¯­å¥ç­‰ã€‚</li><li><strong>æ ¸å¿ƒç±»åº“</strong>ï¼šæä¾›äº†åŸºç¡€çš„ç±»åº“ï¼ŒåŒ…æ‹¬æ•°æ®ç±»å‹ã€æ•°å­¦å‡½æ•°ã€æ–‡ä»¶å¤„ç†ã€ç½‘ç»œç¼–ç¨‹ã€å¹¶å‘ç¼–ç¨‹ç­‰ã€‚</li><li><strong>å›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ˆGUIï¼‰</strong>: å¦‚AWTï¼ˆAbstract Window Toolkitï¼‰å’ŒSwingã€‚</li><li><strong>Javaè™šæ‹Ÿæœºï¼ˆJVMï¼‰</strong>: Javaç¨‹åºçš„è¿è¡Œç¯å¢ƒã€‚</li><li><strong>å·¥å…·</strong>: å¦‚ç¼–è¯‘å™¨ï¼ˆjavacï¼‰ï¼Œè§£é‡Šå™¨ï¼ˆjavaï¼‰ï¼Œæ‰“åŒ…å·¥å…·ï¼ˆjarï¼‰ç­‰ã€‚</li></ul><p>Java EEæ˜¯Javaçš„ä¼ä¸šç‰ˆï¼Œå®ƒåœ¨Java SEçš„åŸºç¡€ä¸Šå¢åŠ äº†ç”¨äºæ„å»ºå¤§å‹ä¼ä¸šçº§åº”ç”¨çš„åŠŸèƒ½ã€‚Java EEåŒ…æ‹¬ï¼š</p><ul><li><strong>æ‰©å±•çš„ç±»åº“</strong>: åœ¨Java SEçš„åŸºç¡€ä¸Šæä¾›äº†é¢å¤–çš„ç±»åº“å’ŒAPIï¼Œç”¨äºä¼ä¸šçº§åº”ç”¨å¼€å‘ã€‚</li><li><strong>æœåŠ¡å™¨ç«¯æŠ€æœ¯</strong>: å¦‚Servletsã€JavaServer Pagesï¼ˆJSPï¼‰ã€Enterprise JavaBeansï¼ˆEJBï¼‰ç­‰ã€‚</li><li><strong>WebæœåŠ¡</strong>: æ”¯æŒåˆ›å»ºå’Œæ¶ˆè´¹WebæœåŠ¡ã€‚</li><li><strong>æŒä¹…åŒ–API</strong>: å¦‚Java Persistence APIï¼ˆJPAï¼‰ã€‚</li><li><strong>åˆ†å¸ƒå¼è®¡ç®—</strong>: æ”¯æŒæ„å»ºå¤§å‹ã€åˆ†å¸ƒå¼çš„å¤šå±‚åº”ç”¨ã€‚</li><li><strong>é›†æˆæŠ€æœ¯</strong>: å¦‚JMSï¼ˆJava Message Serviceï¼‰å’ŒJavaMailã€‚</li></ul><blockquote><p>æ€»ç»“</p></blockquote><ul><li><strong>Java SE</strong> æä¾›äº†Javaè¯­è¨€çš„åŸºç¡€ï¼Œæ›´é€‚åˆå¼€å‘æ¡Œé¢åº”ç”¨ç¨‹åºæˆ–ç®€å•çš„æœåŠ¡å™¨åº”ç”¨ç¨‹åº</li><li><strong>Java EE</strong> åœ¨Java SEçš„åŸºç¡€ä¸Šå¢åŠ äº†ä¼ä¸šçº§ç‰¹æ€§ï¼Œæ›´é€‚åˆå¼€å‘å¤æ‚çš„ä¼ä¸šçº§åº”ç”¨ç¨‹åºæˆ– Web åº”ç”¨ç¨‹åº</li></ul><h4 id="1-3ã€JVM-vs-JDK-vs-JRE"><a href="#1-3ã€JVM-vs-JDK-vs-JRE" class="headerlink" title="1.3ã€JVM vs JDK  vs  JRE"></a>1.3ã€JVM vs JDK  vs  JRE</h4><ul><li>Java è™šæ‹Ÿæœºï¼ˆJVMï¼‰æ˜¯è¿è¡Œ Java å­—èŠ‚ç çš„è™šæ‹Ÿæœº</li><li>JDK ï¼ˆJava Development Kitï¼‰æ˜¯å®Œæ•´çš„Javaè½¯ä»¶å¼€å‘å·¥å…·åŒ…</li><li>JREï¼ˆJava Runtime Environmentï¼‰ æ˜¯ Java è¿è¡Œæ—¶ç¯å¢ƒ</li></ul><p>JDK &gt;  JRE  &gt;  JVM</p><p>å…³ç³»å¯ä»¥çœ‹è¿™å¼ å›¾ï¼š<br><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202401081433625.png" alt="image.png"></p><hr><p><strong>JVM å¹¶ä¸æ˜¯åªæœ‰ä¸€ç§ï¼åªè¦æ»¡è¶³ JVM è§„èŒƒï¼Œæ¯ä¸ªå…¬å¸ã€ç»„ç»‡æˆ–è€…ä¸ªäººéƒ½å¯ä»¥å¼€å‘è‡ªå·±çš„ä¸“å± JVMã€‚</strong> </p><p>æˆ‘ä»¬å¹³æ—¶æ¥è§¦åˆ°çš„ HotSpot VM ä»…ä»…æ˜¯æ˜¯ JVM è§„èŒƒçš„ä¸€ç§å®ç°ã€‚</p><p>é™¤äº†æˆ‘ä»¬å¹³æ—¶æœ€å¸¸ç”¨çš„ HotSpot VM å¤–ï¼Œè¿˜æœ‰ J9 VMã€Zing VMã€JRockit VM ç­‰ JVM ã€‚</p><p>JDKï¼ˆJava Development Kitï¼‰ï¼Œå®ƒæ˜¯åŠŸèƒ½é½å…¨çš„ Java SDKï¼Œæ˜¯æä¾›ç»™å¼€å‘è€…ä½¿ç”¨ï¼Œèƒ½å¤Ÿåˆ›å»ºå’Œç¼–è¯‘ Java ç¨‹åºçš„å¼€å‘å¥—ä»¶ã€‚å®ƒåŒ…å«äº† JREï¼ŒåŒæ—¶è¿˜åŒ…å«äº†ç¼–è¯‘ java æºç çš„ç¼–è¯‘å™¨ javac ä»¥åŠä¸€äº›å…¶ä»–å·¥å…·æ¯”å¦‚ javadocï¼ˆæ–‡æ¡£æ³¨é‡Šå·¥å…·ï¼‰ã€jdbï¼ˆè°ƒè¯•å™¨ï¼‰ã€jconsoleï¼ˆåŸºäº JMX çš„å¯è§†åŒ–ç›‘æ§â¼¯å…·ï¼‰ã€javapï¼ˆåç¼–è¯‘å·¥å…·ï¼‰ç­‰ç­‰ã€‚</p><p>JREï¼ˆJava Runtime Environmentï¼‰ æ˜¯ Java è¿è¡Œæ—¶ç¯å¢ƒã€‚å®ƒæ˜¯è¿è¡Œå·²ç¼–è¯‘ Java ç¨‹åºæ‰€éœ€çš„æ‰€æœ‰å†…å®¹çš„é›†åˆï¼Œä¸»è¦åŒ…æ‹¬ Java è™šæ‹Ÿæœºï¼ˆJVMï¼‰ã€Java åŸºç¡€ç±»åº“ï¼ˆClass Libraryï¼‰ã€‚</p><h4 id="1-4ã€JIT"><a href="#1-4ã€JIT" class="headerlink" title="1.4ã€JIT"></a>1.4ã€JIT</h4><p>ç•¥</p><h4 id="1-5ã€ç¼–è¯‘ä¸è§£é‡Š"><a href="#1-5ã€ç¼–è¯‘ä¸è§£é‡Š" class="headerlink" title="1.5ã€ç¼–è¯‘ä¸è§£é‡Š"></a>1.5ã€ç¼–è¯‘ä¸è§£é‡Š</h4><p>é«˜çº§ç¼–ç¨‹è¯­è¨€æŒ‰ç…§ç¨‹åºçš„æ‰§è¡Œæ–¹å¼åˆ†ä¸ºä¸¤ç§ï¼š</p><ul><li>ç¼–è¯‘å‹ï¼šç¼–è¯‘å‹è¯­è¨€open in new window ä¼šé€šè¿‡ç¼–è¯‘å™¨open in new windowå°†æºä»£ç ä¸€æ¬¡æ€§ç¿»è¯‘æˆå¯è¢«è¯¥å¹³å°æ‰§è¡Œçš„æœºå™¨ç ã€‚<ul><li>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç¼–è¯‘è¯­è¨€çš„æ‰§è¡Œé€Ÿåº¦æ¯”è¾ƒå¿«ï¼Œå¼€å‘æ•ˆç‡æ¯”è¾ƒä½ã€‚å¸¸è§çš„ç¼–è¯‘æ€§è¯­è¨€æœ‰ Cã€C++ã€Goã€Rust ç­‰ç­‰ã€‚</li></ul></li><li>è§£é‡Šå‹ï¼šè§£é‡Šå‹è¯­è¨€open in new windowä¼šé€šè¿‡è§£é‡Šå™¨open in new windowä¸€å¥ä¸€å¥çš„å°†ä»£ç è§£é‡Šï¼ˆinterpretï¼‰ä¸ºæœºå™¨ä»£ç åå†æ‰§è¡Œã€‚<ul><li>è§£é‡Šå‹è¯­è¨€å¼€å‘æ•ˆç‡æ¯”è¾ƒå¿«ï¼Œæ‰§è¡Œé€Ÿåº¦æ¯”è¾ƒæ…¢ã€‚å¸¸è§çš„è§£é‡Šæ€§è¯­è¨€æœ‰ Pythonã€JavaScriptã€PHP ç­‰ç­‰</li></ul></li></ul><blockquote><p>ä¸ºä»€ä¹ˆè¯´ Java è¯­è¨€â€œç¼–è¯‘ä¸è§£é‡Šå¹¶å­˜â€ï¼Ÿ  â†’   å…ˆç¼–è¯‘ åè§£é‡Š</p></blockquote><p>è¿™æ˜¯å› ä¸º Java è¯­è¨€æ—¢å…·æœ‰ç¼–è¯‘å‹è¯­è¨€çš„ç‰¹å¾ï¼Œä¹Ÿå…·æœ‰è§£é‡Šå‹è¯­è¨€çš„ç‰¹å¾ã€‚</p><p>å› ä¸º Java ç¨‹åºè¦ç»è¿‡å…ˆç¼–è¯‘ï¼Œåè§£é‡Šä¸¤ä¸ªæ­¥éª¤ï¼Œç”± Java ç¼–å†™çš„ç¨‹åºéœ€è¦å…ˆç»è¿‡ç¼–è¯‘æ­¥éª¤ï¼Œç”Ÿæˆå­—èŠ‚ç ï¼ˆ.class æ–‡ä»¶ï¼‰ï¼Œè¿™ç§å­—èŠ‚ç å¿…é¡»ç”± Java è§£é‡Šå™¨æ¥è§£é‡Šæ‰§è¡Œã€‚</p><h4 id="1-6ã€AOT"><a href="#1-6ã€AOT" class="headerlink" title="1.6ã€AOT"></a>1.6ã€AOT</h4><p>ç•¥</p><h4 id="1-7ã€Oracle-JDK-vs-OpenJDK"><a href="#1-7ã€Oracle-JDK-vs-OpenJDK" class="headerlink" title="1.7ã€Oracle JDK vs OpenJDK"></a>1.7ã€Oracle JDK vs OpenJDK</h4><p>JDK åŸæ¥æ˜¯ SUN å…¬å¸å¼€å‘çš„ï¼Œåæ¥ SUN å…¬å¸åˆå–ç»™äº† Oracle å…¬å¸;  åŸæ¥çš„ SUN å…¬å¸æŠŠ JDK ç»™å¼€æºäº†ï¼› Oracle å…¬å¸å°±ç±»ä¼¼å¼€äº†ä¸€ä¸ªåˆ†æ”¯ï¼Œåšäº†ä¸€ä¸ªé—­æºç‰ˆæœ¬ã€‚</p><blockquote><p>åŒºåˆ«ï¼š</p></blockquote><p> OpenJDK</p><ol><li><strong>å¼€æº</strong>ï¼šOpenJDKæ˜¯ä¸€ä¸ªå¼€æ”¾æºä»£ç çš„Java SEå¹³å°å®ç°ï¼Œå®ƒæ˜¯è‡ªç”±è½¯ä»¶å¹¶ä¸”å…¬å¼€å‘å¸ƒã€‚å®ƒæ˜¯Oracle JDKçš„åŸºç¡€ã€‚</li><li><strong>ç¤¾åŒºé©±åŠ¨</strong>ï¼šç”±å¼€æºç¤¾åŒºç»´æŠ¤å’Œæ›´æ–°ã€‚å®ƒé€šå¸¸æ˜¯æœ€å…ˆè·å¾—æœ€æ–°è¯­è¨€ç‰¹æ€§å’Œä¿®å¤çš„ç‰ˆæœ¬ã€‚</li><li><strong>è®¸å¯è¯</strong>ï¼šä½¿ç”¨GPLï¼ˆé€šç”¨å…¬å…±è®¸å¯è¯ï¼‰v2è®¸å¯è¯ï¼Œå¸¦æœ‰Classpathä¾‹å¤–ï¼Œå…è®¸ä¸å—GPLé™åˆ¶åœ°ä½¿ç”¨ç±»åº“ã€‚</li><li><strong>æ›´æ–°</strong>ï¼šé€šå¸¸æ›´åŠ é¢‘ç¹åœ°è·å¾—æ›´æ–°å’Œè¡¥ä¸ã€‚</li><li><strong>å¹¿æ³›ä½¿ç”¨</strong>ï¼šç”±äºå…¶å¼€æºæ€§è´¨ï¼Œè¢«å¹¿æ³›ç”¨äºå„ç§ç¯å¢ƒï¼ŒåŒ…æ‹¬å•†ä¸šåº”ç”¨ã€‚</li></ol><p>Oracle JDK</p><ol><li><strong>Oracleå®˜æ–¹ç‰ˆæœ¬</strong>ï¼šOracle JDKæ˜¯ç”±Oracleå…¬å¸æä¾›çš„Java SEå¹³å°çš„å®˜æ–¹å®ç°ã€‚å®ƒåŸºäºOpenJDKï¼Œå¹¶åŒ…å«äº†ä¸€äº›é™„åŠ ç»„ä»¶ã€‚</li><li><strong>å•†ä¸šç”¨é€”è®¸å¯è´¹</strong>ï¼šOracle JDKçš„æ—©æœŸç‰ˆæœ¬å…è´¹ç”¨äºä¸ªäººå’Œå¼€å‘ç”¨é€”ï¼Œä½†ä»JDK 11å¼€å§‹ï¼ŒOracleæ›´æ”¹äº†è®¸å¯ç­–ç•¥ï¼Œå¯¹äºå•†ä¸šç”¨é€”æˆ–ç”Ÿäº§ç¯å¢ƒä¸­çš„ä½¿ç”¨éœ€è¦ä»˜è´¹ã€‚</li><li><strong>æ€§èƒ½ä¼˜åŒ–å’Œé™„åŠ ç‰¹æ€§</strong>ï¼šOracle JDKå¯èƒ½åŒ…æ‹¬ä¸€äº›ä¸“æœ‰çš„æ€§èƒ½å¢å¼ºå’Œå…¶ä»–ç‰¹æ€§ï¼Œå¦‚JRockitæˆ–Mission Controlã€‚</li><li><strong>æ”¯æŒ</strong>ï¼šOracleæä¾›ä¸“ä¸šçš„é•¿æœŸæ”¯æŒæœåŠ¡ï¼Œé€‚åˆä¼ä¸šç”¨æˆ·ã€‚</li><li><strong>æ›´æ–°é¢‘ç‡</strong>ï¼šOracle JDKçš„æ›´æ–°å¯èƒ½ä¸å¦‚OpenJDKé¢‘ç¹ï¼Œä½†æ›´ç¨³å®šï¼Œç»è¿‡äº†æ›´ä¸¥æ ¼çš„æµ‹è¯•ã€‚</li></ol><blockquote><p>æ€»ç»“</p></blockquote><ul><li><strong>OpenJDK</strong> æ˜¯ä¸€ä¸ªå®Œå…¨å¼€æºçš„JDKç‰ˆæœ¬ï¼Œé€‚ç”¨äºéœ€è¦å…è´¹ã€å¼€æºè§£å†³æ–¹æ¡ˆçš„åœºæ™¯ã€‚</li><li><strong>Oracle JDK</strong> æä¾›äº†ä¸€äº›é™„åŠ ç‰¹æ€§å’Œä¸“ä¸šæ”¯æŒï¼Œé€‚ç”¨äºéœ€è¦ç¨³å®šæ”¯æŒå’Œä¼ä¸šçº§ç‰¹æ€§çš„å•†ä¸šåº”ç”¨ã€‚</li></ul><h4 id="1-8ã€Java-å’Œ-C-çš„åŒºåˆ«"><a href="#1-8ã€Java-å’Œ-C-çš„åŒºåˆ«" class="headerlink" title="1.8ã€Java å’Œ C++ çš„åŒºåˆ«?"></a>1.8ã€Java å’Œ C++ çš„åŒºåˆ«?</h4><p>ç¨å¾®è®°ä¸€ä¸‹ã€‚</p><p>è™½ç„¶ï¼ŒJava å’Œ C++ éƒ½æ˜¯é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œéƒ½æ”¯æŒå°è£…ã€ç»§æ‰¿å’Œå¤šæ€ï¼Œä½†æ˜¯ï¼Œå®ƒä»¬è¿˜æ˜¯æœ‰æŒºå¤šä¸ç›¸åŒçš„åœ°æ–¹ï¼š</p><ul><li>Java ä¸æä¾›æŒ‡é’ˆæ¥ç›´æ¥è®¿é—®å†…å­˜ï¼Œç¨‹åºå†…å­˜æ›´åŠ å®‰å…¨</li><li>Java çš„ç±»æ˜¯å•ç»§æ‰¿çš„ï¼ŒC++ æ”¯æŒå¤šé‡ç»§æ‰¿ï¼›è™½ç„¶ Java çš„ç±»ä¸å¯ä»¥å¤šç»§æ‰¿ï¼Œä½†æ˜¯æ¥å£å¯ä»¥å¤šç»§æ‰¿ã€‚</li><li>Java æœ‰è‡ªåŠ¨å†…å­˜ç®¡ç†åƒåœ¾å›æ”¶æœºåˆ¶(GC)ï¼Œä¸éœ€è¦ç¨‹åºå‘˜æ‰‹åŠ¨é‡Šæ”¾æ— ç”¨å†…å­˜ã€‚</li><li>C ++åŒæ—¶æ”¯æŒæ–¹æ³•é‡è½½å’Œæ“ä½œç¬¦é‡è½½ï¼Œä½†æ˜¯ Java åªæ”¯æŒæ–¹æ³•é‡è½½ï¼ˆæ“ä½œç¬¦é‡è½½å¢åŠ äº†å¤æ‚æ€§ï¼Œè¿™ä¸ Java æœ€åˆçš„è®¾è®¡æ€æƒ³ä¸ç¬¦ï¼‰</li><li>â€¦â€¦.</li></ul><h3 id="äºŒã€åŸºæœ¬è¯­æ³•"><a href="#äºŒã€åŸºæœ¬è¯­æ³•" class="headerlink" title="äºŒã€åŸºæœ¬è¯­æ³•"></a>äºŒã€åŸºæœ¬è¯­æ³•</h3><h4 id="2-1-æ³¨é‡Š"><a href="#2-1-æ³¨é‡Š" class="headerlink" title="2.1 æ³¨é‡Š"></a>2.1 æ³¨é‡Š</h4><ol><li><p><strong>å•è¡Œæ³¨é‡Š</strong>ï¼šé€šå¸¸ç”¨äºè§£é‡Šæ–¹æ³•å†…æŸå•è¡Œä»£ç çš„ä½œç”¨ã€‚</p></li><li><p><strong>å¤šè¡Œæ³¨é‡Š</strong>ï¼šé€šå¸¸ç”¨äºè§£é‡Šä¸€æ®µä»£ç çš„ä½œç”¨ã€‚</p></li><li><p><strong>æ–‡æ¡£æ³¨é‡Š</strong>ï¼šé€šå¸¸ç”¨äºç”Ÿæˆ Java å¼€å‘æ–‡æ¡£ã€‚</p></li></ol><h4 id="2-2-æ ‡è¯†ç¬¦å’Œå…³é”®å­—"><a href="#2-2-æ ‡è¯†ç¬¦å’Œå…³é”®å­—" class="headerlink" title="2.2 æ ‡è¯†ç¬¦å’Œå…³é”®å­—"></a>2.2 æ ‡è¯†ç¬¦å’Œå…³é”®å­—</h4><p>åœ¨æˆ‘ä»¬ç¼–å†™ç¨‹åºçš„æ—¶å€™ï¼Œéœ€è¦å¤§é‡åœ°ä¸ºç¨‹åºã€ç±»ã€å˜é‡ã€æ–¹æ³•ç­‰å–åå­—ï¼Œäºæ˜¯å°±æœ‰äº† <strong>æ ‡è¯†ç¬¦</strong> ã€‚ç®€å•æ¥è¯´ï¼Œ <strong>æ ‡è¯†ç¬¦å°±æ˜¯ä¸€ä¸ªåå­—</strong> ã€‚</p><p>æœ‰ä¸€äº›æ ‡è¯†ç¬¦ï¼ŒJava è¯­è¨€å·²ç»èµ‹äºˆäº†å…¶ç‰¹æ®Šçš„å«ä¹‰ï¼Œåªèƒ½ç”¨äºç‰¹å®šçš„åœ°æ–¹ï¼Œè¿™äº›ç‰¹æ®Šçš„æ ‡è¯†ç¬¦å°±æ˜¯ <strong>å…³é”®å­—</strong> ã€‚ç®€å•æ¥è¯´ï¼Œ<strong>å…³é”®å­—æ˜¯è¢«èµ‹äºˆç‰¹æ®Šå«ä¹‰çš„æ ‡è¯†ç¬¦</strong> ã€‚</p><blockquote><p>å…³é”®å­—</p></blockquote><table><thead><tr><th>åˆ†ç±»</th><th>å…³é”®å­—</th><th></th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><td>è®¿é—®æ§åˆ¶</td><td>private</td><td>protected</td><td>public</td><td></td><td></td><td></td><td></td></tr><tr><td>ç±»ï¼Œæ–¹æ³•å’Œå˜é‡ä¿®é¥°ç¬¦</td><td>abstract</td><td>class</td><td>extends</td><td>final</td><td>implements</td><td>interface</td><td>native</td></tr><tr><td></td><td>new</td><td>static</td><td>strictfp</td><td>synchronized</td><td>transient</td><td>volatile</td><td>enum</td></tr><tr><td>ç¨‹åºæ§åˆ¶</td><td>break</td><td>continue</td><td>return</td><td>do</td><td>while</td><td>if</td><td>else</td></tr><tr><td></td><td>for</td><td>instanceof</td><td>switch</td><td>case</td><td>default</td><td>assert</td><td></td></tr><tr><td>é”™è¯¯å¤„ç†</td><td>try</td><td>catch</td><td>throw</td><td>throws</td><td>finally</td><td></td><td></td></tr><tr><td>åŒ…ç›¸å…³</td><td>import</td><td>package</td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>åŸºæœ¬ç±»å‹</td><td>boolean</td><td>byte</td><td>char</td><td>double</td><td>float</td><td>int</td><td>long</td></tr><tr><td></td><td>short</td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td>å˜é‡å¼•ç”¨</td><td>super</td><td>this</td><td>void</td><td></td><td></td><td></td><td></td></tr><tr><td>ä¿ç•™å­—</td><td>goto</td><td>const</td><td></td><td></td><td></td><td></td><td></td></tr></tbody></table><blockquote><p>Tipsï¼šæ‰€æœ‰çš„å…³é”®å­—éƒ½æ˜¯å°å†™çš„ï¼Œåœ¨ IDE ä¸­ä¼šä»¥ç‰¹æ®Šé¢œè‰²æ˜¾ç¤ºã€‚</p><p><code>default</code> è¿™ä¸ªå…³é”®å­—å¾ˆç‰¹æ®Šï¼Œæ—¢å±äºç¨‹åºæ§åˆ¶ï¼Œä¹Ÿå±äºç±»ï¼Œæ–¹æ³•å’Œå˜é‡ä¿®é¥°ç¬¦ï¼Œè¿˜å±äºè®¿é—®æ§åˆ¶ã€‚</p></blockquote><ul><li>åœ¨ç¨‹åºæ§åˆ¶ä¸­ï¼Œå½“åœ¨ <code>switch</code> ä¸­åŒ¹é…ä¸åˆ°ä»»ä½•æƒ…å†µæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>default</code> æ¥ç¼–å†™é»˜è®¤åŒ¹é…çš„æƒ…å†µã€‚</li><li>åœ¨ç±»ï¼Œæ–¹æ³•å’Œå˜é‡ä¿®é¥°ç¬¦ä¸­ï¼Œä» JDK8 å¼€å§‹å¼•å…¥äº†é»˜è®¤æ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨ <code>default</code> å…³é”®å­—æ¥å®šä¹‰ä¸€ä¸ªæ–¹æ³•çš„é»˜è®¤å®ç°ã€‚</li><li>åœ¨è®¿é—®æ§åˆ¶ä¸­ï¼Œå¦‚æœä¸€ä¸ªæ–¹æ³•å‰æ²¡æœ‰ä»»ä½•ä¿®é¥°ç¬¦ï¼Œåˆ™é»˜è®¤ä¼šæœ‰ä¸€ä¸ªä¿®é¥°ç¬¦ <code>default</code>ï¼Œä½†æ˜¯è¿™ä¸ªä¿®é¥°ç¬¦åŠ ä¸Šäº†å°±ä¼šæŠ¥é”™ã€‚</li></ul><p>âš ï¸ æ³¨æ„ï¼šè™½ç„¶ <code>true</code>, <code>false</code>, å’Œ <code>null</code> çœ‹èµ·æ¥åƒå…³é”®å­—ä½†å®é™…ä¸Šä»–ä»¬æ˜¯å­—é¢å€¼ï¼ŒåŒæ—¶ä½ ä¹Ÿä¸å¯ä»¥ä½œä¸ºæ ‡è¯†ç¬¦æ¥ä½¿ç”¨ã€‚</p><h4 id="2-3-è‡ªå¢è‡ªå‡è¿ç®—ç¬¦"><a href="#2-3-è‡ªå¢è‡ªå‡è¿ç®—ç¬¦" class="headerlink" title="2.3 è‡ªå¢è‡ªå‡è¿ç®—ç¬¦"></a>2.3 è‡ªå¢è‡ªå‡è¿ç®—ç¬¦</h4><div style="background-color: #ecf0f1; color: #34495e; padding: 15px; border: 2px solid #bdc3c7; border-radius: 5px;">  <strong>ç¬¦å·åœ¨å‰å°±å…ˆåŠ /å‡ï¼Œç¬¦å·åœ¨åå°±ååŠ /å‡</strong></div><p>Javaä¸­çš„è‡ªå¢ï¼ˆ<code>++</code>ï¼‰å’Œè‡ªå‡ï¼ˆ<code>--</code>ï¼‰è¿ç®—ç¬¦æ˜¯å¸¸ç”¨çš„ä¸€å…ƒè¿ç®—ç¬¦ï¼Œç”¨äºå¢åŠ æˆ–å‡å°‘å˜é‡çš„å€¼ã€‚</p><blockquote><p>è‡ªå¢è¿ç®—ç¬¦ï¼ˆ<code>++</code>ï¼‰</p></blockquote><p>è‡ªå¢è¿ç®—ç¬¦<code>++</code>ç”¨äºå°†å˜é‡çš„å€¼å¢åŠ 1ã€‚å®ƒæœ‰ä¸¤ç§å½¢å¼ï¼š</p><ol><li><p><strong>å‰ç¼€è‡ªå¢</strong>ï¼š<code>++var</code>ã€‚åœ¨è¡¨è¾¾å¼æ±‚å€¼ä¹‹å‰å¢åŠ å˜é‡çš„å€¼ã€‚</p><ul><li>ä¾‹å¦‚ï¼š</li><li><code>int a = 5; int b = ++a; // å…ˆå°†aå¢åŠ 1ï¼Œå˜æˆ6ï¼Œç„¶åå°†açš„å€¼èµ‹ç»™bï¼Œbä¹Ÿæ˜¯6</code></li></ul></li><li><p><strong>åç¼€è‡ªå¢</strong>ï¼š<code>var++</code>ã€‚åœ¨è¡¨è¾¾å¼æ±‚å€¼ä¹‹åå¢åŠ å˜é‡çš„å€¼ã€‚</p><ul><li>ä¾‹å¦‚ï¼š</li><li><code>int a = 5; int b = a++; // å…ˆå°†açš„å€¼èµ‹ç»™bï¼Œbæ˜¯5ï¼Œç„¶åaå¢åŠ 1ï¼Œå˜æˆ6</code></li></ul></li></ol><blockquote><p>è‡ªå‡è¿ç®—ç¬¦ï¼ˆ<code>--</code>ï¼‰</p></blockquote><p>è‡ªå‡è¿ç®—ç¬¦<code>--</code>ç”¨äºå°†å˜é‡çš„å€¼å‡å°‘1ã€‚å®ƒåŒæ ·æœ‰ä¸¤ç§å½¢å¼ï¼š</p><ol><li><p><strong>å‰ç¼€è‡ªå‡</strong>ï¼š<code>--var</code>ã€‚åœ¨è¡¨è¾¾å¼æ±‚å€¼ä¹‹å‰å‡å°‘å˜é‡çš„å€¼ã€‚</p><ul><li>ä¾‹å¦‚ï¼š</li><li><code>int a = 5; int b = --a; // å…ˆå°†aå‡å°‘1ï¼Œå˜æˆ4ï¼Œç„¶åå°†açš„å€¼èµ‹ç»™bï¼Œbä¹Ÿæ˜¯4</code></li></ul></li><li><p><strong>åç¼€è‡ªå‡</strong>ï¼š<code>var--</code>ã€‚åœ¨è¡¨è¾¾å¼æ±‚å€¼ä¹‹åå‡å°‘å˜é‡çš„å€¼ã€‚</p><ul><li>ä¾‹å¦‚ï¼š</li><li><code>int a = 5; int b = a--; // å…ˆå°†açš„å€¼èµ‹ç»™bï¼Œbæ˜¯5ï¼Œç„¶åaå‡å°‘1ï¼Œå˜æˆ4</code></li></ul></li></ol><blockquote><p>ä½¿ç”¨åœºæ™¯å’Œæ³¨æ„äº‹é¡¹</p></blockquote><ul><li>è¿™äº›è¿ç®—ç¬¦é€šå¸¸ç”¨åœ¨å¾ªç¯å’Œç®€å•çš„æ•°å€¼æ“ä½œä¸­ã€‚</li><li>é€‰æ‹©å‰ç¼€è¿˜æ˜¯åç¼€å½¢å¼å–å†³äºä½ å¸Œæœ›åœ¨è¡¨è¾¾å¼å…¶ä»–éƒ¨åˆ†ä½¿ç”¨å˜é‡çš„å“ªä¸ªå€¼ï¼ˆå¢åŠ æˆ–å‡å°‘å‰çš„å€¼ï¼Œè¿˜æ˜¯å¢åŠ æˆ–å‡å°‘åçš„å€¼ï¼‰ã€‚</li><li>åœ¨å•ç‹¬ä½¿ç”¨æ—¶ï¼ˆä¸ä½œä¸ºæ›´å¤§è¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†ï¼‰ï¼Œå‰ç¼€å’Œåç¼€å½¢å¼çš„æ•ˆæœæ˜¯ç›¸åŒçš„ã€‚</li></ul><blockquote><p>è¿›é˜¶é—®é¢˜</p></blockquote><p>è€ƒè™‘ä»¥ä¸‹ä»£ç ç‰‡æ®µï¼š</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">int i</span> = 1; <br><span class="hljs-attribute">int j</span> = i++ + ++i;<br></code></pre></td></tr></table></figure><p>æ­¤æ—¶ j çš„å€¼æ˜¯å¤šå°‘ï¼Ÿ</p><p><strong>åˆ†æï¼š</strong></p><p>ç»™å®šä»£ç åˆ†æ</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">int i</span> = 1; <br><span class="hljs-attribute">int j</span> = i++ + ++i;<br></code></pre></td></tr></table></figure><ol><li><strong>ç¬¬ä¸€ä¸ªæ“ä½œ - <code>i++</code></strong> (åç¼€è‡ªå¢): è¿™ä¸ªæ“ä½œé¦–å…ˆè¿”å›<code>i</code>çš„å½“å‰å€¼ï¼Œç„¶å<code>i</code>çš„å€¼å¢åŠ 1ã€‚æ‰€ä»¥ï¼Œåœ¨è¿™ä¸ªè¡¨è¾¾å¼çš„è¿™ä¸€éƒ¨åˆ†ï¼Œ<code>i</code>çš„å€¼è¢«è§†ä¸º1ï¼Œä½†ä¹‹å<code>i</code>å˜æˆäº†2ã€‚</li><li><strong>ç¬¬äºŒä¸ªæ“ä½œ - <code>++i</code></strong> (å‰ç¼€è‡ªå¢): åœ¨æ‰§è¡Œè¿™ä¸ªæ“ä½œæ—¶ï¼Œ<code>i</code>å·²ç»æ˜¯2äº†ã€‚ç°åœ¨ï¼Œç”±äºæ˜¯å‰ç¼€è‡ªå¢ï¼Œ<code>i</code>é¦–å…ˆè¢«å¢åŠ 1ï¼Œå˜æˆ3ï¼Œç„¶åè¿™ä¸ªå€¼è¢«ç”¨äºè¡¨è¾¾å¼ã€‚æ‰€ä»¥ï¼Œè¿™ä¸€éƒ¨åˆ†çš„å€¼æ˜¯3ã€‚</li><li><strong>ç»“æœ</strong>: ç»“åˆè¿™ä¸¤éƒ¨åˆ†ï¼Œ<code>j = 1 + 3</code>ï¼Œæ‰€ä»¥<code>j</code>çš„æœ€ç»ˆå€¼æ˜¯4ã€‚</li></ol><p>å…³é”®ç‚¹</p><ul><li>åç¼€è‡ªå¢(<code>i++</code>)å…ˆè¿”å›å½“å‰å€¼ï¼Œç„¶åå¢åŠ ã€‚</li><li>å‰ç¼€è‡ªå¢(<code>++i</code>)å…ˆå¢åŠ ï¼Œç„¶åè¿”å›å¢åŠ åçš„å€¼ã€‚</li><li>åœ¨åŒ…å«å¤šä¸ªè‡ªå¢&#x2F;è‡ªå‡æ“ä½œçš„å¤åˆè¡¨è¾¾å¼ä¸­ï¼Œç†è§£æ±‚å€¼çš„é¡ºåºéå¸¸é‡è¦ã€‚</li></ul><h4 id="2-4-ç§»ä½è¿ç®—ç¬¦"><a href="#2-4-ç§»ä½è¿ç®—ç¬¦" class="headerlink" title="2.4 ç§»ä½è¿ç®—ç¬¦"></a>2.4 ç§»ä½è¿ç®—ç¬¦</h4><ul><li><code>&lt;&lt;</code> :å·¦ç§»è¿ç®—ç¬¦ï¼Œå‘å·¦ç§»è‹¥å¹²ä½ï¼Œé«˜ä½ä¸¢å¼ƒï¼Œä½ä½è¡¥é›¶ã€‚<code>x &lt;&lt; 1</code>,ç›¸å½“äº x ä¹˜ä»¥ 2(ä¸æº¢å‡ºçš„æƒ…å†µä¸‹)ã€‚</li><li><code>&gt;&gt;</code> :å¸¦ç¬¦å·å³ç§»ï¼Œå‘å³ç§»è‹¥å¹²ä½ï¼Œé«˜ä½è¡¥ç¬¦å·ä½ï¼Œä½ä½ä¸¢å¼ƒã€‚æ­£æ•°é«˜ä½è¡¥ 0,è´Ÿæ•°é«˜ä½è¡¥ 1ã€‚<code>x &gt;&gt; 1</code>,ç›¸å½“äº x é™¤ä»¥ 2ã€‚</li><li><code>&gt;&gt;&gt;</code> :æ— ç¬¦å·å³ç§»ï¼Œå¿½ç•¥ç¬¦å·ä½ï¼Œç©ºä½éƒ½ä»¥ 0 è¡¥é½ã€‚</li></ul><h4 id="2-5-continueã€break-å’Œ-return-çš„åŒºåˆ«"><a href="#2-5-continueã€break-å’Œ-return-çš„åŒºåˆ«" class="headerlink" title="2.5 continueã€break å’Œ return çš„åŒºåˆ«"></a>2.5 continueã€break å’Œ return çš„åŒºåˆ«</h4><p>å…³é”®è¯ï¼š</p><ol><li><code>continue</code>ï¼šæŒ‡è·³å‡ºå½“å‰çš„è¿™ä¸€æ¬¡å¾ªç¯ï¼Œç»§ç»­ä¸‹ä¸€æ¬¡å¾ªç¯ã€‚</li><li><code>break</code>ï¼šæŒ‡è·³å‡ºæ•´ä¸ªå¾ªç¯ä½“ï¼Œç»§ç»­æ‰§è¡Œå¾ªç¯ä¸‹é¢çš„è¯­å¥ã€‚</li></ol><p><code>return</code> ç”¨äºè·³å‡ºæ‰€åœ¨æ–¹æ³•ï¼Œç»“æŸè¯¥æ–¹æ³•çš„è¿è¡Œã€‚return ä¸€èˆ¬æœ‰ä¸¤ç§ç”¨æ³•ï¼š</p><ol><li><code>return;</code>ï¼šç›´æ¥ä½¿ç”¨ return ç»“æŸæ–¹æ³•æ‰§è¡Œï¼Œç”¨äºæ²¡æœ‰è¿”å›å€¼å‡½æ•°çš„æ–¹æ³•</li><li><code>return value;</code>ï¼šreturn ä¸€ä¸ªç‰¹å®šå€¼ï¼Œç”¨äºæœ‰è¿”å›å€¼å‡½æ•°çš„æ–¹æ³•</li></ol><h3 id="ä¸‰ã€åŸºæœ¬æ•°æ®ç±»å‹"><a href="#ä¸‰ã€åŸºæœ¬æ•°æ®ç±»å‹" class="headerlink" title="ä¸‰ã€åŸºæœ¬æ•°æ®ç±»å‹"></a>ä¸‰ã€åŸºæœ¬æ•°æ®ç±»å‹</h3><h4 id="3-1ã€Java-ä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹"><a href="#3-1ã€Java-ä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹" class="headerlink" title="3.1ã€Java ä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹"></a>3.1ã€Java ä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹</h4><table><thead><tr><th>ç±»å‹</th><th>åŸºç¡€ç±»å‹</th><th>é»˜è®¤å€¼</th><th>å ç”¨ç©ºé—´å¤§å°</th><th>ä½æ•°</th><th>å–å€¼èŒƒå›´</th><th>å¯¹åº”åŒ…è£…ç±»å‹</th></tr></thead><tbody><tr><td>æ•°å­—ç±»å‹</td><td>byte</td><td>0</td><td>1å­—èŠ‚</td><td>8</td><td>-128 ~ 127</td><td>Byte</td></tr><tr><td>æ•°å­—ç±»å‹</td><td>short</td><td>0</td><td>2å­—èŠ‚</td><td>16</td><td>-32768ï¼ˆ-2^15ï¼‰ ~ 32767ï¼ˆ2^15 - 1ï¼‰</td><td>Short</td></tr><tr><td>æ•°å­—ç±»å‹</td><td>int</td><td>0</td><td>4å­—èŠ‚</td><td>16</td><td>-2147483648 ~ 2147483647</td><td>Integer</td></tr><tr><td>æ•°å­—ç±»å‹</td><td>long</td><td>0L</td><td>8å­—èŠ‚</td><td>32</td><td>-9223372036854775808ï¼ˆ-2^63ï¼‰ ~ 9223372036854775807ï¼ˆ2^63 -1ï¼‰</td><td>Long</td></tr><tr><td>æ•°å­—ç±»å‹</td><td>float</td><td>0.0f</td><td>4å­—èŠ‚</td><td>23</td><td>1.4E-45 ~ 3.4028235E38</td><td>Float</td></tr><tr><td>æ•°å­—ç±»å‹</td><td>double</td><td>0.0d</td><td>8å­—èŠ‚</td><td>64</td><td>4.9E-324 ~ 1.7976931348623157E308</td><td>Double</td></tr><tr><td>å­—ç¬¦ç±»å‹</td><td>char</td><td>â€˜\u0000â€™ï¼ˆå³ç©ºå­—ç¬¦ï¼‰</td><td>2å­—èŠ‚ï¼ˆä½¿ç”¨Unicodeç¼–ç ï¼‰</td><td>16</td><td>0 ~ 65535ï¼ˆ2^16 - 1ï¼‰</td><td>Character</td></tr><tr><td>å¸ƒå°”ç±»å‹</td><td>boolean</td><td>false</td><td>1å­—èŠ‚</td><td>1</td><td>trueã€false</td><td>Boolean</td></tr></tbody></table><h4 id="3-2-åŸºæœ¬ç±»å‹å’ŒåŒ…è£…ç±»å‹"><a href="#3-2-åŸºæœ¬ç±»å‹å’ŒåŒ…è£…ç±»å‹" class="headerlink" title="3.2 åŸºæœ¬ç±»å‹å’ŒåŒ…è£…ç±»å‹"></a>3.2 åŸºæœ¬ç±»å‹å’ŒåŒ…è£…ç±»å‹</h4><blockquote><p>åŒºåˆ«</p></blockquote><ul><li><strong>ç”¨é€”</strong>ï¼šé™¤äº†å®šä¹‰ä¸€äº›å¸¸é‡å’Œå±€éƒ¨å˜é‡ä¹‹å¤–ï¼Œæˆ‘ä»¬åœ¨å…¶ä»–åœ°æ–¹æ¯”å¦‚æ–¹æ³•å‚æ•°ã€å¯¹è±¡å±æ€§ä¸­å¾ˆå°‘ä¼šä½¿ç”¨åŸºæœ¬ç±»å‹æ¥å®šä¹‰å˜é‡ã€‚å¹¶ä¸”ï¼ŒåŒ…è£…ç±»å‹å¯ç”¨äºæ³›å‹ï¼Œè€ŒåŸºæœ¬ç±»å‹ä¸å¯ä»¥ã€‚</li><li><strong>å­˜å‚¨æ–¹å¼</strong>ï¼šåŸºæœ¬æ•°æ®ç±»å‹çš„å±€éƒ¨å˜é‡å­˜æ”¾åœ¨ Java è™šæ‹Ÿæœºæ ˆä¸­çš„å±€éƒ¨å˜é‡è¡¨ä¸­ï¼ŒåŸºæœ¬æ•°æ®ç±»å‹çš„æˆå‘˜å˜é‡ï¼ˆæœªè¢« <code>static</code> ä¿®é¥° ï¼‰å­˜æ”¾åœ¨ Java è™šæ‹Ÿæœºçš„å †ä¸­ã€‚åŒ…è£…ç±»å‹å±äºå¯¹è±¡ç±»å‹ï¼Œæˆ‘ä»¬çŸ¥é“å‡ ä¹æ‰€æœ‰å¯¹è±¡å®ä¾‹éƒ½å­˜åœ¨äºå †ä¸­ã€‚</li><li><strong>å ç”¨ç©ºé—´</strong>ï¼šç›¸æ¯”äºåŒ…è£…ç±»å‹ï¼ˆå¯¹è±¡ç±»å‹ï¼‰ï¼Œ åŸºæœ¬æ•°æ®ç±»å‹å ç”¨çš„ç©ºé—´å¾€å¾€éå¸¸å°ã€‚</li><li><strong>é»˜è®¤å€¼</strong>ï¼šæˆå‘˜å˜é‡åŒ…è£…ç±»å‹ä¸èµ‹å€¼å°±æ˜¯ <code>null</code> ï¼Œè€ŒåŸºæœ¬ç±»å‹æœ‰é»˜è®¤å€¼ä¸”ä¸æ˜¯ <code>null</code>ã€‚</li><li><strong>æ¯”è¾ƒæ–¹å¼</strong>ï¼š</li></ul><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">æ¯”è¾ƒæ–¹å¼<br><br>å¯¹äºåŸºæœ¬æ•°æ®ç±»å‹æ¥è¯´ï¼Œ`==`Â æ¯”è¾ƒçš„æ˜¯å€¼ã€‚å¯¹äºåŒ…è£…æ•°æ®ç±»å‹æ¥è¯´ï¼Œ`==`Â æ¯”è¾ƒçš„æ˜¯å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚æ‰€æœ‰æ•´å‹åŒ…è£…ç±»å¯¹è±¡ä¹‹é—´å€¼çš„æ¯”è¾ƒï¼Œå…¨éƒ¨ä½¿ç”¨Â `equals()`Â æ–¹æ³•ã€‚<br></code></pre></td></tr></table></figure><blockquote><p>ç‰¹ç‚¹</p></blockquote><ol><li><strong>å¯¹è±¡ç‰¹æ€§</strong>ï¼šåŒ…è£…ç±»å‹æ˜¯å¯¹è±¡ï¼Œå¯ä»¥è°ƒç”¨å„ç§æ–¹æ³•ï¼Œä¾‹å¦‚<code>Integer.parseInt()</code>ã€‚</li><li><strong>å¯ç”¨äºæ³›å‹</strong>ï¼šåœ¨é›†åˆç±»ç­‰ä½¿ç”¨æ³›å‹çš„åœºåˆï¼Œåªèƒ½ä½¿ç”¨å¯¹è±¡ï¼Œå› æ­¤å¿…é¡»ä½¿ç”¨åŒ…è£…ç±»å‹ã€‚</li><li><strong>å¯è¡¨ç¤ºç©ºå€¼</strong>ï¼šå¯ä»¥è¡¨ç¤ºä¸º<code>null</code>ï¼Œè€ŒåŸºæœ¬ç±»å‹ä¸èƒ½ã€‚</li><li><strong>å †å†…å­˜</strong>ï¼šå¯¹è±¡é€šå¸¸å­˜å‚¨åœ¨å †ä¸Šï¼Œè¿™å¯èƒ½å¯¼è‡´å¤„ç†ç¨æ…¢äºåŸºæœ¬ç±»å‹ã€‚</li><li><strong>è‡ªåŠ¨è£…ç®±å’Œæ‹†ç®±</strong>ï¼šJavaæä¾›è‡ªåŠ¨å°†åŸºæœ¬ç±»å‹è½¬æ¢ä¸ºåŒ…è£…ç±»å‹ï¼ˆè£…ç®±ï¼‰å’Œå°†åŒ…è£…ç±»å‹è½¬æ¢ä¸ºåŸºæœ¬ç±»å‹ï¼ˆæ‹†ç®±ï¼‰çš„åŠŸèƒ½ã€‚</li></ol><blockquote><p>æ¯”è¾ƒå’Œé€‰æ‹©</p></blockquote><ul><li>ä½¿ç”¨åŸºæœ¬æ•°æ®ç±»å‹æ—¶ï¼Œå¦‚æœå…³æ³¨æ€§èƒ½å’Œå†…å­˜ï¼Œå¹¶ä¸”ä¸éœ€è¦å¯¹è±¡çš„ç‰¹æ€§ï¼Œæ¯”å¦‚åœ¨å¤§é‡æ•°å€¼è®¡ç®—ä¸­ã€‚</li><li>ä½¿ç”¨åŒ…è£…ç±»å‹æ—¶ï¼Œå¦‚æœéœ€è¦å¯¹è±¡çš„ç‰¹æ€§ï¼Œæ¯”å¦‚åœ¨ä½¿ç”¨é›†åˆç±»ã€éœ€è¦è¡¨ç¤ºç©ºå€¼æˆ–ä½¿ç”¨æ³›å‹æ—¶ã€‚</li></ul><h4 id="3-3-åŒ…è£…ç±»å‹çš„ç¼“å­˜æœºåˆ¶"><a href="#3-3-åŒ…è£…ç±»å‹çš„ç¼“å­˜æœºåˆ¶" class="headerlink" title="3.3 åŒ…è£…ç±»å‹çš„ç¼“å­˜æœºåˆ¶"></a>3.3 åŒ…è£…ç±»å‹çš„ç¼“å­˜æœºåˆ¶</h4><p>Javaä¸­çš„æŸäº›åŒ…è£…ç±»å®ç°äº†ä¸€ä¸ªç§°ä¸ºâ€œç¼“å­˜æœºåˆ¶â€çš„ç‰¹æ€§ï¼Œä¸»è¦æ˜¯ä¸ºäº†æé«˜æ€§èƒ½å’Œå‡å°‘å†…å­˜ä½¿ç”¨ã€‚è¿™ä¸€æœºåˆ¶æœ€å¸¸è§äº<code>Integer</code>å’Œå…¶ä»–å‡ ç§æ•°å­—ç±»å‹çš„åŒ…è£…ç±»ä¸­ã€‚æˆ‘ä»¬æ¥è¯¦ç»†æ¢è®¨è¿™ä¸€ç‚¹ã€‚</p><blockquote><p>åŒ…è£…ç±»å‹ç¼“å­˜æœºåˆ¶çš„æ¦‚è¿°</p></blockquote><ol><li><strong>Integerç¼“å­˜</strong>: Javaçš„<code>Integer</code>ç±»ç¼“å­˜äº†ä»<code>-128</code>åˆ°<code>127</code>ä¹‹é—´çš„æ•´æ•°ã€‚è¿™æ„å‘³ç€åœ¨è¿™ä¸ªèŒƒå›´å†…çš„æ•´æ•°ä¼šè¢«é¢„å…ˆåˆ›å»ºå¹¶ç¼“å­˜ã€‚å½“ä»£ç éœ€è¦è¿™äº›å€¼çš„åŒ…è£…å®ä¾‹æ—¶ï¼Œä¼šé‡ç”¨å·²ç»åˆ›å»ºçš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯æ¯æ¬¡éƒ½åˆ›å»ºæ–°å¯¹è±¡ã€‚</li><li><strong>å…¶ä»–ç±»å‹</strong>: ç±»ä¼¼çš„ç¼“å­˜æœºåˆ¶ä¹Ÿé€‚ç”¨äº<code>Byte</code>, <code>Short</code>, <code>Long</code>, <code>Character</code>ç­‰åŒ…è£…ç±»ã€‚ä½†å…·ä½“çš„ç¼“å­˜èŒƒå›´å¯èƒ½ä¸åŒã€‚ä¾‹å¦‚ï¼Œ<code>Byte</code>ç¼“å­˜äº†æ‰€æœ‰å¯èƒ½çš„å€¼ï¼ˆä»<code>-128</code>åˆ°<code>127</code>ï¼‰ï¼Œè€Œ<code>Character</code>ç¼“å­˜äº†ä»<code>\u0000</code>åˆ°<code>\u007F</code>çš„å­—ç¬¦ã€‚</li></ol><blockquote><p>ç¼“å­˜æœºåˆ¶çš„å·¥ä½œåŸç†</p></blockquote><p>å½“ä½ é€šè¿‡<code>valueOf</code>æ–¹æ³•ï¼ˆè¿™æ˜¯è‡ªåŠ¨è£…ç®±èƒŒåä½¿ç”¨çš„æ–¹æ³•ï¼‰æˆ–è€…ç›´æ¥ä½¿ç”¨è‡ªåŠ¨è£…ç®±æ¥åˆ›å»ºä¸€ä¸ªåŒ…è£…å¯¹è±¡æ—¶ï¼ŒJavaä¼šé¦–å…ˆæ£€æŸ¥å…¶å€¼æ˜¯å¦åœ¨ç¼“å­˜èŒƒå›´å†…ã€‚å¦‚æœæ˜¯ï¼Œå®ƒä¼šä»ç¼“å­˜ä¸­è¿”å›ç›¸åº”çš„å¯¹è±¡å®ä¾‹ï¼›å¦‚æœä¸æ˜¯ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡å®ä¾‹ã€‚</p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs abnf">Integer a <span class="hljs-operator">=</span> <span class="hljs-number">100</span><span class="hljs-comment">;  // ä½¿ç”¨ç¼“å­˜</span><br>Integer b <span class="hljs-operator">=</span> <span class="hljs-number">100</span><span class="hljs-comment">;  // é‡ç”¨ç›¸åŒçš„å¯¹è±¡</span><br>Integer c <span class="hljs-operator">=</span> <span class="hljs-number">200</span><span class="hljs-comment">;  // åˆ›å»ºæ–°çš„å¯¹è±¡å®ä¾‹ï¼Œå› ä¸º200ä¸åœ¨ç¼“å­˜èŒƒå›´å†…</span><br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ<code>a</code>å’Œ<code>b</code>å¼•ç”¨çš„æ˜¯å†…å­˜ä¸­ç›¸åŒçš„<code>Integer</code>å¯¹è±¡ï¼Œå› ä¸º100åœ¨ç¼“å­˜èŒƒå›´å†…ã€‚</p><blockquote><p>ç¼“å­˜æœºåˆ¶çš„å¥½å¤„</p></blockquote><ul><li><strong>æ€§èƒ½æå‡</strong>ï¼šé€šè¿‡å‡å°‘ä¸å¿…è¦çš„å¯¹è±¡åˆ›å»ºï¼Œæé«˜äº†æ€§èƒ½ã€‚</li><li><strong>å†…å­˜ä¼˜åŒ–</strong>ï¼šå‡å°‘äº†å†…å­˜çš„å ç”¨ï¼Œå› ä¸ºå…±äº«äº†ç›¸åŒçš„å¯¹è±¡ã€‚</li></ul><blockquote><p>ä½¿ç”¨æ—¶çš„æ³¨æ„äº‹é¡¹</p></blockquote><ul><li>å½“æ¯”è¾ƒåŒ…è£…ç±»å‹çš„å€¼æ—¶ï¼Œåº”è¯¥ä½¿ç”¨<code>equals</code>æ–¹æ³•è€Œä¸æ˜¯&#x3D;&#x3D; è¿ç®—ç¬¦ï¼Œå› ä¸º &#x3D;&#x3D; æ¯”è¾ƒçš„æ˜¯å¼•ç”¨ï¼Œè€Œä¸æ˜¯å€¼ã€‚ä½†åœ¨ç¼“å­˜èŒƒå›´å†…ï¼Œä½¿ç”¨ &#x3D;&#x3D; å¯èƒ½ä¼šè¯¯å¯¼ä½ è®¤ä¸ºæ¯”è¾ƒçš„æ˜¯å€¼ã€‚</li><li>åœ¨å¤„ç†å¤§é‡çš„æ•´æ•°è¿ç®—æ—¶ï¼Œè¦æ„è¯†åˆ°è‡ªåŠ¨è£…ç®±å’Œæ‹†ç®±å¯èƒ½ä¼šå¼•å…¥é¢å¤–çš„æ€§èƒ½å¼€é”€</li></ul><hr><p>Java åŸºæœ¬æ•°æ®ç±»å‹çš„åŒ…è£…ç±»å‹çš„å¤§éƒ¨åˆ†éƒ½ç”¨åˆ°äº†ç¼“å­˜æœºåˆ¶æ¥æå‡æ€§èƒ½ã€‚</p><p><code>Byte</code>,<code>Short</code>,<code>Integer</code>,<code>Long</code> è¿™ 4 ç§åŒ…è£…ç±»é»˜è®¤åˆ›å»ºäº†æ•°å€¼ <strong>[-128ï¼Œ127]</strong> çš„ç›¸åº”ç±»å‹çš„ç¼“å­˜æ•°æ®ï¼Œ</p><p><code>Character</code> åˆ›å»ºäº†æ•°å€¼åœ¨ <strong>[0,127]</strong> èŒƒå›´çš„ç¼“å­˜æ•°æ®ï¼Œ</p><p><code>Boolean</code> ç›´æ¥è¿”å› <code>True</code> or <code>False</code>ã€‚</p><p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªé—®é¢˜ï¼šä¸‹é¢çš„ä»£ç çš„è¾“å‡ºç»“æœæ˜¯ <code>true</code> è¿˜æ˜¯ <code>false</code> å‘¢ï¼Ÿ</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs abnf">Integer i1 <span class="hljs-operator">=</span> <span class="hljs-number">40</span><span class="hljs-comment">;</span><br>Integer i2 <span class="hljs-operator">=</span> new Integer(<span class="hljs-number">40</span>)<span class="hljs-comment">;</span><br>System.out.println(i1<span class="hljs-operator">=</span><span class="hljs-operator">=</span>i2)<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><p><code>Integer i1=40</code> è¿™ä¸€è¡Œä»£ç ä¼šå‘ç”Ÿè£…ç®±ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™è¡Œä»£ç ç­‰ä»·äº <code>Integer i1=Integer.valueOf(40)</code> ã€‚</p><p>å› æ­¤ï¼Œ<code>i1</code> ç›´æ¥ä½¿ç”¨çš„æ˜¯ç¼“å­˜ä¸­çš„å¯¹è±¡ã€‚è€Œ<code>Integer i2 = new Integer(40)</code> ä¼šç›´æ¥åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚</p><p>å› æ­¤ï¼Œç­”æ¡ˆæ˜¯ <code>false</code> ã€‚</p><p>è®°ä½ï¼š<strong>æ‰€æœ‰æ•´å‹åŒ…è£…ç±»å¯¹è±¡ä¹‹é—´å€¼çš„æ¯”è¾ƒï¼Œå…¨éƒ¨ä½¿ç”¨ equals æ–¹æ³•æ¯”è¾ƒ</strong>ã€‚</p><div style="background-color: #ecf0f1; color: #34495e; padding: 15px; border: 2px solid #bdc3c7; border-radius: 5px;">  <strong>è®°ä½ï¼š</strong> æ‰€æœ‰æ•´å‹åŒ…è£…ç±»å¯¹è±¡ä¹‹é—´å€¼çš„æ¯”è¾ƒï¼Œå…¨éƒ¨ä½¿ç”¨ equals æ–¹æ³•æ¯”è¾ƒ</div><p> <img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20240108224809.png" alt="image.png"></p><h4 id="3-4-è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±"><a href="#3-4-è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±" class="headerlink" title="3.4 è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±"></a>3.4 è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±</h4><ul><li><strong>è£…ç®±</strong>ï¼šå°†åŸºæœ¬ç±»å‹ç”¨å®ƒä»¬å¯¹åº”çš„å¼•ç”¨ç±»å‹åŒ…è£…èµ·æ¥ï¼›</li><li><strong>æ‹†ç®±</strong>ï¼šå°†åŒ…è£…ç±»å‹è½¬æ¢ä¸ºåŸºæœ¬æ•°æ®ç±»å‹ï¼›</li></ul><h4 id="3-5-æµ®ç‚¹æ•°è¿ç®—ç²¾åº¦ä¸¢å¤±"><a href="#3-5-æµ®ç‚¹æ•°è¿ç®—ç²¾åº¦ä¸¢å¤±" class="headerlink" title="3.5 æµ®ç‚¹æ•°è¿ç®—ç²¾åº¦ä¸¢å¤±"></a>3.5 æµ®ç‚¹æ•°è¿ç®—ç²¾åº¦ä¸¢å¤±</h4><p>çœ‹ä¸€ä¸‹ä¸‹é¢è¿™ä¸ªä»£ç ç¤ºä¾‹ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">float</span> a = <span class="hljs-number">2</span>.<span class="hljs-number">0</span>f - <span class="hljs-number">1</span>.<span class="hljs-number">9</span>f;<br><span class="hljs-attribute">float</span> b = <span class="hljs-number">1</span>.<span class="hljs-number">8</span>f - <span class="hljs-number">1</span>.<span class="hljs-number">7</span>f;<br><span class="hljs-attribute">System</span>.out.println(a);// <span class="hljs-number">0</span>.<span class="hljs-number">100000024</span><br><span class="hljs-attribute">System</span>.out.println(b);// <span class="hljs-number">0</span>.<span class="hljs-number">099999905</span><br><span class="hljs-attribute">System</span>.out.println(a == b);// false<br></code></pre></td></tr></table></figure><p>åŸå› åˆ†æï¼š</p><p>æµ®ç‚¹æ•°è¿ç®—ä¸­çš„ç²¾åº¦ä¸¢å¤±æ˜¯ä¸€ä¸ªåœ¨è®¡ç®—æœºç§‘å­¦ä¸­å¹¿æ³›å­˜åœ¨çš„é—®é¢˜ï¼Œå°¤å…¶æ˜¯åœ¨ä½¿ç”¨å•ç²¾åº¦ï¼ˆ<code>float</code>ï¼‰å’ŒåŒç²¾åº¦ï¼ˆ<code>double</code>ï¼‰ç±»å‹æ—¶ã€‚è¿™ä¸ªé—®é¢˜çš„æ ¹æºåœ¨äºæµ®ç‚¹æ•°åœ¨è®¡ç®—æœºä¸­çš„è¡¨ç¤ºæ–¹å¼ã€‚</p><blockquote><p>æµ®ç‚¹æ•°è¡¨ç¤º</p></blockquote><p>æµ®ç‚¹æ•°åœ¨è®¡ç®—æœºä¸­é€šå¸¸ä½¿ç”¨IEEE 754æ ‡å‡†è¡¨ç¤ºã€‚è¿™ç§è¡¨ç¤ºæ–¹æ³•æœ‰ä¸¤ä¸ªä¸»è¦éƒ¨åˆ†ï¼š</p><ol><li><strong>å°¾æ•°ï¼ˆMantissaï¼‰</strong>ï¼šä»£è¡¨æ•°å­—çš„æœ‰æ•ˆæ•°å­—ã€‚</li><li><strong>æŒ‡æ•°ï¼ˆExponentï¼‰</strong>ï¼šå†³å®šå°æ•°ç‚¹çš„ä½ç½®ã€‚</li></ol><p>ç”±äºè¿™ä¸¤ä¸ªéƒ¨åˆ†éƒ½æœ‰å›ºå®šçš„ä½æ•°ï¼Œæ‰€ä»¥åªèƒ½ç²¾ç¡®è¡¨ç¤ºä¸€å®šèŒƒå›´å’Œç²¾åº¦çš„æ•°ã€‚ä¸€äº›æ•°ï¼Œå¦‚åˆ†æ•°<code>1/3</code>æˆ–ç‰¹å®šçš„å°æ•°ï¼Œæ— æ³•è¢«ç²¾ç¡®åœ°è¡¨ç¤ºä¸ºæµ®ç‚¹æ•°ã€‚</p><blockquote><p>ç²¾åº¦ä¸¢å¤±çš„åŸå› </p></blockquote><ol><li><strong>æœ‰é™çš„ä½æ•°</strong>ï¼šç”±äºå°¾æ•°å’ŒæŒ‡æ•°çš„ä½æ•°æ˜¯æœ‰é™çš„ï¼Œå› æ­¤æµ®ç‚¹æ•°ä¸èƒ½ç²¾ç¡®è¡¨ç¤ºæ‰€æœ‰çš„æ•°å€¼ã€‚åœ¨è½¬æ¢å’Œè¿ç®—è¿‡ç¨‹ä¸­ï¼Œä¼šè¿›è¡Œå››èˆäº”å…¥ä»¥é€‚åº”è¿™äº›ä½æ•°ï¼Œä»è€Œå¯¼è‡´ç²¾åº¦ä¸¢å¤±ã€‚</li><li><strong>äºŒè¿›åˆ¶è¡¨ç¤º</strong>ï¼šæŸäº›åè¿›åˆ¶å°æ•°åœ¨äºŒè¿›åˆ¶ä¸‹æ˜¯æ— é™å¾ªç¯å°æ•°ï¼Œæ— æ³•ç²¾ç¡®è¡¨ç¤ºï¼Œä¾‹å¦‚0.1ã€‚</li></ol><p>å®é™…å½±å“</p><p>åœ¨è¿›è¡Œæµ®ç‚¹æ•°è¿ç®—æ—¶ï¼Œå¦‚åŠ æ³•ã€å‡æ³•ã€ä¹˜æ³•å’Œé™¤æ³•ï¼Œè¿™ç§ç²¾åº¦çš„ä¸¢å¤±å¯èƒ½ä¼šç´¯ç§¯ï¼Œå¯¼è‡´æœ€ç»ˆç»“æœä¸é¢„æœŸæœ‰è¾ƒå¤§åå·®ã€‚è¿™åœ¨é‡‘èè®¡ç®—ç­‰éœ€è¦é«˜ç²¾åº¦çš„åœºåˆå°¤ä¸ºé‡è¦ã€‚</p><blockquote><p>è§£å†³æ–¹æ³•</p></blockquote><ol><li><strong>ä½¿ç”¨<code>BigDecimal</code></strong>: åœ¨Javaä¸­ï¼Œ<code>BigDecimal</code>ç±»å¯ä»¥ç”¨äºç²¾ç¡®çš„å°æ•°è¿ç®—ã€‚å®ƒå…è®¸æ§åˆ¶èˆå…¥æ¨¡å¼ï¼Œå¯ä»¥ç”¨äºé‡‘èå’Œç§‘å­¦è®¡ç®—ä¸­ã€‚</li><li><strong>é¿å…ä¸å¿…è¦çš„è¿ç®—</strong>ï¼šå‡å°‘æµ®ç‚¹æ•°è¿ç®—çš„æ•°é‡å¯ä»¥å‡å°‘ç´¯ç§¯è¯¯å·®ã€‚</li><li><strong>ç†è§£å’Œæ¥å—ä¸€å®šçš„è¯¯å·®</strong>ï¼šåœ¨æŸäº›åœºåˆï¼Œå®Œå…¨ç²¾ç¡®çš„ç»“æœå¯èƒ½å¹¶ä¸æ˜¯å¿…éœ€çš„ï¼Œæ­¤æ—¶ç†è§£å¹¶æ¥å—æµ®ç‚¹è¿ç®—çš„é™åˆ¶æ˜¯åˆç†çš„ã€‚</li></ol><h3 id="å››ã€å˜é‡"><a href="#å››ã€å˜é‡" class="headerlink" title="å››ã€å˜é‡"></a>å››ã€å˜é‡</h3><h4 id="4-1-æˆå‘˜å˜é‡ä¸å±€éƒ¨å˜é‡"><a href="#4-1-æˆå‘˜å˜é‡ä¸å±€éƒ¨å˜é‡" class="headerlink" title="4.1 æˆå‘˜å˜é‡ä¸å±€éƒ¨å˜é‡"></a>4.1 æˆå‘˜å˜é‡ä¸å±€éƒ¨å˜é‡</h4><p>æˆå‘˜å˜é‡ï¼ˆå­—æ®µã€å±æ€§ï¼‰ï¼Œå±€éƒ¨å˜é‡åœ¨å£°æ˜ä½ç½®ã€ä½œç”¨åŸŸã€åˆå§‹åŒ–è¡Œä¸ºç­‰æ–¹é¢æœ‰æ˜¾è‘—çš„ä¸åŒ</p><blockquote><p>æˆå‘˜å˜é‡ï¼ˆMember Variablesï¼‰</p></blockquote><p>æˆå‘˜å˜é‡æ˜¯å®šä¹‰åœ¨ç±»ä¸­çš„å˜é‡ï¼Œå®ƒä»¬æè¿°äº†ç±»çš„å±æ€§æˆ–çŠ¶æ€ã€‚æ ¹æ®æ˜¯å¦ä½¿ç”¨<code>static</code>å…³é”®å­—ï¼Œæˆå‘˜å˜é‡å¯ä»¥è¿›ä¸€æ­¥åˆ†ä¸ºå®ä¾‹å˜é‡å’Œç±»å˜é‡ã€‚</p><ol><li><strong>å®ä¾‹å˜é‡</strong>ï¼šæ²¡æœ‰ç”¨<code>static</code>ä¿®é¥°çš„æˆå‘˜å˜é‡ã€‚æ¯ä¸ªç±»çš„å®ä¾‹éƒ½æœ‰è‡ªå·±çš„ä¸€å¥—å®ä¾‹å˜é‡çš„å‰¯æœ¬ã€‚</li><li><strong>ç±»å˜é‡ï¼ˆé™æ€å˜é‡ï¼‰</strong>ï¼šç”¨<code>static</code>ä¿®é¥°çš„æˆå‘˜å˜é‡ã€‚å®ƒä»¬å±äºç±»æœ¬èº«ï¼Œæ‰€æœ‰å®ä¾‹å…±äº«åŒä¸€ä¸ªé™æ€å˜é‡çš„å‰¯æœ¬ã€‚</li></ol><p>ç‰¹ç‚¹</p><ul><li><strong>ä½œç”¨åŸŸ</strong>ï¼šæ•´ä¸ªç±»å†…éƒ¨ã€‚</li><li><strong>ç”Ÿå‘½å‘¨æœŸ</strong>ï¼šä¸å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼ˆå®ä¾‹å˜é‡ï¼‰æˆ–ç±»çš„ç”Ÿå‘½å‘¨æœŸï¼ˆé™æ€å˜é‡ï¼‰ç›¸åŒã€‚</li><li><strong>é»˜è®¤å€¼</strong>ï¼šè‡ªåŠ¨åˆå§‹åŒ–ä¸ºé»˜è®¤å€¼ï¼ˆå¦‚<code>int</code>ä¸º0ï¼Œå¯¹è±¡å¼•ç”¨ä¸º<code>null</code>ï¼‰ã€‚</li><li><strong>è®¿é—®æ–¹å¼</strong>ï¼šå¯ä»¥é€šè¿‡å¯¹è±¡ï¼ˆå®ä¾‹å˜é‡ï¼‰æˆ–ç±»åï¼ˆé™æ€å˜é‡ï¼‰è®¿é—®ã€‚</li></ul><blockquote><p>å±€éƒ¨å˜é‡ï¼ˆLocal Variablesï¼‰</p></blockquote><p>å±€éƒ¨å˜é‡æ˜¯åœ¨æ–¹æ³•å†…ã€æ„é€ å™¨å†…æˆ–ä»£ç å—å†…å®šä¹‰çš„å˜é‡ã€‚</p><p><strong>ç‰¹ç‚¹</strong></p><ul><li><strong>ä½œç”¨åŸŸ</strong>ï¼šä»…é™äºå®ƒä»¬è¢«å£°æ˜çš„æ–¹æ³•ã€æ„é€ å™¨æˆ–ä»£ç å—å†…ã€‚</li><li><strong>ç”Ÿå‘½å‘¨æœŸ</strong>ï¼šä»å£°æ˜å¼€å§‹åˆ°æ–¹æ³•ã€æ„é€ å™¨æˆ–ä»£ç å—æ‰§è¡Œå®Œæ¯•æ—¶ç»“æŸã€‚</li><li><strong>åˆå§‹åŒ–</strong>ï¼šä¸ä¼šè‡ªåŠ¨åˆå§‹åŒ–ï¼Œå¿…é¡»åœ¨ä½¿ç”¨å‰æ˜¾å¼åˆå§‹åŒ–ã€‚</li><li><strong>å†…å­˜ä½ç½®</strong>ï¼šé€šå¸¸å­˜å‚¨åœ¨æ ˆä¸Šã€‚</li></ul><blockquote><p>æ¯”è¾ƒ</p></blockquote><table><thead><tr><th>ç‰¹æ€§</th><th>æˆå‘˜å˜é‡</th><th>å±€éƒ¨å˜é‡</th></tr></thead><tbody><tr><td>å£°æ˜ä½ç½®</td><td>ç±»ä½“å†…éƒ¨</td><td>æ–¹æ³•ã€æ„é€ å™¨æˆ–ä»£ç å—å†…</td></tr><tr><td>ä½œç”¨åŸŸ</td><td>æ•´ä¸ªç±»å†…éƒ¨</td><td>ä»…é™äºå£°æ˜å®ƒä»¬çš„å—å†…</td></tr><tr><td>ç”Ÿå‘½å‘¨æœŸ</td><td>å®ä¾‹å˜é‡ï¼šéšå¯¹è±¡å­˜åœ¨ï¼›é™æ€å˜é‡ï¼šéšç±»å­˜åœ¨</td><td>éšæ–¹æ³•ã€æ„é€ å™¨æˆ–ä»£ç å—æ‰§è¡Œå®Œæ¯•è€Œç»“æŸ</td></tr><tr><td>åˆå§‹åŒ–</td><td>è‡ªåŠ¨åˆå§‹åŒ–ä¸ºé»˜è®¤å€¼</td><td>å¿…é¡»æ˜¾å¼åˆå§‹åŒ–</td></tr><tr><td>å†…å­˜ä½ç½®</td><td>å †ï¼ˆå®ä¾‹å˜é‡ï¼‰æˆ–æ–¹æ³•åŒºï¼ˆé™æ€å˜é‡ï¼‰</td><td>æ ˆ</td></tr></tbody></table><h4 id="4-2-é™æ€å˜é‡"><a href="#4-2-é™æ€å˜é‡" class="headerlink" title="4.2 é™æ€å˜é‡"></a>4.2 é™æ€å˜é‡</h4><p>ç•¥</p><h4 id="4-3-å­—ç¬¦å‹å¸¸é‡å’Œå­—ç¬¦ä¸²å¸¸é‡"><a href="#4-3-å­—ç¬¦å‹å¸¸é‡å’Œå­—ç¬¦ä¸²å¸¸é‡" class="headerlink" title="4.3 å­—ç¬¦å‹å¸¸é‡å’Œå­—ç¬¦ä¸²å¸¸é‡"></a>4.3 å­—ç¬¦å‹å¸¸é‡å’Œå­—ç¬¦ä¸²å¸¸é‡</h4><p>å­—ç¬¦å‹å¸¸é‡ï¼ˆCharacter Constantsï¼‰å’Œå­—ç¬¦ä¸²å¸¸é‡ï¼ˆString Constantsï¼‰ä¹‹é—´çš„ä¸»è¦åŒºåˆ«ï¼š</p><table><thead><tr><th>ç‰¹æ€§</th><th>å­—ç¬¦å‹å¸¸é‡ï¼ˆCharacter Constantsï¼‰</th><th>å­—ç¬¦ä¸²å¸¸é‡ï¼ˆString Constantsï¼‰</th></tr></thead><tbody><tr><td>å¼•å·ç±»å‹</td><td>å•å¼•å·ï¼ˆâ€™ï¼‰</td><td>åŒå¼•å·ï¼ˆâ€ï¼‰</td></tr><tr><td>å†…å®¹</td><td>ä»…åŒ…å«å•ä¸ªå­—ç¬¦</td><td>å¯åŒ…å«é›¶ä¸ªã€ä¸€ä¸ªæˆ–å¤šä¸ªå­—ç¬¦</td></tr><tr><td>ç±»å‹</td><td>åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆ<code>char</code>ï¼‰</td><td>ç±»ï¼ˆ<code>String</code>ï¼‰</td></tr><tr><td>å­˜å‚¨å¤§å°</td><td>16ä½ï¼ˆ2å­—èŠ‚ï¼‰Unicodeå­—ç¬¦</td><td>å–å†³äºå­—ç¬¦ä¸²é•¿åº¦</td></tr><tr><td>å¯å˜æ€§</td><td>ä¸é€‚ç”¨</td><td>ä¸å¯å˜ï¼ˆä¸€æ—¦åˆ›å»ºï¼Œå†…å®¹ä¸å¯æ›´æ”¹ï¼‰</td></tr><tr><td>ç¤ºä¾‹</td><td><code>&#39;A&#39;</code>, <code>&#39;1&#39;</code>, <code>&#39;\n&#39;</code></td><td><code>&quot;Hello&quot;</code>, <code>&quot;123&quot;</code>, <code>&quot;&quot;</code></td></tr></tbody></table><h3 id="äº”ã€æ–¹æ³•"><a href="#äº”ã€æ–¹æ³•" class="headerlink" title="äº”ã€æ–¹æ³•"></a>äº”ã€æ–¹æ³•</h3><h4 id="5-1-ä»€ä¹ˆæ˜¯æ–¹æ³•"><a href="#5-1-ä»€ä¹ˆæ˜¯æ–¹æ³•" class="headerlink" title="5.1  ä»€ä¹ˆæ˜¯æ–¹æ³•"></a>5.1  ä»€ä¹ˆæ˜¯æ–¹æ³•</h4><p>ç•¥</p><h4 id="5-2-æ–¹æ³•çš„è¿”å›å€¼"><a href="#5-2-æ–¹æ³•çš„è¿”å›å€¼" class="headerlink" title="5.2 æ–¹æ³•çš„è¿”å›å€¼"></a>5.2 æ–¹æ³•çš„è¿”å›å€¼</h4><p>æ ¹æ®æ–¹æ³•çš„è¿”å›å€¼ç±»å‹å’Œå‚æ•°ç±»å‹ï¼Œæ–¹æ³•å¯ä»¥åˆ†ä¸ºå‡ ç§ä¸åŒçš„ç±»åˆ«ã€‚</p><p>åŒºåˆ«ï¼š</p><table><thead><tr><th>ç±»åˆ«</th><th>è¿”å›å€¼ç±»å‹</th><th>å‚æ•°ç±»å‹</th><th>æè¿°</th></tr></thead><tbody><tr><td>æ— è¿”å›å€¼æ— å‚æ•°</td><td><code>void</code></td><td>æ— å‚æ•°</td><td>è¿™ç±»æ–¹æ³•ä¸è¿”å›ä»»ä½•å€¼ï¼Œä¹Ÿä¸æ¥å—ä»»ä½•å‚æ•°ã€‚</td></tr><tr><td>æ— è¿”å›å€¼æœ‰å‚æ•°</td><td><code>void</code></td><td>æœ‰å‚æ•°</td><td>è¿™ç±»æ–¹æ³•ä¸è¿”å›å€¼ï¼Œä½†æ¥å—ä¸€ä¸ªæˆ–å¤šä¸ªå‚æ•°ã€‚</td></tr><tr><td>æœ‰è¿”å›å€¼æ— å‚æ•°</td><td>é<code>void</code></td><td>æ— å‚æ•°</td><td>è¿™ç±»æ–¹æ³•è¿”å›ä¸€ä¸ªå€¼ï¼Œä½†ä¸æ¥å—ä»»ä½•å‚æ•°ã€‚</td></tr><tr><td>æœ‰è¿”å›å€¼æœ‰å‚æ•°</td><td>é<code>void</code></td><td>æœ‰å‚æ•°</td><td>è¿™ç±»æ–¹æ³•æ—¢è¿”å›ä¸€ä¸ªå€¼ï¼Œåˆæ¥å—ä¸€ä¸ªæˆ–å¤šä¸ªå‚æ•°ã€‚</td></tr></tbody></table><blockquote><p>ä¾‹å­</p></blockquote><ol><li><strong>æ— è¿”å›å€¼æ— å‚æ•°</strong></li></ol><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">f1</span>()</span> &#123;<br>    <span class="hljs-comment">//......</span><br>&#125;<br><span class="hljs-comment">// ä¸‹é¢è¿™ä¸ªæ–¹æ³•ä¹Ÿæ²¡æœ‰è¿”å›å€¼ï¼Œè™½ç„¶ç”¨åˆ°äº† return</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">f</span>(<span class="hljs-params"><span class="hljs-built_in">int</span> a</span>)</span> &#123;<br>    <span class="hljs-keyword">if</span> (...) &#123;<br>        <span class="hljs-comment">// è¡¨ç¤ºç»“æŸæ–¹æ³•çš„æ‰§è¡Œ,ä¸‹æ–¹çš„è¾“å‡ºè¯­å¥ä¸ä¼šæ‰§è¡Œ</span><br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    System.<span class="hljs-keyword">out</span>.println(a);<br>&#125;<br></code></pre></td></tr></table></figure><ol start="2"><li><p><strong>æ— è¿”å›å€¼æœ‰å‚æ•°</strong></p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-function"><span class="hljs-title">public</span></span> void f2(<span class="hljs-keyword">Parameter</span> 1, ..., <span class="hljs-keyword">Parameter</span> <span class="hljs-comment">n) &#123;</span><br>    <span class="hljs-comment">//......</span><br>&#125;<br></code></pre></td></tr></table></figure></li><li><p><strong>æœ‰è¿”å›å€¼æ— å‚æ•°</strong></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> <span class="hljs-title">f3</span>()</span> &#123;<br>    <span class="hljs-comment">//......</span><br>    <span class="hljs-keyword">return</span> x;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p><strong>æœ‰è¿”å›å€¼æœ‰å‚æ•°</strong></p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs arduino"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title">f4</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> a * b;<br>&#125;<br></code></pre></td></tr></table></figure></li></ol><h4 id="5-3-é™æ€æ–¹æ³•ä¸å®ä¾‹æ–¹æ³•"><a href="#5-3-é™æ€æ–¹æ³•ä¸å®ä¾‹æ–¹æ³•" class="headerlink" title="5.3 é™æ€æ–¹æ³•ä¸å®ä¾‹æ–¹æ³•"></a>5.3 é™æ€æ–¹æ³•ä¸å®ä¾‹æ–¹æ³•</h4><blockquote><p>åŒºåˆ«</p></blockquote><p>é™æ€æ–¹æ³•ï¼ˆStatic Methodsï¼‰</p><ol><li><strong>å®šä¹‰</strong>: ä½¿ç”¨<code>static</code>å…³é”®å­—å®šä¹‰ã€‚</li><li><strong>è°ƒç”¨æ–¹å¼</strong>: å¯ä»¥é€šè¿‡ç±»åç›´æ¥è°ƒç”¨ï¼Œä¸éœ€è¦åˆ›å»ºç±»çš„å¯¹è±¡ã€‚</li><li><strong>è®¿é—®</strong>: åªèƒ½ç›´æ¥è®¿é—®ç±»çš„é™æ€æˆå‘˜ï¼ˆå˜é‡å’Œæ–¹æ³•ï¼‰ã€‚ä¸èƒ½ç›´æ¥è®¿é—®å®ä¾‹æˆå‘˜ã€‚</li><li><strong>ç”¨é€”</strong>: å¸¸ç”¨äºä¸ä¾èµ–äºå¯¹è±¡çŠ¶æ€çš„å·¥å…·æˆ–å¸®åŠ©æ–¹æ³•ã€‚</li></ol><p>å®ä¾‹æ–¹æ³•ï¼ˆInstance Methodsï¼‰</p><ol><li><strong>å®šä¹‰</strong>: æ²¡æœ‰<code>static</code>å…³é”®å­—ï¼Œå±äºç±»çš„å®ä¾‹ã€‚</li><li><strong>è°ƒç”¨æ–¹å¼</strong>: éœ€è¦åˆ›å»ºç±»çš„å¯¹è±¡ï¼Œé€šè¿‡å¯¹è±¡è°ƒç”¨ã€‚</li><li><strong>è®¿é—®</strong>: å¯ä»¥è®¿é—®ç±»çš„å®ä¾‹æˆå‘˜ï¼ˆå˜é‡å’Œæ–¹æ³•ï¼‰ä»¥åŠé™æ€æˆå‘˜ã€‚</li><li><strong>ç”¨é€”</strong>: é€šå¸¸ç”¨äºæ“ä½œæˆ–è®¿é—®å¯¹è±¡çš„å®ä¾‹æ•°æ®ã€‚</li></ol><blockquote><p>æ¯”è¾ƒ</p></blockquote><table><thead><tr><th>ç‰¹æ€§</th><th>é™æ€æ–¹æ³•</th><th>å®ä¾‹æ–¹æ³•</th></tr></thead><tbody><tr><td>å®šä¹‰</td><td>ä½¿ç”¨ <code>static</code> å…³é”®å­—</td><td>æ²¡æœ‰ <code>static</code> å…³é”®å­—</td></tr><tr><td>è°ƒç”¨æ–¹å¼</td><td>é€šè¿‡ç±»åè°ƒç”¨ï¼ˆä¾‹å¦‚ <code>ClassName.method()</code>ï¼‰</td><td>é€šè¿‡å¯¹è±¡å®ä¾‹è°ƒç”¨ï¼ˆä¾‹å¦‚ <code>object.method()</code>ï¼‰</td></tr><tr><td>è®¿é—®ç±»çš„æˆå‘˜</td><td>åªèƒ½è®¿é—®é™æ€æˆå‘˜</td><td>å¯è®¿é—®å®ä¾‹æˆå‘˜å’Œé™æ€æˆå‘˜</td></tr><tr><td>å¯¹è±¡çŠ¶æ€ä¾èµ–</td><td>ä¸ä¾èµ–å¯¹è±¡çŠ¶æ€</td><td>ä¾èµ–æˆ–å¯è®¿é—®å¯¹è±¡çŠ¶æ€</td></tr><tr><td>å…¸å‹ç”¨é€”</td><td>å·¥å…·æ–¹æ³•ã€è®¡ç®—æ–¹æ³•ã€æ— éœ€å¯¹è±¡çŠ¶æ€çš„æ“ä½œ</td><td>æ“ä½œæˆ–è®¿é—®å¯¹è±¡çš„å®ä¾‹æ•°æ®</td></tr></tbody></table><blockquote><p>ç±»æ¯”</p></blockquote><ul><li><strong>é™æ€æ–¹æ³•</strong>: å°±åƒæ˜¯å¤§å­¦çš„å…¬å…±å›¾ä¹¦é¦†ï¼Œæ‰€æœ‰å­¦ç”Ÿï¼ˆç±»çš„å®ä¾‹ï¼‰éƒ½å¯ä»¥ä½¿ç”¨ï¼Œä½†å®ƒä¸å±äºä»»ä½•ä¸€ä¸ªå­¦ç”Ÿã€‚</li><li><strong>å®ä¾‹æ–¹æ³•</strong>: å°±åƒå­¦ç”Ÿçš„ä¸ªäººç¬”è®°æœ¬ï¼Œæ¯ä¸ªå­¦ç”Ÿéƒ½æœ‰è‡ªå·±çš„ç¬”è®°æœ¬ï¼Œå¯ä»¥åœ¨å…¶ä¸­å†™ä¸‹è‡ªå·±çš„ç¬”è®°ï¼ˆå®ä¾‹æ•°æ®ï¼‰ï¼Œå¹¶ä¸”æ¯ä¸ªç¬”è®°æœ¬éƒ½æ˜¯ç‹¬ä¸€æ— äºŒçš„ã€‚</li></ul><hr><blockquote><p>é™æ€æ–¹æ³•ä¸èƒ½è°ƒç”¨éé™æ€æˆå‘˜</p></blockquote><p>ä¸»è¦åŸå› å¦‚ä¸‹ï¼š</p><ol><li>é™æ€æ–¹æ³•æ˜¯å±äºç±»çš„ï¼Œåœ¨ç±»åŠ è½½çš„æ—¶å€™å°±ä¼šåˆ†é…å†…å­˜ï¼Œå¯ä»¥é€šè¿‡ç±»åç›´æ¥è®¿é—®ã€‚è€Œéé™æ€æˆå‘˜å±äºå®ä¾‹å¯¹è±¡ï¼Œåªæœ‰åœ¨å¯¹è±¡å®ä¾‹åŒ–ä¹‹åæ‰å­˜åœ¨ï¼Œéœ€è¦é€šè¿‡ç±»çš„å®ä¾‹å¯¹è±¡å»è®¿é—®ã€‚</li><li>åœ¨ç±»çš„éé™æ€æˆå‘˜ä¸å­˜åœ¨çš„æ—¶å€™é™æ€æ–¹æ³•å°±å·²ç»å­˜åœ¨äº†ï¼Œæ­¤æ—¶è°ƒç”¨åœ¨å†…å­˜ä¸­è¿˜ä¸å­˜åœ¨çš„éé™æ€æˆå‘˜ï¼Œå±äºéæ³•æ“ä½œ</li></ol><h4 id="5-4-é‡è½½å’Œé‡å†™"><a href="#5-4-é‡è½½å’Œé‡å†™" class="headerlink" title="5.4 é‡è½½å’Œé‡å†™"></a>5.4 é‡è½½å’Œé‡å†™</h4><p>é‡è½½ï¼šï¼ˆåŒä¸€ä¸ªç±»ä¸­çš„æ“ä½œï¼‰</p><p>å‘ç”Ÿåœ¨åŒä¸€ä¸ªç±»ä¸­ï¼ˆæˆ–è€…çˆ¶ç±»å’Œå­ç±»ä¹‹é—´ï¼‰ï¼Œæ–¹æ³•åå¿…é¡»ç›¸åŒï¼Œå‚æ•°ç±»å‹ä¸åŒã€ä¸ªæ•°ä¸åŒã€é¡ºåºä¸åŒï¼Œæ–¹æ³•è¿”å›å€¼å’Œè®¿é—®ä¿®é¥°ç¬¦å¯ä»¥ä¸åŒã€‚</p><p>é‡å†™ï¼šï¼ˆå­ç±»å¯¹çˆ¶ç±»çš„æ“ä½œï¼‰</p><p>é‡å†™å‘ç”Ÿåœ¨è¿è¡ŒæœŸï¼Œæ˜¯å­ç±»å¯¹çˆ¶ç±»çš„å…è®¸è®¿é—®çš„æ–¹æ³•çš„å®ç°è¿‡ç¨‹è¿›è¡Œé‡æ–°ç¼–å†™ã€‚</p><ol><li>æ–¹æ³•åã€å‚æ•°åˆ—è¡¨å¿…é¡»ç›¸åŒï¼Œå­ç±»æ–¹æ³•è¿”å›å€¼ç±»å‹åº”æ¯”çˆ¶ç±»æ–¹æ³•è¿”å›å€¼ç±»å‹æ›´å°æˆ–ç›¸ç­‰ï¼ŒæŠ›å‡ºçš„å¼‚å¸¸èŒƒå›´å°äºç­‰äºçˆ¶ç±»ï¼Œè®¿é—®ä¿®é¥°ç¬¦èŒƒå›´å¤§äºç­‰äºçˆ¶ç±»ã€‚</li><li>å¦‚æœçˆ¶ç±»æ–¹æ³•è®¿é—®ä¿®é¥°ç¬¦ä¸º <code>private/final/static</code> åˆ™å­ç±»å°±ä¸èƒ½é‡å†™è¯¥æ–¹æ³•ï¼Œä½†æ˜¯è¢« <code>static</code> ä¿®é¥°çš„æ–¹æ³•èƒ½å¤Ÿè¢«å†æ¬¡å£°æ˜ã€‚</li><li>æ„é€ æ–¹æ³•æ— æ³•è¢«é‡å†™</li></ol><table><thead><tr><th>ç‰¹æ€§</th><th>é‡è½½ (Overloading)</th><th>é‡å†™ (Overriding)</th></tr></thead><tbody><tr><td>æ‰€åœ¨ä½ç½®</td><td>åŒä¸€ä¸ªç±»ä¸­</td><td>å­ç±»ä¸­</td></tr><tr><td>æ–¹æ³•å</td><td>å¿…é¡»ç›¸åŒ</td><td>å¿…é¡»ç›¸åŒ</td></tr><tr><td>å‚æ•°åˆ—è¡¨</td><td>å¿…é¡»ä¸åŒï¼ˆæ•°é‡ã€ç±»å‹æˆ–é¡ºåºï¼‰</td><td>å¿…é¡»ç›¸åŒ</td></tr><tr><td>è¿”å›ç±»å‹</td><td>å¯ä»¥ä¸åŒ</td><td>å¿…é¡»ä¸è¢«é‡å†™çš„æ–¹æ³•å…¼å®¹</td></tr><tr><td>è®¿é—®ä¿®é¥°ç¬¦</td><td>å¯ä»¥ä¸åŒ</td><td>ä¸èƒ½æ¯”çˆ¶ç±»æ–¹æ³•æ›´ä¸¥æ ¼</td></tr><tr><td>æŠ›å‡ºçš„å¼‚å¸¸</td><td>å¯ä»¥ä¸åŒ</td><td>ä¸èƒ½æŠ›å‡ºæ–°çš„æ£€æŸ¥å¼‚å¸¸æˆ–æ›´å¹¿æ³›çš„æ£€æŸ¥å¼‚å¸¸</td></tr><tr><td>å®ç°ç›®çš„</td><td>å¢åŠ åŒä¸€æ“ä½œçš„çµæ´»æ€§</td><td>å®ç°è¿è¡Œæ—¶å¤šæ€ï¼Œæä¾›ç‰¹å®šçš„å®ç°</td></tr></tbody></table><h4 id="5-5-å¯å˜é•¿å‚æ•°"><a href="#5-5-å¯å˜é•¿å‚æ•°" class="headerlink" title="5.5 å¯å˜é•¿å‚æ•°"></a>5.5 å¯å˜é•¿å‚æ•°</h4><p>ç•¥</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://javaguide.cn/java/basis/java-basic-questions-01.html">https://javaguide.cn/java/basis/java-basic-questions-01.html</a></li><li><a href="https://www.yuque.com/snailclimb/mf2z3k/gre6gr">https://www.yuque.com/snailclimb/mf2z3k/gre6gr</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
      <category>Base</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é¢è¯•é¢˜_èƒŒè¯µç‰ˆ</title>
    <link href="/2024/01/07/%E9%9D%A2%E8%AF%95%E9%A2%98_%E8%83%8C%E8%AF%B5%E7%89%88/"/>
    <url>/2024/01/07/%E9%9D%A2%E8%AF%95%E9%A2%98_%E8%83%8C%E8%AF%B5%E7%89%88/</url>
    
    <content type="html"><![CDATA[<p>to be continedâ€¦.</p>]]></content>
    
    
    <categories>
      
      <category>é¢è¯•é¢˜</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>é¢è¯•é¢˜</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é¢è¯•é¢˜_Redis</title>
    <link href="/2024/01/02/%E9%9D%A2%E8%AF%95%E9%A2%98_Redis/"/>
    <url>/2024/01/02/%E9%9D%A2%E8%AF%95%E9%A2%98_Redis/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å¤§çº²</p></blockquote><ul><li>Redis æœ‰ä»€ä¹ˆä½œç”¨ï¼Œä¸ºä»€ä¹ˆè¦ç”¨ç¼“å­˜ï¼Œä¸ºä»€ä¹ˆé€‰æ‹©Redis</li><li>åœ¨ä½¿ç”¨Redisä½œä¸ºç¼“å­˜æ—¶ï¼Œå¦‚æœé‡åˆ°ç¼“å­˜ç©¿é€ï¼ˆå³è¯·æ±‚çš„æ•°æ®ä¸åœ¨ç¼“å­˜ä¸­ä¹Ÿä¸åœ¨æ•°æ®åº“ä¸­ï¼‰çš„é—®é¢˜ï¼Œä½ ä¼šå¦‚ä½•è§£å†³ï¼Ÿ</li></ul><h4 id="1ã€Redis-æœ‰ä»€ä¹ˆä½œç”¨ï¼Œä¸ºä»€ä¹ˆè¦ç”¨ç¼“å­˜ï¼Œä¸ºä»€ä¹ˆé€‰æ‹©Redis"><a href="#1ã€Redis-æœ‰ä»€ä¹ˆä½œç”¨ï¼Œä¸ºä»€ä¹ˆè¦ç”¨ç¼“å­˜ï¼Œä¸ºä»€ä¹ˆé€‰æ‹©Redis" class="headerlink" title="1ã€Redis æœ‰ä»€ä¹ˆä½œç”¨ï¼Œä¸ºä»€ä¹ˆè¦ç”¨ç¼“å­˜ï¼Œä¸ºä»€ä¹ˆé€‰æ‹©Redis"></a>1ã€Redis æœ‰ä»€ä¹ˆä½œç”¨ï¼Œä¸ºä»€ä¹ˆè¦ç”¨ç¼“å­˜ï¼Œä¸ºä»€ä¹ˆé€‰æ‹©Redis</h4><blockquote><p>LQ</p></blockquote><p>åœ¨é¡¹ç›®ä¸­ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ç¼“å­˜ï¼ŒæŒ‰ç…§æˆ‘ä¸ªäººç†è§£ï¼Œé¦–å…ˆæ˜¯å¼•å…¥ç¼“å­˜åå¯¹æˆ‘ç³»ç»Ÿæ€§èƒ½æ˜¯æœ‰æå‡çš„ï¼Œ åŸºäºæ­¤æˆ‘è€ƒè™‘å¼•å…¥ç¼“å­˜ï¼›æˆ–è€…æœ‰å…¶ä»–éœ€æ±‚ï¼Œæ¯”å¦‚ï¼šé«˜å¹¶å‘ï¼ˆå‡å°‘æ•°æ®åº“å‹åŠ›ï¼‰ï¼Œå¿«é€Ÿè¯»å†™ï¼ˆåŸºäºå†…å­˜ï¼Œè¯»æ•°æ®å¿«ï¼‰ï¼›</p><p>ä¸ºä»€ä¹ˆé€‰æ‹©Redisï¼ŒRedis æ˜¯éå¸¸æµè¡Œçš„ä¸€å¥—æŠ€æœ¯è§£å†³æ–¹æ¡ˆï¼Œé‡‡ç”¨å®ƒå¯ä»¥è§£å†³å¾ˆå¤šä¸å¿…è¦çš„å¼€å‘å­˜åœ¨çš„é—®é¢˜ï¼ˆå‰äººå·²ç»è§£å†³è¿‡äº†ï¼Œè€Œä¸”æˆ‘èƒ½ä½¿ç”¨å‰äººçš„ä¸€å¥—æ–¹æ¡ˆï¼‰ å»ä½¿ç”¨Redis å»åšä¸€äº›ä¸œè¥¿ï¼Œæ¯”å¦‚é«˜å¯ç”¨ï¼Œæ­å»ºé›†ç¾¤ï¼ŒåŒæ—¶Redis å®ƒæœ¬èº«è‡ªå·±ä¹Ÿæœ‰å¾ˆå¤šä¼˜ç‚¹ï¼Œæ”¯æŒæŒä¹…åŒ–ï¼Œæ•°æ®ç±»å‹ä¸°å¯Œç­‰ã€‚</p><blockquote><p>GPT</p></blockquote><p>é¡¹ç›®ä¸­ä½¿ç”¨ç¼“å­˜çš„åŸå› </p><ol><li><p><strong>æ€§èƒ½æå‡</strong>: æ­£å¦‚ä½ æ‰€æåˆ°çš„ï¼Œç¼“å­˜ä¸»è¦æ˜¯ä¸ºäº†æå‡ç³»ç»Ÿæ€§èƒ½ã€‚é€šè¿‡å­˜å‚¨ç»å¸¸è®¿é—®çš„æ•°æ®åœ¨å†…å­˜ä¸­ï¼Œå¯ä»¥é¿å…æ¯æ¬¡éƒ½ä»æ•°æ®åº“ä¸­è¯»å–ï¼Œä»è€Œå‡å°‘å“åº”æ—¶é—´ã€‚</p></li><li><p><strong>å‡å°‘æ•°æ®åº“å‹åŠ›</strong>: åœ¨é«˜å¹¶å‘æƒ…å†µä¸‹ï¼Œæ•°æ®åº“å¯èƒ½æˆä¸ºæ€§èƒ½ç“¶é¢ˆã€‚ç¼“å­˜å¯ä»¥å¸æ”¶å¤§é‡çš„è¯»æ“ä½œï¼Œå‡è½»æ•°æ®åº“çš„è´Ÿæ‹…ã€‚</p></li><li><p><strong>å¿«é€Ÿè¯»å†™</strong>: å†…å­˜çš„è¯»å†™é€Ÿåº¦è¿œå¿«äºç¡¬ç›˜ã€‚ä½¿ç”¨å†…å­˜ä½œä¸ºç¼“å­˜ä»‹è´¨ï¼Œå¯ä»¥å®ç°è¿…é€Ÿçš„æ•°æ®è®¿é—®ã€‚</p></li></ol><p>é€‰æ‹©Redisçš„åŸå› </p><ol><li><p><strong>æµè¡Œæ€§å’Œç¤¾åŒºæ”¯æŒ</strong>: Redisä½œä¸ºä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„æŠ€æœ¯ï¼Œæ‹¥æœ‰å¼ºå¤§çš„ç¤¾åŒºæ”¯æŒå’Œä¸°å¯Œçš„æ–‡æ¡£èµ„æºã€‚è¿™æ„å‘³ç€åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜æ—¶ï¼Œæ›´å®¹æ˜“æ‰¾åˆ°è§£å†³æ–¹æ¡ˆã€‚</p></li><li><p><strong>é«˜å¯ç”¨å’Œé›†ç¾¤æ”¯æŒ</strong>: Redisçš„é«˜å¯ç”¨æ€§å’Œé›†ç¾¤åŠŸèƒ½ä½¿å…¶åœ¨å¤„ç†å¤§è§„æ¨¡ã€é«˜å¯ç”¨æ€§éœ€æ±‚çš„åœºæ™¯ä¸­è¡¨ç°å“è¶Šã€‚</p></li><li><p><strong>æŒä¹…åŒ–èƒ½åŠ›</strong>: Redisæä¾›å¤šç§æŒä¹…åŒ–é€‰é¡¹ï¼Œå¦‚RDBï¼ˆå¿«ç…§ï¼‰å’ŒAOFï¼ˆæ—¥å¿—ï¼‰ï¼Œè¿™ä½¿å¾—å³ä½¿åœ¨æ–­ç”µç­‰æƒ…å†µä¸‹æ•°æ®ä¹Ÿä¸ä¼šä¸¢å¤±ã€‚</p></li><li><p><strong>æ•°æ®ç±»å‹ä¸°å¯Œ</strong>: Redisæ”¯æŒçš„æ•°æ®ç»“æ„ä¸ä»…é™äºç®€å•çš„é”®å€¼å¯¹ï¼Œè¿˜åŒ…æ‹¬åˆ—è¡¨ã€é›†åˆã€å“ˆå¸Œè¡¨ç­‰ï¼Œè¿™ä½¿å¾—å¼€å‘è€…å¯ä»¥ä¸ºå„ç§ä¸åŒçš„åº”ç”¨åœºæ™¯é€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„ã€‚</p></li><li><p><strong>æ˜“äºæ­å»ºå’Œç»´æŠ¤</strong>: ç›¸è¾ƒäºä¸€äº›å…¶ä»–çš„è§£å†³æ–¹æ¡ˆï¼ŒRedisçš„æ­å»ºå’Œç»´æŠ¤ç›¸å¯¹ç®€å•ï¼Œè¿™é™ä½äº†æŠ€æœ¯é—¨æ§›å’Œç»´æŠ¤æˆæœ¬ã€‚</p></li></ol><h4 id="2ã€åœ¨ä½¿ç”¨Redisä½œä¸ºç¼“å­˜æ—¶ï¼Œå¦‚æœé‡åˆ°ç¼“å­˜ç©¿é€ï¼ˆå³è¯·æ±‚çš„æ•°æ®ä¸åœ¨ç¼“å­˜ä¸­ä¹Ÿä¸åœ¨æ•°æ®åº“ä¸­ï¼‰çš„é—®é¢˜ï¼Œä½ ä¼šå¦‚ä½•è§£å†³ï¼Ÿ"><a href="#2ã€åœ¨ä½¿ç”¨Redisä½œä¸ºç¼“å­˜æ—¶ï¼Œå¦‚æœé‡åˆ°ç¼“å­˜ç©¿é€ï¼ˆå³è¯·æ±‚çš„æ•°æ®ä¸åœ¨ç¼“å­˜ä¸­ä¹Ÿä¸åœ¨æ•°æ®åº“ä¸­ï¼‰çš„é—®é¢˜ï¼Œä½ ä¼šå¦‚ä½•è§£å†³ï¼Ÿ" class="headerlink" title="2ã€åœ¨ä½¿ç”¨Redisä½œä¸ºç¼“å­˜æ—¶ï¼Œå¦‚æœé‡åˆ°ç¼“å­˜ç©¿é€ï¼ˆå³è¯·æ±‚çš„æ•°æ®ä¸åœ¨ç¼“å­˜ä¸­ä¹Ÿä¸åœ¨æ•°æ®åº“ä¸­ï¼‰çš„é—®é¢˜ï¼Œä½ ä¼šå¦‚ä½•è§£å†³ï¼Ÿ"></a>2ã€åœ¨ä½¿ç”¨Redisä½œä¸ºç¼“å­˜æ—¶ï¼Œå¦‚æœé‡åˆ°ç¼“å­˜ç©¿é€ï¼ˆå³è¯·æ±‚çš„æ•°æ®ä¸åœ¨ç¼“å­˜ä¸­ä¹Ÿä¸åœ¨æ•°æ®åº“ä¸­ï¼‰çš„é—®é¢˜ï¼Œä½ ä¼šå¦‚ä½•è§£å†³ï¼Ÿ</h4><p>è§£å†³ç¼“å­˜ç©¿é€é—®é¢˜çš„ä¸¤ç§å¸¸è§æ–¹æ³•ï¼šä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨å’Œè®¾ç½®ç©ºå¯¹è±¡ç¼“å­˜ã€‚</p><blockquote><p>GPT</p></blockquote><p>å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆBloom Filterï¼‰</p><p>å¸ƒéš†è¿‡æ»¤å™¨æ˜¯ä¸€ç§ç©ºé—´æ•ˆç‡å¾ˆé«˜çš„æ•°æ®ç»“æ„ï¼Œç”¨äºæ£€æµ‹ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨ä¸€ä¸ªé›†åˆä¸­ã€‚å®ƒçš„ç‰¹ç‚¹æ˜¯å¯èƒ½ä¼šè¯¯åˆ¤ï¼ˆå³é”™è¯¯åœ°è®¤ä¸ºæŸä¸ªå…ƒç´ å­˜åœ¨äºé›†åˆä¸­ï¼‰ï¼Œä½†ä¸ä¼šæ¼åˆ¤ï¼ˆå³å¦‚æœå®ƒè¯´æŸä¸ªå…ƒç´ ä¸åœ¨é›†åˆä¸­ï¼Œé‚£ä¹ˆè¿™ä¸ªå…ƒç´ ä¸€å®šä¸åœ¨é›†åˆä¸­ï¼‰ã€‚</p><ul><li><strong>åº”ç”¨äºç¼“å­˜ç©¿é€</strong>: åœ¨æŸ¥è¯¢ç¼“å­˜ä¹‹å‰ï¼Œå…ˆä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨æ£€æŸ¥æ•°æ®æ˜¯å¦å¯èƒ½å­˜åœ¨ã€‚å¦‚æœå¸ƒéš†è¿‡æ»¤å™¨è¡¨ç¤ºæ•°æ®ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆå°±å¯ä»¥é¿å…å¯¹æ•°æ®åº“çš„æŸ¥è¯¢ï¼Œä»è€Œé˜²æ­¢ç¼“å­˜ç©¿é€ã€‚</li><li><strong>ä¼˜ç‚¹</strong>: èƒ½å¤Ÿå¤§é‡å‡å°‘å¯¹æ•°æ®åº“çš„æ— æ•ˆæŸ¥è¯¢ï¼Œæé«˜ç³»ç»Ÿçš„æ•´ä½“æ€§èƒ½ã€‚</li><li><strong>æ³¨æ„ç‚¹</strong>: éœ€è¦åˆç†è®¾ç½®å¸ƒéš†è¿‡æ»¤å™¨çš„å¤§å°å’Œå“ˆå¸Œå‡½æ•°çš„æ•°é‡ï¼Œä»¥å¹³è¡¡è¯¯åˆ¤ç‡å’Œç©ºé—´æ•ˆç‡ã€‚</li></ul><p>è®¾ç½®ç©ºå¯¹è±¡ç¼“å­˜</p><p>å½“æŸ¥è¯¢ä¸åˆ°æ•°æ®æ—¶ï¼Œå¯ä»¥åœ¨ç¼“å­˜ä¸­è®¾ç½®ä¸€ä¸ªç‰¹æ®Šçš„ç©ºå¯¹è±¡æˆ–æ ‡è®°ï¼Œè¡¨ç¤ºè¿™ä¸ªæ•°æ®åœ¨æ•°æ®åº“ä¸­æ˜¯ä¸å­˜åœ¨çš„ã€‚</p><ul><li><strong>åº”ç”¨äºç¼“å­˜ç©¿é€</strong>: è¿™æ ·å½“å†æ¬¡æŸ¥è¯¢ç›¸åŒçš„éå­˜åœ¨æ•°æ®æ—¶ï¼Œå¯ä»¥ç›´æ¥ä»ç¼“å­˜ä¸­è·å–åˆ°è¿™ä¸ªç©ºå¯¹è±¡ï¼Œä»è€Œé¿å…å†æ¬¡æŸ¥è¯¢æ•°æ®åº“ã€‚</li><li><strong>ä¼˜ç‚¹</strong>: ç®€å•æ˜“è¡Œï¼Œå¯ä»¥å¿«é€Ÿå®ç°ã€‚</li><li><strong>æ³¨æ„ç‚¹</strong>: éœ€è¦è®¾ç½®åˆç†çš„è¿‡æœŸæ—¶é—´ï¼Œä»¥é¿å…é•¿æ—¶é—´å ç”¨ç¼“å­˜ç©ºé—´ã€‚åŒæ—¶ï¼Œè¦é˜²æ­¢è¿™ç§æ–¹æ³•è¢«æ¶æ„åˆ©ç”¨ï¼Œå¯¼è‡´ç¼“å­˜è¢«å¡«æ»¡æ— æ•ˆæ•°æ®ã€‚</li></ul><h4 id="3ã€â€œç¼“å­˜é›ªå´©â€çš„ç°è±¡ï¼Œè¿™æ˜¯æŒ‡ä»€ä¹ˆï¼Ÿåˆè¯¥å¦‚ä½•é˜²æ­¢å®ƒå‘ç”Ÿï¼Ÿ"><a href="#3ã€â€œç¼“å­˜é›ªå´©â€çš„ç°è±¡ï¼Œè¿™æ˜¯æŒ‡ä»€ä¹ˆï¼Ÿåˆè¯¥å¦‚ä½•é˜²æ­¢å®ƒå‘ç”Ÿï¼Ÿ" class="headerlink" title="3ã€â€œç¼“å­˜é›ªå´©â€çš„ç°è±¡ï¼Œè¿™æ˜¯æŒ‡ä»€ä¹ˆï¼Ÿåˆè¯¥å¦‚ä½•é˜²æ­¢å®ƒå‘ç”Ÿï¼Ÿ"></a>3ã€â€œç¼“å­˜é›ªå´©â€çš„ç°è±¡ï¼Œè¿™æ˜¯æŒ‡ä»€ä¹ˆï¼Ÿåˆè¯¥å¦‚ä½•é˜²æ­¢å®ƒå‘ç”Ÿï¼Ÿ</h4><p>ç¼“å­˜é›ªå´©æ˜¯ç”±äºå¤§é‡ç¼“å­˜åŒæ—¶å¤±æ•ˆæ‰€å¼•èµ·çš„ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´çªç„¶çš„æ•°æ®åº“è¯·æ±‚æ¿€å¢ï¼Œè¿›è€Œå¯èƒ½å¯¼è‡´æ•°æ®åº“æœåŠ¡å´©æºƒ</p><p>è§£å†³ç¼“å­˜é›ªå´©çš„ç­–ç•¥</p><ol><li><p><strong>ä¸åŒçš„è¿‡æœŸæ—¶é—´</strong>: æ­£å¦‚ä½ æ‰€è¯´ï¼Œç»™ä¸åŒçš„ç¼“å­˜é¡¹è®¾ç½®ä¸åŒçš„è¿‡æœŸæ—¶é—´å¯ä»¥é¿å…å®ƒä»¬åŒæ—¶è¿‡æœŸã€‚è¿™æ ·å¯ä»¥å°†ç¼“å­˜å¤±æ•ˆçš„è¯·æ±‚åˆ†æ•£åˆ°ä¸åŒçš„æ—¶é—´ç‚¹ï¼Œå‡å°‘å¯¹æ•°æ®åº“çš„å‹åŠ›ã€‚</p></li><li><p><strong>ç¼“å­˜æ•°æ®é¢„çƒ­</strong>: ç³»ç»Ÿå¯åŠ¨æ—¶ï¼Œé¢„å…ˆåŠ è½½ä¸€äº›å…³é”®æ•°æ®åˆ°ç¼“å­˜ä¸­ã€‚è¿™æ„å‘³ç€å³ä½¿ç¼“å­˜è¿‡æœŸï¼Œå·²ç»é¢„çƒ­çš„æ•°æ®ä»ç„¶å¯ä»¥æ”¯æ’‘ä¸€æ®µæ—¶é—´çš„è¯»å–éœ€æ±‚ï¼Œå‡è½»æ•°æ®åº“è´Ÿæ‹…ã€‚</p></li></ol><p>è¡¥å……è§£å†³æ–¹æ¡ˆ</p><ol start="3"><li><p><strong>è®¾ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´éšæœºåŒ–</strong>: ä¸ºç¼“å­˜é¡¹è®¾ç½®çš„è¿‡æœŸæ—¶é—´åŠ ä¸Šä¸€ä¸ªéšæœºå€¼ï¼Œè¿™æ ·å³ä½¿å¤šä¸ªç¼“å­˜é¡¹åŸæœ¬æœ‰ç›¸åŒçš„è¿‡æœŸæ—¶é—´ï¼Œå®ƒä»¬å®é™…å¤±æ•ˆçš„æ—¶é—´ä¹Ÿä¼šæœ‰æ‰€ä¸åŒã€‚</p></li><li><p><strong>ä½¿ç”¨æŒä¹…åŒ–</strong>: åœ¨Redisç­‰ç¼“å­˜ç³»ç»Ÿä¸­ä½¿ç”¨æŒä¹…åŒ–ï¼Œå³ä½¿ç¼“å­˜æœåŠ¡é‡å¯ï¼Œæ•°æ®ä¹Ÿå¯ä»¥ä»ç£ç›˜ä¸­æ¢å¤ï¼Œå‡å°‘äº†å¯¹æ•°æ®åº“çš„ç›´æ¥å‹åŠ›ã€‚</p></li><li><p><strong>é™æµå’Œé™çº§æœºåˆ¶</strong>: åœ¨ç³»ç»Ÿè®¾è®¡æ—¶å¼•å…¥é™æµå’Œé™çº§ç­–ç•¥ï¼Œå½“æ£€æµ‹åˆ°æ•°æ®åº“è¯·æ±‚é‡æ¿€å¢æ—¶ï¼Œé€šè¿‡é™æµæ¥æ§åˆ¶è¯·æ±‚é‡ï¼Œæˆ–è€…æš‚æ—¶é™çº§æœåŠ¡ï¼ˆå¦‚è¿”å›ç®€åŒ–æ•°æ®æˆ–é”™è¯¯ä¿¡æ¯ï¼‰ï¼Œä»¥ä¿æŠ¤æ•°æ®åº“ä¸è¢«å‹å®ã€‚</p></li></ol><h4 id="4ã€â€œç¼“å­˜å‡»ç©¿â€ï¼Œå®ƒæ˜¯ä»€ä¹ˆæ„æ€ï¼Œä»¥åŠå¦‚ä½•è§£å†³ï¼Ÿ"><a href="#4ã€â€œç¼“å­˜å‡»ç©¿â€ï¼Œå®ƒæ˜¯ä»€ä¹ˆæ„æ€ï¼Œä»¥åŠå¦‚ä½•è§£å†³ï¼Ÿ" class="headerlink" title="4ã€â€œç¼“å­˜å‡»ç©¿â€ï¼Œå®ƒæ˜¯ä»€ä¹ˆæ„æ€ï¼Œä»¥åŠå¦‚ä½•è§£å†³ï¼Ÿ"></a>4ã€â€œç¼“å­˜å‡»ç©¿â€ï¼Œå®ƒæ˜¯ä»€ä¹ˆæ„æ€ï¼Œä»¥åŠå¦‚ä½•è§£å†³ï¼Ÿ</h4><p>ç¼“å­˜å‡»ç©¿æ˜¯æŒ‡ä¸€ä¸ªçƒ­ç‚¹çš„ç¼“å­˜é¡¹ï¼ˆå³é«˜é¢‘è®¿é—®çš„æ•°æ®ï¼‰çªç„¶å¤±æ•ˆï¼ˆæ¯”å¦‚è¿‡æœŸäº†ï¼‰ï¼Œæ­¤æ—¶çªç„¶æœ‰å¤§é‡çš„å¹¶å‘è¯·æ±‚ç›´æ¥æ‰“åˆ°æ•°æ®åº“ä¸Šï¼Œå¯èƒ½ä¼šå¯¹æ•°æ®åº“é€ æˆå¾ˆå¤§å‹åŠ›ã€‚</p><p>è§£å†³ç¼“å­˜å‡»ç©¿çš„ç­–ç•¥</p><ol><li><p><strong>è®¾ç½®é•¿æ—¶é—´æˆ–ä¸è¿‡æœŸ</strong>: å¯¹äºé‚£äº›æŸ¥è¯¢é‡éå¸¸å¤§çš„çƒ­ç‚¹æ•°æ®ï¼Œå¯ä»¥è®¾ç½®è¾ƒé•¿çš„è¿‡æœŸæ—¶é—´ç”šè‡³ä¸è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œè¿™æ ·å¯ä»¥ä¿è¯è¿™äº›æ•°æ®å¤§éƒ¨åˆ†æ—¶é—´éƒ½åœ¨ç¼“å­˜ä¸­ã€‚</p></li><li><p><strong>é™æµå’Œé™çº§å¤„ç†</strong>: å½“ç³»ç»Ÿæ£€æµ‹åˆ°æŸä¸ªé”®çªç„¶è¯·æ±‚é‡æ¿€å¢æ—¶ï¼Œå¯ä»¥ä¸´æ—¶å¯¹è¿™äº›è¯·æ±‚è¿›è¡Œé™æµï¼Œæˆ–è€…åœ¨æ•°æ®ä¸å¯ç”¨æ—¶æä¾›é™çº§æœåŠ¡ã€‚</p></li></ol><p>è¡¥å……è§£å†³æ–¹æ¡ˆ</p><ol start="3"><li><p><strong>ä½¿ç”¨äº’æ–¥é”</strong>: å½“ç¼“å­˜å¤±æ•ˆæ—¶ï¼Œä¸æ˜¯æ‰€æœ‰è¯·æ±‚éƒ½å»åŠ è½½æ•°æ®åº“æ•°æ®ï¼Œè€Œæ˜¯ä½¿ç”¨äº’æ–¥é”ï¼ˆæˆ–å…¶ä»–åŒæ­¥æœºåˆ¶ï¼‰æ§åˆ¶åªæœ‰ä¸€ä¸ªè¯·æ±‚å»æ•°æ®åº“ä¸­åŠ è½½æ•°æ®å¹¶é‡æ–°å¡«å……åˆ°ç¼“å­˜ä¸­ã€‚å…¶ä»–è¯·æ±‚ç­‰å¾…ç¼“å­˜é‡å»ºåå†è®¿é—®ç¼“å­˜ã€‚</p></li><li><p><strong>é€»è¾‘è¿‡æœŸ</strong>: å¯¹äºçƒ­ç‚¹æ•°æ®ï¼Œå¯ä»¥è®¾ç½®ä¸¤å±‚è¿‡æœŸæ—¶é—´ï¼Œä¸€ä¸ªæ˜¯çœŸå®çš„è¿‡æœŸæ—¶é—´ï¼Œå¦ä¸€ä¸ªæ˜¯é€»è¾‘ä¸Šçš„è¿‡æœŸæ—¶é—´ã€‚åœ¨é€»è¾‘è¿‡æœŸåï¼Œå¯åŠ¨ä¸€ä¸ªå¼‚æ­¥çº¿ç¨‹å»æ›´æ–°è¿™ä¸ªæ•°æ®ï¼Œä½†åœ¨çœŸå®è¿‡æœŸå‰ï¼Œä»ç„¶å¯ä»¥è¿”å›æ—§çš„ç¼“å­˜æ•°æ®ï¼Œé¿å…ç›´æ¥æ‰“åˆ°æ•°æ®åº“ã€‚</p></li></ol><h4 id="5ã€ç¼“å­˜ä¸€è‡´æ€§ï¼šå½“æ•°æ®åŒæ—¶å­˜å‚¨åœ¨æ•°æ®åº“å’Œç¼“å­˜ä¸­æ—¶ï¼Œå¦‚ä½•ä¿è¯ç¼“å­˜å’Œæ•°æ®åº“ä¹‹é—´çš„æ•°æ®ä¸€è‡´æ€§ï¼Ÿ"><a href="#5ã€ç¼“å­˜ä¸€è‡´æ€§ï¼šå½“æ•°æ®åŒæ—¶å­˜å‚¨åœ¨æ•°æ®åº“å’Œç¼“å­˜ä¸­æ—¶ï¼Œå¦‚ä½•ä¿è¯ç¼“å­˜å’Œæ•°æ®åº“ä¹‹é—´çš„æ•°æ®ä¸€è‡´æ€§ï¼Ÿ" class="headerlink" title="5ã€ç¼“å­˜ä¸€è‡´æ€§ï¼šå½“æ•°æ®åŒæ—¶å­˜å‚¨åœ¨æ•°æ®åº“å’Œç¼“å­˜ä¸­æ—¶ï¼Œå¦‚ä½•ä¿è¯ç¼“å­˜å’Œæ•°æ®åº“ä¹‹é—´çš„æ•°æ®ä¸€è‡´æ€§ï¼Ÿ"></a>5ã€<strong>ç¼“å­˜ä¸€è‡´æ€§</strong>ï¼šå½“æ•°æ®åŒæ—¶å­˜å‚¨åœ¨æ•°æ®åº“å’Œç¼“å­˜ä¸­æ—¶ï¼Œå¦‚ä½•ä¿è¯ç¼“å­˜å’Œæ•°æ®åº“ä¹‹é—´çš„æ•°æ®ä¸€è‡´æ€§ï¼Ÿ</h4><p>ç¼“å­˜å­˜ä¸€è‡´æ€§çš„æŒ‘æˆ˜</p><p>åœ¨æ—è·¯ç¼“å­˜æ¨¡å¼ä¸­ï¼Œåœ¨æ›´æ–°æ•°æ®åº“åã€åˆ é™¤ç¼“å­˜å‰çš„è¿™ä¸ªçŸ­æš‚æ—¶é—´çª—å£å†…ï¼Œå…¶ä»–è¯»å–æ“ä½œå¯èƒ½ä¼šè¯»åˆ°æ—§çš„ç¼“å­˜æ•°æ®ã€‚</p><p>è§£å†³æ–¹æ¡ˆ</p><ol><li><strong>æ›´æ–°æ•°æ®åº“åç«‹å³åˆ é™¤ç¼“å­˜</strong>: è¿™æ˜¯æœ€å¸¸ç”¨çš„æ–¹æ³•ã€‚å…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†åˆ é™¤ç¼“å­˜ï¼Œä¿è¯ä¸‹ä¸€æ¬¡è¯»å–æ—¶èƒ½å¤Ÿä»æ•°æ®åº“ä¸­åŠ è½½æœ€æ–°æ•°æ®ã€‚ä½†æ­£å¦‚ä½ æåˆ°çš„ï¼Œè¿™ç§æ–¹æ³•å­˜åœ¨ä¸€ä¸ªçª—å£æœŸï¼Œå¯èƒ½ä¼šè¯»åˆ°æ—§æ•°æ®ã€‚</li><li><strong>ä½¿ç”¨äº‹åŠ¡æˆ–é”</strong>: å¯¹æ›´æ–°æ“ä½œåŠ é”å¯ä»¥ä¿è¯åœ¨æ›´æ–°æ•°æ®åº“å’Œåˆ é™¤ç¼“å­˜çš„è¿‡ç¨‹ä¸­ï¼Œä¸ä¼šæœ‰è¯»å–æ“ä½œä»‹å…¥ï¼Œä»è€Œé¿å…è¯»å–åˆ°æ—§æ•°æ®ã€‚ä½†è¿™å¯èƒ½ä¼šé™ä½ç³»ç»Ÿçš„å¹¶å‘æ€§èƒ½ã€‚</li></ol><p>è¡¥å……ç­–ç•¥</p><ol start="3"><li><strong>å»¶è¿ŸåŒåˆ </strong>: æ›´æ–°æ•°æ®åº“åï¼Œå…ˆåˆ é™¤ç¼“å­˜ï¼Œç¨ä½œå»¶æ—¶ï¼Œç„¶åå†æ¬¡åˆ é™¤ç¼“å­˜ã€‚è¿™ç§æ–¹æ³•çš„ç›®çš„æ˜¯ä¸ºäº†è¦†ç›–é‚£äº›åœ¨ç¬¬ä¸€æ¬¡åˆ é™¤ç¼“å­˜å’Œæ•°æ®åº“æ›´æ–°ä¹‹é—´ç”±äºå…¶ä»–è¯»æ“ä½œå¼•å…¥çš„æ—§æ•°æ®ã€‚</li><li><strong>Write-Through&#x2F;Read-Throughç¼“å­˜</strong>: åœ¨Write-Throughç­–ç•¥ä¸­ï¼Œåº”ç”¨ç¨‹åºå…ˆå†™ç¼“å­˜ï¼Œç¼“å­˜å†åŒæ­¥åˆ°æ•°æ®åº“ï¼›åœ¨Read-Throughç­–ç•¥ä¸­ï¼Œå¦‚æœç¼“å­˜æœªå‘½ä¸­ï¼Œç¼“å­˜ç³»ç»Ÿä¼šä»æ•°æ®åº“åŠ è½½æ•°æ®å¹¶è¿”å›ï¼ŒåŒæ—¶æ›´æ–°ç¼“å­˜ã€‚è¿™äº›ç­–ç•¥å¯ä»¥ç”±ç¼“å­˜æ¡†æ¶è‡ªåŠ¨ç®¡ç†ï¼Œå‡å°‘äº†æ‰‹åŠ¨å¤„ç†ç¼“å­˜ä¸€è‡´æ€§çš„è´Ÿæ‹…ã€‚</li></ol><h4 id="6ã€åœ¨åˆ†å¸ƒå¼ç¼“å­˜ç¯å¢ƒä¸­ï¼Œå¦‚ä½•å¤„ç†å¤šä¸ªèŠ‚ç‚¹ä¹‹é—´çš„ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜ï¼Ÿ"><a href="#6ã€åœ¨åˆ†å¸ƒå¼ç¼“å­˜ç¯å¢ƒä¸­ï¼Œå¦‚ä½•å¤„ç†å¤šä¸ªèŠ‚ç‚¹ä¹‹é—´çš„ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜ï¼Ÿ" class="headerlink" title="6ã€åœ¨åˆ†å¸ƒå¼ç¼“å­˜ç¯å¢ƒä¸­ï¼Œå¦‚ä½•å¤„ç†å¤šä¸ªèŠ‚ç‚¹ä¹‹é—´çš„ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜ï¼Ÿ"></a>6ã€åœ¨åˆ†å¸ƒå¼ç¼“å­˜ç¯å¢ƒä¸­ï¼Œå¦‚ä½•å¤„ç†å¤šä¸ªèŠ‚ç‚¹ä¹‹é—´çš„ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜ï¼Ÿ</h4><hr><p>å‚è€ƒ</p><ul><li><a href="https://mp.weixin.qq.com/s/7hfkBOrbdVUNkepuQ0PX6Q">https://mp.weixin.qq.com/s/7hfkBOrbdVUNkepuQ0PX6Q</a></li><li><a href="https://www.yuque.com/snailclimb/mf2z3k/fg8lgc">https://www.yuque.com/snailclimb/mf2z3k/fg8lgc</a></li><li><a href="https://www.yuque.com/snailclimb/mf2z3k/es0afc">https://www.yuque.com/snailclimb/mf2z3k/es0afc</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>é¢è¯•é¢˜</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>é¢è¯•é¢˜</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é¢è¯•é¢˜_JVM</title>
    <link href="/2024/01/02/%E9%9D%A2%E8%AF%95%E9%A2%98_JVM/"/>
    <url>/2024/01/02/%E9%9D%A2%E8%AF%95%E9%A2%98_JVM/</url>
    
    <content type="html"><![CDATA[<p>ä¸‹é¢çš„é¢è¯•é¢˜ä¸»è¦é’ˆå¯¹çš„æ˜¯ HotSpot VMã€‚</p><p><strong>è‡ªæµ‹é¢˜</strong></p><p>to be continedâ€¦</p><hr>]]></content>
    
    
    <categories>
      
      <category>é¢è¯•é¢˜</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>é¢è¯•é¢˜</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é¢è¯•é¢˜_Javaå¹¶å‘</title>
    <link href="/2024/01/02/%E9%9D%A2%E8%AF%95%E9%A2%98_Java%E5%B9%B6%E5%8F%91/"/>
    <url>/2024/01/02/%E9%9D%A2%E8%AF%95%E9%A2%98_Java%E5%B9%B6%E5%8F%91/</url>
    
    <content type="html"><![CDATA[<p><strong>è‡ªæµ‹é¢˜</strong></p><ul><li>ä»€ä¹ˆæ˜¯çº¿ç¨‹ï¼Œçº¿ç¨‹å’Œè¿›ç¨‹çš„åŒºåˆ«æ˜¯ä»€ä¹ˆã€‚</li><li>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å¤šçº¿ç¨‹ã€‚</li><li>çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸå’ŒçŠ¶æ€è®²ä¸€ä¸‹ã€‚</li><li>ä»€ä¹ˆæ˜¯çº¿ç¨‹æ­»é”ï¼Œå¦‚ä½•é¢„é˜²å’Œé¿å…çº¿ç¨‹æ­»é”ã€‚</li><li>è®²ä¸€ä¸‹çº¿ç¨‹ä¸­çš„ä¹è§‚é”å’Œæ‚²è§‚é”ï¼Œå¹¶è®²ä¸€ä¸‹å…¶å¯¹åº”çš„ä¸€ç§å®ç°æ–¹æ¡ˆã€‚ï¼ˆå¦‚ä½•å®ç°ä¹è§‚é”å’Œæ‚²è§‚é”ï¼‰</li><li>synchronized å…³é”®å­—æœ‰ä»€ä¹ˆä½œç”¨ï¼Œä½ å¹³æ—¶æ€ä¹ˆä½¿ç”¨ synchronized çš„ã€‚</li><li>synchronized å…³é”®å­—çš„åº•å±‚åŸç†è®²ä¸€ä¸‹ã€‚</li><li>synchronized å’Œ ReentrantLock æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚</li><li>synchronized å’Œ volatile çš„åŒºåˆ«è®²ä¸€ä¸‹ã€‚</li><li>ä¹è§‚é”ä¼šå­˜åœ¨ä»€ä¹ˆé—®é¢˜ã€‚</li><li>è®²ä¸€ä¸‹ CAS ï¼Œå…¶å®ç°åŸç†æ‡‚å—ã€‚</li><li>å¦‚æœé‡åˆ°ABAé—®é¢˜ï¼Œæ€ä¹ˆè§£å†³ï¼Ÿ</li><li>AQS æ˜¯ä»€ä¹ˆï¼Œä»–çš„åŸç†äº†è§£å—ã€‚</li><li>å¹¶å‘ç¼–ç¨‹çš„ä¸‰ä¸ªé‡è¦ç‰¹æ€§æ˜¯å“ªä¸‰ä¸ªï¼Ÿ</li><li>ä½ æ€ä¹ˆç†è§£ JMM çš„ï¼ŒJMM æ˜¯ä»€ä¹ˆï¼Ÿ</li><li>ThreadLocal çš„åº•å±‚åŸç†è®²ä¸€ä¸‹ï¼Œä½ åœ¨å¹³æ—¶çš„é¡¹ç›®ä¸­æ˜¯å¦‚ä½•ä½¿ç”¨ ThreadLocal å…³é”®å­—çš„ã€‚</li><li>çº¿ç¨‹æ± æœ‰å“ªå‡ ç§ï¼Œçº¿ç¨‹æ± çš„é‡è¦å‚æ•°æœ‰å“ªäº›ï¼Ÿ</li><li>Semaphore æœ‰ä»€ä¹ˆç”¨ï¼Œä»–çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</li><li>CountDownLatcï¼ŒCyclicBarrier äº†è§£å—ã€‚</li></ul><hr><p>å‚è€ƒ</p><ul><li><a href="https://www.yuque.com/snailclimb/mf2z3k/cm70wa">https://www.yuque.com/snailclimb/mf2z3k/cm70wa</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>é¢è¯•é¢˜</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>é¢è¯•é¢˜</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é¢è¯•é¢˜_Javaé›†åˆ</title>
    <link href="/2023/12/30/%E9%9D%A2%E8%AF%95%E9%A2%98_Java%E9%9B%86%E5%90%88/"/>
    <url>/2023/12/30/%E9%9D%A2%E8%AF%95%E9%A2%98_Java%E9%9B%86%E5%90%88/</url>
    
    <content type="html"><![CDATA[<p><strong>è‡ªæµ‹é¢˜</strong></p><ul><li>è®²ä¸€ä¸‹ Listã€Mapã€Set çš„åŒºåˆ«</li><li>å¸¸è§çš„é›†åˆå®ç°ç±»è¯´ä¸€ä¸‹ï¼Œæ€ä¹ˆç”¨çš„å¤§è‡´è¯´ä¸€ä¸‹ã€‚</li><li>å“ªäº›é›†åˆæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œåœ¨å¹¶å‘æƒ…å†µä¸‹ï¼Œå¦‚ä½•ä¿è¯é›†åˆçº¿ç¨‹å®‰å…¨å‘¢ã€‚</li><li>è®²ä¸€ä¸‹List çš„å®ç°ç±»ï¼Œå…¶ä¸­ï¼šArrayList å’Œ Vectorã€ArrayList å’Œ ArrayLinked çš„åŒºåˆ«è®²ä¸€ä¸‹ã€‚</li><li>ArrayList çš„æ‰©å®¹æœºåˆ¶äº†è§£å—ï¼Œè®²è¿°ä¸€ä¸‹æ€ä¹ˆæ‰©å®¹çš„ã€‚</li><li>è¯´ä¸€ä¸‹ HashSetã€LinkedHashSet å’Œ TreeSet ä¸‰è€…çš„åŒºåˆ«ã€‚</li><li>Queue äº†è§£å—ï¼Œè®²ä¸€ä¸‹ä»–çš„å®ç°ç±»ç‰¹ç‚¹ã€‚</li><li>è®²ä¸€ä¸‹HashMap çš„åº•å±‚å®ç°ã€‚</li><li>HashMap çš„æŸ¥è¯¢ã€åˆ é™¤çš„æ—¶é—´å¤æ‚åº¦æ˜¯å¤šå°‘ï¼Ÿ</li><li>è®²ä¸€ä¸‹ HashMap å’Œ ConcurrentHashMap çš„åŒºåˆ«ã€‚</li><li>ConcurrentHashMap çº¿ç¨‹å®‰å…¨çš„åº•å±‚å®ç°åŸç†è®²ä¸€ä¸‹ã€‚</li></ul><hr><p>è‡ªæµ‹é¢˜ç›¸å…³é—®é¢˜å›ç­”</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://www.yuque.com/snailclimb/mf2z3k/vlf8gd">https://www.yuque.com/snailclimb/mf2z3k/vlf8gd</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>é¢è¯•é¢˜</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>é¢è¯•é¢˜</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é¢è¯•é¢˜_JavaåŸºç¡€</title>
    <link href="/2023/12/30/%E9%9D%A2%E8%AF%95%E9%A2%98_Java%E5%9F%BA%E7%A1%80/"/>
    <url>/2023/12/30/%E9%9D%A2%E8%AF%95%E9%A2%98_Java%E5%9F%BA%E7%A1%80/</url>
    
    <content type="html"><![CDATA[<p><strong>è‡ªæµ‹é¢˜</strong></p><ul><li>è®²ä¸€ä¸‹Java ä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹ï¼Œæœ‰å‡ ç§ï¼Œä»–ä»¬é»˜è®¤çš„å ç”¨ç©ºé—´å’Œé»˜è®¤å€¼ï¼Œå¯¹åº”çš„åŒ…è£…ç±»å‹æ˜¯ä»€ä¹ˆã€‚</li><li>åŒ…è£…ç±»å‹å’ŒåŸºç¡€æ•°æ®ç±»å‹çš„åŒºåˆ«ï¼Œä¸ºä»€ä¹ˆè¦æœ‰åŒ…è£…ç±»å‹</li><li>è‡ªåŠ¨æ‹†è£…ç®±çš„åŸç†</li><li>Stringã€StringBufferã€StringBuilder çš„åŒºåˆ«</li><li>é‡è½½å’Œé‡å†™çš„åŒºåˆ«</li><li>è®²ä¸€ä¸‹å†…éƒ¨ç±»ï¼ŒåŒ¿åå†…éƒ¨ç±»æ€ä¹ˆä½¿ç”¨çš„</li><li>è®²ä¸€ä¸‹æ·±æ‹·è´ã€æµ…æ‹·è´å’Œå¼•ç”¨æ‹·è´</li><li>æ¥å£å’ŒæŠ½è±¡ç±»çš„åŒºåˆ«</li><li>Javaåå°„ä½ æ€ä¹ˆç†è§£çš„ï¼Œæ¡†æ¶ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨åå°„ï¼Œä½ æ˜¯æ€ä¹ˆç†è§£åå°„çš„</li><li>è°ˆä¸€ä¸‹ä½ å¯¹ Java æ³¨è§£çš„ç†è§£ï¼Œå¹³æ—¶ä½ æ€ä¹ˆç”¨çš„ï¼Œè®²ä¸€ä¸ªä½ ä½¿ç”¨ Java æ³¨è§£è§£å†³çš„é—®é¢˜</li><li>è®²ä¸€ä¸‹ Java æ³›å‹ï¼Œæ³›å‹æ˜¯ä»€ä¹ˆï¼Œä»–æ€ä¹ˆä½¿ç”¨çš„ï¼Œç±»å‹æ“¦é™¤è®²ä¸€ä¸‹ï¼Œå¸¸ç”¨çš„é€šé…ç¬¦æœ‰å“ªäº›ã€‚</li><li>ä»€ä¹ˆæ˜¯I&#x2F;O; å¸¸è§çš„ IO æ¨¡å‹æœ‰å“ªäº›ï¼ˆBIO&#x2F;NIO&#x2F;AIO çš„åŒºåˆ«è®²ä¸€ä¸‹ï¼‰</li><li>I&#x2F;Oæµä¸ºä»€ä¹ˆè¦åˆ†å­—èŠ‚æµå’Œå­—ç¬¦æµ</li></ul><hr><p>å…³äº String æœ‰ä¸€äº›å¸¸è§çš„é¢è¯•é¢˜ï¼Œæ”¾åœ¨å¦å¤–ä¸€ç¯‡æ–‡ç« ï¼š <strong>é¢è¯•é¢˜_JavaåŸºç¡€_Stringå¸¸è§é¢è¯•é¢˜</strong></p><p>è‡ªæµ‹é¢˜ç›¸å…³å†…å®¹ï¼š</p><h4 id="1ã€Java-ä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹"><a href="#1ã€Java-ä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹" class="headerlink" title="1ã€Java ä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹"></a>1ã€Java ä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹</h4><table><thead><tr><th>ç±»å‹</th><th>åŸºç¡€ç±»å‹</th><th>é»˜è®¤å€¼</th><th>å ç”¨ç©ºé—´å¤§å°</th><th>å¯¹åº”åŒ…è£…ç±»å‹</th></tr></thead><tbody><tr><td>æ•°å­—ç±»å‹</td><td>byte</td><td>0</td><td>1å­—èŠ‚</td><td>Byte</td></tr><tr><td>æ•°å­—ç±»å‹</td><td>short</td><td>0</td><td>2å­—èŠ‚</td><td>Short</td></tr><tr><td>æ•°å­—ç±»å‹</td><td>int</td><td>0</td><td>4å­—èŠ‚</td><td>Integer</td></tr><tr><td>æ•°å­—ç±»å‹</td><td>long</td><td>0L</td><td>8å­—èŠ‚</td><td>Long</td></tr><tr><td>æ•°å­—ç±»å‹</td><td>float</td><td>0.0f</td><td>4å­—èŠ‚</td><td>Float</td></tr><tr><td>æ•°å­—ç±»å‹</td><td>double</td><td>0.0d</td><td>8å­—èŠ‚</td><td>Double</td></tr><tr><td>å­—ç¬¦ç±»å‹</td><td>char</td><td>â€˜\u0000â€™ï¼ˆå³ç©ºå­—ç¬¦ï¼‰</td><td>2å­—èŠ‚ï¼ˆä½¿ç”¨Unicodeç¼–ç ï¼‰</td><td>Character</td></tr><tr><td>å¸ƒå°”ç±»å‹</td><td>boolean</td><td>false</td><td>1å­—èŠ‚</td><td>Boolean</td></tr></tbody></table><h4 id="2ã€åŒ…è£…ç±»å‹å’ŒåŸºç¡€ç±»å‹çš„åŒºåˆ«"><a href="#2ã€åŒ…è£…ç±»å‹å’ŒåŸºç¡€ç±»å‹çš„åŒºåˆ«" class="headerlink" title="2ã€åŒ…è£…ç±»å‹å’ŒåŸºç¡€ç±»å‹çš„åŒºåˆ«"></a>2ã€åŒ…è£…ç±»å‹å’ŒåŸºç¡€ç±»å‹çš„åŒºåˆ«</h4><p>åŒ…è£…ç±»å‹èƒ½å¤Ÿé€šè¿‡å¯¹è±¡çš„æ–¹å¼è¿›è¡Œæ“ä½œï¼Œåœ¨ä½¿ç”¨æ³›å‹çš„æ—¶å€™ä¼šç”¨åˆ°ã€‚</p><p>åŒæ—¶æˆ‘ä»¬è¿ç®—çš„æ—¶å€™ä¹Ÿä¼šæœ‰è‡ªåŠ¨æ‹†ç®±å’Œè‡ªåŠ¨è£…ç®±å­</p><h4 id="3ã€Stringã€StringBufferã€StringBuilder-çš„åŒºåˆ«"><a href="#3ã€Stringã€StringBufferã€StringBuilder-çš„åŒºåˆ«" class="headerlink" title="3ã€Stringã€StringBufferã€StringBuilder çš„åŒºåˆ«"></a>3ã€Stringã€StringBufferã€StringBuilder çš„åŒºåˆ«</h4><table><thead><tr><th>ç‰¹æ€§</th><th><code>String</code></th><th><code>StringBuffer</code></th><th><code>StringBuilder</code></th></tr></thead><tbody><tr><td>å¯å˜æ€§</td><td>ä¸å¯å˜</td><td>å¯å˜</td><td>å¯å˜</td></tr><tr><td>çº¿ç¨‹å®‰å…¨</td><td>æ˜¯</td><td>æ˜¯</td><td>å¦</td></tr><tr><td>æ€§èƒ½</td><td>è¾ƒä½ï¼ˆå¯¹äºé¢‘ç¹ä¿®æ”¹ï¼‰</td><td>é«˜ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰</td><td>é«˜ï¼ˆéçº¿ç¨‹å®‰å…¨ï¼‰</td></tr><tr><td>ç”¨é€”</td><td>æ–‡æœ¬ä¸é¢‘ç¹æ”¹å˜æ—¶</td><td>å¤šçº¿ç¨‹ä¸­æ–‡æœ¬é¢‘ç¹æ”¹å˜</td><td>å•çº¿ç¨‹ä¸­æ–‡æœ¬é¢‘ç¹æ”¹å˜</td></tr></tbody></table><h4 id="4ã€é‡è½½å’Œé‡å†™çš„åŒºåˆ«"><a href="#4ã€é‡è½½å’Œé‡å†™çš„åŒºåˆ«" class="headerlink" title="4ã€é‡è½½å’Œé‡å†™çš„åŒºåˆ«"></a>4ã€é‡è½½å’Œé‡å†™çš„åŒºåˆ«</h4><hr><p>å‚è€ƒ</p><ul><li><a href="https://www.yuque.com/snailclimb/mf2z3k/gre6gr">https://www.yuque.com/snailclimb/mf2z3k/gre6gr</a></li><li><a href="https://javaguide.cn/java/basis/java-basic-questions-01.html#%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5%E4%B8%8E%E5%B8%B8%E8%AF%86">https://javaguide.cn/java/basis/java-basic-questions-01.html#%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5%E4%B8%8E%E5%B8%B8%E8%AF%86</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>é¢è¯•é¢˜</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>é¢è¯•é¢˜</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ¶ˆæ¯é˜Ÿåˆ—_Kafka_åŸºç¡€ä½¿ç”¨</title>
    <link href="/2023/12/30/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97_Kafka_%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/"/>
    <url>/2023/12/30/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97_Kafka_%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å¤§çº²</p></blockquote><ul><li>Kafka æ˜¯ä»€ä¹ˆ</li><li>Kafka çš„æ ¸å¿ƒæ¦‚å¿µ</li></ul><h3 id="1ã€Kafka-æ˜¯ä»€ä¹ˆ"><a href="#1ã€Kafka-æ˜¯ä»€ä¹ˆ" class="headerlink" title="1ã€Kafka æ˜¯ä»€ä¹ˆ"></a>1ã€Kafka æ˜¯ä»€ä¹ˆ</h3><p>ç•¥</p><h3 id="2ã€Kafka-çš„æ ¸å¿ƒæ¦‚å¿µ"><a href="#2ã€Kafka-çš„æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="2ã€Kafka çš„æ ¸å¿ƒæ¦‚å¿µ"></a>2ã€Kafka çš„æ ¸å¿ƒæ¦‚å¿µ</h3><p>æ ¸å¿ƒæ¦‚å¿µä¸»è¦æ˜¯ï¼š Producerã€Consumerã€Brokerã€Topicã€Partition</p><p>æœ‰ç‚¹ç±»ä¼¼ RocketMQï¼Œæ¯•ç«ŸRocketMQ çš„è®¾è®¡ä¹‹å¤„æ˜¯å‚è€ƒäº†éƒ¨åˆ† Kafka çš„è®¾è®¡ï¼Œå…¶ä¸­ Kafka æ˜¯æ²¡æœ‰ Queue è¿™ä¸ªæ¦‚å¿µçš„ï¼Œä¸»é¢˜ Topic ä¸‹é¢çš„å®é™…å­˜å‚¨æ•°æ®é‡‡ç”¨çš„æ˜¯ Partion åˆ†åŒºã€‚</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231230105605.png" alt="image.png"></p><hr><blockquote><p>kafka å’Œ Zookeeper çš„å…³ç³»</p></blockquote><p>åœ¨ Kafka 2.8 ä¹‹å‰ï¼ŒKafka å…¶é‡åº¦ä¾èµ–äº Zookeeperã€‚</p><p>åœ¨ Kafka 2.8 ä¹‹åï¼Œå¼•å…¥äº†åŸºäº Raft åè®®çš„ KRaft æ¨¡å¼ï¼Œä¸å†ä¾èµ– Zookeeperï¼Œç®€åŒ–äº† Kafka çš„æ¶æ„ã€‚</p><p>Zookeeper çš„ä½œç”¨å°±æ˜¯æ³¨å†Œä¸­å¿ƒï¼Œä½œä¸ºèŠ‚ç‚¹çš„ Broker çš„è·¯ç”±ç®¡ç† å’Œé›†ç¾¤è´Ÿè½½ç­‰åŠŸèƒ½</p><blockquote><p>kafka å’Œ RocketMQ çš„åŒºåˆ«</p></blockquote><p>å¯ä»¥çœ‹ä¸€ä¸‹ä¸‹é¢è¿™ä¸ªè§£é‡Š,  å…·ä½“æ›´æ·±å±‚æ¬¡çš„ç†è§£å»ºè®®ä»å®é™…çš„ä»£ç ç¨‹åºæ–¹é¢å…¥æ‰‹å»ç†è§£ã€‚</p><p>Kafka å’Œ RocketMQ éƒ½æ˜¯é«˜æ€§èƒ½çš„æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œå¹¿æ³›ç”¨äºå¤„ç†å¤§è§„æ¨¡æ•°æ®æµå’Œå®ç°åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æ¶ˆæ¯ä¼ é€’ã€‚</p><p>å°½ç®¡å®ƒä»¬æœ‰è®¸å¤šç›¸ä¼¼ä¹‹å¤„ï¼Œä½†ä¹Ÿå­˜åœ¨ä¸€äº›å…³é”®çš„åŒºåˆ«ã€‚ä»¥ä¸‹æ˜¯ Kafka å’Œ RocketMQ ä¸»è¦åŒºåˆ«çš„æ¦‚è¿°ï¼š</p><blockquote><ol><li>è®¾è®¡æ¶æ„</li></ol></blockquote><ul><li><strong>Kafka</strong>ï¼šæœ€åˆç”±LinkedInå¼€å‘ï¼Œé‡ç‚¹æ”¾åœ¨é«˜ååé‡å’Œå¯æ‰©å±•æ€§ä¸Šã€‚Kafka ä½¿ç”¨åˆ†åŒºï¼ˆPartitionï¼‰å’Œå¤åˆ¶ï¼ˆReplicationï¼‰çš„æ¦‚å¿µæ¥ä¿è¯æ¶ˆæ¯çš„å¯é æ€§å’Œå¯ä¼¸ç¼©æ€§ã€‚</li><li><strong>RocketMQ</strong>ï¼šæœ€åˆç”±é˜¿é‡Œå·´å·´å¼€å‘ï¼Œè®¾è®¡é‡ç‚¹æ˜¯æä¾›æ›´ä¸°å¯Œçš„æ¶ˆæ¯æ¨¡å‹å’ŒæœåŠ¡è´¨é‡ã€‚å®ƒé‡‡ç”¨äº†æ›´å¤æ‚çš„å­˜å‚¨å’Œæ¶ˆæ¯è·¯ç”±æœºåˆ¶ã€‚</li></ul><blockquote><ol start="2"><li>å­˜å‚¨æœºåˆ¶</li></ol></blockquote><ul><li><strong>Kafka</strong>ï¼šé‡‡ç”¨åˆ†å¸ƒå¼ã€å¯ä¼¸ç¼©çš„æ—¥å¿—å­˜å‚¨æœºåˆ¶ã€‚æ¯ä¸ªä¸»é¢˜ï¼ˆTopicï¼‰åˆ†ä¸ºå¤šä¸ªåˆ†åŒºï¼Œæ¯ä¸ªåˆ†åŒºåœ¨ç‰©ç†ä¸Šå¯¹åº”ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ã€‚</li><li><strong>RocketMQ</strong>ï¼šä½¿ç”¨å•ä¸€çš„ <code>CommitLog</code> æ–‡ä»¶æ¥å­˜å‚¨æ‰€æœ‰ä¸»é¢˜çš„æ¶ˆæ¯ï¼Œç„¶åé€šè¿‡ <code>ConsumeQueue</code> å’Œ <code>IndexFile</code> æ¥ä¸ºæ¶ˆæ¯æä¾›ç´¢å¼•å’Œå¿«é€Ÿè®¿é—®ã€‚</li></ul><blockquote><ol start="3"><li>æ¶ˆæ¯æ¶ˆè´¹æ¨¡å‹</li></ol></blockquote><ul><li><strong>Kafka</strong>ï¼šä¸»è¦æ”¯æŒå‘å¸ƒ-è®¢é˜…æ¨¡å‹ï¼Œä½†ä¹Ÿå¯ä»¥é€šè¿‡åˆ†åŒºåˆ†é…å®ç°ç±»ä¼¼é˜Ÿåˆ—çš„æ¶ˆè´¹æ¨¡å¼ã€‚Kafka å¼ºè°ƒæ¶ˆè´¹è€…çš„æ¦‚å¿µï¼Œæ¯ä¸ªæ¶ˆè´¹è€…è´Ÿè´£è·Ÿè¸ªè‡ªå·±çš„åç§»é‡ã€‚</li><li><strong>RocketMQ</strong>ï¼šæä¾›æ›´å¤šæ ·çš„æ¶ˆæ¯æ¨¡å‹ï¼ŒåŒ…æ‹¬å‘å¸ƒ-è®¢é˜…ã€ç‚¹å¯¹ç‚¹æ¶ˆæ¯ã€é¡ºåºæ¶ˆæ¯å’Œå»¶æ—¶æ¶ˆæ¯ç­‰ã€‚</li></ul><blockquote><ol start="4"><li>äº‹åŠ¡æ¶ˆæ¯</li></ol></blockquote><ul><li><strong>Kafka</strong>ï¼šåœ¨è¾ƒæ–°ç‰ˆæœ¬ä¸­å¢åŠ äº†å¯¹äº‹åŠ¡æ¶ˆæ¯çš„æ”¯æŒï¼Œä½†å®ç°ç›¸å¯¹ç®€å•ã€‚</li><li><strong>RocketMQ</strong>ï¼šæä¾›äº†æ›´ä¸ºå¤æ‚å’Œå¼ºå¤§çš„äº‹åŠ¡æ¶ˆæ¯æ”¯æŒã€‚</li></ul><blockquote><ol start="5"><li>æ€§èƒ½å’Œå¯é æ€§</li></ol></blockquote><ul><li><strong>Kafka</strong>ï¼šä»¥å…¶é«˜æ€§èƒ½å’Œé«˜ååé‡è€Œè‘—ç§°ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤§é‡æ•°æ®æ—¶ã€‚</li><li><strong>RocketMQ</strong>ï¼šè™½ç„¶ä¹Ÿæä¾›é«˜æ€§èƒ½å¤„ç†ï¼Œä½†åœ¨æŸäº›åœºæ™¯ä¸‹å¯èƒ½ä¸å¦‚Kafkaé«˜æ•ˆï¼Œå°¤å…¶æ˜¯åœ¨å•ä¸€CommitLogè®¾è®¡ä¸‹ã€‚</li></ul><blockquote><ol start="6"><li>ç¤¾åŒºå’Œç”Ÿæ€</li></ol></blockquote><ul><li><strong>Kafka</strong>ï¼šæœ‰ç€å¹¿æ³›çš„ç¤¾åŒºæ”¯æŒå’Œæˆç†Ÿçš„ç”Ÿæ€ç³»ç»Ÿï¼Œæ˜¯æµæ•°æ®å¤„ç†å’Œå®æ—¶åˆ†æçš„é¦–é€‰ã€‚</li><li><strong>RocketMQ</strong>ï¼šåœ¨ä¸­å›½æœ‰è¾ƒå¼ºçš„ç¤¾åŒºæ”¯æŒï¼Œç‰¹åˆ«æ˜¯åœ¨é˜¿é‡Œå·´å·´åŠå…¶ç”Ÿæ€ç³»ç»Ÿä¸­å¾—åˆ°å¹¿æ³›åº”ç”¨ã€‚</li></ul><p>é€‰æ‹©Kafkaè¿˜æ˜¯RocketMQï¼Œå–å†³äºå…·ä½“çš„åº”ç”¨åœºæ™¯å’Œéœ€æ±‚ã€‚</p><p>å¦‚æœéœ€è¦å¤„ç†å¤§è§„æ¨¡çš„æ•°æ®æµï¼Œç‰¹åˆ«æ˜¯åœ¨æ•°æ®åˆ†æå’Œæµå¤„ç†æ–¹é¢ï¼ŒKafkaå¯èƒ½æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚è€Œå¦‚æœéœ€è¦æ›´å¤æ‚çš„æ¶ˆæ¯ç±»å‹å’ŒæœåŠ¡è´¨é‡ï¼Œæˆ–è€…å¯¹äº‹åŠ¡æ¶ˆæ¯æœ‰æ›´é«˜çš„è¦æ±‚ï¼ŒRocketMQå¯èƒ½æ›´é€‚åˆã€‚åœ¨å®é™…é€‰æ‹©æ—¶ï¼Œè¿˜éœ€è¦è€ƒè™‘å›¢é˜Ÿçš„æŠ€æœ¯æ ˆå…¼å®¹æ€§å’Œå…·ä½“çš„ä¸šåŠ¡éœ€æ±‚ã€‚</p><h3 id="3ã€Kafka-æ¶ˆè´¹é¡ºåºã€æ¶ˆæ¯ä¸¢å¤±å’Œé‡å¤æ¶ˆè´¹"><a href="#3ã€Kafka-æ¶ˆè´¹é¡ºåºã€æ¶ˆæ¯ä¸¢å¤±å’Œé‡å¤æ¶ˆè´¹" class="headerlink" title="3ã€Kafka æ¶ˆè´¹é¡ºåºã€æ¶ˆæ¯ä¸¢å¤±å’Œé‡å¤æ¶ˆè´¹"></a>3ã€Kafka æ¶ˆè´¹é¡ºåºã€æ¶ˆæ¯ä¸¢å¤±å’Œé‡å¤æ¶ˆè´¹</h3><p>to be continedâ€¦..</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://javaguide.cn/high-performance/message-queue/kafka-questions-01.html">https://javaguide.cn/high-performance/message-queue/kafka-questions-01.html</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>ä¸­é—´ä»¶</category>
      
      <category>MQ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MQ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ¶ˆæ¯é˜Ÿåˆ—_RabbitMQ_åŸºç¡€ä½¿ç”¨</title>
    <link href="/2023/12/28/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97_RabbitMQ_%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/"/>
    <url>/2023/12/28/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97_RabbitMQ_%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å¤§çº²</p></blockquote><ul><li>RabbitMQæ˜¯ä»€ä¹ˆ</li><li>RabbitMQçš„ç»„æˆéƒ¨åˆ†</li><li>RabbitMQ çš„å·¥ä½œæµç¨‹</li><li>RabbitMQå¹¿æ’­å’Œç›´æ¥æ¨¡å¼ç¤ºä¾‹</li></ul><p><strong>â€œæ¶ˆæ¯é˜Ÿåˆ—(Message Queue)â€æ˜¯åœ¨æ¶ˆæ¯çš„ä¼ è¾“è¿‡ç¨‹ä¸­ä¿å­˜æ¶ˆæ¯çš„å®¹å™¨</strong>ã€‚</p><p>MQ çš„æ ¸å¿ƒä½œç”¨ï¼šå‰Šå³°ã€è§£è€¦ã€å¼‚æ­¥</p><h3 id="1ã€RabbitMQæ˜¯ä»€ä¹ˆ"><a href="#1ã€RabbitMQæ˜¯ä»€ä¹ˆ" class="headerlink" title="1ã€RabbitMQæ˜¯ä»€ä¹ˆ"></a>1ã€RabbitMQæ˜¯ä»€ä¹ˆ</h3><p>å»ºè®®ç›´æ¥å»å®˜ç½‘çœ‹ä¸€ä¸‹ç›¸å…³æ¦‚å¿µï¼š <a href="https://www.rabbitmq.com/documentation.html">https://www.rabbitmq.com/documentation.html</a></p><blockquote><p>RabbitMQçš„ç‰¹ç‚¹</p></blockquote><p>RabbitMQæ˜¯ä¸€æ¬¾ä½¿ç”¨Erlangè¯­è¨€å¼€å‘çš„ï¼Œå®ç°AMQP(é«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®)çš„å¼€æºæ¶ˆæ¯ä¸­é—´ä»¶ã€‚</p><p>ç‰¹ç‚¹</p><ul><li>å¯é æ€§ã€‚æ”¯æŒæŒä¹…åŒ–ï¼Œä¼ è¾“ç¡®è®¤ï¼Œå‘å¸ƒç¡®è®¤ç­‰ä¿è¯äº†MQçš„å¯é æ€§ã€‚</li><li>çµæ´»çš„åˆ†å‘æ¶ˆæ¯ç­–ç•¥ã€‚è¿™åº”è¯¥æ˜¯RabbitMQçš„ä¸€å¤§ç‰¹ç‚¹ã€‚åœ¨æ¶ˆæ¯è¿›å…¥MQå‰ç”±Exchange(äº¤æ¢æœº)è¿›è¡Œè·¯ç”±æ¶ˆæ¯ã€‚åˆ†å‘æ¶ˆæ¯ç­–ç•¥æœ‰ï¼šç®€å•æ¨¡å¼ã€å·¥ä½œé˜Ÿåˆ—æ¨¡å¼ã€å‘å¸ƒè®¢é˜…æ¨¡å¼ã€è·¯ç”±æ¨¡å¼ã€é€šé…ç¬¦æ¨¡å¼ã€‚</li><li>æ”¯æŒé›†ç¾¤ã€‚å¤šå°RabbitMQæœåŠ¡å™¨å¯ä»¥ç»„æˆä¸€ä¸ªé›†ç¾¤ï¼Œå½¢æˆä¸€ä¸ªé€»è¾‘Brokerã€‚</li><li>å¤šç§åè®®ã€‚RabbitMQæ”¯æŒå¤šç§æ¶ˆæ¯é˜Ÿåˆ—åè®®ï¼Œæ¯”å¦‚ STOMPã€MQTT ç­‰ç­‰ã€‚</li><li>æ”¯æŒå¤šç§è¯­è¨€å®¢æˆ·ç«¯ã€‚RabbitMQå‡ ä¹æ”¯æŒæ‰€æœ‰å¸¸ç”¨ç¼–ç¨‹è¯­è¨€ï¼ŒåŒ…æ‹¬ Javaã€.NETã€Ruby ç­‰ç­‰ã€‚</li><li>å¯è§†åŒ–ç®¡ç†ç•Œé¢ã€‚RabbitMQæä¾›äº†ä¸€ä¸ªæ˜“ç”¨çš„ç”¨æˆ·ç•Œé¢ï¼Œä½¿å¾—ç”¨æˆ·å¯ä»¥ç›‘æ§å’Œç®¡ç†æ¶ˆæ¯ Brokerã€‚</li><li>æ’ä»¶æœºåˆ¶ã€‚RabbitMQæä¾›äº†è®¸å¤šæ’ä»¶ï¼Œå¯ä»¥é€šè¿‡æ’ä»¶è¿›è¡Œæ‰©å±•ï¼Œä¹Ÿå¯ä»¥ç¼–å†™è‡ªå·±çš„æ’ä»¶ã€‚</li></ul><blockquote><p>å®‰è£…å’Œä½¿ç”¨</p></blockquote><ul><li><ol><li>å®‰è£… erlang ç¯å¢ƒ</li></ol></li><li><ol start="2"><li>å®‰è£…RabbitMQæœåŠ¡ç«¯</li></ol></li></ul><h3 id="2ã€RabbitMQçš„ç»„æˆéƒ¨åˆ†"><a href="#2ã€RabbitMQçš„ç»„æˆéƒ¨åˆ†" class="headerlink" title="2ã€RabbitMQçš„ç»„æˆéƒ¨åˆ†"></a>2ã€RabbitMQçš„ç»„æˆéƒ¨åˆ†</h3><p>æ ¸å¿ƒæ¦‚å¿µ</p><ul><li>Brokerï¼šæ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡è¿›ç¨‹ã€‚æ­¤è¿›ç¨‹åŒ…æ‹¬ä¸¤ä¸ªéƒ¨åˆ†ï¼šExchangeå’ŒQueueã€‚<ul><li>Exchangeï¼šæ¶ˆæ¯é˜Ÿåˆ—äº¤æ¢æœºã€‚<strong>æŒ‰ä¸€å®šçš„è§„åˆ™å°†æ¶ˆæ¯è·¯ç”±è½¬å‘åˆ°æŸä¸ªé˜Ÿåˆ—</strong>ã€‚</li><li>Queueï¼šæ¶ˆæ¯é˜Ÿåˆ—ï¼Œå­˜å‚¨æ¶ˆæ¯çš„é˜Ÿåˆ—ã€‚</li></ul></li><li>Producerï¼šæ¶ˆæ¯ç”Ÿäº§è€…ã€‚ç”Ÿäº§æ–¹å®¢æˆ·ç«¯å°†æ¶ˆæ¯åŒäº¤æ¢æœºè·¯ç”±å‘é€åˆ°é˜Ÿåˆ—ä¸­ã€‚</li><li>Consumerï¼šæ¶ˆæ¯æ¶ˆè´¹è€…ã€‚æ¶ˆè´¹é˜Ÿåˆ—ä¸­å­˜å‚¨çš„æ¶ˆæ¯ã€‚</li></ul><p>å¤§æ¦‚æµç¨‹ï¼š</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202312121056722.png" alt="image.png"></p><ul><li>æ¶ˆæ¯ç”Ÿäº§è€…è¿æ¥åˆ°RabbitMQ Brokerï¼Œåˆ›å»ºconnectionï¼Œå¼€å¯channelã€‚</li><li>ç”Ÿäº§è€…å£°æ˜äº¤æ¢æœºç±»å‹ã€åç§°ã€æ˜¯å¦æŒä¹…åŒ–ç­‰ã€‚</li><li>ç”Ÿäº§è€…å‘é€æ¶ˆæ¯ï¼Œå¹¶æŒ‡å®šæ¶ˆæ¯æ˜¯å¦æŒä¹…åŒ–ç­‰å±æ€§å’Œ routing keyã€‚</li><li>exchangeæ”¶åˆ°æ¶ˆæ¯ä¹‹åï¼Œ<strong>æ ¹æ®routing keyè·¯ç”±åˆ°è·Ÿå½“å‰äº¤æ¢æœºç»‘å®šçš„ç›¸åŒ¹é…çš„é˜Ÿåˆ—</strong>é‡Œé¢ã€‚</li><li>æ¶ˆè´¹è€…ç›‘å¬æ¥æ”¶åˆ°æ¶ˆæ¯ä¹‹åå¼€å§‹ä¸šåŠ¡å¤„ç†</li></ul><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs brainfuck"><span class="hljs-comment">ç”Ÿäº§è€…</span> <span class="hljs-literal">--</span><span class="hljs-title">[</span><span class="hljs-comment">æ¶ˆæ¯</span><span class="hljs-title">]</span><span class="hljs-literal">--</span>&gt; <span class="hljs-comment">äº¤æ¢æœº</span> <span class="hljs-literal">--</span><span class="hljs-title">[</span><span class="hljs-comment">è·¯ç”±</span><span class="hljs-title">]</span><span class="hljs-literal">--</span>&gt; <span class="hljs-comment">é˜Ÿåˆ—</span> <span class="hljs-literal">--</span><span class="hljs-title">[</span><span class="hljs-comment">æ¶ˆè´¹</span><span class="hljs-title">]</span><span class="hljs-literal">--</span>&gt; <span class="hljs-comment">æ¶ˆè´¹è€…</span><br>    <span class="hljs-comment">\                                         /</span><br>     <span class="hljs-comment">\</span><span class="hljs-literal">--</span><span class="hljs-title">[</span><span class="hljs-comment">é€šé“ Channel</span><span class="hljs-title">]</span><span class="hljs-literal">-----------------------</span><span class="hljs-comment">/</span><br></code></pre></td></tr></table></figure><p>é€šé“çš„æ¦‚å¿µï¼š</p><ul><li><strong>å®šä¹‰</strong>ï¼šé€šé“æ˜¯å»ºç«‹åœ¨å®é™…çš„ TCP è¿æ¥å†…çš„ä¸€ä¸ªè½»é‡çº§è¿æ¥ã€‚å®ƒæ˜¯æ‰§è¡Œå¤§å¤šæ•°æ“ä½œï¼ˆå¦‚æ¶ˆæ¯å‘å¸ƒæˆ–æ¶ˆæ¯æ¥æ”¶ï¼‰çš„è·¯å¾„ã€‚</li><li><strong>ä½œç”¨</strong>ï¼šé€šé“æ˜¯å¤šè·¯å¤ç”¨è¿æ¥ä¸­çš„ä¸€ä¸ªç‹¬ç«‹è·¯å¾„ï¼Œå…è®¸å¤šä¸ªé€šé“å…±äº«ä¸€ä¸ª TCP è¿æ¥ï¼Œè€Œä¸å¿…ä¸ºæ¯ä¸ªé€šé“å»ºç«‹ç‰©ç†è¿æ¥ã€‚è¿™æé«˜äº†èµ„æºåˆ©ç”¨ç‡å’Œé€šä¿¡æ•ˆç‡</li><li>ç”Ÿäº§è€…ä½¿ç”¨é€šé“æ¥å‘é€æ¶ˆæ¯åˆ°äº¤æ¢æœºï¼Œè€Œæ¶ˆè´¹è€…ä½¿ç”¨é€šé“ä»é˜Ÿåˆ—ä¸­æ¥æ”¶æ¶ˆæ¯ã€‚é€šé“ä½œä¸ºæ¶ˆæ¯ä¼ è¾“çš„é€šé“ï¼Œè¿æ¥äº†ç”Ÿäº§è€…ã€äº¤æ¢æœºå’Œæ¶ˆè´¹è€…ã€‚</li></ul><p>é€šé“æ˜¯ä½œä¸ºæ¶ˆæ¯ä¼ é€’çš„è½½ä½“è´¯ç©¿æ•´ä¸ªè¿‡ç¨‹ã€‚</p><p>to be continedâ€¦.</p><h3 id="3ã€RabbitMQ-çš„å·¥ä½œæµç¨‹"><a href="#3ã€RabbitMQ-çš„å·¥ä½œæµç¨‹" class="headerlink" title="3ã€RabbitMQ çš„å·¥ä½œæµç¨‹"></a>3ã€RabbitMQ çš„å·¥ä½œæµç¨‹</h3><h4 id="å·¥ä½œæµç¨‹"><a href="#å·¥ä½œæµç¨‹" class="headerlink" title="å·¥ä½œæµç¨‹"></a>å·¥ä½œæµç¨‹</h4><ul><li>å»ºç«‹è¿æ¥</li><li>ç”Ÿäº§è€…<ul><li>å£°æ˜äº¤æ¢æœºç±»å‹ã€åç§°ã€æ˜¯å¦æŒä¹…åŒ–ç­‰</li><li>å‘é€æ¶ˆæ¯</li></ul></li><li>äº¤æ¢æœº<ul><li>äº¤æ¢æœºæ¥æ”¶æ¶ˆæ¯ï¼Œè¿›è¡Œæ¶ˆæ¯è·¯ç”±</li></ul></li><li>æ¶ˆè´¹è€…<ul><li>è®¢é˜…æ¶ˆæ¯ï¼ˆç›‘å¬é˜Ÿåˆ—ï¼‰</li><li>æ¥æ”¶æ¶ˆæ¯ï¼Œä¸šåŠ¡å¤„ç†</li></ul></li></ul><blockquote><ol><li>æ¶ˆæ¯ç”Ÿäº§è€…ä¸ RabbitMQ Broker å»ºç«‹è¿æ¥</li></ol></blockquote><ul><li><strong>å»ºç«‹è¿æ¥ï¼ˆConnectionï¼‰</strong>ï¼šæ¶ˆæ¯ç”Ÿäº§è€…ï¼ˆProducerï¼‰é¦–å…ˆä¸ RabbitMQ Broker å»ºç«‹è¿æ¥ã€‚è¿™ä¸ªè¿æ¥æ˜¯ä¸€ä¸ªæ¯”è¾ƒé‡çš„æ“ä½œï¼Œé€šå¸¸æ˜¯é•¿è¿æ¥ï¼Œå¹¶åœ¨å¤šä¸ªæ¶ˆæ¯å‘é€è¿‡ç¨‹ä¸­å¤ç”¨ã€‚</li><li><strong>å¼€å¯é€šé“ï¼ˆChannelï¼‰</strong>ï¼šä¸€æ—¦è¿æ¥å»ºç«‹ï¼Œç”Ÿäº§è€…å¼€å¯ä¸€ä¸ªæˆ–å¤šä¸ªé€šé“ï¼ˆChannelï¼‰ã€‚é€šé“æ˜¯è½»é‡çº§çš„ï¼Œç”¨äºæ‰§è¡Œå®é™…çš„æ¶ˆæ¯å‘é€å’Œæ¥æ”¶æ“ä½œã€‚åœ¨ RabbitMQ ä¸­ï¼Œæ‰€æœ‰çš„æ¶ˆæ¯ä¼ è¾“éƒ½æ˜¯é€šè¿‡é€šé“å®Œæˆçš„ã€‚</li></ul><blockquote><ol start="2"><li>ç”Ÿäº§è€…å£°æ˜äº¤æ¢æœº</li></ol></blockquote><ul><li><strong>å£°æ˜äº¤æ¢æœºï¼ˆExchangeï¼‰</strong>ï¼šç”Ÿäº§è€…éœ€è¦å£°æ˜ä¸€ä¸ªäº¤æ¢æœºï¼Œå¹¶æŒ‡å®šå®ƒçš„ç±»å‹ï¼ˆå¦‚ direct, topic, fanout, headersï¼‰å’Œåç§°ã€‚ç”Ÿäº§è€…è¿˜å¯ä»¥è®¾ç½®äº¤æ¢æœºçš„å…¶ä»–å±æ€§ï¼Œå¦‚æ˜¯å¦æŒä¹…åŒ–ã€‚æŒä¹…åŒ–çš„äº¤æ¢æœºå¯ä»¥åœ¨ Broker é‡å¯åä¾ç„¶å­˜åœ¨ã€‚</li></ul><blockquote><ol start="3"><li>ç”Ÿäº§è€…å‘é€æ¶ˆæ¯</li></ol></blockquote><ul><li><strong>å‘é€æ¶ˆæ¯</strong>ï¼šç”Ÿäº§è€…å‘æŒ‡å®šçš„äº¤æ¢æœºå‘é€æ¶ˆæ¯ã€‚å‘é€æ—¶ï¼Œç”Ÿäº§è€…è¿˜å¯ä»¥æŒ‡å®šæ¶ˆæ¯çš„å„ç§å±æ€§ï¼Œå¦‚æ˜¯å¦æŒä¹…åŒ–æ¶ˆæ¯ä½“ï¼Œè®¾ç½®æ¶ˆæ¯ä¼˜å…ˆçº§ç­‰ã€‚</li><li><strong>æŒ‡å®š Routing Key</strong>ï¼šå‘é€æ¶ˆæ¯æ—¶ï¼Œç”Ÿäº§è€…éœ€è¦æŒ‡å®šä¸€ä¸ª <code>routing key</code>ã€‚è¿™ä¸ª <code>routing key</code> ç”¨äºå†³å®šæ¶ˆæ¯å¦‚ä½•è·¯ç”±åˆ°é˜Ÿåˆ—ã€‚</li></ul><blockquote><ol start="4"><li>äº¤æ¢æœºå¤„ç†æ¶ˆæ¯</li></ol></blockquote><ul><li><strong>æ¥æ”¶æ¶ˆæ¯</strong>ï¼šäº¤æ¢æœºæ¥æ”¶åˆ°ç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯åï¼Œå¼€å§‹æ ¹æ®äº¤æ¢æœºç±»å‹å’Œ <code>routing key</code> è¿›è¡Œæ¶ˆæ¯è·¯ç”±ã€‚</li><li><strong>è·¯ç”±åˆ°é˜Ÿåˆ—</strong>ï¼šäº¤æ¢æœºæ ¹æ® <code>routing key</code> å’Œäº¤æ¢æœºç±»å‹å°†æ¶ˆæ¯è·¯ç”±åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªç»‘å®šçš„é˜Ÿåˆ—ä¸­ã€‚ä¾‹å¦‚ï¼Œåœ¨ direct ç±»å‹çš„äº¤æ¢æœºä¸­ï¼Œæ¶ˆæ¯ä¼šè·¯ç”±åˆ° <code>routing key</code> å®Œå…¨åŒ¹é…çš„é˜Ÿåˆ—ã€‚</li></ul><blockquote><ol start="5"><li>æ¶ˆè´¹è€…å¤„ç†æ¶ˆæ¯</li></ol></blockquote><ul><li><strong>ç›‘å¬é˜Ÿåˆ—</strong>ï¼šæ¶ˆè´¹è€…ï¼ˆConsumerï¼‰ç›‘å¬ä¸€ä¸ªæˆ–å¤šä¸ªé˜Ÿåˆ—ï¼Œç­‰å¾…æ¶ˆæ¯çš„åˆ°æ¥ã€‚</li><li><strong>æ¥æ”¶æ¶ˆæ¯</strong>ï¼šä¸€æ—¦æœ‰æ¶ˆæ¯åˆ°è¾¾é˜Ÿåˆ—ï¼Œæ¶ˆè´¹è€…å°±ä¼šæ¥æ”¶åˆ°è¿™ä¸ªæ¶ˆæ¯ã€‚</li><li><strong>ä¸šåŠ¡å¤„ç†</strong>ï¼šæ¶ˆè´¹è€…è·å–æ¶ˆæ¯åï¼Œå¼€å§‹è¿›è¡Œç›¸åº”çš„ä¸šåŠ¡å¤„ç†ã€‚</li></ul><p>åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼ŒRabbitMQ é€šè¿‡äº¤æ¢æœºå’Œé˜Ÿåˆ—çš„æœºåˆ¶æä¾›äº†å¼ºå¤§çš„æ¶ˆæ¯è·¯ç”±èƒ½åŠ›ã€‚</p><p>äº¤æ¢æœºå†³å®šäº†æ¶ˆæ¯å¦‚ä½•æ ¹æ® <code>routing key</code> è¢«è·¯ç”±åˆ°ä¸åŒçš„é˜Ÿåˆ—ï¼Œè€Œæ¶ˆè´¹è€…ä»é˜Ÿåˆ—ä¸­è·å–æ¶ˆæ¯è¿›è¡Œå¤„ç†ã€‚è¿™ç§æœºåˆ¶æ”¯æŒäº†é«˜åº¦çš„è§£è€¦å’Œçµæ´»çš„æ¶ˆæ¯å¤„ç†ç­–ç•¥ï¼Œé€‚ç”¨äºå„ç§å¤æ‚çš„æ¶ˆæ¯å¤„ç†åœºæ™¯ã€‚</p><h4 id="äº¤æ¢æœºç±»å‹"><a href="#äº¤æ¢æœºç±»å‹" class="headerlink" title="äº¤æ¢æœºç±»å‹"></a>äº¤æ¢æœºç±»å‹</h4><p>RabbitMQ ä¸­æœ€å¸¸ç”¨çš„å‡ ç§äº¤æ¢æœºç±»å‹åŠå…¶åŒºåˆ«ï¼š</p><blockquote><ol><li>Direct Exchangeï¼ˆç›´æ¥äº¤æ¢æœºï¼‰</li></ol></blockquote><ul><li><strong>è¡Œä¸º</strong>ï¼šæ¶ˆæ¯è¢«è·¯ç”±åˆ°é‚£äº› <code>binding key</code> ä¸æ¶ˆæ¯çš„ <code>routing key</code> å®Œå…¨åŒ¹é…çš„é˜Ÿåˆ—ã€‚</li><li><strong>ç”¨é€”</strong>ï¼šéå¸¸é€‚åˆå•æ’­ï¼ˆunicastï¼‰æˆ–å¤šæ’­ï¼ˆmulticastï¼‰è·¯ç”±åœºæ™¯ï¼Œå³ä¸€å¯¹ä¸€æˆ–ä¸€å¯¹å¤šå‘é€ã€‚</li></ul><blockquote><ol start="2"><li>Fanout Exchangeï¼ˆæ‰‡å‡ºäº¤æ¢æœºï¼‰</li></ol></blockquote><ul><li><strong>è¡Œä¸º</strong>ï¼šæ¶ˆæ¯è¢«è·¯ç”±åˆ°æ‰€æœ‰ä¸è¯¥äº¤æ¢æœºç»‘å®šçš„é˜Ÿåˆ—ï¼Œå¿½ç•¥ <code>routing key</code>ã€‚</li><li><strong>ç”¨é€”</strong>ï¼šéå¸¸é€‚åˆå¹¿æ’­æ¶ˆæ¯ï¼Œå¦‚æ—¥å¿—ç³»ç»Ÿï¼Œå…¶ä¸­æ¶ˆæ¯éœ€è¦è¢«å‘é€åˆ°å¤šä¸ªç›®çš„åœ°ã€‚</li></ul><blockquote><ol start="3"><li>Topic Exchangeï¼ˆä¸»é¢˜äº¤æ¢æœºï¼‰</li></ol></blockquote><ul><li><strong>è¡Œä¸º</strong>ï¼šå¯ä»¥æ ¹æ®æ¨¡å¼åŒ¹é… <code>routing keys</code> å’Œ <code>binding keys</code>ï¼ˆæ¨¡å¼ä¸­å¯ä»¥åŒ…å«é€šé…ç¬¦ï¼‰ã€‚<code>routing key</code> ä¸ºç‚¹åˆ†éš”çš„ä¸€ç³»åˆ—å•è¯ï¼Œ<code>binding key</code> ä¸­å¯ä»¥åŒ…å«ç‰¹æ®Šå­—ç¬¦ <code>*</code> å’Œ <code>#</code> æ¥è¿›è¡Œæ¨¡å¼åŒ¹é…ï¼Œå…¶ä¸­ <code>*</code> åŒ¹é…ä¸€ä¸ªå•è¯ï¼Œ<code>#</code> åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªå•è¯ã€‚</li><li><strong>ç”¨é€”</strong>ï¼šé€‚ç”¨äºåŒæ—¶éœ€è¦å•æ’­å’Œå¤šæ’­è·¯ç”±é€»è¾‘çš„å¤æ‚è·¯ç”±é…ç½®ã€‚</li></ul><blockquote><ol start="4"><li>Headers Exchangeï¼ˆå¤´éƒ¨äº¤æ¢æœºï¼‰</li></ol></blockquote><ul><li><strong>è¡Œä¸º</strong>ï¼šåŸºäºæ¶ˆæ¯å¤´éƒ¨ï¼ˆheadersï¼‰ä¸­çš„å±æ€§è¿›è¡ŒåŒ¹é…ã€‚ä¸ä¾èµ– <code>routing key</code>ã€‚åŒ¹é…è§„åˆ™å¯ä»¥æ˜¯â€œæ‰€æœ‰â€ï¼ˆ<code>x-match=all</code>ï¼Œå³æ‰€æœ‰å¤´éƒ¨å±æ€§å¿…é¡»åŒ¹é…ï¼‰æˆ–â€œä»»ä½•â€ï¼ˆ<code>x-match=any</code>ï¼Œå³ä»»æ„å¤´éƒ¨å±æ€§åŒ¹é…ï¼‰ã€‚</li><li><strong>ç”¨é€”</strong>ï¼šé€‚ç”¨äºéœ€è¦æ ¹æ®å¤šä¸ªå±æ€§è¿›è¡Œè·¯ç”±å†³ç­–çš„é«˜çº§è·¯ç”±ç­–ç•¥ã€‚</li></ul><blockquote><p>æ€»ç»“</p></blockquote><p>é€‰æ‹©å“ªç§äº¤æ¢æœºç±»å‹ä¸»è¦å–å†³äºä½ çš„å…·ä½“åº”ç”¨åœºæ™¯å’Œæ¶ˆæ¯è·¯ç”±éœ€æ±‚ã€‚</p><p>ç›´æ¥äº¤æ¢æœºé€‚åˆç®€å•çš„å•æ’­è·¯ç”±ï¼Œæ‰‡å‡ºäº¤æ¢æœºé€‚åˆå¹¿æ’­ï¼Œä¸»é¢˜äº¤æ¢æœºé€‚åˆå¤æ‚çš„è·¯ç”±åœºæ™¯ï¼Œè€Œå¤´éƒ¨äº¤æ¢æœºé€‚åˆåŸºäºå¤šå±æ€§çš„è·¯ç”±å†³ç­–ã€‚äº†è§£è¿™äº›äº¤æ¢æœºçš„ç‰¹ç‚¹å¯ä»¥å¸®åŠ©ä½ æ›´å¥½åœ°è®¾è®¡æ¶ˆæ¯è·¯ç”±ç­–ç•¥ï¼Œå¹¶å……åˆ†åˆ©ç”¨ RabbitMQ çš„å¼ºå¤§åŠŸèƒ½ã€‚</p><p>RabbitMQ çš„å¤„ç†æµç¨‹æ˜¯å›´ç»•ç€è¿æ¥ã€äº¤æ¢æœºã€æ¶ˆæ¯å‘é€å’Œæ¶ˆæ¯æ¥æ”¶è¿™å‡ ä¸ªæ ¸å¿ƒç¯èŠ‚å±•å¼€çš„ã€‚</p><h4 id="è·¯ç”±é”®ï¼ˆRouting-Keyï¼‰çš„ä½œç”¨"><a href="#è·¯ç”±é”®ï¼ˆRouting-Keyï¼‰çš„ä½œç”¨" class="headerlink" title="è·¯ç”±é”®ï¼ˆRouting Keyï¼‰çš„ä½œç”¨"></a>è·¯ç”±é”®ï¼ˆRouting Keyï¼‰çš„ä½œç”¨</h4><p>è·¯ç”±é”®æ˜¯æ¶ˆæ¯å‘å¸ƒåˆ° RabbitMQ æ—¶<strong>é™„å¸¦çš„ä¸€ä¸ªå­—ç¬¦ä¸²æ ‡è¯†</strong>ï¼Œå®ƒçš„ä½œç”¨æ˜¯å¸®åŠ©äº¤æ¢æœºå†³å®šå¦‚ä½•è·¯ç”±æ¶ˆæ¯ã€‚</p><p>è¿™é‡Œçš„â€œè·¯ç”±â€æŒ‡çš„æ˜¯å†³å®šæ¶ˆæ¯åº”è¯¥è¢«å‘é€åˆ°å“ªä¸€ä¸ªæˆ–å“ªäº›é˜Ÿåˆ—ã€‚è·¯ç”±é”®çš„å…·ä½“ä½œç”¨å–å†³äºäº¤æ¢æœºçš„ç±»å‹ï¼š</p><ol><li><strong>Direct Exchange</strong>ï¼šäº¤æ¢æœºä¼šå°†æ¶ˆæ¯è·¯ç”±åˆ°é‚£äº› <code>binding key</code> ä¸ <code>routing key</code> å®Œå…¨åŒ¹é…çš„é˜Ÿåˆ—ã€‚</li><li><strong>Topic Exchange</strong>ï¼šå¯ä»¥è¿›è¡Œæ¨¡å¼åŒ¹é…ï¼Œäº¤æ¢æœºä¼šæ ¹æ® <code>routing key</code> å’Œé˜Ÿåˆ—çš„ <code>binding key</code>ï¼ˆå¯ä»¥åŒ…å«é€šé…ç¬¦ï¼‰è¿›è¡ŒåŒ¹é…ã€‚</li><li><strong>Fanout Exchange</strong>ï¼šå¿½ç•¥è·¯ç”±é”®ï¼Œæ¶ˆæ¯ä¼šè¢«å‘é€åˆ°æ‰€æœ‰ç»‘å®šåˆ°è¯¥äº¤æ¢æœºçš„é˜Ÿåˆ—ã€‚</li><li><strong>Headers Exchange</strong>ï¼šä¸ä¾èµ–è·¯ç”±é”®ï¼Œè€Œæ˜¯æ ¹æ®å‘é€çš„æ¶ˆæ¯å¤´éƒ¨ä¸­çš„é”®å€¼å¯¹è¿›è¡ŒåŒ¹é…ã€‚</li></ol><h4 id="äº¤æ¢æœºä¸æ¶ˆè´¹è€…ä¹‹é—´çš„ååŒ"><a href="#äº¤æ¢æœºä¸æ¶ˆè´¹è€…ä¹‹é—´çš„ååŒ" class="headerlink" title="äº¤æ¢æœºä¸æ¶ˆè´¹è€…ä¹‹é—´çš„ååŒ"></a>äº¤æ¢æœºä¸æ¶ˆè´¹è€…ä¹‹é—´çš„ååŒ</h4><p>äº¤æ¢æœºä¸ç›´æ¥ä¸æ¶ˆè´¹è€…é€šä¿¡æ¥å†³å®šå‘å“ªä¸ªæ¶ˆè´¹è€…å‘é€æ¶ˆæ¯ã€‚</p><p>ç›¸åï¼Œå®ƒä¾èµ–äºé˜Ÿåˆ—å’Œé˜Ÿåˆ—ä¸æ¶ˆè´¹è€…ä¹‹é—´çš„å…³ç³»æ¥å®ç°æ¶ˆæ¯çš„åˆ†å‘ã€‚ä¸‹é¢æ˜¯å®ƒä»¬æ˜¯å¦‚ä½•ååŒå·¥ä½œçš„ï¼š</p><ol><li><p><strong>é˜Ÿåˆ—ç»‘å®šåˆ°äº¤æ¢æœº</strong>ï¼šé˜Ÿåˆ—é€šè¿‡ <code>binding key</code>ï¼ˆåœ¨ fanout å’Œ headers äº¤æ¢æœºä¸­ï¼Œè¿™ä¸ª <code>binding key</code> ä¸ä¸€å®šè¢«ä½¿ç”¨ï¼‰ç»‘å®šåˆ°äº¤æ¢æœºã€‚è¿™ä¸ªè¿‡ç¨‹å†³å®šäº†å“ªäº›æ¶ˆæ¯ä¼šè¢«è·¯ç”±åˆ°ç‰¹å®šçš„é˜Ÿåˆ—ã€‚</p></li><li><p><strong>æ¶ˆè´¹è€…ç›‘å¬é˜Ÿåˆ—</strong>ï¼šæ¶ˆè´¹è€…é€šè¿‡æ‰“å¼€ä¸€ä¸ªé€šé“å¹¶è®¢é˜…ï¼ˆæˆ–ç›‘å¬ï¼‰ä¸€ä¸ªæˆ–å¤šä¸ªé˜Ÿåˆ—æ¥æ¥æ”¶æ¶ˆæ¯ã€‚è¿™æ„å‘³ç€æ¶ˆè´¹è€…å‘Šè¯‰ RabbitMQï¼šâ€œæˆ‘å¯¹è¿™ä¸ªé˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯æ„Ÿå…´è¶£ï¼Œè¯·å°†å®ƒä»¬å‘é€ç»™æˆ‘ã€‚â€</p></li><li><p><strong>æ¶ˆæ¯åˆ†å‘</strong>ï¼šå½“æ¶ˆæ¯é€šè¿‡äº¤æ¢æœºè¢«è·¯ç”±åˆ°é˜Ÿåˆ—åï¼ŒRabbitMQ ä¼šå°†é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯å‘é€ç»™è®¢é˜…è¯¥é˜Ÿåˆ—çš„æ¶ˆè´¹è€…ã€‚è¿™ä¸ªåˆ†å‘è¿‡ç¨‹å¯èƒ½æ˜¯åŸºäºä¸åŒçš„ç­–ç•¥ï¼Œå¦‚è½®è¯¢æˆ–å…¬å¹³è°ƒåº¦ç­‰ã€‚</p></li></ol><h4 id="æ¶ˆè´¹è€…çš„ç›‘å¬"><a href="#æ¶ˆè´¹è€…çš„ç›‘å¬" class="headerlink" title="æ¶ˆè´¹è€…çš„ç›‘å¬"></a>æ¶ˆè´¹è€…çš„ç›‘å¬</h4><p>å½“æˆ‘ä»¬è¯´æ¶ˆè´¹è€…â€œç›‘å¬â€ä¸€ä¸ªé˜Ÿåˆ—æ—¶ï¼Œå®é™…ä¸Šæ˜¯æŒ‡æ¶ˆè´¹è€…å¼€å¯äº†ä¸€ä¸ªæŒç»­çš„ã€å¼‚æ­¥çš„è¿‡ç¨‹ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šç­‰å¾…ã€æ¥æ”¶å¹¶å¤„ç†æ¥è‡ªé˜Ÿåˆ—çš„æ¶ˆæ¯ã€‚</p><p>æ¶ˆè´¹è€…é€šè¿‡é€šé“å‘ RabbitMQ æ³¨å†Œå…¶å¯¹ç‰¹å®šé˜Ÿåˆ—çš„å…´è¶£ã€‚ä¸€æ—¦é˜Ÿåˆ—ä¸­æœ‰æ¶ˆæ¯ï¼ŒRabbitMQ å°±ä¼šå°†æ¶ˆæ¯æ¨é€ç»™æ¶ˆè´¹è€…ã€‚æ¶ˆè´¹è€…æ¥æ”¶åˆ°æ¶ˆæ¯åï¼Œä¼šæ ¹æ®è‡ªå·±çš„é€»è¾‘è¿›è¡Œå¤„ç†ã€‚</p><p>æ¶ˆè´¹è€…é€šè¿‡ç›‘å¬é˜Ÿåˆ—æ¥æ¥æ”¶æ¶ˆæ¯ï¼Œäº¤æ¢æœºæœ¬èº«å¹¶ä¸å†³å®šæ¶ˆæ¯å‘é€ç»™å“ªä¸ªæ¶ˆè´¹è€…ï¼Œè¿™æ˜¯ç”±é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ä¸æ¶ˆè´¹è€…ä¹‹é—´çš„å…³ç³»å†³å®šçš„ã€‚<strong>æ¶ˆè´¹è€…ç›‘å¬æ„å‘³ç€å®ƒä»¬å‡†å¤‡å¥½æ¥æ”¶å’Œå¤„ç†ä»é˜Ÿåˆ—ä¸­æ¥çš„æ¶ˆæ¯ã€‚</strong></p><h3 id="4ã€RabbitMQå¹¿æ’­å’Œç›´æ¥æ¨¡å¼ç¤ºä¾‹"><a href="#4ã€RabbitMQå¹¿æ’­å’Œç›´æ¥æ¨¡å¼ç¤ºä¾‹" class="headerlink" title="4ã€RabbitMQå¹¿æ’­å’Œç›´æ¥æ¨¡å¼ç¤ºä¾‹"></a>4ã€RabbitMQå¹¿æ’­å’Œç›´æ¥æ¨¡å¼ç¤ºä¾‹</h3><p>é¡¹ç›®å‚è€ƒï¼š <a href="https://gitee.com/yidao620/springboot-bucket">https://gitee.com/yidao620/springboot-bucket</a></p><p>è¿™ä¸ªé¡¹ç›®çš„æœ€åæ›´æ–°æ—¶é—´æ˜¯äº”å¹´å‰ï¼Œ è¿™é‡Œå»ºè®®å•ç‹¬æ‰“å¼€ä¸€ä¸‹ springboot-rabbitmq</p><p>æœ¬åœ°çš„ maven ç‰ˆæœ¬æ˜¯ 3.5.2 , springboot-rabbitmq ä¾èµ–ä¸­çš„ maven-compiler-plugin æ”¹ä¸ºäº† 3.6.1 åæ²¡æœ‰æŠ¥é”™</p><p>åœ¨ SpringBoot ä¸­ï¼Œä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—éœ€è¦å¼•å…¥ amqp çš„ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>  <br>   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>  <br>   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-amqp<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>  <br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>yml é…ç½®å†…å®¹</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">spring:</span>  <br>  <span class="hljs-attr">profiles:</span> <span class="hljs-string">dev</span>  <br>  <span class="hljs-attr">rabbitmq:</span>  <br>    <span class="hljs-attr">host:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>  <br>    <span class="hljs-attr">port:</span> <span class="hljs-number">5672</span>  <br>    <span class="hljs-attr">username:</span> <span class="hljs-string">guest</span>  <br>    <span class="hljs-attr">password:</span> <span class="hljs-string">guest</span><br></code></pre></td></tr></table></figure><h4 id="é…ç½®ç±»"><a href="#é…ç½®ç±»" class="headerlink" title="é…ç½®ç±»"></a>é…ç½®ç±»</h4><p>åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ªé…ç½®ç±» RabbitConfig</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><code class="hljs livescript">package com.xncoding.pos.config;<br><br><span class="hljs-keyword">import</span> org.slf4j.Logger;<br><span class="hljs-keyword">import</span> org.slf4j.LoggerFactory;<br><span class="hljs-keyword">import</span> org.springframework.amqp.core.*;<br><span class="hljs-keyword">import</span> org.springframework.amqp.rabbit.core.RabbitTemplate;<br><span class="hljs-keyword">import</span> org.springframework.amqp.support.converter.Jackson2JsonMessageConverter;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Qualifier;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><br><span class="hljs-keyword">import</span> javax.annotation.Resource;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * RabbitConfig</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * @version 1.0</span><br><span class="hljs-comment"> * @since 2018/3/1</span><br><span class="hljs-comment"> */</span><br>@Configuration<br>public <span class="hljs-keyword">class</span> <span class="hljs-title class_">RabbitConfig</span> &#123;<br>    @Resource<br>    private RabbitTemplate rabbitTemplate;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å®šåˆ¶åŒ– AMQP æ¨¡ç‰ˆã€‚</span><br><span class="hljs-comment">     * è®¾ç½®æ¶ˆæ¯è½¬æ¢å™¨ã€ç¼–ç ã€æ¶ˆæ¯ç¡®è®¤å’Œè¿”å›å›è°ƒã€‚</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * @return the amqp template</span><br><span class="hljs-comment">     */</span><br>    @Bean<br>    public AmqpTemplate amqpTemplate() &#123;<br>        Logger log = LoggerFactory.getLogger(RabbitTemplate.<span class="hljs-keyword">class</span>);<br><br>        <span class="hljs-regexp">// ä½¿ç”¨ Jackson ä½œä¸ºæ¶ˆæ¯è½¬æ¢å™¨ï¼Œè‡ªåŠ¨å°†æ¶ˆæ¯è½¬æ¢ä¸º JSON æ ¼å¼</span><br><span class="hljs-regexp">        rabbitTemplate.setMessageConverter(new Jackson2JsonMessageConverter());</span><br><span class="hljs-regexp"></span><br><span class="hljs-regexp">        //</span> è®¾ç½®å­—ç¬¦ç¼–ç ä¸º UTF-<span class="hljs-number">8</span><br>        rabbitTemplate.setEncoding(<span class="hljs-string">&quot;UTF-8&quot;</span>);<br><br>        <span class="hljs-regexp">// æ¶ˆæ¯å‘é€å¤±è´¥æ—¶è¿”å›åˆ°é˜Ÿåˆ—ï¼Œéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½® publisher-returns: true</span><br><span class="hljs-regexp">        rabbitTemplate.setMandatory(true);</span><br><span class="hljs-regexp"></span><br><span class="hljs-regexp">        //</span> å®šä¹‰æ¶ˆæ¯å‘é€å¤±è´¥çš„å›è°ƒ<br>        rabbitTemplate.setReturnCallback<span class="hljs-function"><span class="hljs-params">((message, replyCode, replyText, exchange, routingKey) -&gt; &#123;</span></span><br><span class="hljs-params"><span class="hljs-function">            <span class="hljs-built_in">String</span> correlationId = message.getMessageProperties().getCorrelationIdString();</span></span><br><span class="hljs-params"><span class="hljs-function">            log.debug(<span class="hljs-string">&quot;æ¶ˆæ¯ï¼š&#123;&#125; å‘é€å¤±è´¥, åº”ç­”ç ï¼š&#123;&#125; åŸå› ï¼š&#123;&#125; äº¤æ¢æœº: &#123;&#125;  è·¯ç”±é”®: &#123;&#125;&quot;</span>, correlationId, replyCode, replyText, exchange, routingKey);</span></span><br><span class="hljs-params"><span class="hljs-function">        &#125;)</span>;</span><br><span class="hljs-function"></span><br><span class="hljs-function">        // å®šä¹‰æ¶ˆæ¯å‘é€åˆ°äº¤æ¢æœºç¡®è®¤å›è°ƒï¼Œéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½® <span class="hljs-title">publisher-confirms</span>: <span class="hljs-title">true</span></span><br><span class="hljs-function">        <span class="hljs-title">rabbitTemplate</span>.<span class="hljs-title">setConfirmCallback</span><span class="hljs-params">((correlationData, ack, cause) -&gt; &#123;</span></span><br><span class="hljs-params"><span class="hljs-function">            <span class="hljs-keyword">if</span> (ack) &#123;</span></span><br><span class="hljs-params"><span class="hljs-function">                log.debug(<span class="hljs-string">&quot;æ¶ˆæ¯å‘é€åˆ°exchangeæˆåŠŸ,id: &#123;&#125;&quot;</span>, correlationData.getId());</span></span><br><span class="hljs-params"><span class="hljs-function">            &#125; <span class="hljs-keyword">else</span> &#123;</span></span><br><span class="hljs-params"><span class="hljs-function">                log.debug(<span class="hljs-string">&quot;æ¶ˆæ¯å‘é€åˆ°exchangeå¤±è´¥,åŸå› : &#123;&#125;&quot;</span>, cause);</span></span><br><span class="hljs-params"><span class="hljs-function">            &#125;</span></span><br><span class="hljs-params"><span class="hljs-function">        &#125;)</span>;</span><br><span class="hljs-function"></span><br><span class="hljs-function">        <span class="hljs-title">return</span> <span class="hljs-title">rabbitTemplate</span>;</span><br><span class="hljs-function">    &#125;</span><br><span class="hljs-function"></span><br><span class="hljs-function">    // <span class="hljs-title">Direct</span> <span class="hljs-title">Exchange</span> é…ç½®éƒ¨åˆ†</span><br><span class="hljs-function"></span><br><span class="hljs-function">    /**</span><br><span class="hljs-function">     * å£°æ˜ <span class="hljs-title">Direct</span> äº¤æ¢æœºã€‚</span><br><span class="hljs-function">     *</span><br><span class="hljs-function">     * @<span class="hljs-title">return</span> <span class="hljs-title">the</span> <span class="hljs-title">exchange</span></span><br><span class="hljs-function">     */</span><br><span class="hljs-function">    @<span class="hljs-title">Bean</span><span class="hljs-params">(<span class="hljs-string">&quot;directExchange&quot;</span>)</span></span><br><span class="hljs-function">    <span class="hljs-title">public</span> <span class="hljs-title">Exchange</span> <span class="hljs-title">directExchange</span><span class="hljs-params">()</span> &#123;</span><br><span class="hljs-function">        // åˆ›å»ºå¹¶è¿”å›ä¸€ä¸ªæŒä¹…åŒ–çš„ <span class="hljs-title">Direct</span> äº¤æ¢æœº</span><br><span class="hljs-function">        <span class="hljs-title">return</span> <span class="hljs-title">ExchangeBuilder</span>.<span class="hljs-title">directExchange</span><span class="hljs-params">(<span class="hljs-string">&quot;DIRECT_EXCHANGE&quot;</span>)</span>.<span class="hljs-title">durable</span><span class="hljs-params">(<span class="hljs-literal">true</span>)</span>.<span class="hljs-title">build</span><span class="hljs-params">()</span>;</span><br><span class="hljs-function">    &#125;</span><br><span class="hljs-function"></span><br><span class="hljs-function">    /**</span><br><span class="hljs-function">     * å£°æ˜é˜Ÿåˆ—ã€‚</span><br><span class="hljs-function">     *</span><br><span class="hljs-function">     * @<span class="hljs-title">return</span> <span class="hljs-title">the</span> <span class="hljs-title">queue</span></span><br><span class="hljs-function">     */</span><br><span class="hljs-function">    @<span class="hljs-title">Bean</span><span class="hljs-params">(<span class="hljs-string">&quot;directQueue&quot;</span>)</span></span><br><span class="hljs-function">    <span class="hljs-title">public</span> <span class="hljs-title">Queue</span> <span class="hljs-title">directQueue</span><span class="hljs-params">()</span> &#123;</span><br><span class="hljs-function">        // åˆ›å»ºå¹¶è¿”å›ä¸€ä¸ªæŒä¹…åŒ–çš„é˜Ÿåˆ—</span><br><span class="hljs-function">        <span class="hljs-title">return</span> <span class="hljs-title">QueueBuilder</span>.<span class="hljs-title">durable</span><span class="hljs-params">(<span class="hljs-string">&quot;DIRECT_QUEUE&quot;</span>)</span>.<span class="hljs-title">build</span><span class="hljs-params">()</span>;</span><br><span class="hljs-function">    &#125;</span><br><span class="hljs-function"></span><br><span class="hljs-function">    /**</span><br><span class="hljs-function">     * å°†é˜Ÿåˆ—ç»‘å®šåˆ°äº¤æ¢æœºã€‚</span><br><span class="hljs-function">     *</span><br><span class="hljs-function">     * @<span class="hljs-title">param</span> <span class="hljs-title">queue</span>    <span class="hljs-title">the</span> <span class="hljs-title">queue</span></span><br><span class="hljs-function">     * @<span class="hljs-title">param</span> <span class="hljs-title">exchange</span> <span class="hljs-title">the</span> <span class="hljs-title">exchange</span></span><br><span class="hljs-function">     * @<span class="hljs-title">return</span> <span class="hljs-title">the</span> <span class="hljs-title">binding</span></span><br><span class="hljs-function">     */</span><br><span class="hljs-function">    @<span class="hljs-title">Bean</span></span><br><span class="hljs-function">    <span class="hljs-title">public</span> <span class="hljs-title">Binding</span> <span class="hljs-title">directBinding</span><span class="hljs-params">(@Qualifier(<span class="hljs-string">&quot;directQueue&quot;</span>) Queue queue,</span></span><br><span class="hljs-params"><span class="hljs-function">                                 @Qualifier(<span class="hljs-string">&quot;directExchange&quot;</span>) Exchange exchange)</span> &#123;</span><br><span class="hljs-function">        // å°†é˜Ÿåˆ—ç»‘å®šåˆ°äº¤æ¢æœºï¼Œä½¿ç”¨è·¯ç”±é”® &quot;<span class="hljs-title">DIRECT_ROUTING_KEY</span>&quot;</span><br><span class="hljs-function">        <span class="hljs-title">return</span> <span class="hljs-title">BindingBuilder</span>.<span class="hljs-title">bind</span><span class="hljs-params">(queue)</span>.<span class="hljs-title">to</span><span class="hljs-params">(exchange)</span>.<span class="hljs-title">with</span><span class="hljs-params">(<span class="hljs-string">&quot;DIRECT_ROUTING_KEY&quot;</span>)</span>.<span class="hljs-title">noargs</span><span class="hljs-params">()</span>;</span><br><span class="hljs-function">    &#125;</span><br><span class="hljs-function"></span><br><span class="hljs-function">    // <span class="hljs-title">Fanout</span> <span class="hljs-title">Exchange</span> é…ç½®éƒ¨åˆ†</span><br><span class="hljs-function"></span><br><span class="hljs-function">    /**</span><br><span class="hljs-function">     * å£°æ˜ <span class="hljs-title">Fanout</span> äº¤æ¢æœºã€‚</span><br><span class="hljs-function">     *</span><br><span class="hljs-function">     * @<span class="hljs-title">return</span> <span class="hljs-title">the</span> <span class="hljs-title">exchange</span></span><br><span class="hljs-function">     */</span><br><span class="hljs-function">    @<span class="hljs-title">Bean</span><span class="hljs-params">(<span class="hljs-string">&quot;fanoutExchange&quot;</span>)</span></span><br><span class="hljs-function">    <span class="hljs-title">public</span> <span class="hljs-title">FanoutExchange</span> <span class="hljs-title">fanoutExchange</span><span class="hljs-params">()</span> &#123;</span><br><span class="hljs-function">        // åˆ›å»ºå¹¶è¿”å›ä¸€ä¸ªæŒä¹…åŒ–çš„ <span class="hljs-title">Fanout</span> äº¤æ¢æœº</span><br><span class="hljs-function">        <span class="hljs-title">return</span> <span class="hljs-params">(FanoutExchange)</span> <span class="hljs-title">ExchangeBuilder</span>.<span class="hljs-title">fanoutExchange</span><span class="hljs-params">(<span class="hljs-string">&quot;FANOUT_EXCHANGE&quot;</span>)</span>.<span class="hljs-title">durable</span><span class="hljs-params">(<span class="hljs-literal">true</span>)</span>.<span class="hljs-title">build</span><span class="hljs-params">()</span>;</span><br><span class="hljs-function">    &#125;</span><br><span class="hljs-function"></span><br><span class="hljs-function">    /**</span><br><span class="hljs-function">     * å£°æ˜é˜Ÿåˆ— <span class="hljs-title">A</span>ã€‚</span><br><span class="hljs-function">     *</span><br><span class="hljs-function">     * @<span class="hljs-title">return</span> <span class="hljs-title">the</span> <span class="hljs-title">queue</span></span><br><span class="hljs-function">     */</span><br><span class="hljs-function">    @<span class="hljs-title">Bean</span><span class="hljs-params">(<span class="hljs-string">&quot;fanoutQueueA&quot;</span>)</span></span><br><span class="hljs-function">    <span class="hljs-title">public</span> <span class="hljs-title">Queue</span> <span class="hljs-title">fanoutQueueA</span><span class="hljs-params">()</span> &#123;</span><br><span class="hljs-function">        // åˆ›å»ºå¹¶è¿”å›ä¸€ä¸ªæŒä¹…åŒ–çš„é˜Ÿåˆ— <span class="hljs-title">A</span></span><br><span class="hljs-function">        <span class="hljs-title">return</span> <span class="hljs-title">QueueBuilder</span>.<span class="hljs-title">durable</span><span class="hljs-params">(<span class="hljs-string">&quot;FANOUT_QUEUE_A&quot;</span>)</span>.<span class="hljs-title">build</span><span class="hljs-params">()</span>;</span><br><span class="hljs-function">    &#125;</span><br><span class="hljs-function"></span><br><span class="hljs-function">    /**</span><br><span class="hljs-function">     * å£°æ˜é˜Ÿåˆ— <span class="hljs-title">B</span>ã€‚</span><br><span class="hljs-function">     *</span><br><span class="hljs-function">     * @<span class="hljs-title">return</span> <span class="hljs-title">the</span> <span class="hljs-title">queue</span></span><br><span class="hljs-function">     */</span><br><span class="hljs-function">    @<span class="hljs-title">Bean</span><span class="hljs-params">(<span class="hljs-string">&quot;fanoutQueueB&quot;</span>)</span></span><br><span class="hljs-function">    <span class="hljs-title">public</span> <span class="hljs-title">Queue</span> <span class="hljs-title">fanoutQueueB</span><span class="hljs-params">()</span> &#123;</span><br><span class="hljs-function">        // åˆ›å»ºå¹¶è¿”å›ä¸€ä¸ªæŒä¹…åŒ–çš„é˜Ÿåˆ— <span class="hljs-title">B</span></span><br><span class="hljs-function">        <span class="hljs-title">return</span> <span class="hljs-title">QueueBuilder</span>.<span class="hljs-title">durable</span><span class="hljs-params">(<span class="hljs-string">&quot;FANOUT_QUEUE_B&quot;</span>)</span>.<span class="hljs-title">build</span><span class="hljs-params">()</span>;</span><br><span class="hljs-function">    &#125;</span><br><span class="hljs-function"></span><br><span class="hljs-function">    /**</span><br><span class="hljs-function">     * å°†é˜Ÿåˆ— <span class="hljs-title">A</span> ç»‘å®šåˆ° <span class="hljs-title">Fanout</span> äº¤æ¢æœºã€‚</span><br><span class="hljs-function">     *</span><br><span class="hljs-function">     * @<span class="hljs-title">param</span> <span class="hljs-title">queue</span>          <span class="hljs-title">the</span> <span class="hljs-title">queue</span></span><br><span class="hljs-function">     * @<span class="hljs-title">param</span> <span class="hljs-title">fanoutExchange</span> <span class="hljs-title">the</span> <span class="hljs-title">fanout</span> <span class="hljs-title">exchange</span></span><br><span class="hljs-function">     * @<span class="hljs-title">return</span> <span class="hljs-title">the</span> <span class="hljs-title">binding</span></span><br><span class="hljs-function">     */</span><br><span class="hljs-function">    @<span class="hljs-title">Bean</span></span><br><span class="hljs-function">    <span class="hljs-title">public</span> <span class="hljs-title">Binding</span> <span class="hljs-title">bindingA</span><span class="hljs-params">(@Qualifier(<span class="hljs-string">&quot;fanoutQueueA&quot;</span>) Queue queue,</span></span><br><span class="hljs-params"><span class="hljs-function">                            @Qualifier(<span class="hljs-string">&quot;fanoutExchange&quot;</span>) FanoutExchange fanoutExchange)</span> &#123;</span><br><span class="hljs-function">        // å°†é˜Ÿåˆ— <span class="hljs-title">A</span> ç»‘å®šåˆ° <span class="hljs-title">Fanout</span> äº¤æ¢æœº</span><br><span class="hljs-function">        <span class="hljs-title">return</span> <span class="hljs-title">BindingBuilder</span>.<span class="hljs-title">bind</span><span class="hljs-params">(queue)</span>.<span class="hljs-title">to</span><span class="hljs-params">(fanoutExchange)</span>;</span><br><span class="hljs-function">    &#125;</span><br><span class="hljs-function"></span><br><span class="hljs-function">    /**</span><br><span class="hljs-function">     * å°†é˜Ÿåˆ— <span class="hljs-title">B</span> ç»‘å®šåˆ° <span class="hljs-title">Fanout</span> äº¤æ¢æœºã€‚</span><br><span class="hljs-function">     *</span><br><span class="hljs-function">     * @<span class="hljs-title">param</span> <span class="hljs-title">queue</span>          <span class="hljs-title">the</span> <span class="hljs-title">queue</span></span><br><span class="hljs-function">     * @<span class="hljs-title">param</span> <span class="hljs-title">fanoutExchange</span> <span class="hljs-title">the</span> <span class="hljs-title">fanout</span> <span class="hljs-title">exchange</span></span><br><span class="hljs-function">     * @<span class="hljs-title">return</span> <span class="hljs-title">the</span> <span class="hljs-title">binding</span></span><br><span class="hljs-function">     */</span><br><span class="hljs-function">    @<span class="hljs-title">Bean</span></span><br><span class="hljs-function">    <span class="hljs-title">public</span> <span class="hljs-title">Binding</span> <span class="hljs-title">bindingB</span><span class="hljs-params">(@Qualifier(<span class="hljs-string">&quot;fanoutQueueB&quot;</span>) Queue queue,</span></span><br><span class="hljs-params"><span class="hljs-function">                            @Qualifier(<span class="hljs-string">&quot;fanoutExchange&quot;</span>) FanoutExchange fanoutExchange)</span> &#123;</span><br><span class="hljs-function">        // å°†é˜Ÿåˆ— <span class="hljs-title">B</span> ç»‘å®šåˆ° <span class="hljs-title">Fanout</span> äº¤æ¢æœº</span><br><span class="hljs-function">        <span class="hljs-title">return</span> <span class="hljs-title">BindingBuilder</span>.<span class="hljs-title">bind</span><span class="hljs-params">(queue)</span>.<span class="hljs-title">to</span><span class="hljs-params">(fanoutExchange)</span>;</span><br><span class="hljs-function">    &#125;</span><br><span class="hljs-function">&#125;</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ª <code>RabbitConfig</code> é…ç½®ç±»é€šè¿‡ <code>@Bean</code> æ³¨è§£å£°æ˜äº†å¤šä¸ª Spring Beanï¼Œç”¨äºè®¾ç½® RabbitMQ çš„ä¸åŒç»„ä»¶ã€‚</p><p>å®ƒæ¶µç›–äº†æ¶ˆæ¯æ¨¡æ¿çš„å®šåˆ¶ã€äº¤æ¢æœºå’Œé˜Ÿåˆ—çš„å£°æ˜ï¼Œä»¥åŠé˜Ÿåˆ—ä¸äº¤æ¢æœºçš„ç»‘å®šã€‚</p><p>è¿™æ ·çš„é…ç½®æä¾›äº†çµæ´»çš„æ–¹å¼æ¥å®šä¹‰æ¶ˆæ¯ä¼ é€’çš„è¡Œä¸ºï¼ŒåŒ…æ‹¬æ¶ˆæ¯æ ¼å¼ã€è·¯ç”±ç­–ç•¥å’Œé˜Ÿåˆ—ç®¡ç†ï¼Œé€‚ç”¨äºä¸åŒçš„æ¶ˆæ¯å¤„ç†éœ€æ±‚ã€‚</p><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¯ä»¥åœ¨ Spring åº”ç”¨ä¸­è½»æ¾åœ°ä½¿ç”¨ RabbitMQ è¿›è¡Œé«˜æ•ˆçš„æ¶ˆæ¯é€šä¿¡ã€‚</p><hr><p>é€šè¿‡å¹¿æ’­æ–¹å¼å‘é€æ¶ˆæ¯</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * å‘é€å¹¿æ’­æ¨¡å¼çš„æ¶ˆæ¯ã€‚</span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> p è¦å‘é€çš„æ¶ˆæ¯å†…å®¹</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">broadcast</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> p</span>) &#123;<br>    <span class="hljs-comment">// åˆ›å»º CorrelationData å¯¹è±¡ï¼Œå¸¦æœ‰ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ã€‚</span><br>    <span class="hljs-comment">// è¿™ä¸ªæ ‡è¯†ç¬¦ç”¨äºæ¶ˆæ¯ç¡®è®¤è¿‡ç¨‹ä¸­è¯†åˆ«æ¶ˆæ¯ã€‚</span><br>    <span class="hljs-title class_">CorrelationData</span> correlationData = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CorrelationData</span>(<span class="hljs-variable constant_">UUID</span>.<span class="hljs-title function_">randomUUID</span>().<span class="hljs-title function_">toString</span>());<br><br>    <span class="hljs-comment">// ä½¿ç”¨ RabbitTemplate å°†æ¶ˆæ¯å‘é€åˆ°æŒ‡å®šçš„äº¤æ¢æœºã€‚</span><br>    <span class="hljs-comment">// å‚æ•°1: äº¤æ¢æœºåç§° - è¿™é‡Œæ˜¯ &quot;FANOUT_EXCHANGE&quot;ã€‚</span><br>    <span class="hljs-comment">// å‚æ•°2: è·¯ç”±é”® - åœ¨ Fanout äº¤æ¢æœºä¸­ï¼Œè·¯ç”±é”®ä¼šè¢«å¿½ç•¥ï¼Œæ‰€ä»¥è¿™é‡Œä¼ é€’ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ã€‚</span><br>    <span class="hljs-comment">// å‚æ•°3: æ¶ˆæ¯å†…å®¹ - è¿™é‡Œæ˜¯ä¼ å…¥çš„å‚æ•° pã€‚</span><br>    <span class="hljs-comment">// å‚æ•°4: CorrelationData - åŒ…å«æ¶ˆæ¯çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œç”¨äºæ¶ˆæ¯è·Ÿè¸ªå’Œç¡®è®¤ã€‚</span><br>    rabbitTemplate.<span class="hljs-title function_">convertAndSend</span>(<span class="hljs-string">&quot;FANOUT_EXCHANGE&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, p, correlationData);<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨å‰é¢çš„é…ç½®ç±»ä¸­ï¼Œæ˜¯å£°æ˜äº† Fanout äº¤æ¢æœºï¼Œ å¹¶ä¸”ç»‘å®šä¸¤ä¸ªé˜Ÿåˆ—åœ¨è¿™ä¸ªäº¤æ¢æœºä¸Šã€‚</p><h4 id="ç”Ÿäº§è€…ç±»"><a href="#ç”Ÿäº§è€…ç±»" class="headerlink" title="ç”Ÿäº§è€…ç±»"></a>ç”Ÿäº§è€…ç±»</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xncoding.pos.service;<br><br><span class="hljs-keyword">import</span> org.slf4j.Logger;<br><span class="hljs-keyword">import</span> org.slf4j.LoggerFactory;<br><span class="hljs-keyword">import</span> org.springframework.amqp.rabbit.core.RabbitTemplate;<br><span class="hljs-keyword">import</span> org.springframework.amqp.rabbit.support.CorrelationData;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Service;<br><br><span class="hljs-keyword">import</span> javax.annotation.Resource;<br><span class="hljs-keyword">import</span> java.util.UUID;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æ¶ˆæ¯å‘é€æœåŠ¡</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SenderService</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">logger</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(<span class="hljs-built_in">this</span>.getClass());<br><br>    <span class="hljs-meta">@Resource</span><br>    <span class="hljs-keyword">private</span> RabbitTemplate rabbitTemplate;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æµ‹è¯•å¹¿æ’­æ¨¡å¼.</span><br><span class="hljs-comment">     * åœ¨å¹¿æ’­æ¨¡å¼ä¸‹ï¼Œæ¶ˆæ¯ä¼šè¢«å‘é€åˆ°æ‰€æœ‰ç»‘å®šåˆ°äº¤æ¢æœºçš„é˜Ÿåˆ—ã€‚</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> p è¦å‘é€çš„æ¶ˆæ¯å†…å®¹</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">broadcast</span><span class="hljs-params">(String p)</span> &#123;<br>        <span class="hljs-comment">// ä¸ºæ¯ä¸ªæ¶ˆæ¯åˆ›å»ºä¸€ä¸ªå¸¦å”¯ä¸€æ ‡è¯†ç¬¦çš„ CorrelationData å¯¹è±¡</span><br>        <span class="hljs-type">CorrelationData</span> <span class="hljs-variable">correlationData</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CorrelationData</span>(UUID.randomUUID().toString());<br>        <span class="hljs-comment">// å°†æ¶ˆæ¯å‘é€åˆ° FANOUT_EXCHANGE äº¤æ¢æœºï¼Œè·¯ç”±é”®ä¸ºç©ºå­—ç¬¦ä¸²</span><br>        rabbitTemplate.convertAndSend(<span class="hljs-string">&quot;FANOUT_EXCHANGE&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, p, correlationData);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æµ‹è¯•Directæ¨¡å¼.</span><br><span class="hljs-comment">     * åœ¨Directæ¨¡å¼ä¸‹ï¼Œæ¶ˆæ¯ä¼šè¢«è·¯ç”±åˆ°å…·æœ‰æŒ‡å®šè·¯ç”±é”®çš„é˜Ÿåˆ—ã€‚</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> p è¦å‘é€çš„æ¶ˆæ¯å†…å®¹</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">direct</span><span class="hljs-params">(String p)</span> &#123;<br>        <span class="hljs-comment">// ä¸ºæ¯ä¸ªæ¶ˆæ¯åˆ›å»ºä¸€ä¸ªå¸¦å”¯ä¸€æ ‡è¯†ç¬¦çš„ CorrelationData å¯¹è±¡</span><br>        <span class="hljs-type">CorrelationData</span> <span class="hljs-variable">correlationData</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CorrelationData</span>(UUID.randomUUID().toString());<br>        <span class="hljs-comment">// å°†æ¶ˆæ¯å‘é€åˆ° DIRECT_EXCHANGE äº¤æ¢æœºï¼Œå¹¶æŒ‡å®šè·¯ç”±é”®</span><br>        rabbitTemplate.convertAndSend(<span class="hljs-string">&quot;DIRECT_EXCHANGE&quot;</span>, <span class="hljs-string">&quot;DIRECT_ROUTING_KEY&quot;</span>, p, correlationData);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="æ¶ˆè´¹è€…ç±»"><a href="#æ¶ˆè´¹è€…ç±»" class="headerlink" title="æ¶ˆè´¹è€…ç±»"></a>æ¶ˆè´¹è€…ç±»</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xncoding.pos.mq;<br><br><span class="hljs-keyword">import</span> com.rabbitmq.client.Channel;<br><span class="hljs-keyword">import</span> org.slf4j.Logger;<br><span class="hljs-keyword">import</span> org.slf4j.LoggerFactory;<br><span class="hljs-keyword">import</span> org.springframework.amqp.core.Message;<br><span class="hljs-keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Component;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æ¶ˆæ¯ç›‘å¬å™¨</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Receiver</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">log</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(Receiver.class);<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * FANOUTå¹¿æ’­é˜Ÿåˆ—ç›‘å¬ä¸€.</span><br><span class="hljs-comment">     * åœ¨ FANOUT_QUEUE_A é˜Ÿåˆ—ä¸Šç›‘å¬æ¶ˆæ¯ã€‚</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> message æ¥æ”¶åˆ°çš„æ¶ˆæ¯</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> channel é€šä¿¡é€šé“</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> IOException åœ¨æ¶ˆæ¯ç¡®è®¤è¿‡ç¨‹ä¸­å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@RabbitListener(queues = &#123;&quot;FANOUT_QUEUE_A&quot;&#125;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">on</span><span class="hljs-params">(Message message, Channel channel)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-comment">// ç¡®è®¤æ¶ˆæ¯å·²è¢«æ­£ç¡®æ¥æ”¶</span><br>        channel.basicAck(message.getMessageProperties().getDeliveryTag(), <span class="hljs-literal">true</span>);<br>        <span class="hljs-comment">// è®°å½•æ¥æ”¶åˆ°çš„æ¶ˆæ¯</span><br>        log.debug(<span class="hljs-string">&quot;FANOUT_QUEUE_A &quot;</span> + <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(message.getBody()));<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * FANOUTå¹¿æ’­é˜Ÿåˆ—ç›‘å¬äºŒ.</span><br><span class="hljs-comment">     * åœ¨ FANOUT_QUEUE_B é˜Ÿåˆ—ä¸Šç›‘å¬æ¶ˆæ¯ã€‚</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> message æ¥æ”¶åˆ°çš„æ¶ˆæ¯</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> channel é€šä¿¡é€šé“</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> IOException åœ¨æ¶ˆæ¯ç¡®è®¤è¿‡ç¨‹ä¸­å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@RabbitListener(queues = &#123;&quot;FANOUT_QUEUE_B&quot;&#125;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">t</span><span class="hljs-params">(Message message, Channel channel)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-comment">// ç¡®è®¤æ¶ˆæ¯å·²è¢«æ­£ç¡®æ¥æ”¶</span><br>        channel.basicAck(message.getMessageProperties().getDeliveryTag(), <span class="hljs-literal">true</span>);<br>        <span class="hljs-comment">// è®°å½•æ¥æ”¶åˆ°çš„æ¶ˆæ¯</span><br>        log.debug(<span class="hljs-string">&quot;FANOUT_QUEUE_B &quot;</span> + <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(message.getBody()));<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * DIRECTæ¨¡å¼.</span><br><span class="hljs-comment">     * åœ¨ DIRECT_QUEUE é˜Ÿåˆ—ä¸Šç›‘å¬æ¶ˆæ¯ã€‚</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> message æ¥æ”¶åˆ°çš„æ¶ˆæ¯</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> channel é€šä¿¡é€šé“</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> IOException åœ¨æ¶ˆæ¯ç¡®è®¤è¿‡ç¨‹ä¸­å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@RabbitListener(queues = &#123;&quot;DIRECT_QUEUE&quot;&#125;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">message</span><span class="hljs-params">(Message message, Channel channel)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-comment">// ç¡®è®¤æ¶ˆæ¯å·²è¢«æ­£ç¡®æ¥æ”¶</span><br>        channel.basicAck(message.getMessageProperties().getDeliveryTag(), <span class="hljs-literal">true</span>);<br>        <span class="hljs-comment">// è®°å½•æ¥æ”¶åˆ°çš„æ¶ˆæ¯</span><br>        log.debug(<span class="hljs-string">&quot;DIRECT &quot;</span> + <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(message.getBody()));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>åœ¨ç”Ÿäº§è€…ç±»ï¼ˆ<code>SenderService</code>ï¼‰ä¸­ï¼Œä¸¤ä¸ªæ–¹æ³•åˆ†åˆ«æ¼”ç¤ºäº†å¦‚ä½•åœ¨å¹¿æ’­ï¼ˆFanoutï¼‰å’Œç›´æ¥ï¼ˆDirectï¼‰æ¨¡å¼ä¸‹å‘é€æ¶ˆæ¯ã€‚</li><li>åœ¨æ¶ˆè´¹è€…ç±»ï¼ˆ<code>Receiver</code>ï¼‰ä¸­ï¼Œæ¯ä¸ªæ–¹æ³•éƒ½ä½¿ç”¨äº† <code>@RabbitListener</code> æ³¨è§£æ¥ç›‘å¬ç‰¹å®šçš„é˜Ÿåˆ—ï¼Œå¹¶åœ¨æ¥æ”¶åˆ°æ¶ˆæ¯åæ‰§è¡Œç›¸åº”çš„å¤„ç†é€»è¾‘ã€‚</li></ul><p>è¿™é‡Œç”±äºä½ é…ç½®äº†æ¥æ”¶çš„ç›‘å¬ï¼Œå› æ­¤å½“ä½ å‘é€çš„æ—¶å€™ä½ å°±æ”¶åˆ°äº†è¿™æ¡æ¶ˆæ¯ï¼Œå¹¶ä¸”é€šè¿‡æ—¥å¿—çš„æ–¹å¼æ‰“å°äº†å‡ºæ¥ï¼Œå¦‚æœéœ€è¦æ¯”è¾ƒæ˜æ˜¾ä¸€ç‚¹çš„è§‚å¯Ÿç°è±¡ï¼Œå¯ä»¥åŠ ä¸€ä¸ªç­‰å¾…æ—¶é—´ç¡®ä¿è¢«æ¶ˆè´¹ã€‚</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-comment">// ç­‰å¾…ä¸€æ®µæ—¶é—´ä»¥ç¡®ä¿æ¶ˆæ¯è¢«æ¶ˆè´¹ </span><br>Thread.<span class="hljs-built_in">sleep</span>(<span class="hljs-number">1000</span>);<br></code></pre></td></tr></table></figure><h4 id="ä¸»é¢˜äº¤æ¢æœºï¼ˆTopic-Exchangeï¼‰çš„ä½¿ç”¨ç¤ºä¾‹"><a href="#ä¸»é¢˜äº¤æ¢æœºï¼ˆTopic-Exchangeï¼‰çš„ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="ä¸»é¢˜äº¤æ¢æœºï¼ˆTopic Exchangeï¼‰çš„ä½¿ç”¨ç¤ºä¾‹"></a>ä¸»é¢˜äº¤æ¢æœºï¼ˆTopic Exchangeï¼‰çš„ä½¿ç”¨ç¤ºä¾‹</h4><p>Topic Exchange ç›´æ¥ç¿»è¯‘çš„è¯å«åšä¸»é¢˜äº¤æ¢æœºï¼Œå¦‚æœä»ç”¨æ³•ä¸Šé¢ç¿»è¯‘å¯èƒ½å«é€šé…ç¬¦äº¤æ¢æœºä¼šæ›´åŠ è´´åˆ‡ã€‚</p><p>è¿™ç§äº¤æ¢æœºæ˜¯ä½¿ç”¨é€šé…ç¬¦å»åŒ¹é…ï¼Œè·¯ç”±åˆ°å¯¹åº”çš„é˜Ÿåˆ—ã€‚é€šé…ç¬¦æœ‰ä¸¤ç§ï¼šâ€* â€œ ã€ â€œ#â€ã€‚éœ€è¦æ³¨æ„çš„æ˜¯é€šé…ç¬¦å‰é¢å¿…é¡»è¦åŠ ä¸Šâ€.â€ç¬¦å·ã€‚</p><p><code>*</code>Â ç¬¦å·ï¼šæœ‰ä¸”åªåŒ¹é…ä¸€ä¸ªè¯ã€‚æ¯”å¦‚Â <code>a.*</code>å¯ä»¥åŒ¹é…åˆ°â€a.bâ€ã€â€a.câ€ï¼Œä½†æ˜¯åŒ¹é…ä¸äº†â€a.b.câ€ã€‚<br><code>#</code>Â ç¬¦å·ï¼šåŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªè¯ã€‚æ¯”å¦‚â€rabbit.#â€æ—¢å¯ä»¥åŒ¹é…åˆ°â€rabbit.a.bâ€ã€â€rabbit.aâ€ï¼Œä¹Ÿå¯ä»¥åŒ¹é…åˆ°â€rabbit.a.b.câ€ã€‚</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202312121409207.png" alt="image.png"></p><blockquote><p>ä½¿ç”¨ç¤ºä¾‹</p></blockquote><p>åœ¨å‰æ–‡çš„åŸºç¡€ä¸Šï¼Œæ–°å¢ä¸€äº›å†…å®¹</p><p>é…ç½®ç±»(æ›´æ–°é…ç½®ç±»ä»¥åŒ…å«ä¸€ä¸ªä¸»é¢˜äº¤æ¢æœºå’Œä¸¤ä¸ªé˜Ÿåˆ—ï¼Œä»¥åŠå®ƒä»¬çš„ç»‘å®š)</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RabbitConfig</span> &#123;<br><br>    <span class="hljs-comment">// ... å…¶ä»–é…ç½® ...</span><br><br>    <span class="hljs-comment">// Topic Exchange é…ç½®</span><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">TopicExchange</span> <span class="hljs-title function_">topicExchange</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TopicExchange</span>(<span class="hljs-string">&quot;TOPIC_EXCHANGE&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Queue</span> <span class="hljs-title function_">topicQueueOneWord</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Queue</span>(<span class="hljs-string">&quot;TOPIC_QUEUE_ONE_WORD&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Queue</span> <span class="hljs-title function_">topicQueueMultipleWords</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Queue</span>(<span class="hljs-string">&quot;TOPIC_QUEUE_MULTIPLE_WORDS&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-comment">// ç»‘å®šé”® &quot;topic.*&quot; åªåŒ¹é…ä¸€ä¸ªå•è¯</span><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Binding</span> <span class="hljs-title function_">bindingTopicOneWord</span>(<span class="hljs-params">Queue topicQueueOneWord, TopicExchange topicExchange</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title class_">BindingBuilder</span>.<span class="hljs-title function_">bind</span>(topicQueueOneWord).<span class="hljs-title function_">to</span>(topicExchange).<span class="hljs-title function_">with</span>(<span class="hljs-string">&quot;topic.*&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-comment">// ç»‘å®šé”® &quot;topic.#&quot; åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªå•è¯</span><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Binding</span> <span class="hljs-title function_">bindingTopicMultipleWords</span>(<span class="hljs-params">Queue topicQueueMultipleWords, TopicExchange topicExchange</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title class_">BindingBuilder</span>.<span class="hljs-title function_">bind</span>(topicQueueMultipleWords).<span class="hljs-title function_">to</span>(topicExchange).<span class="hljs-title function_">with</span>(<span class="hljs-string">&quot;topic.#&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç”Ÿäº§è€…ç±»</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SenderService</span> &#123;<br><br>    <span class="hljs-comment">// ... å…¶ä»–æ–¹æ³• ...</span><br><br>    <span class="hljs-meta">@Resource</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">RabbitTemplate</span> rabbitTemplate;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å‘é€æ¶ˆæ¯åˆ°ä¸»é¢˜äº¤æ¢æœº</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">sendToTopic</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> routingKey, <span class="hljs-built_in">String</span> message</span>) &#123;<br>        rabbitTemplate.<span class="hljs-title function_">convertAndSend</span>(<span class="hljs-string">&quot;TOPIC_EXCHANGE&quot;</span>, routingKey, message);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ¶ˆè´¹è€…ç±»</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Receiver</span> &#123;<br><br>    <span class="hljs-comment">// ... å…¶ä»–æ–¹æ³• ...</span><br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> final <span class="hljs-title class_">Logger</span> log = <span class="hljs-title class_">LoggerFactory</span>.<span class="hljs-title function_">getLogger</span>(<span class="hljs-title class_">Receiver</span>.<span class="hljs-property">class</span>);<br><br>    <span class="hljs-meta">@RabbitListener</span>(queues = &#123;<span class="hljs-string">&quot;TOPIC_QUEUE_ONE_WORD&quot;</span>&#125;)<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">receiveFromTopicOneWord</span>(<span class="hljs-params">Message message</span>) &#123;<br>        log.<span class="hljs-title function_">debug</span>(<span class="hljs-string">&quot;Received in TOPIC_QUEUE_ONE_WORD: &quot;</span> + <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(message.<span class="hljs-title function_">getBody</span>()));<br>    &#125;<br><br>    <span class="hljs-meta">@RabbitListener</span>(queues = &#123;<span class="hljs-string">&quot;TOPIC_QUEUE_MULTIPLE_WORDS&quot;</span>&#125;)<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">receiveFromTopicMultipleWords</span>(<span class="hljs-params">Message message</span>) &#123;<br>        log.<span class="hljs-title function_">debug</span>(<span class="hljs-string">&quot;Received in TOPIC_QUEUE_MULTIPLE_WORDS: &quot;</span> + <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(message.<span class="hljs-title function_">getBody</span>()));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æµ‹è¯•ç±»(å‘é€æ¶ˆæ¯å¹¶éªŒè¯å®ƒä»¬è¢«æ­£ç¡®è·¯ç”±åˆ°å¯¹åº”çš„é˜Ÿåˆ—ï¼š)</p><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs aspectj"><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RabbitMqTest</span> </span>&#123;<br><br>    <span class="hljs-comment">// ... å…¶ä»–æµ‹è¯• ...</span><br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> SenderService senderService;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">testTopicExchange</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException </span>&#123;<br>        <span class="hljs-comment">// å‘é€æ¶ˆæ¯ï¼Œè·¯ç”±é”®åŒ¹é… &quot;topic.*&quot;ï¼Œåº”è¯¥åªè¢« TOPIC_QUEUE_ONE_WORD æ¥æ”¶</span><br>        senderService.sendToTopic(<span class="hljs-string">&quot;topic.one&quot;</span>, <span class="hljs-string">&quot;Message for topic.one&quot;</span>);<br><br>        <span class="hljs-comment">// å‘é€æ¶ˆæ¯ï¼Œè·¯ç”±é”®åŒ¹é… &quot;topic.#&quot;ï¼Œåº”è¯¥è¢«ä¸¤ä¸ªé˜Ÿåˆ—æ¥æ”¶</span><br>        senderService.sendToTopic(<span class="hljs-string">&quot;topic.one.two&quot;</span>, <span class="hljs-string">&quot;Message for topic.one.two&quot;</span>);<br><br>        <span class="hljs-comment">// ç­‰å¾…ä¸€æ®µæ—¶é—´ä»¥ç¡®ä¿æ¶ˆæ¯è¢«æ¶ˆè´¹</span><br>        Thread.sleep(<span class="hljs-number">1000</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>ç¬¬ä¸€ä¸ªæµ‹è¯•æ¶ˆæ¯ä½¿ç”¨è·¯ç”±é”® â€œtopic.oneâ€ï¼Œå®ƒç¬¦åˆ <code>*</code> çš„åŒ¹é…è§„åˆ™ï¼ˆåŒ¹é…ä¸€ä¸ªå•è¯ï¼‰ï¼Œå› æ­¤åªæœ‰ â€œTOPIC_QUEUE_ONE_WORDâ€ é˜Ÿåˆ—æ¥æ”¶åˆ°è¿™ä¸ªæ¶ˆæ¯ã€‚</li><li>ç¬¬äºŒä¸ªæµ‹è¯•æ¶ˆæ¯ä½¿ç”¨è·¯ç”±é”® â€œtopic.one.twoâ€ï¼Œå®ƒç¬¦åˆ <code>#</code> çš„åŒ¹é…è§„åˆ™ï¼ˆåŒ¹é…å¤šä¸ªå•è¯ï¼‰ï¼Œå› æ­¤ä¸¤ä¸ªé˜Ÿåˆ—éƒ½æ¥æ”¶åˆ°è¿™ä¸ªæ¶ˆæ¯ã€‚</li></ul><p>è¿è¡Œæµ‹è¯•åï¼Œé€šè¿‡æ—¥å¿—è¾“å‡ºå¯ä»¥éªŒè¯è¿™äº›åŒ¹é…è§„åˆ™æ˜¯å¦æŒ‰é¢„æœŸå·¥ä½œã€‚</p><blockquote><p>å°ç»“</p></blockquote><p>åœ¨ RabbitMQä¸­æ¯”è¾ƒå¸¸ç”¨çš„ä¸‰ç§æ¨¡å¼æ˜¯ï¼šç›´è¿(DirectExchange)ï¼Œå‘å¸ƒè®¢é˜…(FanoutExchange)ï¼Œé€šé…ç¬¦(TopicExchange)ã€‚</p><p>ç†Ÿç»ƒè¿ç”¨è¿™ä¸‰ç§äº¤æ¢æœºç±»å‹ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥è§£å†³å¤§éƒ¨åˆ†çš„ä¸šåŠ¡åœºæ™¯ã€‚</p><p>é€šé…ç¬¦(TopicExchange)è¿™ç§æ¨¡å¼ä¹Ÿå¯ä»¥è¾¾åˆ°ç›´è¿(DirectExchange)å’Œå‘å¸ƒè®¢é˜…(FanoutExchange)è¿™ä¸¤ç§çš„æ•ˆæœã€‚</p><p>FanoutExchangeä¸éœ€è¦ç»‘å®šroutingKeyï¼Œæ‰€ä»¥æ€§èƒ½ç›¸å¯¹TopicExchangeä¼šå¥½ä¸€äº›ã€‚</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://www.rabbitmq.com/documentation.html">https://www.rabbitmq.com/documentation.html</a></li><li><a href="https://developer.aliyun.com/article/769883">https://developer.aliyun.com/article/769883</a></li><li><a href="https://blog.csdn.net/CherryChenieth/article/details/124767155">https://blog.csdn.net/CherryChenieth/article/details/124767155</a></li><li><a href="https://javaguide.cn/high-performance/message-queue/rabbitmq-questions.html">https://javaguide.cn/high-performance/message-queue/rabbitmq-questions.html</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>ä¸­é—´ä»¶</category>
      
      <category>MQ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>MQ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ¶ˆæ¯é˜Ÿåˆ—_RocketMQ_åŸºç¡€ä½¿ç”¨</title>
    <link href="/2023/12/28/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97_RocketMQ_%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/"/>
    <url>/2023/12/28/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97_RocketMQ_%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å¤§çº²</p></blockquote><ul><li>RocketMQæ˜¯ä»€ä¹ˆ</li><li>é˜Ÿåˆ—æ¨¡å‹å’Œä¸»é¢˜æ¨¡å‹</li><li>RocketMQæ¶æ„è®¾è®¡</li><li>RocketMQ çš„åŠŸèƒ½ç‰¹æ€§</li><li>å¦‚ä½•è§£å†³é¡ºåºæ¶ˆè´¹å’Œé‡å¤æ¶ˆè´¹</li><li>RocketMQ å¦‚ä½•å®ç°åˆ†å¸ƒå¼äº‹åŠ¡</li><li>å¦‚ä½•è§£å†³æ¶ˆæ¯å †ç§¯é—®é¢˜ï¼Ÿ</li><li>å›æº¯æ¶ˆè´¹</li><li>RocketMQ å¦‚ä½•ä¿è¯é«˜æ€§èƒ½è¯»å†™</li><li>RocketMQ çš„åˆ·ç›˜æœºåˆ¶</li><li>RocketMQ å¦‚ä½•ä¿è¯ä¸ä¸¢å¤±æ¶ˆæ¯</li></ul><h4 id="å›é¡¾"><a href="#å›é¡¾" class="headerlink" title="å›é¡¾"></a>å›é¡¾</h4><p>æ¶ˆæ¯é˜Ÿåˆ—èƒ½ç”¨æ¥å¹²ä»€ä¹ˆ</p><ul><li>å¼‚æ­¥</li><li>è§£è€¦</li><li>å‰Šå³°</li></ul><p>åœ¨å¼•å…¥æ¶ˆæ¯é˜Ÿåˆ—æ—¶ï¼ŒåŒæ—¶æ„å‘³ç€ä¼šç»™ç³»ç»Ÿå¸¦æ¥ä¸€ç³»åˆ—çš„å‰¯ä½œç”¨å’ŒæŒ‘æˆ˜ï¼Œè¿™äº›é—®é¢˜éœ€è¦åœ¨è®¾è®¡å’Œå®æ–½è¿‡ç¨‹ä¸­äºˆä»¥ç‰¹åˆ«è€ƒè™‘ã€‚</p><p>å…³é”®ç‚¹å’Œé£é™©ï¼š</p><ul><li><ol><li>é™ä½ç³»ç»Ÿçš„å¯ç”¨æ€§</li></ol></li><li><ol start="2"><li>å¢åŠ ç³»ç»Ÿçš„å¤æ‚åº¦</li></ol></li><li><ol start="3"><li>å¦‚ä½•è§£å†³é‡å¤æ¶ˆè´¹æ¶ˆæ¯çš„é—®é¢˜</li></ol></li><li><ol start="4"><li>å¦‚ä½•è§£å†³æ¶ˆæ¯çš„é¡ºåºæ¶ˆè´¹é—®é¢˜</li></ol></li><li><ol start="5"><li>è§£å†³åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜</li></ol></li><li><ol start="6"><li>è§£å†³æ¶ˆæ¯å †ç§¯çš„é—®é¢˜</li></ol></li></ul><h3 id="1ã€RocketMQæ˜¯ä»€ä¹ˆ"><a href="#1ã€RocketMQæ˜¯ä»€ä¹ˆ" class="headerlink" title="1ã€RocketMQæ˜¯ä»€ä¹ˆ"></a>1ã€RocketMQæ˜¯ä»€ä¹ˆ</h3><p>RocketMQ æ˜¯ä¸€æ¬¾å¼€æºçš„åˆ†å¸ƒå¼æ¶ˆæ¯å’Œæµå¤„ç†å¹³å°ï¼Œç”±é˜¿é‡Œå·´å·´é›†å›¢å¼€å‘å¹¶è´¡çŒ®ç»™ Apache è½¯ä»¶åŸºé‡‘ä¼šã€‚å®ƒè¢«è®¾è®¡ç”¨äºå¤„ç†å¤§è§„æ¨¡ã€é«˜ååé‡çš„æ¶ˆæ¯ä¼ é€’ï¼Œå¹¶åœ¨é˜¿é‡Œå·´å·´é›†å›¢å†…éƒ¨åŠä¼—å¤šä¼ä¸šä¸­å¹¿æ³›ä½¿ç”¨ã€‚</p><p>ç‰¹ç‚¹ï¼šé«˜æ€§èƒ½ï¼Œé«˜å¯é ï¼Œé«˜å®æ—¶ï¼Œåˆ†å¸ƒå¼</p><h3 id="2ã€é˜Ÿåˆ—æ¨¡å‹å’Œä¸»é¢˜æ¨¡å‹"><a href="#2ã€é˜Ÿåˆ—æ¨¡å‹å’Œä¸»é¢˜æ¨¡å‹" class="headerlink" title="2ã€é˜Ÿåˆ—æ¨¡å‹å’Œä¸»é¢˜æ¨¡å‹"></a>2ã€é˜Ÿåˆ—æ¨¡å‹å’Œä¸»é¢˜æ¨¡å‹</h3><p>äº†è§£ RocketMQ å‰ï¼Œæˆ‘ä»¬å…ˆäº†è§£ä¸‹é¢ä¸¤ä¸ªåè¯æ¦‚å¿µï¼šé˜Ÿåˆ—æ¨¡å‹å’Œä¸»é¢˜æ¨¡å‹</p><h4 id="é˜Ÿåˆ—æ¨¡å‹å’Œä¸»é¢˜æ¨¡å‹"><a href="#é˜Ÿåˆ—æ¨¡å‹å’Œä¸»é¢˜æ¨¡å‹" class="headerlink" title="é˜Ÿåˆ—æ¨¡å‹å’Œä¸»é¢˜æ¨¡å‹"></a>é˜Ÿåˆ—æ¨¡å‹å’Œä¸»é¢˜æ¨¡å‹</h4><ul><li>é˜Ÿåˆ—æ¨¡å‹<ul><li>é˜Ÿåˆ—æ–¹å¼ï¼Œç”Ÿäº§è€…æ¶ˆè´¹è€…</li></ul></li><li>ä¸»é¢˜æ¨¡å‹&#x2F;å‘å¸ƒè®¢é˜…<ul><li>å‘å¸ƒè€…å°†æ¶ˆæ¯å‘é€åˆ°æŒ‡å®šä¸»é¢˜ä¸­ï¼Œè®¢é˜…è€…éœ€è¦Â <strong>æå‰è®¢é˜…ä¸»é¢˜</strong>Â æ‰èƒ½æ¥å—ç‰¹å®šä¸»é¢˜çš„æ¶ˆæ¯ã€‚<img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231220201308.png" alt="image.png|500"></li></ul></li></ul><h4 id="RocketMQä¸­çš„æ¶ˆæ¯æ¨¡å‹"><a href="#RocketMQä¸­çš„æ¶ˆæ¯æ¨¡å‹" class="headerlink" title="RocketMQä¸­çš„æ¶ˆæ¯æ¨¡å‹"></a>RocketMQä¸­çš„æ¶ˆæ¯æ¨¡å‹</h4><div style="background-color: #ecf0f1; color: #34495e; padding: 15px; border: 2px solid #bdc3c7; border-radius: 5px;">  <strong>`RocketMQ`Â ä¸­çš„æ¶ˆæ¯æ¨¡å‹æ˜¯æŒ‰ç…§Â ä¸»é¢˜æ¨¡å‹Â æ‰€å®ç°çš„</strong></div><p>RocketMQ å®ç°çš„æ¶ˆæ¯ä¼ é€’æ¨¡å‹éµå¾ªäº†ä¸»é¢˜æ¨¡å‹ï¼ˆä¹Ÿç§°ä¸ºå‘å¸ƒ&#x2F;è®¢é˜…æ¨¡å‹ï¼‰è¿™ä¸€æ ‡å‡†ã€‚</p><p>ä¸»é¢˜æ¨¡å‹æ˜¯æ¶ˆæ¯ä¸­é—´ä»¶ä¸­çš„ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œå®ƒå®šä¹‰äº†å¦‚ä½•è¿›è¡Œæ¶ˆæ¯çš„å‘å¸ƒå’Œè®¢é˜…ã€‚åœ¨è¿™ç§æ¨¡å‹ä¸­ï¼Œæ¶ˆæ¯ç”Ÿäº§è€…ï¼ˆå‘å¸ƒè€…ï¼‰å‘é€æ¶ˆæ¯åˆ°ä¸€ä¸ªä¸»é¢˜ï¼ˆTopicï¼‰ï¼Œè€Œæ¶ˆæ¯æ¶ˆè´¹è€…ï¼ˆè®¢é˜…è€…ï¼‰è®¢é˜…è¿™ä¸ªä¸»é¢˜å¹¶æ¥æ”¶ç›¸åº”çš„æ¶ˆæ¯ã€‚</p><blockquote><p>æ ¸å¿ƒæ¦‚å¿µç†è§£ï¼š</p></blockquote><ul><li><strong>ä¸»é¢˜æ¨¡å‹ï¼ˆTopic Modelï¼‰</strong>ï¼š<ul><li>å®ƒæ˜¯ä¸€ç§å‘å¸ƒ&#x2F;è®¢é˜…æ¶ˆæ¯ä¼ é€’çš„æ¶æ„æ¨¡å¼ã€‚</li><li>æ¶ˆæ¯ç”Ÿäº§è€…å‘å¸ƒæ¶ˆæ¯åˆ°ä¸»é¢˜ï¼Œè€Œä¸æ˜¯ç›´æ¥å‘é€ç»™ç‰¹å®šçš„æ¶ˆè´¹è€…ã€‚</li><li>æ¶ˆæ¯æ¶ˆè´¹è€…è®¢é˜…ä¸»é¢˜æ¥æ¥æ”¶æ¶ˆæ¯ï¼Œè€Œä¸æ˜¯ä»ç‰¹å®šç”Ÿäº§è€…æ¥æ”¶ã€‚</li></ul></li><li><strong>å‘å¸ƒ&#x2F;è®¢é˜…æ¨¡å‹ï¼ˆPub&#x2F;Sub Modelï¼‰</strong>ï¼š<ul><li>è¿™æ˜¯ä¸»é¢˜æ¨¡å‹çš„å¦ä¸€ç§å«æ³•ï¼Œå¼ºè°ƒçš„æ˜¯æ¶ˆæ¯çš„å‘å¸ƒå’Œè®¢é˜…æœºåˆ¶ã€‚</li><li>ä»»ä½•è®¢é˜…äº†ä¸»é¢˜çš„æ¶ˆè´¹è€…éƒ½èƒ½æ¥æ”¶åˆ°ä¸»é¢˜ä¸­çš„æ¶ˆæ¯ï¼Œå®ç°äº†ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„è§£è€¦ã€‚</li></ul></li></ul><h4 id="RocketMQ-çš„ä¸»é¢˜æ¨¡å‹å¦‚ä½•å®ç°"><a href="#RocketMQ-çš„ä¸»é¢˜æ¨¡å‹å¦‚ä½•å®ç°" class="headerlink" title="RocketMQ çš„ä¸»é¢˜æ¨¡å‹å¦‚ä½•å®ç°"></a>RocketMQ çš„ä¸»é¢˜æ¨¡å‹å¦‚ä½•å®ç°</h4><p>åœ¨ RocketMQ ä¸­ï¼Œè¿™ç§æ¨¡å‹æ˜¯é€šè¿‡å¤šä¸ªé˜Ÿåˆ—ï¼ˆQueueï¼‰æ¥å®ç°çš„ï¼Œæ¯ä¸ªé˜Ÿåˆ—ç›¸å½“äº Kafka ä¸­çš„åˆ†åŒºæˆ– RabbitMQ ä¸­çš„ Exchangeã€‚</p><p>å…·ä½“å®ç°çœ‹ä¸‹ä¸€ç« çš„æ¶æ„è®¾è®¡ã€‚</p><h3 id="3ã€RocketMQæ¶æ„è®¾è®¡"><a href="#3ã€RocketMQæ¶æ„è®¾è®¡" class="headerlink" title="3ã€RocketMQæ¶æ„è®¾è®¡"></a>3ã€RocketMQæ¶æ„è®¾è®¡</h3><p>å…ˆäº†è§£ä¸€ä¸‹ï¼Œåœ¨ RocketMQ ä¸­ï¼Œä»–çš„ä¸€äº›åŸºç¡€è§’è‰²ã€‚</p><h4 id="åŸºç¡€è§’è‰²"><a href="#åŸºç¡€è§’è‰²" class="headerlink" title="åŸºç¡€è§’è‰²"></a>åŸºç¡€è§’è‰²</h4><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231226214425.png" alt="image.png"></p><p><code>RocketMQ</code>Â æŠ€æœ¯æ¶æ„ä¸­æœ‰å››å¤§è§’è‰²Â <code>NameServer</code>ã€<code>Broker</code>ã€<code>Producer</code>ã€<code>Consumer</code></p><ul><li><code>NameServer</code><ul><li>æ³¨å†Œä¸­å¿ƒï¼Œæä¾› <code>Broker</code>ç®¡ç†å’Œè·¯ç”±ä¿¡æ¯ç®¡ç†</li><li>æ“ä½œæ­¥éª¤<ul><li><ol><li><code>Broker</code> ä¼šå°†è‡ªå·±çš„ä¿¡æ¯æ³¨å†Œåˆ° <code>NameServer</code> ä¸­ï¼ˆæ­¤æ—¶ï¼Œ<code>NameServer</code> ä¼šå­˜æ”¾å¾ˆå¤š <code>Broker</code> çš„ä¿¡æ¯  â†  Broker çš„è·¯ç”±è¡¨ä¿¡æ¯ï¼‰</li></ol></li><li><ol start="2"><li>æ¶ˆè´¹è€…å’Œç”Ÿäº§è€…ä» <code>NameServer</code> è·å–è·¯ç”±è¡¨ä¿¡æ¯å’Œå¯¹åº”çš„  <code>Broker</code> è¿›è¡Œé€šä¿¡(ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…å®šæœŸä¼šå‘ <code>NameServer</code> å»æŸ¥è¯¢ç›¸å…³çš„ <code>Broker</code> çš„ä¿¡æ¯)</li></ol></li></ul></li><li>å¤šä¸ª NameServer å½¢æˆé›†ç¾¤ï¼Œä½†å®ƒä»¬ä¹‹é—´ä¸åŒæ­¥ä¿¡æ¯ã€‚å®¢æˆ·ç«¯ï¼ˆProducer å’Œ Consumerï¼‰å¯ä»¥è¿æ¥ä»»æ„ä¸€ä¸ª NameServer</li></ul></li><li><code>Broker</code><ul><li>æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡å™¨ï¼Œç”Ÿäº§è€…ç”Ÿäº§æ¶ˆæ¯åˆ°Â <code>Broker</code>Â ï¼Œæ¶ˆè´¹è€…ä»Â <code>Broker</code>Â æ‹‰å–æ¶ˆæ¯å¹¶æ¶ˆè´¹ã€‚</li><li>Broker å¯ä»¥æ˜¯ Master ä¹Ÿå¯ä»¥æ˜¯ Slaveã€‚<ul><li>æ¯ä¸ª Master å¯ä»¥æœ‰å¤šä¸ª Slaveã€‚Master è´Ÿè´£è¯»å†™æ¶ˆæ¯ï¼ŒSlave å¯ä»¥è¿›è¡Œæ¶ˆæ¯çš„åŒæ­¥ï¼Œä¿è¯æ•°æ®çš„é«˜å¯ç”¨æ€§ã€‚</li></ul></li><li>Broker æ˜¯æ¶ˆæ¯å­˜å‚¨å’Œè½¬å‘çš„æ ¸å¿ƒã€‚ç”Ÿäº§è€…å°†æ¶ˆæ¯å‘é€åˆ° Brokerï¼ŒBroker è´Ÿè´£å°†æ¶ˆæ¯ä¿å­˜åœ¨ç›¸åº”çš„é˜Ÿåˆ—ä¸­ã€‚</li><li>Broker å¤„ç†æ‰€æœ‰ä¸æ¶ˆæ¯ç›¸å…³çš„æ“ä½œï¼ŒåŒ…æ‹¬æ¶ˆæ¯çš„å­˜å‚¨ã€æ£€ç´¢ã€åˆ é™¤ä»¥åŠå‘æ¶ˆè´¹è€…åˆ†å‘æ¶ˆæ¯ã€‚</li><li>Broker è´Ÿè´£ç»´æŠ¤æ¯ä¸ªé˜Ÿåˆ—çš„çŠ¶æ€ï¼Œå¦‚æ¶ˆæ¯åç§»é‡ï¼ˆOffsetï¼‰ï¼Œç¡®ä¿æ¶ˆæ¯èƒ½å¤Ÿè¢«æ­£ç¡®åœ°æ¶ˆè´¹ã€‚</li></ul></li><li><code>Producer</code><ul><li>ç”Ÿäº§è€…</li></ul></li><li><code>Consumer</code><ul><li>æ¶ˆè´¹è€…</li><li>æ¶ˆè´¹è€…å‘ Broker è®¢é˜…ç‰¹å®šçš„ Topicã€‚è¿™ä¸ªè¿‡ç¨‹ä¼šæ¶‰åŠ NameServer æ¥æ‰¾åˆ°æ‰˜ç®¡è¯¥ Topic çš„ Brokerã€‚</li><li>ä¸€æ—¦ Broker ä¸­çš„ Topic æ”¶åˆ°æ¶ˆæ¯ï¼Œç¬¦åˆæ¡ä»¶çš„æ¶ˆè´¹è€…ï¼ˆé‚£äº›è®¢é˜…äº†è¯¥ Topic çš„æ¶ˆè´¹è€…ï¼‰å°±å¯ä»¥æ¥æ”¶åˆ°è¿™äº›æ¶ˆæ¯ã€‚</li><li><strong>æ¶ˆè´¹æ¨¡å¼</strong>ï¼š<ul><li>åœ¨é›†ç¾¤æ¶ˆè´¹æ¨¡å¼ä¸‹ï¼Œæ¯æ¡æ¶ˆæ¯åªä¼šè¢«æ¶ˆè´¹è€…ç»„ä¸­çš„ä¸€ä¸ªæ¶ˆè´¹è€…å¤„ç†ã€‚</li><li>åœ¨å¹¿æ’­æ¶ˆè´¹æ¨¡å¼ä¸‹ï¼Œæ¯æ¡æ¶ˆæ¯ä¼šè¢«å‘é€åˆ°æ¶ˆè´¹è€…ç»„ä¸­çš„æ‰€æœ‰æ¶ˆè´¹è€…ã€‚</li></ul></li></ul></li></ul><h4 id="æ¶ˆæ¯å¤„ç†-ğŸ˜€"><a href="#æ¶ˆæ¯å¤„ç†-ğŸ˜€" class="headerlink" title="æ¶ˆæ¯å¤„ç† ğŸ˜€"></a>æ¶ˆæ¯å¤„ç† ğŸ˜€</h4><p>ç”Ÿäº§æ¶ˆæ¯å’Œæ¶ˆè´¹æ¶ˆæ¯æ“ä½œï¼š</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202312271701523.png" alt="image.png"></p><p>è®²è¿°ä¸€ä¸‹åœ¨ RocketMQ ä¸­ï¼Œç”Ÿäº§è€…ç»„å‘é€æ¶ˆæ¯ä»¥åŠæ¶ˆè´¹è€…ç»„æ˜¯å¦‚ä½•æ¥å—æ¶ˆæ¯çš„ã€‚</p><p>åœ¨RocketMQ ä¸­ï¼ŒNameServer è´Ÿè´£æœåŠ¡å‘ç°å’Œè·¯ç”±ç®¡ç†ï¼Œå½“ç”Ÿäº§è€…ç»„å‘é€æŸä¸€ä¸ªä¸»é¢˜çš„æ¶ˆæ¯æ—¶å€™ï¼ŒProducer Groups ä¼šå…ˆä» NameServer è·å–åˆ° Topic ä¸»é¢˜æ¶ˆæ¯ æ‰€åœ¨çš„ Broker ä¿¡æ¯ï¼Œæ ¹æ®è¿™äº›ä¿¡æ¯ï¼Œç”Ÿäº§è€…ç»„ä¼šå‘é€æ¶ˆæ¯åˆ°æ­£ç¡®çš„ Broker å’Œ å¯¹åº”çš„é˜Ÿåˆ—ä¸­ã€‚</p><p>é‡Œé¢çš„ä¸€ä¸ªæ ¸å¿ƒè§‚ç‚¹æ˜¯ Topic ï¼Œä¸ªäººç†è§£ä¸»é¢˜Topic æ˜¯ å°†Queueè¿›è¡Œåˆ†ç±»ï¼Œç±»ä¼¼åˆ†ç»„ã€æ ‡ç­¾ï¼ˆé€»è¾‘ä¸Šï¼‰</p><p>è€Œ Queue çš„å®é™…ä½œç”¨æ˜¯ ç‰©ç†å®é™…åˆ†åŒºï¼Œæ¶ˆæ¯çš„å®é™…å­˜å‚¨åœ°æ–¹ï¼›æ¶ˆæ¯å‘é€åˆ°æ­£ç¡®çš„ Broker åï¼ŒBroker ä¼šè´Ÿè´£å°†æ¶ˆæ¯<strong>ä¿å­˜åœ¨</strong>ç›¸åº”çš„é˜Ÿåˆ—ä¸­ã€‚</p><p>Consumer Groups ä¼šä»NameServer æŸ¥è¯¢ Broker çš„ä¿¡æ¯ï¼ˆä» NameServer æ¥æ‰¾åˆ°æ‰˜ç®¡è¯¥ Topic çš„ Brokerï¼‰ï¼Œè®¢é˜…å¯¹åº”ä¸»é¢˜çš„æ¶ˆæ¯ï¼Œå½“ ä¸€æ—¦ Broker ä¸­çš„ Topic æ”¶åˆ°æ¶ˆæ¯ï¼Œå°±å¯ä»¥æ¥æ”¶åˆ°å¯¹åº”æ¶ˆæ¯ã€‚</p><hr><p>ä¸€äº›å¸¸ç”¨çš„æ“ä½œå’Œæ¦‚å¿µä¹Ÿéœ€è¦ç†è§£ä¸‹ã€‚</p><p>å½“æŸä¸ª <code>Topic</code> æ¶ˆæ¯é‡å¾ˆå¤§ï¼Œåº”è¯¥ç»™å®ƒå¤šé…ç½®å‡ ä¸ªé˜Ÿåˆ—ï¼Œå¹¶ä¸” <strong>å°½é‡å¤šåˆ†å¸ƒåœ¨ä¸åŒ <code>Broker</code> ä¸Šï¼Œä»¥å‡è½»æŸä¸ª <code>Broker</code> çš„å‹åŠ›</strong> ã€‚</p><p><code>Topic</code> æ¶ˆæ¯é‡éƒ½æ¯”è¾ƒå‡åŒ€çš„æƒ…å†µä¸‹ï¼Œå¦‚æœæŸä¸ª <code>broker</code> ä¸Šçš„é˜Ÿåˆ—è¶Šå¤šï¼Œåˆ™è¯¥ <code>broker</code> å‹åŠ›è¶Šå¤§ã€‚</p><blockquote><p>é€šå¸¸å»ºè®®æ¶ˆè´¹è€…ç»„ä¸­çš„æ¶ˆè´¹è€…æ•°é‡ä¸ä¸»é¢˜ä¸­çš„é˜Ÿåˆ—æ•°é‡ä¿æŒä¸€è‡´</p></blockquote><ul><li>è¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†æœ€å¤§åŒ–å¹¶è¡Œå¤„ç†çš„æ•ˆç‡ã€‚</li><li><strong>åŸå› </strong>ï¼šå¦‚æœæ¶ˆè´¹è€…çš„æ•°é‡å¤šäºé˜Ÿåˆ—çš„æ•°é‡ï¼Œé‚£ä¹ˆä¼šæœ‰ä¸€äº›æ¶ˆè´¹è€…å®é™…ä¸Šæ²¡æœ‰åˆ†é…åˆ°é˜Ÿåˆ—ï¼Œä»è€Œé—²ç½®ã€‚ç›¸åï¼Œå¦‚æœæ¶ˆè´¹è€…çš„æ•°é‡å°‘äºé˜Ÿåˆ—çš„æ•°é‡ï¼ŒæŸäº›é˜Ÿåˆ—å¯èƒ½ä¸ä¼šè¢«åŠæ—¶æ¶ˆè´¹ï¼Œå¯¼è‡´æ¶ˆæ¯ç§¯å‹ã€‚</li></ul><blockquote><p><strong>æ¯ä¸ªæ¶ˆè´¹ç»„åœ¨æ¯ä¸ªé˜Ÿåˆ—ä¸Šç»´æŠ¤ä¸€ä¸ªæ¶ˆè´¹ä½ç½®</strong>Â </p></blockquote><ul><li><strong>Offset çš„ä½œç”¨</strong>ï¼šæ¶ˆè´¹ä½ç§»æ˜¯æŒ‡æ¶ˆè´¹è€…åœ¨é˜Ÿåˆ—ä¸­æ¶ˆè´¹åˆ°çš„ä½ç½®ã€‚å®ƒç”¨äºè·Ÿè¸ªæ¶ˆè´¹è€…å·²ç»æ¶ˆè´¹åˆ°å“ªé‡Œï¼Œä»¥ä¾¿åœ¨æ¶ˆè´¹è€…é‡å¯æˆ–æ•…éšœåèƒ½å¤Ÿä»ä¸Šæ¬¡çš„ä½ç½®ç»§ç»­æ¶ˆè´¹ã€‚</li><li><strong>è°æ¥ç»´æŠ¤</strong>ï¼šè¿™ä¸ªä½ç§»æ˜¯ç”± Broker ç»´æŠ¤çš„ã€‚æ¶ˆè´¹è€…åœ¨å¤„ç†å®Œæ¶ˆæ¯åï¼Œä¼šå‘ Broker æŠ¥å‘Šè‡ªå·±çš„æ¶ˆè´¹ä½ç§»ã€‚</li><li><strong>æ¶ˆæ¯çš„ä¿ç•™</strong>ï¼šé˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯é€šå¸¸ä¼šåœ¨æ‰€æœ‰æ¶ˆè´¹è€…ç»„æ¶ˆè´¹ä¹‹åæ‰ä¼šè¢«åˆ é™¤ã€‚è¿™æ„å‘³ç€ï¼Œåªè¦æœ‰ä¸€ä¸ªæ¶ˆè´¹è€…ç»„è¿˜æ²¡æœ‰æ¶ˆè´¹æŸæ¡æ¶ˆæ¯ï¼Œè¿™æ¡æ¶ˆæ¯å°±ä¼šè¢«ä¿ç•™åœ¨é˜Ÿåˆ—ä¸­ã€‚</li></ul><blockquote><p>æ¶ˆæ¯çš„å­˜å‚¨å’Œåˆ é™¤</p></blockquote><ul><li><strong>æ•°æ®çš„æŒä¹…åŒ–</strong>ï¼šBroker è´Ÿè´£æ¶ˆæ¯çš„å­˜å‚¨ã€‚åªè¦æ¶ˆæ¯è¿˜æ²¡æœ‰è¢«æ‰€æœ‰è®¢é˜…çš„æ¶ˆè´¹è€…ç»„æ¶ˆè´¹ï¼Œå®ƒå°±ä¼šä¸€ç›´å­˜å‚¨åœ¨ Broker ä¸­ã€‚</li><li><strong>æ¶ˆæ¯çš„åˆ é™¤</strong>ï¼šæ¶ˆæ¯é€šå¸¸åœ¨æ»¡è¶³ä¸€å®šæ¡ä»¶åæ‰ä¼šè¢«åˆ é™¤ï¼Œä¾‹å¦‚ï¼Œå½“æ‰€æœ‰æ¶ˆè´¹è€…ç»„éƒ½æ¶ˆè´¹äº†è¯¥æ¶ˆæ¯ï¼Œæˆ–è€…æ¶ˆæ¯è¾¾åˆ°äº†å…¶å­˜å‚¨çš„æœ€å¤§æ—¶é—´ï¼ˆå¦‚è®¾ç½®äº†æ¶ˆæ¯çš„å­˜å‚¨æ—¶é•¿ï¼‰ã€‚</li></ul><blockquote><p>ä¸ºä»€ä¹ˆä¸€ä¸ªä¸»é¢˜ä¸­éœ€è¦ç»´æŠ¤å¤šä¸ªé˜Ÿåˆ—ï¼Ÿ</p></blockquote><ol><li><strong>æé«˜å¹¶å‘èƒ½åŠ›</strong>ï¼šåœ¨ä¸€ä¸ªä¸»é¢˜ä¸‹é…ç½®å¤šä¸ªé˜Ÿåˆ—çš„ç›®çš„æ˜¯ä¸ºäº†æé«˜æ¶ˆæ¯å¤„ç†çš„å¹¶å‘èƒ½åŠ›ã€‚è¿™å…è®¸å¤šä¸ªç”Ÿäº§è€…åŒæ—¶å‘ä¸åŒçš„é˜Ÿåˆ—å‘é€æ¶ˆæ¯ï¼ŒåŒæ—¶ä¹Ÿå…è®¸å¤šä¸ªæ¶ˆè´¹è€…å¹¶è¡Œåœ°ä»ä¸åŒé˜Ÿåˆ—ä¸­æ‹‰å–å’Œå¤„ç†æ¶ˆæ¯ã€‚</li><li><strong>è´Ÿè½½å‡è¡¡å’Œæ•ˆç‡</strong>ï¼šå¦‚æœä¸€ä¸ªä¸»é¢˜åªæœ‰ä¸€ä¸ªé˜Ÿåˆ—ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„æ¶ˆæ¯éƒ½ä¼šè¢«é¡ºåºåœ°æ”¾å…¥è¿™ä¸ªå•ä¸€çš„é˜Ÿåˆ—ä¸­ï¼Œè¿™é™åˆ¶äº†å¹¶è¡Œå¤„ç†çš„å¯èƒ½æ€§ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå³ä½¿æœ‰å¤šä¸ªæ¶ˆè´¹è€…ï¼Œä¹Ÿåªèƒ½æœ‰ä¸€ä¸ªæ¶ˆè´¹è€…åœ¨ä»»ä½•ç»™å®šæ—¶é—´å¤„ç†é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ï¼Œä»è€Œé™ä½äº†æ•´ä½“çš„å¤„ç†æ•ˆç‡ã€‚</li></ol><h4 id="RocketMQ-çš„é«˜å¯ç”¨"><a href="#RocketMQ-çš„é«˜å¯ç”¨" class="headerlink" title="RocketMQ çš„é«˜å¯ç”¨"></a>RocketMQ çš„é«˜å¯ç”¨</h4><p>é«˜å¯ç”¨æƒ…æ™¯ä¸‹ï¼Œä¼šæ„å»º <code>broker</code>  é›†ç¾¤å¹¶ä¸”è¿›è¡Œä¸»ä»éƒ¨ç½²ï¼ŒåŒæ—¶<code>NameServer</code> ä¹Ÿè¿›è¡Œé›†ç¾¤éƒ¨ç½²ã€‚</p><p>å®˜ç½‘æ¶æ„å›¾</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202312211545167.png" alt="image.png"></p><p>ç¬¬ä¸€ï¼Œæ„å»º <code>broker</code>  é›†ç¾¤å¹¶ä¸”è¿›è¡Œä¸»ä»éƒ¨ç½²ï¼Œæ­¤æ—¶ï¼Œæ¶ˆæ¯ä¼šåˆ†å¸ƒåœ¨å¤šä¸ª  <code>broker</code> </p><p>å½“æŸä¸ª <code>Broker</code> å®•æœºï¼Œåœ¨<code>Rocketmq</code> çš„ <code>master/slave</code> ç»“æ„ä¸‹ï¼Œ<code>salve</code> å®šæ—¶ä» <code>master</code> åŒæ­¥æ•°æ®(åŒæ­¥åˆ·ç›˜æˆ–è€…å¼‚æ­¥åˆ·ç›˜)ï¼Œå¦‚æœ <code>master</code> å®•æœºï¼Œåˆ™ <code>slave</code> æä¾›æ¶ˆè´¹æœåŠ¡ï¼Œä½†æ˜¯ä¸èƒ½å†™å…¥æ¶ˆæ¯</p><p>ç¬¬äºŒï¼Œ <code>NameServer</code> è¿›è¡Œäº†é›†ç¾¤éƒ¨ç½²ï¼ˆ <strong>å»ä¸­å¿ƒåŒ–</strong> çš„ï¼Œæ²¡æœ‰ä¸»èŠ‚ç‚¹ï¼‰ï¼›</p><p><code>Broker ä¼šå’Œæ‰€æœ‰ NameServer ä¿æŒé•¿è¿æ¥ ï¼Œå¹¶ä¸”åœ¨æ¯éš” 30 ç§’ </code>Broker<code>ä¼šå‘æ‰€æœ‰</code>Nameserver<code>å‘é€å¿ƒè·³ï¼Œå¿ƒè·³åŒ…å«äº†è‡ªèº«çš„</code>Topic<code>é…ç½®ä¿¡æ¯ï¼Œè¿™ä¸ªæ­¥éª¤å°±å¯¹åº”å›¾ä¸­çš„</code>Routing Info&#96;</p><p>ç¬¬ä¸‰ï¼Œåœ¨ç”Ÿäº§è€…éœ€è¦å‘ <code>Broker</code> å‘é€æ¶ˆæ¯çš„æ—¶å€™ï¼Œ<strong>éœ€è¦å…ˆä» <code>NameServer</code> è·å–å…³äº <code>Broker</code> çš„è·¯ç”±ä¿¡æ¯</strong>ï¼Œç„¶åé€šè¿‡ <strong>è½®è¯¢</strong> çš„æ–¹æ³•å»å‘æ¯ä¸ªé˜Ÿåˆ—ä¸­ç”Ÿäº§æ•°æ®ä»¥è¾¾åˆ° <strong>è´Ÿè½½å‡è¡¡</strong> çš„æ•ˆæœã€‚</p><p>ç¬¬å››ã€æ¶ˆè´¹è€…é€šè¿‡ <code>NameServer</code> è·å–æ‰€æœ‰ <code>Broker</code> çš„è·¯ç”±ä¿¡æ¯åï¼Œå‘ <code>Broker</code> å‘é€ <code>Pull</code> è¯·æ±‚æ¥è·å–æ¶ˆæ¯æ•°æ®ã€‚</p><p><code>Consumer</code> å¯ä»¥ä»¥ä¸¤ç§æ¨¡å¼å¯åŠ¨â€”â€” <strong>å¹¿æ’­ï¼ˆBroadcastï¼‰å’Œé›†ç¾¤ï¼ˆClusterï¼‰</strong>ã€‚å¹¿æ’­æ¨¡å¼ä¸‹ï¼Œä¸€æ¡æ¶ˆæ¯ä¼šå‘é€ç»™ <strong>åŒä¸€ä¸ªæ¶ˆè´¹ç»„ä¸­çš„æ‰€æœ‰æ¶ˆè´¹è€…</strong> ï¼Œé›†ç¾¤æ¨¡å¼ä¸‹æ¶ˆæ¯åªä¼šå‘é€ç»™ä¸€ä¸ªæ¶ˆè´¹è€…ã€‚</p><h3 id="4ã€RocketMQ-çš„åŠŸèƒ½ç‰¹æ€§"><a href="#4ã€RocketMQ-çš„åŠŸèƒ½ç‰¹æ€§" class="headerlink" title="4ã€RocketMQ çš„åŠŸèƒ½ç‰¹æ€§"></a>4ã€RocketMQ çš„åŠŸèƒ½ç‰¹æ€§</h3><h4 id="æ¶ˆæ¯"><a href="#æ¶ˆæ¯" class="headerlink" title="æ¶ˆæ¯"></a>æ¶ˆæ¯</h4><p>åœ¨ RocketMQ ä¸­ï¼Œä¸€èˆ¬ä½¿ç”¨çš„æ˜¯æ™®é€šæ¶ˆæ¯ï¼Œè¿˜æœ‰å®šæ—¶æ¶ˆæ¯ã€é¡ºåºæ¶ˆæ¯ã€äº‹åŠ¡æ¶ˆæ¯ï¼›ä¸‹é¢æˆ‘ä»¬åˆ†åˆ«æ¥äº†è§£ä¸€ä¸‹å…·ä½“çš„ä¸€äº›ä½¿ç”¨ã€‚</p><blockquote><p>æ™®é€šæ¶ˆæ¯</p></blockquote><ul><li><strong>ä¸šåŠ¡åœºæ™¯</strong>ï¼šé€‚ç”¨äºå¤§å¤šæ•°æ ‡å‡†çš„æ¶ˆæ¯ä¼ é€’éœ€æ±‚ï¼Œå¦‚å¼‚æ­¥å¤„ç†ã€ç³»ç»Ÿè§£è€¦ã€æ•°æ®åˆ†å‘ç­‰ã€‚</li><li><strong>ä½¿ç”¨</strong>ï¼šç”Ÿäº§è€…å‘é€æ¶ˆæ¯åˆ°æŒ‡å®šçš„ä¸»é¢˜ï¼ˆTopicï¼‰ï¼Œæ¶ˆè´¹è€…ä»ä¸»é¢˜è®¢é˜…å¹¶å¤„ç†è¿™äº›æ¶ˆæ¯ã€‚æ¶ˆæ¯æŒ‰ç…§åˆ°è¾¾ Broker çš„é¡ºåºå­˜å‚¨ã€‚</li></ul><p><strong>æ™®é€šæ¶ˆæ¯ç”Ÿå‘½å‘¨æœŸ</strong></p><ul><li>åˆå§‹åŒ–ï¼šæ¶ˆæ¯è¢«ç”Ÿäº§è€…æ„å»ºå¹¶å®Œæˆåˆå§‹åŒ–ï¼Œå¾…å‘é€åˆ°æœåŠ¡ç«¯çš„çŠ¶æ€ã€‚</li><li>å¾…æ¶ˆè´¹ï¼šæ¶ˆæ¯è¢«å‘é€åˆ°æœåŠ¡ç«¯ï¼Œå¯¹æ¶ˆè´¹è€…å¯è§ï¼Œç­‰å¾…æ¶ˆè´¹è€…æ¶ˆè´¹çš„çŠ¶æ€ã€‚</li><li>æ¶ˆè´¹ä¸­ï¼šæ¶ˆæ¯è¢«æ¶ˆè´¹è€…è·å–ï¼Œå¹¶æŒ‰ç…§æ¶ˆè´¹è€…æœ¬åœ°çš„ä¸šåŠ¡é€»è¾‘è¿›è¡Œå¤„ç†çš„è¿‡ç¨‹ã€‚ æ­¤æ—¶æœåŠ¡ç«¯ä¼šç­‰å¾…æ¶ˆè´¹è€…å®Œæˆæ¶ˆè´¹å¹¶æäº¤æ¶ˆè´¹ç»“æœï¼Œå¦‚æœä¸€å®šæ—¶é—´åæ²¡æœ‰æ”¶åˆ°æ¶ˆè´¹è€…çš„å“åº”ï¼ŒRocketMQ ä¼šå¯¹æ¶ˆæ¯è¿›è¡Œé‡è¯•å¤„ç†ã€‚</li><li>æ¶ˆè´¹æäº¤ï¼šæ¶ˆè´¹è€…å®Œæˆæ¶ˆè´¹å¤„ç†ï¼Œå¹¶å‘æœåŠ¡ç«¯æäº¤æ¶ˆè´¹ç»“æœï¼ŒæœåŠ¡ç«¯æ ‡è®°å½“å‰æ¶ˆæ¯å·²ç»è¢«å¤„ç†ï¼ˆåŒ…æ‹¬æ¶ˆè´¹æˆåŠŸå’Œå¤±è´¥ï¼‰ã€‚RocketMQ é»˜è®¤æ”¯æŒä¿ç•™æ‰€æœ‰æ¶ˆæ¯ï¼Œæ­¤æ—¶æ¶ˆæ¯æ•°æ®å¹¶ä¸ä¼šç«‹å³è¢«åˆ é™¤ï¼Œåªæ˜¯é€»è¾‘æ ‡è®°å·²æ¶ˆè´¹ã€‚æ¶ˆæ¯åœ¨ä¿å­˜æ—¶é—´åˆ°æœŸæˆ–å­˜å‚¨ç©ºé—´ä¸è¶³è¢«åˆ é™¤å‰ï¼Œæ¶ˆè´¹è€…ä»ç„¶å¯ä»¥å›æº¯æ¶ˆæ¯é‡æ–°æ¶ˆè´¹ã€‚</li><li>æ¶ˆæ¯åˆ é™¤ï¼šRocketMQ æŒ‰ç…§æ¶ˆæ¯ä¿å­˜æœºåˆ¶æ»šåŠ¨æ¸…ç†æœ€æ—©çš„æ¶ˆæ¯æ•°æ®ï¼Œå°†æ¶ˆæ¯ä»ç‰©ç†æ–‡ä»¶ä¸­åˆ é™¤ã€‚</li></ul><blockquote><p>å®šæ—¶æ¶ˆæ¯</p></blockquote><ul><li><strong>ä¸šåŠ¡åœºæ™¯</strong>ï¼šç”¨äºé‚£äº›éœ€è¦åœ¨æŒ‡å®šæ—¶é—´ç‚¹æ‰§è¡Œçš„ä»»åŠ¡ï¼Œå¦‚å»¶è¿Ÿé€šçŸ¥ã€å®šæ—¶ä»»åŠ¡ç­‰ã€‚</li><li><strong>ä½¿ç”¨</strong>ï¼šç”Ÿäº§è€…å‘é€æ¶ˆæ¯æ—¶æŒ‡å®šä¸€ä¸ªå»¶æ—¶çº§åˆ«ï¼Œæ¶ˆæ¯å°†åœ¨æŒ‡å®šçš„å»¶æ—¶åæ‰è¢«æŠ•é€’ã€‚RocketMQ ä¸æ”¯æŒä»»æ„çš„å»¶æ—¶æ—¶é—´ï¼Œè€Œæ˜¯æä¾›äº†å‡ ä¸ªé¢„è®¾çš„å»¶æ—¶çº§åˆ«ï¼ˆå¦‚1åˆ†é’Ÿã€5åˆ†é’Ÿã€10åˆ†é’Ÿç­‰ï¼‰ã€‚</li></ul><p><strong>å®šæ—¶æ¶ˆæ¯ç”Ÿå‘½å‘¨æœŸ</strong></p><ul><li>åˆå§‹åŒ–ï¼šæ¶ˆæ¯è¢«ç”Ÿäº§è€…æ„å»ºå¹¶å®Œæˆåˆå§‹åŒ–ï¼Œå¾…å‘é€åˆ°æœåŠ¡ç«¯çš„çŠ¶æ€ã€‚</li><li>å®šæ—¶ä¸­ï¼šæ¶ˆæ¯è¢«å‘é€åˆ°æœåŠ¡ç«¯ï¼Œå’Œæ™®é€šæ¶ˆæ¯ä¸åŒçš„æ˜¯ï¼ŒæœåŠ¡ç«¯ä¸ä¼šç›´æ¥æ„å»ºæ¶ˆæ¯ç´¢å¼•ï¼Œè€Œæ˜¯ä¼šå°†å®šæ—¶æ¶ˆæ¯<strong>å•ç‹¬å­˜å‚¨åœ¨å®šæ—¶å­˜å‚¨ç³»ç»Ÿä¸­</strong>ï¼Œç­‰å¾…å®šæ—¶æ—¶åˆ»åˆ°è¾¾ã€‚</li><li>å¾…æ¶ˆè´¹ï¼šå®šæ—¶æ—¶åˆ»åˆ°è¾¾åï¼ŒæœåŠ¡ç«¯å°†æ¶ˆæ¯é‡æ–°å†™å…¥æ™®é€šå­˜å‚¨å¼•æ“ï¼Œå¯¹ä¸‹æ¸¸æ¶ˆè´¹è€…å¯è§ï¼Œç­‰å¾…æ¶ˆè´¹è€…æ¶ˆè´¹çš„çŠ¶æ€ã€‚</li><li>æ¶ˆè´¹ä¸­ï¼šæ¶ˆæ¯è¢«æ¶ˆè´¹è€…è·å–ï¼Œå¹¶æŒ‰ç…§æ¶ˆè´¹è€…æœ¬åœ°çš„ä¸šåŠ¡é€»è¾‘è¿›è¡Œå¤„ç†çš„è¿‡ç¨‹ã€‚ æ­¤æ—¶æœåŠ¡ç«¯ä¼šç­‰å¾…æ¶ˆè´¹è€…å®Œæˆæ¶ˆè´¹å¹¶æäº¤æ¶ˆè´¹ç»“æœï¼Œå¦‚æœä¸€å®šæ—¶é—´åæ²¡æœ‰æ”¶åˆ°æ¶ˆè´¹è€…çš„å“åº”ï¼ŒRocketMQ ä¼šå¯¹æ¶ˆæ¯è¿›è¡Œé‡è¯•å¤„ç†ã€‚</li><li>æ¶ˆè´¹æäº¤ï¼šæ¶ˆè´¹è€…å®Œæˆæ¶ˆè´¹å¤„ç†ï¼Œå¹¶å‘æœåŠ¡ç«¯æäº¤æ¶ˆè´¹ç»“æœï¼ŒæœåŠ¡ç«¯æ ‡è®°å½“å‰æ¶ˆæ¯å·²ç»è¢«å¤„ç†ï¼ˆåŒ…æ‹¬æ¶ˆè´¹æˆåŠŸå’Œå¤±è´¥ï¼‰ã€‚RocketMQ é»˜è®¤æ”¯æŒä¿ç•™æ‰€æœ‰æ¶ˆæ¯ï¼Œæ­¤æ—¶æ¶ˆæ¯æ•°æ®å¹¶ä¸ä¼šç«‹å³è¢«åˆ é™¤ï¼Œåªæ˜¯é€»è¾‘æ ‡è®°å·²æ¶ˆè´¹ã€‚æ¶ˆæ¯åœ¨ä¿å­˜æ—¶é—´åˆ°æœŸæˆ–å­˜å‚¨ç©ºé—´ä¸è¶³è¢«åˆ é™¤å‰ï¼Œæ¶ˆè´¹è€…ä»ç„¶å¯ä»¥å›æº¯æ¶ˆæ¯é‡æ–°æ¶ˆè´¹ã€‚</li><li>æ¶ˆæ¯åˆ é™¤ï¼šApache RocketMQ æŒ‰ç…§æ¶ˆæ¯ä¿å­˜æœºåˆ¶æ»šåŠ¨æ¸…ç†æœ€æ—©çš„æ¶ˆæ¯æ•°æ®ï¼Œå°†æ¶ˆæ¯ä»ç‰©ç†æ–‡ä»¶ä¸­åˆ é™¤ã€‚</li></ul><p>å®šæ—¶æ¶ˆæ¯çš„å®ç°é€»è¾‘éœ€è¦å…ˆç»è¿‡å®šæ—¶å­˜å‚¨ç­‰å¾…è§¦å‘ï¼Œå®šæ—¶æ—¶é—´åˆ°è¾¾åæ‰ä¼šè¢«æŠ•é€’ç»™æ¶ˆè´¹è€…ã€‚å› æ­¤ï¼Œå¦‚æœå°†å¤§é‡å®šæ—¶æ¶ˆæ¯çš„å®šæ—¶æ—¶é—´è®¾ç½®ä¸ºåŒä¸€æ—¶åˆ»ï¼Œåˆ™åˆ°è¾¾è¯¥æ—¶åˆ»åä¼šæœ‰å¤§é‡æ¶ˆæ¯åŒæ—¶éœ€è¦è¢«å¤„ç†ï¼Œä¼šé€ æˆç³»ç»Ÿå‹åŠ›è¿‡å¤§ï¼Œå¯¼è‡´æ¶ˆæ¯åˆ†å‘å»¶è¿Ÿï¼Œå½±å“å®šæ—¶ç²¾åº¦ã€‚</p><blockquote><p>é¡ºåºæ¶ˆæ¯</p></blockquote><ul><li><strong>ä¸šåŠ¡åœºæ™¯</strong>ï¼šé€‚ç”¨äºä¸¥æ ¼è¦æ±‚æ¶ˆæ¯é¡ºåºçš„åœºæ™¯ï¼Œå¦‚è‚¡ç¥¨ä»·æ ¼æ›´æ–°ã€è®¢å•çŠ¶æ€å˜æ›´ç­‰ï¼Œè¿™äº›åœºæ™¯ä¸­æ¶ˆæ¯çš„å¤„ç†é¡ºåºä¼šå½±å“åˆ°ä¸šåŠ¡é€»è¾‘çš„æ­£ç¡®æ€§ã€‚</li><li><strong>ä½¿ç”¨</strong>ï¼šç”Ÿäº§è€…åœ¨å‘é€æ¶ˆæ¯æ—¶ï¼Œå°†æ¶ˆæ¯åˆ†é…åˆ°ç‰¹å®šçš„é˜Ÿåˆ—ã€‚æ¶ˆè´¹è€…ä»é˜Ÿåˆ—ä¸­æŒ‰é¡ºåºæ¶ˆè´¹æ¶ˆæ¯ã€‚RocketMQ é€šè¿‡å›ºå®šçš„æ˜ å°„å…³ç³»ï¼ˆå¦‚è®¢å•å·çš„æ•£åˆ—å€¼ï¼‰æ¥ä¿è¯ç›¸åŒç±»å‹çš„æ¶ˆæ¯è¢«è·¯ç”±åˆ°åŒä¸€é˜Ÿåˆ—ã€‚</li></ul><p>é¡ºåºæ¶ˆæ¯ä»…æ”¯æŒä½¿ç”¨ MessageType ä¸º FIFO çš„ä¸»é¢˜ï¼Œå³é¡ºåºæ¶ˆæ¯åªèƒ½å‘é€è‡³ç±»å‹ä¸ºé¡ºåºæ¶ˆæ¯çš„ä¸»é¢˜ä¸­ï¼Œå‘é€çš„æ¶ˆæ¯çš„ç±»å‹å¿…é¡»å’Œä¸»é¢˜çš„ç±»å‹ä¸€è‡´ã€‚</p><p>å’Œæ™®é€šæ¶ˆæ¯å‘é€ç›¸æ¯”ï¼Œé¡ºåºæ¶ˆæ¯å‘é€å¿…é¡»è¦è®¾ç½®æ¶ˆæ¯ç»„ã€‚ï¼ˆæ¨èå®ç° MessageQueueSelector çš„æ–¹å¼ï¼‰ã€‚è¦ä¿è¯æ¶ˆæ¯çš„é¡ºåºæ€§éœ€è¦å•ä¸€ç”Ÿäº§è€…ä¸²è¡Œå‘é€ã€‚</p><p>å•çº¿ç¨‹ä½¿ç”¨ MessageListenerConcurrently å¯ä»¥é¡ºåºæ¶ˆè´¹ï¼Œå¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä½¿ç”¨ MessageListenerOrderly æ‰èƒ½é¡ºåºæ¶ˆè´¹ã€‚</p><blockquote><p>äº‹åŠ¡æ¶ˆæ¯</p></blockquote><ul><li><strong>ä¸šåŠ¡åœºæ™¯</strong>ï¼šé€‚ç”¨äºéœ€è¦ä¿è¯æ¶ˆæ¯å‘é€å’Œæœ¬åœ°äº‹åŠ¡åŒæ—¶æˆåŠŸæˆ–å¤±è´¥çš„åœºæ™¯ï¼Œå¦‚æ”¯ä»˜å’Œè®¢å•æœåŠ¡é—´çš„äº¤äº’ã€‚</li><li><strong>ä½¿ç”¨</strong>ï¼š<ul><li>ç”Ÿäº§è€…å‘é€åŠæ¶ˆæ¯ï¼ˆé¢„å¤‡æ¶ˆæ¯ï¼‰ã€‚</li><li>æ‰§è¡Œæœ¬åœ°äº‹åŠ¡ï¼ˆæ¯”å¦‚æ•°æ®åº“æ“ä½œï¼‰ã€‚</li><li>æ ¹æ®æœ¬åœ°äº‹åŠ¡æ‰§è¡Œç»“æœï¼Œæäº¤æˆ–å›æ»šæ¶ˆæ¯ã€‚æäº¤çš„æ¶ˆæ¯å°†è¢«æ¶ˆè´¹è€…æ¶ˆè´¹ï¼Œå›æ»šçš„æ¶ˆæ¯å°†è¢«åˆ é™¤ã€‚</li></ul></li></ul><h4 id="å‘é€æ¶ˆæ¯"><a href="#å‘é€æ¶ˆæ¯" class="headerlink" title="å‘é€æ¶ˆæ¯"></a>å‘é€æ¶ˆæ¯</h4><ul><li>ä¸å»ºè®®å•ä¸€è¿›ç¨‹åˆ›å»ºå¤§é‡ç”Ÿäº§è€…<ul><li>å¯¹äºç”Ÿäº§è€…çš„åˆ›å»ºå’Œåˆå§‹åŒ–ï¼Œå»ºè®®éµå¾ªå¤Ÿç”¨å³å¯ã€æœ€å¤§åŒ–å¤ç”¨åŸåˆ™</li></ul></li><li>ä¸å»ºè®®é¢‘ç¹åˆ›å»ºå’Œé”€æ¯ç”Ÿäº§è€…</li></ul><blockquote><p>åˆ›å»ºå’Œé”€æ¯ç”Ÿäº§è€…</p></blockquote><p>æ­£ç¡®ç¤ºä¾‹ï¼š</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs abnf">Producer p <span class="hljs-operator">=</span> ProducerBuilder.build()<span class="hljs-comment">;</span><br>for (int i <span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-comment">;i&lt;n;i++)&#123;</span><br>    Message m<span class="hljs-operator">=</span> MessageBuilder.build()<span class="hljs-comment">;</span><br>    p.send(m)<span class="hljs-comment">;</span><br> &#125;<br>p.shutdown()<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><h4 id="æ¶ˆè´¹è€…åˆ†ç»„-ğŸ¦Œ"><a href="#æ¶ˆè´¹è€…åˆ†ç»„-ğŸ¦Œ" class="headerlink" title="æ¶ˆè´¹è€…åˆ†ç»„  ğŸ¦Œ"></a>æ¶ˆè´¹è€…åˆ†ç»„  ğŸ¦Œ</h4><ul><li>PushConsumer</li><li>SimpleConsumer</li><li>PullConsumer</li></ul><h4 id="ç”Ÿäº§è€…åˆ†ç»„å’Œæ¶ˆè´¹è€…åˆ†ç»„"><a href="#ç”Ÿäº§è€…åˆ†ç»„å’Œæ¶ˆè´¹è€…åˆ†ç»„" class="headerlink" title="ç”Ÿäº§è€…åˆ†ç»„å’Œæ¶ˆè´¹è€…åˆ†ç»„"></a>ç”Ÿäº§è€…åˆ†ç»„å’Œæ¶ˆè´¹è€…åˆ†ç»„</h4><blockquote><p>ç”Ÿäº§è€…åˆ†ç»„</p></blockquote><ol><li><strong>RocketMQ 5.x ç‰ˆæœ¬åŠä»¥å</strong>ï¼š<ul><li>ç”Ÿäº§è€…ç°åœ¨æ˜¯â€œåŒ¿åâ€çš„ï¼Œå³ä¸å†å¼ºè°ƒç”Ÿäº§è€…åˆ†ç»„ï¼ˆProducerGroupï¼‰çš„æ¦‚å¿µã€‚</li><li>åœ¨æœåŠ¡ç«¯ï¼Œç”Ÿäº§è€…ä¸éœ€è¦æ˜¾å¼åœ°é…ç½®ä¸ºç‰¹å®šçš„åˆ†ç»„ï¼Œè¿™ç®€åŒ–äº†ç”Ÿäº§è€…çš„ç®¡ç†ã€‚</li></ul></li><li><strong>RocketMQ 3.x å’Œ 4.x ç‰ˆæœ¬</strong>ï¼š<ul><li>åœ¨è¿™äº›å†å²ç‰ˆæœ¬ä¸­ï¼Œç”Ÿäº§è€…åˆ†ç»„æ˜¯ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µï¼Œç”¨äºæ ‡è¯†å’Œç®¡ç†ä¸€ç»„æœ‰ç€ç›¸åŒè¡Œä¸ºçš„ç”Ÿäº§è€…ã€‚</li><li>å¦‚æœä½ æ˜¯ä»è¿™äº›æ—§ç‰ˆæœ¬å‡çº§åˆ° 5.xï¼Œé‚£ä¹ˆä¹‹å‰ä½¿ç”¨çš„ç”Ÿäº§è€…åˆ†ç»„å¯ä»¥åºŸå¼ƒï¼Œä¸å†éœ€è¦è®¾ç½®ï¼Œä¸”ä¸ä¼šå½±å“å½“å‰ä¸šåŠ¡ã€‚</li></ul></li></ol><blockquote><p>æ¶ˆè´¹è€…åˆ†ç»„</p></blockquote><ol><li><strong>æ¦‚å¿µ</strong>ï¼š<ul><li>æ¶ˆè´¹è€…åˆ†ç»„æ˜¯å¤šä¸ªæ¶ˆè´¹è€…çš„ä¸€ä¸ªé€»è¾‘åˆ†ç»„ï¼Œè¿™äº›æ¶ˆè´¹è€…æœ‰ç€ä¸€è‡´çš„æ¶ˆè´¹è¡Œä¸ºã€‚</li><li>é€šè¿‡æ¶ˆè´¹è€…åˆ†ç»„ï¼Œå¯ä»¥å®ç°æ¶ˆè´¹è¡Œä¸ºçš„è´Ÿè½½å‡è¡¡å’Œé«˜å¯ç”¨æ€§ã€‚</li></ul></li><li><strong>åŠŸèƒ½</strong>ï¼š<ul><li><strong>è®¢é˜…å…³ç³»ç®¡ç†</strong>ï¼šRocketMQ ä»¥æ¶ˆè´¹è€…åˆ†ç»„çš„ç²’åº¦æ¥ç®¡ç†å’Œè¿½æº¯è®¢é˜…å…³ç³»ã€‚</li><li><strong>æŠ•é€’é¡ºåºæ€§</strong>ï¼šæœåŠ¡ç«¯æ”¯æŒé¡ºåºæŠ•é€’å’Œå¹¶å‘æŠ•é€’ï¼Œè¿™äº›æŠ•é€’æ–¹å¼åœ¨æ¶ˆè´¹è€…åˆ†ç»„ä¸­ç»Ÿä¸€é…ç½®ã€‚</li><li><strong>æ¶ˆè´¹é‡è¯•ç­–ç•¥</strong>ï¼šåŒ…æ‹¬é‡è¯•æ¬¡æ•°å’Œæ­»ä¿¡é˜Ÿåˆ—çš„è®¾ç½®ï¼Œç”¨äºå¤„ç†æ¶ˆè´¹å¤±è´¥çš„æƒ…å†µã€‚</li></ul></li><li><strong>ç‰ˆæœ¬å·®å¼‚</strong>ï¼š<ul><li><strong>5.x ç‰ˆæœ¬</strong>ï¼šæ¶ˆè´¹è€…çš„æ¶ˆè´¹è¡Œä¸ºç»Ÿä¸€ç”±å…³è”çš„æ¶ˆè´¹è€…åˆ†ç»„åœ¨æœåŠ¡ç«¯é…ç½®å’Œç®¡ç†ï¼Œç¡®ä¿åŒä¸€åˆ†ç»„å†…æ‰€æœ‰æ¶ˆè´¹è€…çš„è¡Œä¸ºä¸€è‡´ã€‚</li><li><strong>3.x&#x2F;4.x å†å²ç‰ˆæœ¬</strong>ï¼šæ¶ˆè´¹è¡Œä¸ºç”±æ¶ˆè´¹è€…å®¢æˆ·ç«¯æ¥å£å®šä¹‰ï¼Œéœ€è¦åœ¨æ¶ˆè´¹è€…å®¢æˆ·ç«¯è®¾ç½®æ—¶ç¡®ä¿åŒä¸€åˆ†ç»„ä¸‹çš„æ¶ˆè´¹è€…è¡Œä¸ºä¸€è‡´ã€‚</li></ul></li></ol><p>RocketMQ 5.x ç‰ˆæœ¬ä¸­å¯¹ç”Ÿäº§è€…åˆ†ç»„çš„æ¦‚å¿µè¿›è¡Œäº†ç®€åŒ–ï¼Œä½¿å…¶æˆä¸ºåŒ¿åçš„ï¼Œè€Œæ¶ˆè´¹è€…åˆ†ç»„åˆ™ä»ç„¶æ˜¯ä¸€ä¸ªå…³é”®æ¦‚å¿µï¼Œç”¨äºç®¡ç†æ¶ˆè´¹è€…çš„è¡Œä¸ºå’Œç­–ç•¥ã€‚</p><h3 id="5ã€å¦‚ä½•è§£å†³é¡ºåºæ¶ˆè´¹å’Œé‡å¤æ¶ˆè´¹"><a href="#5ã€å¦‚ä½•è§£å†³é¡ºåºæ¶ˆè´¹å’Œé‡å¤æ¶ˆè´¹" class="headerlink" title="5ã€å¦‚ä½•è§£å†³é¡ºåºæ¶ˆè´¹å’Œé‡å¤æ¶ˆè´¹"></a>5ã€å¦‚ä½•è§£å†³é¡ºåºæ¶ˆè´¹å’Œé‡å¤æ¶ˆè´¹</h3><h4 id="é¡ºåºæ¶ˆè´¹"><a href="#é¡ºåºæ¶ˆè´¹" class="headerlink" title="é¡ºåºæ¶ˆè´¹"></a>é¡ºåºæ¶ˆè´¹</h4><p>æ ¹æ®ä¸Šæ–‡çš„æ¶æ„è®¾è®¡ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“<code>RocketMQ</code>Â åœ¨ä¸»é¢˜ä¸Šæ˜¯æ— åºçš„ã€å®ƒåªæœ‰åœ¨é˜Ÿåˆ—å±‚é¢æ‰æ˜¯ä¿è¯æœ‰åºçš„ã€‚</p><p>è®²è¿°é¡ºåºæ¶ˆè´¹ä¸€èˆ¬ä¼šè®¾è®¡ä¸¤ä¸ªæ¦‚å¿µâ€”â€”<strong>æ™®é€šé¡ºåº</strong> å’Œ <strong>ä¸¥æ ¼é¡ºåº</strong> ã€‚</p><ul><li>æ™®é€šé¡ºåº<ul><li>æ‰€è°“æ™®é€šé¡ºåºæ˜¯æŒ‡ æ¶ˆè´¹è€…é€šè¿‡ <strong>åŒä¸€ä¸ªæ¶ˆè´¹é˜Ÿåˆ—æ”¶åˆ°çš„æ¶ˆæ¯æ˜¯æœ‰é¡ºåºçš„</strong> ï¼Œä¸åŒæ¶ˆæ¯é˜Ÿåˆ—æ”¶åˆ°çš„æ¶ˆæ¯åˆ™å¯èƒ½æ˜¯æ— é¡ºåºçš„ã€‚æ™®é€šé¡ºåºæ¶ˆæ¯åœ¨ <code>Broker</code> <strong>é‡å¯æƒ…å†µä¸‹ä¸ä¼šä¿è¯æ¶ˆæ¯é¡ºåºæ€§</strong> (çŸ­æš‚æ—¶é—´) ã€‚</li></ul></li><li>ä¸¥æ ¼é¡ºåº<ul><li>æ‰€è°“ä¸¥æ ¼é¡ºåºæ˜¯æŒ‡ æ¶ˆè´¹è€…æ”¶åˆ°çš„ <strong>æ‰€æœ‰æ¶ˆæ¯</strong> å‡æ˜¯æœ‰é¡ºåºçš„ã€‚ä¸¥æ ¼é¡ºåºæ¶ˆæ¯ <strong>å³ä½¿åœ¨å¼‚å¸¸æƒ…å†µä¸‹ä¹Ÿä¼šä¿è¯æ¶ˆæ¯çš„é¡ºåºæ€§</strong> ã€‚</li></ul></li></ul><p>åœ¨ä¸¥æ ¼é¡ºåºè¿™ç§æ¨¡å¼ä¸‹ï¼Œå®ç°çš„æˆæœ¬è¾ƒé«˜ï¼ŒåŒæ—¶é£é™©æ¯”è¾ƒå¤§ï¼Œå¦‚æœä½ ä½¿ç”¨ä¸¥æ ¼é¡ºåºæ¨¡å¼ï¼Œ<code>Broker</code> é›†ç¾¤ä¸­åªè¦æœ‰ä¸€å°æœºå™¨ä¸å¯ç”¨ï¼Œåˆ™æ•´ä¸ªé›†ç¾¤éƒ½ä¸å¯ç”¨ã€‚ç°åœ¨ä¸»è¦åœºæ™¯æ˜¯åœ¨ <code>binlog</code> åŒæ­¥ã€‚</p><p>ä¸€èˆ¬è€Œè¨€ï¼Œæˆ‘ä»¬çš„Â <code>MQ</code>Â éƒ½æ˜¯èƒ½å®¹å¿çŸ­æš‚çš„ä¹±åºï¼Œæ‰€ä»¥æ¨èä½¿ç”¨æ™®é€šé¡ºåºæ¨¡å¼ã€‚</p><hr><p>ä¸‹é¢å›´ç»•æ™®é€šé¡ºåºè®²è¿°ä¸€ä¸‹æ¶ˆæ¯çš„é¡ºåºä¿è¯å®ç°ã€‚</p><p> <code>Producer</code> ç”Ÿäº§æ¶ˆæ¯çš„æ—¶å€™ä¼šè¿›è¡Œè½®è¯¢(å–å†³è´Ÿè½½å‡è¡¡ç­–ç•¥)æ¥å‘åŒä¸€ä¸»é¢˜çš„ä¸åŒæ¶ˆæ¯é˜Ÿåˆ—å‘é€æ¶ˆæ¯ã€‚</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ RocketMQ ä¸­å®ç°æ™®é€šé¡ºåºæ¨¡å¼ä¸»è¦æ¶‰åŠåˆ°å¦‚ä½•ç¡®ä¿ç›¸å…³çš„æ¶ˆæ¯ï¼ˆä¾‹å¦‚åŒä¸€ä¸ªè®¢å•çš„ä¸åŒæ“ä½œï¼‰è¢«å‘é€åˆ°åŒä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œä»¥ä¿æŒæ¶ˆæ¯çš„é¡ºåºæ€§ã€‚</p><p>è¿™é‡Œçš„å…³é”®åœ¨äºæ­£ç¡®åœ°é€‰æ‹©é˜Ÿåˆ—æ¥å‘é€æ¶ˆæ¯ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†çš„è§£é‡Šå’Œå®ç°æ–¹æ³•ï¼š</p><blockquote><p>æ™®é€šé¡ºåºæ¨¡å¼çš„åŸºæœ¬åŸç†</p></blockquote><ul><li><strong>é—®é¢˜</strong>ï¼šåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œç”Ÿäº§è€…åœ¨å‘é€æ¶ˆæ¯æ—¶å¯èƒ½ä¼šè½®è¯¢åœ°é€‰æ‹©ä¸åŒçš„é˜Ÿåˆ—ï¼Œè¿™å¯èƒ½å¯¼è‡´åŒä¸€ä¸ªä¸šåŠ¡æµç¨‹ï¼ˆå¦‚ä¸€ä¸ªè®¢å•çš„ä¸åŒæ“ä½œï¼‰çš„ç›¸å…³æ¶ˆæ¯è¢«å‘é€åˆ°ä¸åŒçš„é˜Ÿåˆ—ï¼Œä»è€Œæ‰“ä¹±æ¶ˆæ¯çš„é¡ºåºã€‚</li><li><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šä¸ºäº†ä¿è¯åŒä¸€ä¸šåŠ¡æµç¨‹çš„æ¶ˆæ¯è¢«å‘é€åˆ°åŒä¸€ä¸ªé˜Ÿåˆ—ï¼Œéœ€è¦åœ¨å‘é€æ¶ˆæ¯æ—¶é‡‡ç”¨ä¸€è‡´çš„é˜Ÿåˆ—é€‰æ‹©ç­–ç•¥ã€‚</li></ul><blockquote><p>å®ç°æ™®é€šé¡ºåºæ¨¡å¼</p></blockquote><ol><li><strong>ä½¿ç”¨å“ˆå¸Œå–æ¨¡æ³•</strong>ï¼š<ul><li>è¿™æ˜¯å®ç°æ¶ˆæ¯é¡ºåºçš„ä¸€ç§å¸¸ç”¨æ–¹æ³•ã€‚ç”Ÿäº§è€…åœ¨å‘é€æ¯æ¡æ¶ˆæ¯æ—¶ï¼Œå¯ä»¥æ ¹æ®ä¸šåŠ¡æ ‡è¯†ç¬¦ï¼ˆä¾‹å¦‚è®¢å•IDï¼‰è¿›è¡Œå“ˆå¸Œè®¡ç®—ã€‚</li><li>ç„¶åï¼Œä½¿ç”¨è¿™ä¸ªå“ˆå¸Œå€¼å¯¹é˜Ÿåˆ—æ•°é‡è¿›è¡Œå–æ¨¡è¿ç®—ï¼Œä»¥æ­¤å†³å®šå°†æ¶ˆæ¯å‘é€åˆ°å“ªä¸ªé˜Ÿåˆ—ã€‚</li><li>è¿™æ ·åšçš„ç»“æœæ˜¯ï¼Œç›¸åŒè®¢å•IDçš„æ‰€æœ‰æ¶ˆæ¯éƒ½ä¼šè¢«å‘é€åˆ°åŒä¸€ä¸ªé˜Ÿåˆ—ï¼Œä¿æŒäº†é¡ºåºã€‚</li></ul></li><li><strong>RocketMQ çš„é˜Ÿåˆ—é€‰æ‹©ç®—æ³•</strong>ï¼š<ul><li>RocketMQ æä¾›äº†å†…ç½®çš„é˜Ÿåˆ—é€‰æ‹©ç®—æ³•ï¼Œå…¶ä¸­ä¹‹ä¸€æ˜¯åŸºäºæ¶ˆæ¯é”®çš„å“ˆå¸Œå€¼æ¥é€‰æ‹©é˜Ÿåˆ—ã€‚</li><li>å½“ç”Ÿäº§è€…å‘é€æ¶ˆæ¯æ—¶ï¼Œå¯ä»¥æŒ‡å®šä¸€ä¸ªæ¶ˆæ¯é”®ï¼ˆä¾‹å¦‚è®¢å•IDï¼‰ï¼ŒRocketMQ ä¼šæ ¹æ®è¿™ä¸ªé”®çš„å“ˆå¸Œå€¼æ¥é€‰æ‹©é˜Ÿåˆ—ã€‚</li></ul></li><li><strong>å‘é€é¡ºåºæ¶ˆæ¯çš„å®è·µ</strong>ï¼š<ul><li>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œç¡®ä¿æ¯æ¬¡å‘é€æ¶ˆæ¯æ—¶éƒ½ä½¿ç”¨ç›¸åŒçš„ä¸šåŠ¡æ ‡è¯†ç¬¦ï¼ˆå¦‚è®¢å•IDï¼‰ä½œä¸ºæ¶ˆæ¯é”®ã€‚</li><li>è¿™æ ·ï¼Œæ— è®ºæ˜¯ä½¿ç”¨ RocketMQ çš„å†…ç½®é˜Ÿåˆ—é€‰æ‹©ç®—æ³•è¿˜æ˜¯è‡ªå®šä¹‰çš„å“ˆå¸Œå–æ¨¡æ³•ï¼Œéƒ½èƒ½ç¡®ä¿åŒä¸€è®¢å•çš„ä¸åŒæ“ä½œï¼ˆåˆ›å»ºã€æ”¯ä»˜ã€å‘è´§ï¼‰çš„æ¶ˆæ¯è¢«å‘é€åˆ°åŒä¸€ä¸ªé˜Ÿåˆ—ã€‚</li></ul></li></ol><p><strong>æ¶ˆè´¹é¡ºåºæ¶ˆæ¯</strong></p><ul><li>åœ¨æ¶ˆè´¹ç«¯ï¼Œæ¶ˆè´¹è€…ä¼šæŒ‰ç…§æ¶ˆæ¯åœ¨é˜Ÿåˆ—ä¸­çš„é¡ºåºæ¥å¤„ç†æ¶ˆæ¯ã€‚</li><li>ç”±äºç›¸å…³çš„æ¶ˆæ¯éƒ½åœ¨åŒä¸€é˜Ÿåˆ—ä¸­ï¼Œè¿™ä¿è¯äº†æ¶ˆè´¹è€…èƒ½å¤ŸæŒ‰ç…§å‘é€é¡ºåºæ¥å¤„ç†è¿™äº›æ¶ˆæ¯ã€‚</li></ul><blockquote><p>é˜Ÿåˆ—é€‰æ‹©ç®—æ³•</p></blockquote><p>RocketMQ å®ç°äº†ä¸¤ç§é˜Ÿåˆ—é€‰æ‹©ç®—æ³•ï¼Œä¹Ÿå¯ä»¥è‡ªå·±å®ç°</p><ul><li>è½®è¯¢ç®—æ³•<ul><li>è½®è¯¢ç®—æ³•å°±æ˜¯å‘æ¶ˆæ¯æŒ‡å®šçš„ topic æ‰€åœ¨é˜Ÿåˆ—ä¸­ä¾æ¬¡å‘é€æ¶ˆæ¯ï¼Œä¿è¯æ¶ˆæ¯å‡åŒ€åˆ†å¸ƒ</li><li>æ˜¯ RocketMQ é»˜è®¤é˜Ÿåˆ—é€‰æ‹©ç®—æ³•</li></ul></li><li>æœ€å°æŠ•é€’å»¶è¿Ÿç®—æ³•<ul><li>æ¯æ¬¡æ¶ˆæ¯æŠ•é€’çš„æ—¶å€™ç»Ÿè®¡æ¶ˆæ¯æŠ•é€’çš„å»¶è¿Ÿï¼Œé€‰æ‹©é˜Ÿåˆ—æ—¶ä¼˜å…ˆé€‰æ‹©æ¶ˆæ¯å»¶æ—¶å°çš„é˜Ÿåˆ—ï¼Œå¯¼è‡´æ¶ˆæ¯åˆ†å¸ƒä¸å‡åŒ€,æŒ‰ç…§å¦‚ä¸‹è®¾ç½®å³å¯ã€‚</li><li>&#96;producer.setSendLatencyFaultEnable(true);</li></ul></li><li>ç»§æ‰¿ MessageQueueSelector å®ç°</li></ul><p>ç»§æ‰¿ MessageQueueSelector å®ç°</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-title class_">SendResult</span> sendResult = producer.<span class="hljs-title function_">send</span>(msg, <span class="hljs-keyword">new</span> <span class="hljs-title class_">MessageQueueSelector</span>() &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">MessageQueue</span> <span class="hljs-title function_">select</span>(<span class="hljs-params">List&lt;MessageQueue&gt; mqs, Message msg, <span class="hljs-built_in">Object</span> arg</span>) &#123;<br>        <span class="hljs-comment">//ä»mqsä¸­é€‰æ‹©ä¸€ä¸ªé˜Ÿåˆ—,å¯ä»¥æ ¹æ®msgç‰¹ç‚¹é€‰æ‹©</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br>&#125;, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>());<br></code></pre></td></tr></table></figure><h4 id="é‡å¤æ¶ˆè´¹"><a href="#é‡å¤æ¶ˆè´¹" class="headerlink" title="é‡å¤æ¶ˆè´¹"></a>é‡å¤æ¶ˆè´¹</h4><blockquote><p>é‡å¤æ¶ˆè´¹é—®é¢˜</p></blockquote><ul><li>åœ¨æ¶ˆæ¯é˜Ÿåˆ—ç³»ç»Ÿä¸­ï¼Œç”±äºå„ç§åŸå› ï¼ˆå¦‚ç½‘ç»œæ³¢åŠ¨ã€Broker é‡å¯ç­‰ï¼‰ï¼Œæ¶ˆæ¯å¯èƒ½ä¼šè¢«é‡å¤å‘é€ç»™æ¶ˆè´¹è€…ã€‚</li><li>å¦‚æœæ¶ˆè´¹è€…å¯¹åŒä¸€æ¶ˆæ¯çš„é‡å¤å¤„ç†ä¼šå¯¼è‡´ä¸åŒçš„ç»“æœï¼ˆå¦‚å¤šæ¬¡å¢åŠ ç”¨æˆ·ç§¯åˆ†ï¼‰ï¼Œå°±ä¼šäº§ç”Ÿé—®é¢˜ã€‚</li></ul><blockquote><p>å¹‚ç­‰æ€§è§£å†³ç­–ç•¥</p></blockquote><ul><li><strong>å¹‚ç­‰æ€§å®šä¹‰</strong>ï¼šå¹‚ç­‰æ“ä½œæŒ‡çš„æ˜¯æ— è®ºæ‰§è¡Œå¤šå°‘æ¬¡ï¼Œéƒ½äº§ç”Ÿç›¸åŒçš„æ•ˆæœã€‚åœ¨æ¶ˆæ¯é˜Ÿåˆ—çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œè¿™æ„å‘³ç€å¯¹åŒä¸€æ¶ˆæ¯çš„é‡å¤å¤„ç†åº”è¯¥ä¿è¯æœ€ç»ˆç»“æœä¸å˜ã€‚</li><li><strong>å®ä¾‹è¯´æ˜</strong>ï¼šä¾‹å¦‚ï¼Œä¸€ä¸ªå¤„ç†è®¢å•ç§¯åˆ†çš„ç³»ç»Ÿï¼Œå³ä½¿æ¥æ”¶åˆ°åŒä¸€è®¢å•æ¶ˆæ¯å¤šæ¬¡ï¼Œä¹Ÿåº”è¯¥åªç»™ç”¨æˆ·å¢åŠ ä¸€æ¬¡ç›¸åº”çš„ç§¯åˆ†ã€‚</li></ul><blockquote><p>å®ç°å¹‚ç­‰æ€§çš„æ–¹æ³•</p></blockquote><ol><li><strong>ä½¿ç”¨ Redis</strong>ï¼š<ul><li>åˆ©ç”¨ Redis çš„ key-value ç‰¹æ€§å®ç°å¹‚ç­‰æ€§ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨è®¢å•IDä½œä¸º keyï¼Œç¡®ä¿å¯¹åŒä¸€è®¢å•çš„å¤„ç†æ˜¯å¹‚ç­‰çš„ã€‚</li></ul></li><li><strong>æ•°æ®åº“æ’å…¥æ³•</strong>ï¼š<ul><li>ä¾èµ–æ•°æ®åº“çš„å”¯ä¸€é”®çº¦æŸæ¥é˜²æ­¢é‡å¤æ•°æ®çš„æ’å…¥ï¼Œå¦‚ä½¿ç”¨å”¯ä¸€ç´¢å¼•æ¥ç¡®ä¿æ¯æ¡æ¶ˆæ¯åªè¢«å¤„ç†ä¸€æ¬¡ã€‚</li></ul></li><li><strong>åœºæ™¯ç‰¹å®šè§£å†³æ–¹æ¡ˆ</strong>ï¼š<ul><li>æ ¹æ®ä¸šåŠ¡åœºæ™¯çš„ä¸åŒï¼Œé€‰æ‹©åˆé€‚çš„å¹‚ç­‰æ€§å®ç°æ–¹æ³•ã€‚è€ƒè™‘æ¶ˆæ¯æ¶ˆè´¹çš„ç‰¹æ€§ï¼Œå†³å®šæ˜¯é‡‡ç”¨å¼ºæ ¡éªŒè¿˜æ˜¯å¼±æ ¡éªŒçš„å¹‚ç­‰æ€§ç­–ç•¥ã€‚</li></ul></li></ol><p>å¹‚ç­‰æ€§çš„æ¦‚å¿µä¸é™äºæ¶ˆæ¯é˜Ÿåˆ—ï¼Œå®ƒåŒæ ·é€‚ç”¨äºå…¶ä»–åœºæ™¯ï¼Œå¦‚é¿å… HTTP æœåŠ¡çš„é‡å¤è¯·æ±‚å¤„ç†æˆ–è§£å†³ RPC æ¡†æ¶åœ¨è‡ªåŠ¨é‡è¯•æ—¶çš„é‡å¤è°ƒç”¨é—®é¢˜ã€‚</p><p>é‡è¦çš„æ˜¯æ ¹æ®å…·ä½“çš„ä¸šåŠ¡éœ€æ±‚å’Œåœºæ™¯æ¥è®¾è®¡å’Œå®ç°å¹‚ç­‰æ€§ç­–ç•¥ã€‚</p><h4 id="ç‰¹æ®Šæƒ…å†µå¤„ç†"><a href="#ç‰¹æ®Šæƒ…å†µå¤„ç†" class="headerlink" title="ç‰¹æ®Šæƒ…å†µå¤„ç†"></a>ç‰¹æ®Šæƒ…å†µå¤„ç†</h4><h5 id="å‘é€å¼‚å¸¸"><a href="#å‘é€å¼‚å¸¸" class="headerlink" title="å‘é€å¼‚å¸¸"></a>å‘é€å¼‚å¸¸</h5><p>é€‰æ‹©é˜Ÿåˆ—åä¼šä¸ Broker å»ºç«‹è¿æ¥ï¼Œé€šè¿‡ç½‘ç»œè¯·æ±‚å°†æ¶ˆæ¯å‘é€åˆ° Broker ä¸Šï¼Œå¦‚æœ Broker æŒ‚äº†æˆ–è€…ç½‘ç»œæ³¢åŠ¨å‘é€æ¶ˆæ¯è¶…æ—¶æ­¤æ—¶ RocketMQ ä¼šè¿›è¡Œé‡è¯•ã€‚</p><p>é‡æ–°é€‰æ‹©å…¶ä»– Broker ä¸­çš„æ¶ˆæ¯é˜Ÿåˆ—è¿›è¡Œå‘é€ï¼Œé»˜è®¤é‡è¯•ä¸¤æ¬¡ï¼Œå¯ä»¥æ‰‹åŠ¨è®¾ç½®ã€‚</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">producer.setRetryTimesWhenSendFailed(<span class="hljs-number">5</span>)<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><h5 id="æ¶ˆæ¯è¿‡å¤§"><a href="#æ¶ˆæ¯è¿‡å¤§" class="headerlink" title="æ¶ˆæ¯è¿‡å¤§"></a>æ¶ˆæ¯è¿‡å¤§</h5><p>æ¶ˆæ¯è¶…è¿‡ 4k æ—¶ RocketMQ ä¼šå°†æ¶ˆæ¯å‹ç¼©ååœ¨å‘é€åˆ° Broker ä¸Šï¼Œå‡å°‘ç½‘ç»œèµ„æºçš„å ç”¨ã€‚</p><h3 id="6ã€RocketMQ-å¦‚ä½•å®ç°åˆ†å¸ƒå¼äº‹åŠ¡"><a href="#6ã€RocketMQ-å¦‚ä½•å®ç°åˆ†å¸ƒå¼äº‹åŠ¡" class="headerlink" title="6ã€RocketMQ å¦‚ä½•å®ç°åˆ†å¸ƒå¼äº‹åŠ¡"></a>6ã€RocketMQ å¦‚ä½•å®ç°åˆ†å¸ƒå¼äº‹åŠ¡</h3><p>è¿™é‡Œå»ºè®®ç”¨å®é™…ä¾‹å­å»è¡¥å……ä¸€ä¸‹å…·ä½“å¦‚ä½•å®Œæˆçš„ï¼Œç›®å‰æˆ‘ä»¬è®²è¿°ä¸€ä¸‹ RocketMQ æ˜¯å¦‚ä½•å®ç°åˆ†å¸ƒå¼äº‹åŠ¡çš„ã€‚</p><blockquote><p>åˆ†å¸ƒå¼äº‹åŠ¡çš„å¸¸è§å®ç°æ–¹å¼ï¼ˆæ¯ç§æ–¹æ³•éƒ½æœ‰å…¶é€‚ç”¨åœºæ™¯å’Œå±€é™æ€§ï¼‰</p></blockquote><ul><li>2PCï¼ˆä¸¤é˜¶æ®µæäº¤ï¼‰</li><li>TCCï¼ˆTry-Confirm-Cancelï¼‰</li><li>äº‹åŠ¡æ¶ˆæ¯ï¼ˆhalf åŠæ¶ˆæ¯æœºåˆ¶ï¼‰</li></ul><blockquote><p>RocketMQ çš„åˆ†å¸ƒå¼äº‹åŠ¡å®ç°</p></blockquote><p>åœ¨ RocketMQ ä¸­ï¼Œå…¶é‡‡ç”¨çš„å®ç°æœºåˆ¶æ˜¯ï¼šäº‹åŠ¡æ¶ˆæ¯åŠ ä¸Šäº‹åŠ¡åæŸ¥æœºåˆ¶ã€‚</p><p>å‚è€ƒä¸€ä¸‹è¿™ç¯‡åšå®¢ä¸­å…³äºè®¢å•å…³äºçš„ä¸€ä¸ªæµç¨‹ä½¿ç”¨ï¼š <a href="https://juejin.cn/post/6844904099993878536">https://juejin.cn/post/6844904099993878536</a></p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202312281351790.png" alt="image.png"></p><p>ä¸Šè¿°å†…å®¹æåŠåˆ°è‡ªå·±è®¤ä¸ºéœ€è¦æ³¨æ„çš„ç‚¹ï¼š</p><ul><li>æœ¬åœ°äº‹åŠ¡è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œåï¼ŒæœåŠ¡æ–¹æ‰ä¼šæäº¤æˆ–è€…å›æ»šåŠæ¶ˆæ¯åˆ° RocketMQ çš„èŠ‚ç‚¹ Broker</li></ul><blockquote><p>å›¾ï¼šRocketMQ å®ç°åˆ†å¸ƒå¼äº‹åŠ¡</p></blockquote><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202312281358695.png" alt="image.png"></p><p>å…³äº Half Messageï¼ŒåŠæ¶ˆæ¯  å’Œ äº‹åŠ¡çŠ¶æ€å›æŸ¥  çš„ä¸€ä¸ªåŸºæœ¬è¡¨è¿°ï¼š</p><ol><li><strong>äº‹åŠ¡æ¶ˆæ¯ï¼ˆHalf æ¶ˆæ¯ï¼‰</strong>ï¼š<ul><li><strong>ç¬¬ä¸€æ­¥ï¼šå‘é€ Half æ¶ˆæ¯</strong>ï¼šæ‰€è°“çš„ Half æ¶ˆæ¯æ˜¯æŒ‡ä¸€ç§ç‰¹æ®ŠçŠ¶æ€çš„æ¶ˆæ¯ï¼Œå®ƒåœ¨äº‹åŠ¡å®Œæˆä¹‹å‰å¯¹æ¶ˆè´¹è€…æ˜¯ä¸å¯è§çš„ã€‚</li><li><strong>å®ç°æœºåˆ¶</strong>ï¼šå½“å‘é€ä¸€ä¸ªäº‹åŠ¡æ¶ˆæ¯æ—¶ï¼ŒRocketMQ é¦–å…ˆå­˜å‚¨è¿™ä¸ªæ¶ˆæ¯ï¼Œä½†å°†å…¶æ ‡è®°ä¸ºä¸å¯è§çŠ¶æ€ï¼ˆHalf çŠ¶æ€ï¼‰ã€‚è¿™æ˜¯é€šè¿‡æ”¹å˜æ¶ˆæ¯çš„ä¸»é¢˜ä¸º <code>RMQ_SYS_TRANS_HALF_TOPIC</code> å®ç°çš„ï¼Œå› ä¸ºæ¶ˆè´¹è€…é€šå¸¸ä¸è®¢é˜…è¿™ä¸ªç‰¹æ®Šä¸»é¢˜ï¼Œæ‰€ä»¥ä¸ä¼šæ¶ˆè´¹è¿™äº› Half æ¶ˆæ¯ã€‚</li></ul></li><li><strong>äº‹åŠ¡åæŸ¥æœºåˆ¶</strong>ï¼š<ul><li><strong>å®šæ—¶ä»»åŠ¡</strong>ï¼šRocketMQ ä¼šå¯åŠ¨ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œå®šæœŸæ£€æŸ¥ <code>RMQ_SYS_TRANS_HALF_TOPIC</code> ä¸­çš„æ¶ˆæ¯ã€‚</li><li><strong>åæŸ¥è¯·æ±‚</strong>ï¼šå¯¹äºæ¯æ¡ Half æ¶ˆæ¯ï¼ŒRocketMQ ä¼šæ ¹æ®å…¶ç”Ÿäº§è€…ç»„å‘ç›¸åº”çš„æœåŠ¡å‘é€äº‹åŠ¡çŠ¶æ€å›æŸ¥è¯·æ±‚ã€‚</li><li><strong>äº‹åŠ¡çŠ¶æ€å†³å®š</strong>ï¼šæ ¹æ®å›æŸ¥ç»“æœï¼ŒRocketMQ ä¼šå†³å®šæ˜¯æäº¤è¿˜æ˜¯å›æ»šè¿™æ¡æ¶ˆæ¯ã€‚å¦‚æœäº‹åŠ¡æˆåŠŸï¼Œæ¶ˆæ¯å°†å˜ä¸ºæ­£å¸¸çŠ¶æ€å¹¶å¯è¢«æ¶ˆè´¹ï¼›å¦‚æœäº‹åŠ¡å¤±è´¥ï¼Œæ¶ˆæ¯å°†è¢«å›æ»šæˆ–åˆ é™¤ã€‚</li></ul></li><li><strong>ç½‘ç»œæ³¢åŠ¨å’Œäº‹åŠ¡åæŸ¥çš„é‡è¦æ€§</strong>ï¼š<ul><li><strong>é—®é¢˜åœºæ™¯</strong>ï¼šå¦‚æœåœ¨ç¡®è®¤äº‹åŠ¡æˆåŠŸï¼ˆå³ç¬¬å››æ­¥ï¼‰æ—¶å‡ºç°ç½‘ç»œé—®é¢˜ï¼ŒRocketMQ æ— æ³•çŸ¥é“è¯¥æ¶ˆæ¯æ˜¯å¦åº”è¯¥å¯¹æ¶ˆè´¹è€…å¯è§ã€‚</li><li><strong>åæŸ¥æœºåˆ¶çš„ä½œç”¨</strong>ï¼šäº‹åŠ¡åæŸ¥ç¡®ä¿å³ä½¿åœ¨ç½‘ç»œæ³¢åŠ¨æˆ–å…¶ä»–é—®é¢˜çš„æƒ…å†µä¸‹ï¼Œäº‹åŠ¡æ¶ˆæ¯çš„æœ€ç»ˆçŠ¶æ€ä¹Ÿèƒ½å¾—åˆ°æ­£ç¡®å¤„ç†ã€‚</li></ul></li></ol><p>å…¶ä»–çš„è¡¨è¿°ä¹Ÿæ˜¯å¤§åŒå°å¼‚ï¼Œå…·ä½“æ›´å¤šçš„ç»†èŠ‚å¯ä»¥çœ‹ä¸€ä¸‹å…·ä½“å®ç°ï¼Œä»¥åŠç›¸å…³è”çš„å…¶ä»–åˆ†å¸ƒå¼äº‹åŠ¡æ˜¯å¦‚ä½•å®ç°çš„ï¼Œæ¯”è¾ƒå·®å¼‚ã€‚</p><h3 id="7ã€å¦‚ä½•è§£å†³æ¶ˆæ¯å †ç§¯é—®é¢˜ï¼Ÿ"><a href="#7ã€å¦‚ä½•è§£å†³æ¶ˆæ¯å †ç§¯é—®é¢˜ï¼Ÿ" class="headerlink" title="7ã€å¦‚ä½•è§£å†³æ¶ˆæ¯å †ç§¯é—®é¢˜ï¼Ÿ"></a>7ã€å¦‚ä½•è§£å†³æ¶ˆæ¯å †ç§¯é—®é¢˜ï¼Ÿ</h3><p>è§£å†³æ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„å †ç§¯é—®é¢˜é€šå¸¸éœ€è¦ä»ä¸¤ä¸ªä¸»è¦æ–¹é¢è€ƒè™‘ï¼š</p><ul><li>ç”Ÿäº§è€…ç”Ÿäº§æ¶ˆæ¯å‡å°‘</li><li>æ¶ˆè´¹è€…å¤„ç†æ¶ˆæ¯é€Ÿç‡åŠ å¿«</li></ul><blockquote><p>ç”Ÿäº§è€…ç”Ÿäº§æ¶ˆæ¯å‡å°‘</p></blockquote><p>å¤„ç†ç­–ç•¥ä¸€èˆ¬æ˜¯é™æµå’Œé™çº§ï¼š</p><ul><li><strong>ç”Ÿäº§è€…é™æµ</strong>ï¼šåœ¨é«˜å³°æœŸï¼Œå¦‚æœç”Ÿäº§è€…ç”Ÿäº§æ¶ˆæ¯çš„é€Ÿåº¦è¿‡å¿«ï¼Œå¯ä»¥é‡‡å–é™æµæªæ–½ã€‚è¿™æ„å‘³ç€æš‚æ—¶å‡å°‘æ¶ˆæ¯çš„ç”Ÿäº§é€Ÿç‡ï¼Œæˆ–è€…åœ¨éé«˜å³°æ—¶æ®µå†è¿›è¡Œæ¶ˆæ¯çš„å‘é€ã€‚</li><li><strong>æœåŠ¡é™çº§</strong>ï¼šåœ¨ç³»ç»Ÿè´Ÿè½½è¿‡é«˜æ—¶ï¼Œå¯ä»¥ä¸´æ—¶å…³é—­ä¸€äº›éæ ¸å¿ƒä¸šåŠ¡åŠŸèƒ½ï¼Œå‡å°‘æ¶ˆæ¯çš„äº§ç”Ÿã€‚</li></ul><blockquote><p>æ¶ˆè´¹è€…å¤„ç†æ¶ˆæ¯é€Ÿç‡åŠ å¿«</p></blockquote><p>å¤„ç†ç­–ç•¥å¯ä»¥æ˜¯ å¢åŠ æ¶ˆè´¹è€…å®ä¾‹ ä»¥åŠ å¢åŠ é˜Ÿåˆ—æ•°é‡</p><ul><li>å¢åŠ æ¶ˆè´¹è€…å®ä¾‹ï¼ˆé›†ç¾¤æ¶ˆè´¹æ¨¡å¼ä¸‹å¢é•¿åŒä¸€ä¸ªæ¶ˆè´¹è€…ç»„ä¸‹çš„å®ä¾‹æ•°å¯¹å †ç§¯æ¶ˆæ¯æ¶ˆè´¹å¤„ç†å¸®åŠ©ä¸å¤§ï¼‰<ul><li>å½“ç°æœ‰é˜Ÿåˆ—ä¸­æœ‰æ¶ˆæ¯å †ç§¯ï¼Œå¹¶ä¸”ç°æœ‰çš„æ¶ˆè´¹è€…å¤„ç†èƒ½åŠ›ä¸è¶³ä»¥åŠæ—¶å¤„ç†è¿™äº›æ¶ˆæ¯æ—¶ã€‚</li><li>å¢åŠ æ¶ˆè´¹è€…å®ä¾‹å¯ä»¥å¸®åŠ©æ›´å¿«åœ°å¤„ç†ç°æœ‰é˜Ÿåˆ—ä¸­å·²ç»å †ç§¯çš„æ¶ˆæ¯ã€‚</li><li>åœ¨ä¸€ä¸ªé˜Ÿåˆ—åªè¢«ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹çš„åœºæ™¯ä¸­ï¼ˆå¦‚ RocketMQ çš„é›†ç¾¤æ¶ˆè´¹æ¨¡å¼ï¼‰ï¼Œå¢åŠ åŒä¸€æ¶ˆè´¹è€…ç»„çš„å®ä¾‹æ•°å¯¹äºåŠ å¿«å¤„ç†ä¸€ä¸ªå•ç‹¬é˜Ÿåˆ—ä¸­çš„å †ç§¯æ¶ˆæ¯æ˜¯æ— æ•ˆçš„ã€‚</li></ul></li><li>å¢åŠ é˜Ÿåˆ—æ•°é‡ï¼ˆå¢åŠ é˜Ÿåˆ—æ•°é‡åï¼Œæ–°æ¥çš„ä¸€äº›æ¶ˆæ¯èƒ½å¤Ÿè¢«ç­–ç•¥åˆ†é…åˆ°æ–°çš„é˜Ÿåˆ—ï¼Œä»è€Œå‡å°‘å †ç§¯å‹åŠ›ï¼‰<ul><li>å½“é¢„æœŸæœªæ¥å°†æœ‰é«˜è´Ÿè½½ï¼Œæˆ–è€…æƒ³è¦æé«˜ç³»ç»Ÿå¤„ç†æ–°æ¶ˆæ¯çš„èƒ½åŠ›æ—¶ã€‚</li><li>å¢åŠ é˜Ÿåˆ—æ•°é‡å¯ä»¥ä¸ºæ–°ç”Ÿäº§çš„æ¶ˆæ¯æä¾›æ›´å¤šçš„å­˜å‚¨ç©ºé—´ï¼Œå¹¶å…è®¸æ›´å¤šçš„æ¶ˆè´¹è€…å¹¶è¡Œå¤„ç†è¿™äº›æ–°æ¶ˆæ¯ã€‚</li><li>ä»…ä»…å¢åŠ é˜Ÿåˆ—æ•°é‡è€Œä¸å¢åŠ æ¶ˆè´¹è€…å®ä¾‹å¯èƒ½å¯¼è‡´æ–°é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯æœªè¢«åŠæ—¶æ¶ˆè´¹ï¼Œç‰¹åˆ«æ˜¯åœ¨é›†ç¾¤æ¶ˆè´¹æ¨¡å¼ä¸‹ã€‚</li></ul></li></ul><div style="background: linear-gradient(to right, #74ebd5, #ACB6E5); color: #333; padding: 15px; border-radius: 10px; border: 1px solid #ddd; box-shadow: 0 2px 5px rgba(0,0,0,0.2);">  <strong> </strong>æœ€å¿«é€Ÿè§£å†³æ¶ˆæ¯å †ç§¯é—®é¢˜çš„æ–¹æ³•è¿˜æ˜¯å¢åŠ æ¶ˆè´¹è€…å®ä¾‹ï¼Œä¸è¿‡ åŒæ—¶ä½ è¿˜éœ€è¦å¢åŠ æ¯ä¸ªä¸»é¢˜çš„é˜Ÿåˆ—æ•°é‡ ã€‚</div><hr><p>åœ¨æ¶ˆæ¯å †ç§¯åï¼Œæˆ‘ä»¬ä¸€èˆ¬çš„å¤„ç†æ˜¯å…ˆæ’æŸ¥æ¶ˆè´¹ç«¯æ•…éšœï¼Œè®©å¤„ç†æ¶ˆè´¹æ­£å¸¸èµ·æ¥ï¼›</p><p>ä½†æ­¤æ—¶æ¶ˆæ¯é˜Ÿåˆ—ä¸­å·²ç»å †ç§¯äº†å¤§é‡çš„ä¸€ä¸ªæ¶ˆæ¯å¾…å¤„ç†ï¼Œæˆ‘ä»¬é™¤äº†ä¼˜åŒ–æ¶ˆè´¹è€…ç«¯çš„æ¶ˆæ¯å¤„ç†é€»è¾‘å’Œå®æ–½å¿«é€Ÿå¤±è´¥æœºåˆ¶ä¹‹å¤–ï¼Œè¿˜æœ‰å…¶ä»–å‡ ç§æ–¹æ³•å¯ä»¥è€ƒè™‘ï¼š</p><ul><li><ol><li>è°ƒæ•´é˜Ÿåˆ—å’Œæ¶ˆè´¹è€…çš„æ˜ å°„å…³ç³»</li></ol></li><li><ol start="2"><li>ä¸´æ—¶å¢åŠ ç‰¹å®šé˜Ÿåˆ—çš„æ¶ˆè´¹è€…</li></ol><ul><li>å°½ç®¡åœ¨é›†ç¾¤æ¨¡å¼ä¸‹ï¼Œä¸€ä¸ªé˜Ÿåˆ—åœ¨åŒä¸€æ—¶é—´åªèƒ½ç”±ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹ï¼Œä½†æ‚¨å¯ä»¥å°è¯•ä¸´æ—¶åˆ›å»ºä¸€ä¸ªæ–°çš„æ¶ˆè´¹è€…ç»„ï¼Œä¸“é—¨ç”¨æ¥å¤„ç†é‚£ä¸ªå †ç§¯çš„é˜Ÿåˆ—ã€‚</li></ul></li><li><ol start="3"><li>ä½¿ç”¨æ¶ˆæ¯è¿‡æ»¤</li></ol><ul><li><strong>æ¶ˆæ¯é€‰æ‹©æ€§æ¶ˆè´¹</strong>ï¼šå¦‚æœé€‚ç”¨ï¼Œå¯ä»¥åœ¨æ¶ˆè´¹è€…ç«¯ä½¿ç”¨æ¶ˆæ¯è¿‡æ»¤ï¼Œä¸“æ³¨äºå¤„ç†æœ€ç´§æ€¥æˆ–æœ€é‡è¦çš„æ¶ˆæ¯ã€‚</li></ul></li><li><ol start="4"><li>çŸ­æœŸç­–ç•¥</li></ol><ul><li><strong>ä¸´æ—¶æªæ–½</strong>ï¼šä½œä¸ºä¸€ç§çŸ­æœŸç­–ç•¥ï¼Œå¯ä»¥æš‚æ—¶å°†ä¸€äº›ä¸å¤ªé‡è¦çš„ä¸šåŠ¡å¤„ç†å»¶åï¼Œä¼˜å…ˆå¤„ç†å †ç§¯çš„æ¶ˆæ¯ã€‚</li></ul></li><li><ol start="5"><li>ç³»ç»Ÿèµ„æºä¼˜åŒ–ï¼Œç›‘æ§å’ŒåŠ¨æ€è°ƒæ•´</li></ol></li></ul><h3 id="8ã€å›æº¯æ¶ˆè´¹"><a href="#8ã€å›æº¯æ¶ˆè´¹" class="headerlink" title="8ã€å›æº¯æ¶ˆè´¹"></a>8ã€å›æº¯æ¶ˆè´¹</h3><blockquote><p>å®˜æ–¹æ–‡æ¡£è§£é‡Š</p></blockquote><p>å›æº¯æ¶ˆè´¹æ˜¯æŒ‡ <code>Consumer</code> å·²ç»æ¶ˆè´¹æˆåŠŸçš„æ¶ˆæ¯ï¼Œç”±äºä¸šåŠ¡ä¸Šéœ€æ±‚éœ€è¦é‡æ–°æ¶ˆè´¹ï¼Œ</p><p>åœ¨<code>RocketMQ</code> ä¸­ï¼Œ <code>Broker</code> åœ¨å‘<code>Consumer</code> æŠ•é€’æˆåŠŸæ¶ˆæ¯åï¼Œ<strong>æ¶ˆæ¯ä»ç„¶éœ€è¦ä¿ç•™</strong> ã€‚å¹¶ä¸”é‡æ–°æ¶ˆè´¹ä¸€èˆ¬æ˜¯æŒ‰ç…§æ—¶é—´ç»´åº¦ï¼Œä¾‹å¦‚ç”±äº <code>Consumer</code> ç³»ç»Ÿæ•…éšœï¼Œæ¢å¤åéœ€è¦é‡æ–°æ¶ˆè´¹ 1 å°æ—¶å‰çš„æ•°æ®ï¼Œé‚£ä¹ˆ <code>Broker</code> è¦æä¾›ä¸€ç§æœºåˆ¶ï¼Œå¯ä»¥æŒ‰ç…§æ—¶é—´ç»´åº¦æ¥å›é€€æ¶ˆè´¹è¿›åº¦ã€‚<code>RocketMQ</code> æ”¯æŒæŒ‰ç…§æ—¶é—´å›æº¯æ¶ˆè´¹ï¼Œæ—¶é—´ç»´åº¦ç²¾ç¡®åˆ°æ¯«ç§’ã€‚</p><h3 id="9ã€RocketMQ-å¦‚ä½•ä¿è¯é«˜æ€§èƒ½è¯»å†™"><a href="#9ã€RocketMQ-å¦‚ä½•ä¿è¯é«˜æ€§èƒ½è¯»å†™" class="headerlink" title="9ã€RocketMQ å¦‚ä½•ä¿è¯é«˜æ€§èƒ½è¯»å†™"></a>9ã€RocketMQ å¦‚ä½•ä¿è¯é«˜æ€§èƒ½è¯»å†™</h3><p>RocketMQ å†…éƒ¨ä¸»è¦æ˜¯ä½¿ç”¨åŸºäº mmap å®ç°çš„é›¶æ‹·è´ï¼Œç”¨æ¥è¯»å†™æ–‡ä»¶</p><p>to be continedâ€¦.</p><h3 id="10ã€RocketMQ-çš„åˆ·ç›˜æœºåˆ¶-ğŸ¦…"><a href="#10ã€RocketMQ-çš„åˆ·ç›˜æœºåˆ¶-ğŸ¦…" class="headerlink" title="10ã€RocketMQ çš„åˆ·ç›˜æœºåˆ¶   ğŸ¦…"></a>10ã€RocketMQ çš„åˆ·ç›˜æœºåˆ¶   ğŸ¦…</h3><h4 id="åŒæ­¥åˆ·ç›˜å’Œå¼‚æ­¥åˆ·ç›˜"><a href="#åŒæ­¥åˆ·ç›˜å’Œå¼‚æ­¥åˆ·ç›˜" class="headerlink" title="åŒæ­¥åˆ·ç›˜å’Œå¼‚æ­¥åˆ·ç›˜"></a>åŒæ­¥åˆ·ç›˜å’Œå¼‚æ­¥åˆ·ç›˜</h4><p>åœ¨ RocketMQ ä¸­ï¼ŒåŒæ­¥åˆ·ç›˜å’Œå¼‚æ­¥åˆ·ç›˜æ˜¯ä¸¤ç§ä¸åŒçš„æ¶ˆæ¯æŒä¹…åŒ–ç­–ç•¥ï¼Œå®ƒä»¬å„æœ‰ä¼˜åŠ£ï¼Œå¹¶é€‚ç”¨äºä¸åŒçš„ä¸šåŠ¡åœºæ™¯ã€‚</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202312281520496.png" alt="image.png"></p><p>ä»¥ä¸‹æ˜¯å¯¹è¿™ä¸¤ç§ç­–ç•¥çš„è¯¦ç»†è¯´æ˜å’Œæ¯”è¾ƒï¼š</p><blockquote><p>åŒæ­¥åˆ·ç›˜ï¼ˆSYNC_FLUSHï¼‰</p></blockquote><ul><li><strong>å·¥ä½œåŸç†</strong>ï¼šåœ¨åŒæ­¥åˆ·ç›˜æ¨¡å¼ä¸‹ï¼Œæ¯å½“ç”Ÿäº§è€…å‘é€ä¸€æ¡æ¶ˆæ¯ï¼ŒBroker éœ€è¦å°†æ¶ˆæ¯å†™å…¥ç£ç›˜å¹¶å®Œæˆåˆ·ç›˜æ“ä½œåï¼Œæ‰ä¼šå‘ç”Ÿäº§è€…è¿”å›ç¡®è®¤ï¼ˆACKï¼‰ã€‚åªæœ‰æ”¶åˆ°è¿™ä¸ªç¡®è®¤ï¼Œç”Ÿäº§è€…æ‰çŸ¥é“æ¶ˆæ¯å·²ç»å®‰å…¨å­˜å‚¨ã€‚</li><li><strong>ä¼˜ç‚¹</strong>ï¼šæä¾›äº†æ›´é«˜çš„æ¶ˆæ¯å¯é æ€§ã€‚å³ä½¿åœ¨Brokeræ„å¤–å®•æœºçš„æƒ…å†µä¸‹ï¼Œä¹Ÿä¸ä¼šä¸¢å¤±å·²ç¡®è®¤çš„æ¶ˆæ¯ã€‚</li><li><strong>ç¼ºç‚¹</strong>ï¼šå½±å“æ€§èƒ½ã€‚ç”±äºæ¯æ¡æ¶ˆæ¯éƒ½éœ€è¦ç­‰å¾…ç£ç›˜å†™å…¥å®Œæˆï¼Œè¿™ä¼šå¢åŠ æ¶ˆæ¯çš„å»¶è¿Ÿæ—¶é—´ï¼Œé™ä½ååé‡ã€‚</li><li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šé€‚ç”¨äºå¯¹æ¶ˆæ¯å¯é æ€§æœ‰æé«˜è¦æ±‚çš„åœºæ™¯ï¼Œå¦‚é‡‘èäº¤æ˜“ã€é‡è¦ä¸šåŠ¡æ•°æ®å¤„ç†ç­‰ã€‚</li></ul><blockquote><p>å¼‚æ­¥åˆ·ç›˜ï¼ˆASYNC_FLUSHï¼‰</p></blockquote><ul><li><strong>å·¥ä½œåŸç†</strong>ï¼šåœ¨å¼‚æ­¥åˆ·ç›˜æ¨¡å¼ä¸‹ï¼ŒBroker å°†æ¶ˆæ¯å†™å…¥å†…å­˜åï¼Œå°±ç«‹å³å‘ç”Ÿäº§è€…è¿”å›ç¡®è®¤ã€‚å®é™…çš„åˆ·ç›˜æ“ä½œæ˜¯ç”±åå°çº¿ç¨‹å¼‚æ­¥å®Œæˆçš„ï¼Œä¸ä¼šé˜»å¡æ¶ˆæ¯çš„å‘é€ã€‚</li><li><strong>ä¼˜ç‚¹</strong>ï¼šæé«˜äº†æ€§èƒ½å’Œååé‡ã€‚ç”±äºæ¶ˆæ¯å‘é€ä¸éœ€è¦ç­‰å¾…ç£ç›˜æ“ä½œå®Œæˆï¼Œå› æ­¤å‡å°‘äº†å»¶è¿Ÿã€‚</li><li><strong>ç¼ºç‚¹</strong>ï¼šæ¶ˆæ¯å¯é æ€§é™ä½ã€‚å¦‚æœBrokeråœ¨æ¶ˆæ¯è¿˜æœªåˆ·å…¥ç£ç›˜å‰å‘ç”Ÿå®•æœºï¼Œé‚£ä¹ˆè¿™éƒ¨åˆ†æ¶ˆæ¯å¯èƒ½ä¼šä¸¢å¤±ã€‚</li><li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šé€‚ç”¨äºå¯¹æ€§èƒ½è¦æ±‚è¾ƒé«˜ï¼Œä½†å¯¹æ¶ˆæ¯å¯é æ€§è¦æ±‚ä¸æ˜¯ç‰¹åˆ«ä¸¥æ ¼çš„åœºæ™¯ï¼Œå¦‚æ—¥å¿—æ”¶é›†ã€ä¸€äº›éå…³é”®çš„ä¸šåŠ¡é€šçŸ¥ç­‰ã€‚</li></ul><p><strong>åˆ·ç›˜ç­–ç•¥çš„è®¾ç½®</strong></p><ul><li><strong>é…ç½®å‚æ•°</strong>ï¼šåœ¨ RocketMQ ä¸­ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®Brokerçš„<code>FlushDiskType</code>å‚æ•°æ¥è°ƒæ•´åˆ·ç›˜ç­–ç•¥ã€‚</li><li>å¯ä»¥é€‰æ‹©<code>ASYNC_FLUSH</code>ï¼ˆå¼‚æ­¥åˆ·ç›˜ï¼‰æˆ–<code>SYNC_FLUSH</code>ï¼ˆåŒæ­¥åˆ·ç›˜ï¼‰ã€‚</li></ul><p>åŒæ­¥åˆ·ç›˜å’Œå¼‚æ­¥åˆ·ç›˜åœ¨æ¶ˆæ¯å¯é æ€§å’Œæ€§èƒ½ä¹‹é—´æä¾›äº†ä¸åŒçš„å¹³è¡¡ç‚¹ã€‚</p><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œåº”æ ¹æ®ä¸šåŠ¡éœ€æ±‚çš„ä¸åŒï¼Œé€‰æ‹©æœ€åˆé€‚çš„åˆ·ç›˜ç­–ç•¥ã€‚å¯¹äºé‚£äº›è¦æ±‚é«˜å¯é æ€§çš„åœºæ™¯ï¼ŒåŒæ­¥åˆ·ç›˜æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼›è€Œå¯¹äºé‚£äº›æ›´çœ‹é‡æ€§èƒ½å’Œååé‡çš„åº”ç”¨ï¼Œå¼‚æ­¥åˆ·ç›˜åˆ™æ›´ä¸ºé€‚åˆ</p><h4 id="åŒæ­¥å¤åˆ¶å’Œå¼‚æ­¥å¤åˆ¶"><a href="#åŒæ­¥å¤åˆ¶å’Œå¼‚æ­¥å¤åˆ¶" class="headerlink" title="åŒæ­¥å¤åˆ¶å’Œå¼‚æ­¥å¤åˆ¶"></a>åŒæ­¥å¤åˆ¶å’Œå¼‚æ­¥å¤åˆ¶</h4><p>åŒæ­¥å¤åˆ¶å’Œå¼‚æ­¥å¤åˆ¶åœ¨ RocketMQ ä¸­æŒ‡çš„æ˜¯ä¸»ä»Brokerä¹‹é—´çš„æ•°æ®å¤åˆ¶æ–¹å¼ï¼Œè¿™ç›´æ¥å½±å“æ¶ˆæ¯çš„å¯é æ€§å’Œç³»ç»Ÿçš„å¯ç”¨æ€§ã€‚è¿™ä¸¤ç§å¤åˆ¶ç­–ç•¥åœ¨ä¿è¯æ•°æ®ä¸€è‡´æ€§å’Œæé«˜ç³»ç»Ÿæ€§èƒ½ä¹‹é—´æä¾›äº†ä¸åŒçš„å¹³è¡¡ç‚¹ã€‚ä»¥ä¸‹æ˜¯å¯¹è¿™ä¸¤ç§ç­–ç•¥çš„è¯¦ç»†è¯´æ˜å’Œæ¯”è¾ƒï¼š</p><blockquote><p>åŒæ­¥å¤åˆ¶ï¼ˆåŒæ­¥åŒå†™ï¼‰</p></blockquote><ul><li><strong>å·¥ä½œåŸç†</strong>ï¼šåœ¨åŒæ­¥å¤åˆ¶æ¨¡å¼ä¸‹ï¼Œå½“æ¶ˆæ¯è¢«å†™å…¥ä¸»Brokeråï¼Œå®ƒå¿…é¡»åŒæ—¶è¢«å¤åˆ¶åˆ°ä»Brokerä¸Šã€‚åªæœ‰å½“æ¶ˆæ¯åœ¨ä¸»ä»Brokerä¸Šéƒ½æˆåŠŸå†™å…¥åï¼Œæ‰å‘ç”Ÿäº§è€…è¿”å›å†™å…¥æˆåŠŸçš„ç¡®è®¤ã€‚</li><li><strong>ä¼˜ç‚¹</strong>ï¼šæé«˜äº†æ•°æ®çš„å¯é æ€§ã€‚å³ä½¿ä¸»Brokerå®•æœºï¼Œä»Brokerä¸Šä»ç„¶æœ‰æ¶ˆæ¯çš„å®Œæ•´å‰¯æœ¬ã€‚</li><li><strong>ç¼ºç‚¹</strong>ï¼šå½±å“æ€§èƒ½ã€‚ç”±äºæ¶ˆæ¯å†™å…¥æ“ä½œéœ€è¦åœ¨ä¸»ä»Brokerä¸Šéƒ½å®Œæˆï¼Œè¿™å¯èƒ½å¯¼è‡´è¾ƒé«˜çš„å»¶è¿Ÿå’Œé™ä½ååé‡ã€‚</li><li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šé€‚ç”¨äºå¯¹æ•°æ®å¯é æ€§è¦æ±‚æé«˜çš„åœºæ™¯ï¼Œå¦‚é‡‘èäº¤æ˜“ã€‚</li></ul><blockquote><p>å¼‚æ­¥å¤åˆ¶</p></blockquote><ul><li><strong>å·¥ä½œåŸç†</strong>ï¼šåœ¨å¼‚æ­¥å¤åˆ¶æ¨¡å¼ä¸‹ï¼Œå½“æ¶ˆæ¯å†™å…¥ä¸»Brokerä¹‹åï¼Œç³»ç»Ÿå°±ç›´æ¥è¿”å›å†™å…¥æˆåŠŸã€‚æ¶ˆæ¯çš„å¤åˆ¶åˆ°ä»Brokeræ˜¯å¼‚æ­¥è¿›è¡Œçš„ã€‚</li><li><strong>ä¼˜ç‚¹</strong>ï¼šæé«˜äº†æ€§èƒ½ã€‚ç”±äºä¸éœ€è¦ç­‰å¾…ä»Brokerç¡®è®¤ï¼Œæ¶ˆæ¯çš„å†™å…¥å’Œç¡®è®¤é€Ÿåº¦æ›´å¿«ã€‚</li><li><strong>ç¼ºç‚¹</strong>ï¼šå¯èƒ½å­˜åœ¨æ•°æ®ä¸ä¸€è‡´çš„é£é™©ã€‚å¦‚æœä¸»Brokeråœ¨æ•°æ®å¤åˆ¶å®Œæˆå‰å®•æœºï¼Œä»Brokerå¯èƒ½ç¼ºå°‘æœ€æ–°çš„æ•°æ®ã€‚</li><li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šé€‚ç”¨äºå¯¹æ€§èƒ½è¦æ±‚è¾ƒé«˜ï¼Œä½†æ•°æ®å¯é æ€§è¦æ±‚ä¸æ˜¯æç«¯ä¸¥æ ¼çš„åœºæ™¯ã€‚</li></ul><blockquote><p>å¯ç”¨æ€§ä¸é¡ºåºæ€§çš„è€ƒè™‘</p></blockquote><ul><li><strong>å¯ç”¨æ€§é—®é¢˜</strong>ï¼šç”±äºRocketMQä¸æ”¯æŒè‡ªåŠ¨ä¸»ä»åˆ‡æ¢ï¼Œå¦‚æœä¸»Brokerå®•æœºï¼Œæ•´ä¸ªç³»ç»Ÿå°†æ— æ³•ç»§ç»­ç”Ÿäº§æ¶ˆæ¯ã€‚è™½ç„¶æ¶ˆè´¹è€…å¯ä»¥ä»ä»Brokeræ¶ˆè´¹æ¶ˆæ¯ï¼Œä½†åœ¨ä¸»Brokerå®•æœºæœŸé—´ä¼šå­˜åœ¨çŸ­æš‚çš„ä¸»ä»æ•°æ®ä¸ä¸€è‡´æƒ…å†µã€‚</li><li><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šé€šè¿‡éƒ¨ç½²å¤šä¸ªä¸»ä»é›†ç¾¤ï¼ˆå¤šBrokeræ¶æ„ï¼‰æ¥æé«˜å¯ç”¨æ€§ã€‚æ¯ä¸ªTopicåˆ†å¸ƒåœ¨ä¸åŒçš„Brokerä¸­ï¼Œå¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šè§£å†³å•ä¸ªBrokerå®•æœºé—®é¢˜ã€‚</li><li><strong>é¡ºåºæ€§é—®é¢˜</strong>ï¼šåœ¨å¤šBrokeræ¶æ„ä¸‹ï¼Œå¦‚æœæŸä¸ªä¸»Brokerè´Ÿè´£ç‰¹å®šé¡ºåºæ¶ˆæ¯å®•æœºï¼Œå…¶ä»–Brokeræ— æ³•æ›¿ä»£å®ƒå¤„ç†è¿™äº›æ¶ˆæ¯ï¼Œå¯èƒ½å½±å“æ¶ˆæ¯çš„é¡ºåºæ€§ã€‚</li><li><strong>Dledger</strong>ï¼šRocketMQé€šè¿‡å¼•å…¥DledgeræŠ€æœ¯ï¼Œæ”¯æŒåŠæ•°ä»¥ä¸ŠèŠ‚ç‚¹çš„æ¶ˆæ¯å¤åˆ¶åæ‰ç¡®è®¤å†™å…¥æˆåŠŸï¼Œå¹¶æ”¯æŒä¸»èŠ‚ç‚¹çš„åŠ¨æ€é€‰ä¸¾ï¼Œè§£å†³äº†ä¸¥æ ¼é¡ºåºæ€§å’Œé«˜å¯ç”¨æ€§çš„é—®é¢˜ã€‚</li></ul><p>åŒæ­¥å¤åˆ¶å’Œå¼‚æ­¥å¤åˆ¶åœ¨RocketMQä¸­æä¾›äº†ä¸åŒçš„æ•°æ®ä¸€è‡´æ€§å’Œæ€§èƒ½å¹³è¡¡ã€‚åœ¨è®¾è®¡ç³»ç»Ÿæ—¶ï¼Œéœ€è¦æ ¹æ®ä¸šåŠ¡éœ€æ±‚çš„å…·ä½“æƒ…å†µé€‰æ‹©åˆé€‚çš„å¤åˆ¶ç­–ç•¥ã€‚</p><p>Dledgerä½œä¸ºä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œè™½ç„¶æé«˜äº†å¯ç”¨æ€§å’Œé¡ºåºæ€§ä¿è¯ï¼Œä½†åœ¨é€‰ä¸¾è¿‡ç¨‹ä¸­å¯èƒ½ä¼šæš‚æ—¶æ— æ³•æä¾›æœåŠ¡ï¼Œå¹¶ä¸”å¯¹èŠ‚ç‚¹çš„æ•°é‡æœ‰ä¸€å®šè¦æ±‚ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œéœ€ç»¼åˆè€ƒè™‘ä¸šåŠ¡åœºæ™¯çš„ç‰¹æ€§å’Œå¯¹æ•°æ®å¯é æ€§ã€ç³»ç»Ÿæ€§èƒ½çš„å…·ä½“éœ€æ±‚æ¥å†³å®šä½¿ç”¨å“ªç§å¤åˆ¶ç­–ç•¥ã€‚</p><h4 id="å­˜å‚¨æœºåˆ¶"><a href="#å­˜å‚¨æœºåˆ¶" class="headerlink" title="å­˜å‚¨æœºåˆ¶"></a>å­˜å‚¨æœºåˆ¶</h4><p>RocketMQ çš„å­˜å‚¨æœºåˆ¶é‡‡ç”¨æ··åˆå‹ç»“æ„ï¼Œä¼˜åŒ–äº†æ•°æ®çš„å†™å…¥æ•ˆç‡å’Œè¯»å–æ•ˆç‡ã€‚è¿™ç§è®¾è®¡æ¶‰åŠåˆ°ä¸‰ä¸ªå…³é”®ç»„ä»¶ï¼šCommitLogã€ConsumeQueue å’Œ IndexFileã€‚</p><p>ä»¥ä¸‹æ˜¯è¿™äº›ç»„ä»¶çš„åŠŸèƒ½å’Œå®ƒä»¬åœ¨æ•´ä¸ªå­˜å‚¨ç»“æ„ä¸­çš„ä½œç”¨ï¼š</p><blockquote><p>CommitLog   æ ¸å¿ƒæ–‡ä»¶</p></blockquote><ul><li><strong>åŠŸèƒ½</strong>ï¼šCommitLog æ˜¯æ¶ˆæ¯å­˜å‚¨çš„æ ¸å¿ƒæ–‡ä»¶ï¼Œå®ƒå­˜å‚¨äº†ç”Ÿäº§è€…å†™å…¥çš„æ¶ˆæ¯ä¸»ä½“å†…å®¹åŠå…¶å…ƒæ•°æ®ã€‚</li><li><strong>å­˜å‚¨ç»“æ„</strong>ï¼šCommitLog æ–‡ä»¶çš„å¤§å°é»˜è®¤ä¸º1GBï¼Œæ–‡ä»¶å‘½ååŸºäºèµ·å§‹åç§»é‡ï¼Œä¾‹å¦‚ <code>00000000001073741824</code>ã€‚</li><li><strong>å†™å…¥æ–¹å¼</strong>ï¼šæ¶ˆæ¯ä¸»è¦æ˜¯é¡ºåºå†™å…¥CommitLogæ–‡ä»¶ï¼Œæé«˜äº†å†™å…¥æ•ˆç‡ã€‚å½“ä¸€ä¸ªæ–‡ä»¶å†™æ»¡åï¼Œå†™å…¥ä¼šç»§ç»­åœ¨ä¸‹ä¸€ä¸ªæ–‡ä»¶ã€‚</li></ul><blockquote><p>ConsumeQueue   ç´¢å¼•æ–‡ä»¶</p></blockquote><ul><li><strong>åŠŸèƒ½</strong>ï¼šConsumeQueue ä½œä¸ºæ¶ˆè´¹æ¶ˆæ¯çš„ç´¢å¼•ï¼Œæå‡è¯»å–æ•ˆç‡ã€‚</li><li><strong>ç»“æ„</strong>ï¼šConsumeQueue ä¿å­˜äº†ç‰¹å®šTopicä¸‹é˜Ÿåˆ—æ¶ˆæ¯åœ¨CommitLogä¸­çš„èµ·å§‹ç‰©ç†åç§»é‡ã€æ¶ˆæ¯å¤§å°å’Œæ¶ˆæ¯Tagçš„HashCodeå€¼ã€‚</li><li><strong>å­˜å‚¨è·¯å¾„</strong>ï¼šé‡‡ç”¨ <code>topic/queue/file</code> çš„ä¸‰å±‚ç»„ç»‡ç»“æ„ï¼Œæ–‡ä»¶è·¯å¾„ä¸º <code>$HOME/store/consumequeue/&#123;topic&#125;/&#123;queueId&#125;/&#123;fileName&#125;</code>ã€‚</li><li><strong>æ¡ç›®ç»„ç»‡</strong>ï¼šæ¯ä¸ªæ¡ç›®å›ºå®š20å­—èŠ‚ï¼ŒåŒ…æ‹¬commitlogçš„ç‰©ç†åç§»é‡ã€æ¶ˆæ¯é•¿åº¦å’Œtag hashcodeï¼Œå…è®¸åƒæ•°ç»„ä¸€æ ·éšæœºè®¿é—®æ¯ä¸ªæ¡ç›®ã€‚</li></ul><blockquote><p>IndexFile</p></blockquote><ul><li><strong>åŠŸèƒ½</strong>ï¼šæä¾›äº†é€šè¿‡keyæˆ–æ—¶é—´åŒºé—´æŸ¥è¯¢æ¶ˆæ¯çš„èƒ½åŠ›ï¼Œä½†ä¸æ¶‰åŠæ¶ˆæ¯çš„ä¸»ä½“å†…å®¹ã€‚</li></ul><p>å­˜å‚¨æœºåˆ¶çš„ç‰¹ç‚¹</p><ul><li><strong>é«˜æ•ˆå†™å…¥</strong>ï¼šä¸åˆ†Topicåœ°é¡ºåºå†™å…¥CommitLogï¼Œå¢åŠ äº†å†™å…¥æ•ˆç‡ã€‚</li><li><strong>ç´¢å¼•ä¼˜åŒ–</strong>ï¼šä½¿ç”¨ConsumeQueueä½œä¸ºç´¢å¼•æ–‡ä»¶ï¼ŒåŠ å¿«äº†åŸºäºTopicçš„æ¶ˆæ¯æ£€ç´¢å’Œæ¶ˆè´¹ã€‚</li><li><strong>æ–‡ä»¶å¤§å°</strong>ï¼šCommitLogæ–‡ä»¶è®¾è®¡æˆå›ºå®šå¤§å°ä¸»è¦æ˜¯ä¸ºäº†æ”¯æŒå†…å­˜æ˜ å°„æœºåˆ¶ï¼Œæé«˜æ–‡ä»¶æ“ä½œçš„æ•ˆç‡ã€‚</li></ul><p>è¯»å–æµç¨‹</p><ul><li>ç”Ÿäº§è€…å‘é€æ¶ˆæ¯æ—¶æŒ‡å®šTopicå’ŒQueueIdï¼Œæ¶ˆæ¯è¢«é¡ºåºå­˜å‚¨åˆ°CommitLogã€‚</li><li>ç›¸åº”çš„ç´¢å¼•ä¿¡æ¯ï¼ˆåç§»é‡ã€å¤§å°ã€tag hashï¼‰è¢«å­˜å…¥å¯¹åº”Topicå’ŒQueueIdçš„ConsumeQueueæ–‡ä»¶ã€‚</li><li>æ¶ˆè´¹è€…æ ¹æ®æ¶ˆè´¹åç§»é‡ï¼ˆConsumeOffsetï¼‰åœ¨ConsumeQueueä¸­æ£€ç´¢ä¸‹ä¸€æ¡æ¶ˆæ¯çš„ä½ç½®ï¼Œç„¶åæ ¹æ®CommitLogä¸­çš„ä½ç½®æ‰¾åˆ°å®é™…æ¶ˆæ¯ã€‚</li></ul><p>RocketMQçš„å­˜å‚¨æ¶æ„é€šè¿‡å°†æ‰€æœ‰æ¶ˆæ¯é¡ºåºå­˜å‚¨åœ¨ä¸€ä¸ªå…±äº«çš„CommitLogæ–‡ä»¶å¹¶ä½¿ç”¨ConsumeQueueå’ŒIndexFileä½œä¸ºç´¢å¼•æ–‡ä»¶æ¥å®ç°é«˜æ•ˆçš„æ¶ˆæ¯è¯»å†™ã€‚</p><p>è¿™ç§è®¾è®¡åœ¨æé«˜å†™å…¥æ•ˆç‡çš„åŒæ—¶ï¼Œé€šè¿‡ç´¢å¼•æœºåˆ¶åŠ å¿«äº†æ¶ˆæ¯çš„æ£€ç´¢å’Œæ¶ˆè´¹é€Ÿåº¦ã€‚<br>ä¸Kafkaçš„æ¯ä¸ªTopicç‹¬ç«‹å­˜å‚¨æ–‡ä»¶ç›¸æ¯”ï¼ŒRocketMQçš„è¿™ç§æ··åˆå‹å­˜å‚¨ç»“æ„æ›´æ³¨é‡å†™å…¥æ•ˆç‡å’Œçµæ´»çš„è¯»å–æ“ä½œã€‚</p><blockquote><p><code>IndexFile</code> å’Œ <code>ConsumeQueue</code> çš„åŒºåˆ«</p></blockquote><p>åœ¨ RocketMQ ä¸­ï¼Œ<code>IndexFile</code> å’Œ <code>ConsumeQueue</code> éƒ½æ˜¯æ¶ˆæ¯å­˜å‚¨ç»“æ„çš„é‡è¦éƒ¨åˆ†ï¼Œä½†å®ƒä»¬çš„ç”¨é€”å’Œå·¥ä½œæ–¹å¼æœ‰æ‰€ä¸åŒã€‚</p><p>ç†è§£è¿™ä¸¤è€…ä¹‹é—´çš„åŒºåˆ«æœ‰åŠ©äºæ›´å¥½åœ°æŠŠæ¡ RocketMQ çš„æ¶ˆæ¯å­˜å‚¨å’Œæ£€ç´¢æœºåˆ¶ã€‚</p><p>ä»¥ä¸‹æ˜¯å¯¹ <code>IndexFile</code> å’Œ <code>ConsumeQueue</code> çš„ä¸»è¦åŒºåˆ«çš„æ¦‚è¿°ï¼š</p><blockquote><p>ConsumeQueue</p></blockquote><ul><li><strong>ç›®çš„</strong>ï¼š<code>ConsumeQueue</code> ä½œä¸ºæ¶ˆè´¹æ¶ˆæ¯çš„ç´¢å¼•ï¼Œå…¶ä¸»è¦ç›®çš„æ˜¯åŠ å¿«æ¶ˆæ¯æ¶ˆè´¹çš„æ•ˆç‡ã€‚</li><li><strong>å†…å®¹</strong>ï¼šå®ƒä¿å­˜äº†ç‰¹å®š Topic ä¸‹çš„é˜Ÿåˆ—æ¶ˆæ¯åœ¨ <code>CommitLog</code> ä¸­çš„èµ·å§‹ç‰©ç†åç§»é‡ã€æ¶ˆæ¯å¤§å°å’Œæ¶ˆæ¯ Tag çš„ HashCode å€¼ã€‚</li><li><strong>ç»“æ„</strong>ï¼š<code>ConsumeQueue</code> æ–‡ä»¶æ˜¯å®šé•¿è®¾è®¡ï¼Œæ¯ä¸ªæ¡ç›®åŒ…å«äº†æ¶ˆæ¯åœ¨ <code>CommitLog</code> çš„åç§»é‡ã€é•¿åº¦å’Œ Tag HashCodeï¼Œä½¿å¾—æ¶ˆè´¹è€…èƒ½å¤Ÿå¿«é€Ÿå®šä½æ¶ˆæ¯ã€‚</li><li><strong>ä½¿ç”¨</strong>ï¼šæ¶ˆè´¹è€…ä½¿ç”¨ <code>ConsumeQueue</code> æ¥å¿«é€ŸæŸ¥æ‰¾å¾…æ¶ˆè´¹çš„æ¶ˆæ¯ï¼Œæœ‰æ•ˆæå‡äº†æ¶ˆæ¯æ¶ˆè´¹çš„é€Ÿåº¦å’Œæ•ˆç‡ã€‚</li></ul><blockquote><p>IndexFile</p></blockquote><ul><li><strong>ç›®çš„</strong>ï¼š<code>IndexFile</code> çš„ä¸»è¦ä½œç”¨æ˜¯æä¾›ä¸€ç§åŸºäº key æˆ–æ—¶é—´åŒºé—´æ¥å¿«é€ŸæŸ¥è¯¢æ¶ˆæ¯çš„æ–¹æ³•ã€‚</li><li><strong>å†…å®¹</strong>ï¼šå®ƒåˆ›å»ºäº†æ¶ˆæ¯å±æ€§ï¼ˆå¦‚æ¶ˆæ¯çš„å”¯ä¸€æ ‡è¯†ç¬¦æˆ–ä¸šåŠ¡é”®ï¼‰çš„ç´¢å¼•ï¼Œä»¥åŠæ¶ˆæ¯åœ¨ <code>CommitLog</code> ä¸­çš„ç‰©ç†åç§»é‡ã€‚</li><li><strong>ç»“æ„</strong>ï¼š<code>IndexFile</code> ä¸æ˜¯é’ˆå¯¹ç‰¹å®š Topic æˆ–é˜Ÿåˆ—çš„ï¼Œè€Œæ˜¯ä¸ºäº†æä¾›è·¨æ‰€æœ‰æ¶ˆæ¯çš„å¿«é€ŸæŸ¥æ‰¾åŠŸèƒ½ã€‚</li><li><strong>ä½¿ç”¨</strong>ï¼šå½“éœ€è¦æ ¹æ®ç‰¹å®šå…³é”®å­—æˆ–è€…æ—¶é—´åŒºé—´æŸ¥è¯¢æ¶ˆæ¯æ—¶ï¼Œ<code>IndexFile</code> èƒ½å¤Ÿå¿«é€Ÿå®šä½è¿™äº›æ¶ˆæ¯ã€‚</li></ul><p>åŒºåˆ«ï¼š</p><ul><li><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼š<code>ConsumeQueue</code> æ˜¯ä¸ºäº†ä¼˜åŒ–æ¶ˆæ¯æ¶ˆè´¹è¿‡ç¨‹è€Œè®¾è®¡çš„ï¼Œè€Œ <code>IndexFile</code> åˆ™æ˜¯ä¸ºäº†æä¾›ä¸€ç§çµæ´»çš„æ¶ˆæ¯æŸ¥è¯¢æœºåˆ¶ã€‚</li><li><strong>æ•°æ®å†…å®¹</strong>ï¼š<code>ConsumeQueue</code> ä¾§é‡äºæ¶ˆæ¯æ¶ˆè´¹çš„å¿«é€Ÿå®šä½ï¼Œè€Œ <code>IndexFile</code> ä¾§é‡äºæä¾›åŸºäºå…³é”®å­—å’Œæ—¶é—´çš„å¿«é€Ÿæ£€ç´¢ã€‚</li><li><strong>ç»“æ„è®¾è®¡</strong>ï¼š<code>ConsumeQueue</code> æ˜¯åŸºäº Topic çš„é€»è¾‘æ¶ˆè´¹é˜Ÿåˆ—ï¼Œæ¯ä¸ªæ¡ç›®æŒ‡å‘ <code>CommitLog</code> ä¸­çš„ç‰¹å®šæ¶ˆæ¯ï¼›è€Œ <code>IndexFile</code> æ˜¯ä¸€ä¸ªå…¨å±€ç´¢å¼•ï¼Œå…è®¸æ ¹æ®ä¸åŒçš„æŸ¥è¯¢æ¡ä»¶æ‰¾åˆ°æ¶ˆæ¯ã€‚</li></ul><hr><h3 id="11ã€RocketMQ-å¦‚ä½•ä¿è¯ä¸ä¸¢å¤±æ¶ˆæ¯"><a href="#11ã€RocketMQ-å¦‚ä½•ä¿è¯ä¸ä¸¢å¤±æ¶ˆæ¯" class="headerlink" title="11ã€RocketMQ å¦‚ä½•ä¿è¯ä¸ä¸¢å¤±æ¶ˆæ¯"></a>11ã€RocketMQ å¦‚ä½•ä¿è¯ä¸ä¸¢å¤±æ¶ˆæ¯</h3><p>RocketMQ é‡‡ç”¨äº†å¤šç§æœºåˆ¶æ¥ç¡®ä¿æ¶ˆæ¯çš„å¯é æ€§ï¼Œé˜²æ­¢æ¶ˆæ¯ä¸¢å¤±ã€‚</p><p>ä»¥ä¸‹æ˜¯ RocketMQ å®ç°æ¶ˆæ¯ä¸ä¸¢å¤±çš„ä¸»è¦æ–¹æ³•ï¼š</p><ul><li><ol><li>æ¶ˆæ¯æŒä¹…åŒ–</li></ol></li><li><ol start="2"><li>é«˜å¯ç”¨æ€§è®¾è®¡</li></ol></li><li><ol start="3"><li>æ¶ˆæ¯é‡è¯•æœºåˆ¶</li></ol></li><li><ol start="5"><li>äº‹åŠ¡æ¶ˆæ¯</li></ol></li><li><ol start="6"><li>åŒæ­¥å¤åˆ¶</li></ol></li><li><ol start="7"><li>æ¶ˆæ¯ç¡®è®¤æœºåˆ¶</li></ol></li></ul><blockquote><ol><li>æ¶ˆæ¯æŒä¹…åŒ–</li></ol></blockquote><ul><li><strong>ç£ç›˜å­˜å‚¨</strong>ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰æ¶ˆæ¯åœ¨è¢«æ¶ˆè´¹ä¹‹å‰éƒ½ä¼šè¢«æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œç¡®ä¿å³ä½¿åœ¨å‘ç”Ÿç³»ç»Ÿå´©æºƒçš„æƒ…å†µä¸‹ä¹Ÿä¸ä¼šä¸¢å¤±æ¶ˆæ¯ã€‚</li><li><strong>åŒæ­¥å’Œå¼‚æ­¥åˆ·ç›˜</strong>ï¼šæä¾›äº†åŒæ­¥åˆ·ç›˜å’Œå¼‚æ­¥åˆ·ç›˜ä¸¤ç§æ¨¡å¼ã€‚åŒæ­¥åˆ·ç›˜æä¾›æ›´é«˜çš„æ¶ˆæ¯å¯é æ€§ï¼Œè€Œå¼‚æ­¥åˆ·ç›˜åˆ™æä¾›æ›´é«˜çš„æ€§èƒ½ã€‚</li></ul><blockquote><ol start="2"><li>é«˜å¯ç”¨æ€§è®¾è®¡</li></ol></blockquote><ul><li><strong>ä¸»ä»æ¶æ„</strong>ï¼šé€šè¿‡éƒ¨ç½²å¤šä¸ªBrokerå®ä¾‹ï¼ˆåŒ…æ‹¬ä¸»Brokerå’Œä»Brokerï¼‰ï¼Œå¹¶ä½¿ç”¨æ•°æ®å¤åˆ¶æœºåˆ¶æ¥ç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§å’Œå¯é æ€§ã€‚</li><li><strong>æ•…éšœè‡ªåŠ¨è½¬ç§»</strong>ï¼šå¦‚æœä¸»Brokerå®•æœºï¼Œä»Brokerå¯ä»¥è‡ªåŠ¨æ¥ç®¡ï¼Œä¿è¯æœåŠ¡çš„æŒç»­å¯ç”¨æ€§ã€‚</li></ul><blockquote><ol start="3"><li>æ¶ˆæ¯é‡è¯•æœºåˆ¶</li></ol></blockquote><ul><li><strong>æ¶ˆè´¹è€…é‡è¯•</strong>ï¼šå¦‚æœæ¶ˆè´¹è€…å¤„ç†æ¶ˆæ¯å¤±è´¥ï¼ŒRocketMQ æä¾›äº†æ¶ˆæ¯é‡è¯•æœºåˆ¶ï¼Œå…è®¸æ¶ˆè´¹è€…åœ¨ä¸€å®šæ—¶é—´åé‡æ–°å°è¯•å¤„ç†æ¶ˆæ¯ã€‚</li></ul><blockquote><ol start="4"><li>æ­»ä¿¡é˜Ÿåˆ—</li></ol></blockquote><ul><li><strong>æ­»ä¿¡å¤„ç†</strong>ï¼šå¯¹äºå¤šæ¬¡é‡è¯•ä»ç„¶å¤±è´¥çš„æ¶ˆæ¯ï¼Œå¯ä»¥è¢«å‘é€åˆ°æ­»ä¿¡é˜Ÿåˆ—ã€‚è¿™æ ·åšå¯ä»¥é¿å…ä¸€ç›´é‡è¯•æ— æ³•å¤„ç†çš„æ¶ˆæ¯ï¼ŒåŒæ—¶ä¿ç•™è¿™äº›æ¶ˆæ¯ä»¥ä¾¿åç»­åˆ†æå’Œå¤„ç†ã€‚</li></ul><blockquote><ol start="5"><li>äº‹åŠ¡æ¶ˆæ¯</li></ol></blockquote><ul><li><strong>åŠæ¶ˆæ¯å’Œäº‹åŠ¡å›æŸ¥</strong>ï¼šå¯¹äºéœ€è¦äº‹åŠ¡æ”¯æŒçš„åœºæ™¯ï¼ŒRocketMQ æä¾›äº†äº‹åŠ¡æ¶ˆæ¯åŠŸèƒ½ã€‚è¿™åŒ…æ‹¬å‘é€åŠæ¶ˆæ¯å’Œåœ¨å¿…è¦æ—¶è¿›è¡Œäº‹åŠ¡çŠ¶æ€çš„å›æŸ¥ï¼Œä»¥ä¿è¯äº‹åŠ¡çš„ä¸€è‡´æ€§ã€‚</li></ul><blockquote><ol start="6"><li>åŒæ­¥å¤åˆ¶</li></ol></blockquote><ul><li><strong>æ•°æ®å¤åˆ¶</strong>ï¼šåœ¨ä¸»ä»æ¶æ„ä¸­ï¼Œå¯ä»¥é…ç½®æ•°æ®åŒæ­¥å¤åˆ¶ï¼Œç¡®ä¿ä»Brokerå®æ—¶å¤åˆ¶ä¸»Brokerçš„æ•°æ®ã€‚</li></ul><blockquote><ol start="7"><li>æ¶ˆæ¯ç¡®è®¤æœºåˆ¶</li></ol></blockquote><ul><li><strong>ç”Ÿäº§è€…ç¡®è®¤</strong>ï¼šç”Ÿäº§è€…å¯ä»¥ç­‰å¾…Brokerçš„ç¡®è®¤å›åº”ï¼Œä»¥ç¡®ä¿æ¶ˆæ¯å·²ç»æˆåŠŸå­˜å‚¨åœ¨Brokerä¸Šã€‚</li><li><strong>æ¶ˆè´¹è€…ç¡®è®¤</strong>ï¼šæ¶ˆè´¹è€…åœ¨å¤„ç†å®Œæ¶ˆæ¯åå‘é€ç¡®è®¤ï¼Œç¡®ä¿æ¶ˆæ¯ä¸ä¼šè¢«é‡å¤æŠ•é€’ã€‚</li></ul><hr><p>å‚è€ƒ</p><ul><li><a href="https://rocketmq.apache.org/docs/quickStart/01quickstart">https://rocketmq.apache.org/docs/quickStart/01quickstart</a></li><li><a href="https://rocketmq.apache.org/zh/docs/quickStart/01quickstart/">https://rocketmq.apache.org/zh/docs/quickStart/01quickstart/</a></li><li><a href="https://developer.aliyun.com/article/788183">https://developer.aliyun.com/article/788183</a></li><li><a href="https://javaguide.cn/high-performance/message-queue/rocketmq-questions.html">https://javaguide.cn/high-performance/message-queue/rocketmq-questions.html</a></li><li><a href="https://juejin.cn/post/7134227366481494046">https://juejin.cn/post/7134227366481494046</a></li><li><a href="https://b23.tv/GneHu8S">https://b23.tv/GneHu8S</a></li><li><a href="https://juejin.cn/post/6844904099993878536">https://juejin.cn/post/6844904099993878536</a></li><li><a href="https://doocs.github.io/advanced-java/#/docs/high-concurrency/how-to-ensure-high-availability-of-message-queues">https://doocs.github.io/advanced-java/#/docs/high-concurrency/how-to-ensure-high-availability-of-message-queues</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>ä¸­é—´ä»¶</category>
      
      <category>MQ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MQ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç™½æ¿æ“¦</title>
    <link href="/2023/12/26/%E7%99%BD%E6%9D%BF%E6%93%A6/"/>
    <url>/2023/12/26/%E7%99%BD%E6%9D%BF%E6%93%A6/</url>
    
    <content type="html"><![CDATA[<p>ä»Šæ—¥è®¡åˆ’</p><ul><li><input disabled="" type="checkbox"> è¿‡ä¸€ä¸‹é¢è¯•é¢˜ï¼Œå‡†å¤‡ä¸€ä¸‹å…«è‚¡ï¼ˆä¸»è¦æ ¹æ®é¢è¯•æŒ‡åŒ—å’ŒJavaé¢è¯•åº“å­¦ä¹ ï¼‰</li><li><input disabled="" type="checkbox"> å®Œå–„çŸ¥è¯†åº“å†…å®¹</li><li><input disabled="" type="checkbox"> é€šè¿‡è¾“å‡ºå€’é€¼è¾“å…¥</li></ul>]]></content>
    
    
    <categories>
      
      <category>Diary</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Fluidä¸»é¢˜</title>
    <link href="/2023/12/26/Fluid%E4%B8%BB%E9%A2%98/"/>
    <url>/2023/12/26/Fluid%E4%B8%BB%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<p>to be continedâ€¦</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://hexo.fluid-dev.com/docs/start/">https://hexo.fluid-dev.com/docs/start/</a></li><li><a href="https://hexo.fluid-dev.com/">https://hexo.fluid-dev.com/</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>StatusPage</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ¡†æ¶å­¦ä¹ _MyBatis-Plusä½¿ç”¨</title>
    <link href="/2023/12/25/%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A0_MyBatis-Plus%E4%BD%BF%E7%94%A8/"/>
    <url>/2023/12/25/%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A0_MyBatis-Plus%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<p>to be continedâ€¦</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://caochenlei.blog.csdn.net/article/details/108809902">https://caochenlei.blog.csdn.net/article/details/108809902</a></li><li><a href="https://caochenlei.blog.csdn.net/article/details/108281646?spm=1001.2014.3001.5502&ydreferer=aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NDkwNDU3Lz90eXBlPWJsb2c=">https://caochenlei.blog.csdn.net/article/details/108281646?spm=1001.2014.3001.5502&amp;ydreferer=aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM4NDkwNDU3Lz90eXBlPWJsb2c%3D</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>æ¡†æ¶</category>
      
      <category>MyBatis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Rediså…¥é—¨_Rediså®æˆ˜ç¯‡</title>
    <link href="/2023/12/25/Redis%E5%85%A5%E9%97%A8_Redis%E5%AE%9E%E6%88%98%E7%AF%87/"/>
    <url>/2023/12/25/Redis%E5%85%A5%E9%97%A8_Redis%E5%AE%9E%E6%88%98%E7%AF%87/</url>
    
    <content type="html"><![CDATA[<h2 id="Redis-å®æˆ˜ç¯‡"><a href="#Redis-å®æˆ˜ç¯‡" class="headerlink" title="Redis å®æˆ˜ç¯‡"></a>Redis å®æˆ˜ç¯‡</h2><h3 id="1ã€Redis-åˆ†å¸ƒå¼é”"><a href="#1ã€Redis-åˆ†å¸ƒå¼é”" class="headerlink" title="1ã€Redis åˆ†å¸ƒå¼é”"></a>1ã€Redis åˆ†å¸ƒå¼é”</h3><p>åˆ†å¸ƒå¼é”çš„å®ç°å¸¸è§çš„æœ‰ï¼š</p><ul><li>åŸºäºæ•°æ®åº“çš„é”ï¼ˆä¹è§‚é”å’Œæ‚²è§‚é”ï¼‰</li><li>åŸºäºç¼“å­˜çš„é”</li><li>åŸºäºZookeeper çš„é”ï¼ˆå¼ºä¸€è‡´æ€§ï¼‰</li><li>åŸºäºæ¶ˆæ¯é˜Ÿåˆ—çš„é”ï¼ˆå°‘è§ï¼‰</li><li>åŸºäºå…¶ä»–åˆ†å¸ƒå¼åè°ƒæœåŠ¡</li></ul><p>è¿™é‡Œä¸»è¦ä»‹ç»ä¸€ä¸‹ Redis åˆ†å¸ƒå¼é”çš„å®ç°æ–¹å¼ï¼Œä»¥åŠå®ƒæ˜¯å¦‚ä½•ä½¿ç”¨çš„ã€‚</p><p>Redis åˆ†å¸ƒå¼é”é€šè¿‡æ˜¯<strong>åˆ©ç”¨<code>SETNX</code>è¿™ä¸ªæ–¹æ³•</strong>ï¼Œå¦‚æœæ’å…¥KeyæˆåŠŸï¼Œåˆ™è¡¨ç¤ºè·å¾—åˆ°äº†é”ï¼Œå¦‚æœæœ‰äººæ’å…¥æˆåŠŸï¼Œé‚£ä¹ˆå…¶ä»–äººå°±å›æ’å…¥å¤±è´¥ï¼Œæ— æ³•è·å–åˆ°é”ï¼Œåˆ©ç”¨è¿™å¥—é€»è¾‘å®Œæˆ<code>äº’æ–¥</code>ï¼Œä»è€Œå®ç°åˆ†å¸ƒå¼é”</p><p>åœ¨ä½¿ç”¨ <code>SETNX</code>è¿™ä¸ªæ–¹æ³•çš„æ—¶å€™ï¼Œä¸€èˆ¬è¿˜ä¼šä½¿ç”¨ EXPIRE å‘½ä»¤ä¸ºé”è®¾ç½®ä¸€ä¸ªè¿‡æœŸæ—¶é—´é˜²æ­¢æ­»é”ã€‚</p><p>to be continedâ€¦..</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://cyborg2077.github.io/2022/10/22/RedisPractice/">https://cyborg2077.github.io/2022/10/22/RedisPractice/</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>ä¸­é—´ä»¶</category>
      
      <category>Redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>NoSQL</tag>
      
      <tag>redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Rediså…¥é—¨_å¸¸è§é¢è¯•é¢˜</title>
    <link href="/2023/12/25/Redis%E5%85%A5%E9%97%A8_%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    <url>/2023/12/25/Redis%E5%85%A5%E9%97%A8_%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å¸¸è§é¢è¯•é¢˜</p></blockquote><ul><li>ä¸ºä»€ä¹ˆè¦ç”¨åˆ†å¸ƒå¼ç¼“å­˜</li><li>å¸¸è§çš„ç¼“å­˜æ›´æ–°ç­–ç•¥æœ‰å“ªå‡ ç§?</li><li>Redisä¸»ä»å¤åˆ¶ï¼šä¸»ä»èŠ‚ç‚¹ä¹‹é—´å¦‚ä½•åŒæ­¥æ•°æ®ï¼Ÿ</li><li>Redis Sentinelï¼šå¦‚ä½•å®ç°è‡ªåŠ¨åŒ–åœ°æ•…éšœè½¬ç§»ï¼Ÿ</li><li>Redis Clusterï¼šç¼“å­˜çš„æ•°æ®é‡å¤ªå¤§æ€ä¹ˆåŠï¼Ÿ</li></ul><blockquote><p>Redis åŸºç¡€é¢è¯•é¢˜</p></blockquote><hr><p>å‚è€ƒ</p><ul><li><a href="https://www.yuque.com/snailclimb/mf2z3k/fg8lgc">https://www.yuque.com/snailclimb/mf2z3k/fg8lgc</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>ä¸­é—´ä»¶</category>
      
      <category>Redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>NoSQL</tag>
      
      <tag>redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MySQLå­¦ä¹ _åŸºç¡€å†…å®¹03</title>
    <link href="/2023/12/24/MySQL%E5%AD%A6%E4%B9%A0_%E5%9F%BA%E7%A1%80%E5%86%85%E5%AE%B903/"/>
    <url>/2023/12/24/MySQL%E5%AD%A6%E4%B9%A0_%E5%9F%BA%E7%A1%80%E5%86%85%E5%AE%B903/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å¤§çº²</p></blockquote><h3 id="1ã€åˆ†åº“åˆ†è¡¨"><a href="#1ã€åˆ†åº“åˆ†è¡¨" class="headerlink" title="1ã€åˆ†åº“åˆ†è¡¨"></a>1ã€åˆ†åº“åˆ†è¡¨</h3><p>MySQLçš„åˆ†è¡¨åˆ†åº“æ˜¯ä¸€ç§æ•°æ®åº“æ¶æ„è®¾è®¡æ–¹æ³•ï¼Œç”¨äºå¤„ç†å¤§è§„æ¨¡æ•°æ®å’Œé«˜å¹¶å‘è®¿é—®ã€‚</p><p>éšç€æ•°æ®é‡çš„å¢é•¿å’Œè®¿é—®é‡çš„æå‡ï¼Œå•ä¸€æ•°æ®åº“æˆ–è¡¨å¯èƒ½éš¾ä»¥æ‰¿å—å‹åŠ›ï¼Œè¿™æ—¶é€šè¿‡åˆ†è¡¨åˆ†åº“å¯ä»¥æœ‰æ•ˆåœ°æé«˜æ€§èƒ½å’Œå¯æ‰©å±•æ€§ã€‚</p><blockquote><p>åˆ†è¡¨ï¼ˆShardingï¼‰</p></blockquote><p>åˆ†è¡¨æ˜¯æŒ‡å°†ä¸€ä¸ªå¤§è¡¨æ‹†åˆ†æˆå¤šä¸ªå°è¡¨çš„è¿‡ç¨‹ã€‚</p><p>è¿™äº›å°è¡¨å¯ä»¥åˆ†å¸ƒåœ¨åŒä¸€ä¸ªæ•°æ®åº“æˆ–å¤šä¸ªæ•°æ®åº“ä¸­ã€‚åˆ†è¡¨é€šå¸¸åŸºäºæŸäº›å…³é”®å­—æ®µè¿›è¡Œï¼Œæ¯”å¦‚æ—¶é—´ã€ç”¨æˆ·IDç­‰ã€‚</p><ul><li><strong>å‚ç›´åˆ†è¡¨</strong>ï¼šå°†è¡¨ä¸­ä¸åŒçš„åˆ—åˆ†åˆ°ä¸åŒçš„è¡¨ä¸­ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªç”¨æˆ·è¡¨å¯ä»¥è¢«åˆ†æˆç”¨æˆ·åŸºç¡€ä¿¡æ¯è¡¨å’Œç”¨æˆ·è¯¦ç»†ä¿¡æ¯è¡¨ã€‚</li><li><strong>æ°´å¹³åˆ†è¡¨</strong>ï¼šæ ¹æ®è¡Œæ•°æ®å°†è¡¨åˆ†æˆå¤šä¸ªè¡¨ï¼Œæ¯ä¸ªè¡¨åŒ…å«ç›¸åŒçš„åˆ—ï¼Œä½†åªåŒ…å«éƒ¨åˆ†è¡Œã€‚ä¾‹å¦‚ï¼ŒåŸºäºç”¨æˆ·IDèŒƒå›´æˆ–åˆ›å»ºæ—¶é—´è¿›è¡Œåˆ‡åˆ†ã€‚</li></ul><blockquote><p>åˆ†åº“ï¼ˆDatabase Shardingï¼‰</p></blockquote><p>åˆ†åº“æ¶‰åŠå°†æ•°æ®åˆ†å¸ƒåˆ°å¤šä¸ªæ•°æ®åº“å®ä¾‹ä¸Šã€‚æ¯ä¸ªæ•°æ®åº“å®ä¾‹å¯ä»¥æ‰˜ç®¡åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œä»è€Œåˆ†æ•£è´Ÿè½½å’Œæé«˜å®¹é”™èƒ½åŠ›ã€‚</p><ul><li><strong>åˆ†å¸ƒå¼æ•°æ®åº“</strong>ï¼šæ•°æ®è¢«åˆ†æ•£å­˜å‚¨åœ¨å¤šä¸ªç‰©ç†ä½ç½®ï¼Œæ¯ä¸ªæ•°æ®åº“å®ä¾‹å¯ä»¥ç‹¬ç«‹å¤„ç†æŸ¥è¯¢å’Œäº‹åŠ¡ã€‚</li><li><strong>è¯»å†™åˆ†ç¦»</strong>ï¼šå¸¸ä¸åˆ†åº“ç»“åˆä½¿ç”¨ï¼Œè¯»æ“ä½œå’Œå†™æ“ä½œåˆ†åˆ«åœ¨ä¸åŒçš„æ•°æ®åº“å®ä¾‹ä¸Šè¿›è¡Œã€‚</li></ul><p>åœ¨å®ç°MySQLçš„åˆ†è¡¨åˆ†åº“æ—¶ï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨ä¸€äº›å·¥å…·å’Œä¸­é—´ä»¶ï¼Œå¦‚MyCATã€Shard-Queryç­‰ï¼Œå®ƒä»¬å¸®åŠ©ç®¡ç†å¤æ‚çš„åˆ†ç‰‡é€»è¾‘ï¼Œå¹¶å¯¹åº”ç”¨å±‚é€æ˜ã€‚</p><h3 id="2ã€ä¸»ä»å¤åˆ¶å’Œè¯»å†™åˆ†ç¦»"><a href="#2ã€ä¸»ä»å¤åˆ¶å’Œè¯»å†™åˆ†ç¦»" class="headerlink" title="2ã€ä¸»ä»å¤åˆ¶å’Œè¯»å†™åˆ†ç¦»"></a>2ã€ä¸»ä»å¤åˆ¶å’Œè¯»å†™åˆ†ç¦»</h3><p>åœ¨MySQLä¸­ï¼Œä¸»ä»å¤åˆ¶å’Œè¯»å†™åˆ†ç¦»æ˜¯ä¸¤ç§å¸¸ç”¨çš„æ¶æ„ç­–ç•¥ï¼Œç”¨äºæé«˜æ•°æ®åº“çš„å¯ç”¨æ€§ã€æ‰©å±•æ€§å’Œæ€§èƒ½ã€‚</p><h4 id="ä¸»ä»å¤åˆ¶ï¼ˆMaster-Slave-Replicationï¼‰"><a href="#ä¸»ä»å¤åˆ¶ï¼ˆMaster-Slave-Replicationï¼‰" class="headerlink" title="ä¸»ä»å¤åˆ¶ï¼ˆMaster-Slave Replicationï¼‰"></a>ä¸»ä»å¤åˆ¶ï¼ˆMaster-Slave Replicationï¼‰</h4><p>ä¸»ä»å¤åˆ¶æ˜¯ä¸€ç§æ•°æ®å¤åˆ¶çš„æ–¹æ³•ï¼Œå…¶ä¸­æ•°æ®ä»ä¸€ä¸ªä¸»æœåŠ¡å™¨ï¼ˆMasterï¼‰è‡ªåŠ¨å¤åˆ¶åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªä»æœåŠ¡å™¨ï¼ˆSlaveï¼‰ã€‚</p><p>å·¥ä½œåŸç†</p><ol><li><strong>æ—¥å¿—å¤åˆ¶</strong>ï¼šä¸»æœåŠ¡å™¨çš„æ›´æ”¹ï¼ˆå¦‚INSERTã€UPDATEã€DELETEæ“ä½œï¼‰è¢«è®°å½•åˆ°äºŒè¿›åˆ¶æ—¥å¿—ä¸­ã€‚</li><li><strong>æ—¥å¿—ä¼ è¾“</strong>ï¼šè¿™äº›æ›´æ”¹ï¼ˆæ—¥å¿—æ¡ç›®ï¼‰è¢«ä¼ è¾“åˆ°ä»æœåŠ¡å™¨ã€‚</li><li><strong>åº”ç”¨æ›´æ”¹</strong>ï¼šä»æœåŠ¡å™¨è¯»å–è¿™äº›æ—¥å¿—æ¡ç›®ï¼Œå¹¶åœ¨è‡ªå·±çš„æ•°æ®å‰¯æœ¬ä¸Šåº”ç”¨è¿™äº›æ›´æ”¹ã€‚</li></ol><p>ç›®çš„å’Œä¼˜åŠ¿ï¼š</p><ul><li><strong>æ•°æ®å¤‡ä»½</strong>ï¼šæä¾›äº†æ•°æ®å¤‡ä»½ï¼Œæœ‰åŠ©äºç¾éš¾æ¢å¤ã€‚</li><li><strong>è¯»å–è´Ÿè½½åˆ†æ•£</strong>ï¼šä»æœåŠ¡å™¨å¯ä»¥ç”¨äºè¯»å–æ“ä½œï¼Œå‡è½»ä¸»æœåŠ¡å™¨çš„è´Ÿè½½ã€‚</li><li><strong>é«˜å¯ç”¨æ€§</strong>ï¼šå¦‚æœä¸»æœåŠ¡å™¨å‡ºç°æ•…éšœï¼Œä»æœåŠ¡å™¨å¯ä»¥è¢«æå‡ä¸ºæ–°çš„ä¸»æœåŠ¡å™¨ã€‚</li></ul><p>ä¸»ä»è¾…åŠ©æ“ä½œä¸»è¦æ¶‰åŠä¸‰ä¸ªçº¿ç¨‹: binlog çº¿ç¨‹ã€I&#x2F;O çº¿ç¨‹å’Œ SQL çº¿ç¨‹ã€‚</p><ul><li><strong>binlog çº¿ç¨‹</strong> : è´Ÿè´£å°†ä¸»æœåŠ¡å™¨ä¸Šçš„æ•°æ®æ›´æ”¹å†™å…¥äºŒè¿›åˆ¶æ—¥å¿—ä¸­ã€‚</li><li><strong>I&#x2F;O çº¿ç¨‹</strong> : è´Ÿè´£ä»ä¸»æœåŠ¡å™¨ä¸Šè¯»å–äºŒè¿›åˆ¶æ—¥å¿—ï¼Œå¹¶å†™å…¥ä»æœåŠ¡å™¨çš„ä¸­ç»§æ—¥å¿—ä¸­ã€‚</li><li><strong>SQL çº¿ç¨‹</strong> : è´Ÿè´£è¯»å–ä¸­ç»§æ—¥å¿—å¹¶é‡æ”¾å…¶ä¸­çš„ SQL è¯­å¥ã€‚</li></ul><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202401041611217.png" alt="image.png"></p><h4 id="è¯»å†™åˆ†ç¦»ï¼ˆRead-Write-Splittingï¼‰"><a href="#è¯»å†™åˆ†ç¦»ï¼ˆRead-Write-Splittingï¼‰" class="headerlink" title="è¯»å†™åˆ†ç¦»ï¼ˆRead-Write Splittingï¼‰"></a>è¯»å†™åˆ†ç¦»ï¼ˆRead-Write Splittingï¼‰</h4><p>è¯»å†™åˆ†ç¦»æ¶‰åŠå°†æ•°æ®åº“çš„è¯»å–æ“ä½œï¼ˆSELECTæŸ¥è¯¢ï¼‰å’Œå†™å…¥æ“ä½œï¼ˆINSERTã€UPDATEã€DELETEï¼‰åˆ†ç¦»åˆ°ä¸åŒçš„æœåŠ¡å™¨ä¸Šã€‚</p><p>å®ç°æ–¹æ³•</p><ul><li><strong>ä¸»æœåŠ¡å™¨å¤„ç†å†™æ“ä½œ</strong>ï¼šæ‰€æœ‰æ›´æ”¹æ•°æ®çš„æ“ä½œéƒ½åœ¨ä¸»æœåŠ¡å™¨ä¸Šæ‰§è¡Œã€‚</li><li><strong>ä»æœåŠ¡å™¨å¤„ç†è¯»æ“ä½œ</strong>ï¼šæ‰€æœ‰çš„è¯»å–è¯·æ±‚éƒ½è¢«é‡å®šå‘åˆ°ä»æœåŠ¡å™¨ã€‚</li></ul><p>è¯»å†™åˆ†ç¦»å¸¸ç”¨ä»£ç†æ–¹å¼æ¥å®ç°ï¼Œä»£ç†æœåŠ¡å™¨æ¥æ”¶åº”ç”¨å±‚ä¼ æ¥çš„è¯»å†™è¯·æ±‚ï¼Œç„¶åå†³å®šè½¬å‘åˆ°å“ªä¸ªæœåŠ¡å™¨ã€‚</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202401041612689.png" alt="image.png"></p><blockquote><p>å°ç»“</p></blockquote><p>è¯»å†™åˆ†ç¦»å’Œä¸»ä»å¤åˆ¶å¯ä»¥é€šè¿‡MySQLçš„å†…ç½®åŠŸèƒ½å®ç°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹å·¥å…·å¦‚ProxySQLã€MaxScaleç­‰æ¥å¸®åŠ©ç®¡ç†ã€‚</p><p>ä¸»ä»å¤åˆ¶å’Œè¯»å†™åˆ†ç¦»æ˜¯æé«˜MySQLæ•°æ®åº“æ€§èƒ½å’Œå¯é æ€§çš„é‡è¦ç­–ç•¥ã€‚</p><p>å®ƒä»¬åœ¨å¤„ç†å¤§é‡æ•°æ®å’Œé«˜å¹¶å‘è®¿é—®çš„æƒ…å†µä¸‹å°¤å…¶æœ‰ç”¨ï¼Œä½†ä¹Ÿéœ€è¦è€ƒè™‘å…¶å¸¦æ¥çš„é¢å¤–ç®¡ç†å’Œé…ç½®å¤æ‚æ€§ã€‚</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://javaguide.cn/database/mysql/mysql-questions-01.html">https://javaguide.cn/database/mysql/mysql-questions-01.html</a></li><li><a href="https://www.pdai.tech/md/db/sql-mysql/sql-mysql-devide.html">https://www.pdai.tech/md/db/sql-mysql/sql-mysql-devide.html</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
      <category>MySQL</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mysql</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ•°æ®åº“_SQLå¸¸è§é¢è¯•é¢˜</title>
    <link href="/2023/12/24/%E6%95%B0%E6%8D%AE%E5%BA%93_SQL%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    <url>/2023/12/24/%E6%95%B0%E6%8D%AE%E5%BA%93_SQL%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<p>to be continedâ€¦</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://javaguide.cn/database/sql/sql-questions-01.html">https://javaguide.cn/database/sql/sql-questions-01.html</a></li><li><a href="https://javaguide.cn/database/sql/sql-questions-02.html">https://javaguide.cn/database/sql/sql-questions-02.html</a></li><li><a href="https://javaguide.cn/database/sql/sql-questions-03.html">https://javaguide.cn/database/sql/sql-questions-03.html</a></li><li><a href="https://javaguide.cn/database/sql/sql-questions-04.html">https://javaguide.cn/database/sql/sql-questions-04.html</a></li><li><a href="https://javaguide.cn/database/sql/sql-questions-05.html">https://javaguide.cn/database/sql/sql-questions-05.html</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
      <category>MySQL</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mysql</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ•°æ®åº“_SQLè¯­æ³•åŸºç¡€çŸ¥è¯†</title>
    <link href="/2023/12/24/%E6%95%B0%E6%8D%AE%E5%BA%93_SQL%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    <url>/2023/12/24/%E6%95%B0%E6%8D%AE%E5%BA%93_SQL%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/</url>
    
    <content type="html"><![CDATA[<p>çœ‹ä¸€ä¸‹è¿™ä¸ªï¼š <a href="https://javaguide.cn/database/sql/sql-syntax-summary.html">https://javaguide.cn/database/sql/sql-syntax-summary.html</a></p><p>to be continedâ€¦</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
      <category>MySQL</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mysql</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ•°æ®åº“_åŸºç¡€çŸ¥è¯†</title>
    <link href="/2023/12/24/%E6%95%B0%E6%8D%AE%E5%BA%93_%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    <url>/2023/12/24/%E6%95%B0%E6%8D%AE%E5%BA%93_%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/</url>
    
    <content type="html"><![CDATA[<p>æ•°æ®åº“åŸºç¡€çŸ¥è¯†åŒ…å«äº†æ•°æ®åº“è®¾è®¡ã€ç®¡ç†å’Œæ“ä½œçš„æ ¸å¿ƒæ¦‚å¿µã€‚</p><p>å¸¸è§çš„ä¸€äº›æ¦‚å¿µğŸ‘‡</p><p>æœ‰å…´è¶£ç™¾åº¦äº†è§£ä¸‹ï¼Œæˆ–è€…é€šè¿‡å‚è€ƒé“¾æ¥æ‰©å±•ä¸€ä¸‹ç›¸å…³å†…å®¹</p><ul><li>æ•°æ®åº“å’Œæ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆDBMSï¼‰</li><li>æ•°æ®æ¨¡å‹ï¼ˆå…³ç³»æ¨¡å‹ä¸éå…³ç³»æ¨¡å‹ï¼‰</li><li>æ•°æ®åº“è®¾è®¡<ul><li>ERå›¾</li><li>æ•°æ®åº“èŒƒå¼</li></ul></li><li>å…ƒç»„, ç , å€™é€‰ç , ä¸»ç , å¤–ç , ä¸»å±æ€§, éä¸»å±æ€§</li><li>ä¸»é”®å’Œå¤–é”®</li><li>ä¸ºä»€ä¹ˆä¸æ¨èä½¿ç”¨å¤–é”®ä¸çº§è”</li><li>å­˜å‚¨è¿‡ç¨‹</li><li>æ•°æ®åº“è®¾è®¡</li><li>å­—ç¬¦é›†</li></ul><h4 id="SQLï¼ˆç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€ï¼‰"><a href="#SQLï¼ˆç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€ï¼‰" class="headerlink" title="SQLï¼ˆç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€ï¼‰"></a>SQLï¼ˆç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€ï¼‰</h4><ul><li><strong>æ•°æ®å®šä¹‰è¯­è¨€ï¼ˆDDLï¼‰</strong>ï¼šå®šä¹‰æ•°æ®åº“ç»“æ„ï¼ŒåŒ…æ‹¬CREATEã€ALTERã€DROPç­‰å‘½ä»¤ã€‚</li><li><strong>æ•°æ®æ“çºµè¯­è¨€ï¼ˆDMLï¼‰</strong>ï¼šç”¨äºæ•°æ®è®¿é—®å’Œå¤„ç†ï¼ŒåŒ…æ‹¬INSERTã€UPDATEã€DELETEã€SELECTç­‰å‘½ä»¤ã€‚</li><li><strong>æ•°æ®æ§åˆ¶è¯­è¨€ï¼ˆDCLï¼‰</strong>ï¼šç”¨äºæƒé™å’Œäº‹åŠ¡æ§åˆ¶ï¼ŒåŒ…æ‹¬GRANTã€REVOKEã€BEGIN TRANSACTIONç­‰ã€‚</li></ul><h4 id="dropã€delete-ä¸-truncate-åŒºåˆ«"><a href="#dropã€delete-ä¸-truncate-åŒºåˆ«" class="headerlink" title="dropã€delete ä¸ truncate åŒºåˆ«?"></a>dropã€delete ä¸ truncate åŒºåˆ«?</h4><ul><li>drop           ç§»é™¤æ•´ä¸ªè¡¨ç»“æ„ï¼ŒåŒ…æ‹¬å…¶æ•°æ®å’Œè¡¨å®šä¹‰     ä¸èƒ½å›æ»šï¼ˆDDL)</li><li>delete         åˆ é™¤è¡¨ä¸­çš„ä¸€è¡Œæˆ–å¤šè¡Œè®°å½•      èƒ½å›æ»š(DML)</li><li>truncate      åˆ é™¤è¡¨ä¸­çš„æ‰€æœ‰è®°å½•    ä¸èƒ½å›æ»šï¼ˆDDL)</li></ul><p>æ‰§è¡Œé€Ÿåº¦ï¼šä¸€èˆ¬æ¥è¯´ï¼š<code>drop</code>Â &gt;Â <code>truncate</code>Â &gt;Â <code>delete</code></p><p>åœ¨MySQLä¸­ï¼Œ<code>DROP</code>ã€<code>DELETE</code>å’Œ<code>TRUNCATE</code>éƒ½æ˜¯ç”¨äºç§»é™¤æ•°æ®çš„å‘½ä»¤ï¼Œä½†å®ƒä»¬åœ¨ç”¨æ³•å’Œå½±å“ä¸Šæœ‰æ˜æ˜¾çš„åŒºåˆ«ï¼š</p><blockquote><ol><li>DELETE</li></ol></blockquote><ul><li><strong>ç”¨é€”</strong>ï¼š<code>DELETE</code>ç”¨äºåˆ é™¤è¡¨ä¸­çš„ä¸€è¡Œæˆ–å¤šè¡Œè®°å½•ã€‚</li><li><strong>ç‰¹ç‚¹</strong>ï¼š<ul><li>å¯ä»¥å¸¦æœ‰<code>WHERE</code>å­å¥ï¼Œæä¾›äº†æ¡ä»¶åˆ é™¤çš„åŠŸèƒ½ã€‚</li><li>å½±å“çš„è¡Œæ•°ä¼šè®°å½•åœ¨äº‹åŠ¡æ—¥å¿—ä¸­ï¼Œå› æ­¤å¯ä»¥å›æ»šã€‚</li><li>è§¦å‘å™¨ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ä¼šè¢«æ¿€æ´»ã€‚</li><li>è¾ƒæ…¢ï¼Œç‰¹åˆ«æ˜¯åœ¨åˆ é™¤å¤§é‡æ•°æ®æ—¶ï¼Œå› ä¸ºå®ƒé€è¡Œåˆ é™¤ã€‚</li></ul></li><li><strong>ç¤ºä¾‹</strong>ï¼š<code>DELETE FROM table_name WHERE condition;</code></li></ul><blockquote><ol start="2"><li>TRUNCATE</li></ol></blockquote><ul><li><strong>ç”¨é€”</strong>ï¼š<code>TRUNCATE</code>ç”¨äºåˆ é™¤è¡¨ä¸­çš„æ‰€æœ‰è®°å½•ã€‚</li><li><strong>ç‰¹ç‚¹</strong>ï¼š<ul><li>ä¸èƒ½å¸¦æœ‰<code>WHERE</code>å­å¥ï¼Œå®ƒæ€»æ˜¯åˆ é™¤è¡¨ä¸­çš„æ‰€æœ‰è®°å½•ã€‚</li><li>æ‰§è¡Œé€Ÿåº¦æ¯”<code>DELETE</code>å¿«ï¼Œå› ä¸ºå®ƒä¸é€è¡Œåˆ é™¤æ•°æ®ï¼Œè€Œæ˜¯ç›´æ¥ç§»é™¤æ•°æ®é¡µã€‚</li><li>ä¸è®°å½•è¯¦ç»†çš„äº‹åŠ¡æ—¥å¿—ï¼Œåªè®°å½•é‡å»ºç©ºè¡¨çš„æ“ä½œï¼Œå› æ­¤æ— æ³•å›æ»šï¼ˆåœ¨æŸäº›æ•°æ®åº“ç³»ç»Ÿä¸­ï¼Œ<code>TRUNCATE</code>æ˜¯äº‹åŠ¡å®‰å…¨çš„ï¼Œå¹¶ä¸”å¯ä»¥å›æ»šï¼‰ã€‚</li><li>é‡ç½®è¡¨çš„è‡ªå¢è®¡æ•°å™¨ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ã€‚</li><li>ä¸è§¦å‘è§¦å‘å™¨ã€‚</li></ul></li><li><strong>ç¤ºä¾‹</strong>ï¼š<code>TRUNCATE TABLE table_name;</code></li></ul><blockquote><ol start="3"><li>DROP</li></ol></blockquote><ul><li><strong>ç”¨é€”</strong>ï¼š<code>DROP</code>ç”¨äºç§»é™¤æ•´ä¸ªè¡¨ç»“æ„ï¼ŒåŒ…æ‹¬å…¶æ•°æ®å’Œè¡¨å®šä¹‰ã€‚</li><li><strong>ç‰¹ç‚¹</strong>ï¼š<ul><li>åˆ é™¤è¡¨çš„ç»“æ„åŠå…¶æ•°æ®ï¼Œé‡Šæ”¾å­˜å‚¨ç©ºé—´ã€‚</li><li>ä¸èƒ½å›æ»šï¼ˆä¸€æ—¦æ‰§è¡Œï¼Œè¡¨å°±å®Œå…¨æ¶ˆå¤±äº†ï¼‰ã€‚</li><li>ä¸è§¦å‘è§¦å‘å™¨ã€‚</li><li>åœ¨åˆ é™¤å¤§é‡æ•°æ®ä¸”ä¸å†éœ€è¦è¯¥è¡¨æ—¶ä½¿ç”¨ã€‚</li></ul></li><li><strong>ç¤ºä¾‹</strong>ï¼š<code>DROP TABLE table_name;</code></li></ul><blockquote><p>æ€»ç»“</p></blockquote><ul><li><strong>åˆ é™¤æ•°æ®è¡Œ</strong>ï¼šå¦‚æœéœ€è¦åˆ é™¤éƒ¨åˆ†æ•°æ®è¡Œï¼Œä½¿ç”¨<code>DELETE</code>ã€‚è‹¥éœ€åˆ é™¤æ‰€æœ‰æ•°æ®è¡Œä¸”è¡¨ç»“æ„ä»éœ€ä¿ç•™ï¼Œä½¿ç”¨<code>TRUNCATE</code>ã€‚</li><li><strong>åˆ é™¤è¡¨</strong>ï¼šå¦‚æœè¦åˆ é™¤æ•´ä¸ªè¡¨åŠå…¶æ•°æ®ï¼Œä½¿ç”¨<code>DROP</code>ã€‚</li><li><strong>æ€§èƒ½è€ƒè™‘</strong>ï¼šå½“å¤„ç†å¤§é‡æ•°æ®æ—¶ï¼Œ<code>TRUNCATE</code>æ¯”<code>DELETE</code>æ›´é«˜æ•ˆã€‚</li><li><strong>äº‹åŠ¡å’Œå›æ»š</strong>ï¼š<code>DELETE</code>æ“ä½œå¯ä»¥å›æ»šï¼Œè€Œ<code>TRUNCATE</code>å’Œ<code>DROP</code>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ä¸èƒ½ã€‚</li></ul><p>é€‰æ‹©ä½¿ç”¨å“ªä¸ªå‘½ä»¤å–å†³äºå…·ä½“çš„éœ€æ±‚ï¼Œå¦‚æ˜¯å¦éœ€è¦ä¿ç•™è¡¨ç»“æ„ã€æ˜¯å¦éœ€è¦æ¡ä»¶åˆ é™¤æˆ–æ˜¯å¦å…³æ³¨æ€§èƒ½ä¼˜åŒ–ã€‚</p><h4 id="æ•°æ®åº“è®¾è®¡é€šå¸¸åˆ†ä¸ºå“ªå‡ æ­¥"><a href="#æ•°æ®åº“è®¾è®¡é€šå¸¸åˆ†ä¸ºå“ªå‡ æ­¥" class="headerlink" title="æ•°æ®åº“è®¾è®¡é€šå¸¸åˆ†ä¸ºå“ªå‡ æ­¥?"></a>æ•°æ®åº“è®¾è®¡é€šå¸¸åˆ†ä¸ºå“ªå‡ æ­¥?</h4><ol><li><strong>éœ€æ±‚åˆ†æ</strong> : åˆ†æç”¨æˆ·çš„éœ€æ±‚ï¼ŒåŒ…æ‹¬æ•°æ®ã€åŠŸèƒ½å’Œæ€§èƒ½éœ€æ±‚ã€‚</li><li><strong>æ¦‚å¿µç»“æ„è®¾è®¡</strong> : ä¸»è¦é‡‡ç”¨ E-R æ¨¡å‹è¿›è¡Œè®¾è®¡ï¼ŒåŒ…æ‹¬ç”» E-R å›¾ã€‚</li><li><strong>é€»è¾‘ç»“æ„è®¾è®¡</strong> : é€šè¿‡å°† E-R å›¾è½¬æ¢æˆè¡¨ï¼Œå®ç°ä» E-R æ¨¡å‹åˆ°å…³ç³»æ¨¡å‹çš„è½¬æ¢ã€‚</li><li><strong>ç‰©ç†ç»“æ„è®¾è®¡</strong> : ä¸»è¦æ˜¯ä¸ºæ‰€è®¾è®¡çš„æ•°æ®åº“é€‰æ‹©åˆé€‚çš„å­˜å‚¨ç»“æ„å’Œå­˜å–è·¯å¾„ã€‚</li><li><strong>æ•°æ®åº“å®æ–½</strong> : åŒ…æ‹¬ç¼–ç¨‹ã€æµ‹è¯•å’Œè¯•è¿è¡Œã€‚</li><li><strong>æ•°æ®åº“çš„è¿è¡Œå’Œç»´æŠ¤</strong> : ç³»ç»Ÿçš„è¿è¡Œä¸æ•°æ®åº“çš„æ—¥å¸¸ç»´æŠ¤</li></ol><hr><p>å‚è€ƒ</p><ul><li><a href="https://javaguide.cn/database/basis.html">https://javaguide.cn/database/basis.html</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
      <category>MySQL</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mysql</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MySQLå­¦ä¹ _åŸºç¡€å†…å®¹02</title>
    <link href="/2023/12/22/MySQL%E5%AD%A6%E4%B9%A0_%E5%9F%BA%E7%A1%80%E5%86%85%E5%AE%B902/"/>
    <url>/2023/12/22/MySQL%E5%AD%A6%E4%B9%A0_%E5%9F%BA%E7%A1%80%E5%86%85%E5%AE%B902/</url>
    
    <content type="html"><![CDATA[<h3 id="3ã€äº‹åŠ¡éš”ç¦»"><a href="#3ã€äº‹åŠ¡éš”ç¦»" class="headerlink" title="3ã€äº‹åŠ¡éš”ç¦»"></a>3ã€äº‹åŠ¡éš”ç¦»</h3><p>äº‹åŠ¡å°±æ˜¯è¦ä¿è¯ä¸€ç»„æ•°æ®åº“æ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ã€‚</p><p>åœ¨Â <strong>MySQL</strong>Â ä¸­ï¼Œäº‹åŠ¡æ”¯æŒæ˜¯åœ¨å¼•æ“å±‚å®ç°çš„ï¼ŒMyISAM å¼•æ“ä¸æ”¯æŒäº‹åŠ¡ï¼ŒInnoDB æ”¯æŒï¼›ä¸‹è¿°å†…å®¹ä¹Ÿæ˜¯å›´ç»• InnoDB å¼•æ“æ¥è®²è¿°çš„ã€‚</p><h4 id="éš”ç¦»æ€§ä¸éš”ç¦»çº§åˆ«"><a href="#éš”ç¦»æ€§ä¸éš”ç¦»çº§åˆ«" class="headerlink" title="éš”ç¦»æ€§ä¸éš”ç¦»çº§åˆ«"></a>éš”ç¦»æ€§ä¸éš”ç¦»çº§åˆ«</h4><p>åœ¨MySQLä¸­ï¼Œäº‹åŠ¡éš”ç¦»çº§åˆ«å®šä¹‰äº†ä¸€ä¸ªäº‹åŠ¡å¯èƒ½å—å…¶ä»–å¹¶å‘äº‹åŠ¡å½±å“çš„ç¨‹åº¦ã€‚</p><p>è¿™ä¸ªæ¦‚å¿µå¯¹äºç†è§£å¹¶å‘æ“ä½œæ—¶å¯èƒ½å‡ºç°çš„é—®é¢˜ï¼ˆå¦‚è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»ï¼‰è‡³å…³é‡è¦ã€‚</p><p>MySQLæ”¯æŒä»¥ä¸‹å››ç§æ ‡å‡†çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼š</p><ul><li>è¯»æœªæäº¤</li><li>è¯»å·²æäº¤</li><li>å¯é‡å¤è¯»</li><li>ä¸²è¡ŒåŒ–</li></ul><blockquote><ol><li>READ UNCOMMITTEDï¼ˆè¯»æœªæäº¤ï¼‰</li></ol></blockquote><p>è¿™æ˜¯æœ€ä½çš„éš”ç¦»çº§åˆ«ï¼Œåœ¨è¿™ä¸ªçº§åˆ«ï¼Œäº‹åŠ¡å¯ä»¥è¯»å–åˆ°å…¶ä»–äº‹åŠ¡è¿˜æœªæäº¤çš„æ›´æ”¹ã€‚</p><p>æƒ³è±¡ä¸€ä¸ªå›¾ä¹¦é¦†ï¼Œæ‰€æœ‰ä¹¦ç±å³ä½¿æ­£åœ¨è¢«ç¼–è¾‘ï¼ˆæ•°æ®è¢«ä¿®æ”¹ï¼‰ä¹Ÿå¯ä»¥è¢«ä»»ä½•äººé˜…è¯»ã€‚</p><p>è¿™å¯èƒ½å¯¼è‡´â€œè„è¯»â€ï¼Œå³ä¸€ä¸ªäº‹åŠ¡å¯èƒ½è¯»å–åˆ°å¦ä¸€ä¸ªäº‹åŠ¡ä¿®æ”¹ä½†å°šæœªæäº¤çš„æ•°æ®ï¼Œå¦‚æœé‚£ä¸ªäº‹åŠ¡å›æ»šï¼Œè¯»å–åˆ°çš„æ•°æ®å°±æ˜¯æ— æ•ˆçš„ã€‚</p><blockquote><ol start="2"><li>READ COMMITTEDï¼ˆè¯»å·²æäº¤ï¼‰</li></ol></blockquote><p>åœ¨è¿™ä¸ªçº§åˆ«ï¼Œä¸€ä¸ªäº‹åŠ¡åªèƒ½è¯»å–åˆ°å…¶ä»–äº‹åŠ¡å·²ç»æäº¤çš„æ›´æ”¹ã€‚</p><p>å›åˆ°å›¾ä¹¦é¦†çš„ä¾‹å­ï¼Œè¿™å°±ç›¸å½“äºåªæœ‰å½“ä¸€æœ¬ä¹¦å®Œæˆç¼–è¾‘å¹¶è¿”å›åˆ°ä¹¦æ¶ä¸Šæ—¶ï¼Œå…¶ä»–äººæ‰èƒ½é˜…è¯»å®ƒã€‚</p><p>è¿™è§£å†³äº†è„è¯»çš„é—®é¢˜ï¼Œä½†ä»ç„¶å¯èƒ½å‡ºç°â€œä¸å¯é‡å¤è¯»â€ï¼Œå› ä¸ºåœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ï¼ŒåŒæ ·çš„æŸ¥è¯¢å¯èƒ½ä¼šè¿”å›ä¸åŒçš„ç»“æœï¼Œå¦‚æœå…¶ä»–äº‹åŠ¡åœ¨ä¸¤æ¬¡æŸ¥è¯¢ä¹‹é—´æäº¤äº†æ›´æ”¹ã€‚</p><blockquote><ol start="3"><li>REPEATABLE READï¼ˆå¯é‡å¤è¯»ï¼‰</li></ol></blockquote><p>MySQLçš„é»˜è®¤éš”ç¦»çº§åˆ«ã€‚</p><p>åœ¨è¿™ä¸ªçº§åˆ«ï¼Œäº‹åŠ¡åœ¨å¼€å§‹æ—¶åˆ›å»ºä¸€ä¸ªæ•°æ®å¿«ç…§ï¼Œ<strong>ç¡®ä¿åœ¨æ•´ä¸ªäº‹åŠ¡æœŸé—´å¯ä»¥é‡å¤è¯»å–ç›¸åŒçš„æ•°æ®</strong>ï¼Œå³ä½¿å…¶ä»–äº‹åŠ¡æäº¤äº†æ›´æ”¹ã€‚</p><p>åœ¨å›¾ä¹¦é¦†ä¸­ï¼Œå³ä½¿ä¹¦ç±è¢«ç¼–è¾‘ï¼Œä½ ä¹Ÿä¼šä¸€ç›´è¯»åˆ°ä½ æœ€åˆæ‰¾åˆ°çš„ç‰ˆæœ¬ã€‚è™½ç„¶è§£å†³äº†ä¸å¯é‡å¤è¯»çš„é—®é¢˜ï¼Œä½†å®ƒä»ç„¶é¢ä¸´â€œå¹»è¯»â€çš„é—®é¢˜ï¼Œå½“ä¸€ä¸ªäº‹åŠ¡ä¸­çš„ä¸¤ä¸ªç›¸åŒçš„æŸ¥è¯¢å¯èƒ½<strong>å› ä¸ºå¦ä¸€ä¸ªäº‹åŠ¡çš„æ’å…¥æ“ä½œ</strong>è€Œè¿”å›ä¸åŒçš„è¡Œæ•°ã€‚</p><blockquote><ol start="4"><li>SERIALIZABLEï¼ˆä¸²è¡ŒåŒ–ï¼‰</li></ol></blockquote><p>è¿™æ˜¯æœ€é«˜çš„éš”ç¦»çº§åˆ«ï¼Œå®ƒé€šè¿‡<strong>å¼ºåˆ¶äº‹åŠ¡é¡ºåºæ‰§è¡Œ</strong>ï¼Œé¿å…äº†å¹»è¯»çš„é—®é¢˜ã€‚åœ¨å›¾ä¹¦é¦†ä¸­ï¼Œè¿™ç›¸å½“äºå½“ä½ é˜…è¯»ä¸€æœ¬ä¹¦æ—¶ï¼Œ<strong>å…¶ä»–ä»»ä½•äººéƒ½ä¸èƒ½ç¼–è¾‘æˆ–æ£€æŸ¥è¿™æœ¬ä¹¦</strong>ã€‚è¿™ä¼šå¯¼è‡´æ˜æ˜¾çš„æ€§èƒ½ä¸‹é™ï¼Œå› ä¸ºå®ƒé˜»æ­¢äº†å¯èƒ½çš„å¹¶å‘äº‹åŠ¡æ‰§è¡Œã€‚</p><p>ä¸åŒéš”ç¦»çº§åˆ«å¯¹æ€§èƒ½å’Œå¹¶å‘æ€§çš„å½±å“æ˜¯ä¸€ä¸ªæƒè¡¡ï¼š</p><ul><li>æ›´ä½çš„éš”ç¦»çº§åˆ«ï¼ˆå¦‚READ UNCOMMITTEDå’ŒREAD COMMITTEDï¼‰æé«˜äº†å¹¶å‘æ€§ï¼Œä½†ç‰ºç‰²äº†æ•°æ®çš„å‡†ç¡®æ€§ã€‚</li><li>æ›´é«˜çš„éš”ç¦»çº§åˆ«ï¼ˆå¦‚REPEATABLE READå’ŒSERIALIZABLEï¼‰æä¾›äº†æ›´å‡†ç¡®çš„æ•°æ®å’Œäº‹åŠ¡ä¸€è‡´æ€§ï¼Œä½†å¯èƒ½ä¼šé™ä½å¹¶å‘æ€§ã€‚</li></ul><p>é€‰æ‹©å“ªä¸ªéš”ç¦»çº§åˆ«å–å†³äºåº”ç”¨ç¨‹åºçš„ç‰¹å®šéœ€æ±‚å’Œå®ƒå¯ä»¥å®¹å¿çš„æ•°æ®ä¸ä¸€è‡´ç¨‹åº¦ã€‚</p><p>ä¾‹å¦‚ï¼Œé“¶è¡Œç³»ç»Ÿå¯èƒ½ä¼šå€¾å‘äºä½¿ç”¨æ›´é«˜çš„éš”ç¦»çº§åˆ«ä»¥ä¿è¯äº‹åŠ¡çš„å‡†ç¡®æ€§ï¼Œè€Œä¸€ä¸ªåªæ˜¾ç¤ºè¿‘ä¼¼æ•°æ®çš„æŠ¥å‘Šç³»ç»Ÿå¯èƒ½ä¼šé€‰æ‹©ä¸€ä¸ªæ›´ä½çš„éš”ç¦»çº§åˆ«ä»¥è·å¾—æ›´å¥½çš„æ€§èƒ½ã€‚</p><h4 id="éš”ç¦»çº§åˆ«REPEATABLE-READï¼ˆå¯é‡å¤è¯»ï¼‰çš„å®ç°"><a href="#éš”ç¦»çº§åˆ«REPEATABLE-READï¼ˆå¯é‡å¤è¯»ï¼‰çš„å®ç°" class="headerlink" title="éš”ç¦»çº§åˆ«REPEATABLE READï¼ˆå¯é‡å¤è¯»ï¼‰çš„å®ç°"></a>éš”ç¦»çº§åˆ«REPEATABLE READï¼ˆå¯é‡å¤è¯»ï¼‰çš„å®ç°</h4><p>åœ¨MySQLä¸­ï¼ŒREPEATABLE READï¼ˆå¯é‡å¤è¯»ï¼‰éš”ç¦»çº§åˆ«çš„å®ç°æ˜¯é€šè¿‡ç»“åˆä½¿ç”¨å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCCï¼‰å’Œå›æ»šæ—¥å¿—æ¥å®Œæˆçš„ã€‚</p><p>è¿™ä¸¤ç§æœºåˆ¶å…±åŒå·¥ä½œï¼Œä»¥ç¡®ä¿äº‹åŠ¡å¯ä»¥åœ¨å…¶æ‰§è¡ŒæœŸé—´å¤šæ¬¡è¯»å–åŒä¸€æ•°æ®çš„ä¸€è‡´çŠ¶æ€ï¼ŒåŒæ—¶é¿å…ç”±å…¶ä»–å¹¶å‘äº‹åŠ¡å¼•èµ·çš„æ•°æ®ä¸ä¸€è‡´ã€‚</p><blockquote><p>å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCCï¼‰</p></blockquote><p>MVCCæ˜¯å¯é‡å¤è¯»éš”ç¦»çº§åˆ«çš„æ ¸å¿ƒï¼Œå®ƒå…è®¸åœ¨ä¸åŠ é”çš„æƒ…å†µä¸‹è¿›è¡Œè¯»æ“ä½œï¼ŒåŒæ—¶ä»ç„¶ä¿æŒäº‹åŠ¡é—´çš„éš”ç¦»ã€‚</p><ul><li><strong>æ•°æ®ç‰ˆæœ¬åŒ–</strong>ï¼šåœ¨MVCCä¸­ï¼Œæ¯å½“æ•°æ®è¢«æ›´æ–°æ—¶ï¼ŒåŸå§‹æ•°æ®ä¸ä¼šç«‹å³è¢«è¦†ç›–ã€‚ç›¸åï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®ç‰ˆæœ¬ã€‚è¿™æ ·ï¼Œä¸åŒçš„äº‹åŠ¡å¯ä»¥çœ‹åˆ°åŒä¸€æ•°æ®çš„ä¸åŒç‰ˆæœ¬ã€‚</li><li><strong>è¯»è§†å›¾ï¼ˆRead-Viewï¼‰</strong>ï¼šå½“äº‹åŠ¡å¼€å§‹æ—¶ï¼Œå®ƒåˆ›å»ºä¸€ä¸ªè¯»è§†å›¾ï¼Œè¿™ä¸ªè§†å›¾ä»£è¡¨æ•°æ®åº“åœ¨é‚£ä¸€æ—¶åˆ»çš„çŠ¶æ€ã€‚åœ¨æ•´ä¸ªäº‹åŠ¡æœŸé—´ï¼Œå³ä½¿æ•°æ®åœ¨å…¶ä»–äº‹åŠ¡ä¸­è¢«æ›´æ”¹ï¼Œè¯¥äº‹åŠ¡ä¹Ÿèƒ½çœ‹åˆ°å…¶è¯»è§†å›¾ä¸­çš„æ•°æ®ç‰ˆæœ¬ã€‚</li></ul><blockquote><p>å›æ»šæ—¥å¿—</p></blockquote><p>å›æ»šæ—¥å¿—æ˜¯å®ç°MVCCçš„å…³é”®ç»„æˆéƒ¨åˆ†ï¼Œå®ƒç”¨äºè®°å½•æ¯ä¸ªæ•°æ®ç‰ˆæœ¬çš„å†å²ä¿¡æ¯ã€‚</p><ul><li><strong>ç‰ˆæœ¬é“¾</strong>ï¼šæ¯å½“æ•°æ®é¡¹è¢«æ›´æ–°ï¼Œå›æ»šæ—¥å¿—å°±ä¼šè®°å½•ä¸€ä¸ªæ“ä½œï¼Œè¿™äº›æ“ä½œå½¢æˆäº†ä¸€æ¡ç‰ˆæœ¬é“¾ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå€¼ä»1æ”¹ä¸º2ï¼Œå†æ”¹ä¸º3ï¼Œæœ€åå˜ä¸º4ï¼Œå›æ»šæ—¥å¿—ä¼šè®°å½•è¿™ä¸€ç³»åˆ—å˜åŒ–ã€‚</li><li><strong>ä¿ç•™å†å²æ•°æ®</strong>ï¼šè¿™äº›å›æ»šæ“ä½œå…è®¸æ•°æ®åº“â€œå›æ»šâ€åˆ°æ—©æœŸçš„çŠ¶æ€ã€‚å› æ­¤ï¼Œå³ä½¿å½“å‰æ•°æ®å€¼æ˜¯4ï¼Œä¸åŒçš„äº‹åŠ¡ä¾æ®å®ƒä»¬çš„è¯»è§†å›¾å¯èƒ½çœ‹åˆ°çš„å€¼æ˜¯1ã€2æˆ–4ã€‚</li></ul><p>å›æ»šæ—¥å¿—ä»€ä¹ˆæ—¶å€™åˆ é™¤ï¼Ÿ</p><ul><li>åœ¨ä¸éœ€è¦çš„æ—¶å€™æ‰åˆ é™¤ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç³»ç»Ÿä¼šåˆ¤æ–­ï¼Œå½“æ²¡æœ‰äº‹åŠ¡å†éœ€è¦ç”¨åˆ°è¿™äº›å›æ»šæ—¥å¿—æ—¶ï¼Œå›æ»šæ—¥å¿—ä¼šè¢«åˆ é™¤ã€‚</li><li>ä»€ä¹ˆæ—¶å€™æ‰ä¸éœ€è¦äº†å‘¢ï¼Ÿå°±æ˜¯å½“ç³»ç»Ÿé‡Œæ²¡æœ‰æ¯”è¿™ä¸ªå›æ»šæ—¥å¿—æ›´æ—©çš„ read-view çš„æ—¶å€™ã€‚</li></ul><blockquote><p>å®ç°åŸç†</p></blockquote><p>ç»“åˆMVCCå’Œå›æ»šæ—¥å¿—ï¼Œå¯é‡å¤è¯»éš”ç¦»çº§åˆ«åœ¨MySQLä¸­çš„å®ç°å¯ä»¥è¿™æ ·ç†è§£ï¼š</p><ol><li><strong>äº‹åŠ¡å¼€å§‹æ—¶åˆ›å»ºè¯»è§†å›¾</strong>ï¼šäº‹åŠ¡å¼€å§‹æ—¶æ•æ‰æ•°æ®åº“çš„ç¬æ—¶å¿«ç…§ï¼Œè¿™ä¸ªå¿«ç…§å®šä¹‰äº†äº‹åŠ¡èƒ½çœ‹åˆ°çš„æ•°æ®ç‰ˆæœ¬ã€‚</li><li><strong>è¯»å–æ“ä½œæ—¶ä½¿ç”¨å›æ»šæ—¥å¿—</strong>ï¼šå½“äº‹åŠ¡ä¸­çš„æ“ä½œéœ€è¦è¯»å–æ•°æ®æ—¶ï¼Œç³»ç»Ÿä¼šåˆ©ç”¨å›æ»šæ—¥å¿—æ‰¾åˆ°è¯¥äº‹åŠ¡è¯»è§†å›¾å¯¹åº”çš„æ•°æ®ç‰ˆæœ¬ã€‚</li><li><strong>éš”ç¦»æ€§çš„ä¿è¯</strong>ï¼šå³ä½¿åœ¨äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå…¶ä»–äº‹åŠ¡å·²ç»æäº¤äº†å¯¹ç›¸åŒæ•°æ®çš„æ›´æ”¹ï¼Œè¯¥äº‹åŠ¡ä»ç„¶åªèƒ½çœ‹åˆ°å…¶å¼€å§‹æ—¶çš„æ•°æ®ç‰ˆæœ¬ã€‚</li><li><strong>å›æ»šæ—¥å¿—çš„ç»´æŠ¤</strong>ï¼šå›æ»šæ—¥å¿—ä¼šä¸€ç›´ä¿ç•™ï¼Œç›´åˆ°æ²¡æœ‰äº‹åŠ¡éœ€è¦æ—©æœŸçš„æ•°æ®ç‰ˆæœ¬ä¸ºæ­¢ã€‚è¿™ç¡®ä¿äº†å³ä½¿åœ¨æœ‰é•¿äº‹åŠ¡å­˜åœ¨çš„æƒ…å†µä¸‹ï¼Œæ•°æ®çš„æ—©æœŸç‰ˆæœ¬ä»ç„¶å¯ç”¨ã€‚</li></ol><blockquote><p>é•¿äº‹åŠ¡çš„å½±å“</p></blockquote><p>ç”±äºé•¿äº‹åŠ¡å¯èƒ½ä¼šè®¿é—®æ—§ç‰ˆæœ¬çš„æ•°æ®ï¼ŒMySQLå¿…é¡»ä¿ç•™é•¿äº‹åŠ¡å¼€å§‹ä¹‹å‰çš„æ‰€æœ‰å›æ»šä¿¡æ¯ã€‚è¿™ä¸ä»…å ç”¨äº†å¤§é‡å­˜å‚¨ç©ºé—´ï¼Œè€Œä¸”å¯èƒ½å½±å“ç³»ç»Ÿæ€§èƒ½ã€‚</p><p>ä¾‹å¦‚ï¼Œåœ¨MySQL 5.5åŠä»¥å‰çš„ç‰ˆæœ¬ä¸­ï¼Œå¤§é‡çš„å›æ»šæ—¥å¿—å¯èƒ½å¯¼è‡´ibdataæ–‡ä»¶è¿‡å¤§ï¼Œå³ä½¿é•¿äº‹åŠ¡æœ€ç»ˆæäº¤ï¼Œè¿™äº›ç©ºé—´ä¹Ÿä¸ä¼šè‡ªåŠ¨é‡Šæ”¾ï¼Œæœ‰æ—¶éœ€è¦é‡å»ºæ•´ä¸ªæ•°æ®åº“æ¥æ¸…ç†è¿™äº›ç©ºé—´ã€‚</p><p>å› æ­¤ï¼Œè™½ç„¶REPEATABLE READæä¾›äº†è¾ƒå¼ºçš„éš”ç¦»æ€§ï¼Œä½†ä¹Ÿéœ€è¦åˆç†ç®¡ç†äº‹åŠ¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œé¿å…é•¿äº‹åŠ¡å¯¹ç³»ç»Ÿæ€§èƒ½å’Œå­˜å‚¨ç©ºé—´çš„è´Ÿé¢å½±å“ã€‚</p><h4 id="äº‹åŠ¡çš„å¯åŠ¨æ–¹å¼"><a href="#äº‹åŠ¡çš„å¯åŠ¨æ–¹å¼" class="headerlink" title="äº‹åŠ¡çš„å¯åŠ¨æ–¹å¼"></a>äº‹åŠ¡çš„å¯åŠ¨æ–¹å¼</h4><div style="background-color: #ecf0f1; color: #34495e; padding: 15px; border: 2px solid #bdc3c7; border-radius: 5px;">  <strong>äº‹åŠ¡çš„å¯åŠ¨æ–¹å¼ï¼š</strong>æ˜¾ç¤ºå¯åŠ¨äº‹åŠ¡ï¼›è‡ªåŠ¨æäº¤æ¨¡å¼</div><p>åœ¨MySQLä¸­ï¼Œäº‹åŠ¡çš„å¯åŠ¨æ–¹å¼å¯¹äºäº‹åŠ¡ç®¡ç†å’Œæ€§èƒ½ä¼˜åŒ–è‡³å…³é‡è¦ã€‚ç†è§£å’Œæ­£ç¡®ä½¿ç”¨ä¸åŒçš„äº‹åŠ¡å¯åŠ¨æ–¹å¼å¯ä»¥é¿å…é•¿äº‹åŠ¡å¸¦æ¥çš„é£é™©ã€‚ä¸‹é¢æ˜¯MySQLä¸­å¸¸è§çš„å‡ ç§äº‹åŠ¡å¯åŠ¨æ–¹å¼ï¼š</p><blockquote><ol><li>æ˜¾å¼å¯åŠ¨äº‹åŠ¡</li></ol></blockquote><ul><li><strong>ä½¿ç”¨è¯­å¥å¯åŠ¨</strong>ï¼šæœ€ç›´æ¥çš„å¯åŠ¨äº‹åŠ¡çš„æ–¹å¼æ˜¯ä½¿ç”¨<code>BEGIN</code>æˆ–<code>START TRANSACTION</code>è¯­å¥ã€‚è¿™ç§æ–¹å¼ä¸‹ï¼Œäº‹åŠ¡ä¼šæŒç»­åˆ°æ‰§è¡Œ<code>COMMIT</code>æˆ–<code>ROLLBACK</code>è¯­å¥ä¸ºæ­¢ã€‚<code>COMMIT</code>ç”¨äºæäº¤äº‹åŠ¡ä¸­çš„æ‰€æœ‰æ›´æ”¹ï¼Œè€Œ<code>ROLLBACK</code>ç”¨äºæ’¤é”€æ‰€æœ‰æ›´æ”¹ã€‚</li><li><strong>æ˜¾å¼æ§åˆ¶</strong>ï¼šè¿™ç§æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯å¼€å‘è€…å¯¹äº‹åŠ¡çš„å¼€å§‹å’Œç»“æŸæœ‰æ˜ç¡®çš„æ§åˆ¶ï¼Œè¿™æœ‰åŠ©äºé¿å…ä¸å¿…è¦çš„é•¿äº‹åŠ¡ã€‚</li></ul><blockquote><ol start="2"><li>è‡ªåŠ¨æäº¤æ¨¡å¼</li></ol></blockquote><ul><li><strong>è®¾ç½®è‡ªåŠ¨æäº¤</strong>ï¼šé€šè¿‡æ‰§è¡Œ<code>SET autocommit=0</code>ï¼Œå¯ä»¥å…³é—­å½“å‰çº¿ç¨‹çš„è‡ªåŠ¨æäº¤ã€‚è¿™æ„å‘³ç€å³ä½¿æ‰§è¡Œäº†ä¸€ä¸ªç®€å•çš„<code>SELECT</code>æŸ¥è¯¢ï¼Œä¹Ÿä¼šå¯åŠ¨ä¸€ä¸ªäº‹åŠ¡ï¼Œå¹¶ä¸”äº‹åŠ¡ä¸ä¼šè‡ªåŠ¨æäº¤ã€‚</li><li><strong>æ½œåœ¨é£é™©</strong>ï¼šè¿™ç§æ¨¡å¼ä¸‹ï¼Œå¦‚æœå¼€å‘è€…å¿˜è®°äº†æ‰‹åŠ¨æäº¤æˆ–å›æ»šäº‹åŠ¡ï¼Œæˆ–è€…åœ¨é•¿è¿æ¥ä¸­ä½¿ç”¨æ­¤æ¨¡å¼ï¼Œå¯èƒ½ä¼šæ— æ„ä¸­åˆ›å»ºé•¿äº‹åŠ¡ï¼Œè¿™ä¼šå ç”¨å¤§é‡èµ„æºå¹¶å½±å“æ•°æ®åº“æ€§èƒ½ã€‚</li></ul><blockquote><ol start="3"><li>æ¨èçš„å®è·µ</li></ol></blockquote><ul><li><strong>é»˜è®¤è‡ªåŠ¨æäº¤</strong>ï¼šå»ºè®®æ€»æ˜¯ä½¿ç”¨<code>SET autocommit=1</code>ã€‚é€šè¿‡æ˜¾å¼çš„<code>BEGIN</code>ã€<code>COMMIT</code>å’Œ<code>ROLLBACK</code>è¯­å¥æ¥æ§åˆ¶äº‹åŠ¡ï¼Œè¿™æ ·å¯ä»¥æ¸…æ™°åœ°ç®¡ç†äº‹åŠ¡çš„ç”Ÿå‘½å‘¨æœŸã€‚</li><li><strong>å‡å°‘äº¤äº’</strong>ï¼šå¯¹äºéœ€è¦é¢‘ç¹å¯åŠ¨äº‹åŠ¡çš„åœºæ™¯ï¼Œå¯ä»¥ä½¿ç”¨<code>COMMIT WORK AND CHAIN</code>è¯­æ³•ã€‚åœ¨<code>autocommit=1</code>çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªå‘½ä»¤ä¸ä»…æäº¤å½“å‰äº‹åŠ¡ï¼Œè¿˜ä¼šè‡ªåŠ¨å¼€å§‹ä¸€ä¸ªæ–°äº‹åŠ¡ã€‚è¿™å‡å°‘äº†æ¯ä¸ªäº‹åŠ¡å¼€å§‹æ—¶æ‰§è¡Œ<code>BEGIN</code>çš„éœ€æ±‚ï¼ŒåŒæ—¶ä¿æŒäº†äº‹åŠ¡çš„æ˜¾å¼æ§åˆ¶ã€‚</li></ul><blockquote><ol start="4"><li>ç›‘æ§é•¿äº‹åŠ¡</li></ol></blockquote><ul><li><strong>æ£€æµ‹é•¿äº‹åŠ¡</strong>ï¼šå¯ä»¥é€šè¿‡æŸ¥è¯¢<code>information_schema.innodb_trx</code>è¡¨æ¥ç›‘æ§é•¿æ—¶é—´è¿è¡Œçš„äº‹åŠ¡ã€‚ä¾‹å¦‚ï¼Œè¦æŸ¥æ‰¾è¿è¡Œæ—¶é—´è¶…è¿‡60ç§’çš„äº‹åŠ¡ï¼Œå¯ä»¥ä½¿ç”¨ç±»ä¼¼ä»¥ä¸‹çš„æŸ¥è¯¢è¯­å¥ï¼š<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> information_schema.innodb_trx <br><span class="hljs-keyword">WHERE</span> TIME_TO_SEC(TIMEDIFF(NOW(), trx_started)) &gt; <span class="hljs-number">60</span>;<br></code></pre></td></tr></table></figure>  è¿™å¯¹äºè¯†åˆ«å¯èƒ½å½±å“æ•°æ®åº“æ€§èƒ½çš„é•¿äº‹åŠ¡éå¸¸æœ‰ç”¨ã€‚</li></ul><p>é€šè¿‡ä»¥ä¸Šæ–¹æ³•ï¼Œå¼€å‘è€…å¯ä»¥æ›´æœ‰æ•ˆåœ°ç®¡ç†MySQLäº‹åŠ¡ï¼Œé¿å…å› è¯¯ç”¨æˆ–ä¸å½“çš„äº‹åŠ¡ç®¡ç†å¯¼è‡´çš„æ€§èƒ½é—®é¢˜ã€‚</p><p>æ˜ç¡®çš„äº‹åŠ¡ç•Œå®šï¼Œç»“åˆå¯¹é•¿äº‹åŠ¡çš„ç›‘æ§ï¼Œæœ‰åŠ©äºç»´æŒæ•°æ®åº“çš„å¥åº·çŠ¶æ€å’Œé«˜æ•ˆæ€§èƒ½ã€‚</p><hr><blockquote><p>é—®é¢˜ï¼šä½œä¸ºä¸šåŠ¡å¼€å‘è´Ÿè´£äººå…¼æ•°æ®åº“è´Ÿè´£äººï¼Œå¦‚ä½•é¿å…é•¿äº‹åŠ¡çš„å‡ºç°å¹¶å¦¥å–„å¤„ç†è¿™ç§æƒ…å†µã€‚</p></blockquote><p>é•¿äº‹åŠ¡å¯èƒ½å¯¼è‡´å¤šç§æ€§èƒ½é—®é¢˜ï¼Œå¦‚é”äº‰ç”¨ã€äº‹åŠ¡æ—¥å¿—è†¨èƒ€ã€ä¸»ä»å»¶è¿Ÿç­‰ã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€äº›æœ‰æ•ˆçš„ç­–ç•¥å’Œæœ€ä½³å®è·µï¼š</p><ul><li><ol><li>æ•™è‚²å’ŒåŸ¹è®­</li></ol></li><li><ol start="2"><li>ä»£ç å®¡æŸ¥</li></ol></li><li><ol start="3"><li>ç›‘æ§å’ŒæŠ¥è­¦</li></ol></li><li><ol start="4"><li>æ€§èƒ½åˆ†æ</li></ol></li><li><ol start="5"><li>ä¼˜åŒ–äº‹åŠ¡ç®¡ç†</li></ol></li><li><ol start="6"><li>åº”ç”¨æ¶æ„è®¾è®¡</li></ol></li><li><ol start="7"><li>æµ‹è¯•å’Œä»¿çœŸ</li></ol></li><li><ol start="8"><li>ç¯å¢ƒç®¡ç†</li></ol></li></ul><blockquote><ol start="3"><li>ç›‘æ§å’ŒæŠ¥è­¦</li></ol></blockquote><ul><li><strong>äº‹åŠ¡æŒç»­æ—¶é—´ç›‘æ§</strong>ï¼šç›‘æ§äº‹åŠ¡çš„æŒç»­æ—¶é—´ï¼Œä½¿ç”¨å¦‚<code>information_schema.innodb_trx</code>çš„æŸ¥è¯¢æ¥è¯†åˆ«é•¿äº‹åŠ¡ã€‚</li><li><strong>å®æ—¶æŠ¥è­¦ç³»ç»Ÿ</strong>ï¼šå®ç°å®æ—¶æŠ¥è­¦ç³»ç»Ÿï¼Œå½“äº‹åŠ¡è¶…è¿‡é¢„è®¾é˜ˆå€¼æ—¶å‘å‡ºè­¦å‘Šã€‚</li></ul><blockquote><ol start="4"><li>æ€§èƒ½åˆ†æ</li></ol></blockquote><ul><li><strong>åˆ†ææ…¢æŸ¥è¯¢æ—¥å¿—</strong>ï¼šå®šæœŸæ£€æŸ¥æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œæ‰¾å‡ºå¯èƒ½å¯¼è‡´é•¿äº‹åŠ¡çš„æ…¢SQLè¯­å¥ã€‚</li><li><strong>ä½¿ç”¨æ€§èƒ½åˆ†æå·¥å…·</strong>ï¼šä½¿ç”¨å¦‚MySQL Workbenchç­‰å·¥å…·åˆ†ææ•°æ®åº“æ€§èƒ½ï¼Œå¯»æ‰¾ä¼˜åŒ–ç‚¹ã€‚</li></ul><blockquote><ol start="5"><li>ä¼˜åŒ–äº‹åŠ¡ç®¡ç†</li></ol></blockquote><ul><li><strong>çŸ­äº‹åŠ¡åŸåˆ™</strong>ï¼šé¼“åŠ±ä½¿ç”¨çŸ­äº‹åŠ¡åŸåˆ™ï¼Œå°½é‡å‡å°‘äº‹åŠ¡çš„ä½œç”¨èŒƒå›´å’ŒæŒç»­æ—¶é—´ã€‚</li><li><strong>é¿å…ä¸å¿…è¦çš„äº‹åŠ¡</strong>ï¼šæœ‰äº›è¯»å–æ“ä½œå¯èƒ½ä¸éœ€è¦äº‹åŠ¡ï¼Œç‰¹åˆ«æ˜¯åœ¨åªè¯»æ“ä½œä¸­ã€‚</li></ul><h3 id="4ã€æ•°æ®åº“ç´¢å¼•-ğŸ±"><a href="#4ã€æ•°æ®åº“ç´¢å¼•-ğŸ±" class="headerlink" title="4ã€æ•°æ®åº“ç´¢å¼•   ğŸ±"></a>4ã€æ•°æ®åº“ç´¢å¼•   ğŸ±</h3><p>åœ¨MySQLä¸­ï¼Œæ•°æ®åº“ç´¢å¼•æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ•°æ®ç»“æ„ï¼Œå®ƒä»¬å¸®åŠ©æ•°æ®åº“å¿«é€Ÿé«˜æ•ˆåœ°å®šä½å’Œæ£€ç´¢æ•°æ®ã€‚</p><p>ä½ å¯ä»¥å°†ç´¢å¼•ç±»æ¯”ä¸ºå›¾ä¹¦çš„ç›®å½•ï¼šå°±åƒç›®å½•ä½¿ä½ èƒ½å¤Ÿå¿«é€Ÿæ‰¾åˆ°ä½ æƒ³è¦é˜…è¯»çš„ç« èŠ‚ï¼Œæ•°æ®åº“ç´¢å¼•å…è®¸æ•°æ®åº“å¿«é€Ÿæ‰¾åˆ°å­˜å‚¨åœ¨æ•°æ®è¡¨ä¸­çš„ç‰¹å®šæ•°æ®ï¼Œè€Œä¸å¿…æ‰«ææ•´ä¸ªè¡¨ã€‚</p><blockquote><p>ç´¢å¼•çš„ç±»å‹</p></blockquote><p>æŒ‰æ•°æ®ç»“æ„åˆ†ç±»å¯åˆ†ä¸ºï¼šB+treeç´¢å¼•ã€Hashç´¢å¼•ã€Full-textç´¢å¼•ã€‚<br>æŒ‰ç‰©ç†å­˜å‚¨åˆ†ç±»å¯åˆ†ä¸ºï¼šèšç°‡ç´¢å¼•ã€äºŒçº§ç´¢å¼•ï¼ˆè¾…åŠ©ç´¢å¼•ï¼‰ã€‚<br>æŒ‰å­—æ®µç‰¹æ€§åˆ†ç±»å¯åˆ†ä¸ºï¼šä¸»é”®ç´¢å¼•ã€æ™®é€šç´¢å¼•ã€å‰ç¼€ç´¢å¼•ã€‚<br>æŒ‰å­—æ®µä¸ªæ•°åˆ†ç±»å¯åˆ†ä¸ºï¼šå•åˆ—ç´¢å¼•ã€è”åˆç´¢å¼•ï¼ˆå¤åˆç´¢å¼•ã€ç»„åˆç´¢å¼•ï¼‰ã€‚</p><h4 id="ç´¢å¼•-B-æ ‘"><a href="#ç´¢å¼•-B-æ ‘" class="headerlink" title="ç´¢å¼•(B+æ ‘)"></a>ç´¢å¼•(B+æ ‘)</h4><blockquote><p>B+ Tree åŸç†</p></blockquote><p>å‚è€ƒï¼š </p><ul><li><a href="https://www.pdai.tech/md/db/sql-mysql/sql-mysql-b-tree.html">https://www.pdai.tech/md/db/sql-mysql/sql-mysql-b-tree.html</a></li><li><a href="https://www.yuque.com/snailclimb/mf2z3k/wghadf">https://www.yuque.com/snailclimb/mf2z3k/wghadf</a></li></ul><p>ç´¢å¼•ä¸ºä»€ä¹ˆä½¿ç”¨ B+ æ ‘</p><p>å¼•å…¥å„ç§æ ‘è§£å†³çš„é—®é¢˜ä»¥åŠé¢ä¸´çš„æ–°é—®é¢˜</p><ul><li>äºŒå‰æŸ¥æ‰¾æ ‘ï¼ˆBST)<ul><li>ä¸å¹³è¡¡</li><li>äºŒå‰æŸ¥æ‰¾æ ‘çš„å¹³å‡æ—¶é—´å¤æ‚åº¦æ˜¯ O(lgn)ï¼›ä½†æ˜¯åœ¨æç«¯æƒ…å†µä¸‹ï¼ŒBSTä¼šé€€åŒ–ä¸ºé“¾è¡¨ï¼Œæ­¤æ—¶æ—¶é—´å¤æ‚åº¦ä¸º O(n)</li></ul></li><li>å¹³è¡¡äºŒå‰æ ‘ï¼ˆAVL)<ul><li>æ—‹è½¬è€—æ—¶</li><li>åˆ é™¤çš„ä¸€ä¸ªè€—æ—¶æ•ˆç‡è¾ƒä½ï¼Œæ¯”èµ·ä½¿ç”¨çš„å¥½å¤„è€Œè¨€ï¼Œç»¼åˆä½¿ç”¨å¹¶ä¸å¹¿æ³›</li></ul></li><li>çº¢é»‘æ ‘<ul><li>æ ‘å¤ªé«˜</li><li>çº¢é»‘æ ‘åœ¨å†…å­˜çš„è¡¨ç°ä¼˜å¼‚ï¼›ä½†æ˜¯åœ¨çœŸæ­£å­˜å‚¨åœ¨ç£ç›˜çš„æ—¶å€™ï¼Œè€ƒè™‘çš„åé‡æ˜¯éœ€è¦å‡å°‘IOæ¬¡æ•°</li></ul></li><li>Bæ ‘<ul><li>ä¸ºç£ç›˜è€Œç”Ÿ</li><li>å°†äºŒå‰æ ‘æ”¹ä¸ºäº†å¤šè·¯å¹³è¡¡æŸ¥æ‰¾æ ‘</li></ul></li><li>B+ æ ‘<ul><li>åœ¨ B æ ‘çš„åŸºç¡€ä¸Šï¼Œè¿›ä¸€æ­¥é™ä½äº†æ ‘çš„é«˜åº¦ï¼Œéƒ¨åˆ†æ”¹é€ ï¼Œä½¿å¾—èŒƒå›´æŸ¥è¯¢æ›´åŠ é«˜æ•ˆã€‚</li></ul></li></ul><h3 id="5ã€é”æœºåˆ¶"><a href="#5ã€é”æœºåˆ¶" class="headerlink" title="5ã€é”æœºåˆ¶"></a>5ã€é”æœºåˆ¶</h3><p>MySQLçš„é”æœºåˆ¶æ˜¯ä¸€ç§ç”¨æ¥ç®¡ç†å¤šä¸ªäº‹åŠ¡å¯¹åŒä¸€æ•°æ®è¿›è¡Œè®¿é—®çš„æœºåˆ¶ï¼Œæ—¨åœ¨ä¿æŒæ•°æ®çš„ä¸€è‡´æ€§å’Œå®Œæ•´æ€§ã€‚</p><p>é”æœºåˆ¶å…è®¸å¤šä¸ªäº‹åŠ¡åŒæ—¶è¯»å†™æ•°æ®åº“ï¼ŒåŒæ—¶é˜²æ­¢æ•°æ®å†²çªå’Œä¸ä¸€è‡´ã€‚</p><p>MySQLä¸­çš„é”ä¸»è¦å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ç§ç±»å‹ï¼š</p><ul><li>è¡¨çº§é”ï¼ˆTable-level Locksï¼‰</li><li>è¡Œçº§é”ï¼ˆRow-level Locksï¼‰</li><li>é¡µé¢é”ï¼ˆPage-level Locksï¼‰</li><li>å…±äº«é”å’Œæ’ä»–é”</li><li>æ„å‘é”ï¼ˆIntention Locksï¼‰</li><li>æ­»é”ï¼ˆDeadlocksï¼‰</li></ul><blockquote><ol><li>è¡¨çº§é”ï¼ˆTable-level Locksï¼‰</li></ol></blockquote><ul><li><strong>ç®€å•ä½†å¼€é”€å°</strong>ï¼šé”å®šæ•´ä¸ªè¡¨ï¼Œæ˜¯æœ€ç®€å•çš„é”ç­–ç•¥ï¼Œå¼€é”€æœ€å°ã€‚</li><li><strong>å¹¶å‘æ€§ä½</strong>ï¼šä¸é€‚åˆé«˜å¹¶å‘æ“ä½œï¼Œå› ä¸ºå®ƒé˜»æ­¢äº†å¯¹åŒä¸€è¡¨çš„å…¶ä»–è®¿é—®ã€‚</li><li><strong>åº”ç”¨</strong>ï¼šMyISAMå­˜å‚¨å¼•æ“ä¸»è¦ä½¿ç”¨è¡¨çº§é”ã€‚</li></ul><blockquote><ol start="2"><li>è¡Œçº§é”ï¼ˆRow-level Locksï¼‰</li></ol></blockquote><ul><li><strong>é«˜å¹¶å‘å¤„ç†</strong>ï¼šåªé”å®šéœ€è¦è®¿é—®çš„æ•°æ®è¡Œã€‚æ˜¯æœ€ç»†ç²’åº¦çš„é”ï¼Œå…è®¸é«˜åº¦çš„å¹¶å‘ã€‚</li><li><strong>å¼€é”€å¤§</strong>ï¼šæ¯”è¡¨çº§é”æ›´å¤šçš„å†…å­˜å’ŒCPUèµ„æºã€‚</li><li><strong>æ­»é”</strong>ï¼šå¯èƒ½ä¼šå¼•èµ·æ­»é”ï¼Œéœ€è¦é¢å¤–çš„é€»è¾‘æ¥å¤„ç†ã€‚</li><li><strong>åº”ç”¨</strong>ï¼šInnoDBå­˜å‚¨å¼•æ“ä½¿ç”¨è¡Œçº§é”ã€‚</li></ul><blockquote><ol start="3"><li>é¡µé¢é”ï¼ˆPage-level Locksï¼‰</li></ol></blockquote><ul><li><strong>ä¸­é—´ç²’åº¦</strong>ï¼šé”å®šå†…å­˜ä¸­çš„é¡µé¢ï¼Œä»‹äºè¡¨çº§é”å’Œè¡Œçº§é”ä¹‹é—´ã€‚</li><li><strong>å¹¶å‘å’Œèµ„æº</strong>ï¼šå¹³è¡¡äº†å¹¶å‘æ€§å’Œèµ„æºå¼€é”€ã€‚</li><li><strong>åº”ç”¨</strong>ï¼šä¸€äº›å­˜å‚¨å¼•æ“å¦‚BerkeleyDBä½¿ç”¨é¡µé¢é”ã€‚</li></ul><blockquote><ol start="4"><li>å…±äº«é”å’Œæ’ä»–é”</li></ol></blockquote><ul><li><strong>å…±äº«é”ï¼ˆShared Locksï¼‰</strong>ï¼šåˆç§°è¯»é”ï¼Œå…è®¸äº‹åŠ¡è¯»ä¸€è¡Œæ•°æ®ã€‚</li><li><strong>æ’ä»–é”ï¼ˆExclusive Locksï¼‰</strong>ï¼šåˆç§°å†™é”ï¼Œå…è®¸äº‹åŠ¡æ’ä»–åœ°å†™ä¸€è¡Œæ•°æ®ã€‚</li></ul><blockquote><ol start="5"><li>æ„å‘é”ï¼ˆIntention Locksï¼‰</li></ol></blockquote><ul><li><strong>å±‚çº§é”ç³»ç»Ÿ</strong>ï¼šç”¨äºæ”¯æŒè¡¨çº§é”å’Œè¡Œçº§é”çš„å…¼å®¹ã€‚</li><li><strong>ç±»å‹</strong>ï¼šåŒ…æ‹¬æ„å‘å…±äº«é”å’Œæ„å‘æ’ä»–é”ã€‚</li></ul><blockquote><ol start="6"><li>æ­»é”ï¼ˆDeadlocksï¼‰</li></ol></blockquote><ul><li><strong>é—®é¢˜</strong>ï¼šå½“å¤šä¸ªäº‹åŠ¡ç›¸äº’ç­‰å¾…å¯¹æ–¹é‡Šæ”¾é”æ—¶å‘ç”Ÿã€‚</li><li><strong>è§£å†³</strong>ï¼šMySQLä¼šè‡ªåŠ¨æ£€æµ‹å¹¶è§£å†³æ­»é”ï¼Œé€šå¸¸æ˜¯é€šè¿‡å›æ»šä¸€ä¸ªäº‹åŠ¡æ¥è§£é”ã€‚</li></ul><p><strong>é”ç­–ç•¥çš„é€‰æ‹©</strong></p><ul><li>ä¸åŒçš„å­˜å‚¨å¼•æ“æ”¯æŒä¸åŒçš„é”ç­–ç•¥ã€‚ä¾‹å¦‚ï¼ŒInnoDBæ”¯æŒè¡Œçº§é”å’Œè¡¨çº§é”ï¼Œè€ŒMyISAMä¸»è¦ä½¿ç”¨è¡¨çº§é”ã€‚</li><li>é”çš„é€‰æ‹©å–å†³äºå¤šç§å› ç´ ï¼ŒåŒ…æ‹¬äº‹åŠ¡çš„ç±»å‹ã€å¹¶å‘çº§åˆ«ã€æ•°æ®è¡¨çš„å¤§å°ç­‰ã€‚</li></ul><p>é”æœºåˆ¶çš„å®é™…åº”ç”¨</p><ul><li>åœ¨é«˜å¹¶å‘çš„æ•°æ®åº“ç³»ç»Ÿä¸­ï¼Œé€‚å½“çš„é”ç­–ç•¥å¯¹äºç»´æŠ¤æ•°æ®çš„å®Œæ•´æ€§å’Œæé«˜ç³»ç»Ÿæ€§èƒ½è‡³å…³é‡è¦ã€‚</li><li>ç†è§£ä¸åŒé”çš„è¡Œä¸ºå’Œå½±å“å¯ä»¥å¸®åŠ©æ•°æ®åº“ç®¡ç†å‘˜å’Œå¼€å‘äººå‘˜ä¼˜åŒ–æŸ¥è¯¢ï¼Œå‡å°‘æ­»é”ï¼Œå¹¶æé«˜æ•°æ®åº“çš„æ•´ä½“æ€§èƒ½ã€‚</li></ul><h3 id="DEBUYG"><a href="#DEBUYG" class="headerlink" title="DEBUYG"></a>DEBUYG</h3><p>å¾…å®Œå–„ï¼Œå‚è€ƒ <a href="https://javaguide.cn/database/mysql/mysql-questions-01.html#mysql-%E9%94%81">https://javaguide.cn/database/mysql/mysql-questions-01.html#mysql-%E9%94%81</a></p><h3 id="6ã€explainçš„ä½¿ç”¨"><a href="#6ã€explainçš„ä½¿ç”¨" class="headerlink" title="6ã€explainçš„ä½¿ç”¨"></a>6ã€explainçš„ä½¿ç”¨</h3><p>åœ¨MySQLä¸­ï¼Œ<code>EXPLAIN</code>æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œå®ƒç”¨äºåˆ†æMySQLå¦‚ä½•æ‰§è¡ŒSQLæŸ¥è¯¢ï¼Œç‰¹åˆ«æ˜¯ç”¨äºä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½ã€‚</p><p>ä½¿ç”¨<code>EXPLAIN</code>å¯ä»¥å¸®åŠ©ä½ ç†è§£MySQLå¦‚ä½•å¤„ç†ä½ çš„SQLè¯­å¥ï¼ŒåŒ…æ‹¬é€‰æ‹©å“ªäº›ç´¢å¼•ï¼Œå¦‚ä½•è¿æ¥è¡¨ï¼Œä»¥åŠä¼°è®¡çš„è¡Œæ•°ç­‰ã€‚</p><blockquote><p>å¦‚ä½•ä½¿ç”¨EXPLAIN</p></blockquote><p>è¦ä½¿ç”¨<code>EXPLAIN</code>ï¼Œåªéœ€åœ¨ä½ çš„SELECTè¯­å¥ä¹‹å‰åŠ ä¸Šå…³é”®å­—<code>EXPLAIN</code>ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql"><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> your_table <span class="hljs-keyword">WHERE</span> your_column = <span class="hljs-string">&#x27;some_value&#x27;</span>;<br></code></pre></td></tr></table></figure><p>è¿™æ¡å‘½ä»¤ä¼šè¿”å›ä¸€ä¸ªç»“æœé›†ï¼Œå±•ç¤ºäº†MySQLæ‰§è¡Œè¯¥æŸ¥è¯¢çš„è®¡åˆ’ã€‚</p><blockquote><p>EXPLAINè¾“å‡ºçš„å…³é”®åˆ—</p></blockquote><p><code>EXPLAIN</code>çš„è¾“å‡ºåŒ…å«äº†è®¸å¤šåˆ—ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›æœ€é‡è¦çš„åˆ—ï¼š</p><ol><li><strong>id</strong>ï¼šè¡¨ç¤ºSELECTçš„åºåˆ—å·ï¼Œç”¨äºåŒºåˆ†æŸ¥è¯¢ä¸­ä¸åŒéƒ¨åˆ†çš„æ‰§è¡Œé¡ºåºã€‚</li><li><strong>select_type</strong>ï¼šæŸ¥è¯¢çš„ç±»å‹ï¼Œå¦‚SIMPLEï¼ˆç®€å•è¡¨ï¼Œå³ä¸ä½¿ç”¨è¡¨è¿æ¥æˆ–å­æŸ¥è¯¢ï¼‰ï¼ŒPRIMARYï¼ˆä¸»æŸ¥è¯¢ï¼‰ï¼ŒSUBQUERYï¼ˆå­æŸ¥è¯¢ï¼‰ç­‰ã€‚</li><li><strong>table</strong>ï¼šæ˜¾ç¤ºè¿™ä¸€è¡Œçš„æ•°æ®æ˜¯å…³äºå“ªä¸ªè¡¨çš„ã€‚</li><li><strong>type</strong>ï¼šè¡¨ç¤ºè¿æ¥ç±»å‹ï¼Œæ˜¯ä¼˜åŒ–ä¸­éå¸¸é‡è¦çš„ä¸€ä¸ªæŒ‡æ ‡ï¼Œä»æœ€å¥½åˆ°æœ€å·®ä¾æ¬¡æ˜¯ï¼šsystem &gt; const &gt; eq_ref &gt; ref &gt; fulltext &gt; ref_or_null &gt; index_merge &gt; unique_subquery &gt; index_subquery &gt; range &gt; index &gt; ALLã€‚</li><li><strong>possible_keys</strong>ï¼šæ˜¾ç¤ºå¯èƒ½åº”ç”¨åœ¨è¿™å¼ è¡¨ä¸Šçš„ç´¢å¼•ã€‚</li><li><strong>key</strong>ï¼šå®é™…ä½¿ç”¨çš„ç´¢å¼•ã€‚å¦‚æœä¸ºNULLï¼Œåˆ™æ²¡æœ‰ä½¿ç”¨ç´¢å¼•ã€‚</li><li><strong>key_len</strong>ï¼šä½¿ç”¨çš„ç´¢å¼•çš„é•¿åº¦ã€‚åœ¨ä¸æŸå¤±ç²¾ç¡®æ€§çš„æƒ…å†µä¸‹ï¼Œé•¿åº¦è¶ŠçŸ­è¶Šå¥½ã€‚</li><li><strong>ref</strong>ï¼šæ˜¾ç¤ºç´¢å¼•çš„å“ªä¸€åˆ—è¢«ä½¿ç”¨äº†ã€‚</li><li><strong>rows</strong>ï¼šMySQLè®¤ä¸ºå¿…é¡»æ£€æŸ¥çš„ç”¨æ¥è¿”å›è¯·æ±‚æ•°æ®çš„è¡Œæ•°ã€‚</li><li><strong>Extra</strong>ï¼šåŒ…å«MySQLè§£å†³æŸ¥è¯¢çš„è¯¦ç»†ä¿¡æ¯ã€‚æ¯”å¦‚ï¼Œâ€œUsing indexâ€è¡¨ç¤ºç›¸åº”çš„SELECTæ“ä½œä½¿ç”¨äº†è¦†ç›–ç´¢å¼•ï¼Œé¿å…äº†è®¿é—®è¡¨çš„æ•°æ®è¡Œã€‚</li></ol><blockquote><p>ä½¿ç”¨EXPLAINè¿›è¡Œæ€§èƒ½ä¼˜åŒ–</p></blockquote><p>é€šè¿‡åˆ†æ<code>EXPLAIN</code>çš„è¾“å‡ºï¼Œä½ å¯ä»¥è·å¾—å¦‚ä½•ä¼˜åŒ–æŸ¥è¯¢çš„çº¿ç´¢ï¼š</p><ul><li><strong>ç¡®ä¿é€‚å½“çš„ç´¢å¼•è¢«ä½¿ç”¨</strong>ï¼šå¦‚æœ<code>key</code>åˆ—æ˜¯NULLï¼Œæˆ–è€…<code>type</code>åˆ—æ˜¾ç¤ºä¸ºALLæˆ–indexï¼Œå¯èƒ½éœ€è¦ä¼˜åŒ–ç´¢å¼•ã€‚</li><li><strong>æ£€æŸ¥è¿æ¥é¡ºåº</strong>ï¼šåœ¨<code>id</code>åˆ—ä¸­ï¼Œè¾ƒå¤§çš„å€¼è¡¨ç¤ºä¼˜å…ˆçº§è¾ƒé«˜çš„è¡¨ï¼Œä½ å¯ä»¥é€šè¿‡è°ƒæ•´æŸ¥è¯¢ç»“æ„æ¥æ”¹å˜è¿æ¥é¡ºåºã€‚</li><li><strong>ä¼˜åŒ–æŸ¥è¯¢ç»“æ„</strong>ï¼šæ ¹æ®<code>Extra</code>åˆ—çš„ä¿¡æ¯ï¼Œä½ å¯èƒ½éœ€è¦è°ƒæ•´æŸ¥è¯¢ç»“æ„ï¼Œå¦‚æ›´æ”¹JOINç±»å‹æˆ–é‡æ–°ç¼–å†™å­æŸ¥è¯¢ã€‚</li></ul><blockquote><p>æ³¨æ„äº‹é¡¹</p></blockquote><ul><li><strong>EXPLAINä¸æ‰§è¡ŒæŸ¥è¯¢</strong>ï¼šå®ƒåªæ˜¾ç¤ºMySQLå¦‚ä½•æ‰§è¡ŒæŸ¥è¯¢ï¼Œå®é™…ä¸Šå¹¶ä¸æ‰§è¡Œè¯¥æŸ¥è¯¢ã€‚</li><li><strong>ä¼°è®¡çš„è¡Œæ•°å¯èƒ½ä¸å‡†ç¡®</strong>ï¼š<code>rows</code>åˆ—æ˜¾ç¤ºçš„æ˜¯ä¼°è®¡çš„è¡Œæ•°ï¼Œè¿™ä¸ªä¼°è®¡å¯èƒ½åŸºäºè¡¨ç»Ÿè®¡æ•°æ®ï¼Œè€Œä¸æ˜¯å®é™…çš„è¡Œæ•°ã€‚</li></ul><p>å¹³æ—¶ç”¨è¿™ä¸ªè¿›è¡Œåˆ†æè¯­å¥çš„æ—¶å€™ï¼Œçœ‹çš„æœ€å¤šçš„ä¸‰ä¸ªå­—æ®µæ˜¯ï¼šselect_typeã€keyã€rows</p><ul><li>select_type : æŸ¥è¯¢ç±»å‹ï¼Œæœ‰ç®€å•æŸ¥è¯¢ã€è”åˆæŸ¥è¯¢ã€å­æŸ¥è¯¢ç­‰</li><li>key : ä½¿ç”¨çš„ç´¢å¼•</li><li>rows : æ‰«æçš„è¡Œæ•°</li></ul><p>æ€§èƒ½ä¼˜åŒ–æ³¨æ„çš„ç‚¹æ¯”è¾ƒå¤šï¼Œå»ºè®®çœ‹ä¸€ä¸‹è¿™ä¸ªï¼š </p><ul><li><a href="https://www.pdai.tech/md/db/sql-mysql/sql-mysql-performance.html">https://www.pdai.tech/md/db/sql-mysql/sql-mysql-performance.html</a></li></ul><p>æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</p><ul><li>ä¼˜åŒ–æ•°æ®è®¿é—®<ul><li><ol><li>å‡å°‘è¯·æ±‚çš„æ•°æ®é‡</li></ol></li><li><ol start="2"><li>å‡å°‘æœåŠ¡å™¨ç«¯æ‰«æçš„è¡Œæ•°</li></ol></li></ul></li><li>é‡æ„æŸ¥è¯¢æ–¹å¼<ul><li>1.åˆ‡åˆ†å¤§æŸ¥è¯¢</li><li>2.åˆ†è§£å¤§è¿æ¥æŸ¥è¯¢</li></ul></li></ul><p>å‚è€ƒ</p><ul><li><a href="https://gitee.com/moxi159753/LearningNotes/tree/master/MySQL/MySQL45%E8%AE%B2">https://gitee.com/moxi159753/LearningNotes/tree/master/MySQL/MySQL45%E8%AE%B2</a></li><li><a href="https://developer.huawei.com/consumer/cn/forum/topic/0204405591412170236">https://developer.huawei.com/consumer/cn/forum/topic/0204405591412170236</a></li><li><a href="https://javaguide.cn/database/mysql/mysql-questions-01.html">https://javaguide.cn/database/mysql/mysql-questions-01.html</a></li><li><a href="https://www.pdai.tech/md/db/sql-mysql/sql-mysql-overview.html">https://www.pdai.tech/md/db/sql-mysql/sql-mysql-overview.html</a></li><li><a href="https://www.yuque.com/snailclimb/mf2z3k/wghadf">https://www.yuque.com/snailclimb/mf2z3k/wghadf</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
      <category>MySQL</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mysql</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MySQLå­¦ä¹ _åŸºç¡€å†…å®¹01</title>
    <link href="/2023/12/22/MySQL%E5%AD%A6%E4%B9%A0_%E5%9F%BA%E7%A1%80%E5%86%85%E5%AE%B901/"/>
    <url>/2023/12/22/MySQL%E5%AD%A6%E4%B9%A0_%E5%9F%BA%E7%A1%80%E5%86%85%E5%AE%B901/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å¤§çº²</p></blockquote><ul><li>åŸºç¡€æ¶æ„</li><li>æ—¥å¿—ç³»ç»Ÿ</li><li>äº‹åŠ¡éš”ç¦»</li><li>MySQLç´¢å¼•</li><li>é”æœºåˆ¶</li><li>explain</li></ul><h3 id="1ã€åŸºç¡€æ¶æ„"><a href="#1ã€åŸºç¡€æ¶æ„" class="headerlink" title="1ã€åŸºç¡€æ¶æ„"></a>1ã€åŸºç¡€æ¶æ„</h3><p>MySQLçš„é€»è¾‘æ¶æ„å¯ä»¥ä»ä¸Šåˆ°ä¸‹åˆ†ä¸ºå‡ ä¸ªä¸»è¦å±‚æ¬¡ï¼š</p><ul><li>å®¢æˆ·ç«¯å±‚<ul><li>åŒ…æ‹¬äº†ç”¨æˆ·çš„æ¥å£ï¼Œå¦‚å‘½ä»¤è¡Œå®¢æˆ·ç«¯å’Œå›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ˆGUIï¼‰</li></ul></li><li>æœåŠ¡å±‚<ul><li>è¿æ¥å¤„ç†ï¼šç®¡ç†å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„è¿æ¥ï¼ŒåŒ…æ‹¬èº«ä»½è®¤è¯ã€‚</li><li>SQLæ¥å£ï¼šæ¥æ”¶SQLå‘½ä»¤ï¼Œå¹¶ä¸”è¿”å›æŸ¥è¯¢ç»“æœã€‚</li><li>è§£æå™¨ï¼šå°†SQLè¯­å¥åˆ†è§£æˆå¯ä»¥ç†è§£å’Œæ‰§è¡Œçš„éƒ¨åˆ†ã€‚</li><li>ä¼˜åŒ–å™¨ï¼šå†³å®šæœ€ä½³çš„æŸ¥è¯¢è·¯å¾„ã€‚</li><li>ç¼“å­˜&#x2F;ç¼“å†²ï¼šå­˜å‚¨æ•°æ®ï¼Œä»¥ä¾¿æ›´å¿«åœ°è®¿é—®ã€‚</li></ul></li><li>å­˜å‚¨å¼•æ“å±‚<ul><li>è´Ÿè´£MySQLä¸­æ•°æ®çš„å­˜å‚¨å’Œæå–ã€‚</li><li>MySQLçš„å­˜å‚¨å¼•æ“æ˜¯å¯æ’æ‹”çš„ï¼Œæœ€å¸¸è§çš„å¦‚InnoDBï¼ˆæ”¯æŒäº‹åŠ¡å’Œè¡Œçº§é”å®šï¼‰å’ŒMyISAMï¼ˆæ”¯æŒå…¨æ–‡æœç´¢ä½†ä¸æ”¯æŒäº‹åŠ¡ï¼‰ã€‚</li></ul></li><li>å­˜å‚¨å±‚<ul><li>å®é™…å­˜å‚¨æ•°æ®çš„åœ°æ–¹</li><li>åŒ…æ‹¬æ•°æ®æ–‡ä»¶ã€ç´¢å¼•æ–‡ä»¶ç­‰</li></ul></li></ul><p>æ¯ä¸€å±‚åœ¨MySQLçš„è¿è¡Œä¸­æ‰®æ¼”ç€å…³é”®è§’è‰²ï¼Œå¹¶ä¸”å®ƒä»¬å…±åŒå·¥ä½œä»¥å¤„ç†å’Œå­˜å‚¨æ•°æ®ã€‚<br>å®¢æˆ·ç«¯å±‚æ¥æ”¶ç”¨æˆ·è¾“å…¥çš„SQLæŸ¥è¯¢ï¼ŒæœåŠ¡å±‚å¯¹è¿™äº›æŸ¥è¯¢è¿›è¡Œå¤„ç†å’Œä¼˜åŒ–ï¼Œå­˜å‚¨å¼•æ“å±‚æ‰§è¡Œè¿™äº›æŸ¥è¯¢å¹¶é€šè¿‡å­˜å‚¨å±‚å¯¹æ•°æ®è¿›è¡Œç‰©ç†å­˜å‚¨å’Œä¿®æ”¹ã€‚</p><blockquote><p>é¤å…ä¸æ•°æ®åº“</p></blockquote><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç”¨ä¸€ä¸ªç±»æ¯”æ¥å¸®åŠ©ç†è§£ã€‚æƒ³è±¡MySQLæ˜¯ä¸€å®¶é¤å…ï¼š</p><p>å®¢æˆ·ç«¯å±‚åƒæ˜¯é¤å…çš„é¡¾å®¢ï¼Œä»–ä»¬ç‚¹èœï¼ˆå‘é€SQLæŸ¥è¯¢ï¼‰ã€‚</p><p>æœåŠ¡å±‚æ˜¯æœåŠ¡å‘˜ï¼Œä»–ä»¬æ¥æ”¶è®¢å•ï¼Œè§£é‡Šé¡¾å®¢çš„éœ€æ±‚ï¼ˆè§£æSQLï¼‰ï¼Œå¹¶å†³å®šå¦‚ä½•æœ€æœ‰æ•ˆåœ°å‡†å¤‡é£Ÿç‰©ï¼ˆä¼˜åŒ–æŸ¥è¯¢ï¼‰ã€‚<br>å­˜å‚¨å¼•æ“å±‚åƒæ˜¯å¨å¸ˆï¼Œæ ¹æ®æœåŠ¡å‘˜ç»™å‡ºçš„è®¢å•æ¥å‡†å¤‡é£Ÿç‰©ï¼ˆæ‰§è¡ŒSQLæŸ¥è¯¢ï¼‰ã€‚</p><p>å­˜å‚¨å±‚åˆ™æ˜¯å†°ç®±å’Œå‚¨è—å®¤ï¼Œå­˜å‚¨ç€æ‰€æœ‰é£Ÿæï¼ˆæ•°æ®ï¼‰ã€‚</p><p>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªå‘˜å·¥å’Œæ¯ä¸ªå­˜å‚¨åŒºéƒ½å¿…é¡»åè°ƒä¸€è‡´ï¼Œä»¥ç¡®ä¿é£Ÿç‰©ï¼ˆæ•°æ®ï¼‰çš„è´¨é‡å’ŒæœåŠ¡çš„æ•ˆç‡ã€‚</p><blockquote><p>é»˜è®¤å­˜å‚¨å¼•æ“</p></blockquote><p>ç°åœ¨æœ€å¸¸ç”¨çš„å­˜å‚¨å¼•æ“æ˜¯ InnoDBï¼Œå®ƒä» MySQL 5.5.5 ç‰ˆæœ¬å¼€å§‹æˆä¸ºäº†é»˜è®¤å­˜å‚¨å¼•æ“ã€‚</p><blockquote><p>Serverå±‚å’Œå­˜å‚¨å¼•æ“å±‚</p></blockquote><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202312221022103.png" alt="image.png|600"></p><p>å°†è¿™ä¸ªæè¿°ä¸ä¸Šé¢çš„ç±»æ¯”ç»“åˆèµ·æ¥ï¼Œå¯ä»¥è¿™æ ·ç†è§£ï¼š</p><ol><li><strong>Serverå±‚</strong>ï¼š<ul><li>è¿™ä¸€å±‚å¯ä»¥è¢«è§†ä¸ºé¤å…çš„å‰å°å’ŒæœåŠ¡åŒºåŸŸã€‚</li><li><strong>è¿æ¥å™¨</strong>ï¼šé¤å…çš„æ¥å¾…å°ï¼Œè´Ÿè´£è¿æ¥é¡¾å®¢ï¼ˆå»ºç«‹å®¢æˆ·ç«¯è¿æ¥ï¼‰ã€‚</li><li><strong>æŸ¥è¯¢ç¼“å­˜</strong>ï¼šå·²ç»å‡†å¤‡å¥½çš„èœè‚´ï¼Œå¯ä»¥ç«‹å³æä¾›ç»™é¡¾å®¢ï¼Œæ— éœ€å†æ¬¡ç­‰å¾…å¨å¸ˆå‡†å¤‡ï¼ˆç¼“å­˜ä¹‹å‰çš„æŸ¥è¯¢ç»“æœï¼‰ã€‚</li><li><strong>åˆ†æå™¨</strong>ï¼šæœåŠ¡å‘˜å¬é¡¾å®¢ç‚¹èœå¹¶ç¡®è®¤èœå•ä¸Šæœ‰è¿™é“èœï¼ˆè§£æSQLæŸ¥è¯¢ï¼Œæ£€æŸ¥è¯­æ³•ï¼‰ã€‚</li><li><strong>ä¼˜åŒ–å™¨</strong>ï¼šæœåŠ¡å‘˜å†³å®šä¸ºé¡¾å®¢æœåŠ¡çš„é¡ºåºï¼Œä»¥ç¡®ä¿æ•ˆç‡ï¼ˆå†³å®šæŸ¥è¯¢çš„æœ€ä¼˜æ‰§è¡Œè®¡åˆ’ï¼‰ã€‚</li><li><strong>æ‰§è¡Œå™¨</strong>ï¼šæœåŠ¡å‘˜å°†é¡¾å®¢çš„è®¢å•ä¼ è¾¾ç»™å¨å¸ˆå¹¶ç¡®ä¿èœè‚´èƒ½å¤ŸæŒ‰è¦æ±‚å‡ºå“ï¼ˆæ‰§è¡ŒæŸ¥è¯¢ï¼‰ã€‚</li><li>æ­¤å±‚åŒ…å«æ‰€æœ‰çš„å†…ç½®å‡½æ•°ï¼Œå°±åƒé¤å…æœ‰å„ç§è°ƒå‘³å“å’Œçƒ¹é¥ªæ–¹æ³•å¯ä¾›é€‰æ‹©ã€‚</li><li>è·¨å­˜å‚¨å¼•æ“çš„åŠŸèƒ½ï¼Œå¦‚å­˜å‚¨è¿‡ç¨‹ã€è§¦å‘å™¨ã€è§†å›¾ï¼Œéƒ½åƒæ˜¯é¤å…æä¾›çš„ç‰¹æ®ŠæœåŠ¡ï¼Œæ— è®ºä½¿ç”¨å“ªä¸ªå¨æˆ¿ï¼ˆå­˜å‚¨å¼•æ“ï¼‰ï¼Œéƒ½å¯ä»¥æä¾›ã€‚</li></ul></li><li><strong>å­˜å‚¨å¼•æ“å±‚</strong>ï¼š<ul><li>è¿™ä¸€å±‚ç›¸å½“äºé¤å…çš„å¨æˆ¿ã€‚</li><li>æ¯ä¸ªå­˜å‚¨å¼•æ“éƒ½åƒæ˜¯ä¸€ä¸ªä¸“é—¨çš„çƒ¹é¥ªåŒºåŸŸï¼Œæœ‰ç€ä¸åŒçš„çƒ¹é¥ªæŠ€æœ¯å’Œè®¾å¤‡ï¼ˆå¦‚InnoDBæ”¯æŒäº‹åŠ¡ï¼ŒMyISAMæä¾›å…¨æ–‡æœç´¢åŠŸèƒ½ï¼‰ã€‚</li><li>å­˜å‚¨å¼•æ“è´Ÿè´£æ•°æ®çš„ç‰©ç†å­˜å‚¨å’Œæ£€ç´¢ï¼Œå°±åƒå¨å¸ˆä»¬ç®¡ç†é£Ÿæå¹¶å°†å…¶åˆ¶ä½œæˆèœè‚´ä¸€æ ·ã€‚</li></ul></li></ol><blockquote><p>å¯¹äºSQLçš„è§£æå’Œä¼˜åŒ–</p></blockquote><ul><li><strong>SQLè§£æ</strong>ï¼šå½“æœåŠ¡å±‚æ¥æ”¶åˆ°å®¢æˆ·ç«¯å±‚å‘é€çš„SQLè¯­å¥åï¼Œå®ƒé¦–å…ˆè¿›è¡Œè¯­æ³•æ£€æŸ¥å’Œè§£æï¼Œå°†SQLåˆ†è§£ä¸ºè§£ææ ‘ã€‚</li><li><strong>SQLä¼˜åŒ–</strong>ï¼šç„¶åï¼Œä¼˜åŒ–å™¨ä¼šè¯„ä¼°å¤šä¸ªå¯èƒ½çš„æŸ¥è¯¢æ‰§è¡Œè®¡åˆ’ï¼Œå¹¶é€‰æ‹©ä¸€ä¸ªæˆæœ¬æœ€ä½ï¼ˆé€šå¸¸æ˜¯æ‰§è¡Œæ—¶é—´æœ€çŸ­ï¼‰çš„è®¡åˆ’</li></ul><blockquote><p>è¿æ¥å™¨</p></blockquote><p>å»ºè®®åœ¨ä½¿ç”¨ä¸­è¦å°½é‡å‡å°‘å»ºç«‹è¿æ¥çš„åŠ¨ä½œï¼Œä¹Ÿå°±æ˜¯å°½é‡ä½¿ç”¨é•¿è¿æ¥ã€‚</p><p>ä½†å¦‚æœä½¿ç”¨é•¿è¿æ¥ï¼ŒæœåŠ¡å™¨éœ€è¦ä¸€ç›´åˆ†é…èµ„æºç»™è¿™äº›è¿æ¥ï¼ˆåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸´æ—¶ä½¿ç”¨çš„å†…å­˜æ˜¯ç®¡ç†åœ¨è¿æ¥å¯¹è±¡é‡Œé¢ï¼‰ï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œå¦‚æœæœ‰å¾ˆå¤šå¤§çš„æ“ä½œï¼Œå®ƒå ç”¨çš„å†…å­˜å°±ä¼šè¶Šæ¥è¶Šå¤§ï¼Œæœ€ç»ˆå¯èƒ½ä¼šè€—å°½å†…å­˜ï¼Œå¯¼è‡´æ•°æ®åº“æœåŠ¡å´©æºƒã€‚</p><p>è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæœ‰ä¸¤ä¸ªæ–¹æ³•ï¼š</p><ol><li><strong>å®šæœŸæ–­å¼€è¿æ¥</strong>ï¼šå°±åƒå®šæœŸæ¸…ç†æ‰‹æœºåå°è¿è¡Œçš„åº”ç”¨ï¼Œä»¥é‡Šæ”¾å†…å­˜ï¼Œä¿æŒæ‰‹æœºè¿è¡Œæµç•…ã€‚ä½ å¯ä»¥åœ¨æ•°æ®åº“ä¸­ï¼Œç”¨å®Œè¿æ¥åæˆ–è€…æ‰§è¡Œäº†ä¸€äº›å¤§æŸ¥è¯¢æ“ä½œä¹‹åï¼Œæ–­å¼€è¿æ¥ï¼Œä¸‹æ¬¡éœ€è¦æ—¶å†é‡æ–°è¿æ¥ã€‚</li><li><strong>ä½¿ç”¨mysql_reset_connection</strong>ï¼šå¦‚æœä½ ç”¨çš„æ˜¯MySQL 5.7æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œè¿™å°±åƒç»™æ‰‹æœºåšä¸ªå¿«é€Ÿé‡å¯ï¼Œæ¸…é™¤æ‰€æœ‰è¿è¡Œçš„ç¨‹åºä½†ä¸å®Œå…¨å…³æœºï¼Œè¿™æ ·å¯ä»¥è¿…é€Ÿé‡Šæ”¾å†…å­˜ã€‚<code>mysql_reset_connection</code>å‘½ä»¤å¯ä»¥é‡ç½®è¿æ¥çš„çŠ¶æ€ï¼Œä½†ä¸éœ€è¦åƒå®Œå…¨æ–­å¼€è¿æ¥é‚£æ ·å†æ¬¡è¿›è¡Œç¹ççš„æ¡æ‰‹å’Œæƒé™éªŒè¯ã€‚</li></ol><blockquote><p>æŸ¥è¯¢ç¼“å­˜</p></blockquote><p>ä½œç”¨ï¼šä½œä¸ºæŸ¥è¯¢ç¼“å­˜</p><ol><li>å½“ä½ æ‰§è¡Œä¸€ä¸ª<code>SELECT</code>è¯­å¥æ—¶ï¼ŒMySQLä¼šæ£€æŸ¥æŸ¥è¯¢ç¼“å­˜ã€‚</li><li>å¦‚æœä¹‹å‰æ‰§è¡Œè¿‡ç›¸åŒçš„æŸ¥è¯¢ï¼ˆè¿™é‡Œçš„â€œç›¸åŒâ€æ„å‘³ç€å­—èŠ‚åˆ°å­—èŠ‚çš„å®Œå…¨åŒ¹é…ï¼‰ï¼Œå¹¶ä¸”ç»“æœå·²ç»ç¼“å­˜ï¼ŒMySQLå°±ä¼šç«‹å³è¿”å›ç»“æœï¼Œä¸ç”¨å†æ¬¡æ‰§è¡ŒæŸ¥è¯¢ã€‚</li><li>æŸ¥è¯¢çš„æ–‡æœ¬æ˜¯ç¼“å­˜çš„â€œkeyâ€ï¼ŒæŸ¥è¯¢çš„ç»“æœæ˜¯â€œvalueâ€ã€‚</li></ol><p>ç¼ºç‚¹ï¼š</p><ul><li>æŸ¥è¯¢ç¼“å­˜æ¯å½“è¡¨æ›´æ–°æ—¶å°±ä¼šå¤±æ•ˆã€‚å¦‚æœè¡¨ç»å¸¸æ›´æ–°ï¼Œé‚£ä¹ˆç¼“å­˜çš„å‘½ä¸­ç‡å°±ä¼šéå¸¸ä½ã€‚</li><li>æ¯æ¬¡è¡¨æ›´æ–°ï¼Œæ‰€æœ‰ç›¸å…³çš„ç¼“å­˜éƒ½ä¼šè¢«æ¸…ç©ºã€‚è¿™æ„å‘³ç€ï¼Œå³ä½¿ä½ çš„æŸ¥è¯¢ç»“æœè¢«å­˜å…¥ç¼“å­˜ï¼Œä½†å¦‚æœè¡¨ä¸€æ›´æ–°ï¼Œè¿™äº›ç»“æœå°±ä¼šæ¶ˆå¤±ã€‚</li></ul><p>å› ä¸ºè¿™äº›é™åˆ¶ï¼Œå¯¹äºé‚£äº›æ•°æ®æ›´æ–°é¢‘ç¹çš„ç³»ç»Ÿï¼Œå¯ç”¨æŸ¥è¯¢ç¼“å­˜å¯èƒ½ä¼šå¸¦æ¥æ›´å¤šçš„æ€§èƒ½å¼€é”€è€Œä¸æ˜¯å¥½å¤„ã€‚åªæœ‰åœ¨æ•°æ®å¾ˆå°‘å˜åŠ¨çš„æƒ…å†µä¸‹ï¼Œæ¯”å¦‚æŸäº›é…ç½®è¡¨ï¼ŒæŸ¥è¯¢ç¼“å­˜æ‰å¯èƒ½æé«˜æ€§èƒ½ã€‚</p><p>å¦‚æœä½ è¿˜æ˜¯æƒ³è¦åˆ©ç”¨æŸ¥è¯¢ç¼“å­˜ï¼Œå¯ä»¥å°†<code>query_cache_type</code>è®¾ç½®ä¸º<code>DEMAND</code>ã€‚è¿™æ ·ï¼Œåªæœ‰é‚£äº›ä½ æ˜¾å¼æŒ‡å®šä¸º<code>SQL_CACHE</code>çš„æŸ¥è¯¢æ‰ä¼šä½¿ç”¨æŸ¥è¯¢ç¼“å­˜ï¼Œå°±åƒè¿™æ ·ï¼š</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql"><span class="hljs-keyword">SELECT</span> SQL_CACHE * <span class="hljs-keyword">FROM</span> T <span class="hljs-keyword">WHERE</span> ID=<span class="hljs-number">10</span>;<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä»MySQL 8.0ç‰ˆæœ¬å¼€å§‹ï¼ŒæŸ¥è¯¢ç¼“å­˜åŠŸèƒ½è¢«å®Œå…¨ç§»é™¤äº†ã€‚è¿™æ˜¯å› ä¸ºåœ¨å®è·µä¸­ï¼Œç»´æŠ¤æŸ¥è¯¢ç¼“å­˜é€šå¸¸ä¼šå¯¼è‡´æ›´å¤šçš„æ€§èƒ½é—®é¢˜ï¼Œè€Œç°ä»£çš„æ•°æ®åº“ç³»ç»Ÿæœ‰æ›´é«˜æ•ˆçš„æ–¹å¼æ¥æé«˜æŸ¥è¯¢æ€§èƒ½ï¼Œæ¯”å¦‚æ›´å¥½çš„ç´¢å¼•å’Œä¼˜åŒ–å™¨ç­–ç•¥ã€‚</p><p>æ‰€ä»¥ï¼Œåœ¨æœ€æ–°çš„MySQLç‰ˆæœ¬ä¸­ï¼Œä¸éœ€è¦ä¹Ÿä¸èƒ½ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜äº†ã€‚</p><blockquote><p>åˆ†æå™¨</p></blockquote><ul><li>è¯æ³•åˆ†æ</li><li>è¯­æ³•åˆ†æ</li></ul><blockquote><p>ä¼˜åŒ–å™¨:  å†³å®šæŸ¥è¯¢çš„æœ€ä¼˜æ‰§è¡Œè®¡åˆ’</p></blockquote><blockquote><p>æ‰§è¡Œå™¨ï¼šæ‰§è¡ŒæŸ¥è¯¢ï¼ˆæ“ä½œå­˜å‚¨å¼•æ“ï¼Œè¿”å›ç»“æœï¼‰</p></blockquote><h3 id="2ã€æ—¥å¿—ç³»ç»Ÿ"><a href="#2ã€æ—¥å¿—ç³»ç»Ÿ" class="headerlink" title="2ã€æ—¥å¿—ç³»ç»Ÿ"></a>2ã€æ—¥å¿—ç³»ç»Ÿ</h3><p>MySQLçš„æ—¥å¿—ç³»ç»Ÿæ˜¯å…¶æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€ï¼Œå°±åƒé»‘åŒ£å­ä¸€æ ·ï¼Œè®°å½•äº†å‘ç”Ÿåœ¨æ•°æ®åº“ä¸­çš„æ‰€æœ‰å…³é”®æ´»åŠ¨ã€‚å®ƒåŒ…æ‹¬å¤šç§ç±»å‹çš„æ—¥å¿—ï¼Œæ¯ç§æ—¥å¿—è®°å½•ä¸åŒç±»å‹çš„ä¿¡æ¯ï¼Œå¯¹äºæ•°æ®åº“çš„æ¢å¤ã€ä¼˜åŒ–å’Œæ•…éšœæ’é™¤éƒ½è‡³å…³é‡è¦ã€‚</p><p>ä¸‹é¢æ˜¯MySQLæ—¥å¿—ç³»ç»Ÿä¸­æœ€é‡è¦çš„å‡ ç§æ—¥å¿—ç±»å‹ï¼š</p><ul><li>é”™è¯¯æ—¥å¿—</li><li>æŸ¥è¯¢æ—¥å¿—ï¼ˆé€šç”¨æŸ¥è¯¢æ—¥å¿—ï¼‰</li><li>äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆbinlogï¼‰</li><li>æ…¢æŸ¥è¯¢æ—¥å¿—</li><li>ä¸­ç»§æ—¥å¿—ï¼ˆRelay Logï¼‰</li><li>InnoDBé‡åšæ—¥å¿—ï¼ˆRedo Logï¼‰</li><li>InnoDBå›æ»šæ—¥å¿—ï¼ˆUndo Logï¼‰</li></ul><blockquote><p>é”™è¯¯æ—¥å¿—</p></blockquote><p>é”™è¯¯æ—¥å¿—å°±åƒæ˜¯åŒ»ç”Ÿçš„è¯Šæ–­è®°å½•ï¼Œå®ƒè®°å½•MySQLæœåŠ¡å™¨å¯åŠ¨ã€è¿è¡Œæˆ–åœæ­¢æ—¶é‡åˆ°çš„é—®é¢˜ã€‚å¦‚æœæ•°æ®åº“å‡ºç°é—®é¢˜ï¼Œè¿™æ˜¯ç¬¬ä¸€ä¸ªè¦æŸ¥çœ‹çš„åœ°æ–¹ã€‚è¿™é‡Œä¼šæœ‰å…³äºä»»ä½•é”™è¯¯çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æœåŠ¡å¯åŠ¨å¤±è´¥çš„åŸå› ã€‚</p><blockquote><p>æŸ¥è¯¢æ—¥å¿—ï¼ˆé€šç”¨æŸ¥è¯¢æ—¥å¿—ï¼‰</p></blockquote><p>æŸ¥è¯¢æ—¥å¿—è®°å½•äº†æ‰€æœ‰å¯¹MySQLæœåŠ¡å™¨çš„è¯·æ±‚ï¼Œæ— è®ºè¿™äº›è¯·æ±‚æ˜¯å¦å¾—åˆ°äº†æ‰§è¡Œã€‚å¯ä»¥æŠŠå®ƒçœ‹ä½œæ˜¯å•†åº—çš„å®¢æµè®°å½•å™¨ï¼Œè®°å½•æ¯ä¸€ä¸ªè¿›é—¨çš„é¡¾å®¢åŠå…¶è¯·æ±‚çš„å•†å“ã€‚</p><p>ç”±äºè®°å½•äº†æ‰€æœ‰æ´»åŠ¨ï¼ŒåŒ…æ‹¬æ¯æ¡SQLè¯­å¥çš„æ–‡å­—è®°å½•ï¼Œè¿™ä¸ªæ—¥å¿—å¾ˆå®¹æ˜“å˜å¾—éå¸¸å¤§ï¼Œå› æ­¤åœ¨é«˜è´Ÿè½½ç³»ç»Ÿä¸­é€šå¸¸ä¸æ¨èå¼€å¯ã€‚</p><blockquote><p>äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆbinlogï¼‰</p></blockquote><p>äºŒè¿›åˆ¶æ—¥å¿—æ˜¯æ•°æ®åº“æ´»åŠ¨çš„è¯¦ç»†è®°å½•ï¼ŒåŒ…æ‹¬æ‰€æœ‰ä¿®æ”¹æ•°æ®æˆ–å¯èƒ½ä¿®æ”¹æ•°æ®çš„è¯­å¥ï¼ˆå¦‚<code>INSERT</code>ã€<code>UPDATE</code>ã€<code>DELETE</code>ï¼‰ã€‚å¯ä»¥å°†äºŒè¿›åˆ¶æ—¥å¿—è§†ä¸ºé£æœºçš„é»‘åŒ£å­ï¼Œè®°å½•é£è¡Œè¿‡ç¨‹ä¸­çš„æ‰€æœ‰é‡è¦äº‹ä»¶ã€‚</p><p>å®ƒå¯¹äºå¤åˆ¶å’Œæ•°æ®æ¢å¤æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œå› ä¸ºå®ƒå¯ä»¥ç”¨æ¥åœ¨å¦ä¸€å°æœåŠ¡å™¨ä¸Šé‡æ”¾æ•°æ®æ›´æ”¹ï¼Œæˆ–è€…åœ¨æ•°æ®ä¸¢å¤±åæ¢å¤æ•°æ®ã€‚</p><blockquote><p>æ…¢æŸ¥è¯¢æ—¥å¿—</p></blockquote><p>æ…¢æŸ¥è¯¢æ—¥å¿—è®°å½•æ‰§è¡Œæ—¶é—´è¶…è¿‡ç‰¹å®šæ—¶é•¿çš„æŸ¥è¯¢ã€‚</p><p>å°†å…¶æƒ³è±¡ä¸ºç›‘æ§æ‘„åƒå¤´ï¼Œç‰¹åˆ«å…³æ³¨é‚£äº›åœ¨å•†åº—é‡Œé€—ç•™æ—¶é—´è¿‡é•¿çš„é¡¾å®¢ã€‚è¿™å¯¹äºå‘ç°é‚£äº›éœ€è¦ä¼˜åŒ–çš„æŸ¥è¯¢éå¸¸æœ‰å¸®åŠ©ã€‚</p><blockquote><p>ä¸­ç»§æ—¥å¿—ï¼ˆRelay Logï¼‰</p></blockquote><p>åœ¨MySQLå¤åˆ¶è®¾ç½®ä¸­ï¼Œä»æœåŠ¡å™¨ä¸Šçš„ä¸­ç»§æ—¥å¿—è®°å½•äº†ä»ä¸»æœåŠ¡å™¨æ¥æ”¶åˆ°çš„æ‰€æœ‰äºŒè¿›åˆ¶æ—¥å¿—äº‹ä»¶ã€‚</p><p>ä»æœåŠ¡å™¨ä¸Šçš„å¤åˆ¶å­ç³»ç»Ÿä¼šè¯»å–è¿™äº›æ—¥å¿—ï¼Œå¹¶åº”ç”¨åˆ°ä»æœåŠ¡å™¨çš„æ•°æ®åº“ä¸­ã€‚è¿™ç±»ä¼¼äºæ¥åŠ›èµ›ä¸­ï¼Œæ¥åŠ›æ£’åœ¨è¿åŠ¨å‘˜ä¹‹é—´ä¼ é€’çš„è¿‡ç¨‹ã€‚</p><blockquote><p>InnoDBé‡åšæ—¥å¿—ï¼ˆRedo Logï¼‰</p></blockquote><p>InnoDBå­˜å‚¨å¼•æ“ä¸“ç”¨çš„æ—¥å¿—ï¼Œå®ƒè®°å½•äº†å¯¼è‡´æ•°æ®åº“çŠ¶æ€æ”¹å˜çš„æ‰€æœ‰æ“ä½œï¼Œç¡®ä¿åœ¨ç³»ç»Ÿå´©æºƒåèƒ½å¤Ÿæ¢å¤æ•°æ®ã€‚</p><p>å¯ä»¥æŠŠå®ƒçœ‹ä½œæ˜¯é£æœºä¸Šçš„é£è¡Œè®°å½•ä»ªï¼Œè®°å½•äº†é£è¡Œä¸­æ‰€æœ‰çš„æ“ä½œï¼Œä»¥ä¾¿åœ¨äº‹æ•…åé‡å»ºå‘ç”Ÿäº†ä»€ä¹ˆã€‚</p><blockquote><p>InnoDBå›æ»šæ—¥å¿—ï¼ˆUndo Logï¼‰</p></blockquote><p>å›æ»šæ—¥å¿—æ˜¯InnoDBç”¨æ¥å¤„ç†äº‹åŠ¡çš„ï¼Œå®ƒè®°å½•äº†æ•°æ®çš„æ—§ç‰ˆæœ¬ï¼Œä½¿å¾—æ•°æ®åº“èƒ½å¤Ÿâ€œå›æ»šâ€åˆ°ä»¥å‰çš„çŠ¶æ€ã€‚</p><p>å¯ä»¥æŠŠå®ƒæ¯”ä½œæ˜¯æ—¶å…‰æœºï¼Œèƒ½å¤ŸæŠŠäº‹æƒ…æ¢å¤åˆ°è¿‡å»æŸä¸ªæ—¶é—´ç‚¹çš„çŠ¶æ€ã€‚</p><h4 id="RedoLog-And-binlog"><a href="#RedoLog-And-binlog" class="headerlink" title="RedoLog And  binlog"></a>RedoLog And  binlog</h4><p><strong>InnoDBé‡åšæ—¥å¿—ï¼ˆRedo Logï¼‰ä¸ äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆbinlogï¼‰</strong></p><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹InnoDBçš„é‡åšæ—¥å¿—ï¼ˆRedo Logï¼‰å’ŒäºŒè¿›åˆ¶æ—¥å¿—ï¼ˆbinlogï¼‰çš„ä½œç”¨å’Œå®ƒä»¬åœ¨MySQLä¸­çš„åº”ç”¨ã€‚</p><blockquote><p>InnoDBé‡åšæ—¥å¿—ï¼ˆRedo Logï¼‰</p></blockquote><div style="background-color: #ecf0f1; color: #34495e; padding: 15px; border: 2px solid #bdc3c7; border-radius: 5px;">  <strong>Redo Logï¼š</strong>é‡åšæ—¥å¿—æ–‡ä»¶å¤§å°æ˜¯å›ºå®šçš„ï¼Œå¹¶ç»„æˆä¸€ä¸ªå¾ªç¯å†™å…¥çš„åºåˆ—ã€‚ï¼ˆæœ‰ä¸€ä¸ªæ“¦é™¤ç‚¹å’Œå†™å…¥ç‚¹ï¼Œæ–‡ä»¶æ»¡çš„æ—¶å€™éœ€è¦å…ˆæ“¦é™¤å†å†™å…¥ï¼‰</div><p>åœ¨InnoDBå­˜å‚¨å¼•æ“ä¸­ï¼Œé‡åšæ—¥å¿—ç”¨äºè®°å½•å¯¹æ•°æ®åº“æ‰€åšçš„æ¯ä¸ªå†™æ“ä½œï¼Œç¡®ä¿åœ¨ç³»ç»Ÿå´©æºƒåå¯ä»¥æ¢å¤è¿™äº›æ“ä½œã€‚</p><p>è¿™ä¸ªè¿‡ç¨‹ç±»ä¼¼äºä¼ ç»Ÿè´¦æœ¬ä¸ä¾¿ç¬ºçš„ä½¿ç”¨ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œå½“åº—ä¸»åœ¨ä¾¿ç¬ºä¸Šå¿«é€Ÿè®°ä¸‹å®¢æˆ·çš„è´­ä¹°è®°å½•ï¼Œä¹‹ååœ¨æ¯å¤©ç»“æŸæ—¶ï¼Œä»–ä¼šå°†è¿™äº›è®°å½•è¯¦ç»†åœ°è½¬ç§»åˆ°æ­£å¼çš„è´¦æœ¬ä¸­ã€‚ä¾¿ç¬ºä¸Šçš„è®°å½•å¯¹åº”äºé‡åšæ—¥å¿—ï¼Œè€Œæ­£å¼è´¦æœ¬å°±åƒæ˜¯æ•°æ®åº“æ–‡ä»¶ã€‚</p><p>é‡åšæ—¥å¿—æ˜¯å¾ªç¯ä½¿ç”¨çš„ï¼Œæœ‰ä¸€ä¸ªå›ºå®šçš„å¤§å°ã€‚å½“æ•°æ®åº“è¿›è¡Œå†™æ“ä½œæ—¶ï¼ŒInnoDBä¼šå°†æ“ä½œè¯¦æƒ…å†™å…¥é‡åšæ—¥å¿—ï¼Œå¹¶æ ‡è®°ä¸ºå‡†å¤‡ï¼ˆprepareï¼‰çŠ¶æ€ã€‚</p><p>éšåï¼Œåœ¨åˆé€‚çš„æ—¶æœºï¼Œè¿™äº›æ“ä½œä¼šè¢«å®é™…åº”ç”¨åˆ°ç£ç›˜ä¸Šçš„æ•°æ®æ–‡ä»¶ä¸­ã€‚</p><p>è¿™ç§ç­–ç•¥å…è®¸InnoDBå¼•æ“å¿«é€Ÿå“åº”å†™æ“ä½œï¼Œå› ä¸ºå®ƒä¸éœ€è¦æ¯æ¬¡éƒ½åŒæ­¥å†™å…¥ç£ç›˜ã€‚</p><hr><p>InnoDBçš„é‡åšæ—¥å¿—ï¼ˆRedo Logï¼‰åŒ…æ‹¬ä¸¤éƒ¨åˆ†ï¼šå†…å­˜ä¸­çš„é‡åšæ—¥å¿—ç¼“å†²ï¼ˆredo log bufferï¼‰å’Œç£ç›˜ä¸Šçš„é‡åšæ—¥å¿—æ–‡ä»¶ã€‚</p><ol><li><p><strong>é‡åšæ—¥å¿—ç¼“å†²ï¼ˆRedo Log Bufferï¼‰</strong>ï¼šè¿™æ˜¯å†…å­˜ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºæš‚æ—¶å­˜æ”¾é‚£äº›è¿˜æ²¡æœ‰è¢«å†™å…¥åˆ°ç£ç›˜é‡åšæ—¥å¿—æ–‡ä»¶çš„æ•°æ®ã€‚å½“äº‹åŠ¡è¢«æäº¤æ—¶ï¼Œäº‹åŠ¡çš„é‡åšæ—¥å¿—ä¿¡æ¯é¦–å…ˆè¢«å†™å…¥åˆ°è¿™ä¸ªç¼“å†²åŒºä¸­ã€‚</p></li><li><p><strong>é‡åšæ—¥å¿—æ–‡ä»¶ï¼ˆRedo Log Filesï¼‰</strong>ï¼šè¿™äº›æ˜¯å­˜æ”¾åœ¨ç£ç›˜ä¸Šçš„ç‰©ç†æ–‡ä»¶ï¼Œç”¨äºæŒä¹…ä¿å­˜é‡åšæ—¥å¿—æ•°æ®ã€‚å³ä½¿åœ¨ç³»ç»Ÿå´©æºƒçš„æƒ…å†µä¸‹ï¼Œç”±äºè¿™äº›ä¿¡æ¯è¢«å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼ŒInnoDBä¹Ÿå¯ä»¥åœ¨é‡å¯åä½¿ç”¨è¿™äº›æ—¥å¿—æ¥æ¢å¤æ•°æ®ã€‚</p></li></ol><p>å…³äºé‡åšæ—¥å¿—æ–‡ä»¶çš„å¤§å°ï¼Œå®ƒä»¬æ˜¯å›ºå®šçš„ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡MySQLçš„é…ç½®æ–‡ä»¶è¿›è¡Œè®¾ç½®ã€‚é€šå¸¸ï¼Œé‡åšæ—¥å¿—æ–‡ä»¶ç»„æˆä¸€ä¸ªå¾ªç¯å†™å…¥çš„åºåˆ—ï¼Œè¿™æ„å‘³ç€å½“æœ€åä¸€ä¸ªæ—¥å¿—æ–‡ä»¶å†™æ»¡åï¼Œç³»ç»Ÿä¼šå›åˆ°ç¬¬ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶å¼€å§‹è¦†ç›–æ—§çš„æ—¥å¿—ï¼ˆè¿™å–å†³äºæ—¥å¿—çš„å†™å…¥ä½ç½®å’Œæ£€æŸ¥ç‚¹çš„ä½ç½®ï¼‰ã€‚</p><p>åœ¨é…ç½®æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯<code>my.cnf</code>æˆ–<code>my.ini</code>ï¼‰ä¸­ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‚æ•°æ¥å®šä¹‰é‡åšæ—¥å¿—æ–‡ä»¶çš„å¤§å°å’Œæ•°é‡ï¼š</p><ul><li><code>innodb_log_file_size</code>ï¼šå®šä¹‰å•ä¸ªé‡åšæ—¥å¿—æ–‡ä»¶çš„å¤§å°ã€‚</li><li><code>innodb_log_files_in_group</code>ï¼šå®šä¹‰é‡åšæ—¥å¿—æ–‡ä»¶ç»„ä¸­æ–‡ä»¶çš„æ•°é‡ã€‚</li></ul><p>ä¾‹å¦‚ï¼Œå¦‚æœä½ è®¾ç½®<code>innodb_log_file_size</code>ä¸º512MBï¼Œå¹¶ä¸”è®¾ç½®<code>innodb_log_files_in_group</code>ä¸º4ï¼Œé‚£ä¹ˆæ€»å…±ä¼šæœ‰2GBçš„é‡åšæ—¥å¿—ç©ºé—´å¯ç”¨ï¼ˆ512MB * 4 &#x3D; 2048MBæˆ–2GBï¼‰ã€‚</p><p>é€‰æ‹©é€‚å½“çš„é‡åšæ—¥å¿—æ–‡ä»¶å¤§å°æ˜¯å¾ˆé‡è¦çš„ï¼Œå› ä¸ºå®ƒä¼šå½±å“æ•°æ®åº“çš„æ€§èƒ½å’Œæ¢å¤èƒ½åŠ›ã€‚å¦‚æœé‡åšæ—¥å¿—å¤ªå°ï¼Œå¯èƒ½ä¼šå¯¼è‡´é¢‘ç¹çš„I&#x2F;Oæ“ä½œï¼Œå› ä¸ºæ—¥å¿—ç©ºé—´ä¼šè¿…é€Ÿå¡«æ»¡å¹¶éœ€è¦é¢‘ç¹åœ°è¿›è¡Œæ—¥å¿—åˆ‡æ¢æ“ä½œã€‚å¦‚æœå¤ªå¤§ï¼Œæ¢å¤è¿‡ç¨‹å¯èƒ½ä¼šæ›´æ…¢ï¼Œå› ä¸ºInnoDBå¯èƒ½éœ€è¦å¤„ç†å¤§é‡çš„æ—¥å¿—æ•°æ®æ¥æ¢å¤çŠ¶æ€ã€‚é€šå¸¸ï¼Œè¿™ä¸ªå€¼åº”è¯¥æ ¹æ®ç³»ç»Ÿçš„è´Ÿè½½å’ŒI&#x2F;Oèƒ½åŠ›æ¥è°ƒæ•´ã€‚</p><blockquote><p>äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆbinlogï¼‰</p></blockquote><p>äºŒè¿›åˆ¶æ—¥å¿—è®°å½•äº†æ‰€æœ‰å¯¹æ•°æ®åº“è¿›è¡Œæ›´æ”¹çš„SQLè¯­å¥ã€‚å®ƒä¸æ˜¯ç‰¹å®šäºInnoDBçš„ï¼Œè€Œæ˜¯MySQLæœåŠ¡å™¨å±‚é¢çš„æ—¥å¿—ã€‚ä½ å¯ä»¥æŠŠå®ƒçœ‹ä½œæ˜¯ä¸€éƒ¨æ‘„åƒæœºï¼Œè®°å½•ä¸‹äº†å‘ç”Ÿçš„æ‰€æœ‰äº‹ä»¶ï¼Œæ— è®ºæ˜¯å¥½æ˜¯åã€‚</p><p>åœ¨æ•°æ®åº“éœ€è¦æ¢å¤æˆ–è€…è¿›è¡Œå¤åˆ¶è®¾ç½®æ—¶ï¼ŒäºŒè¿›åˆ¶æ—¥å¿—æ˜¯ä¸å¯æˆ–ç¼ºçš„ã€‚</p><p>ä¸é‡åšæ—¥å¿—ä¸åŒï¼ŒäºŒè¿›åˆ¶æ—¥å¿—æ˜¯é€»è¾‘æ—¥å¿—ï¼Œè®°å½•çš„æ˜¯å‘ç”Ÿäº†ä»€ä¹ˆï¼ˆä¾‹å¦‚â€œç»™ID&#x3D;2çš„è¿™ä¸€è¡Œçš„cå­—æ®µåŠ 1â€ï¼‰ï¼Œè€Œé‡åšæ—¥å¿—æ˜¯ç‰©ç†æ—¥å¿—ï¼Œè®°å½•çš„æ˜¯åœ¨å“ªä¸ªæ•°æ®é¡µä¸Šåšäº†ä¿®æ”¹ã€‚äºŒè¿›åˆ¶æ—¥å¿—æ˜¯æŒ‰é¡ºåºè¿½åŠ çš„ï¼Œå¹¶ä¸”ä¸ä¼šè¦†ç›–æ—§çš„æ—¥å¿—ã€‚</p><blockquote><p>ä¸¤è€…çš„ååŒå·¥ä½œä¸ä¸¤é˜¶æ®µæäº¤</p></blockquote><div style="background-color: #ced6e0; color: #34495e; padding: 15px; border: 2px solid #bdc3c7; border-radius: 5px;">  <strong>ä¸¤é˜¶æ®µæäº¤ï¼š</strong>åªæœ‰åœ¨é‡åšæ—¥å¿—å’ŒäºŒè¿›åˆ¶æ—¥å¿—éƒ½è¢«æˆåŠŸå†™å…¥åï¼Œäº‹åŠ¡æ‰ä¼šæäº¤ã€‚</div><p>å½“æ‰§è¡Œä¸€ä¸ªæ›´æ–°æ“ä½œæ—¶ï¼ŒInnoDBä¼šå…ˆå†™å…¥é‡åšæ—¥å¿—ï¼Œè¿™ä¸ªæ“ä½œä¼šæ ‡è®°ä¸ºprepareçŠ¶æ€ã€‚ä¸€æ—¦è¿™ä¸ªæ“ä½œè¢«å†™å…¥ï¼Œå³ä½¿ç³»ç»Ÿå´©æºƒï¼Œè¿™ä¸ªæ“ä½œä¹Ÿä¸ä¼šä¸¢å¤±ï¼Œç¡®ä¿äº†æ•°æ®åº“çš„crash-safeç‰¹æ€§ã€‚<strong>åªæœ‰åœ¨é‡åšæ—¥å¿—å’ŒäºŒè¿›åˆ¶æ—¥å¿—éƒ½è¢«æˆåŠŸå†™å…¥åï¼Œäº‹åŠ¡æ‰ä¼šæäº¤</strong>ã€‚</p><p>è¿™å°±å¼•å…¥äº†æ‰€è°“çš„â€œä¸¤é˜¶æ®µæäº¤â€ï¼š</p><ol><li><strong>å‡†å¤‡é˜¶æ®µ</strong>ï¼šäº‹åŠ¡çš„ä¿®æ”¹å…ˆè¢«å†™å…¥é‡åšæ—¥å¿—ï¼Œå¹¶å°†äº‹åŠ¡æ ‡è®°ä¸ºprepareçŠ¶æ€ã€‚</li><li><strong>æäº¤é˜¶æ®µ</strong>ï¼šäº‹åŠ¡çš„ä¿®æ”¹è¢«å†™å…¥äºŒè¿›åˆ¶æ—¥å¿—ï¼Œç„¶åInnoDBäº‹åŠ¡ä¼šæäº¤ï¼Œé‡åšæ—¥å¿—çš„çŠ¶æ€ä¼šå˜ä¸ºcommitã€‚</li></ol><p>è¿™ç§æœºåˆ¶ä¿è¯äº†å³ä½¿åœ¨äº‹åŠ¡æäº¤è¿‡ç¨‹ä¸­å‘ç”Ÿæ•…éšœï¼Œé‡åšæ—¥å¿—å’ŒäºŒè¿›åˆ¶æ—¥å¿—çš„çŠ¶æ€ä¹Ÿèƒ½ä¿æŒä¸€è‡´ã€‚è¿™å¯¹äºæ¢å¤åˆ°ç²¾ç¡®çš„æŸä¸€ç‚¹ä»¥åŠä¸»ä»å¤åˆ¶æ˜¯å¿…è¦çš„ï¼Œç¡®ä¿äº†æ•°æ®çš„ä¸€è‡´æ€§ã€‚</p><blockquote><p>åº”ç”¨åœºæ™¯</p></blockquote><p>åœ¨åº”ç”¨ä¸­ï¼Œä½ å¯ä»¥åˆ©ç”¨é‡åšæ—¥å¿—æ¥ç¡®ä¿äº‹åŠ¡çš„æŒä¹…æ€§å’ŒåŸå­æ€§ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœä½ çš„ç³»ç»Ÿçªç„¶æ–­ç”µæˆ–è€…å´©æºƒï¼Œé‡åšæ—¥å¿—å¯ä»¥ç”¨æ¥æ¢å¤æœªæäº¤çš„äº‹åŠ¡ï¼Œä»¥åŠç¡®ä¿å·²æäº¤çš„äº‹åŠ¡ä¸ä¼šä¸¢å¤±ã€‚</p><p>äºŒè¿›åˆ¶æ—¥å¿—ä¸»è¦ç”¨äºï¼š</p><ul><li><strong>æ•°æ®å¤åˆ¶</strong>ï¼šå°†binlogå†…å®¹å¤åˆ¶åˆ°ä»æœåŠ¡å™¨ï¼Œä»æœåŠ¡å™¨é‡æ”¾è¿™äº›æ“ä½œï¼Œä¿æŒå’Œä¸»æœåŠ¡å™¨çš„æ•°æ®ä¸€è‡´ã€‚</li><li><strong>æ•°æ®æ¢å¤</strong>ï¼šå½“éœ€è¦å°†æ•°æ®åº“æ¢å¤åˆ°è¿‡å»çš„æŸä¸ªçŠ¶æ€æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å…¨é‡å¤‡ä»½åŠ ä¸ŠäºŒè¿›åˆ¶æ—¥å¿—æ¥è¾¾åˆ°è¿™ä¸ªç›®çš„ã€‚</li></ul><p>ä¸¤é˜¶æ®µæäº¤ä¿è¯äº†åœ¨ä½¿ç”¨é‡åšæ—¥å¿—å’ŒäºŒè¿›åˆ¶æ—¥å¿—æ—¶ï¼Œç³»ç»Ÿçš„çŠ¶æ€æ˜¯ä¸€è‡´çš„ï¼Œè¿™å¯¹äºç¡®ä¿æ•°æ®çš„å‡†ç¡®æ€§å’Œå¯æ¢å¤æ€§éå¸¸é‡è¦ã€‚</p><blockquote><p>æ€è€ƒé¢˜ï¼š åœ¨ä»€ä¹ˆåœºæ™¯ä¸‹ï¼Œä¸€å¤©ä¸€å¤‡ä¼šæ¯”ä¸€å‘¨ä¸€å¤‡æ›´æœ‰ä¼˜åŠ¿å‘¢ï¼Ÿ</p></blockquote><p>æ—¥å¸¸å…¨é‡å¤‡ä»½ç›¸æ¯”å‘¨å¤‡ä»½çš„ä¼˜åŠ¿åœ¨äºå‡å°‘äº†æ•°æ®ä¸¢å¤±çš„é£é™©ã€‚å¦‚æœå‘ç”Ÿç¾éš¾ï¼Œä½ åªä¼šä¸¢å¤±ä¸€å¤©çš„æ•°æ®ï¼Œè€Œä¸æ˜¯ä¸€å‘¨çš„ã€‚è¿™ç›´æ¥å½±å“äº†æ•°æ®åº“ç³»ç»Ÿçš„æ¢å¤ç‚¹ç›®æ ‡ï¼ˆRecovery Point Objectiveï¼ŒRPOï¼‰ï¼Œå³åœ¨æ•°æ®ä¸¢å¤±äº‹ä»¶åæ•°æ®æ¢å¤çš„èƒ½åŠ›ã€‚</p><p>æ¯å¤©å¤‡ä»½çš„RPOæ˜æ˜¾å°äºæ¯å‘¨å¤‡ä»½ï¼Œå› æ­¤ä¸€å¤©ä¸€å¤‡çš„ç­–ç•¥æ›´é€‚åˆå¯¹æ•°æ®å‡†ç¡®æ€§è¦æ±‚è¾ƒé«˜çš„ç³»ç»Ÿã€‚</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://www.bilibili.com/video/BV1ve411F794">https://www.bilibili.com/video/BV1ve411F794</a></li><li><a href="https://gitee.com/moxi159753/LearningNotes/tree/master/MySQL/MySQL45%E8%AE%B2">https://gitee.com/moxi159753/LearningNotes/tree/master/MySQL/MySQL45%E8%AE%B2</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
      <category>MySQL</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mysql</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä»Javaæ„å»ºçº¿ç¨‹çš„æ–¹å¼åˆ°çº¿ç¨‹æ± ThreadPoolExecutoræºç å‰–æ</title>
    <link href="/2023/12/21/Java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B_%E4%BB%8EJava%E6%9E%84%E5%BB%BA%E7%BA%BF%E7%A8%8B%E7%9A%84%E6%96%B9%E5%BC%8F%E5%88%B0%E7%BA%BF%E7%A8%8B%E6%B1%A0ThreadPoolExecutor%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/"/>
    <url>/2023/12/21/Java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B_%E4%BB%8EJava%E6%9E%84%E5%BB%BA%E7%BA%BF%E7%A8%8B%E7%9A%84%E6%96%B9%E5%BC%8F%E5%88%B0%E7%BA%BF%E7%A8%8B%E6%B1%A0ThreadPoolExecutor%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å¤§çº²</p></blockquote><ul><li>Java æ„å»ºçº¿ç¨‹çš„æ–¹å¼</li><li>çº¿ç¨‹æ± çš„7ä¸ªå‚æ•°</li><li>çº¿ç¨‹æ± çš„æ‰§è¡Œæµç¨‹</li><li>çº¿ç¨‹æ± å±æ€§æ ‡è¯†</li><li>çº¿ç¨‹æ± çš„ execute æ–¹æ³•æ‰§è¡Œ</li><li>Worker çš„å°è£…</li></ul><blockquote><p>ä»Javaæ„å»ºçº¿ç¨‹çš„æ–¹å¼åˆ°çº¿ç¨‹æ± ThreadPoolExecutoræºç å‰–æ</p></blockquote><h3 id="ä¸€ã€Java-æ„å»ºçº¿ç¨‹çš„æ–¹å¼ï¼ˆå¸¸è¯†ï¼‰"><a href="#ä¸€ã€Java-æ„å»ºçº¿ç¨‹çš„æ–¹å¼ï¼ˆå¸¸è¯†ï¼‰" class="headerlink" title="ä¸€ã€Java æ„å»ºçº¿ç¨‹çš„æ–¹å¼ï¼ˆå¸¸è¯†ï¼‰"></a>ä¸€ã€Java æ„å»ºçº¿ç¨‹çš„æ–¹å¼ï¼ˆå¸¸è¯†ï¼‰</h3><ul><li>ç»§æ‰¿ Thread</li><li>å®ç° Runnable</li><li>å®ç° Callable</li><li>çº¿ç¨‹æ± æ–¹å¼ï¼ˆJavaæä¾›äº†æ„å»ºçº¿ç¨‹æ± çš„æ–¹å¼ï¼‰<ul><li>Javaæä¾›äº† Executors å¯ä»¥å»åˆ›å»ºï¼ˆè§„èŒƒä¸­ä¸å…è®¸ä½¿ç”¨è¿™ç§æ–¹å¼åˆ›å»ºçº¿ç¨‹æ± ï¼Œè¿™ç§æ–¹å¼å¯¹çº¿ç¨‹çš„æ§åˆ¶ç²’åº¦æ¯”è¾ƒä½ï¼‰</li><li>æ¨èæ‰‹åŠ¨åˆ›å»ºçº¿ç¨‹æ± </li></ul></li></ul><h3 id="äºŒã€çº¿ç¨‹æ± çš„7ä¸ªå‚æ•°ï¼ˆå¸¸è¯†ï¼‰"><a href="#äºŒã€çº¿ç¨‹æ± çš„7ä¸ªå‚æ•°ï¼ˆå¸¸è¯†ï¼‰" class="headerlink" title="äºŒã€çº¿ç¨‹æ± çš„7ä¸ªå‚æ•°ï¼ˆå¸¸è¯†ï¼‰"></a>äºŒã€çº¿ç¨‹æ± çš„7ä¸ªå‚æ•°ï¼ˆå¸¸è¯†ï¼‰</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ThreadPoolExecutor</span><span class="hljs-params">(<span class="hljs-type">int</span> corePoolSize,   <span class="hljs-comment">//æ ¸å¿ƒçº¿ç¨‹æ± </span></span></span><br><span class="hljs-params"><span class="hljs-function">                          <span class="hljs-type">int</span> maximumPoolSize,   <span class="hljs-comment">//æœ€å¤§çº¿ç¨‹æ•°</span></span></span><br><span class="hljs-params"><span class="hljs-function">                          <span class="hljs-type">long</span> keepAliveTime,    <span class="hljs-comment">//æœ€å¤§ç©ºé—²æ—¶é—´</span></span></span><br><span class="hljs-params"><span class="hljs-function">                          TimeUnit unit,         <span class="hljs-comment">//æ—¶é—´å•ä½</span></span></span><br><span class="hljs-params"><span class="hljs-function">                          BlockingQueue&lt;Runnable&gt; workQueue,  <span class="hljs-comment">//é˜»å¡é˜Ÿåˆ—</span></span></span><br><span class="hljs-params"><span class="hljs-function">                          ThreadFactory threadFactory,        <span class="hljs-comment">//çº¿ç¨‹å·¥å‚</span></span></span><br><span class="hljs-params"><span class="hljs-function">                          RejectedExecutionHandler handler)</span> </span>&#123;   <span class="hljs-comment">//æ‹’ç»ç­–ç•¥</span><br></code></pre></td></tr></table></figure><h3 id="ä¸‰ã€çº¿ç¨‹æ± çš„æ‰§è¡Œæµç¨‹ï¼ˆå¸¸è¯†ï¼‰"><a href="#ä¸‰ã€çº¿ç¨‹æ± çš„æ‰§è¡Œæµç¨‹ï¼ˆå¸¸è¯†ï¼‰" class="headerlink" title="ä¸‰ã€çº¿ç¨‹æ± çš„æ‰§è¡Œæµç¨‹ï¼ˆå¸¸è¯†ï¼‰"></a>ä¸‰ã€çº¿ç¨‹æ± çš„æ‰§è¡Œæµç¨‹ï¼ˆå¸¸è¯†ï¼‰</h3><blockquote><p>çº¿ç¨‹æ± æ‰§è¡Œæµç¨‹</p></blockquote><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231221203519.png" alt="image.png"></p><p>ä¸ºä»€ä¹ˆè¦å…ˆè¿›é˜»å¡å†å»å°è¯•åˆ›å»ºéæ ¸å¿ƒçº¿ç¨‹ï¼š</p><p>é¥­åº—ï¼ˆçº¿ç¨‹æ± ï¼‰ - å¨å­ï¼ˆçº¿ç¨‹ï¼‰ - äººå¤šå…ˆæ’é˜Ÿï¼ˆé˜»å¡é˜Ÿåˆ—ï¼‰- æ‹›å¨å­ï¼ˆåˆ›å»ºæœ€å¤§çº¿ç¨‹æ•°ï¼‰ - ä»Šæ—¥å®¢æ»¡ï¼ˆæ‹’ç»ç­–ç•¥ï¼‰</p><h3 id="å››ã€çº¿ç¨‹æ± å±æ€§æ ‡è¯†"><a href="#å››ã€çº¿ç¨‹æ± å±æ€§æ ‡è¯†" class="headerlink" title="å››ã€çº¿ç¨‹æ± å±æ€§æ ‡è¯†"></a>å››ã€çº¿ç¨‹æ± å±æ€§æ ‡è¯†</h3><h4 id="4-1-çº¿ç¨‹æ± å±æ€§"><a href="#4-1-çº¿ç¨‹æ± å±æ€§" class="headerlink" title="4.1 çº¿ç¨‹æ± å±æ€§"></a>4.1 çº¿ç¨‹æ± å±æ€§</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//ctl æ˜¯ä¸€ä¸ªint ç±»å‹çš„æ•°å€¼ï¼Œè¡¨è¾¾äº†ä¸¤ä¸ªæ„æ€ï¼Œ1ï¼šå£°æ˜å½“å‰çº¿ç¨‹æ± çš„çŠ¶æ€, 2: å£°æ˜çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°</span><br><span class="hljs-comment">//é«˜3ä½æ˜¯ï¼šçº¿ç¨‹æ± çŠ¶æ€</span><br><span class="hljs-comment">//ä½29ä½æ˜¯ï¼š çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹ä¸ªæ•°</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">AtomicInteger</span> <span class="hljs-variable">ctl</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicInteger</span>(ctlOf(RUNNING, <span class="hljs-number">0</span>));  <br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">COUNT_BITS</span> <span class="hljs-operator">=</span> Integer.SIZE - <span class="hljs-number">3</span>;  <span class="hljs-comment">//29ï¼Œæ–¹ä¾¿åé¢åšä½è¿ç®—</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">CAPACITY</span>   <span class="hljs-operator">=</span> (<span class="hljs-number">1</span> &lt;&lt; COUNT_BITS) - <span class="hljs-number">1</span>;   <span class="hljs-comment">//é€šè¿‡ä½è¿ç®—å¾—å‡ºæœ€å¤§å®¹é‡</span><br>  <br><span class="hljs-comment">// runState is stored in the high-order bits  </span><br><span class="hljs-comment">//çº¿ç¨‹æ± çŠ¶æ€</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">RUNNING</span>    <span class="hljs-operator">=</span> -<span class="hljs-number">1</span> &lt;&lt; COUNT_BITS;  <span class="hljs-comment">//111 ä»£è¡¨çº¿ç¨‹æ± ä¸ºRUNNINGï¼Œä»£è¡¨æ­£å¸¸æ¥æ”¶ä»»åŠ¡</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">SHUTDOWN</span>   <span class="hljs-operator">=</span>  <span class="hljs-number">0</span> &lt;&lt; COUNT_BITS;  <span class="hljs-comment">//000 ä»£è¡¨çº¿ç¨‹æ± ä¸º`SHUTDOWN`çŠ¶æ€ï¼Œä¸æ¥æ”¶æ–°ä»»åŠ¡ï¼Œä½†æ˜¯å†…éƒ¨è¿˜ä¼šå¤„ç†é˜»å¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼Œæ­£åœ¨è¿›è¡Œçš„ä»»åŠ¡ä¹Ÿæ­£å¸¸å¤„ç†</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">STOP</span>       <span class="hljs-operator">=</span>  <span class="hljs-number">1</span> &lt;&lt; COUNT_BITS;  <span class="hljs-comment">//001  ä»£è¡¨çº¿ç¨‹æ± ä¸º`STOP`çŠ¶æ€ï¼Œä¸æ¥æ”¶æ–°ä»»åŠ¡ï¼Œä¹Ÿä¸å»å¤„ç†é˜»å¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼ŒåŒæ—¶ä¼šä¸­æ–­æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">TIDYING</span>    <span class="hljs-operator">=</span>  <span class="hljs-number">2</span> &lt;&lt; COUNT_BITS;  <span class="hljs-comment">//010 ä»£è¡¨çº¿ç¨‹æ± ä¸º`TIDYING`çŠ¶æ€ï¼Œè¿‡æ¸¡çš„çŠ¶æ€ï¼Œä»£è¡¨å½“å‰çº¿ç¨‹æ± å³å°†Game Over</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">TERMINATED</span> <span class="hljs-operator">=</span>  <span class="hljs-number">3</span> &lt;&lt; COUNT_BITS;  <span class="hljs-comment">//011 ä»£è¡¨çº¿ç¨‹æ± ä¸º`TERMINATED`ï¼Œè¦æ‰§è¡Œterminated(),çœŸçš„å‡‰å‡‰äº†</span><br>  <br><span class="hljs-comment">// Packing and unpacking ctl  </span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">runStateOf</span><span class="hljs-params">(<span class="hljs-type">int</span> c)</span>     &#123; <span class="hljs-keyword">return</span> c &amp; ~CAPACITY; &#125;  <span class="hljs-comment">//å¾—åˆ°çº¿ç¨‹æ± çš„çŠ¶æ€</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">workerCountOf</span><span class="hljs-params">(<span class="hljs-type">int</span> c)</span>  &#123; <span class="hljs-keyword">return</span> c &amp; CAPACITY; &#125;   <span class="hljs-comment">//å¾—åˆ°å½“å‰çº¿ç¨‹æ± çš„çº¿ç¨‹æ•°é‡</span><br></code></pre></td></tr></table></figure><p><code>ThreadPoolExecutor</code>ç±»ä½¿ç”¨äº†ä¸€äº›é«˜çº§çš„ä½æ“ä½œæ¥é«˜æ•ˆåœ°ç®¡ç†çº¿ç¨‹æ± çš„çŠ¶æ€å’Œå·¥ä½œçº¿ç¨‹çš„æ•°é‡ã€‚</p><blockquote><p>æ ¸å¿ƒå˜é‡è§£é‡Š</p></blockquote><ul><li><code>AtomicInteger ctl</code><ul><li>å®é™…å®ƒæ˜¯ä½¿ç”¨äº† <code>AtomicInteger ctl</code> è¿™ä¸ªå˜é‡æ¥è¿›è¡Œå­˜å‚¨çº¿ç¨‹æ± çš„çŠ¶æ€å’Œçº¿ç¨‹æ•°ã€‚åŸå­æ“ä½œä¿è¯äº†çº¿ç¨‹å®‰å…¨ï¼Œå³åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œå¯¹è¿™ä¸ªå˜é‡çš„ä¿®æ”¹æ˜¯åŸå­æ€§çš„ï¼Œé¿å…äº†ç«æ€æ¡ä»¶ã€‚</li><li>é«˜3ä½æ˜¯ï¼šçº¿ç¨‹æ± çŠ¶æ€</li><li>ä½29ä½æ˜¯ï¼š çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹ä¸ªæ•°</li></ul></li><li><code>COUNT_BITS</code><ul><li>ç”¨äºè®¡ç®—å’Œå­˜å‚¨çº¿ç¨‹æ•°é‡çš„ä½æ•°ã€‚å®ƒæ˜¯<code>Integer.SIZE</code>ï¼ˆJavaä¸­æ•´æ•°çš„ä½æ•°ï¼Œé€šå¸¸æ˜¯32ä½ï¼‰å‡å»3ã€‚</li><li>29ï¼Œæ–¹ä¾¿åé¢åšä½è¿ç®—;3ä½ç”¨äºè¡¨ç¤ºçº¿ç¨‹æ± çŠ¶æ€</li></ul></li><li><code>CAPACITY</code><ul><li>è¡¨ç¤ºçš„æœ€å¤§çº¿ç¨‹æ•°ã€‚å®ƒé€šè¿‡å°†1å·¦ç§»<code>COUNT_BITS</code>ä½ç„¶åå‡1æ¥è®¡ç®—ã€‚</li><li>ç±»ä¼¼ 100000000 - 1 &#x3D; 011111111111 è¿™ç§ï¼Œæ˜¯å¸¸è§çš„ä½è¿ç®—çš„ä¸€ç§è¡¨ç¤ºæ–¹å¼</li></ul></li></ul><blockquote><p>çº¿ç¨‹æ± çŠ¶æ€</p></blockquote><p>çº¿ç¨‹æ± çš„çŠ¶æ€è¢«å­˜å‚¨åœ¨<code>ctl</code>çš„é«˜ä½ã€‚è¿™äº›çŠ¶æ€åŒ…æ‹¬ï¼š</p><ul><li><strong><code>RUNNING</code></strong><ul><li>111</li><li>çº¿ç¨‹æ± å¯ä»¥æ¥å—æ–°ä»»åŠ¡ï¼Œå¹¶ä¸”ä¹Ÿå¯ä»¥å¤„ç†æ’é˜Ÿçš„ä»»åŠ¡ã€‚</li></ul></li><li><strong><code>SHUTDOWN</code></strong><ul><li>000</li><li>ä¸æ¥å—æ–°ä»»åŠ¡ï¼Œä½†æ˜¯å¯ä»¥å¤„ç†æ’é˜Ÿçš„ä»»åŠ¡ã€‚</li></ul></li><li><strong><code>STOP</code></strong><ul><li>001</li><li>ä¸æ¥å—æ–°ä»»åŠ¡ï¼Œä¸å¤„ç†æ’é˜Ÿçš„ä»»åŠ¡ï¼Œå¹¶ä¸”ä¸­æ–­æ­£åœ¨è¿›è¡Œçš„ä»»åŠ¡ã€‚</li></ul></li><li><strong><code>TIDYING</code></strong><ul><li>010</li><li>æ‰€æœ‰ä»»åŠ¡éƒ½å·²ç»ˆæ­¢ï¼ŒworkerCountï¼ˆæ´»åŠ¨çº¿ç¨‹æ•°ï¼‰ä¸ºé›¶ï¼Œçº¿ç¨‹æ± æ­£åœ¨è½¬æ¢åˆ°çŠ¶æ€<code>TERMINATED</code>ã€‚</li></ul></li><li><strong><code>TERMINATED</code></strong><ul><li>011</li><li><code>terminated()</code>æ–¹æ³•å·²ç»å®Œæˆ</li></ul></li></ul><blockquote><p>ä½æ“ä½œæ–¹æ³•</p></blockquote><ul><li><strong><code>runStateOf(int c)</code></strong>: æå–<code>ctl</code>ä¸­çš„çŠ¶æ€éƒ¨åˆ†ã€‚</li><li><strong><code>workerCountOf(int c)</code></strong>: æå–<code>ctl</code>ä¸­çš„å·¥ä½œçº¿ç¨‹æ•°éƒ¨åˆ†ã€‚</li><li><strong><code>ctlOf(int rs, int wc)</code></strong>: å°†è¿è¡ŒçŠ¶æ€å’Œå·¥ä½œçº¿ç¨‹æ•°ç»„åˆæˆä¸€ä¸ª<code>ctl</code>å€¼</li></ul><h4 id="4-2-çº¿ç¨‹æ± çŠ¶æ€å˜åŒ–"><a href="#4-2-çº¿ç¨‹æ± çŠ¶æ€å˜åŒ–" class="headerlink" title="4.2 çº¿ç¨‹æ± çŠ¶æ€å˜åŒ–"></a>4.2 çº¿ç¨‹æ± çŠ¶æ€å˜åŒ–</h4><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231222005453.png" alt="image.png"></p><h3 id="äº”ã€çº¿ç¨‹æ± çš„-execute-æ–¹æ³•æ‰§è¡Œ"><a href="#äº”ã€çº¿ç¨‹æ± çš„-execute-æ–¹æ³•æ‰§è¡Œ" class="headerlink" title="äº”ã€çº¿ç¨‹æ± çš„ execute æ–¹æ³•æ‰§è¡Œ"></a>äº”ã€çº¿ç¨‹æ± çš„ execute æ–¹æ³•æ‰§è¡Œ</h3><p>åœ¨Javaçš„<code>ThreadPoolExecutor</code>ç±»ä¸­ï¼Œ<code>execute</code>æ–¹æ³•æ˜¯ç”¨äºæäº¤ä»»åŠ¡çš„å…³é”®æ–¹æ³•ã€‚</p><p>å®ƒå†³å®šå¦‚ä½•å°†ä¸€ä¸ªæ–°çš„<code>Runnable</code>ä»»åŠ¡æ·»åŠ åˆ°çº¿ç¨‹æ± ä¸­ã€‚</p><h4 id="execute-æ–¹æ³•"><a href="#execute-æ–¹æ³•" class="headerlink" title="execute æ–¹æ³•"></a>execute æ–¹æ³•</h4><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">execute</span>(<span class="hljs-params">Runnable command</span>)</span> &#123;<br>    <span class="hljs-comment">// æ£€æŸ¥æäº¤çš„ä»»åŠ¡ä¸æ˜¯null</span><br>    <span class="hljs-keyword">if</span> (command == <span class="hljs-literal">null</span>)<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NullPointerException();<br><br>    <span class="hljs-comment">// è·å–å½“å‰çº¿ç¨‹æ± çŠ¶æ€å’Œå·¥ä½œçº¿ç¨‹æ•°</span><br>    <span class="hljs-built_in">int</span> c = ctl.<span class="hljs-keyword">get</span>();<br><br>    <span class="hljs-comment">// å¦‚æœå½“å‰å·¥ä½œçº¿ç¨‹æ•°å°äºæ ¸å¿ƒçº¿ç¨‹æ•°</span><br>    <span class="hljs-keyword">if</span> (workerCountOf(c) &lt; corePoolSize) &#123;<br>        <span class="hljs-comment">// å°è¯•æ·»åŠ ä¸€ä¸ªæ–°å·¥ä½œçº¿ç¨‹æ¥æ‰§è¡Œè¿™ä¸ªä»»åŠ¡</span><br>        <span class="hljs-keyword">if</span> (addWorker(command, <span class="hljs-literal">true</span>))<br>            <span class="hljs-keyword">return</span>; <span class="hljs-comment">// å¦‚æœæˆåŠŸï¼Œç›´æ¥è¿”å›</span><br>        <span class="hljs-comment">// å¦‚æœæ·»åŠ å·¥ä½œçº¿ç¨‹å¤±è´¥ï¼Œé‡æ–°è·å–çº¿ç¨‹æ± çŠ¶æ€</span><br>        c = ctl.<span class="hljs-keyword">get</span>();<br>    &#125;<br><br>    <span class="hljs-comment">// å¦‚æœçº¿ç¨‹æ± å¤„äºè¿è¡ŒçŠ¶æ€ï¼Œä¸”ä»»åŠ¡èƒ½è¢«æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­</span><br>    <span class="hljs-keyword">if</span> (isRunning(c) &amp;&amp; workQueue.offer(command)) &#123;<br>        <span class="hljs-comment">// é‡æ–°æ£€æŸ¥çº¿ç¨‹æ± çŠ¶æ€</span><br>        <span class="hljs-built_in">int</span> recheck = ctl.<span class="hljs-keyword">get</span>();<br>        <span class="hljs-comment">// å¦‚æœçº¿ç¨‹æ± ä¸å†è¿è¡Œï¼Œå¹¶ä¸”èƒ½ä»é˜Ÿåˆ—ä¸­ç§»é™¤ä»»åŠ¡ï¼Œåˆ™æ‹’ç»ä»»åŠ¡</span><br>        <span class="hljs-keyword">if</span> (!isRunning(recheck) &amp;&amp; <span class="hljs-keyword">remove</span>(command))<br>            reject(command);<br>        <span class="hljs-comment">// å¦‚æœæ²¡æœ‰æ´»åŠ¨çš„å·¥ä½œçº¿ç¨‹ï¼Œåˆ™æ·»åŠ ä¸€ä¸ªæ–°çš„å·¥ä½œçº¿ç¨‹</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (workerCountOf(recheck) == <span class="hljs-number">0</span>)<br>            addWorker(<span class="hljs-literal">null</span>, <span class="hljs-literal">false</span>);<br>    &#125;<br>    <span class="hljs-comment">// å¦‚æœä»»åŠ¡ä¸èƒ½è¢«æ·»åŠ åˆ°é˜Ÿåˆ—ï¼Œå°è¯•åˆ›å»ºä¸€ä¸ªæ–°å·¥ä½œçº¿ç¨‹æ¥æ‰§è¡Œè¿™ä¸ªä»»åŠ¡</span><br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!addWorker(command, <span class="hljs-literal">false</span>))<br>        reject(command); <span class="hljs-comment">// å¦‚æœåˆ›å»ºå¤±è´¥ï¼Œåˆ™æ‹’ç»ä»»åŠ¡</span><br>&#125;<br></code></pre></td></tr></table></figure><p>å®ç°æ­¥éª¤ï¼š</p><ol><li><strong>å‚æ•°æ£€æŸ¥</strong>: é¦–å…ˆæ£€æŸ¥ä¼ å…¥çš„<code>Runnable</code>å¯¹è±¡ä¸æ˜¯<code>null</code>ã€‚</li><li><strong>å·¥ä½œçº¿ç¨‹æ•°é‡æ£€æŸ¥</strong>: å¦‚æœå½“å‰å·¥ä½œçº¿ç¨‹çš„æ•°é‡å°äºæ ¸å¿ƒçº¿ç¨‹æ•°<code>corePoolSize</code>ï¼Œå°è¯•ç›´æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„å·¥ä½œçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ã€‚</li><li><strong>ä»»åŠ¡é˜Ÿåˆ—å¤„ç†</strong>: å¦‚æœå½“å‰çº¿ç¨‹æ•°å·²ç»è¾¾åˆ°æˆ–è¶…è¿‡æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œæˆ–è€…æ–°å·¥ä½œçº¿ç¨‹çš„åˆ›å»ºå¤±è´¥ï¼Œåˆ™å°è¯•å°†ä»»åŠ¡åŠ å…¥åˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­ã€‚</li><li><strong>çŠ¶æ€é‡æ–°æ£€æŸ¥</strong>: åœ¨æˆåŠŸå°†ä»»åŠ¡åŠ å…¥é˜Ÿåˆ—åï¼Œéœ€è¦å†æ¬¡æ£€æŸ¥çº¿ç¨‹æ± çš„çŠ¶æ€ï¼Œç¡®ä¿çº¿ç¨‹æ± ä»åœ¨è¿è¡Œã€‚å¦‚æœçº¿ç¨‹æ± çŠ¶æ€æ”¹å˜ï¼ˆä¾‹å¦‚ï¼Œè¢«å…³é—­äº†ï¼‰ï¼Œåˆ™å°è¯•ç§»é™¤åˆšåŠ å…¥çš„ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œæ‹’ç»ç­–ç•¥ã€‚</li><li><strong>æ— æ´»åŠ¨çº¿ç¨‹å¤„ç†</strong>: å¦‚æœä»»åŠ¡è¢«æˆåŠŸåŠ å…¥é˜Ÿåˆ—ï¼Œä½†æ²¡æœ‰æ´»åŠ¨çš„å·¥ä½œçº¿ç¨‹å¯ä»¥å¤„ç†é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼Œè¿™æ—¶ä¼šå°è¯•åˆ›å»ºä¸€ä¸ªæ–°çš„å·¥ä½œçº¿ç¨‹ã€‚</li><li><strong>æ‹’ç»ç­–ç•¥</strong>: å¦‚æœæ— æ³•å°†ä»»åŠ¡åŠ å…¥é˜Ÿåˆ—ï¼Œä¸”æ— æ³•åˆ›å»ºæ–°çš„å·¥ä½œçº¿ç¨‹ï¼Œæœ€åçš„é€‰é¡¹æ˜¯æ‹’ç»ä»»åŠ¡ã€‚</li></ol><h4 id="addWorker-æ–¹æ³•"><a href="#addWorker-æ–¹æ³•" class="headerlink" title="addWorker æ–¹æ³•"></a>addWorker æ–¹æ³•</h4><p>åœ¨Javaçš„<code>ThreadPoolExecutor</code>ç±»ä¸­ï¼Œ<code>addWorker</code>æ–¹æ³•æ˜¯ç”¨äºå‘çº¿ç¨‹æ± ä¸­æ·»åŠ æ–°çš„å·¥ä½œçº¿ç¨‹çš„å…³é”®æ–¹æ³•ã€‚</p><p>å®ƒåœ¨å¤„ç†æ–°ä»»åŠ¡æˆ–è€…éœ€è¦å¢åŠ çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡æ—¶è¢«è°ƒç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">addWorker</span><span class="hljs-params">(Runnable firstTask, <span class="hljs-type">boolean</span> core)</span> &#123;<br>    retry:<br>    <span class="hljs-keyword">for</span> (;;) &#123;<br>        <span class="hljs-comment">// è·å–å½“å‰çº¿ç¨‹æ± çš„æ§åˆ¶çŠ¶æ€</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> ctl.get();<br>        <span class="hljs-comment">// è·å–è¿è¡ŒçŠ¶æ€</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">rs</span> <span class="hljs-operator">=</span> runStateOf(c);<br><br>        <span class="hljs-comment">// æ£€æŸ¥çº¿ç¨‹æ± çš„çŠ¶æ€æ˜¯å¦å…è®¸æ·»åŠ æ–°çš„å·¥ä½œçº¿ç¨‹</span><br>        <span class="hljs-comment">// ä»…åœ¨ä»¥ä¸‹æƒ…å†µè¿”å›falseï¼š</span><br>        <span class="hljs-comment">// 1. çº¿ç¨‹æ± çŠ¶æ€ä¸ºSHUTDOWNä»¥ä¸Šï¼ˆä¸åŒ…æ‹¬SHUTDOWNï¼‰ä¸”ä¸æ»¡è¶³ä»¥ä¸‹æ‰€æœ‰æ¡ä»¶ï¼š</span><br>        <span class="hljs-comment">//    - çŠ¶æ€ä¸ºSHUTDOWN</span><br>        <span class="hljs-comment">//    - firstTaskä¸ºnull</span><br>        <span class="hljs-comment">//    - å·¥ä½œé˜Ÿåˆ—ä¸ä¸ºç©º</span><br>        <span class="hljs-keyword">if</span> (rs &gt;= SHUTDOWN &amp;&amp;<br>            !(rs == SHUTDOWN &amp;&amp;<br>              firstTask == <span class="hljs-literal">null</span> &amp;&amp;<br>              !workQueue.isEmpty()))<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br><br>        <span class="hljs-comment">// æ— é™å¾ªç¯ï¼Œå°è¯•å¢åŠ å·¥ä½œçº¿ç¨‹çš„æ•°é‡</span><br>        <span class="hljs-keyword">for</span> (;;) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">wc</span> <span class="hljs-operator">=</span> workerCountOf(c);<br>            <span class="hljs-comment">// æ£€æŸ¥å½“å‰å·¥ä½œçº¿ç¨‹æ•°æ˜¯å¦è¶…è¿‡äº†æœ€å¤§å®¹é‡æˆ–è®¾ç½®çš„é˜ˆå€¼</span><br>            <span class="hljs-comment">// å¦‚æœè¶…è¿‡å®¹é‡æˆ–è€…è¶…è¿‡corePoolSize/maximumPoolSizeï¼Œåˆ™è¿”å›false</span><br>            <span class="hljs-keyword">if</span> (wc &gt;= CAPACITY ||<br>                wc &gt;= (core ? corePoolSize : maximumPoolSize))<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>            <span class="hljs-comment">// ä½¿ç”¨CASæ“ä½œå¢åŠ å·¥ä½œçº¿ç¨‹è®¡æ•°</span><br>            <span class="hljs-comment">// å¦‚æœCASæˆåŠŸï¼Œè·³å‡ºretryæ ‡ç­¾ï¼Œç»§ç»­å‘ä¸‹æ‰§è¡Œ</span><br>            <span class="hljs-keyword">if</span> (compareAndIncrementWorkerCount(c))<br>                <span class="hljs-keyword">break</span> retry;<br>            <span class="hljs-comment">// å¦‚æœCASå¤±è´¥ï¼Œé‡æ–°è¯»å–ctl</span><br>            c = ctl.get(); <br>            <span class="hljs-comment">// å¦‚æœè¿è¡ŒçŠ¶æ€å‘ç”Ÿå˜åŒ–ï¼Œé‡æ–°å¼€å§‹å¤–å±‚å¾ªç¯</span><br>            <span class="hljs-keyword">if</span> (runStateOf(c) != rs)<br>                <span class="hljs-keyword">continue</span> retry;<br>            <span class="hljs-comment">// å¦‚æœCASå¤±è´¥ä½†è¿è¡ŒçŠ¶æ€æ²¡æœ‰å˜åŒ–ï¼Œç»§ç»­å°è¯•å†…å±‚å¾ªç¯çš„CASæ“ä½œ</span><br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// æ·»åŠ å·¥ä½œçº¿ç¨‹çš„è¿‡ç¨‹</span><br>    <span class="hljs-type">boolean</span> <span class="hljs-variable">workerStarted</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br>    <span class="hljs-type">boolean</span> <span class="hljs-variable">workerAdded</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br>    <span class="hljs-type">Worker</span> <span class="hljs-variable">w</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-comment">// åˆ›å»ºæ–°çš„å·¥ä½œçº¿ç¨‹</span><br>        w = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(firstTask);<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> w.thread;<br>        <span class="hljs-comment">// å¦‚æœæˆåŠŸåˆ›å»ºçº¿ç¨‹</span><br>        <span class="hljs-keyword">if</span> (t != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">final</span> <span class="hljs-type">ReentrantLock</span> <span class="hljs-variable">mainLock</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.mainLock;<br>            mainLock.lock();<br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-comment">// åœ¨æŒæœ‰é”çš„æƒ…å†µä¸‹å†æ¬¡æ£€æŸ¥çº¿ç¨‹æ± çŠ¶æ€</span><br>                <span class="hljs-type">int</span> <span class="hljs-variable">rs</span> <span class="hljs-operator">=</span> runStateOf(ctl.get());<br><br>                <span class="hljs-comment">// å¦‚æœçº¿ç¨‹æ± çŠ¶æ€å…è®¸æ·»åŠ å·¥ä½œçº¿ç¨‹ï¼Œåˆ™å°†å…¶æ·»åŠ åˆ°å·¥ä½œé›†åˆä¸­</span><br>                <span class="hljs-keyword">if</span> (rs &lt; SHUTDOWN ||<br>                    (rs == SHUTDOWN &amp;&amp; firstTask == <span class="hljs-literal">null</span>)) &#123;<br>                    <span class="hljs-comment">// æ£€æŸ¥çº¿ç¨‹æ˜¯å¦å·²ç»å¯åŠ¨ï¼ˆé¢„é˜²å¼‚å¸¸æƒ…å†µï¼‰</span><br>                    <span class="hljs-keyword">if</span> (t.isAlive()) <br>                        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalThreadStateException</span>();<br>                    workers.add(w);<br>                    <span class="hljs-type">int</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> workers.size();<br>                    <span class="hljs-comment">// æ›´æ–°è®°å½•çš„æœ€å¤§æ± å¤§å°</span><br>                    <span class="hljs-keyword">if</span> (s &gt; largestPoolSize)<br>                        largestPoolSize = s;<br>                    workerAdded = <span class="hljs-literal">true</span>;<br>                &#125;<br>            &#125; <span class="hljs-keyword">finally</span> &#123;<br>                <span class="hljs-comment">// é‡Šæ”¾é”</span><br>                mainLock.unlock();<br>            &#125;<br>            <span class="hljs-comment">// å¦‚æœæˆåŠŸæ·»åŠ å·¥ä½œçº¿ç¨‹ï¼Œåˆ™å¯åŠ¨è¯¥çº¿ç¨‹</span><br>            <span class="hljs-keyword">if</span> (workerAdded) &#123;<br>                t.start();<br>                workerStarted = <span class="hljs-literal">true</span>;<br>            &#125;<br>        &#125;<br>    &#125; <span class="hljs-keyword">finally</span> &#123;<br>        <span class="hljs-comment">// å¦‚æœå·¥ä½œçº¿ç¨‹æœªèƒ½æˆåŠŸå¯åŠ¨ï¼Œå¤„ç†å¤±è´¥æƒ…å†µ</span><br>        <span class="hljs-keyword">if</span> (!workerStarted)<br>            addWorkerFailed(w);<br>    &#125;<br>    <span class="hljs-comment">// è¿”å›å·¥ä½œçº¿ç¨‹æ˜¯å¦æˆåŠŸå¯åŠ¨</span><br>    <span class="hljs-keyword">return</span> workerStarted;<br>&#125;<br></code></pre></td></tr></table></figure><p>å®ç°æ­¥éª¤ï¼š</p><ol><li><strong>çŠ¶æ€æ£€æŸ¥</strong>: é¦–å…ˆæ£€æŸ¥çº¿ç¨‹æ± çš„çŠ¶æ€ï¼Œç¡®å®šæ˜¯å¦å¯ä»¥æ·»åŠ æ–°çš„å·¥ä½œçº¿ç¨‹ã€‚å¦‚æœçº¿ç¨‹æ± æ­£åœ¨å…³é—­ï¼Œå¹¶ä¸”æ¡ä»¶ä¸å…è®¸æ·»åŠ å·¥ä½œçº¿ç¨‹ï¼ˆä¾‹å¦‚ï¼Œä»»åŠ¡é˜Ÿåˆ—ä¸ºç©ºï¼‰ï¼Œåˆ™ç›´æ¥è¿”å›<code>false</code>ã€‚</li><li><strong>å¢åŠ å·¥ä½œçº¿ç¨‹æ•°</strong>: ä½¿ç”¨ä¸€ä¸ªæ— é™å¾ªç¯ï¼Œé€šè¿‡CASï¼ˆCompare-And-Swapï¼‰æ“ä½œå°è¯•å¢åŠ å·¥ä½œçº¿ç¨‹è®¡æ•°ã€‚å¦‚æœCASæ“ä½œæˆåŠŸï¼Œè·³å‡ºå¾ªç¯ï¼›å¦‚æœå¤±è´¥ï¼Œé‡æ–°å°è¯•ã€‚</li><li><strong>åˆ›å»ºå’Œå¯åŠ¨å·¥ä½œçº¿ç¨‹</strong>: åˆ›å»ºä¸€ä¸ªæ–°çš„<code>Worker</code>å¯¹è±¡ï¼Œå¹¶å°è¯•å¯åŠ¨å…¶çº¿ç¨‹ã€‚è¿™ä¸ªè¿‡ç¨‹æ¶‰åŠè·å–ä¸€ä¸ªå…¨å±€é”ä»¥ä¿è¯çº¿ç¨‹å®‰å…¨ã€‚</li><li><strong>çº¿ç¨‹æ± çŠ¶æ€å†æ¬¡æ£€æŸ¥</strong>: åœ¨é”å†…éƒ¨å†æ¬¡æ£€æŸ¥çº¿ç¨‹æ± çš„çŠ¶æ€ï¼Œä»¥ç¡®ä¿åœ¨è·å–é”çš„è¿‡ç¨‹ä¸­çŠ¶æ€æ²¡æœ‰æ”¹å˜ã€‚</li><li><strong>æ·»åŠ åˆ°å·¥ä½œé›†åˆ</strong>: å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œå°†æ–°çš„<code>Worker</code>æ·»åŠ åˆ°å·¥ä½œçº¿ç¨‹é›†åˆä¸­ï¼Œå¹¶æ›´æ–°è®°å½•çš„æœ€å¤§æ± å¤§å°ã€‚</li><li><strong>å¯åŠ¨çº¿ç¨‹</strong>: å°è¯•å¯åŠ¨çº¿ç¨‹ã€‚å¦‚æœå¯åŠ¨æˆåŠŸï¼Œè¿”å›<code>true</code>ï¼›å¦åˆ™ï¼Œåœ¨<code>finally</code>å—ä¸­å¤„ç†å¯åŠ¨å¤±è´¥çš„æƒ…å†µã€‚</li></ol><p><code>addWorker</code>æ–¹æ³•çš„å®ç°ä½“ç°äº†çº¿ç¨‹æ± å¦‚ä½•æœ‰æ•ˆåœ°ç®¡ç†çº¿ç¨‹çš„åˆ›å»ºå’Œæ·»åŠ ã€‚</p><p>ä½¿ç”¨CASæ“ä½œä¿è¯äº†çº¿ç¨‹å®‰å…¨ï¼Œè€ŒåŒé‡æ£€æŸ¥ï¼ˆåœ¨æ–¹æ³•å¼€å§‹å’ŒæŒæœ‰é”æ—¶ï¼‰ç¡®ä¿äº†å³ä½¿åœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹ä¹Ÿèƒ½æ­£ç¡®åœ°ç®¡ç†çº¿ç¨‹æ± çš„çŠ¶æ€ã€‚</p><h3 id="å…­ã€Worker-çš„å°è£…"><a href="#å…­ã€Worker-çš„å°è£…" class="headerlink" title="å…­ã€Worker çš„å°è£…"></a>å…­ã€Worker çš„å°è£…</h3><p>åœ¨Javaçš„<code>ThreadPoolExecutor</code>ç±»ä¸­ï¼Œ<code>Worker</code>æ˜¯ä¸€ä¸ªå…³é”®çš„å†…éƒ¨ç±»ï¼Œå®ƒå°è£…äº†çº¿ç¨‹æ± ä¸­çš„å·¥ä½œçº¿ç¨‹çš„è¡Œä¸ºå’Œå±æ€§ã€‚</p><p><code>Worker</code>ç±»ç»§æ‰¿è‡ª<code>AbstractQueuedSynchronizer</code>ï¼Œæ˜¯ä¸€ä¸ªç”¨äºæ„å»ºé”å’Œå…¶ä»–åŒæ­¥ç»„ä»¶çš„æ¡†æ¶</p><h4 id="ThreadPoolExecutorå†…éƒ¨ç±»Workerçš„æ„é€ å‡½æ•°"><a href="#ThreadPoolExecutorå†…éƒ¨ç±»Workerçš„æ„é€ å‡½æ•°" class="headerlink" title="ThreadPoolExecutorå†…éƒ¨ç±»Workerçš„æ„é€ å‡½æ•°"></a><code>ThreadPoolExecutor</code>å†…éƒ¨ç±»<code>Worker</code>çš„æ„é€ å‡½æ•°</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">Worker(Runnable firstTask) &#123;<br>    <span class="hljs-comment">// è®¾ç½®Workerçš„çŠ¶æ€ä¸º-1ï¼Œæš‚æ—¶é˜»æ­¢çº¿ç¨‹ä¸­æ–­</span><br>    <span class="hljs-comment">// è¿™æ˜¯ä¸ºäº†é˜²æ­¢åœ¨WorkerçœŸæ­£å¼€å§‹è¿è¡Œå‰è¢«ä¸­æ–­</span><br>    setState(-<span class="hljs-number">1</span>);<br><br>    <span class="hljs-comment">// å°†ä¼ å…¥çš„ä»»åŠ¡ï¼ˆå¯èƒ½ä¸ºnullï¼‰è®¾ç½®ä¸ºWorkerçš„ç¬¬ä¸€ä¸ªä»»åŠ¡</span><br>    <span class="hljs-comment">// è¿™ä¸ªä»»åŠ¡å°†æ˜¯Workeråˆ›å»ºåæ‰§è¡Œçš„ç¬¬ä¸€ä¸ªä»»åŠ¡</span><br>    <span class="hljs-keyword">this</span>.firstTask = firstTask;<br><br>    <span class="hljs-comment">// ä½¿ç”¨çº¿ç¨‹æ± çš„çº¿ç¨‹å·¥å‚åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹ï¼Œå¹¶å°†å½“å‰Workerä½œä¸ºä»»åŠ¡ä¼ é€’ç»™è¿™ä¸ªæ–°çº¿ç¨‹</span><br>    <span class="hljs-comment">// è¿™é‡Œï¼ŒWorkerè‡ªèº«å®é™…ä¸Šæ˜¯ä¸€ä¸ªRunnableï¼Œå› ä¸ºå®ƒå®ç°äº†Runnableæ¥å£</span><br>    <span class="hljs-keyword">this</span>.thread = getThreadFactory().newThread(<span class="hljs-keyword">this</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»£ç åˆ†æï¼š</p><ol><li><strong>æš‚æ—¶ç¦ç”¨ä¸­æ–­</strong>: <code>setState(-1)</code>è®¾ç½®Workerçš„çŠ¶æ€ï¼Œè¿™ä¸ªçŠ¶æ€ç”¨äºæ§åˆ¶çº¿ç¨‹çš„ä¸­æ–­ã€‚è®¾ç½®ä¸º-1æ„å‘³ç€åœ¨<code>runWorker</code>æ–¹æ³•çœŸæ­£å¼€å§‹æ‰§è¡Œä¹‹å‰ï¼Œçº¿ç¨‹ä¸åº”è¢«ä¸­æ–­ã€‚è¿™æ˜¯ä¸€ä¸ªé¢„é˜²æªæ–½ï¼Œä»¥ç¡®ä¿Workeråœ¨å¼€å§‹æ‰§è¡Œå…¶ä»»åŠ¡å‰ä¸ä¼šè¢«æ„å¤–ä¸­æ–­ã€‚</li><li><strong>è®¾ç½®ç¬¬ä¸€ä¸ªä»»åŠ¡</strong>: <code>this.firstTask = firstTask</code>å°†ä¼ å…¥çš„ä»»åŠ¡èµ‹å€¼ç»™Workerçš„<code>firstTask</code>å±æ€§ã€‚è¿™ä¸ªä»»åŠ¡æ˜¯Workerå°†è¦æ‰§è¡Œçš„ç¬¬ä¸€ä¸ªä»»åŠ¡ã€‚å¦‚æœè¿™ä¸ªå€¼æ˜¯<code>null</code>ï¼ŒWorkerå°†ä»çº¿ç¨‹æ± çš„ä»»åŠ¡é˜Ÿåˆ—ä¸­è·å–ä»»åŠ¡ã€‚</li><li><strong>åˆ›å»ºæ–°çº¿ç¨‹</strong>: <code>this.thread = getThreadFactory().newThread(this)</code>è°ƒç”¨çº¿ç¨‹å·¥å‚æ¥åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹ï¼Œå¹¶å°†å½“å‰Workerä½œä¸ºè¿è¡Œä»»åŠ¡ä¼ é€’ã€‚ç”±äºWorkerå®ç°äº†<code>Runnable</code>æ¥å£ï¼Œå®ƒå¯ä»¥è¢«çº¿ç¨‹ç›´æ¥æ‰§è¡Œã€‚çº¿ç¨‹å·¥å‚æ˜¯çº¿ç¨‹æ± çš„ä¸€ä¸ªç»„æˆéƒ¨åˆ†ï¼Œç”¨äºå®šåˆ¶çº¿ç¨‹åˆ›å»ºè¿‡ç¨‹ï¼ˆä¾‹å¦‚è®¾ç½®çº¿ç¨‹åç§°ã€ä¼˜å…ˆçº§ç­‰ï¼‰ã€‚</li></ol><h4 id="runWorker-æ–¹æ³•"><a href="#runWorker-æ–¹æ³•" class="headerlink" title="runWorker æ–¹æ³•"></a>runWorker æ–¹æ³•</h4><p>å®šä¹‰äº†çº¿ç¨‹æ± ä¸­çš„å·¥ä½œçº¿ç¨‹ï¼ˆ<code>Worker</code>ï¼‰å¦‚ä½•æ‰§è¡Œä»»åŠ¡</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> runWorker(Worker w) &#123;<br>    <span class="hljs-comment">// è·å–å½“å‰æ‰§è¡Œè¿™ä¸ªæ–¹æ³•çš„çº¿ç¨‹</span><br>    Thread wt = Thread.currentThread();<br>    <span class="hljs-comment">// ä»Workerè·å–ç¬¬ä¸€ä¸ªä»»åŠ¡</span><br>    Runnable <span class="hljs-keyword">task</span> = w.firstTask;<br>    <span class="hljs-comment">// è®¾ç½®Workerçš„ç¬¬ä¸€ä¸ªä»»åŠ¡ä¸ºnull</span><br>    w.firstTask = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-comment">// é‡Šæ”¾Workerä¸Šçš„é”ï¼Œå…è®¸ä¸­æ–­</span><br>    w.unlock(); <br><br>    <span class="hljs-comment">// æ ‡è®°æ˜¯å¦å¼‚å¸¸å®Œæˆä»»åŠ¡</span><br>    <span class="hljs-keyword">boolean</span> completedAbruptly = <span class="hljs-keyword">true</span>;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-comment">// å½“æœ‰ä»»åŠ¡æ‰§è¡Œæˆ–è€…èƒ½ä»ä»»åŠ¡é˜Ÿåˆ—ä¸­è·å–åˆ°ä»»åŠ¡æ—¶ï¼Œç»§ç»­å¾ªç¯</span><br>        <span class="hljs-keyword">while</span> (<span class="hljs-keyword">task</span> != <span class="hljs-keyword">null</span> || (<span class="hljs-keyword">task</span> = getTask()) != <span class="hljs-keyword">null</span>) &#123;<br>            <span class="hljs-comment">// é”å®šWorkerï¼Œä»¥å¼€å§‹æ‰§è¡Œä»»åŠ¡</span><br>            w.lock();<br>            <span class="hljs-comment">// å¦‚æœçº¿ç¨‹æ± æ­£åœ¨åœæ­¢ï¼Œç¡®ä¿çº¿ç¨‹è¢«ä¸­æ–­ï¼›</span><br>            <span class="hljs-comment">// å¦‚æœä¸æ˜¯ï¼Œåˆ™ç¡®ä¿çº¿ç¨‹ä¸è¢«ä¸­æ–­ã€‚è¿™éœ€è¦åœ¨ç¬¬äºŒç§æƒ…å†µä¸‹é‡æ–°æ£€æŸ¥ä»¥å¤„ç†shutdownNowç«äº‰çŠ¶æ€</span><br>            <span class="hljs-keyword">if</span> ((runStateAtLeast(ctl.get(), STOP) ||<br>                 (Thread.interrupted() &amp;&amp;<br>                  runStateAtLeast(ctl.get(), STOP))) &amp;&amp;<br>                !wt.isInterrupted())<br>                wt.interrupt();<br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-comment">// åœ¨æ‰§è¡Œä»»åŠ¡å‰çš„é’©å­æ–¹æ³•</span><br>                beforeExecute(wt, <span class="hljs-keyword">task</span>);<br>                Throwable thrown = <span class="hljs-keyword">null</span>;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    <span class="hljs-comment">// è¿è¡Œä»»åŠ¡</span><br>                    <span class="hljs-keyword">task</span>.run();<br>                &#125; <span class="hljs-keyword">catch</span> (RuntimeException x) &#123;<br>                    thrown = x; <span class="hljs-keyword">throw</span> x;<br>                &#125; <span class="hljs-keyword">catch</span> (Error x) &#123;<br>                    thrown = x; <span class="hljs-keyword">throw</span> x;<br>                &#125; <span class="hljs-keyword">catch</span> (Throwable x) &#123;<br>                    thrown = x; <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Error(x);<br>                &#125; <span class="hljs-keyword">finally</span> &#123;<br>                    <span class="hljs-comment">// åœ¨æ‰§è¡Œä»»åŠ¡åçš„é’©å­æ–¹æ³•</span><br>                    afterExecute(<span class="hljs-keyword">task</span>, thrown);<br>                &#125;<br>            &#125; <span class="hljs-keyword">finally</span> &#123;<br>                <span class="hljs-comment">// ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œæ¸…ç†å·¥ä½œ</span><br>                <span class="hljs-keyword">task</span> = <span class="hljs-keyword">null</span>;<br>                w.completedTasks++;<br>                w.unlock();<br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">// å¦‚æœæ­£å¸¸é€€å‡ºå¾ªç¯ï¼Œè®¾ç½®completedAbruptlyä¸ºfalse</span><br>        completedAbruptly = <span class="hljs-keyword">false</span>;<br>    &#125; <span class="hljs-keyword">finally</span> &#123;<br>        <span class="hljs-comment">// å¤„ç†Workeré€€å‡º</span><br>        processWorkerExit(w, completedAbruptly);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ‰§è¡Œæ­¥éª¤ï¼š</p><ol><li><strong>åˆå§‹åŒ–</strong>: é¦–å…ˆè·å–å½“å‰çº¿ç¨‹å’ŒWorkerä¸­çš„ç¬¬ä¸€ä¸ªä»»åŠ¡ã€‚è§£é”Workerä»¥å…è®¸çº¿ç¨‹ä¸­æ–­ã€‚</li><li><strong>ä»»åŠ¡æ‰§è¡Œå¾ªç¯</strong>: æ–¹æ³•è¿›å…¥ä¸€ä¸ªå¾ªç¯ï¼Œä¸æ–­æ‰§è¡Œä»»åŠ¡ã€‚å¦‚æœWorkerçš„ç¬¬ä¸€ä¸ªä»»åŠ¡ä¸ºç©ºï¼Œåˆ™å°è¯•ä»çº¿ç¨‹æ± çš„ä»»åŠ¡é˜Ÿåˆ—ä¸­è·å–æ–°çš„ä»»åŠ¡ã€‚</li><li><strong>ä¸­æ–­ç®¡ç†</strong>: åœ¨æ¯æ¬¡ä»»åŠ¡æ‰§è¡Œå‰ï¼Œæ£€æŸ¥çº¿ç¨‹æ± çš„çŠ¶æ€ï¼Œå¦‚æœéœ€è¦ï¼Œæ ¹æ®çº¿ç¨‹æ± çš„çŠ¶æ€æ¥å†³å®šæ˜¯å¦ä¸­æ–­å½“å‰çº¿ç¨‹ã€‚</li><li><strong>ä»»åŠ¡æ‰§è¡Œ</strong>: å®é™…æ‰§è¡Œä»»åŠ¡ï¼Œå¹¶å¤„ç†ä»»ä½•å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸ã€‚åŒæ—¶ï¼Œæ‰§è¡Œé’©å­æ–¹æ³•<code>beforeExecute</code>å’Œ<code>afterExecute</code>ï¼Œè¿™äº›æ–¹æ³•å¯ä»¥ç”¨äºåœ¨ä»»åŠ¡æ‰§è¡Œå‰ååšä¸€äº›å‡†å¤‡å’Œæ¸…ç†å·¥ä½œã€‚</li><li><strong>ä»»åŠ¡å®Œæˆåå¤„ç†</strong>: æ›´æ–°å®Œæˆä»»åŠ¡çš„è®¡æ•°ï¼Œæ¸…ç†å˜é‡ï¼Œè§£é”Workerã€‚</li><li><strong>å¼‚å¸¸å¤„ç†ä¸é€€å‡º</strong>: å¦‚æœä»»åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿå¼‚å¸¸å¯¼è‡´çº¿ç¨‹æ„å¤–ç»“æŸï¼Œ<code>completedAbruptly</code>æ ‡è®°ä¼šä¿æŒä¸º<code>true</code>ã€‚åœ¨æœ€åçš„<code>finally</code>å—ä¸­ï¼Œè°ƒç”¨<code>processWorkerExit</code>æ¥å¤„ç†Workerçš„é€€å‡ºï¼Œè¿™å¯èƒ½åŒ…æ‹¬æ›¿æ¢è¿™ä¸ªWorkeræˆ–è€…æ ¹æ®å½“å‰çº¿ç¨‹æ± çŠ¶æ€è¿›è¡Œå…¶ä»–å¤„ç†ã€‚</li></ol><hr><p>å‚è€ƒ</p><ul><li><a href="https://www.bilibili.com/video/BV1244y1n7bz">https://www.bilibili.com/video/BV1244y1n7bz</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
      <category>Thread</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>thread</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaå¹¶å‘ç¼–ç¨‹_çº¿ç¨‹æ± æœ€ä½³å®è·µ</title>
    <link href="/2023/12/21/Java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B_%E7%BA%BF%E7%A8%8B%E6%B1%A0%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/"/>
    <url>/2023/12/21/Java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B_%E7%BA%BF%E7%A8%8B%E6%B1%A0%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/</url>
    
    <content type="html"><![CDATA[<p>to be continedâ€¦.</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://javaguide.cn/java/concurrent/java-thread-pool-best-practices.html">https://javaguide.cn/java/concurrent/java-thread-pool-best-practices.html</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
      <category>Thread</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>thread</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Rediså…¥é—¨_è¿›é˜¶å†…å®¹</title>
    <link href="/2023/12/21/Redis%E5%85%A5%E9%97%A8_%E8%BF%9B%E9%98%B6%E5%86%85%E5%AE%B9/"/>
    <url>/2023/12/21/Redis%E5%85%A5%E9%97%A8_%E8%BF%9B%E9%98%B6%E5%86%85%E5%AE%B9/</url>
    
    <content type="html"><![CDATA[<blockquote><p>è¿›é˜¶å†…å®¹å­¦ä¹ </p></blockquote><ul><li>Redisäº‹åŠ¡</li><li>Redisæ€§èƒ½ä¼˜åŒ–</li><li>Redisç”Ÿäº§é—®é¢˜</li><li>Redisé›†ç¾¤</li><li>Redisä½¿ç”¨è§„èŒƒ</li></ul><h3 id="1ã€Redis-äº‹åŠ¡"><a href="#1ã€Redis-äº‹åŠ¡" class="headerlink" title="1ã€Redis äº‹åŠ¡"></a>1ã€Redis äº‹åŠ¡</h3><p>to be continedâ€¦.</p><h3 id="2ã€Redis-æ€§èƒ½ä¼˜åŒ–"><a href="#2ã€Redis-æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="2ã€Redis æ€§èƒ½ä¼˜åŒ–"></a>2ã€Redis æ€§èƒ½ä¼˜åŒ–</h3><h3 id="3ã€Redis-ç”Ÿäº§é—®é¢˜"><a href="#3ã€Redis-ç”Ÿäº§é—®é¢˜" class="headerlink" title="3ã€Redis ç”Ÿäº§é—®é¢˜"></a>3ã€Redis ç”Ÿäº§é—®é¢˜</h3><div style="background-color: #f2c867; color: #34495e; padding: 15px; border: 2px solid #bdc3c7; border-radius: 5px;">  <strong>Redis ç”Ÿäº§é—®é¢˜ï¼š</strong>ç¼“å­˜ç©¿é€ã€ç¼“å­˜å‡»ç©¿ã€ç¼“å­˜é›ªå´©ã€æ•°æ®ä¸€è‡´æ€§ã€Redis é˜»å¡</div><h4 id="ç¼“å­˜ç©¿é€"><a href="#ç¼“å­˜ç©¿é€" class="headerlink" title="ç¼“å­˜ç©¿é€"></a>ç¼“å­˜ç©¿é€</h4><p>ç¼“å­˜ç©¿é€æ˜¯æŒ‡æŸ¥è¯¢ä¸å­˜åœ¨çš„æ•°æ®ã€‚ç”±äºè¿™äº›æ•°æ®ä¸åœ¨ç¼“å­˜ä¸­ï¼Œæ¯æ¬¡æŸ¥è¯¢éƒ½ä¼šç©¿è¿‡ç¼“å­˜ï¼Œç›´æ¥è®¿é—®æ•°æ®åº“ã€‚</p><p>å¦‚æœæœ‰å¤§é‡æ­¤ç±»æŸ¥è¯¢ï¼Œ<strong>æ•°æ®åº“å¯èƒ½ä¼šå› æ­¤æ‰¿å—è¿‡å¤§çš„å‹åŠ›</strong>ã€‚</p><blockquote><p>æˆå› </p></blockquote><ul><li>é¢‘ç¹æŸ¥è¯¢ä¸å­˜åœ¨çš„æ•°æ®ï¼ˆå¯èƒ½æ˜¯ç”±äºé”™è¯¯çš„è¾“å…¥æˆ–æ¶æ„æ”»å‡»ï¼‰ã€‚</li></ul><blockquote><p>è§£å†³æ–¹æ¡ˆ</p></blockquote><ul><li><strong>ç©ºå¯¹è±¡ç¼“å­˜</strong>ï¼šå³ä½¿æŸä¸ªå€¼åœ¨æ•°æ®åº“ä¸­ä¸å­˜åœ¨ï¼Œä¹Ÿå¯ä»¥åœ¨ç¼“å­˜ä¸­å­˜å‚¨ä¸€ä¸ªç‰¹æ®Šçš„ç©ºå¯¹è±¡æˆ–ç©ºå€¼ï¼Œå¹¶è®¾ç½®è¾ƒçŸ­çš„è¿‡æœŸæ—¶é—´ã€‚</li><li><strong>å¸ƒéš†è¿‡æ»¤å™¨</strong>ï¼šåœ¨æŸ¥è¯¢ä¹‹å‰ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨åˆ¤æ–­æ•°æ®æ˜¯å¦å¯èƒ½å­˜åœ¨ã€‚å¸ƒéš†è¿‡æ»¤å™¨æ˜¯ä¸€ç§ç©ºé—´æ•ˆç‡é«˜ä½†å¯èƒ½æœ‰ä¸€å®šè¯¯åˆ¤ç‡çš„æ•°æ®ç»“æ„ã€‚</li></ul><h4 id="ç¼“å­˜å‡»ç©¿"><a href="#ç¼“å­˜å‡»ç©¿" class="headerlink" title="ç¼“å­˜å‡»ç©¿"></a>ç¼“å­˜å‡»ç©¿</h4><p>ç¼“å­˜å‡»ç©¿æ˜¯æŒ‡æŸä¸ªçƒ­ç‚¹æ•°æ®ï¼ˆå³è¢«é¢‘ç¹è®¿é—®çš„æ•°æ®ï¼‰åœ¨ç¼“å­˜ä¸­å¤±æ•ˆçš„ç¬é—´ï¼Œå¤§é‡è¯·æ±‚åŒæ—¶æ¶Œå‘æ•°æ®åº“ã€‚</p><blockquote><p>æˆå› </p></blockquote><ul><li>çƒ­ç‚¹æ•°æ®åœ¨ç¼“å­˜ä¸­çªç„¶è¿‡æœŸï¼Œè€Œæ­¤æ—¶æ­£æœ‰å¤§é‡å¹¶å‘è¯·æ±‚è¿™äº›æ•°æ®ã€‚</li></ul><blockquote><p>è§£å†³æ–¹æ¡ˆ</p></blockquote><ul><li><strong>è®¾ç½®çƒ­ç‚¹æ•°æ®æ°¸ä¸è¿‡æœŸ</strong>ï¼šå¯¹äºä¸€äº›æå…¶çƒ­é—¨çš„æ•°æ®ï¼Œå¯ä»¥è®¾ç½®ä¸ºæ°¸ä¸è¿‡æœŸã€‚</li><li><strong>äº’æ–¥é”</strong>ï¼šåœ¨ç¼“å­˜å¤±æ•ˆçš„ç¬é—´ï¼Œä½¿ç”¨äº’æ–¥é”æˆ–åˆ†å¸ƒå¼é”ï¼Œç¡®ä¿åªæœ‰ä¸€ä¸ªè¯·æ±‚å»æ•°æ®åº“æŸ¥è¯¢æ•°æ®å¹¶é‡æ–°ç¼“å­˜ã€‚</li></ul><h4 id="ç¼“å­˜é›ªå´©"><a href="#ç¼“å­˜é›ªå´©" class="headerlink" title="ç¼“å­˜é›ªå´©"></a>ç¼“å­˜é›ªå´©</h4><p>ç¼“å­˜é›ªå´©æ˜¯æŒ‡ç¼“å­˜ä¸­å¤§é‡æ•°æ®åŒæ—¶è¿‡æœŸï¼Œå¯¼è‡´æ‰€æœ‰çš„è¯·æ±‚éƒ½ç›´æ¥è®¿é—®æ•°æ®åº“ï¼Œå¯èƒ½ä¼šä½¿æ•°æ®åº“å‹åŠ›è¿‡å¤§ç”šè‡³å´©æºƒã€‚</p><blockquote><p>æˆå› </p></blockquote><ul><li>ç¼“å­˜è®¾ç½®äº†ç›¸åŒçš„è¿‡æœŸæ—¶é—´ï¼Œå¯¼è‡´å¤§é‡æ•°æ®åŒæ—¶è¿‡æœŸã€‚</li><li>ç¼“å­˜æœåŠ¡å´©æºƒï¼Œæ‰€æœ‰æ•°æ®ä¸¢å¤±ã€‚</li></ul><blockquote><p>è§£å†³æ–¹æ¡ˆ</p></blockquote><ul><li><strong>ä¸åŒçš„è¿‡æœŸæ—¶é—´</strong>ï¼šä¸ºç¼“å­˜æ•°æ®è®¾ç½®ä¸åŒçš„è¿‡æœŸæ—¶é—´ï¼Œé¿å…åŒæ—¶è¿‡æœŸã€‚</li><li><strong>ç¼“å­˜æ•°æ®é¢„çƒ­</strong>ï¼šç³»ç»Ÿå¯åŠ¨æ—¶é¢„å…ˆåŠ è½½çƒ­ç‚¹æ•°æ®åˆ°ç¼“å­˜ä¸­ã€‚</li><li><strong>ä½¿ç”¨é«˜å¯ç”¨çš„ç¼“å­˜æ¶æ„</strong>ï¼šæ¯”å¦‚ä½¿ç”¨Redisé›†ç¾¤ï¼Œæé«˜ç¼“å­˜ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå®¹é”™èƒ½åŠ›ã€‚</li></ul><h4 id="å¦‚ä½•ä¿è¯ç¼“å­˜å’Œæ•°æ®åº“çš„æ•°æ®ä¸€è‡´æ€§"><a href="#å¦‚ä½•ä¿è¯ç¼“å­˜å’Œæ•°æ®åº“çš„æ•°æ®ä¸€è‡´æ€§" class="headerlink" title="å¦‚ä½•ä¿è¯ç¼“å­˜å’Œæ•°æ®åº“çš„æ•°æ®ä¸€è‡´æ€§"></a>å¦‚ä½•ä¿è¯ç¼“å­˜å’Œæ•°æ®åº“çš„æ•°æ®ä¸€è‡´æ€§</h4><h4 id="å“ªäº›æƒ…å†µå¯èƒ½å¯¼è‡´-Redis-é˜»å¡"><a href="#å“ªäº›æƒ…å†µå¯èƒ½å¯¼è‡´-Redis-é˜»å¡" class="headerlink" title="å“ªäº›æƒ…å†µå¯èƒ½å¯¼è‡´ Redis é˜»å¡"></a>å“ªäº›æƒ…å†µå¯èƒ½å¯¼è‡´ Redis é˜»å¡</h4><h3 id="4ã€Redis-é›†ç¾¤"><a href="#4ã€Redis-é›†ç¾¤" class="headerlink" title="4ã€Redis é›†ç¾¤"></a>4ã€Redis é›†ç¾¤</h3><p>çœ‹ä¸€ä¸‹è¿™ç¯‡æ–‡å­—ï¼š <a href="https://www.yuque.com/snailclimb/mf2z3k/ks9olb19hc9wse5k">https://www.yuque.com/snailclimb/mf2z3k/ks9olb19hc9wse5k</a></p><p>é‡Œé¢è®²è¿°äº†ä» ä¸»ä»èŠ‚ç‚¹å¤åˆ¶ â†’  å“¨å…µæœºåˆ¶ Sentinel  â†’ Redis é›†ç¾¤Cluster ï¼ˆè‡ªåŠ¨é…ç½®äº†å“¨å…µæ¨¡å¼ï¼Œä¸”å»ºè®®è‡³å°‘ä¸€ä¸»ä¸€ä»èŠ‚ç‚¹ï¼Œä¸‰ä¸ªä¸»èŠ‚ç‚¹ä»¥ä¸Šçš„å•æ•°èŠ‚ç‚¹é›†ç¾¤æ¨¡å¼ï¼‰</p><h3 id="5ã€Reids-ä½¿ç”¨è§„èŒƒ"><a href="#5ã€Reids-ä½¿ç”¨è§„èŒƒ" class="headerlink" title="5ã€Reids ä½¿ç”¨è§„èŒƒ"></a>5ã€Reids ä½¿ç”¨è§„èŒƒ</h3><hr><p>å‚è€ƒ</p><ul><li><a href="https://javaguide.cn/database/redis/redis-questions-02.html">https://javaguide.cn/database/redis/redis-questions-02.html</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>ä¸­é—´ä»¶</category>
      
      <category>Redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>NoSQL</tag>
      
      <tag>redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ¶ˆæ¯é˜Ÿåˆ—_RocketMQ_å®‰è£…ä¸ä½¿ç”¨</title>
    <link href="/2023/12/21/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97_RocketMQ_%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/"/>
    <url>/2023/12/21/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97_RocketMQ_%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<p>ä¸‹è½½åœ°å€ï¼š <a href="https://rocketmq.apache.org/download/">https://rocketmq.apache.org/download/</a></p><p>è¿™é‡Œä¸‹è½½ 4.8.0 ç‰ˆæœ¬ï¼š<a href="https://rocketmq.apache.org/release-notes/2020/12/21/4.8.0">Release Notes - Apache RocketMQ - Version 4.8.0 | RocketMQ</a></p><p>é€‰æ‹©Binary è¿›è¡Œä¸‹è½½ã€‚</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202312211150403.png" alt="image.png"></p><blockquote><p>NameServer</p></blockquote><p>æ³¨å†Œä¸­å¿ƒï¼Œç”¨äºç®¡ç† Broker</p><blockquote><p>Broker</p></blockquote><p>ç”¨æ¥ä¿æŒ Topic ä¸»é¢˜çš„ä¿¡æ¯ï¼Œæ¥æ”¶ç”Ÿäº§è€…çš„æ¶ˆæ¯ã€‚</p><h4 id="æ­å»ºå¯è§†åŒ–ç›‘æ§å¹³å°"><a href="#æ­å»ºå¯è§†åŒ–ç›‘æ§å¹³å°" class="headerlink" title="æ­å»ºå¯è§†åŒ–ç›‘æ§å¹³å°"></a>æ­å»ºå¯è§†åŒ–ç›‘æ§å¹³å°</h4><p>rocketmq-dashboardæ˜¯RocketMQçš„ä¸€ä¸ªæ‹“å±•å¼€æºé¡¹ç›®ï¼Œå¯ä»¥å¯¹MQè¿›è¡Œå¯è§†åŒ–ç›‘æ§ã€‚ </p><p>ä¸‹è½½åœ°å€ï¼š <a href="https://github.com/apache/rocketmq-dashboard">https://github.com/apache/rocketmq-dashboard</a></p><h4 id="RocketMQçš„åŸºæœ¬ä½¿ç”¨"><a href="#RocketMQçš„åŸºæœ¬ä½¿ç”¨" class="headerlink" title="RocketMQçš„åŸºæœ¬ä½¿ç”¨"></a>RocketMQçš„åŸºæœ¬ä½¿ç”¨</h4><p>to be continedâ€¦.</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://blog.csdn.net/xianren95/article/details/121924194">https://blog.csdn.net/xianren95/article/details/121924194</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>ä¸­é—´ä»¶</category>
      
      <category>MQ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MQ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Java8æ–°ç‰¹æ€§</title>
    <link href="/2023/12/20/Java8%E6%96%B0%E7%89%B9%E6%80%A7/"/>
    <url>/2023/12/20/Java8%E6%96%B0%E7%89%B9%E6%80%A7/</url>
    
    <content type="html"><![CDATA[<ul><li>æ¥å£ä¸­é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•</li><li>å‡½æ•°å¼æ¥å£ï¼ˆFunctional Interfaceï¼‰</li><li>Lambdaè¡¨è¾¾å¼ï¼ˆLambda Expressionsï¼‰</li><li>æµAPIï¼ˆStreams APIï¼‰</li><li>Optional ç±»</li><li>æ–°çš„æ—¥æœŸæ—¶é—´APIï¼ˆNew Date-Time APIï¼‰</li></ul><h3 id="1ã€æ¥å£ä¸­é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•"><a href="#1ã€æ¥å£ä¸­é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•" class="headerlink" title="1ã€æ¥å£ä¸­é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•"></a>1ã€æ¥å£ä¸­é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•</h3><p>åœ¨Java 8ä¹‹å‰ï¼Œæ¥å£åªèƒ½æœ‰æ–¹æ³•å£°æ˜ï¼Œè€Œä¸èƒ½æœ‰æ–¹æ³•å®ç°ã€‚è¿™æ„å‘³ç€ä¸€æ—¦æ¥å£è¢«æ›´æ”¹ï¼ˆæ¯”å¦‚æ·»åŠ æ–°æ–¹æ³•ï¼‰ï¼Œæ‰€æœ‰å®ç°äº†è¯¥æ¥å£çš„ç±»éƒ½å¿…é¡»éšä¹‹ä¿®æ”¹ä»¥å®ç°æ–°æ·»åŠ çš„æ–¹æ³•ã€‚</p><p>Java 8å¼•å…¥çš„<code>default</code>å’Œ<code>static</code>æ–¹æ³•æ­£æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><blockquote><p><code>default</code> æ–¹æ³•</p></blockquote><ul><li><p><strong>ä½œç”¨</strong>: <code>default</code>æ–¹æ³•å…è®¸æˆ‘ä»¬åœ¨æ¥å£ä¸­æ·»åŠ æœ‰å…·ä½“å®ç°çš„éæŠ½è±¡æ–¹æ³•ã€‚è¿™æ„å‘³ç€å®ç°æ¥å£çš„ç±»å¯ä»¥ä¸ç”¨å®ç°è¿™äº›<code>default</code>æ–¹æ³•ã€‚</p></li><li><p><strong>ç”¨é€”</strong>: è¿™å¯¹äºå‘ç°æœ‰æ¥å£æ·»åŠ æ–°åŠŸèƒ½éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒä¸ä¼šç ´åå®ç°è¯¥æ¥å£çš„ç°æœ‰ç±»çš„åŠŸèƒ½ã€‚</p></li><li><p><strong>ç±»æ¯”</strong>: æƒ³è±¡ä¸€ä¸‹ï¼Œæœ‰ä¸€ä¸ªæ ‡å‡†çš„å»ºç­‘è“å›¾ï¼ˆæ¥å£ï¼‰ã€‚çªç„¶ï¼Œéœ€è¦åœ¨æ‰€æœ‰è¿™æ ·çš„å»ºç­‘ä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„åŠŸèƒ½ï¼ˆæ¯”å¦‚ä¸­å¤®ä¾›æš–ï¼‰ã€‚<code>default</code>æ–¹æ³•å°±åƒæ˜¯ä¸€ä¸ªæ ‡å‡†çš„ä¸­å¤®ä¾›æš–ç³»ç»Ÿè®¾è®¡ï¼Œå¯ä»¥ç›´æ¥åŠ å…¥åˆ°ç°æœ‰çš„è“å›¾ä¸­ï¼Œè€Œä¸éœ€è¦é‡æ–°è®¾è®¡æ•´ä¸ªå»ºç­‘ã€‚</p></li></ul><blockquote><p><code>static</code> æ–¹æ³•</p></blockquote><ul><li><p><strong>ä½œç”¨</strong>: <code>static</code>æ–¹æ³•å…è®¸æˆ‘ä»¬åœ¨æ¥å£ä¸­æ·»åŠ é™æ€æ–¹æ³•ã€‚è¿™äº›æ–¹æ³•å¯ä»¥ç›´æ¥é€šè¿‡æ¥å£æ¥è°ƒç”¨ï¼Œè€Œä¸éœ€è¦ä¸€ä¸ªæ¥å£çš„å®ä¾‹ã€‚</p></li><li><p><strong>ç”¨é€”</strong>: <code>static</code>æ–¹æ³•é€šå¸¸ç”¨äºæä¾›ä¸€äº›ä¸æ¥å£ç›¸å…³çš„å·¥å…·æ–¹æ³•ã€‚</p></li><li><p><strong>ç±»æ¯”</strong>: å¦‚æœæ¥å£æ˜¯ä¸€ç§æœåŠ¡çš„æ ‡å‡†ï¼ˆæ¯”å¦‚é‚®å¯„æœåŠ¡ï¼‰ï¼Œé‚£ä¹ˆ<code>static</code>æ–¹æ³•å°±åƒæ˜¯å¯ä»¥ç›´æ¥ä»æœåŠ¡æ ‡å‡†æœ¬èº«è·å¾—çš„é¢å¤–å¸®åŠ©æˆ–å·¥å…·ï¼Œå¦‚ä¸€ä¸ªåœ¨çº¿é‚®èµ„è®¡ç®—å™¨ã€‚</p></li></ul><p>å…·ä½“ä½¿ç”¨ç¤ºä¾‹</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs haxe"><span class="hljs-title class_"><span class="hljs-keyword">interface</span> <span class="hljs-title">MyInterface</span> </span>&#123;<br>    <span class="hljs-comment">// ä¸€ä¸ªé»˜è®¤æ–¹æ³•</span><br>    <span class="hljs-keyword">default</span> void <span class="hljs-keyword">new</span><span class="hljs-type">Method</span>() &#123;<br>        System.out.println(<span class="hljs-string">&quot;This is a default method&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-comment">// ä¸€ä¸ªé™æ€æ–¹æ³•</span><br>    <span class="hljs-keyword">static</span> void anotherNewMethod() &#123;<br>        System.out.println(<span class="hljs-string">&quot;This is a static method&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// å®ç°æ¥å£çš„ç±»</span><br><span class="hljs-title class_"><span class="hljs-keyword">class</span> <span class="hljs-title">MyClass</span> <span class="hljs-keyword"><span class="hljs-keyword">implements</span> <span class="hljs-type">MyInterface</span></span> </span>&#123;<br>    <span class="hljs-comment">// ä¸éœ€è¦å®ç°newMethod()</span><br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-title class_"><span class="hljs-keyword">class</span> <span class="hljs-title">Main</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> void main(<span class="hljs-keyword">String</span>[] args) &#123;<br>        MyClass myClass = <span class="hljs-keyword">new</span> <span class="hljs-type">MyClass</span>();<br>        myClass.<span class="hljs-keyword">new</span><span class="hljs-type">Method</span>(); <span class="hljs-comment">// è°ƒç”¨é»˜è®¤æ–¹æ³•</span><br><br>        MyInterface.anotherNewMethod(); <span class="hljs-comment">// ç›´æ¥è°ƒç”¨æ¥å£çš„é™æ€æ–¹æ³•</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>MyClass</code>å®ç°äº†<code>MyInterface</code>ä½†æ²¡æœ‰å®ç°<code>newMethod()</code>æ–¹æ³•ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªé»˜è®¤æ–¹æ³•ã€‚</p><p>åŒæ—¶ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡<code>MyInterface</code>è°ƒç”¨é™æ€æ–¹æ³•<code>anotherNewMethod()</code>ã€‚</p><hr><p>æœ‰ä¸€ç§æƒ…å†µéœ€è¦é‡å†™ default çš„æ¥å£æ–¹æ³•ï¼Œæ³¨æ„ä¸€ä¸‹ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">InterfaceNew</span> &#123;<br>    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">sm</span>()</span> &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;interfaceæä¾›çš„æ–¹å¼å®ç°&quot;</span>);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">sm2</span>()</span> &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;interfaceæä¾›çš„æ–¹å¼å®ç°&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-literal">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title">def</span>()</span> &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;interface defaultæ–¹æ³•&quot;</span>);<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-literal">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title">def2</span>()</span> &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;interface default2æ–¹æ³•&quot;</span>);<br>    &#125;<br>    <span class="hljs-comment">//é¡»è¦å®ç°ç±»é‡å†™</span><br>    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">f</span>()</span>;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">InterfaceNew1</span> &#123;<br>    <span class="hljs-function"><span class="hljs-literal">default</span> <span class="hljs-keyword">void</span> <span class="hljs-title">def</span>()</span> &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;InterfaceNew1 defaultæ–¹æ³•&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¦‚æœæœ‰ä¸€ä¸ªç±»æ—¢å®ç°äº† <code>InterfaceNew</code> æ¥å£åˆå®ç°äº† <code>InterfaceNew1</code>æ¥å£ï¼Œå®ƒä»¬éƒ½æœ‰<code>def()</code>ï¼Œå¹¶ä¸” <code>InterfaceNew</code> æ¥å£å’Œ <code>InterfaceNew1</code>æ¥å£æ²¡æœ‰ç»§æ‰¿å…³ç³»çš„è¯ï¼Œè¿™æ—¶å°±å¿…é¡»é‡å†™<code>def()</code>ã€‚</p><p>ä¸ç„¶çš„è¯ï¼Œç¼–è¯‘çš„æ—¶å€™å°±ä¼šæŠ¥é”™ã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InterfaceNewImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">InterfaceNew</span> , <span class="hljs-title class_">InterfaceNew1</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"><span class="hljs-built_in">String</span>[] args</span>) &#123;<br>        <span class="hljs-title class_">InterfaceNewImpl</span> interfaceNew = <span class="hljs-keyword">new</span> <span class="hljs-title class_">InterfaceNewImpl</span>();<br>        interfaceNew.<span class="hljs-title function_">def</span>();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">def</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title class_">InterfaceNew1</span>.<span class="hljs-property">super</span>.<span class="hljs-title function_">def</span>();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">f</span>(<span class="hljs-params"></span>) &#123;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><hr><blockquote><p>Java8ä¸­ï¼Œæ¥å£å’ŒæŠ½è±¡ç±»çš„åŒºåˆ«</p></blockquote><ul><li>interface å’Œ class çš„åŒºåˆ«ï¼Œä¸»è¦æœ‰ï¼š<ul><li>æ¥å£å¤šå®ç°ï¼Œç±»å•ç»§æ‰¿</li><li>æ¥å£çš„æ–¹æ³•æ˜¯ public abstract ä¿®é¥°ï¼Œå˜é‡æ˜¯ public static final ä¿®é¥°ã€‚ abstract class å¯ä»¥ç”¨å…¶ä»–ä¿®é¥°ç¬¦</li></ul></li><li>interface çš„æ–¹æ³•æ˜¯<strong>æ›´åƒæ˜¯ä¸€ä¸ªæ‰©å±•æ’ä»¶</strong>ã€‚è€Œ abstract class çš„æ–¹æ³•æ˜¯è¦ç»§æ‰¿çš„ã€‚</li></ul><p>interface æ–°å¢<code>default</code>å’Œ<code>static</code>ä¿®é¥°çš„æ–¹æ³•ï¼Œä¸ºäº†è§£å†³æ¥å£çš„ä¿®æ”¹ä¸ç°æœ‰çš„å®ç°ä¸å…¼å®¹çš„é—®é¢˜ï¼Œå¹¶ä¸æ˜¯ä¸ºäº†è¦æ›¿ä»£<code>abstract class</code>ã€‚</p><h3 id="2ã€å‡½æ•°å¼æ¥å£ï¼ˆFunctional-Interfaceï¼‰"><a href="#2ã€å‡½æ•°å¼æ¥å£ï¼ˆFunctional-Interfaceï¼‰" class="headerlink" title="2ã€å‡½æ•°å¼æ¥å£ï¼ˆFunctional Interfaceï¼‰"></a>2ã€å‡½æ•°å¼æ¥å£ï¼ˆFunctional Interfaceï¼‰</h3><p>å‡½æ•°å¼æ¥å£ï¼ˆFunctional Interfaceï¼‰æ˜¯Java 8å¼•å…¥çš„ä¸€ä¸ª<strong>é‡è¦æ¦‚å¿µ</strong>ï¼Œå®ƒæ˜¯Javaå¯¹å‡½æ•°å¼ç¼–ç¨‹æ”¯æŒçš„ä¸€éƒ¨åˆ†ã€‚</p><blockquote><p>å®šä¹‰</p></blockquote><p>å‡½æ•°å¼æ¥å£<strong>æ˜¯åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£</strong>ã€‚å°½ç®¡æ¥å£å¯ä»¥åŒ…å«å¤šä¸ªé»˜è®¤æ–¹æ³•ã€é™æ€æ–¹æ³•ï¼Œ<strong>ä½†åªèƒ½æœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•</strong>ã€‚è¿™ç§æ¥å£çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†ä¸Lambdaè¡¨è¾¾å¼ç»“åˆä½¿ç”¨ã€‚</p><blockquote><p><code>@FunctionalInterface</code> æ³¨è§£</p></blockquote><p>è™½ç„¶ä¸æ˜¯å¼ºåˆ¶æ€§çš„ï¼Œä½†é€šå¸¸ä¼šä½¿ç”¨<code>@FunctionalInterface</code>æ³¨è§£æ¥æ ‡è®°å‡½æ•°å¼æ¥å£ã€‚è¿™ä¸ªæ³¨è§£æœ‰åŠ©äºç¼–è¯‘å™¨è¯†åˆ«æ„å›¾ï¼Œå¹¶åœ¨æ¥å£ä¸æ˜¯æœ‰æ•ˆçš„å‡½æ•°å¼æ¥å£æ—¶ç”Ÿæˆç¼–è¯‘æ—¶é”™è¯¯ã€‚</p><blockquote><p>å‡½æ•°å¼æ¥å£ç¤ºä¾‹ï¼š</p></blockquote><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs haxe"><span class="hljs-meta">@FunctionalInterface</span><br><span class="hljs-title class_"><span class="hljs-keyword">interface</span> <span class="hljs-title">Greeting</span> </span>&#123;<br>    <span class="hljs-keyword">String</span> sayHello(<span class="hljs-keyword">String</span> name);<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ä¸ª<code>Greeting</code>æ¥å£å®šä¹‰äº†ä¸€ä¸ªæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°å¹¶è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²çš„æ–¹æ³•ã€‚</p><p>ç”±äºå®ƒåªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œæ‰€ä»¥å®ƒæ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ã€‚</p><blockquote><p>ä½¿ç”¨åœºæ™¯</p></blockquote><p>å‡½æ•°å¼æ¥å£åœ¨Java 8ä¸­å¼•å…¥Lambdaè¡¨è¾¾å¼æ—¶å˜å¾—éå¸¸é‡è¦ã€‚Lambdaè¡¨è¾¾å¼æä¾›äº†ä¸€ç§ç®€æ´çš„æ–¹å¼æ¥å®ç°å‡½æ•°å¼æ¥å£ï¼Œä»è€Œä½¿ä»£ç æ›´ç®€æ´ã€æ›´æ˜“è¯»ã€‚</p><p>å¯ä»¥å°†å‡½æ•°å¼æ¥å£æƒ³è±¡æˆä¸€ç§ç‰¹æ®Šçš„å·¥å…·å¥—ä»¶ã€‚è¿™ä¸ªå¥—ä»¶é‡Œåªæœ‰ä¸€ä¸ªå·¥å…·æ§½ï¼ˆæŠ½è±¡æ–¹æ³•ï¼‰ï¼Œä½†ä½ å¯ä»¥ä»¥å¤šç§æ–¹å¼ï¼ˆLambdaè¡¨è¾¾å¼ã€æ–¹æ³•å¼•ç”¨ï¼‰å¡«å……è¿™ä¸ªæ§½ã€‚è¿™å°±åƒæ˜¯ä¸€ä¸ªå¯å®šåˆ¶çš„å·¥å…·ï¼Œä½ å¯ä»¥æ ¹æ®éœ€è¦æ’å…¥ä¸åŒçš„åŠŸèƒ½ã€‚</p><p>å‡½æ•°å¼æ¥å£åœ¨Javaä¸­çš„å¾ˆå¤šåœ°æ–¹éƒ½æœ‰ä½¿ç”¨ï¼Œä¾‹å¦‚ï¼š</p><ul><li>åœ¨<code>java.util.function</code>åŒ…ä¸­ï¼ŒJava 8å¼•å…¥äº†ä¸€ç³»åˆ—æ ‡å‡†çš„å‡½æ•°å¼æ¥å£ï¼Œå¦‚<code>Predicate&lt;T&gt;</code>ã€<code>Function&lt;T,R&gt;</code>ã€<code>Consumer&lt;T&gt;</code>ç­‰ã€‚</li><li>åœ¨é›†åˆæ¡†æ¶ä¸­ï¼Œå®ƒä»¬è¢«ç”¨äºç®€åŒ–è¿­ä»£ã€è¿‡æ»¤å’Œè½¬æ¢æ“ä½œã€‚</li><li>åœ¨å¹¶å‘ç¼–ç¨‹ä¸­ï¼Œä¾‹å¦‚ä½¿ç”¨<code>Runnable</code>æˆ–<code>Callable</code>æ¥å£ã€‚</li></ul><h3 id="3ã€Lambda-è¡¨è¾¾å¼"><a href="#3ã€Lambda-è¡¨è¾¾å¼" class="headerlink" title="3ã€Lambda è¡¨è¾¾å¼"></a>3ã€Lambda è¡¨è¾¾å¼</h3><p>Lambdaè¡¨è¾¾å¼æ˜¯Java 8ä¸­ä¸€ä¸ªéå¸¸é‡è¦çš„æ–°ç‰¹æ€§ï¼Œå®ƒä¸ºJavaå¸¦æ¥äº†ä¸€ç§ç®€æ´çš„æ–¹å¼æ¥è¡¨ç¤ºå‡½æ•°å¼æ¥å£çš„å®ä¾‹ã€‚</p><p>Lambdaè¡¨è¾¾å¼ä¸»è¦ç”¨äºæä¾›ä¸€ç§ç®€æ´ã€è¡¨è¾¾å¼é£æ ¼çš„æ–¹æ³•æ¥è¡¨ç¤ºå¯ä»¥ä¼ é€’çš„åŒ¿åå‡½æ•°ã€‚è¿™ç§è¡¨è¾¾æ–¹å¼éå¸¸é€‚åˆåˆ›å»ºç®€çŸ­çš„ã€åªä½¿ç”¨ä¸€æ¬¡çš„æ–¹æ³•ç‰ˆæœ¬ã€‚</p><h4 id="è¯­æ³•æ ¼å¼"><a href="#è¯­æ³•æ ¼å¼" class="headerlink" title="è¯­æ³•æ ¼å¼"></a>è¯­æ³•æ ¼å¼</h4><blockquote><p>è¯­æ³•æ ¼å¼</p></blockquote><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livescript"><span class="hljs-function"><span class="hljs-params">(parameters)</span> -&gt;</span> expression æˆ–<br><span class="hljs-function"><span class="hljs-params">(parameters)</span> -&gt;</span>&#123; statements; &#125;<br></code></pre></td></tr></table></figure><ul><li>parameters<ul><li>ä¸æ–¹æ³•å®šä¹‰ä¸­çš„å‚æ•°åˆ—è¡¨ç±»ä¼¼ã€‚å¯¹äºå•ä¸ªå‚æ•°ï¼Œå¯ä»¥çœç•¥æ‹¬å·</li></ul></li><li><code>-&gt;</code><ul><li>Lambdaè¡¨è¾¾å¼çš„æ ¸å¿ƒï¼Œç”¨äºåˆ†éš”å‚æ•°åˆ—è¡¨å’ŒLambdaä½“</li></ul></li><li><strong>Lambdaä½“</strong><ul><li>å¯ä»¥æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼æˆ–ä¸€ä¸ªä»£ç å—ã€‚è¡¨è¾¾å¼ä½“ä¼šè¿”å›ä¸€ä¸ªå€¼ï¼Œè€Œä»£ç å—å¯ä»¥åŒ…å«é›¶ä¸ªæˆ–å¤šä¸ªè¯­å¥ã€‚</li></ul></li></ul><h4 id="ç®€æ˜“ç¤ºä¾‹"><a href="#ç®€æ˜“ç¤ºä¾‹" class="headerlink" title="ç®€æ˜“ç¤ºä¾‹"></a>ç®€æ˜“ç¤ºä¾‹</h4><blockquote><p>ä½¿ç”¨ç¤ºä¾‹</p></blockquote><p>Lambdaè¡¨è¾¾å¼é€šå¸¸ä¸å‡½æ•°å¼æ¥å£ä¸€èµ·ä½¿ç”¨ã€‚å‡½æ•°å¼æ¥å£æ˜¯åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£ï¼Œè¿™æ„å‘³ç€Lambdaè¡¨è¾¾å¼å¯ä»¥ä¸ºè¯¥æŠ½è±¡æ–¹æ³•æä¾›å®ç°ã€‚</p><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç®€å•çš„å‡½æ•°å¼æ¥å£ï¼š</p><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs aspectj"><span class="hljs-meta">@FunctionalInterface</span><br><span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">StringOperation</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">getLength</span><span class="hljs-params">(String s)</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸ä½¿ç”¨Lambdaè¡¨è¾¾å¼ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦è¿™æ ·å®ç°ï¼š</p><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs aspectj">StringOperation operation = <span class="hljs-keyword">new</span> StringOperation() &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">getLength</span><span class="hljs-params">(String s)</span> </span>&#123;<br>        <span class="hljs-function"><span class="hljs-keyword">return</span> s.<span class="hljs-title">length</span><span class="hljs-params">()</span></span>;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨Lambdaè¡¨è¾¾å¼ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·ç®€åŒ–ï¼š</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">StringOperation operation <span class="hljs-operator">=</span> s -&gt; s.length()<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><h4 id="æ›¿ä»£åŒ¿åå†…éƒ¨ç±»"><a href="#æ›¿ä»£åŒ¿åå†…éƒ¨ç±»" class="headerlink" title="æ›¿ä»£åŒ¿åå†…éƒ¨ç±»"></a>æ›¿ä»£åŒ¿åå†…éƒ¨ç±»</h4><p>å¹³æ—¶å¼€å‘ç»å¸¸ä¼šç”¨åˆ° Runnable æ¥å£ã€Comparator æ¥å£ã€Listener æ¥å£ è¿™ä¸‰ä¸ªæ¥å£ï¼Œä¸‹é¢åˆ†åˆ«å°±çœ‹ä¸€ä¸‹ä»–ä»¬çš„ä½¿ç”¨ç¤ºä¾‹ã€‚</p><blockquote><p>Runnable æ¥å£</p></blockquote><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-built_in">new</span> Thread(<span class="hljs-built_in">new</span> Runnable() &#123;<br>            @Override<br>            <span class="hljs-built_in">public</span> <span class="hljs-type">void</span> run() &#123;<br>                <span class="hljs-keyword">System</span>.<span class="hljs-keyword">out</span>.println(&quot;The runable now is using!&quot;);<br>            &#125;<br>&#125;).<span class="hljs-keyword">start</span>();<br>//ç”¨lambda<br><span class="hljs-built_in">new</span> Thread(() -&gt; <span class="hljs-keyword">System</span>.<span class="hljs-keyword">out</span>.println(&quot;It&#x27;s a lambda function!&quot;)).<span class="hljs-keyword">start</span>();<br></code></pre></td></tr></table></figure><blockquote><p>Comparator æ¥å£</p></blockquote><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">List&lt;<span class="hljs-type">Integer</span>&gt; strings = Arrays.asList(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>);<br><br>Collections.sort(strings, <span class="hljs-built_in">new</span> Comparator&lt;<span class="hljs-type">Integer</span>&gt;() &#123;<br>@Override<br><span class="hljs-built_in">public</span> <span class="hljs-type">int</span> compare(<span class="hljs-type">Integer</span> o1, <span class="hljs-type">Integer</span> o2) &#123;<br>    <span class="hljs-keyword">return</span> o1 - o2;&#125;<br>&#125;);<br><br>//Lambda<br>Collections.sort(strings, (<span class="hljs-type">Integer</span> o1, <span class="hljs-type">Integer</span> o2) -&gt; o1 - o2);<br>//åˆ†è§£å¼€<br>Comparator&lt;<span class="hljs-type">Integer</span>&gt; comparator = (<span class="hljs-type">Integer</span> o1, <span class="hljs-type">Integer</span> o2) -&gt; o1 - o2;<br>Collections.sort(strings, comparator);<br></code></pre></td></tr></table></figure><blockquote><p>Listener æ¥å£</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">JButton</span> <span class="hljs-variable">button</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JButton</span>();<br>button.addItemListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ItemListener</span>() &#123;<br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">itemStateChanged</span><span class="hljs-params">(ItemEvent e)</span> &#123;<br>   e.getItem();<br>&#125;<br>&#125;);<br><span class="hljs-comment">//lambda</span><br>button.addItemListener(e -&gt; e.getItem());<br></code></pre></td></tr></table></figure><h4 id="é›†åˆä¸Šä½¿ç”¨"><a href="#é›†åˆä¸Šä½¿ç”¨" class="headerlink" title="é›†åˆä¸Šä½¿ç”¨"></a>é›†åˆä¸Šä½¿ç”¨</h4><blockquote><p>åœ¨é›†åˆä¸Šçš„åº”ç”¨</p></blockquote><p>Lambdaè¡¨è¾¾å¼ç‰¹åˆ«é€‚åˆç”¨åœ¨é›†åˆçš„æ“ä½œä¸Šï¼Œæ¯”å¦‚<code>forEach</code>ã€<code>map</code>ã€<code>filter</code>ç­‰æ–¹æ³•ï¼š</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">List&lt;String&gt; list = Arrays.asList(&quot;Java&quot;, &quot;Python&quot;, &quot;C++&quot;);<br><br>// ä½¿ç”¨Lambdaè¡¨è¾¾å¼è¿­ä»£<br>list.<span class="hljs-keyword">forEach</span>(element -&gt; <span class="hljs-keyword">System</span>.<span class="hljs-keyword">out</span>.println(element));<br><br>// ä½¿ç”¨Lambdaè¡¨è¾¾å¼å’ŒStream APIè¿›è¡Œè¿‡æ»¤<br>list.stream()<br>    .<span class="hljs-keyword">filter</span>(s -&gt; s.startsWith(&quot;J&quot;))<br>    .<span class="hljs-keyword">forEach</span>(<span class="hljs-keyword">System</span>.<span class="hljs-keyword">out</span>::println);<br><br></code></pre></td></tr></table></figure><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-type">void</span> lamndaFor() &#123;<br>        List&lt;String&gt; strings = Arrays.asList(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;);<br>        //ä¼ ç»Ÿ<span class="hljs-keyword">foreach</span><br>        <span class="hljs-keyword">for</span> (String s : strings) &#123;<br>            <span class="hljs-keyword">System</span>.<span class="hljs-keyword">out</span>.println(s);<br>        &#125;<br>        //Lambda <span class="hljs-keyword">foreach</span><br>        strings.<span class="hljs-keyword">forEach</span>((s) -&gt; <span class="hljs-keyword">System</span>.<span class="hljs-keyword">out</span>.println(s));<br>        //<span class="hljs-keyword">or</span><br>        strings.<span class="hljs-keyword">forEach</span>(<span class="hljs-keyword">System</span>.<span class="hljs-keyword">out</span>::println);<br> //map<br>        Map&lt;<span class="hljs-type">Integer</span>, String&gt; map = <span class="hljs-built_in">new</span> HashMap&lt;&gt;();<br>        map.<span class="hljs-keyword">forEach</span>((k,v)-&gt;<span class="hljs-keyword">System</span>.<span class="hljs-keyword">out</span>.println(v));<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="æ–¹æ³•çš„å¼•ç”¨"><a href="#æ–¹æ³•çš„å¼•ç”¨" class="headerlink" title="æ–¹æ³•çš„å¼•ç”¨"></a>æ–¹æ³•çš„å¼•ç”¨</h4><p>Java 8 å…è®¸ä½¿ç”¨Â <code>::</code>Â å…³é”®å­—æ¥ä¼ é€’æ–¹æ³•æˆ–è€…æ„é€ å‡½æ•°å¼•ç”¨ï¼Œæ— è®ºå¦‚ä½•ï¼Œè¡¨è¾¾å¼è¿”å›çš„ç±»å‹å¿…é¡»æ˜¯ functional-interfaceã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LambdaClassSuper</span> &#123;<br>    LambdaInterface <span class="hljs-title function_">sf</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LambdaClass</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">LambdaClassSuper</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> LambdaInterface <span class="hljs-title function_">staticF</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> LambdaInterface <span class="hljs-title function_">f</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">show</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">//1.è°ƒç”¨é™æ€å‡½æ•°ï¼Œè¿”å›ç±»å‹å¿…é¡»æ˜¯functional-interface</span><br>        <span class="hljs-type">LambdaInterface</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> LambdaClass::staticF;<br><br>        <span class="hljs-comment">//2.å®ä¾‹æ–¹æ³•è°ƒç”¨</span><br>        <span class="hljs-type">LambdaClass</span> <span class="hljs-variable">lambdaClass</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LambdaClass</span>();<br>        <span class="hljs-type">LambdaInterface</span> <span class="hljs-variable">lambdaInterface</span> <span class="hljs-operator">=</span> lambdaClass::f;<br><br>        <span class="hljs-comment">//3.è¶…ç±»ä¸Šçš„æ–¹æ³•è°ƒç”¨</span><br>        <span class="hljs-type">LambdaInterface</span> <span class="hljs-variable">superf</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">super</span>::sf;<br><br>        <span class="hljs-comment">//4. æ„é€ æ–¹æ³•è°ƒç”¨</span><br>        <span class="hljs-type">LambdaInterface</span> <span class="hljs-variable">tt</span> <span class="hljs-operator">=</span> LambdaClassSuper::<span class="hljs-keyword">new</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è®¿é—®å˜é‡</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>;<br>Collections.sort(<span class="hljs-built_in">string</span>s, (Integer o1, Integer o2) -&gt; o1 - i);<br><span class="hljs-comment">//i =3;</span><br></code></pre></td></tr></table></figure><p>lambda è¡¨è¾¾å¼å¯ä»¥å¼•ç”¨å¤–è¾¹å˜é‡ï¼Œä½†æ˜¯è¯¥å˜é‡é»˜è®¤æ‹¥æœ‰ final å±æ€§ï¼Œä¸èƒ½è¢«ä¿®æ”¹ï¼Œå¦‚æœä¿®æ”¹ï¼Œç¼–è¯‘æ—¶å°±æŠ¥é”™ã€‚</p><p>to be continedâ€¦â€¦</p><h3 id="4ã€Stream"><a href="#4ã€Stream" class="headerlink" title="4ã€Stream"></a>4ã€Stream</h3><blockquote><p>Stream æ˜¯ä»€ä¹ˆ</p></blockquote><p>java æ–°å¢äº† <code>java.util.stream</code> åŒ…ï¼Œå®ƒå’Œä¹‹å‰çš„æµå¤§åŒå°å¼‚ã€‚ä¹‹å‰æ¥è§¦æœ€å¤šçš„æ˜¯èµ„æºæµï¼Œæ¯”å¦‚<code>java.io.FileInputStream</code>ï¼Œé€šè¿‡æµæŠŠæ–‡ä»¶ä»ä¸€ä¸ªåœ°æ–¹è¾“å…¥åˆ°å¦ä¸€ä¸ªåœ°æ–¹ï¼Œå®ƒåªæ˜¯å†…å®¹æ¬è¿å·¥ï¼Œå¯¹æ–‡ä»¶å†…å®¹ä¸åšä»»ä½• CRUDã€‚</p><p><code>Stream</code>ä¾ç„¶ä¸å­˜å‚¨æ•°æ®ï¼Œä¸åŒçš„æ˜¯å®ƒå¯ä»¥æ£€ç´¢(Retrieve)å’Œé€»è¾‘å¤„ç†é›†åˆæ•°æ®ã€åŒ…æ‹¬ç­›é€‰ã€æ’åºã€ç»Ÿè®¡ã€è®¡æ•°ç­‰ã€‚å¯ä»¥æƒ³è±¡æˆæ˜¯ Sql è¯­å¥ã€‚</p><p>å®ƒçš„æºæ•°æ®å¯ä»¥æ˜¯ <code>Collection</code>ã€<code>Array</code> ç­‰ã€‚ç”±äºå®ƒçš„æ–¹æ³•å‚æ•°éƒ½æ˜¯å‡½æ•°å¼æ¥å£ç±»å‹ï¼Œæ‰€ä»¥ä¸€èˆ¬å’Œ Lambda é…åˆä½¿ç”¨ã€‚</p><blockquote><p>æµç±»å‹</p></blockquote><ol><li>stream ä¸²è¡Œæµ</li><li>parallelStream å¹¶è¡Œæµï¼Œå¯å¤šçº¿ç¨‹æ‰§è¡Œ</li></ol><h4 id="Stream-å¸¸ç”¨æ–¹æ³•"><a href="#Stream-å¸¸ç”¨æ–¹æ³•" class="headerlink" title="Stream å¸¸ç”¨æ–¹æ³•"></a>Stream å¸¸ç”¨æ–¹æ³•</h4><ul><li><code>stream()</code>, <code>parallelStream()</code></li><li><code>filter()</code></li><li><code>findAny()</code> <code>findFirst()</code></li><li><code>sort</code></li><li><code>forEach</code> void</li><li><code>map(), reduce()</code></li><li><code>flatMap()</code> - å°†å¤šä¸ªStreamè¿æ¥æˆä¸€ä¸ªStream</li><li><code>collect(Collectors.toList())</code></li><li><code>distinct</code>, <code>limit</code></li><li><code>count</code></li><li><code>min</code>, <code>max</code>, <code>summaryStatistics</code></li></ul><h3 id="5ã€Optional"><a href="#5ã€Optional" class="headerlink" title="5ã€Optional"></a>5ã€Optional</h3><h3 id="6ã€Date-Time-API"><a href="#6ã€Date-Time-API" class="headerlink" title="6ã€Date-Time API"></a>6ã€Date-Time API</h3><p>to be continedâ€¦.</p><hr><p>å‚è€ƒ</p><ul><li><a href="http://moxi159753.gitee.io/learningnotes/#/">http://moxi159753.gitee.io/learningnotes/#/</a></li><li><a href="https://www.pdai.tech/md/interview/x-interview.html#_6-1-java-8-%E7%89%B9%E6%80%A7">https://www.pdai.tech/md/interview/x-interview.html#_6-1-java-8-%E7%89%B9%E6%80%A7</a></li><li><a href="https://javaguide.cn/java/new-features/java8-common-new-features.html">https://javaguide.cn/java/new-features/java8-common-new-features.html</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
      <category>JDK8</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaå¹¶å‘ç¼–ç¨‹_çº¿ç¨‹æ± </title>
    <link href="/2023/12/19/Java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B_%E7%BA%BF%E7%A8%8B%E6%B1%A0/"/>
    <url>/2023/12/19/Java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B_%E7%BA%BF%E7%A8%8B%E6%B1%A0/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å¤§çº²</p></blockquote><ul><li>çº¿ç¨‹æ± ä»‹ç»</li><li>Executor æ¡†æ¶</li><li>ThreadPoolExecutor ç±»</li><li>çº¿ç¨‹æ± åŸç†åˆ†æ</li><li>å¸¸è§çš„å†…ç½®çº¿ç¨‹æ± </li><li>å®è·µä½¿ç”¨ç¯‡</li></ul><h3 id="1ã€ä»€ä¹ˆæ˜¯çº¿ç¨‹æ± "><a href="#1ã€ä»€ä¹ˆæ˜¯çº¿ç¨‹æ± " class="headerlink" title="1ã€ä»€ä¹ˆæ˜¯çº¿ç¨‹æ± "></a>1ã€ä»€ä¹ˆæ˜¯çº¿ç¨‹æ± </h3><p>çº¿ç¨‹æ± æ˜¯ç®¡ç†ä¸€ç³»åˆ—çº¿ç¨‹çš„èµ„æºæ± ï¼Œå…¶æä¾›äº†ä¸€ç§é™åˆ¶å’Œç®¡ç†çº¿ç¨‹èµ„æºçš„æ–¹å¼ã€‚</p><p><strong>çº¿ç¨‹æ± ä¸€èˆ¬ç”¨äºæ‰§è¡Œå¤šä¸ªä¸ç›¸å…³è”çš„è€—æ—¶ä»»åŠ¡ï¼Œæ²¡æœ‰å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œä»»åŠ¡é¡ºåºæ‰§è¡Œï¼Œä½¿ç”¨äº†çº¿ç¨‹æ± çš„è¯å¯è®©å¤šä¸ªä¸ç›¸å…³è”çš„ä»»åŠ¡åŒæ—¶æ‰§è¡Œ</strong></p><p>ä½¿ç”¨çº¿ç¨‹æ± çš„ä¸€äº›å¥½å¤„ï¼š</p><ul><li><strong>é™ä½èµ„æºæ¶ˆè€—</strong>ã€‚é€šè¿‡é‡å¤åˆ©ç”¨å·²åˆ›å»ºçš„çº¿ç¨‹é™ä½çº¿ç¨‹åˆ›å»ºå’Œé”€æ¯é€ æˆçš„æ¶ˆè€—ã€‚</li><li><strong>æé«˜å“åº”é€Ÿåº¦</strong>ã€‚å½“ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œä»»åŠ¡å¯ä»¥ä¸éœ€è¦ç­‰åˆ°çº¿ç¨‹åˆ›å»ºå°±èƒ½ç«‹å³æ‰§è¡Œã€‚</li><li><strong>æé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§</strong>ã€‚çº¿ç¨‹æ˜¯ç¨€ç¼ºèµ„æºï¼Œå¦‚æœæ— é™åˆ¶çš„åˆ›å»ºï¼Œä¸ä»…ä¼šæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œè¿˜ä¼šé™ä½ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è¿›è¡Œç»Ÿä¸€çš„åˆ†é…ï¼Œè°ƒä¼˜å’Œç›‘æ§ã€‚</li></ul><h3 id="2ã€Executor-æ¡†æ¶ä»‹ç»"><a href="#2ã€Executor-æ¡†æ¶ä»‹ç»" class="headerlink" title="2ã€Executor æ¡†æ¶ä»‹ç»"></a>2ã€Executor æ¡†æ¶ä»‹ç»</h3><p><code>Executor</code> æ¡†æ¶æ˜¯ Java5 ä¹‹åå¼•è¿›çš„ï¼Œåœ¨ Java 5 ä¹‹åï¼Œé€šè¿‡ <code>Executor</code> æ¥å¯åŠ¨çº¿ç¨‹æ¯”ä½¿ç”¨ <code>Thread</code> çš„ <code>start</code> æ–¹æ³•æ›´å¥½ï¼Œé™¤äº†æ›´æ˜“ç®¡ç†ï¼Œæ•ˆç‡æ›´å¥½ï¼ˆç”¨çº¿ç¨‹æ± å®ç°ï¼ŒèŠ‚çº¦å¼€é”€ï¼‰å¤–ï¼Œè¿˜æœ‰å…³é”®çš„ä¸€ç‚¹ï¼šæœ‰åŠ©äºé¿å… this é€ƒé€¸é—®é¢˜ã€‚</p><blockquote><p>this é€ƒé€¸æ˜¯æŒ‡åœ¨æ„é€ å‡½æ•°è¿”å›ä¹‹å‰å…¶ä»–çº¿ç¨‹å°±æŒæœ‰è¯¥å¯¹è±¡çš„å¼•ç”¨ï¼Œè°ƒç”¨å°šæœªæ„é€ å®Œå…¨çš„å¯¹è±¡çš„æ–¹æ³•å¯èƒ½å¼•å‘ä»¤äººç–‘æƒ‘çš„é”™è¯¯ã€‚</p></blockquote><p> Executor æ¡†æ¶ ä¸‰å¤§éƒ¨åˆ†ç»„æˆ</p><ul><li><strong>ä»»åŠ¡(<code>Runnable</code>Â &#x2F;<code>Callable</code>)</strong></li><li><strong>ä»»åŠ¡çš„æ‰§è¡Œ(<code>Executor</code>)</strong></li><li><strong>å¼‚æ­¥è®¡ç®—çš„ç»“æœ(<code>Future</code>)</strong></li></ul><blockquote><p><strong>ä»»åŠ¡çš„æ‰§è¡Œ(<code>Executor</code>)</strong></p></blockquote><p>çœ‹è¿™ä¸ªå›¾ï¼Œäº†è§£ä¸€ä¸‹å¯¹åº”æ ¸å¿ƒç±»çš„å…³ç³»ï¼š</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231219213228.png" alt="image.png"></p><p>ä»»åŠ¡çš„æ‰§è¡Œ(<code>Executor</code>) åŒ…æ‹¬ä»»åŠ¡æ‰§è¡Œæœºåˆ¶çš„æ ¸å¿ƒæ¥å£ <code>Executor</code> ï¼Œä»¥åŠç»§æ‰¿è‡ª <code>Executor</code> æ¥å£çš„ <code>ExecutorService</code> æ¥å£ã€‚</p><p><code>ThreadPoolExecutor</code> å’Œ <code>ScheduledThreadPoolExecutor</code>** è¿™ä¸¤ä¸ªå…³é”®ç±»å®ç°äº† <code>ExecutorService</code> æ¥å£ã€‚</p><h3 id="3ã€ThreadPoolExecutor-ç±»ä½¿ç”¨-â˜…"><a href="#3ã€ThreadPoolExecutor-ç±»ä½¿ç”¨-â˜…" class="headerlink" title="3ã€ThreadPoolExecutor ç±»ä½¿ç”¨ â˜…"></a>3ã€ThreadPoolExecutor ç±»ä½¿ç”¨ â˜…</h3><p>çº¿ç¨‹æ± å®ç°ç±»Â <code>ThreadPoolExecutor</code>Â æ˜¯Â <code>Executor</code>Â æ¡†æ¶æœ€æ ¸å¿ƒçš„ç±»ã€‚</p><h4 id="æ„é€ æ–¹æ³•"><a href="#æ„é€ æ–¹æ³•" class="headerlink" title="æ„é€ æ–¹æ³•"></a>æ„é€ æ–¹æ³•</h4><p><code>ThreadPoolExecutor</code> ç±»ä¸­æä¾›çš„å››ä¸ªæ„é€ æ–¹æ³•ã€‚æˆ‘ä»¬æ¥çœ‹æœ€é•¿çš„é‚£ä¸ªï¼Œå…¶ä½™ä¸‰ä¸ªéƒ½æ˜¯åœ¨è¿™ä¸ªæ„é€ æ–¹æ³•çš„åŸºç¡€ä¸Šäº§ç”Ÿã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">/**</span><br><span class="hljs-comment">* ç”¨ç»™å®šçš„åˆå§‹å‚æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ThreadPoolExecutorã€‚</span><br><span class="hljs-comment">*/</span><br><span class="hljs-keyword">public</span> ThreadPoolExecutor(int corePoolSize,     <span class="hljs-comment">//çº¿ç¨‹æ± çš„æ ¸å¿ƒçº¿ç¨‹æ•°é‡</span><br>                          int maximumPoolSize,  <span class="hljs-comment">//çº¿ç¨‹æ± çš„æœ€å¤§çº¿ç¨‹æ•°</span><br>                          long keepAliveTime,   <span class="hljs-comment">//å½“çº¿ç¨‹æ•°å¤§äºæ ¸å¿ƒçº¿ç¨‹æ•°æ—¶ï¼Œå¤šä½™çš„ç©ºé—²çº¿ç¨‹å­˜æ´»çš„æœ€é•¿æ—¶é—´</span><br>                          TimeUnit unit,        <span class="hljs-comment">//æ—¶é—´å•ä½</span><br>                          BlockingQueue&lt;Runnable&gt; workQueue, <span class="hljs-comment">//ä»»åŠ¡é˜Ÿåˆ—ï¼Œç”¨æ¥å‚¨å­˜ç­‰å¾…æ‰§è¡Œä»»åŠ¡çš„é˜Ÿåˆ—</span><br>                          ThreadFactory threadFactory,       <span class="hljs-comment">//çº¿ç¨‹å·¥å‚ï¼Œç”¨æ¥åˆ›å»ºçº¿ç¨‹ï¼Œä¸€èˆ¬é»˜è®¤å³å¯</span><br>                          RejectedExecutionHandler handler  <span class="hljs-comment">//æ‹’ç»ç­–ç•¥ï¼Œå½“æäº¤çš„ä»»åŠ¡è¿‡å¤šè€Œä¸èƒ½åŠæ—¶å¤„ç†æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å®šåˆ¶ç­–ç•¥æ¥å¤„ç†ä»»åŠ¡</span><br>  )&#123;<br>    <span class="hljs-comment">// å‚æ•°æ£€æŸ¥ï¼šæ ¸å¿ƒçº¿ç¨‹æ•°ä¸èƒ½å°äº0ï¼Œæœ€å¤§çº¿ç¨‹æ•°ä¸èƒ½å°äºæˆ–ç­‰äº0ï¼Œæœ€å¤§çº¿ç¨‹æ•°ä¸èƒ½å°äºæ ¸å¿ƒçº¿ç¨‹æ•°ï¼ŒkeepAliveTimeä¸èƒ½å°äº0</span><br>    <span class="hljs-keyword">if</span> (corePoolSize &lt; <span class="hljs-number">0</span> ||<br>        maximumPoolSize &lt;= <span class="hljs-number">0</span> ||<br>        maximumPoolSize &lt; corePoolSize ||<br>        keepAliveTime &lt; <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">throw</span> new IllegalArgumentException();<br><br>    <span class="hljs-comment">// å‚æ•°æ£€æŸ¥ï¼šå·¥ä½œé˜Ÿåˆ—ã€çº¿ç¨‹å·¥å‚å’Œæ‹’ç»ç­–ç•¥ä¸èƒ½ä¸ºnull</span><br>    <span class="hljs-keyword">if</span> (workQueue == <span class="hljs-literal">null</span> || threadFactory == <span class="hljs-literal">null</span> || handler == <span class="hljs-literal">null</span>)<br>        <span class="hljs-keyword">throw</span> new NullPointerException();<br><br>    <span class="hljs-comment">// è·å–å®‰å…¨ç®¡ç†å™¨çš„ä¸Šä¸‹æ–‡ï¼Œè¿™æ˜¯Javaå®‰å…¨æ¨¡å‹çš„ä¸€éƒ¨åˆ†</span><br>    <span class="hljs-keyword">this</span>.acc = System.getSecurityManager() == <span class="hljs-literal">null</span> ?<br>            <span class="hljs-literal">null</span> :<br>            AccessController.getContext();<br><br>    <span class="hljs-comment">// è®¾ç½®çº¿ç¨‹æ± çš„æ ¸å¿ƒçº¿ç¨‹æ•°</span><br>    <span class="hljs-keyword">this</span>.corePoolSize = corePoolSize;<br><br>    <span class="hljs-comment">// è®¾ç½®çº¿ç¨‹æ± çš„æœ€å¤§çº¿ç¨‹æ•°</span><br>    <span class="hljs-keyword">this</span>.maximumPoolSize = maximumPoolSize;<br><br>    <span class="hljs-comment">// è®¾ç½®å·¥ä½œé˜Ÿåˆ—</span><br>    <span class="hljs-keyword">this</span>.workQueue = workQueue;<br><br>    <span class="hljs-comment">// è®¾ç½®çº¿ç¨‹ä¿æŒæ´»åŠ¨çš„æ—¶é—´ï¼Œå•ä½è½¬æ¢ä¸ºçº³ç§’</span><br>    <span class="hljs-keyword">this</span>.keepAliveTime = unit.toNanos(keepAliveTime);<br><br>    <span class="hljs-comment">// è®¾ç½®çº¿ç¨‹å·¥å‚ï¼Œç”¨äºåˆ›å»ºæ–°çº¿ç¨‹</span><br>    <span class="hljs-keyword">this</span>.threadFactory = threadFactory;<br><br>    <span class="hljs-comment">// è®¾ç½®æ‹’ç»ç­–ç•¥ï¼Œå½“çº¿ç¨‹æ± ä¸èƒ½æ¥å—ä»»åŠ¡æ—¶ä½¿ç”¨</span><br>    <span class="hljs-keyword">this</span>.handler = handler;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong><code>ThreadPoolExecutor</code> 3 ä¸ªæœ€é‡è¦çš„å‚æ•°ï¼š</strong></p><ul><li><strong><code>corePoolSize</code> :</strong> ä»»åŠ¡é˜Ÿåˆ—æœªè¾¾åˆ°é˜Ÿåˆ—å®¹é‡æ—¶ï¼Œæœ€å¤§å¯ä»¥åŒæ—¶è¿è¡Œçš„çº¿ç¨‹æ•°é‡ã€‚</li><li><strong><code>maximumPoolSize</code> :</strong> ä»»åŠ¡é˜Ÿåˆ—ä¸­å­˜æ”¾çš„ä»»åŠ¡è¾¾åˆ°é˜Ÿåˆ—å®¹é‡çš„æ—¶å€™ï¼Œå½“å‰å¯ä»¥åŒæ—¶è¿è¡Œçš„çº¿ç¨‹æ•°é‡å˜ä¸ºæœ€å¤§çº¿ç¨‹æ•°ã€‚</li><li><strong><code>workQueue</code>:</strong> æ–°ä»»åŠ¡æ¥çš„æ—¶å€™ä¼šå…ˆåˆ¤æ–­å½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°é‡æ˜¯å¦è¾¾åˆ°æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œå¦‚æœè¾¾åˆ°çš„è¯ï¼Œæ–°ä»»åŠ¡å°±ä¼šè¢«å­˜æ”¾åœ¨é˜Ÿåˆ—ä¸­ã€‚</li></ul><p><code>ThreadPoolExecutor</code>å…¶ä»–å¸¸è§å‚æ•° :</p><ul><li><strong><code>keepAliveTime</code></strong>:çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡å¤§äº <code>corePoolSize</code> çš„æ—¶å€™ï¼Œå¦‚æœè¿™æ—¶æ²¡æœ‰æ–°çš„ä»»åŠ¡æäº¤ï¼Œæ ¸å¿ƒçº¿ç¨‹å¤–çš„çº¿ç¨‹ä¸ä¼šç«‹å³é”€æ¯ï¼Œè€Œæ˜¯ä¼šç­‰å¾…ï¼Œç›´åˆ°ç­‰å¾…çš„æ—¶é—´è¶…è¿‡äº† <code>keepAliveTime</code>æ‰ä¼šè¢«å›æ”¶é”€æ¯ã€‚</li><li><strong><code>unit</code></strong> : <code>keepAliveTime</code> å‚æ•°çš„æ—¶é—´å•ä½ã€‚</li><li><strong><code>threadFactory</code></strong> :executor åˆ›å»ºæ–°çº¿ç¨‹çš„æ—¶å€™ä¼šç”¨åˆ°ã€‚</li><li><strong><code>handler</code></strong> :é¥±å’Œç­–ç•¥ã€‚</li></ul><h4 id="çº¿ç¨‹æ± åˆ›å»ºçš„ä¸¤ç§æ–¹å¼"><a href="#çº¿ç¨‹æ± åˆ›å»ºçš„ä¸¤ç§æ–¹å¼" class="headerlink" title="çº¿ç¨‹æ± åˆ›å»ºçš„ä¸¤ç§æ–¹å¼"></a>çº¿ç¨‹æ± åˆ›å»ºçš„ä¸¤ç§æ–¹å¼</h4><p><strong>æ–¹å¼ä¸€ï¼šé€šè¿‡<code>ThreadPoolExecutor</code>æ„é€ å‡½æ•°æ¥åˆ›å»ºï¼ˆæ¨èï¼‰</strong></p><p><strong>æ–¹å¼äºŒï¼šé€šè¿‡Â <code>Executor</code>Â æ¡†æ¶çš„å·¥å…·ç±»Â <code>Executors</code>Â æ¥åˆ›å»ºã€‚</strong></p><p>æˆ‘ä»¬å¯ä»¥åˆ›å»ºå¤šç§ç±»å‹çš„ <code>ThreadPoolExecutor</code>ï¼š</p><ul><li>**<code>FixedThreadPool</code>**ï¼šè¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªå›ºå®šçº¿ç¨‹æ•°é‡çš„çº¿ç¨‹æ± ã€‚è¯¥çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡å§‹ç»ˆä¸å˜ã€‚å½“æœ‰ä¸€ä¸ªæ–°çš„ä»»åŠ¡æäº¤æ—¶ï¼Œçº¿ç¨‹æ± ä¸­è‹¥æœ‰ç©ºé—²çº¿ç¨‹ï¼Œåˆ™ç«‹å³æ‰§è¡Œã€‚è‹¥æ²¡æœ‰ï¼Œåˆ™æ–°çš„ä»»åŠ¡ä¼šè¢«æš‚å­˜åœ¨ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œå¾…æœ‰çº¿ç¨‹ç©ºé—²æ—¶ï¼Œä¾¿å¤„ç†åœ¨ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚</li><li><strong><code>SingleThreadExecutor</code>ï¼š</strong> è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªåªæœ‰ä¸€ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ± ã€‚è‹¥å¤šä½™ä¸€ä¸ªä»»åŠ¡è¢«æäº¤åˆ°è¯¥çº¿ç¨‹æ± ï¼Œä»»åŠ¡ä¼šè¢«ä¿å­˜åœ¨ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œå¾…çº¿ç¨‹ç©ºé—²ï¼ŒæŒ‰å…ˆå…¥å…ˆå‡ºçš„é¡ºåºæ‰§è¡Œé˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚</li><li><strong><code>CachedThreadPool</code>ï¼š</strong> è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªå¯æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´çº¿ç¨‹æ•°é‡çš„çº¿ç¨‹æ± ã€‚çº¿ç¨‹æ± çš„çº¿ç¨‹æ•°é‡ä¸ç¡®å®šï¼Œä½†è‹¥æœ‰ç©ºé—²çº¿ç¨‹å¯ä»¥å¤ç”¨ï¼Œåˆ™ä¼šä¼˜å…ˆä½¿ç”¨å¯å¤ç”¨çš„çº¿ç¨‹ã€‚è‹¥æ‰€æœ‰çº¿ç¨‹å‡åœ¨å·¥ä½œï¼Œåˆæœ‰æ–°çš„ä»»åŠ¡æäº¤ï¼Œåˆ™ä¼šåˆ›å»ºæ–°çš„çº¿ç¨‹å¤„ç†ä»»åŠ¡ã€‚æ‰€æœ‰çº¿ç¨‹åœ¨å½“å‰ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œå°†è¿”å›çº¿ç¨‹æ± è¿›è¡Œå¤ç”¨ã€‚</li><li>**<code>ScheduledThreadPool</code>**ï¼šè¯¥è¿”å›ä¸€ä¸ªç”¨æ¥åœ¨ç»™å®šçš„å»¶è¿Ÿåè¿è¡Œä»»åŠ¡æˆ–è€…å®šæœŸæ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹æ± ã€‚</li></ul><blockquote><p>ä¸å»ºè®®ä½¿ç”¨ç¬¬äºŒç§ï¼ŒåŸå› å¦‚ä¸‹ï¼š</p></blockquote><p>ã€Šé˜¿é‡Œå·´å·´ Java å¼€å‘æ‰‹å†Œã€‹å¼ºåˆ¶çº¿ç¨‹æ± ä¸å…è®¸ä½¿ç”¨ <code>Executors</code> å»åˆ›å»ºï¼Œ</p><p>è€Œæ˜¯é€šè¿‡ <code>ThreadPoolExecutor</code> æ„é€ å‡½æ•°çš„æ–¹å¼ï¼Œè¿™æ ·çš„å¤„ç†æ–¹å¼è®©å†™çš„åŒå­¦æ›´åŠ æ˜ç¡®çº¿ç¨‹æ± çš„è¿è¡Œè§„åˆ™ï¼Œè§„é¿èµ„æºè€—å°½çš„é£é™©</p><p><code>Executors</code> è¿”å›çº¿ç¨‹æ± å¯¹è±¡çš„å¼Šç«¯å¦‚ä¸‹ï¼š</p><ul><li>**<code>FixedThreadPool</code> å’Œ <code>SingleThreadExecutor</code>**ï¼šä½¿ç”¨çš„æ˜¯æ— ç•Œçš„ <code>LinkedBlockingQueue</code>ï¼Œä»»åŠ¡é˜Ÿåˆ—æœ€å¤§é•¿åº¦ä¸º <code>Integer.MAX_VALUE</code>,å¯èƒ½å †ç§¯å¤§é‡çš„è¯·æ±‚ï¼Œä»è€Œå¯¼è‡´ OOMã€‚</li><li>**<code>CachedThreadPool</code>**ï¼šä½¿ç”¨çš„æ˜¯åŒæ­¥é˜Ÿåˆ— <code>SynchronousQueue</code>, å…è®¸åˆ›å»ºçš„çº¿ç¨‹æ•°é‡ä¸º <code>Integer.MAX_VALUE</code> ï¼Œå¯èƒ½ä¼šåˆ›å»ºå¤§é‡çº¿ç¨‹ï¼Œä»è€Œå¯¼è‡´ OOMã€‚</li><li><strong><code>ScheduledThreadPool</code> å’Œ <code>SingleThreadScheduledExecutor</code></strong> : ä½¿ç”¨çš„æ— ç•Œçš„å»¶è¿Ÿé˜»å¡é˜Ÿåˆ—<code>DelayedWorkQueue</code>ï¼Œä»»åŠ¡é˜Ÿåˆ—æœ€å¤§é•¿åº¦ä¸º <code>Integer.MAX_VALUE</code>,å¯èƒ½å †ç§¯å¤§é‡çš„è¯·æ±‚ï¼Œä»è€Œå¯¼è‡´ OOMã€‚</li></ul><h4 id="çº¿ç¨‹æ± å¸¸ç”¨é˜»å¡é˜Ÿåˆ—"><a href="#çº¿ç¨‹æ± å¸¸ç”¨é˜»å¡é˜Ÿåˆ—" class="headerlink" title="çº¿ç¨‹æ± å¸¸ç”¨é˜»å¡é˜Ÿåˆ—"></a>çº¿ç¨‹æ± å¸¸ç”¨é˜»å¡é˜Ÿåˆ—</h4><p>æ–°ä»»åŠ¡æ¥çš„æ—¶å€™ä¼šå…ˆåˆ¤æ–­å½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°é‡æ˜¯å¦è¾¾åˆ°æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œå¦‚æœè¾¾åˆ°çš„è¯ï¼Œæ–°ä»»åŠ¡å°±ä¼šè¢«å­˜æ”¾åœ¨é˜Ÿåˆ—ä¸­ã€‚</p><p>ä¸åŒçš„çº¿ç¨‹æ± ä¼šé€‰ç”¨ä¸åŒçš„é˜»å¡é˜Ÿåˆ—ï¼Œæˆ‘ä»¬å¯ä»¥ç»“åˆå†…ç½®çº¿ç¨‹æ± æ¥åˆ†æã€‚</p><ul><li>å®¹é‡ä¸º <code>Integer.MAX_VALUE</code> çš„ <code>LinkedBlockingQueue</code>ï¼ˆæ— ç•Œé˜Ÿåˆ—ï¼‰ï¼š<code>FixedThreadPool</code> å’Œ <code>SingleThreadExector</code> ã€‚<code>FixedThreadPool</code>æœ€å¤šåªèƒ½åˆ›å»ºæ ¸å¿ƒçº¿ç¨‹æ•°çš„çº¿ç¨‹ï¼ˆæ ¸å¿ƒçº¿ç¨‹æ•°å’Œæœ€å¤§çº¿ç¨‹æ•°ç›¸ç­‰ï¼‰ï¼Œ<code>SingleThreadExector</code>åªèƒ½åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼ˆæ ¸å¿ƒçº¿ç¨‹æ•°å’Œæœ€å¤§çº¿ç¨‹æ•°éƒ½æ˜¯ 1ï¼‰ï¼ŒäºŒè€…çš„ä»»åŠ¡é˜Ÿåˆ—æ°¸è¿œä¸ä¼šè¢«æ”¾æ»¡ã€‚</li><li><code>SynchronousQueue</code>ï¼ˆåŒæ­¥é˜Ÿåˆ—ï¼‰ï¼š<code>CachedThreadPool</code> ã€‚<code>SynchronousQueue</code> æ²¡æœ‰å®¹é‡ï¼Œä¸å­˜å‚¨å…ƒç´ ï¼Œç›®çš„æ˜¯ä¿è¯å¯¹äºæäº¤çš„ä»»åŠ¡ï¼Œå¦‚æœæœ‰ç©ºé—²çº¿ç¨‹ï¼Œåˆ™ä½¿ç”¨ç©ºé—²çº¿ç¨‹æ¥å¤„ç†ï¼›å¦åˆ™æ–°å»ºä¸€ä¸ªçº¿ç¨‹æ¥å¤„ç†ä»»åŠ¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>CachedThreadPool</code> çš„æœ€å¤§çº¿ç¨‹æ•°æ˜¯ <code>Integer.MAX_VALUE</code> ï¼Œå¯ä»¥ç†è§£ä¸ºçº¿ç¨‹æ•°æ˜¯å¯ä»¥æ— é™æ‰©å±•çš„ï¼Œå¯èƒ½ä¼šåˆ›å»ºå¤§é‡çº¿ç¨‹ï¼Œä»è€Œå¯¼è‡´ OOMã€‚</li><li><code>DelayedWorkQueue</code>ï¼ˆå»¶è¿Ÿé˜»å¡é˜Ÿåˆ—ï¼‰ï¼š<code>ScheduledThreadPool</code> å’Œ <code>SingleThreadScheduledExecutor</code> ã€‚<code>DelayedWorkQueue</code> çš„å†…éƒ¨å…ƒç´ å¹¶ä¸æ˜¯æŒ‰ç…§æ”¾å…¥çš„æ—¶é—´æ’åºï¼Œè€Œæ˜¯ä¼šæŒ‰ç…§å»¶è¿Ÿçš„æ—¶é—´é•¿çŸ­å¯¹ä»»åŠ¡è¿›è¡Œæ’åºï¼Œå†…éƒ¨é‡‡ç”¨çš„æ˜¯â€œå †â€çš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥ä¿è¯æ¯æ¬¡å‡ºé˜Ÿçš„ä»»åŠ¡éƒ½æ˜¯å½“å‰é˜Ÿåˆ—ä¸­æ‰§è¡Œæ—¶é—´æœ€é å‰çš„ã€‚<code>DelayedWorkQueue</code> æ·»åŠ å…ƒç´ æ»¡äº†ä¹‹åä¼šè‡ªåŠ¨æ‰©å®¹åŸæ¥å®¹é‡çš„ 1&#x2F;2ï¼Œå³æ°¸è¿œä¸ä¼šé˜»å¡ï¼Œæœ€å¤§æ‰©å®¹å¯è¾¾ <code>Integer.MAX_VALUE</code>ï¼Œæ‰€ä»¥æœ€å¤šåªèƒ½åˆ›å»ºæ ¸å¿ƒçº¿ç¨‹æ•°çš„çº¿ç¨‹ã€‚</li></ul><h3 id="4ã€çº¿ç¨‹æ± åŸç†åˆ†æ"><a href="#4ã€çº¿ç¨‹æ± åŸç†åˆ†æ" class="headerlink" title="4ã€çº¿ç¨‹æ± åŸç†åˆ†æ"></a>4ã€çº¿ç¨‹æ± åŸç†åˆ†æ</h3><p>to be continedâ€¦.</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://javaguide.cn/java/concurrent/java-thread-pool-summary.html">https://javaguide.cn/java/concurrent/java-thread-pool-summary.html</a></li><li><a href="https://www.bilibili.com/video/BV1eD4y1w7Rp">https://www.bilibili.com/video/BV1eD4y1w7Rp</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
      <category>Thread</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>thread</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringBootå­¦ä¹ _SpringBoot è‡ªåŠ¨è£…é…åŸç†</title>
    <link href="/2023/12/19/SpringBoot%E5%AD%A6%E4%B9%A0_SpringBoot%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D%E5%8E%9F%E7%90%86/"/>
    <url>/2023/12/19/SpringBoot%E5%AD%A6%E4%B9%A0_SpringBoot%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D%E5%8E%9F%E7%90%86/</url>
    
    <content type="html"><![CDATA[<blockquote><p>é¢è¯•é¢˜ï¼šè®²è¿°ä¸€ä¸‹Spring Boot çš„è‡ªåŠ¨è£…é…åŸç†ã€‚</p></blockquote><p>Spring Boot çš„è‡ªåŠ¨è£…é…åŸç†åŸºäº Spring æ¡†æ¶çš„ä¾èµ–æ³¨å…¥å’Œæ¡ä»¶æ³¨å†Œç‰¹æ€§ï¼Œé€šè¿‡ä¸€ç³»åˆ—çš„â€œå¯åŠ¨å™¨â€ï¼ˆstartersï¼‰å’Œè‡ªåŠ¨é…ç½®ï¼ˆauto-configurationï¼‰ç±»æ¥ç®€åŒ–é…ç½®è¿‡ç¨‹ã€‚</p><p>ä»¥ä¸‹æ˜¯å…³é”®ç‚¹ï¼š</p><ol><li><strong>å¯åŠ¨å™¨ï¼ˆStartersï¼‰</strong>:<ul><li>Spring Boot æä¾›äº†ä¸€ç³»åˆ—çš„å¯åŠ¨å™¨ï¼Œå®ƒä»¬æ˜¯é¢„å…ˆæ‰“åŒ…å¥½çš„ä¾èµ–é›†åˆï¼Œæ—¨åœ¨æä¾›ä¸åŒåŠŸèƒ½çš„å¿«é€Ÿé›†æˆï¼Œå¦‚ Web åº”ç”¨ã€æ•°æ®åº“è®¿é—®ç­‰ã€‚</li></ul></li><li><strong>@EnableAutoConfiguration</strong>:<ul><li>è¿™æ˜¯è‡ªåŠ¨è£…é…çš„æ ¸å¿ƒæ³¨è§£ã€‚é€šå¸¸ï¼Œè¿™ä¸ªæ³¨è§£æ˜¯é€šè¿‡ <code>@SpringBootApplication</code> æ‚æ³¨å¼•å…¥çš„ï¼Œå®ƒä¼šè§¦å‘ Spring Boot çš„è‡ªåŠ¨é…ç½®æœºåˆ¶ã€‚</li><li>å®ƒåˆ©ç”¨äº† Spring çš„ <code>ImportSelector</code> æ¥å£æ¥åŠ è½½ <code>META-INF/spring.factories</code> ä¸­æŒ‡å®šçš„é…ç½®ç±»ã€‚</li></ul></li><li><strong>æ¡ä»¶æ³¨è§£ï¼ˆConditional Annotationsï¼‰</strong>:<ul><li>è‡ªåŠ¨é…ç½®ç±»ä½¿ç”¨ä¸€ç³»åˆ—çš„æ¡ä»¶æ³¨è§£ï¼ˆå¦‚ <code>@ConditionalOnClass</code>ï¼Œ<code>@ConditionalOnBean</code>ï¼‰ï¼Œç¡®ä¿åªæœ‰åœ¨æ»¡è¶³ç‰¹å®šæ¡ä»¶æ—¶æ‰å¯ç”¨é…ç½®ã€‚è¿™äº›æ¡ä»¶é€šå¸¸åŒ…æ‹¬ç±»è·¯å¾„ä¸Šçš„ç±»å­˜åœ¨ã€æŸä¸ª Bean ä¸å­˜åœ¨ã€æŸä¸ªå±æ€§æœ‰ç‰¹å®šçš„å€¼ç­‰ã€‚</li></ul></li><li><strong>spring.factories</strong>:<ul><li>è¿™æ˜¯ä¸€ä¸ªä½äºæ¯ä¸ªè‡ªåŠ¨é…ç½®åº“ <code>META-INF</code> ç›®å½•ä¸‹çš„å±æ€§æ–‡ä»¶ã€‚å®ƒåˆ—å‡ºäº†æ‰€æœ‰å¯ç”¨çš„è‡ªåŠ¨é…ç½®ç±»ï¼Œè¿™äº›ç±»ç”± <code>AutoConfigurationImportSelector</code> è¯»å–å’Œå¤„ç†ã€‚</li></ul></li><li><strong>è‡ªåŠ¨é…ç½®ç±»ï¼ˆAutoConfiguration Classesï¼‰</strong>:<ul><li>è¿™äº›ç±»é€šå¸¸é‡‡ç”¨ <code>@Configuration</code> å½¢å¼ï¼Œå¹¶ä¸”å®ƒä»¬è‡ªèº«ä¹Ÿå¯ä»¥åŒ…å« <code>@Bean</code>ã€<code>@Component</code> å’Œå…¶ä»–é…ç½®ç›¸å…³çš„æ³¨è§£ã€‚</li><li>è‡ªåŠ¨é…ç½®ç±»å¯ä»¥æä¾›é»˜è®¤çš„ Bean å®šä¹‰ã€å±æ€§ç»‘å®šå’Œå…¶ä»–è‡ªåŠ¨åŒ–é…ç½®ã€‚</li></ul></li><li><strong>ç»†ç²’åº¦æ§åˆ¶</strong>:<ul><li>å¼€å‘è€…å¯ä»¥é€šè¿‡ <code>application.properties</code> æˆ– <code>application.yml</code> æ–‡ä»¶æ¥è¦†ç›–è‡ªåŠ¨é…ç½®çš„é»˜è®¤å€¼ã€‚</li><li>å¦‚æœéœ€è¦ï¼Œå¯ä»¥é€šè¿‡ <code>@EnableAutoConfiguration</code> çš„ <code>exclude</code> å±æ€§æ’é™¤ç‰¹å®šçš„è‡ªåŠ¨é…ç½®ç±»ã€‚</li></ul></li><li><strong>äº‹ä»¶ç›‘å¬ä¸å‘å¸ƒ</strong>:<ul><li>åœ¨è‡ªåŠ¨é…ç½®çš„è¿‡ç¨‹ä¸­ï¼ŒSpring Boot ä¹Ÿä¼šå‘å¸ƒå’Œç›‘å¬å„ç§äº‹ä»¶ï¼Œå…è®¸ç”¨æˆ·åœ¨åº”ç”¨ç”Ÿå‘½å‘¨æœŸçš„ä¸åŒé˜¶æ®µè¿›è¡Œäº¤äº’ã€‚</li></ul></li></ol><p>æ€»ç»“æ¥è¯´ï¼ŒSpring Boot çš„è‡ªåŠ¨è£…é…æ˜¯ä¸€ä¸ªæ™ºèƒ½ä¸”çµæ´»çš„æœºåˆ¶ï¼Œå®ƒå‡è½»äº†ä¼ ç»Ÿ Spring åº”ç”¨é…ç½®çš„è´Ÿæ‹…ï¼Œé€šè¿‡ä¸€ç³»åˆ—æ¡ä»¶åŒ¹é…å’Œçº¦å®šä¼˜äºé…ç½®çš„åŸåˆ™ï¼Œæä¾›äº†ä¸€ä¸ªå³æ’å³ç”¨çš„å¼€å‘ä½“éªŒã€‚</p><h3 id="1ã€ä»€ä¹ˆæ˜¯Spring-Boot-çš„è‡ªåŠ¨è£…é…"><a href="#1ã€ä»€ä¹ˆæ˜¯Spring-Boot-çš„è‡ªåŠ¨è£…é…" class="headerlink" title="1ã€ä»€ä¹ˆæ˜¯Spring Boot çš„è‡ªåŠ¨è£…é…"></a>1ã€ä»€ä¹ˆæ˜¯Spring Boot çš„è‡ªåŠ¨è£…é…</h3><p>å…ˆäº†è§£ä¸€ä¸‹è‡ªåŠ¨è£…é…ç±»ä¸»è¦ç”¨çš„æ³¨è§£å’Œè‡ªåŠ¨é…ç½®ç±»ï¼Œäº†è§£å…¶æ¦‚å¿µï¼Œå¹¶ç»§ç»­å¾€ä¸‹è¿›è¡Œå­¦ä¹ ã€‚</p><p>Spring Boot çš„è‡ªåŠ¨è£…é…åŸç†æ˜¯åŸºäº Spring æ¡†æ¶çš„ä¾èµ–æ³¨å…¥å’Œæ¡ä»¶è£…é…ç‰¹æ€§ã€‚</p><p>è‡ªåŠ¨è£…é…ä¸»è¦é€šè¿‡ <code>@EnableAutoConfiguration</code> æ³¨è§£å’Œä¸€ç³»åˆ—çš„è‡ªåŠ¨é…ç½®ç±» (<code>*AutoConfiguration</code> ç±») æ¥å®ç°ã€‚</p><p>ä»¥ä¸‹æ˜¯ä»æºç è§’åº¦å¯¹å…¶åŸç†çš„è§£æï¼š</p><blockquote><ol><li>@EnableAutoConfiguration</li></ol></blockquote><ul><li><code>@EnableAutoConfiguration</code> æ³¨è§£æ˜¯ Spring Boot è‡ªåŠ¨è£…é…çš„å…¥å£ã€‚å®ƒé€šå¸¸ä¸ <code>@SpringBootApplication</code> æ³¨è§£ä¸€èµ·ä½¿ç”¨ï¼Œåœ¨åº”ç”¨å¯åŠ¨æ—¶è¢«æ¿€æ´»ã€‚</li><li>è¯¥æ³¨è§£èƒŒåä½¿ç”¨äº† <code>@Import</code> æ³¨è§£æ¥å¯¼å…¥ <code>EnableAutoConfigurationImportSelector</code> ç±»ï¼Œè¿™æ˜¯å¯åŠ¨è‡ªåŠ¨è£…é…çš„å…³é”®ã€‚</li></ul><blockquote><ol start="2"><li>EnableAutoConfigurationImportSelector</li></ol></blockquote><ul><li><code>EnableAutoConfigurationImportSelector</code> å®ç°äº† <code>ImportSelector</code> æ¥å£ï¼Œè´Ÿè´£é€‰æ‹©éœ€è¦å¯¼å…¥çš„é…ç½®ç±»ã€‚</li><li>å®ƒè¯»å– <code>META-INF/spring.factories</code> æ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œè¿™ä¸ªæ–‡ä»¶åˆ—å‡ºäº†æ‰€æœ‰å¯ç”¨çš„è‡ªåŠ¨é…ç½®ç±»ã€‚</li><li>æ¯ä¸ªè‡ªåŠ¨é…ç½®ç±»éƒ½æ˜¯ä»¥æ¡ä»¶æ³¨è§£ï¼ˆå¦‚ <code>@ConditionalOnClass</code>ã€<code>@ConditionalOnBean</code>ï¼‰æ ‡æ³¨çš„ï¼Œè¿™äº›æ³¨è§£ç¡®ä¿åªæœ‰åœ¨ç‰¹å®šæ¡ä»¶æ»¡è¶³æ—¶ï¼Œç›¸å…³é…ç½®æ‰ä¼šè¢«åº”ç”¨ã€‚</li></ul><blockquote><ol start="3"><li>æ¡ä»¶æ³¨è§£</li></ol></blockquote><ul><li>æ¡ä»¶æ³¨è§£æ˜¯ Spring Framework çš„æ ¸å¿ƒç‰¹æ€§ä¹‹ä¸€ï¼ŒSpring Boot åœ¨æ­¤åŸºç¡€ä¸Šå®ç°äº†è‡ªåŠ¨è£…é…ã€‚</li><li><code>@Conditional</code> æ³¨è§£å®¶æ—ï¼ˆæ¯”å¦‚ <code>@ConditionalOnClass</code>ã€<code>@ConditionalOnMissingBean</code>ï¼‰å…è®¸åœ¨æ»¡è¶³ç‰¹å®šæ¡ä»¶æ—¶ï¼Œæ‰æ‰§è¡ŒæŸäº›æ“ä½œï¼ˆå¦‚å®ä¾‹åŒ– Beanï¼‰ã€‚</li><li>è¿™äº›æ³¨è§£ç¡®ä¿äº†åªæœ‰å½“ç›¸å…³çš„ç±»å­˜åœ¨äºç±»è·¯å¾„ä¸Šã€æˆ–è€…æŸä¸ª Bean å°šæœªå®šä¹‰æ—¶ï¼Œå¯¹åº”çš„è‡ªåŠ¨é…ç½®ç±»æ‰ä¼šè¢«æ¿€æ´»ã€‚</li></ul><blockquote><ol start="4"><li>è‡ªåŠ¨é…ç½®ç±» (<code>*AutoConfiguration</code>)</li></ol></blockquote><ul><li>è‡ªåŠ¨é…ç½®ç±»é€šå¸¸å‘½åä¸º <code>*AutoConfiguration</code>ï¼Œå®ƒä»¬åŒ…å«äº†ä¸€ç³»åˆ—çš„ Bean å®šä¹‰å’Œæ¡ä»¶é€»è¾‘ã€‚</li><li>è¿™äº›ç±»åˆ©ç”¨ Spring çš„ä¾èµ–æ³¨å…¥ç‰¹æ€§ï¼Œå®šä¹‰äº†å¦‚ä½•åˆ›å»ºå’Œé…ç½® Beanï¼Œä»è€Œç®€åŒ–äº†è®¸å¤šå¸¸è§åœºæ™¯çš„é…ç½®å·¥ä½œã€‚</li><li>ä¾‹å¦‚ï¼Œ<code>DataSourceAutoConfiguration</code> å¯ä»¥åœ¨ç±»è·¯å¾„ä¸Šæ£€æµ‹åˆ°æ•°æ®åº“è¿æ¥æ± å®ç°æ—¶è‡ªåŠ¨é…ç½®æ•°æ®æºï¼ˆDataSourceï¼‰ã€‚</li></ul><p>ç¤ºä¾‹ï¼šDataSourceAutoConfiguration</p><p>ä»¥ <code>DataSourceAutoConfiguration</code> ä¸ºä¾‹ï¼Œå±•ç¤ºè‡ªåŠ¨é…ç½®ç±»çš„å…¸å‹ç»“æ„ï¼š</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@Configuration</span><br><span class="hljs-variable">@ConditionalOnClass</span>(&#123;DataSource.class, EmbeddedDatabaseType.class&#125;)<br>public class DataSourceAutoConfiguration &#123;<br><br>    <span class="hljs-comment">// ...çœç•¥å…¶ä»–ä»£ç ...</span><br><br>    <span class="hljs-variable">@Configuration</span><br>    <span class="hljs-variable">@Conditional</span>(DataSourceAutoConfiguration.DataSourceAvailableCondition.class)<br>    public static class DataSourceConfiguration &#123;<br>        <span class="hljs-comment">// Bean å®šä¹‰å’Œé…ç½®</span><br>    &#125;<br><br>    <span class="hljs-comment">// ...çœç•¥å…¶ä»–ä»£ç ...</span><br><br>    static class DataSourceAvailableCondition extends SpringBootCondition &#123;<br>        <span class="hljs-comment">// æ¡ä»¶åˆ¤æ–­é€»è¾‘</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>å°ç»“</p></blockquote><p>Spring Boot çš„è‡ªåŠ¨è£…é…æ˜¯é€šè¿‡ä¸€ç³»åˆ—çš„è‡ªåŠ¨é…ç½®ç±»ä»¥åŠæ¡ä»¶æ³¨è§£å®ç°çš„ã€‚</p><p>è¿™äº›è‡ªåŠ¨é…ç½®ç±»ä½äºåº”ç”¨çš„ç±»è·¯å¾„ä¸Šï¼Œå¹¶åœ¨æ»¡è¶³ç‰¹å®šæ¡ä»¶æ—¶è¢« <code>@EnableAutoConfiguration</code> æ³¨è§£æ¿€æ´»ã€‚</p><p>è¿™ç§æœºåˆ¶æå¤§åœ°ç®€åŒ–äº† Spring åº”ç”¨çš„é…ç½®è¿‡ç¨‹ï¼Œå…è®¸å¼€å‘è€…ä»¥æœ€å°‘çš„åŠªåŠ›å®ç°å¼ºå¤§çš„åŠŸèƒ½ã€‚</p><h3 id="2ã€è§£è¯»-SpringBootApplication-æ³¨è§£"><a href="#2ã€è§£è¯»-SpringBootApplication-æ³¨è§£" class="headerlink" title="2ã€è§£è¯»@SpringBootApplication æ³¨è§£"></a>2ã€è§£è¯»@SpringBootApplication æ³¨è§£</h3><p>ä¸Šè¿°å†…å®¹ä¹Ÿè°ˆè®ºåˆ° æ¡ä»¶æ³¨è§£æ˜¯ Spring Framework çš„æ ¸å¿ƒç‰¹æ€§ä¹‹ä¸€ï¼ŒSpring Boot åœ¨å…¶åŸºç¡€ä¸Šï¼Œé€šè¿‡ SPI çš„æ–¹å¼ï¼Œåšäº†è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œå¹¶è¿›è€Œå®ç°äº†è‡ªåŠ¨è£…é…ã€‚</p><blockquote><p>æˆ‘ä»¬ä»å¯åŠ¨ç±»å¼€å§‹äº†è§£å…¶è‡ªåŠ¨è£…é…åŸç†</p></blockquote><p>æœ¬åœ°çš„ç‰ˆæœ¬æ˜¯ï¼šorg.springframework.boot:spring-boot-autoconfigure:2.2.5.RELEASE</p><h4 id="2-1-SpringBootApplication"><a href="#2-1-SpringBootApplication" class="headerlink" title="2.1  SpringBootApplication"></a>2.1  SpringBootApplication</h4><p>@SpringBootApplicationæ³¨è§£æ˜¯æ”¾ç½®åœ¨ Spring Boot åº”ç”¨çš„ä¸»ç±»ä¸Šï¼Œæ³¨è§£çš„ä½œç”¨æ˜¯å¯ç”¨ç»„ä»¶æ‰«æå’Œè‡ªåŠ¨é…ç½®ã€‚</p><p>æˆ‘ä»¬æ‰¾åˆ°ä¸€ä¸ªå¯åŠ¨ç±»ï¼Œè¿›å…¥å…¶æ³¨è§£ä»£ç ï¼Œ</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@Target</span>(ElementType.TYPE) <span class="hljs-comment">// æ³¨è§£ä½œç”¨äºç±»å‹ä¸Šï¼ˆæ¯”å¦‚ç±»ã€æ¥å£ï¼‰</span><br><span class="hljs-variable">@Retention</span>(RetentionPolicy.RUNTIME) <span class="hljs-comment">// æ³¨è§£åœ¨è¿è¡Œæ—¶æœ‰æ•ˆ</span><br><span class="hljs-variable">@Documented</span> <span class="hljs-comment">// å°†æ­¤æ³¨è§£åŒ…å«åœ¨ Javadoc ä¸­</span><br><span class="hljs-variable">@Inherited</span> <span class="hljs-comment">// æ³¨è§£å¯ä»¥è¢«ç»§æ‰¿</span><br><span class="hljs-variable">@SpringBootConfiguration</span> <span class="hljs-comment">// ç‰¹æ®Šçš„@Configurationï¼Œè¡¨æ˜è¿™æ˜¯ä¸€ä¸ª Spring Boot é…ç½®ç±»</span><br><span class="hljs-variable">@EnableAutoConfiguration</span> <span class="hljs-comment">// å¯ç”¨ Spring Boot çš„è‡ªåŠ¨é…ç½®æœºåˆ¶</span><br><span class="hljs-comment">//å¯ç”¨ç»„ä»¶æ‰«æï¼Œè®© Spring è‡ªåŠ¨å‘ç°å’Œæ³¨å†Œåº”ç”¨ä¸­çš„ Beansã€‚é€šå¸¸ï¼Œå®ƒä¼šæ‰«æä¸ä¸»ç±»ç›¸åŒçš„åŒ…ä»¥åŠå­åŒ…ä¸­çš„ç»„ä»¶ã€‚</span><br><span class="hljs-comment">//`excludeFilters` å±æ€§ç”¨äºæ’é™¤æŸäº›ç±»å‹çš„ç»„ä»¶ï¼Œè¿™é‡Œç‰¹åˆ«æ’é™¤äº† `TypeExcludeFilter` å’Œ `AutoConfigurationExcludeFilter` ç±»å‹çš„ç»„ä»¶</span><br><span class="hljs-variable">@ComponentScan</span>(<br>    excludeFilters = &#123;<br>        <span class="hljs-variable">@Filter</span>(<br>            type = FilterType.CUSTOM,<br>            classes = &#123;TypeExcludeFilter.class&#125;<br>        ),<br>        <span class="hljs-variable">@Filter</span>(<br>            type = FilterType.CUSTOM,<br>            classes = &#123;AutoConfigurationExcludeFilter.class&#125;<br>        )<br>    &#125;<br>) <br>public <span class="hljs-variable">@interface</span> SpringBootApplication &#123;<br>    <span class="hljs-comment">// ... å…¶ä»–å±æ€§å®šä¹‰ ...</span><br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2-2-EnableAutoConfiguration"><a href="#2-2-EnableAutoConfiguration" class="headerlink" title="2.2 EnableAutoConfiguration"></a>2.2 EnableAutoConfiguration</h4><blockquote><p>ä½œç”¨</p></blockquote><p><code>@EnableAutoConfiguration</code> æ˜¯ Spring Boot çš„æ ¸å¿ƒæ³¨è§£ä¹‹ä¸€ï¼Œç”¨äºå¯åŠ¨è‡ªåŠ¨é…ç½®çš„æœºåˆ¶ã€‚è¿™ä¸ªæ³¨è§£é€šè¿‡ <code>@Import</code> æ³¨è§£å¯¼å…¥ <code>AutoConfigurationImportSelector</code>ï¼Œåè€…è´Ÿè´£æ ¹æ®æ¡ä»¶é€‰æ‹©å’Œåº”ç”¨è‡ªåŠ¨é…ç½®ç±»ã€‚</p><blockquote><p>ä»£ç </p></blockquote><p><code>@EnableAutoConfiguration</code>Â æ˜¯å®ç°è‡ªåŠ¨è£…é…çš„é‡è¦æ³¨è§£ï¼Œæˆ‘ä»¬ä»¥è¿™ä¸ªæ³¨è§£ç»§ç»­å¾€ä¸‹çœ‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Target(ElementType.TYPE)</span> <span class="hljs-comment">// æŒ‡å®šæ³¨è§£å¯ä»¥åº”ç”¨äºç±»å‹çº§åˆ«ï¼ˆç±»ã€æ¥å£ç­‰ï¼‰</span><br><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span> <span class="hljs-comment">// æ³¨è§£åœ¨è¿è¡Œæ—¶æœ‰æ•ˆ</span><br><span class="hljs-meta">@Documented</span> <span class="hljs-comment">// æ³¨è§£å°†è¢«åŒ…å«åœ¨javadocä¸­</span><br><span class="hljs-meta">@Inherited</span> <span class="hljs-comment">// æ³¨è§£å¯ä»¥è¢«å­ç±»ç»§æ‰¿</span><br><span class="hljs-meta">@AutoConfigurationPackage</span> <span class="hljs-comment">// è‡ªåŠ¨é…ç½®åŒ…ï¼Œå°†ä¸»é…ç½®ç±»çš„åŒ…è§†ä¸ºè‡ªåŠ¨é…ç½®åŒ…</span><br><span class="hljs-meta">@Import(&#123;AutoConfigurationImportSelector.class&#125;)</span> <span class="hljs-comment">// å¯¼å…¥AutoConfigurationImportSelector</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> EnableAutoConfiguration &#123;<br>    <br>    <span class="hljs-comment">// ç”¨äºè¦†ç›–è‡ªåŠ¨é…ç½®æ˜¯å¦å¯ç”¨çš„å±æ€§</span><br>    <span class="hljs-type">String</span> <span class="hljs-variable">ENABLED_OVERRIDE_PROPERTY</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;spring.boot.enableautoconfiguration&quot;</span>;<br><br>    <span class="hljs-comment">// æ’é™¤ç‰¹å®šçš„è‡ªåŠ¨é…ç½®ç±»</span><br>    Class&lt;?&gt;[] exclude() <span class="hljs-keyword">default</span> &#123;&#125;;<br><br>    <span class="hljs-comment">// é€šè¿‡åç§°æ’é™¤ç‰¹å®šçš„è‡ªåŠ¨é…ç½®ç±»</span><br>    String[] excludeName() <span class="hljs-keyword">default</span> &#123;&#125;;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>ä½¿ç”¨ç¤ºä¾‹</p></blockquote><p>é€šå¸¸ï¼Œæˆ‘ä»¬æ˜¯ä¸ä¼šæ˜¾å¼åœ°ä½¿ç”¨ <code>@EnableAutoConfiguration</code>ï¼Œå®ƒå·²ç»åŒ…å«åœ¨ <code>@SpringBootApplication</code> æ³¨è§£ä¸­ã€‚</p><p>ä½†å¦‚æœéœ€è¦å•ç‹¬ä½¿ç”¨ï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ ·ï¼š</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@Configuration</span><br><span class="hljs-variable">@EnableAutoConfiguration</span>(exclude = &#123;DataSourceAutoConfiguration.class&#125;)<br>public class MyConfiguration &#123;<br>    <span class="hljs-comment">// é…ç½®å†…å®¹</span><br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢è¿™ä¸ªä¾‹å­ï¼Œ<code>@EnableAutoConfiguration</code> æ³¨è§£ç”¨äºå¯åŠ¨è‡ªåŠ¨é…ç½®ï¼Œä½†æ’é™¤äº†ç‰¹å®šçš„è‡ªåŠ¨é…ç½®ç±» <code>DataSourceAutoConfiguration</code>ã€‚</p><hr><h4 id="2-3-AutoConfigurationImportSelector"><a href="#2-3-AutoConfigurationImportSelector" class="headerlink" title="2.3 AutoConfigurationImportSelector"></a>2.3 AutoConfigurationImportSelector</h4><p><code>AutoConfigurationImportSelector</code> æ˜¯ Spring Boot è‡ªåŠ¨è£…é…æœºåˆ¶çš„å…³é”®ç»„æˆéƒ¨åˆ†ã€‚è¿™ä¸ªç±»å®ç°äº†å¤šä¸ª Spring æ¡†æ¶çš„æ¥å£ï¼Œä½¿å…¶èƒ½å¤Ÿåœ¨å¯åŠ¨æ—¶é€‰æ‹©å’Œæ³¨å†Œè‡ªåŠ¨é…ç½®ç±»ã€‚</p><p>å…ˆçœ‹ä¸€ä¸‹è¿™ä¸ªç±» <code>AutoConfigurationImportSelector</code>çš„ç»§æ‰¿ä½“ç³»ï¼š</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-symbol">AutoConfigurationImportSelector</span> <span class="hljs-symbol">implements</span> <span class="hljs-symbol">DeferredImportSelector, <span class="hljs-symbol">BeanClassLoaderAware</span>, <span class="hljs-symbol">ResourceLoaderAware</span>, <span class="hljs-symbol">BeanFactoryAware</span>, <span class="hljs-symbol">EnvironmentAware</span>, <span class="hljs-symbol">Ordered</span></span> &#123;<br><br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-symbol">DeferredImportSelector</span> <span class="hljs-symbol">extends</span> <span class="hljs-symbol">ImportSelector</span> &#123;<br><br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-symbol">ImportSelector</span> &#123;<br>    String[] selectImports(AnnotationMetadata var1);<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»ä¸Šé¢çš„ä¸¤å±‚ç»§æ‰¿å…³ç³»å¯ä»¥çœ‹å‡º <code>AutoConfigurationImportSelector</code> ç±»å®ç°äº† <code>ImportSelector</code>æ¥å£ï¼Œè¿™æ„å‘³ç€å®ƒå®ç°äº†è¿™ä¸ªæ¥å£ä¸­çš„ <code>selectImports</code>æ–¹æ³•ï¼Œ</p><p><code>selectImports</code> æ–¹æ³•æ˜¯ <code>AutoConfigurationImportSelector</code> ç±»çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œç”¨äºæ ¹æ®å½“å‰çš„åº”ç”¨ä¸Šä¸‹æ–‡ç¯å¢ƒé€‰æ‹©åˆé€‚çš„è‡ªåŠ¨é…ç½®ç±»ã€‚</p><p>ä»¥ä¸‹æ˜¯å¯¹è¿™ä¸ªæ–¹æ³•çš„ä»£ç æ³¨é‡Šè§£é‡Šï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">public</span> String[] selectImports(AnnotationMetadata annotationMetadata) &#123;<br>    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦å¯ç”¨è‡ªåŠ¨é…ç½®</span><br>    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isEnabled(annotationMetadata)) &#123;<br>        <span class="hljs-comment">// å¦‚æœè‡ªåŠ¨é…ç½®æ²¡æœ‰å¯ç”¨ï¼Œåˆ™ä¸å¯¼å…¥ä»»ä½•é…ç½®</span><br>        <span class="hljs-keyword">return</span> NO_IMPORTS;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// åŠ è½½è‡ªåŠ¨é…ç½®çš„å…ƒæ•°æ®</span><br>        AutoConfigurationMetadata autoConfigurationMetadata = AutoConfigurationMetadataLoader.loadMetadata(<span class="hljs-keyword">this</span>.beanClassLoader);<br><br>        <span class="hljs-comment">// è·å–è‡ªåŠ¨é…ç½®æ¡ç›®ï¼ˆå³è‡ªåŠ¨é…ç½®ç±»çš„åˆ—è¡¨ï¼‰</span><br>        AutoConfigurationImportSelector.AutoConfigurationEntry autoConfigurationEntry = <br>                <span class="hljs-keyword">this</span>.getAutoConfigurationEntry(autoConfigurationMetadata, annotationMetadata);<br><br>        <span class="hljs-comment">// å°†è‡ªåŠ¨é…ç½®ç±»è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ•°ç»„å¹¶è¿”å›</span><br>        <span class="hljs-comment">// è¿™äº›ç±»åå°†è¢« Spring å®¹å™¨è¿›ä¸€æ­¥å¤„ç†ï¼Œä»¥å®ç°è‡ªåŠ¨é…ç½®</span><br>        <span class="hljs-keyword">return</span> StringUtils.toStringArray(autoConfigurationEntry.getConfigurations());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>æ–¹æ³•è§£é‡Š</p></blockquote><ol><li><strong>isEnabled æ–¹æ³•</strong>:<ul><li>æ£€æŸ¥æ˜¯å¦å¯ç”¨äº†è‡ªåŠ¨é…ç½®ã€‚è¿™é€šå¸¸æ˜¯é€šè¿‡æ£€æŸ¥æŸä¸ªç‰¹å®šçš„å±æ€§æˆ–æ¡ä»¶æ¥å†³å®šçš„ã€‚å¦‚æœè‡ªåŠ¨é…ç½®è¢«ç¦ç”¨ï¼Œåˆ™æ­¤æ–¹æ³•è¿”å›ä¸€ä¸ªç©ºçš„æ•°ç»„ï¼Œæ„å‘³ç€ä¸è¿›è¡Œä»»ä½•è‡ªåŠ¨é…ç½®ã€‚</li></ul></li><li><strong>åŠ è½½è‡ªåŠ¨é…ç½®å…ƒæ•°æ®</strong>:<ul><li>ä½¿ç”¨ <code>AutoConfigurationMetadataLoader</code> åŠ è½½è‡ªåŠ¨é…ç½®çš„å…ƒæ•°æ®ã€‚è¿™äº›å…ƒæ•°æ®é€šå¸¸ä» <code>META-INF/spring.factories</code> æ–‡ä»¶ä¸­è¯»å–ï¼Œå…¶ä¸­åˆ—å‡ºäº†æ‰€æœ‰å¯ç”¨çš„è‡ªåŠ¨é…ç½®ç±»ã€‚</li></ul></li><li><strong>è·å–è‡ªåŠ¨é…ç½®æ¡ç›®</strong>:<ul><li><code>getAutoConfigurationEntry</code> æ–¹æ³•æ ¹æ®å½“å‰çš„åº”ç”¨ä¸Šä¸‹æ–‡ç¯å¢ƒå’Œå·²åŠ è½½çš„å…ƒæ•°æ®ç¡®å®šå“ªäº›è‡ªåŠ¨é…ç½®ç±»åº”è¯¥è¢«æ¿€æ´»ã€‚è¿™æ¶‰åŠåˆ°ä¸€ç³»åˆ—æ¡ä»¶åŒ¹é…ï¼Œä¾‹å¦‚æ£€æŸ¥ç±»è·¯å¾„ä¸Šæ˜¯å¦å­˜åœ¨ç‰¹å®šçš„ç±»ã€‚</li></ul></li><li><strong>è¿”å›è‡ªåŠ¨é…ç½®ç±»çš„åç§°</strong>:<ul><li>æœ€åï¼Œè¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªåŒ…å«åº”è¯¥æ¿€æ´»çš„è‡ªåŠ¨é…ç½®ç±»åç§°çš„å­—ç¬¦ä¸²æ•°ç»„ã€‚Spring å®¹å™¨éšåå°†ä½¿ç”¨è¿™äº›ç±»åæ¥å®ä¾‹åŒ–ç›¸åº”çš„ Bean å®šä¹‰ã€‚</li></ul></li></ol><h4 id="2-4-getAutoConfigurationEntry"><a href="#2-4-getAutoConfigurationEntry" class="headerlink" title="2.4 getAutoConfigurationEntry"></a>2.4 getAutoConfigurationEntry</h4><p>é‡ç‚¹å…³æ³¨ä¸€ä¸‹<code>getAutoConfigurationEntry()</code>æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•çš„ä¸»è¦èŒè´£æ˜¯æ”¶é›†æ‰€æœ‰åº”è¯¥è¢«æ¿€æ´»çš„è‡ªåŠ¨é…ç½®ç±»ï¼Œå¹¶æ ¹æ®ç»™å®šçš„æ¡ä»¶æ¥ç­›é€‰å’Œæ’é™¤æŸäº›é…ç½®ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">protected</span> AutoConfigurationImportSelector.AutoConfigurationEntry getAutoConfigurationEntry(<br>    AutoConfigurationMetadata autoConfigurationMetadata, AnnotationMetadata annotationMetadata) &#123;<br>    <br>    <span class="hljs-comment">// æ£€æŸ¥è‡ªåŠ¨é…ç½®æ˜¯å¦è¢«å¯ç”¨ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™è¿”å›ä¸€ä¸ªç©ºçš„é…ç½®æ¡ç›®</span><br>    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isEnabled(annotationMetadata)) &#123;<br>        <span class="hljs-keyword">return</span> EMPTY_ENTRY;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// è·å–æ³¨è§£çš„å±æ€§</span><br>        AnnotationAttributes attributes = <span class="hljs-keyword">this</span>.getAttributes(annotationMetadata);<br>        <br>        <span class="hljs-comment">// è·å–æ‰€æœ‰å€™é€‰çš„é…ç½®ç±»</span><br>        List&lt;String&gt; configurations = <span class="hljs-keyword">this</span>.getCandidateConfigurations(annotationMetadata, attributes);<br>        <br>        <span class="hljs-comment">// ç§»é™¤é‡å¤çš„é…ç½®</span><br>        configurations = <span class="hljs-keyword">this</span>.removeDuplicates(configurations);<br>        <br>        <span class="hljs-comment">// è·å–éœ€è¦æ’é™¤çš„é…ç½®ç±»</span><br>        Set&lt;String&gt; exclusions = <span class="hljs-keyword">this</span>.getExclusions(annotationMetadata, attributes);<br>        <br>        <span class="hljs-comment">// æ£€æŸ¥æ’é™¤çš„ç±»æ˜¯å¦çœŸçš„å­˜åœ¨äºå€™é€‰é…ç½®ä¸­ï¼Œå¹¶æŠ›å‡ºå¼‚å¸¸å¦‚æœæœ‰çš„è¯</span><br>        <span class="hljs-keyword">this</span>.checkExcludedClasses(configurations, exclusions);<br>        <br>        <span class="hljs-comment">// ä»å€™é€‰é…ç½®ä¸­ç§»é™¤æ’é™¤çš„é…ç½®</span><br>        configurations.removeAll(exclusions);<br>        <br>        <span class="hljs-comment">// è¿‡æ»¤é…ç½®ï¼Œå¯èƒ½ä½¿ç”¨æ¡ä»¶æœåŠ¡ç­‰è¿›ä¸€æ­¥ç­›é€‰é…ç½®</span><br>        configurations = <span class="hljs-keyword">this</span>.filter(configurations, autoConfigurationMetadata);<br>        <br>        <span class="hljs-comment">// è§¦å‘è‡ªåŠ¨é…ç½®å¯¼å…¥ç›¸å…³äº‹ä»¶</span><br>        <span class="hljs-keyword">this</span>.fireAutoConfigurationImportEvents(configurations, exclusions);<br>        <br>        <span class="hljs-comment">// è¿”å›ä¸€ä¸ªæ–°çš„ AutoConfigurationEntry å¯¹è±¡ï¼ŒåŒ…å«æœ€ç»ˆç¡®å®šçš„é…ç½®ç±»å’Œæ’é™¤çš„ç±»</span><br>        <span class="hljs-keyword">return</span> new AutoConfigurationImportSelector.AutoConfigurationEntry(configurations, exclusions);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ–¹æ³•è§£é‡Š</p><ol><li><strong>isEnabled</strong>:<ul><li>æ£€æŸ¥æ˜¯å¦åœ¨æ³¨è§£å…ƒæ•°æ®ä¸­è®¾ç½®äº†å¯ç”¨è‡ªåŠ¨é…ç½®çš„å±æ€§ã€‚</li></ul></li></ol><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">protected</span> boolean isEnabled(AnnotationMetadata metadata) &#123;  <br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getClass() == AutoConfigurationImportSelector.<span class="hljs-keyword">class</span> ? (<span class="hljs-built_in">Boolean</span>)<span class="hljs-keyword">this</span>.getEnvironment().getProperty(<span class="hljs-string">&quot;spring.boot.enableautoconfiguration&quot;</span>, <span class="hljs-built_in">Boolean</span>.<span class="hljs-keyword">class</span>, <span class="hljs-literal">true</span>) : <span class="hljs-literal">true</span>;  <br>&#125;<br></code></pre></td></tr></table></figure><p><code>isEnabled</code> æ–¹æ³•ä¼šåˆ¤æ–­è‡ªåŠ¨è£…é…å¼€å…³æ˜¯å¦æ‰“å¼€ã€‚</p><p>é»˜è®¤<code>spring.boot.enableautoconfiguration=true</code>ï¼Œå¯åœ¨ <code>application.properties</code> æˆ– <code>application.yml</code> ä¸­è®¾ç½®</p><ol start="2"><li><strong>getAttributes</strong>:<ul><li>æå–æ³¨è§£å…ƒæ•°æ®ä¸­çš„å±æ€§ï¼Œè¿™äº›å±æ€§å¯èƒ½ä¼šå½±å“è‡ªåŠ¨é…ç½®çš„é€‰æ‹©ã€‚</li><li>ç”¨äºè·å–<code>EnableAutoConfiguration</code>æ³¨è§£ä¸­çš„Â <code>exclude</code>Â å’ŒÂ <code>excludeName</code></li></ul></li><li><strong>getCandidateConfigurations</strong>:<ul><li>è·å–éœ€è¦è‡ªåŠ¨è£…é…çš„æ‰€æœ‰é…ç½®ç±»ï¼Œè¯»å–<code>META-INF/spring.factories</code></li></ul></li></ol><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stata">spring-<span class="hljs-keyword">boot</span>/spring-<span class="hljs-keyword">boot</span>-project/spring-<span class="hljs-keyword">boot</span>-autoconfigure/src/main/resources/<span class="hljs-keyword">META</span>-<span class="hljs-keyword">INF</span>/spring.factories<br></code></pre></td></tr></table></figure><p>ä¸å…‰æ˜¯å•ä¸ªä¾èµ–ä¸‹çš„<code>META-INF/spring.factories</code>è¢«è¯»å–åˆ°ï¼Œæ‰€æœ‰ Spring Boot Starter ä¸‹çš„<code>META-INF/spring.factories</code>éƒ½ä¼šè¢«è¯»å–åˆ°ã€‚</p><p>ä½ å¯ä»¥çœ‹ä¸€ä¸‹ druid æ•°æ®åº“è¿æ¥æ± çš„ Spring Boot Starter ï¼Œåœ¨å®ƒé‡Œé¢å°±åˆ›å»ºäº†<code>META-INF/spring.factories</code>æ–‡ä»¶ã€‚</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231219202949.png" alt="image.png"></p><p>å¦‚æœï¼Œæˆ‘ä»¬è‡ªå·±è¦åˆ›å»ºä¸€ä¸ª Spring Boot Starterï¼Œè¿™ä¸€æ­¥æ˜¯å¿…ä¸å¯å°‘çš„ã€‚</p><ol start="4"><li><strong>removeDuplicates</strong>:<ul><li>ä¿è¯é…ç½®åˆ—è¡¨ä¸­æ²¡æœ‰é‡å¤çš„æ¡ç›®ã€‚</li></ul></li><li><strong>getExclusions</strong>:<ul><li>è¯»å–æ³¨è§£å…ƒæ•°æ®ï¼Œæ‰¾å‡ºéœ€è¦ä»è‡ªåŠ¨é…ç½®ä¸­æ’é™¤çš„ç±»ã€‚</li></ul></li><li><strong>checkExcludedClasses</strong>:<ul><li>ç¡®ä¿æ’é™¤çš„ç±»æ˜¯å€™é€‰é…ç½®åˆ—è¡¨ä¸­çš„æˆå‘˜ï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</li></ul></li><li><strong>configurations.removeAll(exclusions)</strong>:<ul><li>å®é™…ä»å€™é€‰é…ç½®åˆ—è¡¨ä¸­ç§»é™¤è¢«æ’é™¤çš„ç±»ã€‚</li></ul></li><li><strong>filter</strong>:<ul><li>ä½¿ç”¨ <code>AutoConfigurationMetadata</code> å¯¹å€™é€‰é…ç½®è¿›è¡Œè¿›ä¸€æ­¥çš„æ¡ä»¶ç­›é€‰ã€‚</li></ul></li><li><strong>fireAutoConfigurationImportEvents</strong>:<ul><li>å‘å¸ƒäº‹ä»¶ï¼Œè¿™å¯èƒ½ä¼šå½±å“åç»­å¤„ç†è¿‡ç¨‹ï¼Œä¾‹å¦‚é€šè¿‡ç›‘å¬å™¨æ¥è¿›ä¸€æ­¥ä¿®æ”¹é…ç½®åˆ—è¡¨ã€‚</li></ul></li><li><strong>è¿”å› AutoConfigurationEntry</strong>:<ul><li>åˆ›å»ºå¹¶è¿”å›ä¸€ä¸ª <code>AutoConfigurationEntry</code> å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«äº†æœ€ç»ˆç¡®å®šè¦å¯¼å…¥çš„è‡ªåŠ¨é…ç½®ç±»å’Œå·²æ’é™¤çš„ç±»ã€‚</li></ul></li></ol><p>æˆ‘ä»¬åœ¨å…·ä½“ä½¿ç”¨çš„æ—¶å€™ï¼Œ<code>spring.factories</code>ä¸­ä¼šæœ‰å¾ˆå¤šé…ç½®ï¼Œä½†æ¯æ¬¡å¯åŠ¨å¹¶ä¸æ˜¯å…¨éƒ¨åŠ è½½ï¼›</p><p>æˆ‘ä»¬ä¼šåœ¨é…ç½®ç±»ä¸Šä½¿ç”¨ ConditionalOnxxx æ³¨è§£ï¼Œ<code>@ConditionalOnXXX</code>Â ä¸­çš„æ‰€æœ‰æ¡ä»¶éƒ½æ»¡è¶³ï¼Œè¯¥ç±»æ‰ä¼šç”Ÿæ•ˆã€‚</p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@Configuration</span><br><span class="hljs-comment">// æ£€æŸ¥ç›¸å…³çš„ç±»ï¼šRabbitTemplate å’Œ Channelæ˜¯å¦å­˜åœ¨</span><br><span class="hljs-comment">// å­˜åœ¨æ‰ä¼šåŠ è½½</span><br><span class="hljs-variable">@ConditionalOnClass</span>(&#123; RabbitTemplate.class, Channel.class &#125;)<br><span class="hljs-variable">@EnableConfigurationProperties</span>(RabbitProperties.class)<br><span class="hljs-variable">@Import</span>(RabbitAnnotationDrivenConfiguration.class)<br>public class RabbitAutoConfiguration &#123;<br>&#125;<br><br></code></pre></td></tr></table></figure><h3 id="3ã€æ–°å»ºä¸€ä¸ª-starter"><a href="#3ã€æ–°å»ºä¸€ä¸ª-starter" class="headerlink" title="3ã€æ–°å»ºä¸€ä¸ª starter"></a>3ã€æ–°å»ºä¸€ä¸ª starter</h3><p>åˆ›å»ºè¿‡ç¨‹ï¼š</p><blockquote><ol><li>åˆ›å»ºé¡¹ç›®ç»“æ„</li></ol></blockquote><p>éœ€è¦åˆ›å»ºä¸€ä¸ª Mavené¡¹ç›®ã€‚</p><p>ä¸ºäº†éµå¾ª Spring Boot Starter å‘½åçº¦å®šï¼Œé¡¹ç›®çš„åç§°é€šå¸¸ä»¥ <code>spring-boot-starter-</code> å¼€å¤´ï¼Œä¾‹å¦‚ <code>spring-boot-starter-myfeature</code>ã€‚</p><blockquote><ol start="2"><li>æ·»åŠ å¿…è¦çš„ä¾èµ–</li></ol></blockquote><p>åœ¨é¡¹ç›®çš„ <code>pom.xml</code> æ–‡ä»¶ä¸­ï¼Œæ·»åŠ  Spring Boot ä»¥åŠå…¶ä»–æ‰€éœ€åº“çš„ä¾èµ–ã€‚</p><p>ç¤ºä¾‹ Maven <code>pom.xml</code>:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- æ·»åŠ å…¶ä»–è‡ªå·± Starter éœ€è¦çš„ä¾èµ– --&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br></code></pre></td></tr></table></figure><blockquote><ol start="3"><li>åˆ›å»ºè‡ªåŠ¨é…ç½®ç±»</li></ol></blockquote><p>åœ¨é¡¹ç›®ä¸­åˆ›å»ºä¸€ä¸ªæˆ–å¤šä¸ªé…ç½®ç±»ï¼Œä½¿ç”¨ <code>@Configuration</code> æ³¨è§£ï¼Œå¹¶æ ¹æ®éœ€è¦ä½¿ç”¨ <code>@Conditional</code> æ³¨è§£æ¥æ¡ä»¶åŒ–é…ç½®ã€‚</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@Configuration</span><br><span class="hljs-variable">@ConditionalOnClass</span>(MyFeature.class)<br><span class="hljs-variable">@ConditionalOnProperty</span>(prefix = <span class="hljs-string">&quot;myfeature&quot;</span>, name = <span class="hljs-string">&quot;enabled&quot;</span>, havingValue = <span class="hljs-string">&quot;true&quot;</span>, matchIfMissing = true)<br>public class MyFeatureAutoConfiguration &#123;<br><br>    <span class="hljs-variable">@Bean</span><br>    <span class="hljs-variable">@ConditionalOnMissingBean</span><br>    public MyFeature <span class="hljs-built_in">myFeature</span>() &#123;<br>        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">new</span> <span class="hljs-selector-tag">MyFeature</span>();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><ol start="4"><li>åˆ›å»º <code>spring.factories</code> æ–‡ä»¶</li></ol></blockquote><p>åœ¨é¡¹ç›®çš„èµ„æºç›®å½•ä¸­åˆ›å»ºä¸€ä¸ª <code>META-INF/spring.factories</code> æ–‡ä»¶ï¼Œå¹¶æŒ‡å®šè‡ªåŠ¨é…ç½®ç±»ã€‚</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.boot</span><span class="hljs-selector-class">.autoconfigure</span>.EnableAutoConfiguration=\<br>com<span class="hljs-selector-class">.example</span>.MyFeatureAutoConfiguration<br></code></pre></td></tr></table></figure><blockquote><ol start="5"><li>é…ç½®å±æ€§ç±»ï¼ˆå¯é€‰ï¼‰</li></ol></blockquote><p>å¦‚æœä½ çš„ Starter éœ€è¦é…ç½®å±æ€§ï¼Œåˆ›å»ºä¸€ä¸ªå±æ€§ç±»ä½¿ç”¨ <code>@ConfigurationProperties</code> æ³¨è§£ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-meta">@ConfigurationProperties(prefix = <span class="hljs-string">&quot;myfeature&quot;</span>)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyFeatureProperties</span> &#123;<br>    <span class="hljs-keyword">private</span> boolean enabled = <span class="hljs-literal">true</span>;<br>    <span class="hljs-comment">// ... å…¶ä»–å±æ€§å’Œgetter/setter</span><br>&#125;<br></code></pre></td></tr></table></figure><blockquote><ol start="6"><li>æµ‹è¯• Starter</li></ol></blockquote><p>åˆ›å»ºä¸€ä¸ªç®€å•çš„ Spring Boot åº”ç”¨æ¥éªŒè¯ Starter æ˜¯å¦æŒ‰é¢„æœŸå·¥ä½œã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyStarterTestApp</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"><span class="hljs-built_in">String</span>[] args</span>) &#123;<br>        <span class="hljs-title class_">SpringApplication</span>.<span class="hljs-title function_">run</span>(<span class="hljs-title class_">MyStarterTestApp</span>.<span class="hljs-property">class</span>, args);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><ol start="7"><li>æ‰“åŒ…å’Œå‘å¸ƒ</li></ol></blockquote><p>ä½¿ç”¨ Maven å°† Starter æ‰“åŒ…ï¼Œå¹¶å‘å¸ƒåˆ° Maven ä¸­å¤®ä»“åº“æˆ–ç§æœ‰ä»“åº“ï¼Œä½¿å¾—å…¶ä»–é¡¹ç›®å¯ä»¥æ·»åŠ ä¾èµ–ä½¿ç”¨ã€‚</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-string">`mvn clean install`</span><br></code></pre></td></tr></table></figure><p>åŒæ—¶æœ€å¥½ç¼–å†™æ¸…æ™°çš„æ–‡æ¡£ï¼Œè¯´æ˜å¦‚ä½•æ·»åŠ  Starter çš„ä¾èµ–ï¼Œä»¥åŠå¦‚ä½•é…ç½®å’Œä½¿ç”¨æä¾›çš„åŠŸèƒ½ã€‚</p><blockquote><p>æ€»ç»“</p></blockquote><p>Spring Boot é€šè¿‡<code>@EnableAutoConfiguration</code>å¼€å¯è‡ªåŠ¨è£…é…ï¼Œ</p><p>é€šè¿‡ SpringFactoriesLoader æœ€ç»ˆåŠ è½½<code>META-INF/spring.factories</code>ä¸­çš„è‡ªåŠ¨é…ç½®ç±»å®ç°è‡ªåŠ¨è£…é…ï¼Œ</p><p>è‡ªåŠ¨é…ç½®ç±»å…¶å®å°±æ˜¯é€šè¿‡<code>@Conditional</code>æŒ‰éœ€åŠ è½½çš„é…ç½®ç±»ï¼Œæƒ³è¦å…¶ç”Ÿæ•ˆå¿…é¡»å¼•å…¥<code>spring-boot-starter-xxx</code>åŒ…å®ç°èµ·æ­¥ä¾èµ–</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://javaguide.cn/system-design/framework/spring/spring-boot-auto-assembly-principles.html">https://javaguide.cn/system-design/framework/spring/spring-boot-auto-assembly-principles.html</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>æ¡†æ¶</category>
      
      <category>SpringBoot</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>springboot</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Springå­¦ä¹ _Spring_Beançš„ç”Ÿå‘½å‘¨æœŸ</title>
    <link href="/2023/12/18/Spring%E5%AD%A6%E4%B9%A0_Spring_Bean%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/"/>
    <url>/2023/12/18/Spring%E5%AD%A6%E4%B9%A0_Spring_Bean%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/</url>
    
    <content type="html"><![CDATA[<p>æœ¬ç¯‡è®²è¿°ä¸€ä¸‹å…³äºBeançš„ç”Ÿå‘½å‘¨æœŸã€‚</p><p>beançš„ä½œç”¨åŸŸæœ‰å¾ˆå¤šç§ï¼Œè¿™é‡Œè®¨è®ºä¸€ä¸‹å®Œå…¨è¢« IOCå®¹å™¨æ§åˆ¶çš„å•ä¾‹ Beanã€‚</p><h3 id="1ã€Spring-Bean-ç”Ÿå‘½å‘¨æœŸçš„å››ä¸ªé˜¶æ®µ"><a href="#1ã€Spring-Bean-ç”Ÿå‘½å‘¨æœŸçš„å››ä¸ªé˜¶æ®µ" class="headerlink" title="1ã€Spring Bean ç”Ÿå‘½å‘¨æœŸçš„å››ä¸ªé˜¶æ®µ"></a>1ã€Spring Bean ç”Ÿå‘½å‘¨æœŸçš„å››ä¸ªé˜¶æ®µ</h3><blockquote><p>æ™®é€šçš„ Java å¯¹è±¡</p></blockquote><p>å¯¹äºæ™®é€šçš„ Java å¯¹è±¡æ¥è¯´ï¼Œå®ƒä»¬çš„ç”Ÿå‘½å‘¨æœŸæ˜¯ï¼š</p><ul><li>å®ä¾‹åŒ–</li><li>è¯¥å¯¹è±¡ä¸å†è¢«ä½¿ç”¨æ—¶é€šè¿‡åƒåœ¾å›æ”¶æœºåˆ¶è¿›è¡Œå›æ”¶</li></ul><blockquote><p>Spring Bean</p></blockquote><p>è€Œå¯¹äº Spring Bean çš„ç”Ÿå‘½å‘¨æœŸæ¥è¯´ï¼Œå¯ä»¥åˆ†ä¸ºå››ä¸ªé˜¶æ®µï¼š</p><ul><li>å®ä¾‹åŒ– Instantiation</li><li>å±æ€§èµ‹å€¼ Populate</li><li>åˆå§‹åŒ– Initialization</li><li>é”€æ¯ Destruction</li></ul><p>å…¶ä¸­åˆå§‹åŒ–å®Œæˆä¹‹åï¼Œå°±ä»£è¡¨è¿™ä¸ª Bean å¯ä»¥ä½¿ç”¨äº†</p><p>ä¸Šè¿°å››ä¸ªé˜¶æ®µçš„å¤§æ¦‚çš„ä¸€ä¸ªé€»è¾‘</p><p>å‰é¢ä¸‰ä¸ªé˜¶æ®µçš„æ“ä½œï¼ˆå…ˆå¤§æ¦‚äº†è§£æœ‰è¿™ä¸ªå°è±¡ï¼Œå…·ä½“å†…å®¹ç»§ç»­å¾€ä¸‹é¢çœ‹ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">protected</span> Object <span class="hljs-title function_">doCreateBean</span><span class="hljs-params">(String beanName, RootBeanDefinition mbd, <span class="hljs-meta">@Nullable</span> Object[] args)</span> <span class="hljs-keyword">throws</span> BeanCreationException &#123;<br>    <span class="hljs-type">BeanWrapper</span> <span class="hljs-variable">instanceWrapper</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">if</span> (mbd.isSingleton()) &#123;<br>        instanceWrapper = (BeanWrapper)<span class="hljs-built_in">this</span>.factoryBeanInstanceCache.remove(beanName);<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (instanceWrapper == <span class="hljs-literal">null</span>) &#123;<br>    <span class="hljs-comment">// å®ä¾‹åŒ–é˜¶æ®µ</span><br>        instanceWrapper = <span class="hljs-built_in">this</span>.createBeanInstance(beanName, mbd, args);<br>    &#125;<br><br>    ...<br><br>    <span class="hljs-type">Object</span> <span class="hljs-variable">exposedObject</span> <span class="hljs-operator">=</span> bean;<br><br>    <span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-comment">// å±æ€§èµ‹å€¼é˜¶æ®µ</span><br>        <span class="hljs-built_in">this</span>.populateBean(beanName, mbd, instanceWrapper);<br>        <span class="hljs-comment">// åˆå§‹åŒ–é˜¶æ®µ</span><br>        exposedObject = <span class="hljs-built_in">this</span>.initializeBean(beanName, exposedObject, mbd);<br>    &#125; <span class="hljs-keyword">catch</span> (Throwable var18) &#123;<br>        ...<br>    &#125;<br><br>    ...<br>&#125;<br></code></pre></td></tr></table></figure><p>é”€æ¯æ“ä½œï¼Œæ˜¯åœ¨å®¹å™¨å…³é—­æ—¶è°ƒç”¨çš„ï¼Œè¯¦è§Â <code>ConfigurableApplicationContext#close()</code></p><h3 id="2ã€Spring-Bean-çš„ç”Ÿå‘½å‘¨æœŸçš„æ‰©å±•ç‚¹"><a href="#2ã€Spring-Bean-çš„ç”Ÿå‘½å‘¨æœŸçš„æ‰©å±•ç‚¹" class="headerlink" title="2ã€Spring Bean çš„ç”Ÿå‘½å‘¨æœŸçš„æ‰©å±•ç‚¹"></a>2ã€Spring Bean çš„ç”Ÿå‘½å‘¨æœŸçš„æ‰©å±•ç‚¹</h3><p>ä¸Šé¢è®²è¿°åˆ°Beançš„ç”Ÿå‘½å‘¨æœŸæœ‰å››ä¸ªé˜¶æ®µï¼Œåˆ†åˆ«æ˜¯ï¼šå®ä¾‹åŒ–  â†’  å±æ€§èµ‹å€¼  â†’  åˆå§‹åŒ–  â†’  é”€æ¯ï¼›</p><p>åœ¨ä¸åŒé˜¶æ®µä¸­é—´ï¼ŒSpring æ¡†æ¶ä¼šè¿›è¡Œä¸€äº›åŠŸèƒ½çš„æ‰©å±•ç‚¹ï¼Œä¸‹é¢åˆ†å››ä¸ªéƒ¨åˆ†åˆ†åˆ«è®²è§£è¿™äº›æ‰©å±•ç‚¹ã€‚</p><ul><li>Bean è‡ªèº«æ–¹æ³•</li><li>å®¹å™¨çº§åˆ«æ–¹æ³•</li><li>å·¥å‚åå¤„ç†å™¨æ–¹æ³•</li><li>Bean çº§ç”Ÿå‘½å‘¨æœŸæ–¹æ³•</li></ul><h4 id="2-1-Bean-è‡ªèº«çš„æ–¹æ³•"><a href="#2-1-Bean-è‡ªèº«çš„æ–¹æ³•" class="headerlink" title="2.1  Bean è‡ªèº«çš„æ–¹æ³•"></a>2.1  Bean è‡ªèº«çš„æ–¹æ³•</h4><p>åœ¨Beançš„ç”Ÿå‘½å‘¨æœŸä¸­ï¼ŒBeanè‡ªèº«æ˜¯æœ‰ä¸€äº›ç‰¹å®šæ–¹æ³•æ˜¯èƒ½å¤Ÿè¢«è°ƒç”¨çš„ï¼Œä»¥ä¾¿å®Œæˆå…¶ç”Ÿå‘½å‘¨æœŸè¿‡ç¨‹ã€‚</p><p>æ¯”å¦‚æ„é€ å‡½æ•°ã€getter&#x2F;setter ä»¥åŠ init-method å’Œ destory-method æ‰€æŒ‡å®šçš„æ–¹æ³•ç­‰ï¼Œè€Œè¿™äº›æ–¹æ³•åˆåˆ†åˆ«å¯¹åº”ç€ä¸Šæ–‡è¯´çš„å››ä¸ªé˜¶æ®µï¼šä¾‹åŒ–ã€å±æ€§èµ‹å€¼ã€åˆå§‹åŒ–å’Œé”€æ¯ã€‚</p><p>è¿™äº›Beanè‡ªèº«çš„æ–¹æ³•ä¸€èˆ¬æ˜¯æˆ‘ä»¬åœ¨é…ç½®Beançš„æ—¶å€™å°±å·²ç»å®šä¹‰å¥½çš„ï¼Œä¸‹é¢æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å• Bean çš„ä½¿ç”¨æ¥çœ‹ä¸€ä¸‹å…¶ç”¨æ³•ã€‚</p><blockquote><p>Bean ç¤ºä¾‹</p></blockquote><p>æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªç®€å•çš„ Beanï¼Œåä¸º <code>MyBean</code>ï¼Œ</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MyBean</span> &#123;<br><br>    <span class="hljs-keyword">private</span> String <span class="hljs-keyword">value</span>;<br><br>    <span class="hljs-comment">// æ„é€ å‡½æ•° - å®ä¾‹åŒ–é˜¶æ®µ</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MyBean</span>()</span> &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;MyBean Constructor: Bean is being instantiated.&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-comment">// Setter æ–¹æ³• - å±æ€§èµ‹å€¼é˜¶æ®µ</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setValue</span>(<span class="hljs-params">String <span class="hljs-keyword">value</span></span>)</span> &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;MyBean setValue: Setting property value.&quot;</span>);<br>        <span class="hljs-keyword">this</span>.<span class="hljs-keyword">value</span> = <span class="hljs-keyword">value</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// åˆå§‹åŒ–æ–¹æ³• - åˆå§‹åŒ–é˜¶æ®µ</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span>()</span> &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;MyBean init: Bean is being initialized.&quot;</span>);<br>        <span class="hljs-comment">// æ‰§è¡Œåˆå§‹åŒ–é€»è¾‘</span><br>    &#125;<br><br>    <span class="hljs-comment">// é”€æ¯æ–¹æ³• - é”€æ¯é˜¶æ®µ</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">destroy</span>()</span> &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;MyBean destroy: Bean is being destroyed.&quot;</span>);<br>        <span class="hljs-comment">// æ‰§è¡Œæ¸…ç†é€»è¾‘</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬é€šè¿‡æ³¨è§£æˆ–è€…xml é…ç½®å£°æ˜  init-method å’Œ destory-method  å¯¹åº”çš„æ–¹æ³•ã€‚</p><blockquote><p>xml é…ç½®</p></blockquote><p><strong>åœ¨ Spring é…ç½®ä¸­å®šä¹‰ Bean</strong></p><p>åœ¨ Spring çš„ XML é…ç½®æ–‡ä»¶ä¸­ï¼Œå¦‚ä¸‹é…ç½®è¿™ä¸ª Beanï¼Œå¹¶æŒ‡å®š <code>init-method</code> å’Œ <code>destroy-method</code>ï¼š</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs abnf">&lt;bean id<span class="hljs-operator">=</span><span class="hljs-string">&quot;myBean&quot;</span> class<span class="hljs-operator">=</span><span class="hljs-string">&quot;com.example.MyBean&quot;</span> init-method<span class="hljs-operator">=</span><span class="hljs-string">&quot;init&quot;</span> destroy-method<span class="hljs-operator">=</span><span class="hljs-string">&quot;destroy&quot;</span>&gt;<br>    &lt;property name<span class="hljs-operator">=</span><span class="hljs-string">&quot;value&quot;</span> value<span class="hljs-operator">=</span><span class="hljs-string">&quot;Some value&quot;</span>/&gt;<br>&lt;/bean&gt;<br></code></pre></td></tr></table></figure><blockquote><p>æ³¨è§£é…ç½®</p></blockquote><p>åœ¨åŸºäº Java çš„é…ç½®ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ <code>@Bean</code> æ³¨è§£ï¼š</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs haxe"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-title class_"><span class="hljs-keyword">class</span> <span class="hljs-title">AppConfig</span> </span>&#123;<br><br>    <span class="hljs-meta">@Bean</span>(initMethod = <span class="hljs-string">&quot;init&quot;</span>, destroyMethod = <span class="hljs-string">&quot;destroy&quot;</span>)<br>    <span class="hljs-keyword">public</span> MyBean myBean() &#123;<br>        MyBean myBean = <span class="hljs-keyword">new</span> <span class="hljs-type">MyBean</span>();<br>        myBean.setValue(<span class="hljs-string">&quot;Some value&quot;</span>);<br>        <span class="hljs-keyword">return</span> myBean;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>ä½¿ç”¨ Bean</p></blockquote><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs arduino"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">static</span> <span class="hljs-type">void</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">String</span>[] args)</span> </span>&#123;<br>        ApplicationContext context = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ClassPathXmlApplicationContext</span>(<span class="hljs-string">&quot;appContext.xml&quot;</span>);<br>        SimpleBean simpleBean = context.<span class="hljs-built_in">getBean</span>(<span class="hljs-string">&quot;myBean&quot;</span>, MyBean.<span class="hljs-keyword">class</span>);<br>        <span class="hljs-comment">// ä½¿ç”¨ simpleBean ...</span><br>        ((ClassPathXmlApplicationContext) context).<span class="hljs-built_in">close</span>(); <span class="hljs-comment">// å…³é—­ä¸Šä¸‹æ–‡ä»¥è§¦å‘é”€æ¯æ–¹æ³•</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>å››ä¸ªä¸»è¦é˜¶æ®µä»¥åŠä»£ç è§£é‡Š</p></blockquote><p>é€šè¿‡æ³¨è§£æˆ–è€…xmlé…ç½®çš„æ–¹å¼ï¼Œæˆ‘ä»¬æŒ‡å®šäº†åˆå§‹åŒ–å’Œé”€æ¯æ–¹æ³•ï¼Œå¹¶åœ¨ <code>MyBean</code> å®šä¹‰äº† Setter æ–¹æ³•ï¼Œå…·ä½“åœ¨å®¹å™¨æ‰§è¡Œçš„æ—¶å€™ï¼Œä¼šè¿›è¡Œä»¥ä¸‹çš„æ“ä½œï¼š</p><ol><li><strong>å®ä¾‹åŒ–é˜¶æ®µ</strong>:<ul><li>å½“ Spring å®¹å™¨åˆ›å»º <code>MyBean</code> çš„å®ä¾‹æ—¶ï¼Œé¦–å…ˆè°ƒç”¨å…¶æ„é€ å‡½æ•°ã€‚</li></ul></li><li><strong>å±æ€§èµ‹å€¼é˜¶æ®µ</strong>:<ul><li>æ¥ç€ï¼ŒSpring å®¹å™¨é€šè¿‡è°ƒç”¨ <code>setValue</code> æ–¹æ³•æ¥æ³¨å…¥å±æ€§å€¼ã€‚</li></ul></li><li><strong>åˆå§‹åŒ–é˜¶æ®µ</strong>:<ul><li>åœ¨æ‰€æœ‰å±æ€§éƒ½è®¾ç½®ä¹‹åï¼ŒSpring å®¹å™¨è°ƒç”¨æŒ‡å®šçš„ <code>init</code> æ–¹æ³•ã€‚</li></ul></li><li><strong>é”€æ¯é˜¶æ®µ</strong>:<ul><li>å½“ Spring å®¹å™¨å…³é—­æ—¶ï¼Œå®ƒä¼šè°ƒç”¨ <code>destroy</code> æ–¹æ³•ã€‚</li></ul></li></ol><h4 id="2-2-å®¹å™¨çº§åˆ«æ–¹æ³•"><a href="#2-2-å®¹å™¨çº§åˆ«æ–¹æ³•" class="headerlink" title="2.2  å®¹å™¨çº§åˆ«æ–¹æ³•"></a>2.2  å®¹å™¨çº§åˆ«æ–¹æ³•</h4><p>å°†è¿™ä¸ªå®¹å™¨çº§åˆ«æ–¹æ³•ç†è§£ä¸ºé˜¶æ®µä¸­é—´å®¹å™¨ä¼šè¿›è¡Œçš„ä¸€äº›æ“ä½œï¼Œè¿™äº›æ–¹æ³•ä¸€èˆ¬æ˜¯ BeanPostProcessor çš„ä¸€ç³»åˆ—æ¥å£ã€‚</p><p>åœ¨ä¸Šè¿°è®²åˆ°çš„Bean å››ä¸ªé˜¶æ®µï¼Œåœ¨è¿™å››ä¸ªé˜¶æ®µçš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œè¿›è¡Œä¸€äº›å‰ç½®æˆ–è€…åç½®çš„æ“ä½œã€‚</p><p>è¿™äº›æ“ä½œç‹¬ç«‹äº Bean ä¹‹å¤–ï¼Œå¹¶ä¸”ä¼šæ³¨å†Œåˆ° Spring å®¹å™¨ä¸­ï¼Œåœ¨Spring å®¹å™¨åˆ›å»ºBeançš„æ—¶å€™ï¼Œä¼šè¿›è¡Œä¸€äº›å¤„ç†ã€‚</p><p>å…·ä½“çš„ä¸€ä¸ªå…³ç³»çœ‹ä¸‹å›¾ï¼ˆæ¯”è¾ƒæ¸…æ™°ï¼‰ï¼š</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202312150342853.png" alt="image.png"></p><p>ä½ å¯ä»¥ç†è§£  <code>InstantiationAwareBeanPostProcessor</code> æ¥å£æ–¹æ³•æ˜¯ ä½œä¸º å®ä¾‹åŒ–é˜¶æ®µçš„â€äº§å‰äº§åæŠ¤ç†â€ï¼›<code>BeanPostProcessor</code> æ˜¯ åˆå§‹åŒ–é˜¶æ®µçš„ â€œå…³é”®è°ƒæ•´å’Œå¢å¼ºâ€ã€‚</p><h5 id="æºç å†…å®¹åˆ†æï¼ˆå®¹å™¨çº§åˆ«æ–¹æ³•ï¼‰"><a href="#æºç å†…å®¹åˆ†æï¼ˆå®¹å™¨çº§åˆ«æ–¹æ³•ï¼‰" class="headerlink" title="æºç å†…å®¹åˆ†æï¼ˆå®¹å™¨çº§åˆ«æ–¹æ³•ï¼‰"></a>æºç å†…å®¹åˆ†æï¼ˆå®¹å™¨çº§åˆ«æ–¹æ³•ï¼‰</h5><p>éœ€è¦å»äº†è§£Beançš„ç”Ÿå‘½å‘¨æœŸï¼Œè¿™ä¸ªæºç å¯¹åº”çš„æ–¹æ³•æ˜¯å¿…é¡»å»äº†è§£å’Œçœ‹çš„ã€‚</p><h5 id="InstantiationAwareBeanPostProcessor-æ¥å£åˆ†æ"><a href="#InstantiationAwareBeanPostProcessor-æ¥å£åˆ†æ" class="headerlink" title="InstantiationAwareBeanPostProcessor æ¥å£åˆ†æ"></a>InstantiationAwareBeanPostProcessor æ¥å£åˆ†æ</h5><p>æŸ¥çœ‹æºç ï¼Œå¯ä»¥çœ‹åˆ° InstantiationAwareBeanPostProcessor æ¥å£æ˜¯ç»§æ‰¿  BeanPostProcessor</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-symbol">InstantiationAwareBeanPostProcessor</span> <span class="hljs-symbol">extends</span> <span class="hljs-symbol">BeanPostProcessor</span><br></code></pre></td></tr></table></figure><blockquote><p>BeanPostProcessor</p></blockquote><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">BeanPostProcessor</span> &#123;  <br>    <span class="hljs-meta">@Nullable</span>  <br>    <span class="hljs-keyword">default</span> <span class="hljs-title class_">Object</span> <span class="hljs-title function_">postProcessBeforeInitialization</span>(<span class="hljs-title class_">Object</span> bean, <span class="hljs-title class_">String</span> beanName) throws <span class="hljs-title class_">BeansException</span> &#123;  <br>        <span class="hljs-keyword">return</span> bean;  <br>    &#125;  <br>  <br>    <span class="hljs-meta">@Nullable</span>  <br>    <span class="hljs-keyword">default</span> <span class="hljs-title class_">Object</span> <span class="hljs-title function_">postProcessAfterInitialization</span>(<span class="hljs-title class_">Object</span> bean, <span class="hljs-title class_">String</span> beanName) throws <span class="hljs-title class_">BeansException</span> &#123;  <br>        <span class="hljs-keyword">return</span> bean;  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p>AbstractAutowireCapableBeanFactory#createBean</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs haxe"><span class="hljs-comment">// åˆ›å»ºBeanå®ä¾‹çš„æ–¹æ³•ï¼Œæ¥æ”¶Beançš„åç§°ã€RootBeanDefinitionï¼ˆBeançš„å®šä¹‰ä¿¡æ¯ï¼‰å’Œå‚æ•°æ•°ç»„</span><br>protected Object createBean(<span class="hljs-keyword">String</span> beanName, RootBeanDefinition mbd, <span class="hljs-meta">@Nullable Object[] args) throws BeanCreationException &#123;</span><br>    <span class="hljs-comment">// å¦‚æœå¯ç”¨äº†è·Ÿè¸ªæ—¥å¿—ï¼Œè¾“å‡ºåˆ›å»ºBeanå®ä¾‹çš„è·Ÿè¸ªä¿¡æ¯</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.logger.isTraceEnabled()) &#123;<br>        <span class="hljs-built_in">this</span>.logger.<span class="hljs-built_in">trace</span>(<span class="hljs-string">&quot;Creating instance of bean &#x27;&quot;</span> + beanName + <span class="hljs-string">&quot;&#x27;&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-comment">// è§£æBeançš„ç±»ä¿¡æ¯ï¼Œå¦‚æœå·²ç»æœ‰è§£æè¿‡çš„ç±»ä¿¡æ¯ï¼Œä½¿ç”¨ä¹‹å‰è§£æå¾—åˆ°çš„ç±»ä¿¡æ¯</span><br>    RootBeanDefinition mbdToUse = mbd;<br>    Class&lt;?&gt; resolvedClass = <span class="hljs-built_in">this</span>.resolveBeanClass(mbd, beanName, <span class="hljs-keyword">new</span> <span class="hljs-type">Class</span>[<span class="hljs-number">0</span>]);<br>    <span class="hljs-comment">// å¦‚æœè§£æå¾—åˆ°çš„ç±»ä¿¡æ¯ä¸ä¸ºç©ºï¼Œä¸”å½“å‰Beançš„å®šä¹‰ä¿¡æ¯æ²¡æœ‰æŒ‡å®šç±»ä¿¡æ¯ï¼Œåˆ™æ›´æ–°Beançš„å®šä¹‰ä¿¡æ¯</span><br>    <span class="hljs-keyword">if</span> (resolvedClass != <span class="hljs-literal">null</span> &amp;&amp; !mbd.hasBeanClass() &amp;&amp; mbd.getBeanClassName() != <span class="hljs-literal">null</span>) &#123;<br>        mbdToUse = <span class="hljs-keyword">new</span> <span class="hljs-type">RootBeanDefinition</span>(mbd);<br>        mbdToUse.setBeanClass(resolvedClass);<br>    &#125;<br><br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-comment">// å‡†å¤‡å¤„ç†æ–¹æ³•çš„è¦†ç›–ï¼Œå³å‡†å¤‡è§£ææ–¹æ³•æ³¨è§£</span><br>        mbdToUse.prepareMethodOverrides();<br>    &#125; <span class="hljs-keyword">catch</span> (BeanDefinitionValidationException var9) &#123;<br>        <span class="hljs-comment">// å¦‚æœæ–¹æ³•æ³¨è§£è§£æå¤±è´¥ï¼ŒæŠ›å‡ºBeanDefinitionStoreExceptionå¼‚å¸¸</span><br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-type">BeanDefinitionStoreException</span>(mbdToUse.getResourceDescription(), beanName, <span class="hljs-string">&quot;Validation of method overrides failed&quot;</span>, var9);<br>    &#125;<br><br>    Object beanInstance;<br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-comment">// åœ¨å®ä¾‹åŒ–Beanä¹‹å‰ï¼Œå°è¯•è°ƒç”¨BeanPostProcessorçš„beforeInstantiationæ–¹æ³•</span><br>        beanInstance = <span class="hljs-built_in">this</span>.resolveBeforeInstantiation(beanName, mbdToUse);<br>        <span class="hljs-comment">// å¦‚æœbeforeInstantiationæ–¹æ³•è¿”å›éç©ºï¼Œè¡¨ç¤ºå·²ç»åˆ›å»ºäº†Beanå®ä¾‹ï¼Œç›´æ¥è¿”å›è¯¥å®ä¾‹</span><br>        <span class="hljs-keyword">if</span> (beanInstance != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">return</span> beanInstance;<br>        &#125;<br>    &#125; <span class="hljs-keyword">catch</span> (Throwable var10) &#123;<br>        <span class="hljs-comment">// å¦‚æœbeforeInstantiationæ–¹æ³•æŠ›å‡ºå¼‚å¸¸ï¼ŒæŠ›å‡ºBeanCreationExceptionå¼‚å¸¸</span><br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-type">BeanCreationException</span>(mbdToUse.getResourceDescription(), beanName, <span class="hljs-string">&quot;BeanPostProcessor before instantiation of bean failed&quot;</span>, var10);<br>    &#125;<br><br>    <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-comment">// æ‰§è¡ŒçœŸæ­£çš„Beanåˆ›å»ºé€»è¾‘ï¼ŒåŒ…æ‹¬å®ä¾‹åŒ–ã€å±æ€§æ³¨å…¥ç­‰è¿‡ç¨‹</span><br>        beanInstance = <span class="hljs-built_in">this</span>.doCreateBean(beanName, mbdToUse, args);<br>        <span class="hljs-comment">// å¦‚æœå¯ç”¨äº†è·Ÿè¸ªæ—¥å¿—ï¼Œè¾“å‡ºBeanå®ä¾‹åˆ›å»ºå®Œæˆçš„è·Ÿè¸ªä¿¡æ¯</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.logger.isTraceEnabled()) &#123;<br>            <span class="hljs-built_in">this</span>.logger.<span class="hljs-built_in">trace</span>(<span class="hljs-string">&quot;Finished creating instance of bean &#x27;&quot;</span> + beanName + <span class="hljs-string">&quot;&#x27;&quot;</span>);<br>        &#125;<br>        <span class="hljs-comment">// è¿”å›åˆ›å»ºçš„Beanå®ä¾‹</span><br>        <span class="hljs-keyword">return</span> beanInstance;<br>    &#125; <span class="hljs-keyword">catch</span> (ImplicitlyAppearedSingletonException | BeanCreationException var7) &#123;<br>        <span class="hljs-comment">// å¦‚æœBeanåˆ›å»ºè¿‡ç¨‹ä¸­å‡ºç°äº†å¼‚å¸¸ï¼ŒæŠ›å‡ºå¼‚å¸¸</span><br>        <span class="hljs-keyword">throw</span> var7;<br>    &#125; <span class="hljs-keyword">catch</span> (Throwable var8) &#123;<br>        <span class="hljs-comment">// å¦‚æœBeanåˆ›å»ºè¿‡ç¨‹ä¸­å‡ºç°äº†æœªæ•è·çš„å¼‚å¸¸ï¼ŒæŠ›å‡ºBeanCreationExceptionå¼‚å¸¸</span><br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-type">BeanCreationException</span>(mbdToUse.getResourceDescription(), beanName, <span class="hljs-string">&quot;Unexpected exception during bean creation&quot;</span>, var8);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2-3-å·¥å‚åå¤„ç†å™¨æ–¹æ³•"><a href="#2-3-å·¥å‚åå¤„ç†å™¨æ–¹æ³•" class="headerlink" title="2.3 å·¥å‚åå¤„ç†å™¨æ–¹æ³•"></a>2.3 <strong>å·¥å‚åå¤„ç†å™¨æ–¹æ³•</strong></h4><p><strong>BeanFactoryProcessor ä¸€ç³»åˆ—æ¥å£</strong></p><p>åŒ…æ‹¬ AspectJWeavingEnablerã€CustomAutowireConfigurerã€ConfigurationClassPostProcessor ç­‰ã€‚</p><p>è¿™äº›éƒ½æ˜¯ Spring æ¡†æ¶ä¸­å·²ç»å®ç°å¥½çš„ BeanFactoryPostProcessorï¼Œç”¨æ¥å®ç°æŸäº›ç‰¹å®šçš„åŠŸèƒ½</p><blockquote><p>BeanFactoryProcessor æ¥å£ vs  BeanPostProcessoræ¥å£</p></blockquote><p><code>BeanFactoryPostProcessor</code> æ¥å£å’Œ <code>BeanPostProcessor</code> æ¥å£éƒ½æ˜¯ Spring æ¡†æ¶ä¸­ç”¨äºå®šåˆ¶å’Œæ‰©å±• Bean çš„å…³é”®æ¥å£ï¼Œä½†å®ƒä»¬çš„ä½œç”¨å’Œæ—¶æœºç•¥æœ‰ä¸åŒã€‚</p><p>BeanFactoryPostProcessor æ¥å£ï¼š</p><ol><li><p><strong>ä½œç”¨ï¼š</strong> <code>BeanFactoryPostProcessor</code> æ¥å£ç”¨äºåœ¨ Spring å®¹å™¨å®ä¾‹åŒ– Bean ä¹‹å‰ä¿®æ”¹æˆ–å®šåˆ¶ BeanFactory çš„é…ç½®ã€‚</p></li><li><p><strong>æ—¶æœºï¼š</strong> åœ¨ Spring å®¹å™¨è¯»å–äº† Bean çš„å®šä¹‰ï¼ˆé…ç½®å…ƒæ•°æ®ï¼‰ä½†åœ¨å®ä¾‹åŒ–ä»»ä½• Bean ä¹‹å‰ï¼Œ<code>BeanFactoryPostProcessor</code> æ¥å£æä¾›äº†æœºä¼šæ¥ä¿®æ”¹ Bean çš„å®šä¹‰ï¼Œä¾‹å¦‚ä¿®æ”¹å±æ€§å€¼ã€æ·»åŠ å±æ€§ç­‰ã€‚</p></li><li><p><strong>å®ç°æ–¹æ³•ï¼š</strong> å®ç° <code>postProcessBeanFactory</code> æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼ é€’äº† BeanFactory å¯¹è±¡ï¼Œå¯ä»¥åœ¨æ­¤æ–¹æ³•ä¸­ä¿®æ”¹ BeanFactory çš„é…ç½®ã€‚</p></li></ol><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">beans</span>.<span class="hljs-property">factory</span>.<span class="hljs-property">config</span>.<span class="hljs-property">ConfigurableListableBeanFactory</span>;<br><span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">beans</span>.<span class="hljs-property">factory</span>.<span class="hljs-property">support</span>.<span class="hljs-property">BeanDefinitionBuilder</span>;<br><span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">beans</span>.<span class="hljs-property">factory</span>.<span class="hljs-property">support</span>.<span class="hljs-property">BeanDefinitionRegistryPostProcessor</span>;<br><span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">beans</span>.<span class="hljs-property">factory</span>.<span class="hljs-property">support</span>.<span class="hljs-property">BeanDefinitionRegistry</span>;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyBeanFactoryPostProcessor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">BeanDefinitionRegistryPostProcessor</span> &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">postProcessBeanFactory</span>(<span class="hljs-params">ConfigurableListableBeanFactory beanFactory</span>) &#123;<br>        <span class="hljs-comment">// åœ¨è¿™é‡Œå¯ä»¥ä¿®æ”¹ BeanFactory çš„é…ç½®</span><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">postProcessBeanDefinitionRegistry</span>(<span class="hljs-params">BeanDefinitionRegistry registry</span>) &#123;<br>        <span class="hljs-comment">// åœ¨è¿™é‡Œå¯ä»¥æ³¨å†Œæ–°çš„ BeanDefinition</span><br>        <span class="hljs-title class_">BeanDefinitionBuilder</span> builder = <span class="hljs-title class_">BeanDefinitionBuilder</span>.<span class="hljs-title function_">genericBeanDefinition</span>(<span class="hljs-title class_">MyBean</span>.<span class="hljs-property">class</span>);<br>        registry.<span class="hljs-title function_">registerBeanDefinition</span>(<span class="hljs-string">&quot;myBean&quot;</span>, builder.<span class="hljs-title function_">getBeanDefinition</span>());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>BeanPostProcessor æ¥å£</p></blockquote><ol><li><p><strong>ä½œç”¨ï¼š</strong> <code>BeanPostProcessor</code> æ¥å£ç”¨äºåœ¨ Spring å®¹å™¨å®ä¾‹åŒ– Bean åï¼Œåœ¨ Bean çš„åˆå§‹åŒ–å‰åæ‰§è¡Œä¸€äº›è‡ªå®šä¹‰çš„é€»è¾‘ã€‚</p></li><li><p><strong>æ—¶æœºï¼š</strong> å½“ Bean è¢«å®ä¾‹åŒ–åï¼Œä½†åœ¨è°ƒç”¨å…¶åˆå§‹åŒ–æ–¹æ³•ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ä¹‹å‰ï¼Œ<code>BeanPostProcessor</code> æä¾›äº† <code>postProcessBeforeInitialization</code> å’Œ <code>postProcessAfterInitialization</code> æ–¹æ³•ç”¨äºåœ¨åˆå§‹åŒ–é˜¶æ®µè¿›è¡Œå®šåˆ¶æ“ä½œã€‚</p></li><li><p><strong>å®ç°æ–¹æ³•ï¼š</strong> å®ç° <code>BeanPostProcessor</code> æ¥å£çš„ä¸¤ä¸ªæ–¹æ³•ï¼Œå¯ä»¥åœ¨è¿™ä¸¤ä¸ªæ–¹æ³•ä¸­æ·»åŠ å®šåˆ¶é€»è¾‘ã€‚</p></li></ol><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">beans</span>.<span class="hljs-property">BeansException</span>;<br><span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">beans</span>.<span class="hljs-property">factory</span>.<span class="hljs-property">config</span>.<span class="hljs-property">BeanPostProcessor</span>;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyBeanPostProcessor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">BeanPostProcessor</span> &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Object</span> <span class="hljs-title function_">postProcessBeforeInitialization</span>(<span class="hljs-title class_">Object</span> bean, <span class="hljs-title class_">String</span> beanName) throws <span class="hljs-title class_">BeansException</span> &#123;<br>        <span class="hljs-comment">// åœ¨åˆå§‹åŒ–ä¹‹å‰çš„é€»è¾‘</span><br>        <span class="hljs-keyword">return</span> bean;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Object</span> <span class="hljs-title function_">postProcessAfterInitialization</span>(<span class="hljs-title class_">Object</span> bean, <span class="hljs-title class_">String</span> beanName) throws <span class="hljs-title class_">BeansException</span> &#123;<br>        <span class="hljs-comment">// åœ¨åˆå§‹åŒ–ä¹‹åçš„é€»è¾‘</span><br>        <span class="hljs-keyword">return</span> bean;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ€»ç»“</p><ul><li><code>BeanFactoryPostProcessor</code> ä¸»è¦ç”¨äºä¿®æ”¹æ•´ä¸ª BeanFactory çš„é…ç½®ï¼Œå®ƒåœ¨ Bean å®ä¾‹åŒ–ä¹‹å‰æ‰§è¡Œã€‚</li><li><code>BeanPostProcessor</code> ä¸»è¦ç”¨äºåœ¨æ¯ä¸ª Bean çš„åˆå§‹åŒ–é˜¶æ®µæ·»åŠ è‡ªå®šä¹‰é€»è¾‘ï¼Œå®ƒåœ¨ Bean å®ä¾‹åŒ–åï¼Œåˆå§‹åŒ–æ–¹æ³•è°ƒç”¨å‰åæ‰§è¡Œã€‚</li></ul><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¯ä»¥åŒæ—¶ä½¿ç”¨è¿™ä¸¤ä¸ªæ¥å£æ¥å®Œæˆæ›´å¤æ‚çš„å®šåˆ¶éœ€æ±‚ã€‚</p><h4 id="2-4-Bean-çº§ç”Ÿå‘½å‘¨æœŸæ–¹æ³•"><a href="#2-4-Bean-çº§ç”Ÿå‘½å‘¨æœŸæ–¹æ³•" class="headerlink" title="2.4  Bean çº§ç”Ÿå‘½å‘¨æœŸæ–¹æ³•"></a>2.4  <strong>Bean çº§ç”Ÿå‘½å‘¨æœŸæ–¹æ³•</strong></h4><p>å…³äº Bean çº§ç”Ÿå‘½å‘¨æœŸæ–¹æ³•çš„ç†è§£ï¼š</p><ul><li>è¿™äº›æ–¹æ³•æä¾›äº†é’ˆå¯¹ Bean å®ä¾‹çš„<strong>ä¸ªæ€§åŒ–è¡Œä¸º</strong>ï¼Œå…è®¸ Bean åœ¨å…¶ç”Ÿå‘½å‘¨æœŸçš„å…³é”®ç‚¹åšå‡ºå“åº”ã€‚</li></ul><p>é€šè¿‡è¿™äº›æ–¹æ³•ï¼Œæ˜¯å¯ä»¥å¯¹äºæŸä¸ªBeanå®ä¾‹è¿›è¡Œä¸ªæ€§åŒ–æ“ä½œçš„ã€‚</p><p>å¯ä»¥ç†è§£ä¸º Bean ç±»ç›´æ¥å®ç°æ¥å£çš„æ–¹æ³•ï¼Œæ¯”å¦‚Â <code>BeanNameAware</code>ã€<code>BeanFactoryAware</code>ã€<code>ApplicationContextAware</code>ã€<code>InitializingBean</code>ã€<code>DisposableBean</code>Â ç­‰æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•åªå¯¹å½“å‰ Bean ç”Ÿæ•ˆã€‚</p><p>Aware ç±»å‹çš„æ¥å£</p><p>Aware ç±»å‹çš„æ¥å£çš„ä½œç”¨å°±æ˜¯è®©æˆ‘ä»¬èƒ½å¤Ÿæ‹¿åˆ° Spring å®¹å™¨ä¸­çš„ä¸€äº›èµ„æºã€‚</p><p>åŸºæœ¬éƒ½èƒ½å¤Ÿè§åçŸ¥æ„ï¼ŒAware ä¹‹å‰çš„åå­—å°±æ˜¯å¯ä»¥æ‹¿åˆ°ä»€ä¹ˆèµ„æºï¼Œä¾‹å¦‚ BeanNameAware å¯ä»¥æ‹¿åˆ° BeanNameï¼Œä»¥æ­¤ç±»æ¨ã€‚</p><h3 id="3ã€Spring-Bean-è¯¦ç»†ç”Ÿå‘½å‘¨æœŸ"><a href="#3ã€Spring-Bean-è¯¦ç»†ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="3ã€Spring Bean è¯¦ç»†ç”Ÿå‘½å‘¨æœŸ"></a>3ã€Spring Bean è¯¦ç»†ç”Ÿå‘½å‘¨æœŸ</h3><blockquote><p>Bean çš„ç”Ÿå‘½å‘¨æœŸ</p></blockquote><ul><li>Bean å®¹å™¨æ‰¾åˆ°é…ç½®æ–‡ä»¶ä¸­ Spring Bean çš„å®šä¹‰ã€‚</li><li>Bean å®¹å™¨åˆ©ç”¨ Java Reflection API åˆ›å»ºä¸€ä¸ª Bean çš„å®ä¾‹ã€‚</li><li>å¦‚æœæ¶‰åŠåˆ°ä¸€äº›å±æ€§å€¼ åˆ©ç”¨ set() æ–¹æ³•è®¾ç½®ä¸€äº›å±æ€§å€¼ã€‚</li><li>å¦‚æœ Bean å®ç°äº† BeanNameAware æ¥å£ï¼Œè°ƒç”¨ setBeanName() æ–¹æ³•ï¼Œä¼ å…¥ Bean çš„åå­—ã€‚</li><li>å¦‚æœ Bean å®ç°äº† BeanClassLoaderAware æ¥å£ï¼Œè°ƒç”¨ setBeanClassLoader() æ–¹æ³•ï¼Œä¼ å…¥ ClassLoader å¯¹è±¡çš„å®ä¾‹ã€‚</li><li>å¦‚æœ Bean å®ç°äº† BeanFactoryAware æ¥å£ï¼Œè°ƒç”¨ setBeanFactory() æ–¹æ³•ï¼Œä¼ å…¥ BeanFactory å¯¹è±¡çš„å®ä¾‹ã€‚</li><li>ä¸ä¸Šé¢çš„ç±»ä¼¼ï¼Œå¦‚æœå®ç°äº†å…¶ä»– * .Aware æ¥å£ï¼Œå°±è°ƒç”¨ç›¸åº”çš„æ–¹æ³•ã€‚</li><li>å¦‚æœæœ‰å’ŒåŠ è½½è¿™ä¸ª Bean çš„ Spring å®¹å™¨ç›¸å…³çš„ BeanPostProcessor å¯¹è±¡ï¼Œæ‰§è¡Œ postProcessBeforeInitialization() æ–¹æ³•</li><li>å¦‚æœ Bean å®ç°äº† InitializingBean æ¥å£ï¼Œæ‰§è¡Œ afterPropertiesSet() æ–¹æ³•ã€‚</li><li>å¦‚æœ Bean åœ¨é…ç½®æ–‡ä»¶ä¸­çš„å®šä¹‰åŒ…å« init-method å±æ€§ï¼Œæ‰§è¡ŒæŒ‡å®šçš„æ–¹æ³•ã€‚</li><li>å¦‚æœæœ‰å’ŒåŠ è½½è¿™ä¸ª Bean çš„ Spring å®¹å™¨ç›¸å…³çš„ BeanPostProcessor å¯¹è±¡ï¼Œæ‰§è¡Œ postProcessAfterInitialization() æ–¹æ³•</li><li>å½“è¦é”€æ¯ Bean çš„æ—¶å€™ï¼Œå¦‚æœ Bean å®ç°äº† DisposableBean æ¥å£ï¼Œæ‰§è¡Œ destroy() æ–¹æ³•ã€‚</li><li>å½“è¦é”€æ¯ Bean çš„æ—¶å€™ï¼Œå¦‚æœ Bean åœ¨é…ç½®æ–‡ä»¶ä¸­çš„å®šä¹‰åŒ…å« destroy-method å±æ€§ï¼Œæ‰§è¡ŒæŒ‡å®šçš„æ–¹æ³•ã€‚</li></ul><h3 id="4ã€Bean-åˆ›å»ºæµç¨‹å…¥å£-refresh"><a href="#4ã€Bean-åˆ›å»ºæµç¨‹å…¥å£-refresh" class="headerlink" title="4ã€Bean åˆ›å»ºæµç¨‹å…¥å£ refresh()"></a>4ã€Bean åˆ›å»ºæµç¨‹å…¥å£ refresh()</h3><h4 id="ç›¸å…³æ¦‚å¿µå›é¡¾"><a href="#ç›¸å…³æ¦‚å¿µå›é¡¾" class="headerlink" title="ç›¸å…³æ¦‚å¿µå›é¡¾"></a>ç›¸å…³æ¦‚å¿µå›é¡¾</h4><h5 id="Springä¸Šä¸‹æ–‡"><a href="#Springä¸Šä¸‹æ–‡" class="headerlink" title="Springä¸Šä¸‹æ–‡"></a>Springä¸Šä¸‹æ–‡</h5><p>ä»ä»£ç çº§åˆ«æ¥è¯´ï¼Œå°±æ˜¯æŒ‡Spring Context</p><p>ä»æºç çº§åˆ«ï¼Œæˆ‘ä»¬åˆå§‹åŒ–Spring Contextçš„æ—¶å€™ï¼Œä¸€å †çš„Springç»„ä»¶å›´ç»•åœ¨ä¸€èµ·ï¼Œä½¿å…¶èƒ½å¤Ÿæ­£å¸¸å·¥ä½œï¼Œè¿™ä¸ªçŠ¶æ€å°±è¢«ç§°ä¸ºSpringç¯å¢ƒã€‚</p><h5 id="Spring-åˆå§‹åŒ–æ“ä½œ"><a href="#Spring-åˆå§‹åŒ–æ“ä½œ" class="headerlink" title="Spring åˆå§‹åŒ–æ“ä½œ"></a>Spring åˆå§‹åŒ–æ“ä½œ</h5><p>å…·ä½“æ“ä½œå¯ä»¥è§ä¸‹#ClassPathXmlApplicationContext çš„æ„é€ æ–¹æ³•å“ªé‡Œä¼šè¢«åŠ è½½å¹¶ä½¿ç”¨</p><p>ä½¿ç”¨å‰éœ€è¦å¼•å…¥ spring-context ç›¸å…³çš„ä¾èµ–ï¼Œåˆå§‹åŒ–Beanå¯ä»¥é€šè¿‡æ³¨è§£çš„æ–¹å¼ä¹Ÿå¯ä»¥é€šè¿‡xmlçš„æ–¹å¼ã€‚</p><h5 id="BeanFactory-ä¸-ApplicationContext"><a href="#BeanFactory-ä¸-ApplicationContext" class="headerlink" title="BeanFactory  ä¸  ApplicationContext"></a><code>BeanFactory</code>  ä¸  <code>ApplicationContext</code></h5><p>å…ˆäº†è§£ä¸€ä¸‹  <code>BeanFactory</code> ä¸  <code>ApplicationContext</code> æ¥å£ä¸¤ä¸ªçš„ä½œç”¨ä¸æ¦‚å¿µï¼š</p><ul><li><code>org.springframework.beans</code> å’Œ <code>org.springframework.context</code> åŒ…æ˜¯Spring Frameworkçš„IoCå®¹å™¨çš„åŸºç¡€ã€‚ </li><li><code>BeanFactory</code>Â æä¾›äº†é…ç½®æ¡†æ¶å’ŒåŸºæœ¬åŠŸèƒ½ï¼Œæä¾›äº†ä¸€ç§é«˜çº§é…ç½®æœºåˆ¶ï¼Œèƒ½å¤Ÿç®¡ç†ä»»ä½•ç±»å‹çš„å¯¹è±¡ã€‚</li><li><code>ApplicationContext</code> æ˜¯ <code>BeanFactory</code> çš„ä¸€ä¸ªå­æ¥å£ï¼Œç›¸æ¯”äº <code>BeanFactory</code>  æ¥è¯´ï¼Œå¢åŠ äº†æ›´å¤šçš„ä¼ä¸šç‰¹å®šåŠŸèƒ½, æ˜¯Â <code>BeanFactory</code>Â çš„ä¸€ä¸ªå®Œæ•´çš„è¶…é›†ã€‚</li><li><code>BeanFactory</code> å®ç°äº†<strong>å»¶è¿Ÿ</strong>åŠ è½½ï¼ˆæ‡’åŠ è½½ï¼‰ï¼Œåªæœ‰åœ¨è¯·æ±‚è·å–Beanæ—¶ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡<code>getBean()</code>æ–¹æ³•ï¼‰ï¼Œå®¹å™¨æ‰ä¼šåˆ›å»ºè¯¥Beanã€‚è¿™æ„å‘³ç€å¦‚æœåº”ç”¨ä¸­æœªä½¿ç”¨æŸä¸ªBeanï¼Œå®ƒå°±ä¸ä¼šè¢«å®ä¾‹åŒ–ã€‚</li><li><code>ApplicationContext</code>å…¶ä¸‹ç®¡ç†çš„ Bean æ˜¯<strong>åœ¨IOCå®¹å™¨åˆå§‹åŒ–</strong>çš„æ—¶å€™å®Œæˆ Bean å®ä¾‹åŒ–ã€‚</li></ul><h5 id="ApplicationContext"><a href="#ApplicationContext" class="headerlink" title="ApplicationContext"></a><code>ApplicationContext</code></h5><p><code>org.springframework.context.ApplicationContext</code>Â æ¥å£ä»£è¡¨Spring IoCå®¹å™¨ï¼Œè´Ÿè´£å®ä¾‹åŒ–ã€é…ç½®å’Œç»„è£…beanã€‚</p><h5 id="AbstractApplicationContext"><a href="#AbstractApplicationContext" class="headerlink" title="AbstractApplicationContext"></a><code>AbstractApplicationContext</code></h5><p><code>AbstractApplicationContext</code> å®ç°äº† <code>ApplicationContext</code> æ¥å£ï¼Œæä¾›äº†è¿™ä¸ªæ¥å£çš„å¤§éƒ¨åˆ†é€šç”¨åŠŸèƒ½ã€‚</p><p>å®ƒæ˜¯å®é™…åº”ç”¨ä¸Šä¸‹æ–‡ç±»ï¼ˆå¦‚ <code>ClassPathXmlApplicationContext</code> å’Œ <code>AnnotationConfigApplicationContext</code>ï¼‰çš„çˆ¶ç±»</p><p>é€šè¿‡ç»§æ‰¿å’Œæ‰©å±• <code>AbstractApplicationContext</code>ï¼ŒSpring å…è®¸å¼€å‘è€…è‡ªå®šä¹‰åº”ç”¨ä¸Šä¸‹æ–‡çš„è¡Œä¸ºï¼Œä»¥æ»¡è¶³ç‰¹å®šçš„ä¸šåŠ¡éœ€æ±‚ã€‚</p><h5 id="ClassPathXmlApplicationContext-çš„æ„é€ æ–¹æ³•å“ªé‡Œä¼šè¢«åŠ è½½å¹¶ä½¿ç”¨ï¼Ÿ"><a href="#ClassPathXmlApplicationContext-çš„æ„é€ æ–¹æ³•å“ªé‡Œä¼šè¢«åŠ è½½å¹¶ä½¿ç”¨ï¼Ÿ" class="headerlink" title="ClassPathXmlApplicationContext çš„æ„é€ æ–¹æ³•å“ªé‡Œä¼šè¢«åŠ è½½å¹¶ä½¿ç”¨ï¼Ÿ"></a>ClassPathXmlApplicationContext çš„æ„é€ æ–¹æ³•å“ªé‡Œä¼šè¢«åŠ è½½å¹¶ä½¿ç”¨ï¼Ÿ</h5><p>ä»¥ä¸‹æ˜¯å‡ ä¸ªå…¸å‹åœºæ™¯ï¼Œå…¶ä¸­å¯èƒ½ä¼šåŠ è½½å¹¶ä½¿ç”¨ <code>ClassPathXmlApplicationContext</code> çš„æ„é€ æ–¹æ³•ï¼š</p><ol><li>Java åº”ç”¨çš„ä¸»æ–¹æ³• (main)</li></ol><p>åœ¨ä¸€ä¸ªæ ‡å‡†çš„ Java åº”ç”¨ç¨‹åºä¸­ï¼Œä½ å¯ä»¥åœ¨ <code>main</code> æ–¹æ³•ä¸­åˆ›å»º <code>ClassPathXmlApplicationContext</code> çš„å®ä¾‹æ¥å¯åŠ¨ Spring å®¹å™¨ã€‚è¿™æ˜¯æœ€å¸¸è§çš„ç”¨æ³•ã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyApp</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"><span class="hljs-built_in">String</span>[] args</span>) &#123;<br>        <span class="hljs-title class_">ApplicationContext</span> context = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassPathXmlApplicationContext</span>(<span class="hljs-string">&quot;applicationContext.xml&quot;</span>);<br>        <span class="hljs-comment">// ä½¿ç”¨ context è·å– Bean å®ä¾‹...</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>ClassPathXmlApplicationContext</code> ç”¨äºåŠ è½½åä¸º â€œapplicationContext.xmlâ€ çš„é…ç½®æ–‡ä»¶ã€‚</p><ol start="2"><li>Web åº”ç”¨ç¨‹åº</li></ol><p>åœ¨åŸºäº Servlet çš„ä¼ ç»Ÿ Web åº”ç”¨ç¨‹åºä¸­ï¼Œå¯ä»¥åœ¨ Servlet çš„ <code>init</code> æ–¹æ³•ä¸­åˆ›å»º <code>ClassPathXmlApplicationContext</code>ï¼Œæˆ–è€…ä½¿ç”¨ Spring çš„ <code>ContextLoaderListener</code> åœ¨ Web åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½ Spring ä¸Šä¸‹æ–‡ã€‚</p><ol start="3"><li>å•å…ƒæµ‹è¯•</li></ol><p>åœ¨ç¼–å†™ Spring åº”ç”¨çš„å•å…ƒæµ‹è¯•æ—¶ï¼Œå¯ä»¥åœ¨æµ‹è¯•ç±»ä¸­åˆ›å»º <code>ClassPathXmlApplicationContext</code> æ¥åŠ è½½æ‰€éœ€çš„ Spring é…ç½®ï¼Œå¹¶è¿›è¡Œæµ‹è¯•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyTest</span> &#123;<br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testSomeService</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">ApplicationContext</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassPathXmlApplicationContext</span>(<span class="hljs-string">&quot;testContext.xml&quot;</span>);<br>        <span class="hljs-type">MyService</span> <span class="hljs-variable">myService</span> <span class="hljs-operator">=</span> context.getBean(MyService.class);<br>        <span class="hljs-comment">// æ‰§è¡Œæµ‹è¯•...</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨è¿™é‡Œï¼Œæµ‹è¯•ä½¿ç”¨äº†å•ç‹¬çš„é…ç½®æ–‡ä»¶ â€œtestContext.xmlâ€ã€‚</p><ol start="4"><li>Spring Boot åº”ç”¨</li></ol><p>ä½¿ç”¨ Spring Boot æ—¶é€šå¸¸ä¸ç›´æ¥ä½¿ç”¨ <code>ClassPathXmlApplicationContext</code></p><p> Spring Boot æä¾›äº†åŸºäºæ³¨è§£çš„é…ç½®å’Œè‡ªåŠ¨é…ç½®çš„èƒ½åŠ›ï¼Œä¸€èˆ¬æ˜¯ä½¿ç”¨æ³¨è§£é…ç½®çš„æ–¹å¼è¿›è¡Œå£°æ˜Beanæ“ä½œ ï¼Œä½†åœ¨ä¸€äº›æ—§çš„æˆ–ç‰¹æ®Šçš„æƒ…å†µä¸‹ï¼Œå¯èƒ½ä»ç„¶éœ€è¦æ‰‹åŠ¨åŠ è½½ XML é…ç½®çš„æ–¹å¼ã€‚</p><hr><h4 id="Bean-åˆ›å»ºæµç¨‹å…¥å£"><a href="#Bean-åˆ›å»ºæµç¨‹å…¥å£" class="headerlink" title="Bean åˆ›å»ºæµç¨‹å…¥å£"></a>Bean åˆ›å»ºæµç¨‹å…¥å£</h4><p>è¿™é‡Œç›´æ¥è·Ÿä¸€ä¸‹æºç çœ‹ä¸€ä¸‹ç›¸å…³å†…å®¹</p><p>ä¸‹é¢çš„ä»£ç æ˜¯ä» spring-context-5.2.4.RELEASE ç‰ˆæœ¬ä¸­çš„ AbstractApplicationContext æŠ½è±¡ç±»ä¸‹ç›¸å…³æ–¹æ³•å’Œå†…å®¹è¯´æ˜ã€‚</p><p>åœ¨å®é™…åº”ç”¨ä¸Šä¸‹æ–‡ç±»ä¸­ï¼ˆå¦‚ <code>ClassPathXmlApplicationContext</code> å’Œ <code>AnnotationConfigApplicationContext</code>ï¼‰ï¼Œä»–ä»¬çš„æ„é€ æ–¹æ³•ä¸­ä¼šè°ƒç”¨è¿™ä¸ª refresh() æ–¹æ³•ç±»è¿›è¡Œåˆå§‹åŒ– Spring å®¹å™¨ã€‚</p><p>å› æ­¤å¯ä»¥åˆ¤æ–­å‡º  Bean åˆ›å»ºæµç¨‹å…¥å£ æ˜¯å®šä¹‰åœ¨ AbstractApplicationContext æŠ½è±¡ç±»ä¸‹ refresh() æ–¹æ³•ã€‚</p><h5 id="refresshæ–¹æ³•"><a href="#refresshæ–¹æ³•" class="headerlink" title="refresshæ–¹æ³•"></a>refresshæ–¹æ³•</h5><p>è¿™é‡Œå®é™…çœ‹ä¸€ä¸‹ç›¸å…³ä»£ç  AbstractApplicationContext#refresh()</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">public</span> void refresh() throws BeansException, IllegalStateException &#123;<br>    <span class="hljs-comment">// åŒæ­¥é”ç¡®ä¿å®¹å™¨åˆ·æ–°æ—¶çš„çº¿ç¨‹å®‰å…¨</span><br>    synchronized (<span class="hljs-keyword">this</span>.startupShutdownMonitor) &#123;<br><br>        <span class="hljs-comment">// å‡†å¤‡åˆ·æ–°ï¼Œè®¾ç½®å¯åŠ¨æ—¥æœŸå’Œæ´»è·ƒçŠ¶æ€ç­‰</span><br>        <span class="hljs-keyword">this</span>.prepareRefresh();<br><br>        <span class="hljs-comment">// è·å–æ–°çš„ BeanFactoryï¼Œåˆå§‹åŒ– BeanFactoryï¼Œå¹¶åŠ è½½ Bean å®šä¹‰</span><br>        ConfigurableListableBeanFactory beanFactory = <span class="hljs-keyword">this</span>.obtainFreshBeanFactory();<br><br>        <span class="hljs-comment">// é…ç½® BeanFactoryï¼Œè®¾ç½®ç±»åŠ è½½å™¨ã€äº‹ä»¶å¤„ç†å™¨ç­‰</span><br>        <span class="hljs-keyword">this</span>.prepareBeanFactory(beanFactory);<br><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">// å…è®¸åœ¨ BeanFactory æ ‡å‡†åˆå§‹åŒ–ä¹‹åè¿›è¡Œå®šåˆ¶ä¿®æ”¹</span><br>            <span class="hljs-keyword">this</span>.postProcessBeanFactory(beanFactory);<br><br>            <span class="hljs-comment">// è°ƒç”¨åœ¨å®¹å™¨ä¸­æ³¨å†Œçš„ BeanFactoryPostProcessor</span><br>            <span class="hljs-keyword">this</span>.invokeBeanFactoryPostProcessors(beanFactory);<br><br>            <span class="hljs-comment">// æ³¨å†Œ BeanPostProcessorï¼Œè¿™äº›å¤„ç†å™¨å½±å“æ‰€æœ‰ Bean çš„åˆ›å»º</span><br>            <span class="hljs-keyword">this</span>.registerBeanPostProcessors(beanFactory);<br><br>            <span class="hljs-comment">// åˆå§‹åŒ– MessageSource ç»„ä»¶ï¼Œç”¨äºå›½é™…åŒ–å¤„ç†</span><br>            <span class="hljs-keyword">this</span>.initMessageSource();<br><br>            <span class="hljs-comment">// åˆå§‹åŒ– ApplicationEventMulticasterï¼Œç”¨äºäº‹ä»¶å¹¿æ’­</span><br>            <span class="hljs-keyword">this</span>.initApplicationEventMulticaster();<br><br>            <span class="hljs-comment">// ç‰¹å®šäº ApplicationContext çš„åˆ·æ–°æ“ä½œ</span><br>            <span class="hljs-keyword">this</span>.onRefresh();<br><br>            <span class="hljs-comment">// æ³¨å†Œç›‘å¬å™¨åˆ°äº‹ä»¶å¹¿æ’­å™¨</span><br>            <span class="hljs-keyword">this</span>.registerListeners();<br><br>            <span class="hljs-comment">// åˆå§‹åŒ–æ‰€æœ‰å‰©ä½™çš„éæ‡’åŠ è½½å•ä¾‹</span><br>            <span class="hljs-keyword">this</span>.finishBeanFactoryInitialization(beanFactory);<br><br>            <span class="hljs-comment">// å®Œæˆåˆ·æ–°è¿‡ç¨‹ï¼Œé€šçŸ¥ç”Ÿå‘½å‘¨æœŸå¤„ç†å™¨ä»¥åŠå‘å¸ƒç›¸åº”çš„äº‹ä»¶</span><br>            <span class="hljs-keyword">this</span>.finishRefresh();<br>        &#125; <span class="hljs-keyword">catch</span> (BeansException var9) &#123;<br>            <span class="hljs-comment">// åœ¨ä¸Šä¸‹æ–‡åˆå§‹åŒ–è¿‡ç¨‹ä¸­æ•è·å¹¶å¤„ç†å¼‚å¸¸</span><br>            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.logger.isWarnEnabled()) &#123;<br>                <span class="hljs-keyword">this</span>.logger.warn(<span class="hljs-string">&quot;Exception encountered during context initialization - cancelling refresh attempt: &quot;</span> + var9);<br>            &#125;<br><br>            <span class="hljs-comment">// é”€æ¯å·²åˆ›å»ºçš„ Beanï¼Œä»¥é˜²æœ‰äº› Bean å·²ç»åˆå§‹åŒ–äº†ï¼Œä½†åç»­çš„åˆå§‹åŒ–è¿‡ç¨‹å¤±è´¥äº†</span><br>            <span class="hljs-keyword">this</span>.destroyBeans();<br><br>            <span class="hljs-comment">// å–æ¶ˆåˆ·æ–°æ“ä½œï¼Œé‡ç½®ä¸Šä¸‹æ–‡çš„åŒæ­¥æ ‡å¿—</span><br>            <span class="hljs-keyword">this</span>.cancelRefresh(var9);<br><br>            <span class="hljs-comment">// é‡æ–°æŠ›å‡ºå¼‚å¸¸ï¼Œé€šçŸ¥å¤–éƒ¨è°ƒç”¨è€…</span><br>            <span class="hljs-keyword">throw</span> var9;<br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            <span class="hljs-comment">// é‡ç½®å…¬å…±ç¼“å­˜ï¼ˆä¾‹å¦‚ Reflection ç¼“å­˜ï¼‰</span><br>            <span class="hljs-keyword">this</span>.resetCommonCaches();<br>        &#125;<br>    &#125;<br>&#125; <br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°åˆå§‹åŒ–å•ä¾‹è¿™æ­¥æ“ä½œæ˜¯åœ¨ this.finishBeanFactoryInitialization(beanFactory); è¿™é‡Œè¿›è¡Œçš„</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs arduino"><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-type">void</span> <span class="hljs-title">finishBeanFactoryInitialization</span><span class="hljs-params">(ConfigurableListableBeanFactory beanFactory)</span> </span>&#123;<br>    <span class="hljs-comment">// å¦‚æœ BeanFactory åŒ…å«åä¸º &quot;conversionService&quot; çš„ Beanï¼Œå¹¶ä¸”è¿™ä¸ª Bean é€‚é…äº ConversionService ç±»å‹</span><br>    <span class="hljs-keyword">if</span> (beanFactory.<span class="hljs-built_in">containsBean</span>(<span class="hljs-string">&quot;conversionService&quot;</span>) &amp;&amp; beanFactory.<span class="hljs-built_in">isTypeMatch</span>(<span class="hljs-string">&quot;conversionService&quot;</span>, ConversionService.<span class="hljs-keyword">class</span>)) &#123;<br>        <span class="hljs-comment">// å°†è¿™ä¸ª Bean è®¾ç½®ä¸ºå®¹å™¨çš„ ConversionService</span><br>        beanFactory.<span class="hljs-built_in">setConversionService</span>((ConversionService)beanFactory.<span class="hljs-built_in">getBean</span>(<span class="hljs-string">&quot;conversionService&quot;</span>, ConversionService.<span class="hljs-keyword">class</span>));<br>    &#125;<br><br>    <span class="hljs-comment">// å¦‚æœ BeanFactory è¿˜æ²¡æœ‰åµŒå…¥çš„å€¼è§£æå™¨</span><br>    <span class="hljs-keyword">if</span> (!beanFactory.<span class="hljs-built_in">hasEmbeddedValueResolver</span>()) &#123;<br>        <span class="hljs-comment">// æ·»åŠ ä¸€ä¸ªåµŒå…¥çš„å€¼è§£æå™¨ï¼Œç”¨äºè§£æå ä½ç¬¦</span><br>        beanFactory.<span class="hljs-built_in">addEmbeddedValueResolver</span>(strVal -&gt; &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.<span class="hljs-built_in">getEnvironment</span>().<span class="hljs-built_in">resolvePlaceholders</span>(strVal);<br>        &#125;);<br>    &#125;<br><br>    <span class="hljs-comment">// è·å–æ‰€æœ‰å®ç° LoadTimeWeaverAware æ¥å£çš„ Bean çš„åç§°</span><br>    <span class="hljs-type">String</span>[] weaverAwareNames = beanFactory.<span class="hljs-built_in">getBeanNamesForType</span>(LoadTimeWeaverAware.<span class="hljs-keyword">class</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>);<br>    <br>    <span class="hljs-comment">// éå†è¿™äº› Bean åç§°</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">String</span> weaverAwareName : weaverAwareNames) &#123;<br>        <span class="hljs-comment">// åˆå§‹åŒ–ç›¸åº”çš„ Beanï¼Œä»¥ç¡®ä¿å®ƒä»¬èƒ½å¤Ÿæ‰§è¡ŒåŠ è½½æ—¶ç»‡å…¥ï¼ˆLoad Time Weavingï¼‰çš„ç›¸å…³é€»è¾‘</span><br>        <span class="hljs-keyword">this</span>.<span class="hljs-built_in">getBean</span>(weaverAwareName);<br>    &#125;<br><br>    <span class="hljs-comment">// å°† BeanFactory çš„ä¸´æ—¶ç±»åŠ è½½å™¨è®¾ç½®ä¸º null</span><br>    beanFactory.<span class="hljs-built_in">setTempClassLoader</span>(null);<br><br>    <span class="hljs-comment">// å†»ç»“æ‰€æœ‰çš„ Bean å®šä¹‰ï¼Œè¡¨ç¤ºæ³¨å†Œçš„ Bean å®šä¹‰å°†ä¸å†è¢«ä¿®æ”¹æˆ–ä»»ä½•è¿›ä¸€æ­¥çš„å¤„ç†</span><br>    beanFactory.<span class="hljs-built_in">freezeConfiguration</span>();<br><br>    <span class="hljs-comment">// é¢„å®ä¾‹åŒ–å•ä¾‹ï¼Œç¡®ä¿æ‰€æœ‰éæ‡’åŠ è½½çš„å•ä¾‹éƒ½è¢«å®ä¾‹åŒ–</span><br>    beanFactory.<span class="hljs-built_in">preInstantiateSingletons</span>();<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>å®ä¾‹åŒ– Instantiation</p></blockquote><p>å…¶ä¸­ç¬¬ä¸€é˜¶æ®µ â€”â€” å®ä¾‹åŒ– Instantiationï¼Œ</p><p>Bean å®ä¾‹åŒ–çš„æ—¶æœºåˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§æ˜¯ BeanFactoryï¼Œè¿˜æœ‰ä¸€ç§æ˜¯  ApplicationContextï¼›</p><p>ä¸‹é¢æ˜¯ä¸¤è€…å·®åˆ«ï¼š</p><ul><li>BeanFactory<ul><li>å…¶ä¸‹ç®¡ç†çš„Bean <strong>åœ¨ä½¿ç”¨åˆ°Beançš„æ—¶å€™</strong> æ‰ä¼šè¿›è¡Œå®ä¾‹åŒ–Beanæ“ä½œï¼ˆæ‡’åŠ è½½ç­–ç•¥ï¼‰</li></ul></li><li>ApplicationContext  <ul><li>å…¶ä¸‹ç®¡ç†çš„ Bean <strong>åœ¨IOCå®¹å™¨åˆå§‹åŒ–</strong>çš„æ—¶å€™å®Œæˆ Bean å®ä¾‹åŒ–ã€‚</li><li><code>ApplicationContext</code>æ˜¯<code>BeanFactory</code>çš„å­æ¥å£ï¼Œå¤æ‚ç¨‹åº¦æ›´é«˜ä¸€äº›ã€‚</li><li>å¦‚<code>AnnotationConfigApplicationContext</code>å’Œ<code>ClassPathXmlApplicationContext</code>ç­‰ï¼Œæä¾›äº†å¤šç§æ–¹ä¾¿çš„æ–¹å¼æ¥åˆ›å»ºApplicationContextå®ä¾‹</li></ul></li></ul><hr><p>è§†é¢‘åœ°å€ï¼š  <a href="https://www.bilibili.com/video/BV1584y1r7n6/">https://www.bilibili.com/video/BV1584y1r7n6/</a></p><h4 id="Spring-Bean-çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#Spring-Bean-çš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Spring Bean çš„ç”Ÿå‘½å‘¨æœŸ"></a>Spring Bean çš„ç”Ÿå‘½å‘¨æœŸ</h4><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231218215844.png" alt="image.png"></p><p>ç”Ÿäº§ â†’  ä½¿ç”¨  â†’  é”€æ¯</p><h5 id="ç”Ÿäº§"><a href="#ç”Ÿäº§" class="headerlink" title="ç”Ÿäº§"></a>ç”Ÿäº§</h5><p>å¯åŠ¨ï¼Œå‡†å¤‡å®¹å™¨&#x2F;ç¯å¢ƒç­‰</p><p>â‘  åŠ è½½ Bean å®šä¹‰ï¼ˆBeanDefinitions)</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs stylus">åŠ è½½Beanå®šä¹‰<br><br><span class="hljs-function"><span class="hljs-title">run</span><span class="hljs-params">()</span></span><br>â†’<br><span class="hljs-function"><span class="hljs-title">refreshContext</span><span class="hljs-params">()</span></span><br>â†’ <br><span class="hljs-function"><span class="hljs-title">refresh</span><span class="hljs-params">()</span></span><br>â†’ <br><span class="hljs-function"><span class="hljs-title">obtainFreshBeanFactory</span><span class="hljs-params">()</span></span><br>â†’<br><span class="hljs-function"><span class="hljs-title">refreshBeanFactory</span><span class="hljs-params">()</span></span><br>â†’<br><span class="hljs-function"><span class="hljs-title">loadBeanDefinitions</span><span class="hljs-params">()</span></span><br></code></pre></td></tr></table></figure><p>é€šè¿‡ loadBeanDefinitions æ‰«ææ‰€æœ‰xmlé…ç½®ã€æ³¨è§£å°†Beanè®°å½•åœ¨ Beanå®šä¹‰é›†åˆ beanDefinitionMap ä¸­</p><p>â‘¡åˆ›å»º Bean å¯¹è±¡ï¼ˆcreateBean)</p><p>éå†â€œBeanå®šä¹‰â€é›†åˆ</p><p>é€šè¿‡ createBean éå† beanDefinitionMap åˆ›å»ºbean</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs stylus">åˆ›å»ºBean<br><br><span class="hljs-function"><span class="hljs-title">run</span><span class="hljs-params">()</span></span><br>â†’<br><span class="hljs-function"><span class="hljs-title">refreshContext</span><span class="hljs-params">()</span></span><br>â†’ <br><span class="hljs-function"><span class="hljs-title">refresh</span><span class="hljs-params">()</span></span><br>â†’ <br><span class="hljs-function"><span class="hljs-title">finishBeanFactoryInitialization</span><span class="hljs-params">()</span></span><br>â†’<br><span class="hljs-function"><span class="hljs-title">preInstantiateSingletioins</span><span class="hljs-params">()</span></span><br>â†’<br><span class="hljs-function"><span class="hljs-title">doGetBean</span><span class="hljs-params">()</span></span><br>â†’<br><span class="hljs-function"><span class="hljs-title">createBean</span><span class="hljs-params">()</span></span><br></code></pre></td></tr></table></figure><blockquote><p>2.1.æ„é€ å¯¹è±¡</p></blockquote><p>é€šè¿‡ createBeanInstance æ–¹æ³•è¿›è¡Œå¯¹è±¡çš„æ„é€ </p><p>ä½¿ç”¨åå°„æœºåˆ¶ä»â€œBeanå®šä¹‰â€ä¸­çš„BeanClassæ‹¿åˆ°ç±»çš„æ„é€ æ–¹æ³•</p><p>å‡†å¤‡å‚æ•°ï¼šåœ¨å•ä¾‹æ± ä¸­ï¼Œæ ¹æ®å‚æ•°çš„Classç±»è¿›è¡ŒæŸ¥æ‰¾</p><p>æ„é€ å¯¹è±¡ï¼šé€šè¿‡åå°„è¿›è¡ŒBeançš„æ„é€ ï¼ˆå¦‚æœæ˜¯æ— å‚åˆ™æ— éœ€å‡†å¤‡å‚æ•°ç›´æ¥æ„é€ ï¼‰</p><hr><p>æŸ¥æ‰¾Classç±»<br>    å½“åŒ¹é…åˆ°å¤šä¸ªå®ä¾‹ï¼Œ<br>    ä¼šå†æ ¹æ®å‚æ•°åè¿›è¡ŒåŒ¹é…</p><blockquote><p>2.2.å¡«å……å±æ€§</p></blockquote><p>é€šè¿‡ populateBean æ–¹æ³•å¯¹ Bean å†…éƒ¨æ‰€éœ€å±æ€§è¿›è¡Œå±æ€§å¡«å……, é€šå¸¸æ˜¯ @Autowired æ³¨è§£çš„å˜é‡</p><p>ä¸‰çº§ç¼“å­˜è¿›è¡Œä¾èµ–æ³¨å…¥</p><blockquote><p>2.3.åˆå§‹åŒ–å®ä¾‹</p></blockquote><p>é€šè¿‡ initializeBean æ–¹æ³•å¯¹å®ä¾‹è¿›è¡Œåˆå§‹åŒ–</p><p>åˆå§‹åŒ–æ“ä½œï¼š</p><ol><li>åˆå§‹åŒ–å®¹å™¨ç›¸å…³ä¿¡æ¯<br>é€šè¿‡ invokeAwareMethods æ–¹æ³•ä¸ºå®ç°å„ç§ Aware æ¥å£çš„Beanè®¾ç½®è¯¸å¦‚ beanName, beanFactory ç­‰å®¹å™¨ä¿¡æ¯<br>Aware æ¥å£æŒ‡ä»£ï¼šä¿¡æ¯æ„ŸçŸ¥æ¥å£</li><li>é€šè¿‡ invokeInitMethods æ–¹æ³•æ‰§è¡Œ Bean çš„åˆå§‹åŒ–æ–¹æ³•</li></ol><p>è¯¥ invokeInitMethods æ–¹æ³•æ˜¯é€šè¿‡å®ç° InitializingBean æ¥å£è€Œå®ç°çš„ afterPropertiesSet æ–¹æ³•<br>ã€Beanå¡«å……å±æ€§åæ‰§è¡Œã€‘  ((InitializingBean)bean).afterPropertiesSet()</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs csharp">afterPropertiesSet <br><br>â†“ <br><br><span class="hljs-keyword">init</span>-Methods<br><br>â†“<br><br>BeanPostProcessors<br></code></pre></td></tr></table></figure><hr><h5 id="é”€æ¯æ“ä½œ"><a href="#é”€æ¯æ“ä½œ" class="headerlink" title="é”€æ¯æ“ä½œ"></a>é”€æ¯æ“ä½œ</h5><p>é”€æ¯æ“ä½œ<br>é”€æ¯å‰<br>    é”€æ¯ä¹‹å‰ä¼šæ‰§è¡Œ postProcessBeforeDestruction â€œé”€æ¯å‰å¤„ç†å™¨â€œï¼Œè¿™æ­¥ä¼šæ‰§è¡Œ Bean ä¸­ @PreDestroy æ³¨è§£çš„æ–¹æ³•<br>å®¹å™¨é”€æ¯<br>    åç»­é€šè¿‡ destoryBeans æ–¹æ³•é€ä¸€â€œé”€æ¯â€å®¹å™¨ä¸­çš„Beanï¼Œé”€æ¯çš„æ—¶å€™ä¼šæ‰§è¡Œ destroy æ–¹æ³•ï¼ˆé€šè¿‡registerDisposableBeanæ–¹æ³•æ³¨å†Œçš„Beanï¼Œè¯¥æ¥å£åªæœ‰ä¸€ä¸ªæ–¹æ³• destroyã€‚åœ¨Beané”€æ¯çš„æ—¶å€™ï¼ŒSpringå®¹å™¨ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚ï¼‰<br>Beanè‡ªå®šä¹‰é”€æ¯æ–¹æ³•<br>    â€œå®¢æˆ·é”€æ¯æ–¹æ³•â€invokeCustomDestroyMethod; â†’  æ‰§è¡ŒBeanä¸Šè‡ªå®šä¹‰çš„ destoryMethod æ–¹æ³•</p><h3 id="5ã€Spring-Bean-ç”Ÿå‘½å‘¨æœŸæµç¨‹å›¾"><a href="#5ã€Spring-Bean-ç”Ÿå‘½å‘¨æœŸæµç¨‹å›¾" class="headerlink" title="5ã€Spring Bean ç”Ÿå‘½å‘¨æœŸæµç¨‹å›¾"></a>5ã€<strong>Spring Bean ç”Ÿå‘½å‘¨æœŸæµç¨‹å›¾</strong></h3><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202312160247944.png" alt="image.png"></p><hr><p>å‚è€ƒ</p><ul><li><a href="https://docs.spring.io/spring-framework/reference/6.1-SNAPSHOT/core/beans.html">https://docs.spring.io/spring-framework/reference/6.1-SNAPSHOT/core/beans.html</a></li><li><a href="https://springdoc.cn/spring/core.html#spring-core">https://springdoc.cn/spring/core.html#spring-core</a></li><li><a href="https://www.bilibili.com/video/BV1584y1r7n6">https://www.bilibili.com/video/BV1584y1r7n6</a></li><li><a href="https://javaguide.cn/system-design/framework/spring/spring-knowledge-and-questions-summary.html">https://javaguide.cn/system-design/framework/spring/spring-knowledge-and-questions-summary.html</a></li><li><a href="https://blog.csdn.net/riemann_/article/details/118500805">https://blog.csdn.net/riemann_/article/details/118500805</a></li><li><a href="https://blog.csdn.net/qq_20021569/article/details/109178816">https://blog.csdn.net/qq_20021569/article/details/109178816</a></li><li><a href="https://gitee.com/moxi159753/LearningNotes/tree/master/%E6%A0%A1%E6%8B%9B%E9%9D%A2%E8%AF%95/Spring%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90">https://gitee.com/moxi159753/LearningNotes/tree/master/%E6%A0%A1%E6%8B%9B%E9%9D%A2%E8%AF%95/Spring%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90</a></li><li><a href="https://cloud.tencent.com/developer/article/2216932">https://cloud.tencent.com/developer/article/2216932</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>æ¡†æ¶</category>
      
      <category>Spring</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>spring</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MySQLå­¦ä¹ _æ€§èƒ½ä¼˜åŒ–</title>
    <link href="/2023/12/15/MySQL%E5%AD%A6%E4%B9%A0_%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    <url>/2023/12/15/MySQL%E5%AD%A6%E4%B9%A0_%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/</url>
    
    <content type="html"><![CDATA[<p>æ€§èƒ½ä¼˜åŒ–å‚è€ƒï¼š <a href="https://javaguide.cn/database/mysql/mysql-questions-01.html#mysql-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96">https://javaguide.cn/database/mysql/mysql-questions-01.html#mysql-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96</a></p><p>è§„èŒƒ</p><p>ç•¥</p><p>to be continedâ€¦.</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://javaguide.cn/database/mysql/mysql-high-performance-optimization-specification-recommendations.html">https://javaguide.cn/database/mysql/mysql-high-performance-optimization-specification-recommendations.html</a></li><li><a href="https://mp.weixin.qq.com/s/NM-aHaW6TXrnO6la6Jfl5A">https://mp.weixin.qq.com/s/NM-aHaW6TXrnO6la6Jfl5A</a></li><li><a href="https://mp.weixin.qq.com/s/XC8e5iuQtfsrEOERffEZ-Q">https://mp.weixin.qq.com/s/XC8e5iuQtfsrEOERffEZ-Q</a></li><li><a href="https://javaguide.cn/database/mysql/mysql-questions-01.html#mysql-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96">https://javaguide.cn/database/mysql/mysql-questions-01.html#mysql-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
      <category>MySQL</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mysql</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Springå­¦ä¹ _Spring_Beançš„ä½œç”¨åŸŸ</title>
    <link href="/2023/12/14/Spring%E5%AD%A6%E4%B9%A0_Spring_Bean%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F/"/>
    <url>/2023/12/14/Spring%E5%AD%A6%E4%B9%A0_Spring_Bean%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å¤ä¹ æ¦‚å¿µ</p></blockquote><blockquote><p>ä»€ä¹ˆæ˜¯ Spring Bean</p></blockquote><p>Bean ä»£æŒ‡çš„å°±æ˜¯é‚£äº›è¢« IoC å®¹å™¨æ‰€ç®¡ç†çš„å¯¹è±¡ã€‚</p><p>æˆ‘ä»¬éœ€è¦å‘Šè¯‰ IoC å®¹å™¨å¸®åŠ©æˆ‘ä»¬ç®¡ç†å“ªäº›å¯¹è±¡ï¼Œè¿™ä¸ªæ˜¯é€šè¿‡é…ç½®å…ƒæ•°æ®æ¥å®šä¹‰çš„ã€‚é…ç½®å…ƒæ•°æ®å¯ä»¥æ˜¯ XML æ–‡ä»¶ã€æ³¨è§£æˆ–è€… Java é…ç½®ç±»ã€‚</p><h3 id="Spring-ä¸­çš„-bean-çš„ä½œç”¨åŸŸæœ‰å“ªäº›"><a href="#Spring-ä¸­çš„-bean-çš„ä½œç”¨åŸŸæœ‰å“ªäº›" class="headerlink" title="Spring ä¸­çš„ bean çš„ä½œç”¨åŸŸæœ‰å“ªäº›"></a>Spring ä¸­çš„ bean çš„ä½œç”¨åŸŸæœ‰å“ªäº›</h3><p>è¿™ä¸ªé—®é¢˜æ˜¯é¢è¯•é¢˜åœºæ™¯çš„ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬é¦–å…ˆæ¥çœ‹ä¸€ä¸‹åŸºæœ¬çš„ä¸€ä¸ªå›ç­”ã€‚</p><p>Spring ä¸­ Bean çš„ä½œç”¨åŸŸé€šå¸¸æœ‰ä¸‹é¢å‡ ç§ï¼š</p><ul><li><strong>singleton</strong> : IoC å®¹å™¨ä¸­åªæœ‰å”¯ä¸€çš„ bean å®ä¾‹ã€‚Spring ä¸­çš„ bean é»˜è®¤éƒ½æ˜¯å•ä¾‹çš„ï¼Œæ˜¯å¯¹å•ä¾‹è®¾è®¡æ¨¡å¼çš„åº”ç”¨ã€‚</li><li><strong>prototype</strong> : æ¯æ¬¡è·å–éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ bean å®ä¾‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿ç»­ <code>getBean()</code> ä¸¤æ¬¡ï¼Œå¾—åˆ°çš„æ˜¯ä¸åŒçš„ Bean å®ä¾‹ã€‚</li><li><strong>request</strong> ï¼ˆä»… Web åº”ç”¨å¯ç”¨ï¼‰: æ¯ä¸€æ¬¡ HTTP è¯·æ±‚éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„ beanï¼ˆè¯·æ±‚ beanï¼‰ï¼Œè¯¥ bean ä»…åœ¨å½“å‰ HTTP request å†…æœ‰æ•ˆã€‚</li><li><strong>session</strong> ï¼ˆä»… Web åº”ç”¨å¯ç”¨ï¼‰ : æ¯ä¸€æ¬¡æ¥è‡ªæ–° session çš„ HTTP è¯·æ±‚éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„ beanï¼ˆä¼šè¯ beanï¼‰ï¼Œè¯¥ bean ä»…åœ¨å½“å‰ HTTP session å†…æœ‰æ•ˆã€‚</li><li><strong>application&#x2F;global-session</strong> ï¼ˆä»… Web åº”ç”¨å¯ç”¨ï¼‰ï¼šæ¯ä¸ª Web åº”ç”¨åœ¨å¯åŠ¨æ—¶åˆ›å»ºä¸€ä¸ª Beanï¼ˆåº”ç”¨ Beanï¼‰ï¼Œè¯¥ bean ä»…åœ¨å½“å‰åº”ç”¨å¯åŠ¨æ—¶é—´å†…æœ‰æ•ˆã€‚</li><li><strong>websocket</strong> ï¼ˆä»… Web åº”ç”¨å¯ç”¨ï¼‰ï¼šæ¯ä¸€æ¬¡ WebSocket ä¼šè¯äº§ç”Ÿä¸€ä¸ªæ–°çš„ beanã€‚</li></ul><blockquote><p>å¦‚ä½•é…ç½® bean çš„ä½œç”¨åŸŸ</p></blockquote><p>xml æ–¹å¼ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">&lt;bean <span class="hljs-attribute">id</span>=<span class="hljs-string">&quot;...&quot;</span> <span class="hljs-attribute">class</span>=<span class="hljs-string">&quot;...&quot;</span> <span class="hljs-attribute">scope</span>=<span class="hljs-string">&quot;singleton&quot;</span>&gt;&lt;/bean&gt;<br></code></pre></td></tr></table></figure><p>æ³¨è§£æ–¹å¼ï¼š</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@Bean</span><br><span class="hljs-variable">@Scope</span>(value = ConfigurableBeanFactory.SCOPE_PROTOTYPE)<br>public Person <span class="hljs-built_in">personPrototype</span>() &#123;<br>    <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">new</span> <span class="hljs-selector-tag">Person</span>();<br>&#125;<br></code></pre></td></tr></table></figure><p>å…·ä½“æ€ä¹ˆé…ç½®çš„çœ‹ä½ å®é™…ä½¿ç”¨ï¼Œè¿™é‡Œå¤§æ¦‚è®²ä¸€ä¸‹ä½¿ç”¨åœºæ™¯ï¼Œé€šè¿‡ä¸åŒåœºæ™¯ä¸‹çš„ä½¿ç”¨ç¤ºä¾‹å¯¹ Spring ä¸­ Bean çš„ä½œç”¨åŸŸæœ‰ä¸€ä¸ªåŸºæœ¬è®¤çŸ¥ã€‚</p><h4 id="Singleton-Beanï¼ˆé»˜è®¤ä½œç”¨åŸŸï¼‰"><a href="#Singleton-Beanï¼ˆé»˜è®¤ä½œç”¨åŸŸï¼‰" class="headerlink" title="Singleton Beanï¼ˆé»˜è®¤ä½œç”¨åŸŸï¼‰"></a>Singleton Beanï¼ˆé»˜è®¤ä½œç”¨åŸŸï¼‰</h4><p><strong>åœºæ™¯</strong>: åœ¨ä¸€ä¸ªåœ¨çº¿ä¹¦åº—åº”ç”¨ä¸­ï¼Œæœ‰ä¸€ä¸ªåº“å­˜ç®¡ç†æœåŠ¡è´Ÿè´£è·Ÿè¸ªæ‰€æœ‰ä¹¦ç±çš„åº“å­˜ã€‚è¿™ä¸ªæœåŠ¡éœ€è¦æ˜¯å•ä¾‹çš„ï¼Œå› ä¸ºå®ƒç»´æŠ¤ç€æ•´ä¸ªåº”ç”¨ä¸­ä¹¦ç±åº“å­˜çš„ç»Ÿä¸€è§†å›¾ã€‚</p><p>ä»£ç é€»è¾‘</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.springframework.stereotype.Service;<br><span class="hljs-keyword">import</span> java.util.Map;<br><span class="hljs-keyword">import</span> java.util.concurrent.ConcurrentHashMap;<br><br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InventoryService</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;String, Integer&gt; bookInventory = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addBook</span><span class="hljs-params">(String isbn, <span class="hljs-type">int</span> quantity)</span> &#123;<br>        bookInventory.put(isbn, bookInventory.getOrDefault(isbn, <span class="hljs-number">0</span>) + quantity);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">checkStock</span><span class="hljs-params">(String isbn)</span> &#123;<br>        <span class="hljs-keyword">return</span> bookInventory.getOrDefault(isbn, <span class="hljs-number">0</span>) &gt; <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// ... å…¶ä»–ä¸åº“å­˜ç®¡ç†ç›¸å…³çš„æ–¹æ³• ...</span><br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œï¼Œ<code>InventoryService</code> æ˜¯ä¸€ä¸ªsingletonä½œç”¨åŸŸçš„Beanï¼Œå®ƒåœ¨åº”ç”¨çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…åªä¼šæœ‰ä¸€ä¸ªå®ä¾‹ã€‚</p><p>æ‰€æœ‰å¯¹ä¹¦ç±åº“å­˜çš„æ“ä½œéƒ½é€šè¿‡è¿™ä¸ªå•ä¸€å®ä¾‹è¿›è¡Œï¼Œç¡®ä¿äº†åº“å­˜æ•°æ®çš„ä¸€è‡´æ€§ã€‚</p><h4 id="Prototypeä½œç”¨åŸŸ"><a href="#Prototypeä½œç”¨åŸŸ" class="headerlink" title="Prototypeä½œç”¨åŸŸ"></a>Prototypeä½œç”¨åŸŸ</h4><p><strong>åœºæ™¯</strong>: åœ¨åŒä¸€åœ¨çº¿ä¹¦åº—åº”ç”¨ä¸­ï¼Œå½“ç”¨æˆ·æƒ³è¦è´­ä¹°ä¹¦ç±æ—¶ï¼Œæ¯ä¸ªè´­ç‰©è½¦éƒ½åº”è¯¥æ˜¯ç‹¬ç«‹çš„ã€‚å› æ­¤ï¼Œæ¯ä¸ªç”¨æˆ·çš„è´­ç‰©è½¦åº”è¯¥æœ‰å…¶è‡ªå·±çš„çŠ¶æ€ã€‚</p><p>ä»£ç é€»è¾‘</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">context</span>.<span class="hljs-property">annotation</span>.<span class="hljs-property">Scope</span>;<br><span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">stereotype</span>.<span class="hljs-property">Component</span>;<br><br><span class="hljs-meta">@Component</span><br><span class="hljs-meta">@Scope</span>(<span class="hljs-string">&quot;prototype&quot;</span>)<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ShoppingCart</span> &#123;<br><br>    <span class="hljs-keyword">private</span> final <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Integer</span>&gt; items = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">addItem</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> isbn</span>) &#123;<br>        items.<span class="hljs-title function_">put</span>(isbn, items.<span class="hljs-title function_">getOrDefault</span>(isbn, <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Integer</span>&gt; <span class="hljs-title function_">getItems</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> items;<br>    &#125;<br><br>    <span class="hljs-comment">// ... è´­ç‰©è½¦çš„å…¶ä»–æ–¹æ³• ...</span><br>&#125;<br><br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ShoppingService</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">ApplicationContext</span> context;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">ShoppingCart</span> <span class="hljs-title function_">createNewShoppingCart</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> context.<span class="hljs-title function_">getBean</span>(<span class="hljs-title class_">ShoppingCart</span>.<span class="hljs-property">class</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œ<code>ShoppingService</code> ä½¿ç”¨Springçš„åº”ç”¨ä¸Šä¸‹æ–‡æ¥ä¸ºæ¯ä¸ªç”¨æˆ·åˆ›å»ºä¸€ä¸ªæ–°çš„<code>ShoppingCart</code>å®ä¾‹ã€‚</p><p>æ¯æ¬¡è°ƒç”¨<code>createNewShoppingCart</code>æ–¹æ³•æ—¶ï¼Œéƒ½ä¼šè¿”å›ä¸€ä¸ªå…¨æ–°çš„è´­ç‰©è½¦å®ä¾‹ï¼Œä¿è¯äº†ç”¨æˆ·ä¹‹é—´è´­ç‰©è½¦çš„éš”ç¦»ã€‚</p><h4 id="Requestä½œç”¨åŸŸ"><a href="#Requestä½œç”¨åŸŸ" class="headerlink" title="Requestä½œç”¨åŸŸ"></a>Requestä½œç”¨åŸŸ</h4><p><strong>åœºæ™¯</strong>: åœ¨ä¸€ä¸ªæ–°é—»ç½‘ç«™åº”ç”¨ä¸­ï¼Œä½ éœ€è¦è·Ÿè¸ªæ¯ä¸ªHTTPè¯·æ±‚çš„è®¿é—®ä¿¡æ¯ï¼Œä¾‹å¦‚ç”¨æˆ·çš„åœ°ç†ä½ç½®å’Œè®¾å¤‡ç±»å‹ï¼Œä»¥ä¾¿ä¸ºä»–ä»¬æä¾›å®šåˆ¶åŒ–çš„æ–°é—»å†…å®¹ã€‚</p><p>ä»£ç é€»è¾‘</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs haxe"><span class="hljs-keyword">import</span> org.springframework.web.context.annotation.RequestScope;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Component;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><br><span class="hljs-meta">@Component</span><br><span class="hljs-meta">@RequestScope</span><br><span class="hljs-keyword">public</span> <span class="hljs-title class_"><span class="hljs-keyword">class</span> <span class="hljs-title">UserContext</span> </span>&#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">String</span> location;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">String</span> deviceType;<br><br>    <span class="hljs-keyword">public</span> UserContext(HttpServletRequest request) &#123;<br>        <span class="hljs-comment">// é€šè¿‡è¯·æ±‚è·å–ç”¨æˆ·çš„ä½ç½®å’Œè®¾å¤‡ç±»å‹</span><br>        <span class="hljs-built_in">this</span>.location = request.getHeader(<span class="hljs-string">&quot;Location&quot;</span>);<br>        <span class="hljs-built_in">this</span>.deviceType = request.getHeader(<span class="hljs-string">&quot;Device-Type&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">String</span> getLocation() &#123;<br>        <span class="hljs-keyword">return</span> location;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">String</span> getDeviceType() &#123;<br>        <span class="hljs-keyword">return</span> deviceType;<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-title class_"><span class="hljs-keyword">class</span> <span class="hljs-title">NewsController</span> </span>&#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> UserContext userContext;<br><br>    <span class="hljs-meta">@GetMapping</span>(<span class="hljs-string">&quot;/news&quot;</span>)<br>    <span class="hljs-keyword">public</span> ResponseEntity&lt;List&lt;NewsItem&gt;&gt; getNews() &#123;<br>        List&lt;NewsItem&gt; <span class="hljs-keyword">new</span><span class="hljs-type">s</span> = <span class="hljs-keyword">new</span><span class="hljs-type">sService</span>.getNewsForLocation(userContext.getLocation());<br>        <span class="hljs-comment">// è¿”å›å®šåˆ¶åŒ–çš„æ–°é—»å†…å®¹</span><br>        <span class="hljs-keyword">return</span> ResponseEntity.ok(<span class="hljs-keyword">new</span><span class="hljs-type">s</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œ<code>UserContext</code>æ˜¯ä¸€ä¸ªrequestä½œç”¨åŸŸçš„Beanï¼Œå®ƒä¸ºæ¯ä¸ªHTTPè¯·æ±‚æä¾›äº†ä¸€ä¸ªæ–°å®ä¾‹ï¼Œ</p><p>åŒ…å«äº†è¯·æ±‚ç‰¹å®šçš„ç”¨æˆ·ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œå¦‚ä½ç½®å’Œè®¾å¤‡ç±»å‹ã€‚</p><h4 id="Sessionä½œç”¨åŸŸ"><a href="#Sessionä½œç”¨åŸŸ" class="headerlink" title="Sessionä½œç”¨åŸŸ"></a>Sessionä½œç”¨åŸŸ</h4><p><strong>åœºæ™¯</strong>: åœ¨ä¸€ä¸ªåœ¨çº¿è€ƒè¯•å¹³å°ä¸Šï¼Œæ¯ä¸ªç”¨æˆ·çš„è€ƒè¯•è¿‡ç¨‹éœ€è¦è¢«è¿½è¸ªã€‚ç”¨æˆ·å¯èƒ½ä¼šåœ¨è€ƒè¯•ä¸­æ–­åè¿”å›ç»§ç»­è€ƒè¯•ï¼Œæ‰€ä»¥è€ƒè¯•çŠ¶æ€éœ€è¦åœ¨ä¼šè¯ä¸­ä¿æŒã€‚</p><p>ä»£ç é€»è¾‘</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">import</span> org.springframework.web.context.<span class="hljs-keyword">annotation</span>.SessionScope;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Component;<br><br><span class="hljs-meta">@Component</span><br><span class="hljs-meta">@SessionScope</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ExamSession</span> &#123;<br><br>    <span class="hljs-keyword">private</span> Exam currentExam;<br>    <span class="hljs-keyword">private</span> int currentQuestionIndex;<br><br>    <span class="hljs-comment">// è€ƒè¯•ä¼šè¯çš„æ–¹æ³•ï¼Œä¾‹å¦‚å¼€å§‹è€ƒè¯•ã€å›ç­”é—®é¢˜ç­‰</span><br>&#125;<br><br><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ExamController</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> ExamSession examSession;<br><br>    <span class="hljs-meta">@PostMapping(<span class="hljs-string">&quot;/exam/start&quot;</span>)</span><br>    <span class="hljs-keyword">public</span> String startExam() &#123;<br>        examSession.startNewExam();<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;exam_started&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@PostMapping(<span class="hljs-string">&quot;/exam/answer&quot;</span>)</span><br>    <span class="hljs-keyword">public</span> String answerQuestion(Answer answer) &#123;<br>        examSession.answerQuestion(answer);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;answer_recorded&quot;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œ<code>ExamSession</code> æ˜¯ä¸€ä¸ªsessionä½œç”¨åŸŸçš„Beanï¼Œå®ƒè®°å½•äº†ç”¨æˆ·çš„å½“å‰è€ƒè¯•çŠ¶æ€ã€‚æ¯ä¸ªç”¨æˆ·ä¼šè¯éƒ½æœ‰è‡ªå·±çš„<code>ExamSession</code>å®ä¾‹ã€‚</p><blockquote><p>Session vs Global-Session vs WebSocket</p></blockquote><ol><li><strong>Session</strong>:<ul><li><strong>ä½œç”¨åŸŸ</strong>: é™å®šåœ¨ä¸€ä¸ªç”¨æˆ·çš„HTTPä¼šè¯ä¸­ã€‚</li><li><strong>å…¸å‹ç”¨ä¾‹</strong>: åœ¨ç”¨æˆ·ç™»å½•åˆ°ç½‘ç«™åï¼Œä½ å¯èƒ½éœ€è¦è·Ÿè¸ªè¯¥ç”¨æˆ·çš„ç‰¹å®šçŠ¶æ€ï¼ˆæ¯”å¦‚è´­ç‰©è½¦ã€åå¥½è®¾ç½®ç­‰ï¼‰ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½æœ‰è‡ªå·±çš„ä¼šè¯ï¼Œæ¯ä¸ªä¼šè¯éƒ½æœ‰è‡ªå·±çš„Beanå®ä¾‹ã€‚</li></ul></li><li><strong>Global-Session</strong>:<ul><li><strong>ä½œç”¨åŸŸ</strong>: é™å®šåœ¨Portletç¯å¢ƒçš„å…¨å±€HTTPä¼šè¯ä¸­ã€‚åœ¨Spring 5åŠä¹‹åçš„ç‰ˆæœ¬ä¸­å·²ä¸å†ä½¿ç”¨ï¼Œå› ä¸ºSpring 5ä¸å†æ”¯æŒPortletã€‚</li><li><strong>å…¸å‹ç”¨ä¾‹</strong>: åœ¨Portletç¯å¢ƒä¸­ï¼Œå¤šä¸ªPortletå¯èƒ½éœ€è¦å…±äº«å…¨å±€ä¼šè¯æ•°æ®ã€‚ä¾‹å¦‚ï¼Œç”¨æˆ·çš„è¯­è¨€åå¥½å¯èƒ½éœ€è¦è·¨å¤šä¸ªPortletä¿æŒä¸€è‡´ã€‚</li></ul></li><li><strong>WebSocket</strong>:<ul><li><strong>ä½œç”¨åŸŸ</strong>: ç»‘å®šåˆ°WebSocketçš„ä¼šè¯ä¸­ã€‚</li><li><strong>å…¸å‹ç”¨ä¾‹</strong>: å½“ç”¨æˆ·é€šè¿‡WebSocketè¿æ¥åˆ°ä½ çš„æœåŠ¡å™¨æ—¶ï¼Œä½ å¯èƒ½éœ€è¦ä¸ºæ¯ä¸ªWebSocketä¼šè¯ä¿å­˜çŠ¶æ€ï¼Œä¾‹å¦‚æ¸¸æˆä¸­çš„ç©å®¶çŠ¶æ€æˆ–èŠå¤©åº”ç”¨ä¸­çš„ç”¨æˆ·ä¼šè¯</li></ul></li></ol><h4 id="Singleton-vs-Prototype"><a href="#Singleton-vs-Prototype" class="headerlink" title="Singleton vs Prototype"></a>Singleton vs Prototype</h4><blockquote><p>Singleton vs Prototype</p></blockquote><ol><li><strong>Singleton</strong>:<ul><li><strong>æè¿°</strong>: åœ¨Spring IoCå®¹å™¨ä¸­åªåˆ›å»ºä¸€ä¸ªBeanå®ä¾‹ã€‚</li><li><strong>å…¸å‹ç”¨ä¾‹</strong>: å¤§å¤šæ•°æœåŠ¡å±‚å’Œæ•°æ®è®¿é—®å±‚çš„ç»„ä»¶éƒ½æ˜¯æ— çŠ¶æ€çš„ï¼Œå¯ä»¥è¢«åº”ç”¨ä¸­çš„æ‰€æœ‰å…¶ä»–Beanå…±äº«ã€‚ä¾‹å¦‚ï¼Œæ•°æ®åº“è¿æ¥æ± ã€ä¸šåŠ¡æœåŠ¡ç­‰ã€‚</li></ul></li><li><strong>Prototype</strong>:<ul><li><strong>æè¿°</strong>: æ¯æ¬¡è¯·æ±‚æ—¶ï¼ŒSpring IoCå®¹å™¨éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„Beanå®ä¾‹ã€‚</li><li><strong>å…¸å‹ç”¨ä¾‹</strong>: æ¯”å¦‚åœ¨ä¸€ä¸ªåº”ç”¨ä¸­ï¼Œä½ æƒ³è¦ä¸ºæ¯ä¸ªæ–‡ä»¶ä¸Šä¼ åˆ›å»ºä¸€ä¸ªæ–°çš„å¤„ç†å™¨ï¼ˆFileUploadHandlerï¼‰å®ä¾‹ï¼Œä»¥é˜²ä¸åŒç”¨æˆ·ä¸Šä¼ çš„æ•°æ®ç›¸äº’å†²çªã€‚</li></ul></li></ol><p>ä¸¤ç§ä½œç”¨åŸŸçš„ä½¿ç”¨ä¸»è¦å–å†³äºBeançš„çŠ¶æ€ç®¡ç†éœ€æ±‚ã€‚</p><p>Singletonç”¨äºé‚£äº›ä¸éœ€è¦ç»´æŠ¤çŠ¶æ€ä¿¡æ¯çš„å…±äº«ç»„ä»¶ï¼Œè€ŒPrototypeé€‚ç”¨äºæ¯æ¬¡ä½¿ç”¨éƒ½éœ€è¦ä¸€ä¸ªæ–°çŠ¶æ€çš„åœºæ™¯ã€‚</p><blockquote><p>Singleton vs Prototype   å¯¹æ¯”ä¸¤è€…çš„ç”Ÿå‘½å‘¨æœŸåŒºåˆ«</p></blockquote><p>å•ä¾‹Beançš„ç”Ÿå‘½å‘¨æœŸï¼š</p><ol><li><strong>å®ä¾‹åŒ–</strong>: åªæœ‰ä¸€ä¸ªBeanå®ä¾‹è¢«åˆ›å»ºã€‚</li><li><strong>å±æ€§å¡«å……</strong>: å®¹å™¨æ³¨å…¥ä¾èµ–çš„å±æ€§ã€‚</li><li><strong>åˆå§‹åŒ–</strong>: å¦‚æœBeanå®ç°äº†<code>InitializingBean</code>æ¥å£æˆ–å®šä¹‰äº†è‡ªå®šä¹‰çš„åˆå§‹åŒ–æ–¹æ³•ï¼ˆå¦‚ä½¿ç”¨<code>@PostConstruct</code>æ³¨è§£æˆ–åœ¨XMLé…ç½®ä¸­æŒ‡å®š<code>init-method</code>ï¼‰ï¼Œå°†ä¼šæ‰§è¡Œã€‚</li><li><strong>åå¤„ç†</strong>: <code>BeanPostProcessors</code>åœ¨åˆå§‹åŒ–å‰åæ‰§è¡Œã€‚</li><li><strong>ä½¿ç”¨</strong>: Beanç°åœ¨å¯ä»¥è¢«åº”ç”¨ä¸­çš„å…¶ä»–Beanä½¿ç”¨ã€‚</li><li><strong>é”€æ¯</strong>: å½“å®¹å™¨å…³é—­æ—¶ï¼Œå¦‚æœBeanå®ç°äº†<code>DisposableBean</code>æ¥å£æˆ–å®šä¹‰äº†è‡ªå®šä¹‰çš„é”€æ¯æ–¹æ³•ï¼ˆå¦‚ä½¿ç”¨<code>@PreDestroy</code>æ³¨è§£æˆ–åœ¨XMLé…ç½®ä¸­æŒ‡å®š<code>destroy-method</code>ï¼‰ï¼Œå°†ä¼šæ‰§è¡Œã€‚</li></ol><p>å¤šä¾‹Beançš„ç”Ÿå‘½å‘¨æœŸï¼š</p><ol><li><strong>å®ä¾‹åŒ–</strong>: æ¯æ¬¡è¯·æ±‚æ—¶éƒ½åˆ›å»ºä¸€ä¸ªæ–°çš„Beanå®ä¾‹ã€‚</li><li><strong>å±æ€§å¡«å……</strong>: å®¹å™¨æ³¨å…¥ä¾èµ–çš„å±æ€§ã€‚</li><li><strong>åˆå§‹åŒ–</strong>: ä¸å•ä¾‹Beanç›¸åŒï¼Œå¦‚æœæœ‰æŒ‡å®šçš„åˆå§‹åŒ–æ–¹æ³•ï¼Œå°†ä¼šæ‰§è¡Œã€‚</li><li><strong>åå¤„ç†</strong>: ä¸å•ä¾‹Beanç›¸åŒï¼Œ<code>BeanPostProcessors</code>åœ¨åˆå§‹åŒ–å‰åæ‰§è¡Œã€‚</li><li><strong>ä½¿ç”¨</strong>: Beanè¢«å®¢æˆ·ç«¯è·å–å¹¶ä½¿ç”¨ã€‚</li><li><strong>é”€æ¯</strong>: å®¹å™¨ä¸ä¼šç®¡ç†å¤šä¾‹Beançš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸï¼›é”€æ¯ç”±å®¢æˆ·ç«¯è´Ÿè´£ã€‚</li></ol><p>åŒºåˆ«ï¼š</p><ul><li><strong>å®ä¾‹åŒ–é¢‘ç‡</strong>:<ul><li><strong>å•ä¾‹</strong>: åªåœ¨Spring IoCå®¹å™¨åˆ›å»ºæ—¶å®ä¾‹åŒ–ä¸€æ¬¡ã€‚</li><li><strong>å¤šä¾‹</strong>: æ¯æ¬¡è¯·æ±‚æ—¶å®ä¾‹åŒ–ã€‚</li></ul></li><li><strong>ä¾èµ–æ³¨å…¥æ—¶æœº</strong>:<ul><li><strong>å•ä¾‹</strong>: ä¾èµ–é¡¹åœ¨å®¹å™¨åˆ›å»ºå•ä¾‹Beanæ—¶æ³¨å…¥ã€‚</li><li><strong>å¤šä¾‹</strong>: ä¾èµ–é¡¹åœ¨æ¯æ¬¡åˆ›å»ºæ–°å®ä¾‹æ—¶æ³¨å…¥ã€‚</li></ul></li><li><strong>ç”Ÿå‘½å‘¨æœŸç®¡ç†</strong>:<ul><li><strong>å•ä¾‹</strong>: å®¹å™¨è´Ÿè´£æ•´ä¸ªç”Ÿå‘½å‘¨æœŸï¼ŒåŒ…æ‹¬é”€æ¯ã€‚</li><li><strong>å¤šä¾‹</strong>: å®¹å™¨å¯åŠ¨åï¼Œä¸å†ç®¡ç†Beançš„ç”Ÿå‘½å‘¨æœŸï¼›Beançš„é”€æ¯ä¸ç”±Springå®¹å™¨ç®¡ç†ï¼Œéœ€è¦ç”¨æˆ·æ‰‹åŠ¨ç®¡ç†ã€‚</li></ul></li><li><strong>é”€æ¯å›è°ƒ</strong>:<ul><li><strong>å•ä¾‹</strong>: å®¹å™¨å…³é—­æ—¶ï¼Œå¯ä»¥è°ƒç”¨é”€æ¯æ–¹æ³•ã€‚</li><li><strong>å¤šä¾‹</strong>: å®¹å™¨ä¸è‡ªåŠ¨è°ƒç”¨é”€æ¯æ–¹æ³•ï¼Œå¿…é¡»ç”±è·å–Beançš„å®¢æˆ·ç«¯ä»£ç æ¥å¤„ç†ã€‚</li></ul></li></ul><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå•ä¾‹Beané€šå¸¸ç”¨äºæ— çŠ¶æ€çš„æœåŠ¡ï¼Œä¾‹å¦‚ä¸šåŠ¡é€»è¾‘ç»„ä»¶å’Œæ•°æ®è®¿é—®å¯¹è±¡ã€‚</p><p>è€Œå¤šä¾‹Beanåˆ™ç”¨äºæœ‰æ˜ç¡®çŠ¶æ€çš„æ“ä½œï¼Œè¿™äº›çŠ¶æ€ä¸èƒ½å…±äº«ç»™å…¶ä»–å®ä¾‹æˆ–çº¿ç¨‹ï¼Œä¾‹å¦‚ç”¨æˆ·çš„ä¼šè¯æˆ–ç‹¬ç«‹çš„ä»»åŠ¡å¤„ç†å™¨ã€‚</p><p>å¤šä¾‹Bean çš„é”€æ¯æ“ä½œæœ‰å…´è¶£å¯ä»¥äº†è§£ä¸€ä¸‹ï¼š <a href="https://springdoc.cn/spring/core.html#beans-factory-scopes-prototype">https://springdoc.cn/spring/core.html#beans-factory-scopes-prototype</a></p><blockquote><p>ä¸ºäº†è®©Springå®¹å™¨é‡Šæ”¾ç”± prototype scopeBean æŒæœ‰çš„èµ„æºï¼Œå¯ä»¥å°è¯•ä½¿ç”¨è‡ªå®šä¹‰Â <a href="https://springdoc.cn/spring/core.html#beans-factory-extension-bpp">Beanåå¤„ç†å™¨</a>ï¼Œå®ƒæŒæœ‰å¯¹éœ€è¦æ¸…ç†çš„Beançš„å¼•ç”¨ã€‚</p></blockquote><hr><p>å‚è€ƒ</p><ul><li><a href="https://springdoc.cn/spring/core.html#spring-core">https://springdoc.cn/spring/core.html#spring-core</a></li><li><a href="https://javaguide.cn/system-design/framework/spring/spring-knowledge-and-questions-summary.html#bean-%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F%E6%9C%89%E5%93%AA%E4%BA%9B">Springå¸¸è§é¢è¯•é¢˜æ€»ç»“ | JavaGuide(Javaé¢è¯• + å­¦ä¹ æŒ‡å—)</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>æ¡†æ¶</category>
      
      <category>Spring</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>spring</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Springå­¦ä¹ _IOC</title>
    <link href="/2023/12/14/Spring%E5%AD%A6%E4%B9%A0_IOC/"/>
    <url>/2023/12/14/Spring%E5%AD%A6%E4%B9%A0_IOC/</url>
    
    <content type="html"><![CDATA[<h3 id="1ã€IOCæ˜¯ä»€ä¹ˆ"><a href="#1ã€IOCæ˜¯ä»€ä¹ˆ" class="headerlink" title="1ã€IOCæ˜¯ä»€ä¹ˆ"></a>1ã€IOCæ˜¯ä»€ä¹ˆ</h3><p>IoC &amp; AOP ä¸æ˜¯ Spring æå‡ºæ¥çš„ï¼Œå®ƒä»¬åœ¨ Spring ä¹‹å‰å·²ç»å­˜åœ¨äº†ï¼Œåªä¸è¿‡å½“æ—¶æ›´åŠ åå‘äºç†è®ºã€‚Spring åœ¨æŠ€æœ¯å±‚æ¬¡å°†è¿™ä¸¤ä¸ªæ€æƒ³è¿›è¡Œäº†å¾ˆå¥½çš„å®ç°ã€‚</p><p>IOC ï¼ˆInversion of Control ï¼‰æŒ‡çš„æ˜¯æ§åˆ¶åè½¬&#x2F;åè½¬æ§åˆ¶ã€‚</p><blockquote><p>IOC ç†è®ºè¯´æ˜</p></blockquote><p>ä¾‹å¦‚ï¼šç°æœ‰ç±» A ä¾èµ–äºç±» B</p><ul><li>åœ¨ä¼ ç»Ÿçš„å¼€å‘æ–¹å¼ä¸­ï¼Œå¾€å¾€æ˜¯åœ¨ç±» A ä¸­æ‰‹åŠ¨é€šè¿‡ new å…³é”®å­—æ¥ new ä¸€ä¸ª B çš„å¯¹è±¡å‡ºæ¥</li><li>ä½¿ç”¨IOCæ€æƒ³çš„å¼€å‘æ–¹å¼ï¼šä¸é€šè¿‡ new å…³é”®å­—æ¥åˆ›å»ºå¯¹è±¡ï¼Œè€Œæ˜¯é€šè¿‡ IoC å®¹å™¨(Spring æ¡†æ¶) æ¥å¸®åŠ©æˆ‘ä»¬å®ä¾‹åŒ–å¯¹è±¡ã€‚æˆ‘ä»¬éœ€è¦å“ªä¸ªå¯¹è±¡ï¼Œç›´æ¥ä» IoC å®¹å™¨é‡Œé¢è·å–ã€‚</li></ul><p>æ§åˆ¶åè½¬ä¸»è¦æŒ‡çš„æ˜¯å°†å¯¹è±¡çš„åˆ›å»ºå’Œå¯¹è±¡ä¹‹é—´çš„å…³ç³»ç»´æŠ¤äº¤ç»™IOCå®¹å™¨å»ç®¡ç†ï¼Œè€Œä¸æ˜¯ç”±ç¨‹åºå‘˜æ‰‹åŠ¨è¿›è¡Œç®¡ç†ã€‚åœ¨ä¼ ç»Ÿçš„åº”ç”¨ä¸­ï¼Œå¯¹è±¡çš„åˆ›å»ºé€šå¸¸æ˜¯ç”±ç¨‹åºå‘˜é€šè¿‡<code>new</code>å…³é”®å­—æ¥å®Œæˆçš„ï¼Œè€Œå¯¹è±¡ä¹‹é—´çš„å…³ç³»ä¹Ÿéœ€è¦ç”±ç¨‹åºå‘˜è¿›è¡Œç¡¬ç¼–ç ã€‚</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202312051438413.png" alt="image.png"></p><ul><li><strong>æ§åˆ¶</strong>Â ï¼šæŒ‡çš„æ˜¯å¯¹è±¡åˆ›å»ºï¼ˆå®ä¾‹åŒ–ã€ç®¡ç†ï¼‰çš„æƒåŠ›</li><li><strong>åè½¬</strong>Â ï¼šæ§åˆ¶æƒäº¤ç»™å¤–éƒ¨ç¯å¢ƒï¼ˆIoC å®¹å™¨ï¼‰</li></ul><blockquote><p>IOC å’Œ DI  çš„å…³ç³»</p></blockquote><p>å…¶å®å®ƒä»¬æ˜¯åŒä¸€ä¸ªæ¦‚å¿µçš„ä¸åŒè§’åº¦æè¿°ï¼Œç”±äºæ§åˆ¶åè½¬æ¦‚å¿µæ¯”è¾ƒå«ç³Šï¼ˆå¯èƒ½åªæ˜¯ç†è§£ä¸ºå®¹å™¨æ§åˆ¶å¯¹è±¡è¿™ä¸€ä¸ªå±‚é¢ï¼Œå¾ˆéš¾è®©äººæƒ³åˆ°è°æ¥ç»´æŠ¤å¯¹è±¡å…³ç³»ï¼‰ï¼Œæ‰€ä»¥2004å¹´å¤§å¸ˆçº§äººç‰©Martin Fowleråˆç»™å‡ºäº†ä¸€ä¸ªæ–°çš„åå­—ï¼šâ€œä¾èµ–æ³¨å…¥â€ï¼Œç›¸å¯¹IoC è€Œè¨€ï¼Œâ€œä¾èµ–æ³¨å…¥â€æ˜ç¡®æè¿°äº†â€œè¢«æ³¨å…¥å¯¹è±¡ä¾èµ–IoCå®¹å™¨é…ç½®ä¾èµ–å¯¹è±¡â€ã€‚</p><p>é€šä¿—æ¥è¯´å°±æ˜¯<strong>IoCæ˜¯è®¾è®¡æ€æƒ³ï¼ŒDIæ˜¯å®ç°æ–¹å¼</strong>ã€‚</p><div style="background-color: #3498db; color: white; padding: 10px;">    IoCæ˜¯è®¾è®¡æ€æƒ³ï¼ŒDIæ˜¯å®ç°æ–¹å¼ã€‚</div><hr><blockquote><p>IOC å®¹å™¨</p></blockquote><p>åœ¨ Spring ä¸­ï¼Œ IoC å®¹å™¨æ˜¯ Spring ç”¨æ¥å®ç° IoC çš„è½½ä½“ï¼Œ IoC å®¹å™¨å®é™…ä¸Šå°±æ˜¯ä¸ª Mapï¼ˆkeyï¼Œvalueï¼‰ï¼ŒMap ä¸­å­˜æ”¾çš„æ˜¯å„ç§å¯¹è±¡ã€‚</p><p>Spring æ—¶ä»£æˆ‘ä»¬ä¸€èˆ¬é€šè¿‡ XML æ–‡ä»¶æ¥é…ç½® Beanï¼Œåæ¥å¼€å‘äººå‘˜è§‰å¾— XML æ–‡ä»¶æ¥é…ç½®ä¸å¤ªå¥½ï¼Œäºæ˜¯ SpringBoot æ³¨è§£é…ç½®å°±æ…¢æ…¢å¼€å§‹æµè¡Œèµ·æ¥ã€‚</p><blockquote><p>ä»€ä¹ˆæ˜¯ Spring Bean</p></blockquote><p>Bean ä»£æŒ‡çš„å°±æ˜¯é‚£äº›è¢« IoC å®¹å™¨æ‰€ç®¡ç†çš„å¯¹è±¡ã€‚</p><p>æˆ‘ä»¬éœ€è¦å‘Šè¯‰ IoC å®¹å™¨å¸®åŠ©æˆ‘ä»¬ç®¡ç†å“ªäº›å¯¹è±¡ï¼Œè¿™ä¸ªæ˜¯é€šè¿‡é…ç½®å…ƒæ•°æ®æ¥å®šä¹‰çš„ã€‚é…ç½®å…ƒæ•°æ®å¯ä»¥æ˜¯ XML æ–‡ä»¶ã€æ³¨è§£æˆ–è€… Java é…ç½®ç±»ã€‚</p><h3 id="2ã€IOC-é…ç½®çš„ä¸‰ç§æ–¹å¼"><a href="#2ã€IOC-é…ç½®çš„ä¸‰ç§æ–¹å¼" class="headerlink" title="2ã€IOC é…ç½®çš„ä¸‰ç§æ–¹å¼"></a>2ã€IOC é…ç½®çš„ä¸‰ç§æ–¹å¼</h3><div style="border: 1px solid #999; border-radius: 5px; padding: 10px;">    ä¸»æµæ–¹å¼æ˜¯Â æ³¨è§£ + Java é…ç½®.</div><p>Springæ¡†æ¶æä¾›äº†ä¸‰ç§ä¸»è¦çš„IoCé…ç½®æ–¹å¼ï¼šXMLé…ç½®ã€æ³¨è§£é…ç½®å’ŒJavaé…ç½®ã€‚å¼€å‘è€…å¯ä»¥é€‰æ‹©å…¶ä¸­ä¸€ç§æˆ–æ··åˆä½¿ç”¨è¿™äº›æ–¹å¼ï¼Œæ¥å£°æ˜å¯¹è±¡çš„ä¾èµ–å…³ç³»å’Œé…ç½®ä¿¡æ¯ã€‚</p><p>Springå®¹å™¨ä¼šæ ¹æ®è¿™äº›é…ç½®ä¿¡æ¯ï¼Œè‡ªåŠ¨æ‰«æå¹¶åŠ è½½æ‰€éœ€çš„å¯¹è±¡ï¼Œå®ç°å¯¹è±¡çš„åˆ›å»ºã€è£…é…å’Œç®¡ç†ã€‚</p><h4 id="xml-é…ç½®"><a href="#xml-é…ç½®" class="headerlink" title="xml é…ç½®"></a>xml é…ç½®</h4><p>é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å°†beançš„ä¿¡æ¯é…ç½®.xmlæ–‡ä»¶é‡Œï¼Œé€šè¿‡SpringåŠ è½½æ–‡ä»¶ä¸ºæˆ‘ä»¬åˆ›å»ºbeanã€‚</p><p>è¿™ç§æ–¹å¼å‡ºç°å¾ˆå¤šæ—©å‰çš„SSMé¡¹ç›®ä¸­ï¼Œå°†ç¬¬ä¸‰æ–¹ç±»åº“æˆ–è€…ä¸€äº›é…ç½®å·¥å…·ç±»éƒ½ä»¥è¿™ç§æ–¹å¼è¿›è¡Œé…ç½®ï¼Œä¸»è¦åŸå› æ˜¯ç”±äºç¬¬ä¸‰æ–¹ç±»ä¸æ”¯æŒSpringæ³¨è§£ã€‚</p><ul><li><strong>ä¼˜ç‚¹</strong>ï¼š å¯ä»¥ä½¿ç”¨äºä»»ä½•åœºæ™¯ï¼Œç»“æ„æ¸…æ™°ï¼Œé€šä¿—æ˜“æ‡‚</li><li><strong>ç¼ºç‚¹</strong>ï¼š é…ç½®ç¹çï¼Œä¸æ˜“ç»´æŠ¤ï¼Œæ¯ç‡¥æ— å‘³ï¼Œæ‰©å±•æ€§å·®</li></ul><p><strong>ä¸¾ä¾‹</strong>ï¼š</p><ol><li>é…ç½®xx.xmlæ–‡ä»¶</li><li>å£°æ˜å‘½åç©ºé—´å’Œé…ç½®bean</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans</span></span><br><span class="hljs-string"><span class="hljs-tag"> http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- services --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;userService&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;tech.pdai.springframework.service.UserServiceImpl&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;userDao&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;userDao&quot;</span>/&gt;</span><br>        <span class="hljs-comment">&lt;!-- additional collaborators and configuration for this bean go here --&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- more bean definitions for services go here --&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="Java-é…ç½®"><a href="#Java-é…ç½®" class="headerlink" title="Java é…ç½®"></a>Java é…ç½®</h4><p>å°†ç±»çš„åˆ›å»ºäº¤ç»™æˆ‘ä»¬é…ç½®çš„JavcConfigç±»æ¥å®Œæˆï¼ŒSpringåªè´Ÿè´£ç»´æŠ¤å’Œç®¡ç†ï¼Œé‡‡ç”¨çº¯Javaåˆ›å»ºæ–¹å¼ã€‚</p><p>å…¶æœ¬è´¨ä¸Šå°±æ˜¯æŠŠåœ¨XMLä¸Šçš„é…ç½®å£°æ˜è½¬ç§»åˆ°Javaé…ç½®ç±»ä¸­</p><ul><li><strong>ä¼˜ç‚¹</strong>ï¼šé€‚ç”¨äºä»»ä½•åœºæ™¯ï¼Œé…ç½®æ–¹ä¾¿ï¼Œå› ä¸ºæ˜¯çº¯Javaä»£ç ï¼Œæ‰©å±•æ€§é«˜ï¼Œååˆ†çµæ´»</li><li><strong>ç¼ºç‚¹</strong>ï¼šç”±äºæ˜¯é‡‡ç”¨Javaç±»çš„æ–¹å¼ï¼Œå£°æ˜ä¸æ˜æ˜¾ï¼Œå¦‚æœå¤§é‡é…ç½®ï¼Œå¯è¯»æ€§æ¯”è¾ƒå·®</li></ul><p><strong>ä¸¾ä¾‹</strong>ï¼š</p><ol><li>åˆ›å»ºä¸€ä¸ªé…ç½®ç±»ï¼Œ æ·»åŠ @Configurationæ³¨è§£å£°æ˜ä¸ºé…ç½®ç±»</li><li>åˆ›å»ºæ–¹æ³•ï¼Œæ–¹æ³•ä¸ŠåŠ ä¸Š@beanï¼Œè¯¥æ–¹æ³•ç”¨äºåˆ›å»ºå®ä¾‹å¹¶è¿”å›ï¼Œè¯¥å®ä¾‹åˆ›å»ºåä¼šäº¤ç»™springç®¡ç†ï¼Œæ–¹æ³•åå»ºè®®ä¸å®ä¾‹åç›¸åŒï¼ˆé¦–å­—æ¯å°å†™ï¼‰ã€‚æ³¨ï¼šå®ä¾‹ç±»ä¸éœ€è¦åŠ ä»»ä½•æ³¨è§£</li></ol><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> <span class="hljs-variable">pdai</span></span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BeansConfig</span> &#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> user dao</span><br><span class="hljs-comment">    */</span><br>    <span class="hljs-meta">@Bean</span>(<span class="hljs-string">&quot;userDao&quot;</span>)<br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">UserDaoImpl</span> <span class="hljs-title function_">userDao</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserDaoImpl</span>();<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> user service</span><br><span class="hljs-comment">    */</span><br>    <span class="hljs-meta">@Bean</span>(<span class="hljs-string">&quot;userService&quot;</span>)<br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">UserServiceImpl</span> <span class="hljs-title function_">userService</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title class_">UserServiceImpl</span> userService = <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserServiceImpl</span>();<br>        userService.<span class="hljs-title function_">setUserDao</span>(<span class="hljs-title function_">userDao</span>());<br>        <span class="hljs-keyword">return</span> userService;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="æ³¨è§£é…ç½®"><a href="#æ³¨è§£é…ç½®" class="headerlink" title="æ³¨è§£é…ç½®"></a>æ³¨è§£é…ç½®</h4><p>é€šè¿‡åœ¨ç±»ä¸ŠåŠ æ³¨è§£çš„æ–¹å¼ï¼Œæ¥å£°æ˜ä¸€ä¸ªç±»äº¤ç»™Springç®¡ç†ï¼ŒSpringä¼šè‡ªåŠ¨æ‰«æå¸¦æœ‰@Componentï¼Œ@Controllerï¼Œ@Serviceï¼Œ@Repositoryè¿™å››ä¸ªæ³¨è§£çš„ç±»ï¼Œç„¶åå¸®æˆ‘ä»¬åˆ›å»ºå¹¶ç®¡ç†ï¼Œå‰ææ˜¯éœ€è¦å…ˆé…ç½®Springçš„æ³¨è§£æ‰«æå™¨ã€‚</p><ul><li><strong>ä¼˜ç‚¹</strong>ï¼šå¼€å‘ä¾¿æ·ï¼Œé€šä¿—æ˜“æ‡‚ï¼Œæ–¹ä¾¿ç»´æŠ¤ã€‚</li><li><strong>ç¼ºç‚¹</strong>ï¼šå…·æœ‰å±€é™æ€§ï¼Œå¯¹äºä¸€äº›ç¬¬ä¸‰æ–¹èµ„æºï¼Œæ— æ³•æ·»åŠ æ³¨è§£ã€‚åªèƒ½é‡‡ç”¨XMLæˆ–JavaConfigçš„æ–¹å¼é…ç½®</li></ul><p><strong>ä¸¾ä¾‹</strong>ï¼š</p><ol><li>å¯¹ç±»æ·»åŠ @Componentç›¸å…³çš„æ³¨è§£ï¼Œæ¯”å¦‚@Controllerï¼Œ@Serviceï¼Œ@Repository</li><li>è®¾ç½®ComponentScançš„basePackage, æ¯”å¦‚<code>&lt;context:component-scan base-package=&#39;tech.pdai.springframework&#39;&gt;</code>, æˆ–è€…<code>@ComponentScan(&quot;tech.pdai.springframework&quot;)</code>æ³¨è§£ï¼Œæˆ–è€… <code>new AnnotationConfigApplicationContext(&quot;tech.pdai.springframework&quot;)</code>æŒ‡å®šæ‰«æçš„basePackage.<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs haxe"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * @author pdai</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-title class_"><span class="hljs-keyword">class</span> <span class="hljs-title">UserServiceImpl</span> </span>&#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * user dao impl.</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> UserDaoImpl userDao;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * find user list.</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * @return user list</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> List&lt;User&gt; findUserList() &#123;<br>        <span class="hljs-keyword">return</span> userDao.findUserList();<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure></li></ol><h3 id="3ã€ä¾èµ–æ³¨å…¥çš„ä¸‰ç§æ–¹å¼"><a href="#3ã€ä¾èµ–æ³¨å…¥çš„ä¸‰ç§æ–¹å¼" class="headerlink" title="3ã€ä¾èµ–æ³¨å…¥çš„ä¸‰ç§æ–¹å¼"></a>3ã€ä¾èµ–æ³¨å…¥çš„ä¸‰ç§æ–¹å¼</h3><p>å‚è€ƒçœ‹ä¸€ä¸‹è¿™ä¸ªï¼š <a href="https://zhuanlan.zhihu.com/p/557140781">https://zhuanlan.zhihu.com/p/557140781</a></p><p>ä¾èµ–æ³¨å…¥æœ‰ä¸‰ç§ä¸»è¦çš„å®ç°æ–¹å¼ï¼šå±æ€§æ³¨å…¥ã€Setteræ³¨å…¥å’Œæ„é€ æ–¹æ³•æ³¨å…¥ã€‚</p><p>å±æ€§æ³¨å…¥æœ€ç®€å•ï¼Œä½†é€šç”¨æ€§è¾ƒå·®ã€‚Springå®˜æ–¹æ¨èä½¿ç”¨æ„é€ æ–¹æ³•æ³¨å…¥ï¼Œå› ä¸ºå®ƒæ”¯æŒæ³¨å…¥ä¸å¯å˜å¯¹è±¡ï¼Œé€šç”¨æ€§æ›´å¼ºã€‚å¯¹äºå¯å˜å¯¹è±¡ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨Setteræ³¨å…¥ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹</strong></p><blockquote><ol><li>å±æ€§æ³¨å…¥ï¼ˆField Injectionï¼‰</li></ol></blockquote><p><strong>å±æ€§æ³¨å…¥æ˜¯æˆ‘ä»¬æœ€ç†Ÿæ‚‰ï¼Œä¹Ÿæ˜¯æ—¥å¸¸å¼€å‘ä¸­ä½¿ç”¨æœ€å¤šçš„ä¸€ç§æ³¨å…¥æ–¹å¼</strong>(ç›´æ¥åœ¨ç±»çš„å­—æ®µä¸Šæ³¨å…¥ä¾èµ–)</p><p>è¿™ç§æ–¹å¼åœ¨æŸäº›åœºæ™¯ä¸‹å¾ˆæ–¹ä¾¿ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´éš¾ä»¥æµ‹è¯•å’Œéš¾ä»¥ç»´æŠ¤çš„ä»£ç ï¼Œå› ä¸ºå®ƒéšè—äº†ç±»çš„ä¾èµ–ã€‚</p><p><strong>ç¤ºä¾‹ä»£ç </strong>:</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@Component</span><br>public class MyService &#123;<br><br>    <span class="hljs-variable">@Autowired</span><br>    private DependencyClass dependency;<br><br>    <span class="hljs-comment">// ... å…¶ä»–æ–¹æ³• ...</span><br>&#125;<br><br><span class="hljs-variable">@Component</span><br>public class DependencyClass &#123;<br>    <span class="hljs-comment">// ... ç±»çš„å®ç° ...</span><br>&#125;<br></code></pre></td></tr></table></figure><p>ä¼˜ç‚¹æ˜¯ç®€å•æ˜“ç”¨ï¼Œç¼ºç‚¹ä¹Ÿéšä¹‹è€Œæ¥</p><ol><li>åŠŸèƒ½æ€§é—®é¢˜ï¼šæ— æ³•æ³¨å…¥ä¸€ä¸ªä¸å¯å˜çš„å¯¹è±¡ï¼ˆfinal ä¿®é¥°çš„å¯¹è±¡ï¼‰ï¼›</li><li>é€šç”¨æ€§é—®é¢˜ï¼šåªèƒ½é€‚åº”äº IoC å®¹å™¨ï¼›</li><li>è®¾è®¡åŸåˆ™é—®é¢˜ï¼šæ›´å®¹æ˜“è¿èƒŒå•ä¸€è®¾è®¡åŸåˆ™ã€‚</li></ol><blockquote><ol start="2"><li>Setteræ³¨å…¥ï¼ˆSetter Injectionï¼‰</li></ol></blockquote><p>åœ¨Setteræ³¨å…¥ä¸­ï¼ŒSpringé€šè¿‡è°ƒç”¨ç±»çš„setteræ–¹æ³•æ¥æ³¨å…¥ä¾èµ–ã€‚</p><p><strong>ç¤ºä¾‹ä»£ç </strong>:</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyService</span> &#123;<br><br>    <span class="hljs-keyword">private</span> DependencyClass dependency;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">public</span> void setDependency(DependencyClass dependency) &#123;<br>        <span class="hljs-keyword">this</span>.dependency = dependency;<br>    &#125;<br><br>    <span class="hljs-comment">// ... å…¶ä»–æ–¹æ³• ...</span><br>&#125;<br><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DependencyClass</span> &#123;<br>    <span class="hljs-comment">// ... ç±»çš„å®ç° ...</span><br>&#125;<br></code></pre></td></tr></table></figure><p>setter çš„æ–¹å¼å¯èƒ½ä¼šéº»çƒ¦ä¸€ç‚¹ï¼Œä¸è¿‡ä»–æ˜¯å®Œå…¨ç¬¦åˆå•ä¸€èŒè´£çš„è®¾è®¡åŸåˆ™ï¼Œæ¯ä¸€ä¸ª Setter åªé’ˆå¯¹ä¸€ä¸ªå¯¹è±¡ã€‚</p><p>ç¼ºç‚¹ï¼š</p><ol><li>ä¸èƒ½æ³¨å…¥ä¸å¯å˜å¯¹è±¡ï¼ˆfinal ä¿®é¥°çš„å¯¹è±¡ï¼‰ï¼›</li><li>æ³¨å…¥çš„å¯¹è±¡å¯è¢«ä¿®æ”¹</li></ol><blockquote><ol start="3"><li>æ„é€ æ–¹æ³•æ³¨å…¥ï¼ˆConstructor Injectionï¼‰</li></ol></blockquote><p>è¿™ç§æ–¹å¼é€šè¿‡ç±»çš„æ„é€ æ–¹æ³•æ¥æ³¨å…¥ä¾èµ–ã€‚è¿™æ˜¯æœ€æ¨èçš„æ–¹å¼ï¼Œå› ä¸ºå®ƒå¯ä»¥ç¡®ä¿æ‰€éœ€çš„ä¾èµ–é¡¹åœ¨å¯¹è±¡åˆ›å»ºæ—¶å³è¢«æä¾›ï¼Œä»è€Œä¿è¯äº†å¯¹è±¡çš„ä¸å˜æ€§å’Œä¾èµ–çš„ä¸å¯æ›´æ”¹æ€§ã€‚</p><p><strong>ç¤ºä¾‹ä»£ç </strong>:</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyService</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> DependencyClass dependency;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">public</span> MyService(DependencyClass dependency) &#123;<br>        <span class="hljs-keyword">this</span>.dependency = dependency;<br>    &#125;<br><br>    <span class="hljs-comment">// ... å…¶ä»–æ–¹æ³• ...</span><br>&#125;<br><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DependencyClass</span> &#123;<br>    <span class="hljs-comment">// ... ç±»çš„å®ç° ...</span><br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>MyService</code> ç±»ä¾èµ–äº <code>DependencyClass</code>ã€‚</p><p>å½“Springåˆ›å»º <code>MyService</code> çš„å®ä¾‹æ—¶ï¼Œå®ƒä¼šæŸ¥æ‰¾ <code>DependencyClass</code> çš„å®ä¾‹å¹¶é€šè¿‡æ„é€ æ–¹æ³•æ³¨å…¥å®ƒã€‚</p><p>ä»Spring 4.3å¼€å§‹ï¼Œå½“ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªæ„é€ å‡½æ•°æ—¶ï¼Œ<code>@Autowired</code> æ³¨è§£æ˜¯å¯é€‰çš„(å¯ä»¥çœç•¥ï¼‰ã€‚Springä¼šè‡ªåŠ¨å°†è¿™ä¸ªå”¯ä¸€çš„æ„é€ å‡½æ•°ç”¨ä½œä¾èµ–æ³¨å…¥çš„å…¥å£ã€‚</p><p>ä¸Šé¢çš„ä»£ç å¯ä»¥ç®€åŒ–ä¸ºï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyService</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> DependencyClass dependency;<br><br>    <span class="hljs-keyword">public</span> MyService(DependencyClass dependency) &#123;<br>        <span class="hljs-keyword">this</span>.dependency = dependency;<br>    &#125;<br><br>    <span class="hljs-comment">// ... å…¶ä»–æ–¹æ³• ...</span><br>&#125;<br><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DependencyClass</span> &#123;<br>    <span class="hljs-comment">// ... ç±»çš„å®ç° ...</span><br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ç§å†™æ³•ç¬¦åˆâ€œçº¦å®šä¼˜äºé…ç½®â€çš„åŸåˆ™ï¼Œå‡å°‘äº†ä¸å¿…è¦çš„æ³¨è§£ä½¿ç”¨ã€‚</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://www.pdai.tech/md/spring/spring-x-framework-ioc.html">https://www.pdai.tech/md/spring/spring-x-framework-ioc.html</a></li><li><a href="https://javaguide.cn/system-design/framework/spring/ioc-and-aop.html">https://javaguide.cn/system-design/framework/spring/ioc-and-aop.html</a></li><li><a href="https://www.martinfowler.com/articles/injection.html">https://www.martinfowler.com/articles/injection.html</a></li><li><a href="https://www.iteye.com/blog/jinnianshilongnian-1413846">https://www.iteye.com/blog/jinnianshilongnian-1413846</a></li><li><a href="https://www.pdai.tech/md/spring/spring-x-framework-ioc.html#%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F">https://www.pdai.tech/md/spring/spring-x-framework-ioc.html#%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F</a></li><li><a href="https://zhuanlan.zhihu.com/p/557140781">https://zhuanlan.zhihu.com/p/557140781</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>æ¡†æ¶</category>
      
      <category>Spring</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>spring</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è˜‘è‡åšå®¢é¡¹ç›®_Day04</title>
    <link href="/2023/12/13/%E8%98%91%E8%8F%87%E5%8D%9A%E5%AE%A2%E9%A1%B9%E7%9B%AE_Day04/"/>
    <url>/2023/12/13/%E8%98%91%E8%8F%87%E5%8D%9A%E5%AE%A2%E9%A1%B9%E7%9B%AE_Day04/</url>
    
    <content type="html"><![CDATA[<p>ç»§ç»­è®²è¿°è˜‘è‡åšå®¢é‡Œé¢ä¸€äº›å†™æ³•çš„ä½¿ç”¨è¯´æ˜</p><p>è§£é‡Šä¸‹é¢è¿™æ®µä»£ç çš„ä½¿ç”¨</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@AvoidRepeatableCommit</span>  <br><span class="hljs-variable">@AuthorityVerify</span>  <br><span class="hljs-variable">@OperationLogger</span>(value = <span class="hljs-string">&quot;å¢åŠ åšå®¢&quot;</span>)  <br><span class="hljs-variable">@ApiOperation</span>(value = <span class="hljs-string">&quot;å¢åŠ åšå®¢&quot;</span>, notes = <span class="hljs-string">&quot;å¢åŠ åšå®¢&quot;</span>, response = String.class)  <br><span class="hljs-variable">@PostMapping</span>(<span class="hljs-string">&quot;/add&quot;</span>)  <br>public String <span class="hljs-built_in">add</span>(<span class="hljs-variable">@Validated</span>(&#123;Insert.class&#125;) <span class="hljs-variable">@RequestBody</span> BlogVO blogVO, BindingResult result) &#123;  <br>  <br>    <span class="hljs-comment">// å‚æ•°æ ¡éªŒ  </span><br>    <span class="hljs-selector-tag">ThrowableUtils</span><span class="hljs-selector-class">.checkParamArgument</span>(result);  <br>    <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">blogService</span><span class="hljs-selector-class">.addBlog</span>(blogVO);  <br>&#125;<br></code></pre></td></tr></table></figure><h3 id="1ã€è‡ªå®šä¹‰æ³¨è§£AvoidRepeatableCommitçš„ä½¿ç”¨"><a href="#1ã€è‡ªå®šä¹‰æ³¨è§£AvoidRepeatableCommitçš„ä½¿ç”¨" class="headerlink" title="1ã€è‡ªå®šä¹‰æ³¨è§£AvoidRepeatableCommitçš„ä½¿ç”¨"></a>1ã€è‡ªå®šä¹‰æ³¨è§£<code>AvoidRepeatableCommit</code>çš„ä½¿ç”¨</h3><p><code>@AvoidRepeatableCommit</code> æ³¨è§£ç”¨äºé˜²æ­¢ç”¨æˆ·åœ¨æŒ‡å®šæ—¶é—´å†…é‡å¤æäº¤è¡¨å•æˆ–è¯·æ±‚ã€‚</p><p>ä¸Spring AOPï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰ä¸€èµ·ä½¿ç”¨ï¼Œä»¥ä¾¿åœ¨æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡ŒæŸäº›é¢„å¤„ç†æ“ä½œã€‚</p><blockquote><p>è‡ªå®šä¹‰æ³¨è§£ AvoidRepeatableCommit</p></blockquote><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@Target</span>(ElementType.METHOD)<br><span class="hljs-variable">@Retention</span>(RetentionPolicy.RUNTIME)<br>public <span class="hljs-variable">@interface</span> AvoidRepeatableCommit &#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æŒ‡å®šæ—¶é—´å†…ä¸å¯é‡å¤æäº¤,å•ä½æ¯«ç§’ï¼Œé»˜è®¤1ç§’</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-selector-tag">long</span> <span class="hljs-selector-tag">timeout</span>() <span class="hljs-selector-tag">default</span> <span class="hljs-number">1000</span>;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><code>@Target(ElementType.METHOD)</code>: è¡¨æ˜è¿™ä¸ªæ³¨è§£åªèƒ½ç”¨äºæ–¹æ³•ã€‚</li><li><code>@Retention(RetentionPolicy.RUNTIME)</code>: è¡¨æ˜è¿™ä¸ªæ³¨è§£åœ¨è¿è¡Œæ—¶ä¿ç•™ï¼Œå¯ä»¥é€šè¿‡åå°„è¯»å–ã€‚</li><li><code>timeout()</code>: æ³¨è§£çš„å±æ€§ï¼Œè¡¨ç¤ºä¸å…è®¸é‡å¤æäº¤çš„æ—¶é—´çª—å£ï¼Œé»˜è®¤ä¸º1000æ¯«ç§’ï¼ˆ1ç§’ï¼‰ã€‚</li></ul><p>ä½¿ç”¨åœºæ™¯ï¼šåœ¨Spring MVCçš„æ§åˆ¶å™¨æ–¹æ³•ä¸Šä½¿ç”¨æ­¤æ³¨è§£ï¼Œé˜²æ­¢ç”¨æˆ·åœ¨çŸ­æ—¶é—´å†…é‡å¤æäº¤ç›¸åŒçš„è¯·æ±‚</p><blockquote><p>AvoidRepeatableCommitAspect åˆ‡é¢</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Aspect</span><br><span class="hljs-meta">@Component</span><br><span class="hljs-meta">@Slf4j</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AvoidRepeatableCommitAspect</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> RedisUtil redisUtil;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ç¯ç»•é€šçŸ¥ï¼Œç”¨äºå¤„ç†å¸¦æœ‰ <span class="hljs-doctag">@AvoidRepeatableCommit</span> æ³¨è§£çš„æ–¹æ³•ã€‚</span><br><span class="hljs-comment">     * é˜²æ­¢åŒä¸€ä¸ªç”¨æˆ·åœ¨æŒ‡å®šæ—¶é—´å†…é‡å¤æäº¤ç›¸åŒçš„è¯·æ±‚ã€‚</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> point åˆ‡ç‚¹ï¼Œæä¾›å¯¹è¿æ¥ç‚¹çš„è®¿é—®</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æ–¹æ³•æ‰§è¡Œçš„è¿”å›å€¼</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> Throwable å¯èƒ½æŠ›å‡ºçš„ä»»ä½•å¼‚å¸¸</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Around(&quot;@annotation(com.moxi.mogublog.admin.annotion.AvoidRepeatableCommit.AvoidRepeatableCommit)&quot;)</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">around</span><span class="hljs-params">(ProceedingJoinPoint point)</span> <span class="hljs-keyword">throws</span> Throwable &#123;<br>        <span class="hljs-type">HttpServletRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> RequestHolder.getRequest();<br><br>        <span class="hljs-comment">// è·å–è¯·æ±‚è€…çš„IPåœ°å€</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">ip</span> <span class="hljs-operator">=</span> IpUtils.getIpAddr(request);<br><br>        <span class="hljs-comment">// è·å–æ³¨è§£æ ‡è®°çš„æ–¹æ³•</span><br>        <span class="hljs-type">MethodSignature</span> <span class="hljs-variable">signature</span> <span class="hljs-operator">=</span> (MethodSignature) point.getSignature();<br>        <span class="hljs-type">Method</span> <span class="hljs-variable">method</span> <span class="hljs-operator">=</span> signature.getMethod();<br><br>        <span class="hljs-comment">// è·å–ç±»åå’Œæ–¹æ³•å</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">className</span> <span class="hljs-operator">=</span> method.getDeclaringClass().getName();<br>        <span class="hljs-type">String</span> <span class="hljs-variable">methodName</span> <span class="hljs-operator">=</span> method.getName();<br>        <span class="hljs-type">String</span> <span class="hljs-variable">ipKey</span> <span class="hljs-operator">=</span> String.format(<span class="hljs-string">&quot;%s#%s&quot;</span>, className, methodName);<br><br>        <span class="hljs-comment">// ç”ŸæˆåŸºäºIPå’Œæ–¹æ³•çš„å”¯ä¸€æ ‡è¯†</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">hashCode</span> <span class="hljs-operator">=</span> Math.abs(ipKey.hashCode());<br>        <span class="hljs-type">String</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> String.format(<span class="hljs-string">&quot;%s:%s_%d&quot;</span>, RedisConf.AVOID_REPEATABLE_COMMIT, ip, hashCode);<br>        log.info(<span class="hljs-string">&quot;ipKey=&#123;&#125;, hashCode=&#123;&#125;, key=&#123;&#125;&quot;</span>, ipKey, hashCode, key);<br><br>        <span class="hljs-type">AvoidRepeatableCommit</span> <span class="hljs-variable">avoidRepeatableCommit</span> <span class="hljs-operator">=</span> method.getAnnotation(AvoidRepeatableCommit.class);<br>        <span class="hljs-type">long</span> <span class="hljs-variable">timeout</span> <span class="hljs-operator">=</span> avoidRepeatableCommit.timeout();<br><br>        <span class="hljs-comment">// æ£€æŸ¥Redisä¸­æ˜¯å¦å·²å­˜åœ¨è¯¥è¯·æ±‚çš„æ ‡è®°</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> redisUtil.get(key);<br>        <span class="hljs-keyword">if</span> (StringUtils.isNotBlank(value)) &#123;<br>            log.info(<span class="hljs-string">&quot;è¯·å‹¿é‡å¤æäº¤è¡¨å•&quot;</span>);<br>            <span class="hljs-keyword">return</span> ResultUtil.result(SysConf.ERROR, <span class="hljs-string">&quot;è¯·å‹¿é‡å¤æäº¤è¡¨å•&quot;</span>);<br>        &#125;<br><br>        <span class="hljs-comment">// è®¾ç½®Redisæ ‡è®°ä»¥é˜²æ­¢åœ¨timeoutæ—¶é—´å†…é‡å¤æäº¤</span><br>        redisUtil.setEx(key, StringUtils.getUUID(), timeout, TimeUnit.MILLISECONDS);<br><br>        <span class="hljs-comment">// æ‰§è¡ŒåŸæ–¹æ³•</span><br>        <span class="hljs-keyword">return</span> point.proceed();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><code>@Around(&quot;@annotation(...AvoidRepeatableCommit)&quot;)</code>: è¡¨æ˜è¿™ä¸ªåˆ‡é¢çš„æ–¹æ³•ä¼šåœ¨æ‰€æœ‰æ ‡è®°æœ‰ <code>@AvoidRepeatableCommit</code> æ³¨è§£çš„æ–¹æ³•ä¹‹å‰æ‰§è¡Œã€‚</li><li>åˆ‡é¢çš„å®ç°é€»è¾‘æ˜¯ï¼šé¦–å…ˆæ£€æŸ¥Redisä¸­æ˜¯å¦å·²ç»å­˜å‚¨äº†é’ˆå¯¹è¯¥è¯·æ±‚çš„æ ‡è®°ã€‚å¦‚æœå­˜åœ¨ï¼Œè¡¨ç¤ºè¯¥è¯·æ±‚åœ¨æŒ‡å®šæ—¶é—´å†…å·²ç»æäº¤è¿‡ï¼Œå› æ­¤æ‹’ç»é‡å¤æäº¤ã€‚å¦‚æœä¸å­˜åœ¨ï¼Œå…è®¸æ‰§è¡Œæ–¹æ³•ï¼Œå¹¶åœ¨Redisä¸­è®¾ç½®ä¸€ä¸ªæ ‡è®°ï¼Œä»¥é˜²æ­¢åœ¨æŒ‡å®šæ—¶é—´å†…çš„é‡å¤æäº¤ã€‚</li></ul><p>åœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼š</p><ol><li>é¦–å…ˆï¼Œå®ƒè·å–å½“å‰è¯·æ±‚çš„ <code>HttpServletRequest</code> å¯¹è±¡ï¼Œå¹¶ä»ä¸­æå–è¯·æ±‚è€…çš„IPåœ°å€ã€‚</li><li>ç„¶åï¼Œå®ƒè·å–äº†è¢« <code>@AvoidRepeatableCommit</code> æ³¨è§£çš„æ–¹æ³•çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç±»åå’Œæ–¹æ³•åï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªåŸºäºè¿™äº›ä¿¡æ¯å’ŒIPåœ°å€çš„å”¯ä¸€æ ‡è¯†ã€‚</li><li>æ¥ç€ï¼Œå®ƒæ£€æŸ¥Redisç¼“å­˜ä¸­æ˜¯å¦å·²ç»å­˜åœ¨è¿™ä¸ªè¯·æ±‚çš„æ ‡è®°ã€‚å¦‚æœå­˜åœ¨ï¼Œè¡¨ç¤ºåœ¨æŒ‡å®šçš„æ—¶é—´çª—å£å†…è¯¥è¯·æ±‚å·²ç»æäº¤è¿‡ï¼Œå› æ­¤è¿”å›ä¸€ä¸ªé”™è¯¯ä¿¡æ¯ï¼Œé˜²æ­¢é‡å¤å¤„ç†ç›¸åŒçš„è¯·æ±‚ã€‚</li><li>å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™å°†è¯¥è¯·æ±‚çš„æ ‡è®°å­˜å‚¨åˆ°Redisä¸­ï¼Œå¹¶è®¾ç½®è¿‡æœŸæ—¶é—´ä¸ºæ³¨è§£ä¸­æŒ‡å®šçš„ <code>timeout</code>ã€‚è¿™æ ·ï¼Œå¦‚æœåœ¨ <code>timeout</code> æ—¶é—´å†…å†æ¬¡æ”¶åˆ°ç›¸åŒçš„è¯·æ±‚ï¼Œå°±ä¼šè¢«æ‹¦æˆªã€‚</li><li>æœ€åï¼Œå®ƒæ‰§è¡ŒåŸæ¥æ ‡è®°äº† <code>@AvoidRepeatableCommit</code> æ³¨è§£çš„æ–¹æ³•ã€‚</li></ol><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œ<code>AvoidRepeatableCommitAspect</code> åˆ‡é¢æœ‰æ•ˆåœ°é˜²æ­¢äº†åœ¨çŸ­æ—¶é—´å†…å¯¹åŒä¸€æ–¹æ³•çš„é‡å¤è°ƒç”¨ï¼Œç‰¹åˆ«æ˜¯å¯¹äºé˜²æ­¢è¡¨å•çš„é‡å¤æäº¤éå¸¸æœ‰æ•ˆã€‚</p><h3 id="2ã€è‡ªå®šä¹‰æ³¨è§£-OperationLogger-çš„ä½¿ç”¨"><a href="#2ã€è‡ªå®šä¹‰æ³¨è§£-OperationLogger-çš„ä½¿ç”¨" class="headerlink" title="2ã€è‡ªå®šä¹‰æ³¨è§£ OperationLogger çš„ä½¿ç”¨"></a>2ã€è‡ªå®šä¹‰æ³¨è§£ <code>OperationLogger</code> çš„ä½¿ç”¨</h3><p><code>@OperationLogger</code> æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰æ³¨è§£ï¼Œç”¨äºè®°å½•æ“ä½œæ—¥å¿—ã€‚ç»“åˆSpring AOPï¼Œåœ¨æ–¹æ³•æ‰§è¡Œå‰åæ·»åŠ æ—¥å¿—è®°å½•çš„é€»è¾‘ã€‚</p><h4 id="è‡ªå®šä¹‰æ³¨è§£"><a href="#è‡ªå®šä¹‰æ³¨è§£" class="headerlink" title="è‡ªå®šä¹‰æ³¨è§£"></a>è‡ªå®šä¹‰æ³¨è§£</h4><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-keyword">@Target</span>(ElementType.METHOD)<br><span class="hljs-keyword">@Retention</span>(RetentionPolicy.RUNTIME)<br>public <span class="hljs-keyword">@interface</span> OperationLogger &#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ä¸šåŠ¡åç§°ã€‚</span><br><span class="hljs-comment">     */</span><br>    String <span class="hljs-built_in">value</span>() default &quot;&quot;;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å¹³å°</span><br><span class="hljs-comment">     */</span><br>    PlatformEnum <span class="hljs-built_in">platform</span>() default PlatformEnum<span class="hljs-selector-class">.ADMIN</span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ˜¯å¦å°†å½“å‰æ—¥å¿—è®°å½•åˆ°æ•°æ®åº“ä¸­ã€‚</span><br><span class="hljs-comment">     */</span><br>    boolean <span class="hljs-built_in">save</span>() default true;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><code>@Target(ElementType.METHOD)</code>: è¡¨ç¤ºè¯¥æ³¨è§£åªèƒ½ç”¨äºæ–¹æ³•ã€‚</li><li><code>@Retention(RetentionPolicy.RUNTIME)</code>: è¡¨ç¤ºè¯¥æ³¨è§£åœ¨è¿è¡Œæ—¶æœ‰æ•ˆï¼Œå¯ä»¥é€šè¿‡åå°„è·å–ã€‚</li><li><code>value()</code>: æä¾›ä¸šåŠ¡åç§°ï¼Œé»˜è®¤ä¸ºç©ºã€‚</li><li><code>platform()</code>: æŒ‡å®šæ“ä½œå‘ç”Ÿçš„å¹³å°ï¼Œé»˜è®¤ä¸º <code>ADMIN</code>ã€‚</li><li><code>save()</code>: æŒ‡ç¤ºæ˜¯å¦å°†æ—¥å¿—è®°å½•ä¿å­˜åˆ°æ•°æ®åº“ï¼Œé»˜è®¤ä¸º <code>true</code>ã€‚</li></ul><h4 id="LoggerAspect"><a href="#LoggerAspect" class="headerlink" title="LoggerAspect"></a>LoggerAspect</h4><p><code>LoggerAspect</code> æ˜¯ä¸€ä¸ªåˆ‡é¢ç±»ï¼Œç”¨äºå¤„ç†å¸¦æœ‰ <code>@OperationLogger</code> æ³¨è§£çš„æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Aspect</span><br><span class="hljs-meta">@Component</span><br><span class="hljs-meta">@Slf4j</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LoggerAspect</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> RedisUtil redisUtil;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> ThreadPoolTaskExecutor threadPoolTaskExecutor;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å¼€å§‹æ—¶é—´ï¼Œç”¨äºè®¡ç®—æ–¹æ³•æ‰§è¡Œæ—¶é•¿</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> Date startTime;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å®šä¹‰åˆ‡ç‚¹ï¼ŒåŒ¹é…å¸¦æœ‰ <span class="hljs-doctag">@OperationLogger</span> æ³¨è§£çš„æ–¹æ³•</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> operationLogger è‡ªå®šä¹‰æ³¨è§£</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Pointcut(value = &quot;@annotation(operationLogger)&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">pointcut</span><span class="hljs-params">(OperationLogger operationLogger)</span> &#123;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ç¯ç»•é€šçŸ¥ï¼Œç”¨äºåœ¨æ–¹æ³•æ‰§è¡Œå‰åæ·»åŠ æ—¥å¿—è®°å½•é€»è¾‘</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> joinPoint åˆ‡ç‚¹ä¿¡æ¯</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> operationLogger è‡ªå®šä¹‰æ³¨è§£</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æ–¹æ³•æ‰§è¡Œç»“æœ</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> Throwable å¯èƒ½æŠ›å‡ºçš„ä»»ä½•å¼‚å¸¸</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Around(value = &quot;pointcut(operationLogger)&quot;)</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">doAround</span><span class="hljs-params">(ProceedingJoinPoint joinPoint, OperationLogger operationLogger)</span> <span class="hljs-keyword">throws</span> Throwable &#123;<br>        startTime = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>();<br>        <span class="hljs-comment">// æ‰§è¡ŒåŸæ–¹æ³•</span><br>        <span class="hljs-type">Object</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> joinPoint.proceed();<br><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">// æ—¥å¿—æ”¶é›†</span><br>            handle(joinPoint);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            log.error(<span class="hljs-string">&quot;æ—¥å¿—è®°å½•å‡ºé”™!&quot;</span>, e);<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ—¥å¿—å¤„ç†é€»è¾‘</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> point åˆ‡ç‚¹ä¿¡æ¯</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> Exception å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handle</span><span class="hljs-params">(ProceedingJoinPoint point)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-type">HttpServletRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> RequestHolder.getRequest();<br>        <span class="hljs-type">Method</span> <span class="hljs-variable">currentMethod</span> <span class="hljs-operator">=</span> AspectUtil.INSTANCE.getMethod(point);<br>        <span class="hljs-type">OperationLogger</span> <span class="hljs-variable">annotation</span> <span class="hljs-operator">=</span> currentMethod.getAnnotation(OperationLogger.class);<br><br>        <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦éœ€è¦ä¿å­˜æ—¥å¿—</span><br>        <span class="hljs-type">boolean</span> <span class="hljs-variable">save</span> <span class="hljs-operator">=</span> annotation.save();<br>        <span class="hljs-type">String</span> <span class="hljs-variable">bussinessName</span> <span class="hljs-operator">=</span> AspectUtil.INSTANCE.parseParams(point.getArgs(), annotation.value());<br>        <span class="hljs-type">String</span> <span class="hljs-variable">ua</span> <span class="hljs-operator">=</span> RequestUtil.getUa();<br>        log.info(<span class="hljs-string">&quot;&#123;&#125; | &#123;&#125; - &#123;&#125; &#123;&#125; - &#123;&#125;&quot;</span>, bussinessName, IpUtils.getIpAddr(request), RequestUtil.getMethod(), RequestUtil.getRequestUrl(), ua);<br><br>        <span class="hljs-keyword">if</span> (!save) &#123;<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br><br>        <span class="hljs-comment">// è·å–å‚æ•°åç§°å’Œå€¼</span><br>        Map&lt;String, Object&gt; nameAndArgsMap = AopUtils.getFieldsName(point);<br>        <span class="hljs-type">SecurityUser</span> <span class="hljs-variable">securityUser</span> <span class="hljs-operator">=</span> (SecurityUser) SecurityContextHolder.getContext().getAuthentication().getPrincipal();<br>        <span class="hljs-type">String</span> <span class="hljs-variable">paramsJson</span> <span class="hljs-operator">=</span> JSONObject.toJSONString(nameAndArgsMap);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">type</span> <span class="hljs-operator">=</span> request.getMethod();<br>        <span class="hljs-type">String</span> <span class="hljs-variable">ip</span> <span class="hljs-operator">=</span> IpUtils.getIpAddr(request);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> request.getRequestURI();<br><br>        <span class="hljs-comment">// å¼‚æ­¥å­˜å‚¨æ—¥å¿—</span><br>        threadPoolTaskExecutor.execute(<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">SysLogHandle</span>(ip, type, url, securityUser, paramsJson, point.getTarget().getClass().getName(),<br>                        point.getSignature().getName(), bussinessName, startTime, redisUtil));<br>    &#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * åœ¨æ‰§è¡Œå¸¦æœ‰ <span class="hljs-doctag">@OperationLogger</span> æ³¨è§£çš„æ–¹æ³•æ—¶æŠ›å‡ºå¼‚å¸¸åæ‰§è¡Œçš„é€šçŸ¥ã€‚</span><br><span class="hljs-comment"> * ç”¨äºè®°å½•å¼‚å¸¸ä¿¡æ¯å’Œç›¸å…³æ“ä½œæ—¥å¿—ã€‚</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> joinPoint è¿æ¥ç‚¹ï¼Œæä¾›å¯¹ç›®æ ‡æ–¹æ³•çš„è®¿é—®</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> operationLogger æ“ä½œæ—¥å¿—çš„è‡ªå®šä¹‰æ³¨è§£</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> e æŠ›å‡ºçš„å¼‚å¸¸</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@throws</span> Exception å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@AfterThrowing(value = &quot;pointcut(operationLogger)&quot;, throwing = &quot;e&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doAfterThrowing</span><span class="hljs-params">(JoinPoint joinPoint, OperationLogger operationLogger, Throwable e)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br><br><span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªå¼‚å¸¸æ—¥å¿—å¯¹è±¡</span><br><span class="hljs-type">ExceptionLog</span> <span class="hljs-variable">exception</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ExceptionLog</span>();<br><span class="hljs-type">HttpServletRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> RequestHolder.getRequest();<br><br><span class="hljs-comment">// è·å–è¯·æ±‚IPåœ°å€</span><br><span class="hljs-type">String</span> <span class="hljs-variable">ip</span> <span class="hljs-operator">=</span> IpUtils.getIpAddr(request);<br>exception.setIp(ip);<br><br><span class="hljs-comment">// è§£ææ“ä½œåç§°</span><br><span class="hljs-type">String</span> <span class="hljs-variable">operationName</span> <span class="hljs-operator">=</span> AspectUtil.INSTANCE.parseParams(joinPoint.getArgs(), operationLogger.value());<br><br><span class="hljs-comment">// å°è¯•ä»Redisä¸­è·å–IPæ¥æºä¿¡æ¯</span><br><span class="hljs-type">String</span> <span class="hljs-variable">jsonResult</span> <span class="hljs-operator">=</span> redisUtil.get(RedisConf.IP_SOURCE + Constants.SYMBOL_COLON + ip);<br><span class="hljs-keyword">if</span> (StringUtils.isEmpty(jsonResult)) &#123;<br><span class="hljs-comment">// å¦‚æœRedisä¸­æ²¡æœ‰IPæ¥æºä¿¡æ¯ï¼Œåˆ™æŸ¥è¯¢å¹¶ä¿å­˜</span><br><span class="hljs-type">String</span> <span class="hljs-variable">addresses</span> <span class="hljs-operator">=</span> IpUtils.getAddresses(SysConf.IP + SysConf.EQUAL_TO + ip, SysConf.UTF_8);<br><span class="hljs-keyword">if</span> (StringUtils.isNotEmpty(addresses)) &#123;<br>exception.setIpSource(addresses);<br>redisUtil.setEx(RedisConf.IP_SOURCE + Constants.SYMBOL_COLON + ip, addresses, <span class="hljs-number">24</span>, TimeUnit.HOURS);<br>&#125;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br><span class="hljs-comment">// å¦‚æœRedisä¸­å·²æœ‰IPæ¥æºä¿¡æ¯ï¼Œç›´æ¥ä½¿ç”¨</span><br>exception.setIpSource(jsonResult);<br>&#125;<br><br><span class="hljs-comment">// è®¾ç½®å¼‚å¸¸æ—¥å¿—çš„å…¶ä»–ä¿¡æ¯</span><br>exception.setIp(ip);<br>exception.setMethod(joinPoint.getSignature().getName());<br>exception.setExceptionJson(JSON.toJSONString(e,<br>SerializerFeature.DisableCircularReferenceDetect,<br>SerializerFeature.WriteMapNullValue));<br>exception.setExceptionMessage(e.getMessage());<br>exception.setOperation(operationName);<br>exception.setCreateTime(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());<br>exception.setUpdateTime(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());<br><br><span class="hljs-comment">// å°†å¼‚å¸¸æ—¥å¿—ä¿å­˜åˆ°æ•°æ®åº“</span><br>exception.insert();<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h4 id="SysLogHandle-ç±»"><a href="#SysLogHandle-ç±»" class="headerlink" title="SysLogHandle ç±»"></a><code>SysLogHandle</code> ç±»</h4><p><code>SysLogHandle</code> æ˜¯ä¸€ä¸ªRunnableå®ç°ï¼Œç”¨äºå¼‚æ­¥è®°å½•æ—¥å¿—ä¿¡æ¯ã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SysLogHandle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">AbstractRequestAwareRunnable</span> &#123;<br><br>    <span class="hljs-comment">// Rediså·¥å…·ç±»ï¼Œç”¨äºæ“ä½œRedis</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">RedisUtil</span> redisUtil;<br><br>    <span class="hljs-comment">// è¯·æ±‚çš„å‚æ•°åˆ—è¡¨ï¼Œä»¥JSONå­—ç¬¦ä¸²æ ¼å¼ä¿å­˜</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> paramsJson;<br><br>    <span class="hljs-comment">// è¢«è°ƒç”¨çš„ç±»çš„å®Œæ•´è·¯å¾„</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> classPath;<br><br>    <span class="hljs-comment">// è¢«è°ƒç”¨çš„æ–¹æ³•åç§°</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> methodName;<br><br>    <span class="hljs-comment">// æ–¹æ³•è¯·æ±‚çš„å¼€å§‹æ—¶é—´</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">Date</span> startTime;<br><br>    <span class="hljs-comment">// æ“ä½œåç§°ï¼Œé€šå¸¸ä»æ³¨è§£ä¸­è·å–</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> operationName;<br><br>    <span class="hljs-comment">// è¯·æ±‚çš„IPåœ°å€</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> ip;<br><br>    <span class="hljs-comment">// è¯·æ±‚ç±»å‹ï¼ˆå¦‚GETã€POSTï¼‰</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> <span class="hljs-keyword">type</span>;<br><br>    <span class="hljs-comment">// è¯·æ±‚çš„URL</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> requestUrl;<br><br>    <span class="hljs-comment">// å½“å‰æ“ä½œçš„å®‰å…¨ç”¨æˆ·ä¿¡æ¯</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">SecurityUser</span> securityUser;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ„é€ å‡½æ•°ï¼Œåˆå§‹åŒ–æ—¥å¿—å¤„ç†æ‰€éœ€çš„å„ç§å‚æ•°ã€‚</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> ip           è¯·æ±‚çš„IPåœ°å€</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> type         è¯·æ±‚ç±»å‹ï¼ˆå¦‚GETã€POSTï¼‰</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> requestUrl   è¯·æ±‚çš„URL</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> securityUser å½“å‰æ“ä½œçš„å®‰å…¨ç”¨æˆ·</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> paramsJson   è¯·æ±‚çš„å‚æ•°åˆ—è¡¨ï¼ˆJSONæ ¼å¼ï¼‰</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> classPath    è¢«è°ƒç”¨çš„ç±»çš„å®Œæ•´è·¯å¾„</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> methodName   è¢«è°ƒç”¨çš„æ–¹æ³•åç§°</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> operationName æ“ä½œåç§°</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> startTime    æ–¹æ³•è¯·æ±‚çš„å¼€å§‹æ—¶é—´</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> redisUtil    Rediså·¥å…·ç±»</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">SysLogHandle</span>(<span class="hljs-title class_">String</span> ip, <span class="hljs-title class_">String</span> <span class="hljs-keyword">type</span>, <span class="hljs-title class_">String</span> requestUrl, <span class="hljs-title class_">SecurityUser</span> securityUser,<br>                        <span class="hljs-title class_">String</span> paramsJson, <span class="hljs-title class_">String</span> classPath,<br>                        <span class="hljs-title class_">String</span> methodName, <span class="hljs-title class_">String</span> operationName,<br>                        <span class="hljs-title class_">Date</span> startTime, <span class="hljs-title class_">RedisUtil</span> redisUtil) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">ip</span> = ip;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">type</span> = <span class="hljs-keyword">type</span>;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">requestUrl</span> = requestUrl;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">securityUser</span> = securityUser;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">paramsJson</span> = paramsJson;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">classPath</span> = classPath;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">methodName</span> = methodName;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">operationName</span> = operationName;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">startTime</span> = startTime;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">redisUtil</span> = redisUtil;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ‰§è¡Œæ—¥å¿—è®°å½•çš„é€»è¾‘ã€‚</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">onRun</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-title class_">SysLog</span> sysLog = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SysLog</span>();<br><br>        <span class="hljs-comment">// ä»Redisä¸­è·å–IPæ¥æºä¿¡æ¯</span><br>        <span class="hljs-title class_">String</span> jsonResult = redisUtil.<span class="hljs-title function_">get</span>(<span class="hljs-title class_">RedisConf</span>.<span class="hljs-property">IP_SOURCE</span> + <span class="hljs-title class_">Constants</span>.<span class="hljs-property">SYMBOL_COLON</span> + ip);<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title class_">StringUtils</span>.<span class="hljs-title function_">isEmpty</span>(jsonResult)) &#123;<br>            <span class="hljs-title class_">String</span> addresses = <span class="hljs-title class_">IpUtils</span>.<span class="hljs-title function_">getAddresses</span>(<span class="hljs-title class_">SysConf</span>.<span class="hljs-property">IP</span> + <span class="hljs-title class_">SysConf</span>.<span class="hljs-property">EQUAL_TO</span> + ip, <span class="hljs-title class_">SysConf</span>.<span class="hljs-property">UTF_8</span>);<br>            <span class="hljs-keyword">if</span> (<span class="hljs-title class_">StringUtils</span>.<span class="hljs-title function_">isNotEmpty</span>(addresses)) &#123;<br>                sysLog.<span class="hljs-title function_">setIpSource</span>(addresses);<br>                redisUtil.<span class="hljs-title function_">setEx</span>(<span class="hljs-title class_">RedisConf</span>.<span class="hljs-property">IP_SOURCE</span> + <span class="hljs-title class_">Constants</span>.<span class="hljs-property">SYMBOL_COLON</span> + ip, addresses, <span class="hljs-number">24</span>, <span class="hljs-title class_">TimeUnit</span>.<span class="hljs-property">HOURS</span>);<br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            sysLog.<span class="hljs-title function_">setIpSource</span>(jsonResult);<br>        &#125;<br><br>        <span class="hljs-comment">// è®¾ç½®æ—¥å¿—çš„å…¶ä»–å±æ€§</span><br>        sysLog.<span class="hljs-title function_">setIp</span>(ip);<br>        sysLog.<span class="hljs-title function_">setClassPath</span>(classPath);<br>        sysLog.<span class="hljs-title function_">setMethod</span>(methodName);<br>        sysLog.<span class="hljs-title function_">setType</span>(<span class="hljs-keyword">type</span>);<br>        sysLog.<span class="hljs-title function_">setUrl</span>(requestUrl);<br>        sysLog.<span class="hljs-title function_">setOperation</span>(operationName);<br>        sysLog.<span class="hljs-title function_">setCreateTime</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());<br>        sysLog.<span class="hljs-title function_">setUpdateTime</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());<br>        sysLog.<span class="hljs-title function_">setUserName</span>(securityUser.<span class="hljs-title function_">getUsername</span>());<br>        sysLog.<span class="hljs-title function_">setAdminUid</span>(securityUser.<span class="hljs-title function_">getUid</span>());<br>        sysLog.<span class="hljs-title function_">setParams</span>(paramsJson);<br><br>        <span class="hljs-comment">// è®¡ç®—å¹¶è®¾ç½®è¯·æ±‚è€—æ—¶</span><br>        <span class="hljs-title class_">Date</span> endTime = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>();<br>        <span class="hljs-title class_">Long</span> spendTime = <span class="hljs-title class_">DateUtil</span>.<span class="hljs-title function_">between</span>(startTime, endTime, <span class="hljs-title class_">DateUnit</span>.<span class="hljs-property">MS</span>);<br>        sysLog.<span class="hljs-title function_">setSpendTime</span>(spendTime);<br><br>        <span class="hljs-comment">// å°†æ—¥å¿—ä¿¡æ¯ä¿å­˜åˆ°æ•°æ®åº“</span><br>        sysLog.<span class="hljs-title function_">insert</span>();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><code>SysLogHandle</code> ç»§æ‰¿è‡ª <code>AbstractRequestAwareRunnable</code>ï¼Œå®ƒæ˜¯ä¸€ä¸ªRunnableå®ç°ï¼Œç”¨äºå¼‚æ­¥æ‰§è¡Œæ—¥å¿—è®°å½•ä»»åŠ¡ã€‚</li><li>æ„é€ å‡½æ•°æ¥æ”¶æ‰€æœ‰å¿…è¦çš„å‚æ•°ï¼ŒåŒ…æ‹¬è¯·æ±‚ä¿¡æ¯ã€ç”¨æˆ·ä¿¡æ¯å’Œæ–¹æ³•ä¿¡æ¯ã€‚</li><li><code>onRun</code> æ–¹æ³•æ˜¯æ—¥å¿—è®°å½•é€»è¾‘çš„å®ç°ã€‚å®ƒé¦–å…ˆä»Redisä¸­è·å–IPæ¥æºä¿¡æ¯ï¼Œç„¶ååˆ›å»ºä¸€ä¸ª <code>SysLog</code> å¯¹è±¡å¹¶è®¾ç½®å„ç§å±æ€§ï¼ŒåŒ…æ‹¬è¯·æ±‚ä¿¡æ¯ã€ç”¨æˆ·ä¿¡æ¯ã€æ“ä½œåç§°ã€å‚æ•°ç­‰ã€‚</li><li>æœ€åï¼Œè®¡ç®—è¯·æ±‚è€—æ—¶å¹¶å°†æ—¥å¿—ä¿¡æ¯ä¿å­˜åˆ°æ•°æ®åº“ã€‚</li></ul><p>è¿™ä¸ªç±»çš„ä¸»è¦ä½œç”¨æ˜¯å¼‚æ­¥è®°å½•æ¯æ¬¡è¯·æ±‚çš„è¯¦ç»†æ—¥å¿—ï¼ŒåŒ…æ‹¬è¯·æ±‚å‚æ•°ã€æ‰§è¡Œæ—¶é—´ç­‰ï¼Œ</p><p>é€šè¿‡å¼‚æ­¥å¤„ç†ï¼Œå®ƒè¿˜æœ‰åŠ©äºå‡å°‘æ—¥å¿—è®°å½•å¯¹åº”ç”¨æ€§èƒ½çš„å½±å“ã€‚</p><h4 id="å¼‚æ­¥æ—¥å¿—è®°å½•çš„åŠŸèƒ½"><a href="#å¼‚æ­¥æ—¥å¿—è®°å½•çš„åŠŸèƒ½" class="headerlink" title="å¼‚æ­¥æ—¥å¿—è®°å½•çš„åŠŸèƒ½"></a>å¼‚æ­¥æ—¥å¿—è®°å½•çš„åŠŸèƒ½</h4><p>åœ¨åˆ‡é¢çš„æ—¶å€™ï¼Œhandle æ–¹æ³•ä¿å­˜æ—¥å¿—çš„æ“ä½œæ˜¯å¼‚æ­¥è¿›è¡Œçš„ï¼Œè¿™é‡Œå•ç‹¬æ‹¿å‡ºæ¥åˆ†æä¸€ä¸‹ã€‚</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-comment">// å¼‚æ­¥å­˜å‚¨æ—¥å¿—</span><br><span class="hljs-selector-tag">threadPoolTaskExecutor</span><span class="hljs-selector-class">.execute</span>(<br>        new <span class="hljs-built_in">SysLogHandle</span>(ip, type, url, securityUser,<br>                        paramsJson, point.<span class="hljs-built_in">getTarget</span>().<span class="hljs-built_in">getClass</span>().<span class="hljs-built_in">getName</span>(),<br>                        point.<span class="hljs-built_in">getSignature</span>().<span class="hljs-built_in">getName</span>(), bussinessName,<br>                        startTime, redisUtil));<br><br></code></pre></td></tr></table></figure><ol><li><strong>ä½¿ç”¨çº¿ç¨‹æ± </strong>:<ul><li><code>threadPoolTaskExecutor.execute(...)</code>: è¿™éƒ¨åˆ†ä»£ç åˆ©ç”¨Springæ¡†æ¶ä¸­çš„ <code>ThreadPoolTaskExecutor</code> æ¥æ‰§è¡Œä¸€ä¸ªä»»åŠ¡ã€‚<code>ThreadPoolTaskExecutor</code> æ˜¯ä¸€ä¸ªåŸºäºçº¿ç¨‹æ± çš„TaskExecutorå®ç°ï¼Œå…è®¸å¼‚æ­¥æ‰§è¡Œä»»åŠ¡ã€‚</li></ul></li><li><strong>åˆ›å»ºæ—¥å¿—å¤„ç†ä»»åŠ¡</strong>:<ul><li><code>new SysLogHandle(...)</code>: è¿™é‡Œåˆ›å»ºäº†ä¸€ä¸ª <code>SysLogHandle</code> å¯¹è±¡ï¼Œå®ƒæ˜¯ä¸€ä¸ªå®ç°äº† <code>Runnable</code> æ¥å£çš„ç±»ï¼Œç”¨äºå¤„ç†æ—¥å¿—è®°å½•çš„å…·ä½“é€»è¾‘ã€‚</li></ul></li><li><strong>ä¼ é€’å‚æ•°ç»™æ—¥å¿—å¤„ç†ä»»åŠ¡</strong>:<ul><li>å‘ <code>SysLogHandle</code> æ„é€ å™¨ä¼ é€’äº†å¤šä¸ªå‚æ•°ï¼ŒåŒ…æ‹¬è¯·æ±‚çš„IPåœ°å€ (<code>ip</code>)ã€è¯·æ±‚ç±»å‹ (<code>type</code>)ã€è¯·æ±‚URL (<code>url</code>)ã€å½“å‰å®‰å…¨ç”¨æˆ· (<code>securityUser</code>)ã€è¯·æ±‚å‚æ•°çš„JSONå­—ç¬¦ä¸² (<code>paramsJson</code>)ã€è¢«è°ƒç”¨çš„ç±»åå’Œæ–¹æ³•åï¼ˆé€šè¿‡ <code>point.getTarget().getClass().getName()</code> å’Œ <code>point.getSignature().getName()</code> è·å–ï¼‰ã€ä¸šåŠ¡åç§° (<code>bussinessName</code>)ã€æ–¹æ³•å¼€å§‹æ‰§è¡Œçš„æ—¶é—´ (<code>startTime</code>)ï¼Œä»¥åŠRediså·¥å…·ç±» (<code>redisUtil</code>)ã€‚</li></ul></li><li><strong>æ‰§è¡Œä»»åŠ¡</strong>:<ul><li><code>threadPoolTaskExecutor.execute(...)</code>: è¿™ä¸ªæ–¹æ³•å°† <code>SysLogHandle</code> çš„å®ä¾‹æäº¤åˆ°çº¿ç¨‹æ± è¿›è¡Œå¼‚æ­¥æ‰§è¡Œï¼Œä¸ä¼šé˜»å¡å½“å‰çº¿ç¨‹çš„æ‰§è¡Œã€‚è¿™æ„å‘³ç€åŸæ–¹æ³•ï¼ˆè¢« <code>@OperationLogger</code> æ³¨è§£çš„æ–¹æ³•ï¼‰çš„æ‰§è¡Œå’Œæ—¥å¿—çš„è®°å½•æ˜¯å¹¶å‘è¿›è¡Œçš„ã€‚</li></ul></li></ol><blockquote><p>å®é™…åº”ç”¨</p></blockquote><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™ç§å¼‚æ­¥æ—¥å¿—è®°å½•æ–¹æ³•éå¸¸æœ‰ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨é«˜æµé‡çš„Webåº”ç”¨ä¸­ã€‚å®ƒå…è®¸åº”ç”¨å¿«é€Ÿå“åº”ç”¨æˆ·è¯·æ±‚ï¼ŒåŒæ—¶å°†è€—æ—¶çš„æ—¥å¿—è®°å½•æ“ä½œæ”¾åœ¨åå°çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œä»è€Œä¸ä¼šæ˜¾è‘—å½±å“ç”¨æˆ·ä½“éªŒå’Œåº”ç”¨æ€§èƒ½ã€‚</p><p>é€šè¿‡å°†æ—¥å¿—è®°å½•é€»è¾‘ä»ä¸»æ‰§è¡Œè·¯å¾„ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œå¯ä»¥å‡å°‘å¯¹ä¸»ä¸šåŠ¡é€»è¾‘çš„å¹²æ‰°ï¼ŒåŒæ—¶ç¡®ä¿äº†é‡è¦çš„æ“ä½œæ—¥å¿—è¢«æ­£ç¡®è®°å½•å’Œå­˜å‚¨ã€‚</p><h4 id="å·¥å…·ç±»AspectUtil"><a href="#å·¥å…·ç±»AspectUtil" class="headerlink" title="å·¥å…·ç±»AspectUtil"></a>å·¥å…·ç±»AspectUtil</h4><p>å¯¹äºä¸Šé¢ä½¿ç”¨åˆ°çš„å·¥å…·ç±» AspectUtil è¿›è¡Œè®°å½•è¯´æ˜</p><figure class="highlight wren"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs wren"><span class="hljs-variable">public</span> <span class="hljs-variable">enum</span> <span class="hljs-title class_">AspectUtil</span> &#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å•ä¾‹å®ä¾‹ï¼Œæšä¸¾ç±»å‹ä¿è¯å…¨å±€å”¯ä¸€ã€‚</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-variable">INSTANCE</span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è·å–ä»¥ç±»è·¯å¾„ä¸ºå‰ç¼€çš„é”®ã€‚</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> point å½“å‰åˆ‡é¢æ‰§è¡Œçš„æ–¹æ³•çš„è¿æ¥ç‚¹</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> prefix å‰ç¼€å­—ç¬¦ä¸²</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> ä»¥ç±»è·¯å¾„ä¸ºå‰ç¼€çš„é”®å­—ç¬¦ä¸²</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-variable">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">getKey</span>(<span class="hljs-params">JoinPoint</span> <span class="hljs-params">point</span>, <span class="hljs-params">String</span> <span class="hljs-params">prefix</span>) &#123;<br>        <span class="hljs-title class_">String</span> <span class="hljs-variable">keyPrefix</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-operator">!</span><span class="hljs-title class_">StringUtils</span>.<span class="hljs-property">isEmpty</span>(<span class="hljs-variable">prefix</span>)) &#123;<br>            <span class="hljs-variable">keyPrefix</span> <span class="hljs-operator">+</span><span class="hljs-operator">=</span> <span class="hljs-variable">prefix</span>;<br>        &#125;<br>        <span class="hljs-variable">keyPrefix</span> <span class="hljs-operator">+</span><span class="hljs-operator">=</span> <span class="hljs-title function_">getClassName</span>(<span class="hljs-variable">point</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">keyPrefix</span>;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è·å–å½“å‰åˆ‡é¢æ‰§è¡Œçš„æ–¹æ³•æ‰€åœ¨çš„ç±»çš„åç§°ï¼Œæ›¿æ¢æ‰€æœ‰çš„ç‚¹ä¸ºä¸‹åˆ’çº¿ã€‚</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> point å½“å‰åˆ‡é¢æ‰§è¡Œçš„æ–¹æ³•çš„è¿æ¥ç‚¹</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> å¤„ç†åçš„ç±»åå­—ç¬¦ä¸²</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-variable">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">getClassName</span>(<span class="hljs-params">JoinPoint</span> <span class="hljs-params">point</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">point</span>.<span class="hljs-property">getTarget</span>().<span class="hljs-property">getClass</span>().<span class="hljs-property">getName</span>().<span class="hljs-property">replaceAll</span>(<span class="hljs-string">&quot;<span class="hljs-char escape_">\\</span>.&quot;</span>, <span class="hljs-string">&quot;_&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è·å–å½“å‰åˆ‡é¢æ‰§è¡Œçš„æ–¹æ³•çš„Methodå¯¹è±¡ã€‚</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> point å½“å‰åˆ‡é¢æ‰§è¡Œçš„æ–¹æ³•çš„è¿æ¥ç‚¹</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> å½“å‰æ‰§è¡Œæ–¹æ³•çš„Methodå¯¹è±¡</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> NoSuchMethodException å¦‚æœæ— æ³•æ‰¾åˆ°ç›¸åº”çš„æ–¹æ³•</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-variable">public</span> <span class="hljs-title class_">Method</span> <span class="hljs-title function_">getMethod</span>(<span class="hljs-title class_">JoinPoint</span> <span class="hljs-variable">point</span>) <span class="hljs-variable">throws</span> <span class="hljs-title class_">NoSuchMethodException</span> &#123;<br>        <span class="hljs-title class_">Signature</span> <span class="hljs-variable">sig</span> <span class="hljs-operator">=</span> <span class="hljs-variable">point</span>.<span class="hljs-property">getSignature</span>();<br>        <span class="hljs-title class_">MethodSignature</span> <span class="hljs-variable">msig</span> <span class="hljs-operator">=</span> (<span class="hljs-title class_">MethodSignature</span>) <span class="hljs-variable">sig</span>;<br>        <span class="hljs-title class_">Object</span> <span class="hljs-variable">target</span> <span class="hljs-operator">=</span> <span class="hljs-variable">point</span>.<span class="hljs-property">getTarget</span>();<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">target</span>.<span class="hljs-property">getClass</span>().<span class="hljs-property">getMethod</span>(<span class="hljs-variable">msig</span>.<span class="hljs-property">getName</span>(), <span class="hljs-variable">msig</span>.<span class="hljs-property">getParameterTypes</span>());<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è§£æä¸šåŠ¡åç§°ä¸­çš„å ä½ç¬¦ï¼Œå¹¶ç”¨æ–¹æ³•å‚æ•°æ›¿æ¢ã€‚</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> params æ–¹æ³•å‚æ•°æ•°ç»„</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> bussinessName å¸¦å ä½ç¬¦çš„ä¸šåŠ¡åç§°</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> è§£æåçš„ä¸šåŠ¡åç§°</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-variable">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">parseParams</span>(<span class="hljs-params">Object</span>[] <span class="hljs-params">params</span>, <span class="hljs-params">String</span> <span class="hljs-params">bussinessName</span>) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">bussinessName</span>.<span class="hljs-property">contains</span>(<span class="hljs-string">&quot;&#123;&quot;</span>) <span class="hljs-operator">&amp;&amp;</span> <span class="hljs-variable">bussinessName</span>.<span class="hljs-property">contains</span>(<span class="hljs-string">&quot;&#125;&quot;</span>)) &#123;<br>            <span class="hljs-title class_">List</span><span class="hljs-operator">&lt;</span><span class="hljs-title class_">String</span><span class="hljs-operator">&gt;</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> <span class="hljs-title class_">RegexUtils</span>.<span class="hljs-property">match</span>(<span class="hljs-variable">bussinessName</span>, <span class="hljs-string">&quot;(?&lt;=<span class="hljs-char escape_">\\</span>&#123;)(<span class="hljs-char escape_">\\</span>d+)&quot;</span>);<br>            <span class="hljs-keyword">for</span> (<span class="hljs-title class_">String</span> <span class="hljs-variable">s</span> : <span class="hljs-variable">result</span>) &#123;<br>                int index <span class="hljs-operator">=</span> <span class="hljs-title class_">Integer</span>.<span class="hljs-property">parseInt</span>(<span class="hljs-variable">s</span>);<br>                <span class="hljs-variable">bussinessName</span> <span class="hljs-operator">=</span> <span class="hljs-variable">bussinessName</span>.<span class="hljs-property">replaceAll</span>(<span class="hljs-string">&quot;<span class="hljs-char escape_">\\</span>&#123;&quot;</span> <span class="hljs-operator">+</span> index <span class="hljs-operator">+</span> <span class="hljs-string">&quot;&#125;&quot;</span>, <span class="hljs-variable">JSON</span>.<span class="hljs-property">toJSONString</span>(<span class="hljs-variable">params</span>[index <span class="hljs-operator">-</span> <span class="hljs-number">1</span>]));<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">bussinessName</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><code>AspectUtil</code> æ˜¯ä¸€ä¸ªæšä¸¾ç±»å‹ï¼Œæä¾›äº†ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„å®ä¾‹ <code>INSTANCE</code>ã€‚</li><li><code>getKey</code> æ–¹æ³•æ ¹æ®è¿æ¥ç‚¹ (<code>JoinPoint</code>) å’Œç»™å®šçš„å‰ç¼€ç”Ÿæˆä¸€ä¸ªå­—ç¬¦ä¸²é”®ã€‚è¯¥é”®é€šå¸¸ç”¨äºè¯†åˆ«ç‰¹å®šçš„æ–¹æ³•æˆ–ç±»ã€‚</li><li><code>getClassName</code> æ–¹æ³•è·å–è¿æ¥ç‚¹æŒ‡å‘çš„ç›®æ ‡ç±»çš„åç§°ï¼Œå¹¶å°†å…¶ä¸­çš„ç‚¹æ›¿æ¢ä¸ºä¸‹åˆ’çº¿ã€‚è¿™åœ¨éœ€è¦åŸºäºç±»åç”Ÿæˆå”¯ä¸€æ ‡è¯†æ—¶å¾ˆæœ‰ç”¨ã€‚</li><li><code>getMethod</code> æ–¹æ³•è¿”å›è¿æ¥ç‚¹æŒ‡å‘çš„å…·ä½“æ–¹æ³•çš„ <code>Method</code> å¯¹è±¡ï¼Œç”¨äºè¿›ä¸€æ­¥çš„åå°„æ“ä½œã€‚</li><li><code>parseParams</code> æ–¹æ³•è§£æä¸šåŠ¡åç§°å­—ç¬¦ä¸²ä¸­çš„å ä½ç¬¦ï¼Œå¹¶ç”¨æ–¹æ³•çš„å®é™…å‚æ•°æ›¿æ¢è¿™äº›å ä½ç¬¦ã€‚è¿™å¯¹äºç”ŸæˆåŠ¨æ€çš„æ—¥å¿—æ¶ˆæ¯æˆ–é”™è¯¯æ¶ˆæ¯éå¸¸æœ‰ç”¨ï¼Œç‰¹åˆ«æ˜¯å½“æ¶ˆæ¯å†…å®¹ä¾èµ–äºæ–¹æ³•çš„è¾“å…¥å‚æ•°æ—¶ã€‚</li></ul>]]></content>
    
    
    <categories>
      
      <category>é¡¹ç›®</category>
      
    </categories>
    
    
    <tags>
      
      <tag>project</tag>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è˜‘è‡åšå®¢é¡¹ç›®_Day03</title>
    <link href="/2023/12/12/%E8%98%91%E8%8F%87%E5%8D%9A%E5%AE%A2%E9%A1%B9%E7%9B%AE_Day03/"/>
    <url>/2023/12/12/%E8%98%91%E8%8F%87%E5%8D%9A%E5%AE%A2%E9%A1%B9%E7%9B%AE_Day03/</url>
    
    <content type="html"><![CDATA[<p>è¿™é‡Œè®²è¿°è˜‘è‡åšå®¢é‡Œé¢ä¸€äº›å†™æ³•çš„ä½¿ç”¨è¯´æ˜</p><p>ä¸‹é¢çš„ç« èŠ‚éƒ½æ˜¯ä¸ºäº†è§£é‡Šä¸‹é¢è¿™æ®µä»£ç çš„ä½¿ç”¨</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@AuthorityVerify</span>  <br><span class="hljs-variable">@ApiOperation</span>(value = <span class="hljs-string">&quot;è·å–åšå®¢åˆ—è¡¨&quot;</span>, notes = <span class="hljs-string">&quot;è·å–åšå®¢åˆ—è¡¨&quot;</span>, response = String.class)  <br><span class="hljs-variable">@PostMapping</span>(<span class="hljs-string">&quot;/getList&quot;</span>)  <br>public String <span class="hljs-built_in">getList</span>(<span class="hljs-variable">@Validated</span>(&#123;GetList.class&#125;) <span class="hljs-variable">@RequestBody</span> BlogVO blogVO, BindingResult result) &#123;  <br>  <br>    <span class="hljs-selector-tag">ThrowableUtils</span><span class="hljs-selector-class">.checkParamArgument</span>(result);  <br>    <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResultUtil</span><span class="hljs-selector-class">.successWithData</span>(blogService.<span class="hljs-built_in">getPageList</span>(blogVO));  <br>&#125;<br></code></pre></td></tr></table></figure><h3 id="1ã€è‡ªå®šä¹‰æ³¨è§£-AuthorityVerify-çš„ä½¿ç”¨"><a href="#1ã€è‡ªå®šä¹‰æ³¨è§£-AuthorityVerify-çš„ä½¿ç”¨" class="headerlink" title="1ã€è‡ªå®šä¹‰æ³¨è§£ AuthorityVerify çš„ä½¿ç”¨"></a>1ã€è‡ªå®šä¹‰æ³¨è§£ AuthorityVerify çš„ä½¿ç”¨</h3><h4 id="æ³¨è§£å®šä¹‰"><a href="#æ³¨è§£å®šä¹‰" class="headerlink" title="æ³¨è§£å®šä¹‰"></a>æ³¨è§£å®šä¹‰</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Target(&#123;ElementType.METHOD, ElementType.TYPE&#125;)</span><br><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> AuthorityVerify &#123;<br>    String <span class="hljs-title function_">value</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> <span class="hljs-string">&quot;&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><code>@Target(&#123;ElementType.METHOD, ElementType.TYPE&#125;)</code>ï¼šè¿™è¡¨æ˜è¿™ä¸ªæ³¨è§£å¯ä»¥åº”ç”¨äºæ–¹æ³•å’Œç±»ã€‚å¦‚æœæ”¾åœ¨ç±»ä¸Šï¼Œé€šå¸¸æ„å‘³ç€ç±»ä¸­çš„æ‰€æœ‰æ–¹æ³•éƒ½åº”ç”¨è¿™ä¸ªæ³¨è§£ï¼›å¦‚æœæ”¾åœ¨æ–¹æ³•ä¸Šï¼Œåˆ™åªé’ˆå¯¹è¯¥æ–¹æ³•ã€‚</li><li><code>@Retention(RetentionPolicy.RUNTIME)</code>ï¼šè¿™æŒ‡å®šäº†æ³¨è§£çš„ä¿ç•™ç­–ç•¥æ˜¯åœ¨è¿è¡Œæ—¶ã€‚è¿™æ„å‘³ç€è¿™ä¸ªæ³¨è§£ä¸ä»…è¢«ä¿å­˜åœ¨classæ–‡ä»¶ä¸­ï¼Œè¿˜å¯ä»¥é€šè¿‡åå°„åœ¨è¿è¡Œæ—¶è¢«è¯»å–ã€‚</li><li><code>String value() default &quot;&quot;</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå¯é€‰çš„æ³¨è§£å…ƒç´ ï¼Œå…è®¸åœ¨ä½¿ç”¨æ³¨è§£æ—¶è®¾ç½®ä¸€ä¸ªå­—ç¬¦ä¸²å€¼ã€‚å®ƒçš„é»˜è®¤å€¼æ˜¯ç©ºå­—ç¬¦ä¸²ã€‚</li></ul><h4 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h4><p>è¿™ä¸ªæ³¨è§£å¯ä»¥åº”ç”¨äºç±»æˆ–æ–¹æ³•æ¥å®ç°æƒé™éªŒè¯ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@AuthorityVerify</span><br>public class SomeController &#123;<br><br>    <span class="hljs-variable">@AuthorityVerify</span>(<span class="hljs-string">&quot;admin&quot;</span>)<br>    <span class="hljs-variable">@GetMapping</span>(<span class="hljs-string">&quot;/someSecureMethod&quot;</span>)<br>    public String <span class="hljs-built_in">someSecureMethod</span>() &#123;<br>        <span class="hljs-comment">// æ–¹æ³•å®ç°</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>@AuthorityVerify</code> åº”ç”¨äºä¸€ä¸ªæ§åˆ¶å™¨æ–¹æ³•ã€‚<br>ä½ å¯ä»¥å°†å…¶æ”¾åœ¨ä»»ä½•Spring Controllerçš„æ–¹æ³•ä¸Šï¼Œè¡¨ç¤ºè¯¥æ–¹æ³•éœ€è¦è¿›è¡Œæƒé™éªŒè¯ã€‚<br>æ³¨è§£ä¸­çš„ <code>&quot;admin&quot;</code> å­—ç¬¦ä¸²å¯ä»¥ç”¨æ¥æŒ‡å®šéœ€è¦å“ªç§æƒé™æ‰èƒ½è®¿é—®è¯¥æ–¹æ³•ã€‚</p><p>è¦è®©è¿™ä¸ªæ³¨è§£çœŸæ­£èµ·ä½œç”¨ï¼Œè¿˜éœ€è¦ç¼–å†™é¢å¤–çš„ä»£ç æ¥å¤„ç†è¿™ä¸ªæ³¨è§£ã€‚é€šå¸¸æ˜¯é€šè¿‡Springçš„AOPï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰åŠŸèƒ½æ¥å®ç°çš„ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªåˆ‡é¢æ¥æ‹¦æˆªå¸¦æœ‰ <code>@AuthorityVerify</code> æ³¨è§£çš„æ–¹æ³•è°ƒç”¨ï¼Œç„¶åæ‰§è¡Œæƒé™éªŒè¯é€»è¾‘ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Aspect</span><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AuthorityAspect</span> &#123;<br><br>    <span class="hljs-meta">@Around(&quot;@annotation(authorityVerify)&quot;)</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">around</span><span class="hljs-params">(ProceedingJoinPoint point, AuthorityVerify authorityVerify)</span> <span class="hljs-keyword">throws</span> Throwable &#123;<br>        <span class="hljs-comment">// è·å–æ³¨è§£ä¸­çš„å€¼</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> authorityVerify.value();<br><br>        <span class="hljs-comment">// è¿™é‡Œå®ç°æƒé™éªŒè¯é€»è¾‘</span><br>        <span class="hljs-comment">// ...</span><br><br>        <span class="hljs-comment">// ç»§ç»­æ‰§è¡ŒåŸæ–¹æ³•</span><br>        <span class="hljs-keyword">return</span> point.proceed();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œè˜‘è‡åšå®¢é¡¹ç›®ä¹Ÿæ˜¯è¿™æ ·ä½¿ç”¨çš„ã€‚</p><p>ä¸Šé¢çš„ç¤ºä¾‹æ˜¯é€šè¿‡æ³¨è§£çš„å€¼ï¼Œç„¶ååœ¨ç¯ç»•é€šçŸ¥é‡Œé¢çš„æ–¹æ³•ï¼Œæ ¹æ®è·å–å€¼æ¥è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œã€‚</p><p>è˜‘è‡åšå®¢çš„è¿™ä¸ªæ–¹æ³•æœ‰æ‰€ä¸åŒçš„æ˜¯ï¼Œä»–æ˜¯é€šè¿‡åˆ¤æ–­æ·»åŠ è¯¥æ³¨è§£çš„æ–¹æ³•ï¼Œè·å–è®¿é—®è¯·æ±‚è·¯å¾„ï¼Œè·å–ç”¨æˆ·ï¼Œåˆ¤å®šè¯¥ç”¨æˆ·ä¸‹æ˜¯å¦æœ‰è¯¥è®¿é—®è·¯å¾„çš„æƒé™ã€‚</p><p>getList æ–¹æ³•</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@AuthorityVerify</span>  <br><span class="hljs-variable">@ApiOperation</span>(value = <span class="hljs-string">&quot;è·å–åšå®¢åˆ—è¡¨&quot;</span>, notes = <span class="hljs-string">&quot;è·å–åšå®¢åˆ—è¡¨&quot;</span>, response = String.class)  <br><span class="hljs-variable">@PostMapping</span>(<span class="hljs-string">&quot;/getList&quot;</span>)  <br>public String <span class="hljs-built_in">getList</span>(<span class="hljs-variable">@Validated</span>(&#123;GetList.class&#125;) <span class="hljs-variable">@RequestBody</span> BlogVO blogVO, BindingResult result) &#123;  <br>  <br>    <span class="hljs-selector-tag">ThrowableUtils</span><span class="hljs-selector-class">.checkParamArgument</span>(result);  <br>    <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResultUtil</span><span class="hljs-selector-class">.successWithData</span>(blogService.<span class="hljs-built_in">getPageList</span>(blogVO));  <br>&#125;<br></code></pre></td></tr></table></figure><h4 id="AuthorityVerifyAspect"><a href="#AuthorityVerifyAspect" class="headerlink" title="AuthorityVerifyAspect"></a><code>AuthorityVerifyAspect</code></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æƒé™æ ¡éªŒ åˆ‡é¢å®ç°</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> é™Œæºª</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@create</span>: 2020-03-06-19:05</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Aspect</span><br><span class="hljs-meta">@Component</span><br><span class="hljs-meta">@Slf4j</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AuthorityVerifyAspect</span> &#123;<br><br>    <span class="hljs-comment">// è‡ªåŠ¨æ³¨å…¥æ‰€éœ€çš„æœåŠ¡å’Œå·¥å…·ç±»</span><br>    <span class="hljs-meta">@Autowired</span><br>    CategoryMenuService categoryMenuService;<br><br>    <span class="hljs-meta">@Autowired</span><br>    RoleService roleService;<br><br>    <span class="hljs-meta">@Autowired</span><br>    AdminService adminService;<br><br>    <span class="hljs-meta">@Autowired</span><br>    RedisUtil redisUtil;<br><br>    <span class="hljs-comment">// å®šä¹‰åˆ‡ç‚¹ï¼ŒæŒ‡å‘ä½¿ç”¨AuthorityVerifyæ³¨è§£çš„æ–¹æ³•</span><br>    <span class="hljs-meta">@Pointcut(value = &quot;@annotation(authorityVerify)&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">pointcut</span><span class="hljs-params">(AuthorityVerify authorityVerify)</span> &#123;<br><br>    &#125;<br><br>    <span class="hljs-comment">// ç¯ç»•é€šçŸ¥ï¼Œç”¨äºåœ¨æ–¹æ³•æ‰§è¡Œå‰åæ·»åŠ é¢å¤–çš„å¤„ç†</span><br>    <span class="hljs-meta">@Around(value = &quot;pointcut(authorityVerify)&quot;)</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">doAround</span><span class="hljs-params">(ProceedingJoinPoint joinPoint, AuthorityVerify authorityVerify)</span> <span class="hljs-keyword">throws</span> Throwable &#123;<br><br>        <span class="hljs-comment">// è·å–å½“å‰HTTPè¯·æ±‚çš„å±æ€§</span><br>        <span class="hljs-type">ServletRequestAttributes</span> <span class="hljs-variable">attribute</span> <span class="hljs-operator">=</span> (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();<br>        <span class="hljs-type">HttpServletRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> attribute.getRequest();<br><br>        <span class="hljs-comment">// è·å–è¯·æ±‚è·¯å¾„</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> request.getRequestURI();<br><br>        <span class="hljs-comment">// è§£æå‡ºè¯·æ±‚è€…çš„ID</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">adminUid</span> <span class="hljs-operator">=</span> request.getAttribute(SysConf.ADMIN_UID).toString();<br><br>        <span class="hljs-comment">// å°è¯•ä»Redisè·å–ç®¡ç†å‘˜èƒ½å¤Ÿè®¿é—®çš„è·¯å¾„</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">visitUrlStr</span> <span class="hljs-operator">=</span> redisUtil.get(RedisConf.ADMIN_VISIT_MENU + RedisConf.SEGMENTATION + adminUid);<br>        LinkedTreeMap&lt;String, String&gt; visitMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedTreeMap</span>&lt;&gt;();<br><br>        <span class="hljs-comment">// åˆ¤æ–­Redisä¸­æ˜¯å¦æœ‰æ•°æ®</span><br>        <span class="hljs-keyword">if</span> (StringUtils.isNotEmpty(visitUrlStr)) &#123;<br>            <span class="hljs-comment">// ä»Redisä¸­è·å–</span><br>            visitMap = (LinkedTreeMap&lt;String, String&gt;) JsonUtils.jsonToMap(visitUrlStr, String.class);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// Redisä¸­æ²¡æœ‰ï¼Œåˆ™æŸ¥è¯¢æ•°æ®åº“</span><br>            <span class="hljs-type">Admin</span> <span class="hljs-variable">admin</span> <span class="hljs-operator">=</span> adminService.getById(adminUid);<br>            <span class="hljs-type">String</span> <span class="hljs-variable">roleUid</span> <span class="hljs-operator">=</span> admin.getRoleUid();<br>            <span class="hljs-type">Role</span> <span class="hljs-variable">role</span> <span class="hljs-operator">=</span> roleService.getById(roleUid);<br><br>            <span class="hljs-type">String</span> <span class="hljs-variable">categoryMenuUids</span> <span class="hljs-operator">=</span> role.getCategoryMenuUids();<br>            String[] uids = categoryMenuUids.replace(<span class="hljs-string">&quot;[&quot;</span>, <span class="hljs-string">&quot;&quot;</span>).replace(<span class="hljs-string">&quot;]&quot;</span>, <span class="hljs-string">&quot;&quot;</span>).replace(<span class="hljs-string">&quot;\&quot;&quot;</span>, <span class="hljs-string">&quot;&quot;</span>).split(<span class="hljs-string">&quot;,&quot;</span>);<br><br>            List&lt;String&gt; categoryMenuUids = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(Arrays.asList(uids));<br><br>            <span class="hljs-comment">// åªæŸ¥è¯¢è®¿é—®çš„æŒ‰é’®</span><br>            QueryWrapper&lt;CategoryMenu&gt; queryWrapper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">QueryWrapper</span>&lt;&gt;();<br>            queryWrapper.in(SQLConf.UID, categoryMenuUids);<br>            queryWrapper.eq(SQLConf.MENU_TYPE, EMenuType.BUTTON);<br>            queryWrapper.eq(SQLConf.STATUS, EStatus.ENABLE);<br>            List&lt;CategoryMenu&gt; buttonList = categoryMenuService.list(queryWrapper);<br><br>            <span class="hljs-keyword">for</span> (CategoryMenu item : buttonList) &#123;<br>                <span class="hljs-keyword">if</span> (StringUtils.isNotEmpty(item.getUrl())) &#123;<br>                    visitMap.put(item.getUrl(), item.getUrl());<br>                &#125;<br>            &#125;<br>            <span class="hljs-comment">// å°†è®¿é—®URLå­˜å‚¨åˆ°Redisä¸­</span><br>            redisUtil.setEx(RedisConf.ADMIN_VISIT_MENU + SysConf.REDIS_SEGMENTATION + adminUid, JsonUtils.objectToJson(visitMap), <span class="hljs-number">1</span>, TimeUnit.HOURS);<br>        &#125;<br><br>        <span class="hljs-comment">// åˆ¤æ–­è¯¥è§’è‰²æ˜¯å¦èƒ½å¤Ÿè®¿é—®è¯¥æ¥å£</span><br>        <span class="hljs-keyword">if</span> (visitMap.get(url) != <span class="hljs-literal">null</span>) &#123;<br>            log.info(<span class="hljs-string">&quot;ç”¨æˆ·æ‹¥æœ‰æ“ä½œæƒé™ï¼Œè®¿é—®çš„è·¯å¾„: &#123;&#125;ï¼Œæ‹¥æœ‰çš„æƒé™æ¥å£ï¼š&#123;&#125;&quot;</span>, url, visitMap.get(url));<br>            <span class="hljs-comment">// ç”¨æˆ·æœ‰æƒé™ï¼Œç»§ç»­æ‰§è¡Œä¸šåŠ¡</span><br>            <span class="hljs-keyword">return</span> joinPoint.proceed();<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            log.info(<span class="hljs-string">&quot;ç”¨æˆ·ä¸å…·æœ‰æ“ä½œæƒé™ï¼Œè®¿é—®çš„è·¯å¾„: &#123;&#125;&quot;</span>, url);<br>            <span class="hljs-comment">// ç”¨æˆ·æ— æƒé™ï¼Œè¿”å›æ— æƒé™çš„å“åº”</span><br>            <span class="hljs-keyword">return</span> ResultUtil.result(ECode.NO_OPERATION_AUTHORITY, MessageConf.RESTAPI_NO_PRIVILEGE);<br>        &#125;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2ã€-Validated-æ³¨è§£çš„ä½¿ç”¨"><a href="#2ã€-Validated-æ³¨è§£çš„ä½¿ç”¨" class="headerlink" title="2ã€@Validated æ³¨è§£çš„ä½¿ç”¨"></a>2ã€@Validated æ³¨è§£çš„ä½¿ç”¨</h3><h4 id="è§£é‡Šå¦‚ä½•ä½¿ç”¨çš„"><a href="#è§£é‡Šå¦‚ä½•ä½¿ç”¨çš„" class="headerlink" title="è§£é‡Šå¦‚ä½•ä½¿ç”¨çš„"></a>è§£é‡Šå¦‚ä½•ä½¿ç”¨çš„</h4><p>Springæ¡†æ¶ä¸­ï¼Œ<code>@Validated</code> æ³¨è§£æ˜¯ç”¨æ¥å¯ç”¨æ–¹æ³•å‚æ•°çº§åˆ«çš„éªŒè¯çš„ã€‚è¿™ä¸ªæ³¨è§£å‘Šè¯‰Springéœ€è¦å¯¹è¢«æ³¨è§£çš„å‚æ•°æ‰§è¡ŒéªŒè¯ã€‚</p><blockquote><p>å¦‚ä½•ä½¿ç”¨ <code>@Validated</code></p></blockquote><p>ä¸€èˆ¬ä¼šç»“åˆ éªŒè¯ç»„ã€<code>@RequestBody</code>ã€<code>BindingResult</code> ç»“åˆä½¿ç”¨</p><ol><li><strong>æŒ‡å®šéªŒè¯ç»„</strong>:<ul><li><code>@Validated</code> å¯ä»¥æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ªéªŒè¯ç»„ï¼Œä¾‹å¦‚ <code>@Validated(&#123;GetList.class&#125;)</code>ã€‚è¿™æ„å‘³ç€åªæœ‰åœ¨ <code>GetList</code> ç»„ä¸­å®šä¹‰çš„éªŒè¯è§„åˆ™ä¼šè¢«åº”ç”¨äº <code>blogVO</code> å¯¹è±¡ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šç»„ï¼Œå°†åº”ç”¨é»˜è®¤çš„éªŒè¯è§„åˆ™ã€‚</li></ul></li><li><strong>ä¸ <code>@RequestBody</code> ç»“åˆ</strong>:<ul><li>åœ¨RESTæ§åˆ¶å™¨ä¸­ï¼Œ<code>@Validated</code> é€šå¸¸ä¸ <code>@RequestBody</code> ç»“åˆä½¿ç”¨ï¼Œç”¨äºéªŒè¯JSONè¯·æ±‚ä½“æ˜ å°„åˆ°çš„Javaå¯¹è±¡ã€‚</li></ul></li><li><strong>å¤„ç†éªŒè¯ç»“æœ</strong>:<ul><li>é€šå¸¸ä¸ <code>BindingResult</code> ç»“åˆä½¿ç”¨ï¼Œåè€…ç”¨äºæ•è·éªŒè¯è¿‡ç¨‹ä¸­å‘ç°çš„é”™è¯¯ã€‚å¦‚æœå­˜åœ¨é”™è¯¯ï¼Œå¯ä»¥é€šè¿‡æ£€æŸ¥ <code>BindingResult</code> å¯¹è±¡æ¥å“åº”ç›¸åº”çš„é”™è¯¯ä¿¡æ¯ã€‚</li></ul></li></ol><h4 id="åŸºæœ¬ä½¿ç”¨ç”¨æ³•"><a href="#åŸºæœ¬ä½¿ç”¨ç”¨æ³•" class="headerlink" title="åŸºæœ¬ä½¿ç”¨ç”¨æ³•"></a>åŸºæœ¬ä½¿ç”¨ç”¨æ³•</h4><blockquote><p>ä½¿ç”¨ç¤ºä¾‹</p></blockquote><p>å±•ç¤ºå¦‚ä½•åœ¨Spring Bootåº”ç”¨ä¸­å¯¹ä¸€ä¸ªREST APIç«¯ç‚¹çš„è¯·æ±‚ä½“è¿›è¡ŒéªŒè¯ã€‚</p><p><strong>åœºæ™¯æè¿°</strong></p><p>å‡è®¾æˆ‘ä»¬æ­£åœ¨ç¼–å†™ä¸€ä¸ªåšå®¢åº”ç”¨ç¨‹åºï¼Œéœ€è¦ä¸€ä¸ªAPIæ¥åˆ›å»ºæ–°çš„åšå®¢æ–‡ç« ã€‚</p><p>æˆ‘ä»¬å¸Œæœ›ç¡®ä¿ä¼ å…¥çš„æ•°æ®æ»¡è¶³æŸäº›æ¡ä»¶ï¼Œæ¯”å¦‚æ ‡é¢˜ä¸ä¸ºç©ºï¼Œå†…å®¹é•¿åº¦ä¸ä½äºä¸€å®šå­—ç¬¦æ•°ç­‰ã€‚</p><p><strong>å®ä½“ç±»å®šä¹‰</strong></p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ª <code>BlogPost</code> ç±»ï¼Œå®ƒåŒ…å«æ–‡ç« çš„æ ‡é¢˜å’Œå†…å®¹ï¼Œè¿™äº›å­—æ®µéƒ½æœ‰ç‰¹å®šçš„éªŒè¯è§„åˆ™ï¼š</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">import</span> javax.<span class="hljs-property">validation</span>.<span class="hljs-property">constraints</span>.<span class="hljs-property">NotBlank</span>;<br><span class="hljs-keyword">import</span> javax.<span class="hljs-property">validation</span>.<span class="hljs-property">constraints</span>.<span class="hljs-property">Size</span>;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BlogPost</span> &#123;<br><br>    <span class="hljs-meta">@NotBlank</span>(message = <span class="hljs-string">&quot;Title is required&quot;</span>)<br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> title;<br><br>    <span class="hljs-meta">@NotBlank</span>(message = <span class="hljs-string">&quot;Content is required&quot;</span>)<br>    <span class="hljs-meta">@Size</span>(min = <span class="hljs-number">100</span>, message = <span class="hljs-string">&quot;Content must be at least 100 characters long&quot;</span>)<br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> content;<br><br>    <span class="hljs-comment">// Getters and setters</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">getTitle</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> title;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">setTitle</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> title</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">title</span> = title;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">getContent</span>(<span class="hljs-params"></span>) &#123;<br>        <span class="hljs-keyword">return</span> content;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">setContent</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> content</span>) &#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">content</span> = content;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>æ§åˆ¶å™¨æ–¹æ³•</strong></p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªRESTæ§åˆ¶å™¨æ–¹æ³•æ¥æ¥æ”¶åšå®¢æ–‡ç« çš„æ•°æ®ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">import</span> org.springframework.validation.BindingResult;<br><span class="hljs-keyword">import</span> org.springframework.validation.<span class="hljs-keyword">annotation</span>.Validated;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.<span class="hljs-keyword">annotation</span>.PostMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.<span class="hljs-keyword">annotation</span>.RequestBody;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.<span class="hljs-keyword">annotation</span>.RestController;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BlogController</span> &#123;<br><br>    <span class="hljs-meta">@PostMapping(<span class="hljs-string">&quot;/createBlog&quot;</span>)</span><br>    <span class="hljs-keyword">public</span> String createBlog(<span class="hljs-meta">@Validated</span> <span class="hljs-meta">@RequestBody</span> BlogPost blogPost, BindingResult result) &#123;<br>        <span class="hljs-keyword">if</span> (result.hasErrors()) &#123;<br>            <span class="hljs-comment">// å¤„ç†éªŒè¯é”™è¯¯ï¼Œä¾‹å¦‚è¿”å›é”™è¯¯ä¿¡æ¯</span><br>            <span class="hljs-keyword">return</span> result.getFieldError().getDefaultMessage();<br>        &#125;<br>        <span class="hljs-comment">// å¦‚æœæ•°æ®æœ‰æ•ˆï¼Œæ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼Œä¾‹å¦‚ä¿å­˜åšå®¢æ–‡ç« </span><br>        <span class="hljs-comment">// saveBlogPost(blogPost);</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Blog post created successfully&quot;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è§£é‡Šä¸€ä¸‹ä¸Šé¢çš„ç”¨æ³•</p><ul><li><code>BlogPost</code> ç±»ä¸­çš„å­—æ®µ <code>title</code> å’Œ <code>content</code> ä½¿ç”¨äº†JSR 380ï¼ˆHibernate Validatorï¼‰æ³¨è§£æ¥å£°æ˜éªŒè¯è§„åˆ™ã€‚<code>@NotBlank</code> ç¡®ä¿å­—æ®µä¸ä¸ºç©ºï¼Œ<code>@Size</code> æŒ‡å®šäº† <code>content</code> å­—æ®µçš„æœ€å°é•¿åº¦ã€‚</li><li>åœ¨ <code>BlogController</code> çš„ <code>createBlog</code> æ–¹æ³•ä¸­ï¼Œ<code>@Validated</code> æ³¨è§£ç”¨äºå¯ç”¨å¯¹ <code>@RequestBody</code> æ³¨è§£çš„ <code>BlogPost</code> å¯¹è±¡çš„è‡ªåŠ¨éªŒè¯ã€‚</li><li><code>BindingResult</code> å‚æ•°ç”¨äºæ•è·ä»»ä½•éªŒè¯é”™è¯¯ã€‚å¦‚æœå­˜åœ¨é”™è¯¯ï¼Œå¯ä»¥ä» <code>BindingResult</code> ä¸­è·å–é”™è¯¯ä¿¡æ¯å¹¶é€‚å½“å“åº”ã€‚</li></ul><p>åœ¨æ¥å£è°ƒç”¨çš„æ—¶å€™ï¼Œå½“å®¢æˆ·ç«¯å‘é€POSTè¯·æ±‚åˆ° <code>/createBlog</code> ç«¯ç‚¹ï¼Œå¹¶æä¾›JSONæ ¼å¼çš„åšå®¢æ–‡ç« æ•°æ®æ—¶ï¼ŒSpringå°†è‡ªåŠ¨éªŒè¯è¯¥æ•°æ®æ˜¯å¦ç¬¦åˆ <code>BlogPost</code> ç±»ä¸­å®šä¹‰çš„è§„åˆ™ã€‚å¦‚æœæ•°æ®ä¸ç¬¦åˆè§„åˆ™ï¼Œå°†è¿”å›ç›¸åº”çš„é”™è¯¯ä¿¡æ¯ã€‚</p><h4 id="å¦‚æœéœ€è¦ä½¿ç”¨éªŒè¯ç»„ï¼Œæ˜¯å¦‚ä½•ä½¿ç”¨çš„"><a href="#å¦‚æœéœ€è¦ä½¿ç”¨éªŒè¯ç»„ï¼Œæ˜¯å¦‚ä½•ä½¿ç”¨çš„" class="headerlink" title="å¦‚æœéœ€è¦ä½¿ç”¨éªŒè¯ç»„ï¼Œæ˜¯å¦‚ä½•ä½¿ç”¨çš„"></a>å¦‚æœéœ€è¦ä½¿ç”¨éªŒè¯ç»„ï¼Œæ˜¯å¦‚ä½•ä½¿ç”¨çš„</h4><blockquote><p>ä½¿ç”¨ç¤ºä¾‹2</p></blockquote><p>è¿™é‡Œä¸»è¦è¯´æ˜ä¸€ä¸‹éªŒè¯ç»„çš„ä½¿ç”¨</p><p>åœ¨Springæ¡†æ¶ä¸­ï¼Œå½“ <code>@Validated</code> æ³¨è§£è¢«åº”ç”¨äºä¸€ä¸ªæ–¹æ³•å‚æ•°ï¼Œå¹¶ä¸”æŒ‡å®šäº†ä¸€ä¸ªæˆ–å¤šä¸ªç»„ç±»ï¼Œè¿›è¡ŒéªŒè¯æ—¶åªä¼šè€ƒè™‘é‚£äº›å±äºæŒ‡å®šç»„çš„éªŒè¯çº¦æŸã€‚</p><p><strong>éªŒè¯ç»„çš„ä½œç”¨</strong></p><ol><li><strong>åˆ†ç»„éªŒè¯</strong>:<ul><li>éªŒè¯ç»„å…è®¸ä½ å°†ä¸€ä¸ªå®ä½“ç±»ï¼ˆå¦‚ <code>BlogVO</code>ï¼‰çš„éªŒè¯è§„åˆ™åˆ†æˆä¸åŒçš„ç»„ã€‚è¿™æ ·ï¼Œä½ å¯ä»¥åœ¨ä¸åŒçš„åœºæ™¯ä¸‹åº”ç”¨ä¸åŒçš„éªŒè¯è§„åˆ™é›†åˆã€‚</li><li>ä¾‹å¦‚ï¼Œä¸€ä¸ªå®ä½“åœ¨åˆ›å»ºæ—¶å¯èƒ½éœ€è¦ä¸€ç»„éªŒè¯è§„åˆ™ï¼Œåœ¨æ›´æ–°æ—¶éœ€è¦å¦ä¸€ç»„è§„åˆ™ã€‚</li></ul></li><li><strong>å®šä¹‰éªŒè¯ç»„</strong>:<ul><li>éªŒè¯ç»„é€šå¸¸æ˜¯ç©ºæ¥å£ï¼Œç”¨äºæ ‡è¯†éªŒè¯è§„åˆ™å±äºå“ªä¸ªç»„ã€‚</li><li>ä¾‹å¦‚ï¼Œ<code>public interface GetList &#123;&#125;</code> å¯ä»¥ä½œä¸ºä¸€ä¸ªéªŒè¯ç»„çš„å£°æ˜ã€‚</li></ul></li></ol><p><strong>ä»£ç ç¤ºä¾‹</strong></p><p>å®ä½“ç±»ä¸­çš„éªŒè¯è§„åˆ™</p><p>åœ¨ <code>BlogVO</code> å®ä½“ç±»ä¸­ï¼ŒéªŒè¯æ³¨è§£å¯èƒ½åƒè¿™æ ·ä½¿ç”¨ï¼š</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Blog</span>VO &#123;<br><br>    <span class="hljs-variable">@NotBlank</span>(groups = <span class="hljs-title class_">GetList</span>.<span class="hljs-keyword">class</span>, message = <span class="hljs-string">&quot;Title cannot be empty when getting list&quot;</span>)<br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">String</span> title;<br><br>    <span class="hljs-regexp">//</span> å…¶ä»–å­—æ®µå’Œgetter/setter<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªä¾‹å­ä¸­ï¼š</p><ul><li><code>@NotBlank</code> æ³¨è§£åªæœ‰åœ¨æ‰§è¡Œé’ˆå¯¹ <code>GetList</code> ç»„çš„éªŒè¯æ—¶æ‰ä¼šç”Ÿæ•ˆã€‚</li><li>å¦‚æœåœ¨ä¸€ä¸ªæ–¹æ³•ä¸­ä½¿ç”¨äº† <code>@Validated(&#123;GetList.class&#125;)</code> å¯¹ <code>BlogVO</code> å®ä¾‹è¿›è¡ŒéªŒè¯ï¼Œé‚£ä¹ˆåªæœ‰é‚£äº›æŒ‡å®šä¸º <code>GetList</code> ç»„çš„éªŒè¯è§„åˆ™ï¼ˆå¦‚ä¸Šé¢çš„ <code>title</code> å­—æ®µï¼‰ä¼šè¢«è€ƒè™‘ã€‚</li><li>è¿™ç§æ–¹å¼æä¾›äº†çµæ´»æ€§ï¼Œå…è®¸åœ¨ä¸åŒçš„æ“ä½œï¼ˆå¦‚è·å–åˆ—è¡¨ã€åˆ›å»ºã€æ›´æ–°ç­‰ï¼‰ä¸­é‡å¤ä½¿ç”¨åŒä¸€ä¸ªå®ä½“ç±»ï¼ŒåŒæ—¶åº”ç”¨ä¸åŒçš„éªŒè¯è§„åˆ™ã€‚</li></ul><p>æ§åˆ¶å™¨æ–¹æ³•</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@PostMapping</span>(<span class="hljs-string">&quot;/getList&quot;</span>)  <br>public String <span class="hljs-built_in">getList</span>(<span class="hljs-variable">@Validated</span>(&#123;GetList.class&#125;) <span class="hljs-variable">@RequestBody</span> BlogVO blogVO, BindingResult result) &#123;  <br>  <br>    <span class="hljs-selector-tag">ThrowableUtils</span><span class="hljs-selector-class">.checkParamArgument</span>(result);  <br>    <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResultUtil</span><span class="hljs-selector-class">.successWithData</span>(blogService.<span class="hljs-built_in">getPageList</span>(blogVO));  <br>&#125;<br></code></pre></td></tr></table></figure><p>GetList æ¥å£å®šä¹‰</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">/**  </span><br><span class="hljs-comment"> * GetList Group  ç”¨äºgetListæ–¹æ³•æŸ¥è¯¢æ—¶  </span><br><span class="hljs-comment"> *  </span><br><span class="hljs-comment"> * <span class="hljs-doctag">@author</span>: é™Œæºª  </span><br><span class="hljs-comment"> * <span class="hljs-doctag">@date</span>: 2019å¹´12æœˆ4æ—¥22:49:01  </span><br><span class="hljs-comment"> */</span><br> <span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">GetList</span> &#123;  <br>&#125;<br></code></pre></td></tr></table></figure><ul><li><code>@Validated(&#123;GetList.class&#125;)</code> è¡¨æ˜åªæœ‰æ ‡è®°ä¸º <code>GetList</code> ç»„çš„éªŒè¯çº¦æŸä¼šè¢«åº”ç”¨äº <code>BlogVO</code> å¯¹è±¡ã€‚</li><li>è¿™æ„å‘³ç€ <code>BlogVO</code> ç±»ä¸­çš„æŸäº›éªŒè¯æ³¨è§£å¯èƒ½è¢«æŒ‡å®šä¸ºä»…åœ¨ <code>GetList</code> ç»„ä¸Šä¸‹æ–‡ä¸­æœ‰æ•ˆã€‚</li></ul><hr><h3 id="3ã€æŠ›å‡ºå¼‚å¸¸å·¥å…·ç±»ThrowableUtils"><a href="#3ã€æŠ›å‡ºå¼‚å¸¸å·¥å…·ç±»ThrowableUtils" class="headerlink" title="3ã€æŠ›å‡ºå¼‚å¸¸å·¥å…·ç±»ThrowableUtils"></a>3ã€æŠ›å‡ºå¼‚å¸¸å·¥å…·ç±»ThrowableUtils</h3><p>è¿™ä¸ªç±»ä¸»è¦ç”¨æ³•æ˜¯å¤„ç†éªŒè¯ç»“æœï¼Œå½“ä¼ å…¥æ¥å£æ•°æ®æ—¶ï¼Œæ˜ å°„å¯¹è±¡  BlogVO é‡Œé¢çš„å‚æ•°æ ¡éªŒï¼Œå¯¹åº”çš„éªŒè¯ç»“æœ  result ï¼Œå¯¹éªŒè¯ç»“æœè¿›è¡Œå¤„ç†</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æŠ›å‡ºå¼‚å¸¸å·¥å…·ç±»</span><br><span class="hljs-comment"> * ç”¨äºå¤„ç†å’Œæ ¼å¼åŒ–ç”±Spring Validationæ¡†æ¶æŠ›å‡ºçš„éªŒè¯é”™è¯¯ã€‚</span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> * @author é™Œæºª</span><br><span class="hljs-comment"> * @date 2019å¹´12æœˆ4æ—¥22:47:18</span><br><span class="hljs-comment"> */</span><br>public <span class="hljs-keyword">class</span> ThrowableUtils &#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ ¡éªŒå‚æ•°æ­£ç¡®æ€§ï¼Œå¦‚æœå‘ç°éªŒè¯é”™è¯¯ï¼Œåˆ™æ‹¼è£…å¹¶æŠ›å‡ºè‡ªå®šä¹‰å¼‚å¸¸ã€‚</span><br><span class="hljs-comment">     * è¿™ä¸ªæ–¹æ³•ä¸»è¦ç”¨äºå¤„ç†ç”±Spring Validationæ¡†æ¶äº§ç”Ÿçš„éªŒè¯é”™è¯¯ã€‚</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * @param result BindingResultå¯¹è±¡ï¼ŒåŒ…å«éªŒè¯è¿‡ç¨‹ä¸­äº§ç”Ÿçš„é”™è¯¯ä¿¡æ¯ã€‚</span><br><span class="hljs-comment">     */</span><br>    public static void checkParamArgument(BindingResult result) &#123;<br>        <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦å­˜åœ¨éªŒè¯é”™è¯¯</span><br>        <span class="hljs-keyword">if</span> (result != null &amp;&amp; result.hasErrors()) &#123;<br>            StringBuilder sb = new StringBuilder();<br><br>            <span class="hljs-comment">// è·å–æ‰€æœ‰å­—æ®µçº§åˆ«çš„é”™è¯¯</span><br>            <span class="hljs-keyword">List</span>&lt;FieldError&gt; errors = result.getFieldErrors();<br>            <span class="hljs-keyword">if</span> (CollectionUtil.isNotEmpty(errors)) &#123;<br>                <span class="hljs-comment">// åªå¤„ç†ç¬¬ä¸€ä¸ªé”™è¯¯</span><br>                FieldError <span class="hljs-keyword">error</span> = errors.<span class="hljs-built_in">get</span>(0);<br>                <br>                <span class="hljs-comment">// è·å–è¢«æ‹’ç»çš„å€¼ï¼ˆå³ä¸åˆæ³•çš„è¾“å…¥å€¼ï¼‰</span><br>                String rejectedValue = Objects.<span class="hljs-keyword">toString</span>(<span class="hljs-keyword">error</span>.getRejectedValue(), <span class="hljs-string">&quot;&quot;</span>);<br>                <span class="hljs-comment">// è·å–é»˜è®¤é”™è¯¯ä¿¡æ¯</span><br>                String defMsg = <span class="hljs-keyword">error</span>.getDefaultMessage();<br><br>                <span class="hljs-comment">// æ’é™¤åœ¨ç±»çº§åˆ«ä¸Šçš„æ³¨è§£æç¤º</span><br>                <span class="hljs-keyword">if</span> (rejectedValue.contains(Constants.DELIMITER_TO)) &#123;<br>                    <span class="hljs-comment">// å¯¹äºç±»çº§åˆ«çš„é”™è¯¯ï¼Œç›´æ¥ä½¿ç”¨é”™è¯¯ä¿¡æ¯</span><br>                    sb.<span class="hljs-keyword">append</span>(defMsg);<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-comment">// å¯¹äºå­—æ®µçº§åˆ«çš„é”™è¯¯ï¼Œæ‹¼æ¥å­—æ®µåå’Œé”™è¯¯ä¿¡æ¯</span><br>                    <span class="hljs-keyword">if</span> (Constants.DELIMITER_COLON.contains(defMsg)) &#123;<br>                        sb.<span class="hljs-keyword">append</span>(<span class="hljs-keyword">error</span>.getField()).<span class="hljs-keyword">append</span>(<span class="hljs-string">&quot; &quot;</span>).<span class="hljs-keyword">append</span>(defMsg);<br>                    &#125; <span class="hljs-keyword">else</span> &#123;<br>                        sb.<span class="hljs-keyword">append</span>(<span class="hljs-keyword">error</span>.getField()).<span class="hljs-keyword">append</span>(<span class="hljs-string">&quot; &quot;</span>).<span class="hljs-keyword">append</span>(defMsg);<br>                    &#125;<br>                &#125;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-comment">// å¤„ç†éå­—æ®µçº§åˆ«çš„é”™è¯¯ï¼ˆå¦‚ç±»çº§åˆ«çš„é”™è¯¯ï¼‰</span><br>                String msg = result.getAllErrors().<span class="hljs-built_in">get</span>(0).getDefaultMessage();<br>                sb.<span class="hljs-keyword">append</span>(msg);<br>            &#125;<br>            <br>            <span class="hljs-comment">// æŠ›å‡ºè‡ªå®šä¹‰å¼‚å¸¸ï¼ŒåŒ…å«å¤„ç†è¿‡çš„é”™è¯¯ä¿¡æ¯</span><br>            throw new ApiInvalidParamException(sb.<span class="hljs-keyword">toString</span>());<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="4ã€è‡ªå®šä¹‰å¼‚å¸¸-ApiInvalidParamException-çš„ä½¿ç”¨"><a href="#4ã€è‡ªå®šä¹‰å¼‚å¸¸-ApiInvalidParamException-çš„ä½¿ç”¨" class="headerlink" title="4ã€è‡ªå®šä¹‰å¼‚å¸¸ ApiInvalidParamException çš„ä½¿ç”¨"></a>4ã€è‡ªå®šä¹‰å¼‚å¸¸ ApiInvalidParamException çš„ä½¿ç”¨</h3><p><code>ApiInvalidParamException</code> ç±»æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰å¼‚å¸¸ç±»ï¼Œç»§æ‰¿è‡ª <code>RuntimeException</code>ã€‚å…¶ä¸»è¦ä½œç”¨æ˜¯å°è£…å’Œè¡¨ç¤ºä¸APIå‚æ•°ç›¸å…³çš„é”™è¯¯æˆ–å¼‚å¸¸æƒ…å†µã€‚</p><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs aspectj"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * è‡ªå®šä¹‰çš„è¿è¡Œæ—¶å¼‚å¸¸ç±»ï¼Œç”¨äºè¡¨ç¤ºAPIæ“ä½œä¸­çš„å‚æ•°æ— æ•ˆæˆ–ä¸ç¬¦åˆé¢„æœŸçš„æƒ…å†µã€‚</span><br><span class="hljs-comment"> * è¿™ä¸ªç±»ä¸»è¦ç”¨äºåœ¨APIå±‚æŠ›å‡ºå‚æ•°ç›¸å…³çš„å¼‚å¸¸ï¼Œå¹¶èƒ½å¤Ÿè¢«å…¨å±€å¼‚å¸¸å¤„ç†å™¨æ•è·å’Œå¤„ç†ï¼Œ</span><br><span class="hljs-comment"> * ä»¥ä¾¿è¿”å›ç»Ÿä¸€æ ¼å¼çš„é”™è¯¯å“åº”ç»™å®¢æˆ·ç«¯ã€‚</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ApiInvalidParamException</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">RuntimeException</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">long</span> serialVersionUID = <span class="hljs-number">1</span>L;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ— å‚æ„é€ å‡½æ•°ã€‚</span><br><span class="hljs-comment">     * åˆ›å»ºä¸€ä¸ªæ²¡æœ‰è¯¦ç»†é”™è¯¯æ¶ˆæ¯çš„ApiInvalidParamExceptionå¼‚å¸¸å®ä¾‹ã€‚</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ApiInvalidParamException</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>();<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å¸¦æ¶ˆæ¯å’ŒåŸå› çš„æ„é€ å‡½æ•°ã€‚</span><br><span class="hljs-comment">     * åˆ›å»ºä¸€ä¸ªåŒ…å«å…·ä½“é”™è¯¯æè¿°å’ŒåŸå› çš„ApiInvalidParamExceptionå¼‚å¸¸å®ä¾‹ã€‚</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> message æè¿°å¼‚å¸¸çš„è¯¦ç»†ä¿¡æ¯ã€‚</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> cause å¼•å‘æ­¤å¼‚å¸¸çš„åŸå› ã€‚</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ApiInvalidParamException</span><span class="hljs-params">(String message, Throwable cause)</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>(message, cause);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å¸¦æ¶ˆæ¯çš„æ„é€ å‡½æ•°ã€‚</span><br><span class="hljs-comment">     * åˆ›å»ºä¸€ä¸ªåŒ…å«å…·ä½“é”™è¯¯æè¿°çš„ApiInvalidParamExceptionå¼‚å¸¸å®ä¾‹ã€‚</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> message æè¿°å¼‚å¸¸çš„è¯¦ç»†ä¿¡æ¯ã€‚</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ApiInvalidParamException</span><span class="hljs-params">(String message)</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>(message);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å¸¦åŸå› çš„æ„é€ å‡½æ•°ã€‚</span><br><span class="hljs-comment">     * åˆ›å»ºä¸€ä¸ªåŒ…å«åŸå› çš„ApiInvalidParamExceptionå¼‚å¸¸å®ä¾‹ï¼Œä½†ä¸æä¾›è¯¦ç»†ä¿¡æ¯ã€‚</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> cause å¼•å‘æ­¤å¼‚å¸¸çš„åŸå› ã€‚</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ApiInvalidParamException</span><span class="hljs-params">(Throwable cause)</span> </span>&#123;<br>        <span class="hljs-keyword">super</span>(cause);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»£ç è§£é‡Š</p><p>ç±»ä¸­å®šä¹‰äº†å‡ ä¸ªæ„é€ å‡½æ•°ï¼Œå…è®¸åœ¨åˆ›å»ºå¼‚å¸¸å®ä¾‹æ—¶æä¾›ä¸åŒç±»å‹çš„ä¿¡æ¯ï¼š</p><ol><li><p><strong>æ— å‚æ„é€ å‡½æ•°</strong>:</p><ul><li><code>public ApiInvalidParamException()</code>: åˆ›å»ºä¸€ä¸ªæ²¡æœ‰è¯¦ç»†é”™è¯¯æ¶ˆæ¯çš„å¼‚å¸¸å®ä¾‹ã€‚</li></ul></li><li><p><strong>å¸¦æ¶ˆæ¯çš„æ„é€ å‡½æ•°</strong>:</p><ul><li><code>public ApiInvalidParamException(String message)</code>: åˆ›å»ºä¸€ä¸ªå¸¦æœ‰å…·ä½“é”™è¯¯æè¿°çš„å¼‚å¸¸å®ä¾‹ã€‚</li></ul></li><li><p><strong>å¸¦æ¶ˆæ¯å’ŒåŸå› çš„æ„é€ å‡½æ•°</strong>:</p><ul><li><code>public ApiInvalidParamException(String message, Throwable cause)</code>: åˆ›å»ºä¸€ä¸ªå¼‚å¸¸å®ä¾‹ï¼ŒåŒæ—¶æä¾›é”™è¯¯æè¿°å’Œä¸€ä¸ªåŸå§‹å¼‚å¸¸ï¼ˆåŸå§‹å¼‚å¸¸è¡¨ç¤ºè¿™ä¸ªæ–°å¼‚å¸¸çš„åŸå› ï¼‰ã€‚</li></ul></li><li><p><strong>å¸¦åŸå› çš„æ„é€ å‡½æ•°</strong>:</p><ul><li><code>public ApiInvalidParamException(Throwable cause)</code>: åˆ›å»ºä¸€ä¸ªå¼‚å¸¸å®ä¾‹ï¼ŒåªåŒ…å«ä¸€ä¸ªåŸå§‹å¼‚å¸¸ã€‚</li></ul></li></ol><blockquote><p>è‡ªå®šä¹‰å¼‚å¸¸ç±»çš„ä½¿ç”¨</p></blockquote><p><strong>ä½¿ç”¨åœºæ™¯</strong></p><p>åœ¨APIçš„å„ä¸ªå±‚é¢ï¼ˆå¦‚æ§åˆ¶å™¨ã€æœåŠ¡æˆ–æ•°æ®è®¿é—®å±‚ï¼‰ä¸­ï¼Œå½“é‡åˆ°ä¸ç¬¦åˆè¦æ±‚çš„å‚æ•°æˆ–å…¶ä»–ä¸å‚æ•°ç›¸å…³çš„é—®é¢˜æ—¶ï¼Œå¯ä»¥æŠ›å‡º <code>ApiInvalidParamException</code>ã€‚</p><p>ç„¶åï¼Œå…¨å±€å¼‚å¸¸å¤„ç†å™¨å¯ä»¥æ•è·è¿™äº›å¼‚å¸¸ï¼Œå¹¶å°†å®ƒä»¬è½¬æ¢ä¸ºç»Ÿä¸€çš„ã€ç”¨æˆ·å‹å¥½çš„å“åº”æ ¼å¼ï¼Œå¦‚JSONï¼ŒåŒ…å«é”™è¯¯ä»£ç å’Œé”™è¯¯æ¶ˆæ¯ã€‚</p><p><strong>ä½œç”¨å’Œç”¨é€”</strong></p><ol><li><strong>è‡ªå®šä¹‰å¼‚å¸¸å¤„ç†</strong>:<ul><li>è¿™ä¸ªç±»ç”¨äºè¡¨ç¤ºåœ¨APIä¸­é‡åˆ°çš„ç‰¹å®šç±»å‹çš„å‚æ•°é”™è¯¯ã€‚é€šè¿‡åˆ›å»ºè¿™æ ·çš„è‡ªå®šä¹‰å¼‚å¸¸ï¼Œå¯ä»¥æ›´æ¸…æ™°åœ°è¡¨è¾¾ä»£ç ä¸­å¯èƒ½å‡ºç°çš„ç‰¹å®šé”™è¯¯æƒ…å†µã€‚</li></ul></li><li><strong>å…¨å±€å¼‚å¸¸æ‹¦æˆª</strong>:<ul><li>åœ¨ä¸€ä¸ªåŸºäºSpring Bootçš„REST APIé¡¹ç›®ä¸­ï¼Œé€šå¸¸ä¼šæœ‰ä¸€ä¸ªå…¨å±€å¼‚å¸¸å¤„ç†å™¨ï¼ˆå¦‚ä½¿ç”¨ <code>@ControllerAdvice</code> æ³¨è§£çš„ç±»ï¼‰ã€‚</li><li><code>ApiInvalidParamException</code> å¯ä»¥è¢«è¿™æ ·çš„å…¨å±€å¤„ç†å™¨æ•è·ï¼Œå¹¶è½¬æ¢ä¸ºç»Ÿä¸€çš„å“åº”æ ¼å¼å‘é€ç»™APIçš„è°ƒç”¨è€…ã€‚è¿™æœ‰åŠ©äºç»´æŒAPIçš„å“åº”æ ¼å¼çš„ä¸€è‡´æ€§ã€‚</li></ul></li><li><strong>é”™è¯¯æ¶ˆæ¯å®šåˆ¶</strong>:<ul><li>è¿™ä¸ªå¼‚å¸¸ç±»å…è®¸åœ¨æŠ›å‡ºå¼‚å¸¸æ—¶é™„å¸¦ä¸€ä¸ªè‡ªå®šä¹‰çš„é”™è¯¯æ¶ˆæ¯ï¼Œè¿™å¯¹äºæä¾›æ›´è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼Œå“ªä¸ªå‚æ•°é”™è¯¯ä»¥åŠä¸ºä»€ä¹ˆé”™è¯¯ï¼‰éå¸¸æœ‰ç”¨ã€‚</li></ul></li></ol><h3 id="5ã€å…¨å±€å¼‚å¸¸å¤„ç†"><a href="#5ã€å…¨å±€å¼‚å¸¸å¤„ç†" class="headerlink" title="5ã€å…¨å±€å¼‚å¸¸å¤„ç†"></a>5ã€å…¨å±€å¼‚å¸¸å¤„ç†</h3><p><code>GlobalExceptionConfig</code> ç±»å’Œ <code>HandlerExceptionResolver</code> ç±»æ˜¯Springæ¡†æ¶ä¸­ç”¨äºå…¨å±€å¼‚å¸¸å¤„ç†çš„é…ç½®å’Œå®ç°</p><p>é’ˆå¯¹è˜‘è‡åšå®¢ç›¸å…³å®ç°ï¼Œè¿›è¡Œè¯´æ˜</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs haxe"><span class="hljs-meta">@Configuration  </span><br><span class="hljs-keyword">public</span> <span class="hljs-title class_"><span class="hljs-keyword">class</span> <span class="hljs-title">GlobalExceptionConfig</span> </span>&#123;  <br>  <br>    <span class="hljs-meta">@Bean  </span><br>    <span class="hljs-keyword">public</span> HandlerExceptionResolver getHandlerExceptionResolver() &#123;  <br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-type">HandlerExceptionResolver</span>();  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><ul><li><code>@Configuration</code>: è¡¨ç¤ºè¿™ä¸ªç±»åŒ…å«Springå®¹å™¨çš„beanå®šä¹‰ã€‚</li><li><code>@Bean</code>: è¡¨ç¤ºè¯¥æ–¹æ³•å°†è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡åº”è¯¥è¢«æ³¨å†Œä¸ºSpringåº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ä¸­çš„beanã€‚</li><li><code>getHandlerExceptionResolver()</code>: è¿™ä¸ªæ–¹æ³•åˆ›å»ºå¹¶è¿”å› <code>HandlerExceptionResolver</code> çš„ä¸€ä¸ªå®ä¾‹ï¼Œç”¨äºå…¨å±€å¼‚å¸¸å¤„ç†</li></ul><blockquote><p>HandlerExceptionResolver ç±»è§£é‡Š</p></blockquote><p><code>HandlerExceptionResolver</code> ç±»å®ç°äº†Springçš„ <code>HandlerExceptionResolver</code> æ¥å£ï¼Œç”¨äºå¤„ç†Spring MVCæŠ›å‡ºçš„æ‰€æœ‰å¼‚å¸¸ã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-meta">@Slf4j</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HandlerExceptionResolver</span> <span class="hljs-keyword">implements</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">web</span>.<span class="hljs-property">servlet</span>.<span class="hljs-property">HandlerExceptionResolver</span> &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title class_">ModelAndView</span> <span class="hljs-title function_">resolveException</span>(<span class="hljs-params">HttpServletRequest request, HttpServletResponse response, <span class="hljs-built_in">Object</span> handler, Exception exception</span>) &#123;<br>        <span class="hljs-comment">// å¼‚å¸¸å¤„ç†é€»è¾‘...</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li><code>@Slf4j</code>: Lombokåº“æä¾›çš„æ³¨è§£ï¼Œä¸ºç±»æä¾›äº†ä¸€ä¸ªæ—¥å¿—å¯¹è±¡ <code>log</code>ã€‚</li><li><code>resolveException(...)</code>: è¿™æ˜¯å¼‚å¸¸å¤„ç†çš„æ ¸å¿ƒæ–¹æ³•ï¼Œå®ƒæ¥æ”¶å‘ç”Ÿå¼‚å¸¸çš„HTTPè¯·æ±‚å’Œå“åº”ã€å¤„ç†å™¨ï¼ˆhandlerï¼‰å¯¹è±¡ä»¥åŠå®é™…æŠ›å‡ºçš„å¼‚å¸¸ã€‚</li><li>åœ¨è¿™ä¸ªæ–¹æ³•å†…éƒ¨ï¼Œå¯ä»¥æ ¹æ®ä¸åŒç±»å‹çš„å¼‚å¸¸è¿›è¡Œå¤„ç†ï¼Œå¹¶ç”Ÿæˆé€‚å½“çš„å“åº”</li></ul><p>å…·ä½“ä»£ç åˆ†æ</p><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs aspectj"><span class="hljs-meta">@Slf</span>4j<br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HandlerExceptionResolver</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">org</span>.<span class="hljs-title">springframework</span>.<span class="hljs-title">web</span>.<span class="hljs-title">servlet</span>.<span class="hljs-title">HandlerExceptionResolver</span> </span>&#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å¤„ç†Spring MVCæŠ›å‡ºçš„æ‰€æœ‰å¼‚å¸¸ã€‚</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> request   å½“å‰çš„HTTPè¯·æ±‚</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> response  å½“å‰çš„HTTPå“åº”</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> handler   å¤„ç†å½“å‰è¯·æ±‚çš„å¤„ç†å™¨</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> exception æŠ›å‡ºçš„å¼‚å¸¸</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> ModelAndView - Spring MVCçš„æ¨¡å‹å’Œè§†å›¾å¯¹è±¡</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-function">ModelAndView <span class="hljs-title">resolveException</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object <span class="hljs-keyword">handler</span>, Exception exception)</span> </span>&#123;<br>        log.<span class="hljs-keyword">error</span>(<span class="hljs-string">&quot;ç³»ç»Ÿç»Ÿä¸€å¼‚å¸¸å¤„ç†ï¼š&quot;</span>, exception);<br><br>        <span class="hljs-comment">// æ£€æŸ¥å“åº”æ˜¯å¦å·²ç»æäº¤</span><br>        <span class="hljs-keyword">if</span> (response.isCommitted()) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView();<br>        &#125;<br><br>        <span class="hljs-comment">// åˆå§‹åŒ–é”™è¯¯ä»£ç å’Œä¿¡æ¯</span><br>        String errorCode = ErrorCode.ERROR;<br>        String message = BaseMessageConf.OPERATION_FAIL;<br><br>        <span class="hljs-comment">// æ ¹æ®å¼‚å¸¸ç±»å‹è®¾ç½®ä¸åŒçš„é”™è¯¯ä»£ç å’Œæ¶ˆæ¯</span><br>        <span class="hljs-keyword">if</span> (exception <span class="hljs-keyword">instanceof</span> BusinessException) &#123;<br>            errorCode = ((BusinessException) exception).getCode();<br>            message = exception.getMessage();<br>        &#125; <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span> <span class="hljs-params">(exception <span class="hljs-keyword">instanceof</span> ApiInvalidParamException)</span> </span>&#123;<br>            errorCode = ErrorCode.PARAM_INCORRECT;<br>            message = exception.getMessage();<br>        &#125;<br>        <span class="hljs-comment">// ...å¤„ç†å…¶ä»–è‡ªå®šä¹‰å¼‚å¸¸</span><br><br>        <span class="hljs-comment">// è®¾ç½®å“åº”ç±»å‹ä¸ºJSON</span><br>        response.setContentType(MediaType.APPLICATION_JSON_UTF8_VALUE);<br><br>        <span class="hljs-comment">// å‘å®¢æˆ·ç«¯è¾“å‡ºé”™è¯¯ä¿¡æ¯</span><br>        <span class="hljs-keyword">try</span> (PrintWriter writer = response.getWriter()) &#123;<br>            writer.write(ResultUtil.resultWithMessage(errorCode, message));<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            log.<span class="hljs-keyword">error</span>(<span class="hljs-string">&quot;å“åº”è¾“å‡ºå¤±è´¥ï¼åŸå› å¦‚ä¸‹ï¼š&quot;</span>, e);<br>        &#125;<br><br>        <span class="hljs-comment">// è¿”å›ä¸€ä¸ªç©ºçš„ModelAndViewè¡¨ç¤ºå·²æ‰‹åŠ¨å¤„ç†å“åº”</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelAndView();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªç±»ä¸­ï¼Œ<code>resolveException</code> æ–¹æ³•æ ¹æ®æ•è·åˆ°çš„å¼‚å¸¸ç±»å‹ï¼Œå¯¹é”™è¯¯ä¿¡æ¯è¿›è¡Œå®šåˆ¶ï¼Œå¹¶å°†å®šåˆ¶çš„é”™è¯¯æ¶ˆæ¯ä»¥JSONæ ¼å¼å†™å…¥HTTPå“åº”ã€‚</p><p>è¿™ç§æ–¹å¼æœ‰åŠ©äºå®ç°ç»Ÿä¸€çš„é”™è¯¯å¤„ç†é€»è¾‘ï¼Œä½¿å¾—APIçš„é”™è¯¯å“åº”æ›´åŠ ä¸€è‡´å’Œæ ‡å‡†åŒ–ã€‚</p><h3 id="6ã€è¿”å›ç»Ÿä¸€æ¥å£ResultUtil"><a href="#6ã€è¿”å›ç»Ÿä¸€æ¥å£ResultUtil" class="headerlink" title="6ã€è¿”å›ç»Ÿä¸€æ¥å£ResultUtil"></a>6ã€è¿”å›ç»Ÿä¸€æ¥å£ResultUtil</h3><figure class="highlight wren"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><code class="hljs wren"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * å·¥å…·ç±»ç”¨äºæ„å»ºç»Ÿä¸€çš„APIå“åº”æ ¼å¼ã€‚</span><br><span class="hljs-comment"> * æä¾›äº†ä¸€ç³»åˆ—æ–¹æ³•æ¥ç”Ÿæˆæ ‡å‡†åŒ–çš„JSONå­—ç¬¦ä¸²å“åº”ï¼Œ</span><br><span class="hljs-comment"> * åŒ…æ‹¬æˆåŠŸæˆ–é”™è¯¯çš„çŠ¶æ€ä»£ç ã€æ¶ˆæ¯å’Œæ•°æ®ã€‚</span><br><span class="hljs-comment"> */</span><br><span class="hljs-variable">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ResultUtil</span> &#123;<br>    <span class="hljs-comment">// å¸¸é‡å®šä¹‰</span><br>    <span class="hljs-variable">final</span> <span class="hljs-keyword">static</span> <span class="hljs-title class_">String</span> <span class="hljs-variable">CODE</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;code&quot;</span>;<br>    <span class="hljs-variable">final</span> <span class="hljs-keyword">static</span> <span class="hljs-title class_">String</span> <span class="hljs-variable">SUCCESS</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;success&quot;</span>;<br>    <span class="hljs-variable">final</span> <span class="hljs-keyword">static</span> <span class="hljs-title class_">String</span> <span class="hljs-variable">ERROR</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;error&quot;</span>;<br>    <span class="hljs-variable">final</span> <span class="hljs-keyword">static</span> <span class="hljs-title class_">String</span> <span class="hljs-variable">DATA</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;data&quot;</span>;<br>    <span class="hljs-variable">final</span> <span class="hljs-keyword">static</span> <span class="hljs-title class_">String</span> <span class="hljs-variable">MESSAGE</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;message&quot;</span>;<br>    <span class="hljs-variable">final</span> <span class="hljs-keyword">static</span> int <span class="hljs-variable">NUM_TWO</span> <span class="hljs-operator">=</span> <span class="hljs-number">2</span>;<br>    <span class="hljs-variable">final</span> <span class="hljs-keyword">static</span> int <span class="hljs-variable">NUM_THREE</span> <span class="hljs-operator">=</span> <span class="hljs-number">3</span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ç”ŸæˆåŒ…å«çŠ¶æ€ç å’Œæ•°æ®çš„å“åº”ã€‚</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> code çŠ¶æ€ç </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> data æ•°æ®</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> JSONå­—ç¬¦ä¸²æ ¼å¼çš„å“åº”</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-variable">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">result</span>(<span class="hljs-params">Object</span> <span class="hljs-params">code</span>, <span class="hljs-params">Object</span> <span class="hljs-params">data</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">resultWithData</span>(<span class="hljs-variable">code</span>, <span class="hljs-variable">data</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ç”ŸæˆåªåŒ…å«æ•°æ®çš„å“åº”ã€‚</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> code çŠ¶æ€ç </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> data æ•°æ®</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> JSONå­—ç¬¦ä¸²æ ¼å¼çš„å“åº”</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-variable">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">resultWithData</span>(<span class="hljs-params">Object</span> <span class="hljs-params">code</span>, <span class="hljs-params">Object</span> <span class="hljs-params">data</span>) &#123;<br>        <span class="hljs-title class_">Map</span><span class="hljs-operator">&lt;</span><span class="hljs-title class_">Object</span>, <span class="hljs-title class_">Object</span><span class="hljs-operator">&gt;</span> <span class="hljs-variable">map</span> <span class="hljs-operator">=</span> <span class="hljs-variable">new</span> <span class="hljs-title class_">HashMap</span><span class="hljs-operator">&lt;</span><span class="hljs-operator">&gt;</span>(<span class="hljs-variable">NUM_TWO</span>);<br>        <span class="hljs-variable">map</span>.<span class="hljs-property">put</span>(<span class="hljs-variable">CODE</span>, <span class="hljs-variable">code</span>);<br>        <span class="hljs-variable">map</span>.<span class="hljs-property">put</span>(<span class="hljs-variable">DATA</span>, <span class="hljs-variable">data</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-title class_">JsonUtils</span>.<span class="hljs-property">objectToJson</span>(<span class="hljs-variable">map</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ç”ŸæˆåªåŒ…å«æ¶ˆæ¯çš„å“åº”ã€‚</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> code çŠ¶æ€ç </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> message æ¶ˆæ¯</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> JSONå­—ç¬¦ä¸²æ ¼å¼çš„å“åº”</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-variable">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">resultWithMessage</span>(<span class="hljs-params">Object</span> <span class="hljs-params">code</span>, <span class="hljs-params">String</span> <span class="hljs-params">message</span>) &#123;<br>        <span class="hljs-title class_">Map</span><span class="hljs-operator">&lt;</span><span class="hljs-title class_">Object</span>, <span class="hljs-title class_">Object</span><span class="hljs-operator">&gt;</span> <span class="hljs-variable">map</span> <span class="hljs-operator">=</span> <span class="hljs-variable">new</span> <span class="hljs-title class_">HashMap</span><span class="hljs-operator">&lt;</span><span class="hljs-operator">&gt;</span>(<span class="hljs-variable">NUM_TWO</span>);<br>        <span class="hljs-variable">map</span>.<span class="hljs-property">put</span>(<span class="hljs-variable">CODE</span>, <span class="hljs-variable">code</span>);<br>        <span class="hljs-variable">map</span>.<span class="hljs-property">put</span>(<span class="hljs-variable">MESSAGE</span>, <span class="hljs-variable">message</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-title class_">JsonUtils</span>.<span class="hljs-property">objectToJson</span>(<span class="hljs-variable">map</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ç”ŸæˆåŒæ—¶åŒ…å«æ•°æ®å’Œæ¶ˆæ¯çš„å“åº”ã€‚</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> code çŠ¶æ€ç </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> data æ•°æ®</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> message æ¶ˆæ¯</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> JSONå­—ç¬¦ä¸²æ ¼å¼çš„å“åº”</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-variable">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">resultWithDataAndMessage</span>(<span class="hljs-params">Object</span> <span class="hljs-params">code</span>, <span class="hljs-params">Object</span> <span class="hljs-params">data</span>, <span class="hljs-params">String</span> <span class="hljs-params">message</span>) &#123;<br>        <span class="hljs-title class_">Map</span><span class="hljs-operator">&lt;</span><span class="hljs-title class_">Object</span>, <span class="hljs-title class_">Object</span><span class="hljs-operator">&gt;</span> <span class="hljs-variable">map</span> <span class="hljs-operator">=</span> <span class="hljs-variable">new</span> <span class="hljs-title class_">HashMap</span><span class="hljs-operator">&lt;</span><span class="hljs-operator">&gt;</span>(<span class="hljs-variable">NUM_THREE</span>);<br>        <span class="hljs-variable">map</span>.<span class="hljs-property">put</span>(<span class="hljs-variable">CODE</span>, <span class="hljs-variable">code</span>);<br>        <span class="hljs-variable">map</span>.<span class="hljs-property">put</span>(<span class="hljs-variable">DATA</span>, <span class="hljs-variable">data</span>);<br>        <span class="hljs-variable">map</span>.<span class="hljs-property">put</span>(<span class="hljs-variable">MESSAGE</span>, <span class="hljs-variable">message</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-title class_">JsonUtils</span>.<span class="hljs-property">objectToJson</span>(<span class="hljs-variable">map</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ç”Ÿæˆè¡¨ç¤ºæ“ä½œæˆåŠŸçš„å“åº”ï¼ŒåªåŒ…å«æ•°æ®ã€‚</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> data æ•°æ®</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> JSONå­—ç¬¦ä¸²æ ¼å¼çš„å“åº”</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-variable">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">successWithData</span>(<span class="hljs-params">Object</span> <span class="hljs-params">data</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">resultWithData</span>(<span class="hljs-variable">SUCCESS</span>, <span class="hljs-variable">data</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ç”Ÿæˆè¡¨ç¤ºæ“ä½œæˆåŠŸçš„å“åº”ï¼ŒåªåŒ…å«æ¶ˆæ¯ã€‚</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> message æ¶ˆæ¯</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> JSONå­—ç¬¦ä¸²æ ¼å¼çš„å“åº”</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-variable">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">successWithMessage</span>(<span class="hljs-params">String</span> <span class="hljs-params">message</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">resultWithMessage</span>(<span class="hljs-variable">SUCCESS</span>, <span class="hljs-variable">message</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ç”Ÿæˆè¡¨ç¤ºæ“ä½œæˆåŠŸçš„å“åº”ï¼ŒåŒæ—¶åŒ…å«æ•°æ®å’Œæ¶ˆæ¯ã€‚</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> data æ•°æ®</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> message æ¶ˆæ¯</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> JSONå­—ç¬¦ä¸²æ ¼å¼çš„å“åº”</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-variable">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">successWithDataAndMessage</span>(<span class="hljs-params">Object</span> <span class="hljs-params">data</span>, <span class="hljs-params">String</span> <span class="hljs-params">message</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">resultWithDataAndMessage</span>(<span class="hljs-variable">SUCCESS</span>, <span class="hljs-variable">data</span>, <span class="hljs-variable">message</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ç”Ÿæˆè¡¨ç¤ºæ“ä½œå¤±è´¥çš„å“åº”ï¼ŒåªåŒ…å«æ¶ˆæ¯ã€‚</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> message æ¶ˆæ¯</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> JSONå­—ç¬¦ä¸²æ ¼å¼çš„å“åº”</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-variable">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">errorWithMessage</span>(<span class="hljs-params">String</span> <span class="hljs-params">message</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">resultWithMessage</span>(<span class="hljs-variable">ERROR</span>, <span class="hljs-variable">message</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ç”Ÿæˆè¡¨ç¤ºæ“ä½œå¤±è´¥çš„å“åº”ï¼ŒåªåŒ…å«æ•°æ®ã€‚</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> data æ•°æ®</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> JSONå­—ç¬¦ä¸²æ ¼å¼çš„å“åº”</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-variable">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">errorWithData</span>(<span class="hljs-params">Object</span> <span class="hljs-params">data</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">resultWithData</span>(<span class="hljs-variable">ERROR</span>, <span class="hljs-variable">data</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><code>ResultUtil</code> æ˜¯ä¸€ä¸ªå·¥å…·ç±»ï¼Œç”¨äºåˆ›å»ºå’Œæ ¼å¼åŒ–APIå“åº”ã€‚å®ƒæä¾›äº†ä¸€ç³»åˆ—é™æ€æ–¹æ³•æ¥ç”Ÿæˆæ ‡å‡†åŒ–çš„JSONå­—ç¬¦ä¸²å“åº”ã€‚è¿™äº›æ–¹æ³•å…è®¸åŒ…å«å„ç§ç±»å‹çš„ä¿¡æ¯ï¼Œå¦‚çŠ¶æ€ç ã€æ•°æ®ã€æ¶ˆæ¯ç­‰ã€‚</p><blockquote><p>ç±»çš„ä½œç”¨</p></blockquote><ol><li><strong>ç»Ÿä¸€APIå“åº”æ ¼å¼</strong>:<ul><li><code>ResultUtil</code> ç±»ç”¨äºç”Ÿæˆå…·æœ‰ä¸€è‡´æ ¼å¼çš„APIå“åº”ã€‚è¿™æœ‰åŠ©äºå‰ç«¯å¼€å‘è€…ç†è§£å’Œå¤„ç†åç«¯å‘é€çš„æ•°æ®ã€‚</li></ul></li><li><strong>çµæ´»çš„å“åº”æ„å»º</strong>:<ul><li>æä¾›äº†å¤šç§æ–¹æ³•æ¥æ„å»ºå“åº”ï¼Œå¯ä»¥åªåŒ…å«æ•°æ®ã€åªåŒ…å«æ¶ˆæ¯æˆ–åŒæ—¶åŒ…å«æ•°æ®å’Œæ¶ˆæ¯ã€‚</li></ul></li></ol><blockquote><p>æ–¹æ³•è¯´æ˜</p></blockquote><ul><li><code>result(Object code, Object data)</code>: ç”ŸæˆåŒ…å«æŒ‡å®šä»£ç å’Œæ•°æ®çš„å“åº”ã€‚</li><li><code>resultWithData(Object code, Object data)</code>: ç”ŸæˆåªåŒ…å«æ•°æ®çš„å“åº”ã€‚</li><li><code>resultWithMessage(Object code, String message)</code>: ç”ŸæˆåªåŒ…å«æ¶ˆæ¯çš„å“åº”ã€‚</li><li><code>resultWithDataAndMessage(Object code, Object data, String message)</code>: ç”ŸæˆåŒæ—¶åŒ…å«æ•°æ®å’Œæ¶ˆæ¯çš„å“åº”ã€‚</li><li><code>successWithData(Object data)</code>: ç”Ÿæˆè¡¨ç¤ºæ“ä½œæˆåŠŸçš„å“åº”ï¼ŒåªåŒ…å«æ•°æ®ã€‚</li><li><code>successWithMessage(String message)</code>: ç”Ÿæˆè¡¨ç¤ºæ“ä½œæˆåŠŸçš„å“åº”ï¼ŒåªåŒ…å«æ¶ˆæ¯ã€‚</li><li><code>successWithDataAndMessage(Object data, String message)</code>: ç”Ÿæˆè¡¨ç¤ºæ“ä½œæˆåŠŸçš„å“åº”ï¼ŒåŒ…å«æ•°æ®å’Œæ¶ˆæ¯ã€‚</li><li><code>errorWithMessage(String message)</code>: ç”Ÿæˆè¡¨ç¤ºæ“ä½œå¤±è´¥çš„å“åº”ï¼ŒåªåŒ…å«æ¶ˆæ¯ã€‚</li><li><code>errorWithData(Object data)</code>: ç”Ÿæˆè¡¨ç¤ºæ“ä½œå¤±è´¥çš„å“åº”ï¼ŒåªåŒ…å«æ•°æ®ã€‚</li></ul><blockquote><p>ä½¿ç”¨ç¤ºä¾‹</p></blockquote><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs abnf">// è¿”å›æˆåŠŸå“åº”ï¼ŒåªåŒ…å«æ•°æ®<br>String response <span class="hljs-operator">=</span> ResultUtil.successWithData(someData)<span class="hljs-comment">;</span><br><br>// è¿”å›å¤±è´¥å“åº”ï¼ŒåªåŒ…å«é”™è¯¯æ¶ˆæ¯<br>String errorResponse <span class="hljs-operator">=</span> ResultUtil.errorWithMessage(<span class="hljs-string">&quot;An error occurred&quot;</span>)<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªç±»åœ¨å®é™…çš„APIå¼€å‘ä¸­éå¸¸æœ‰ç”¨ï¼Œå®ƒå¯ä»¥ç®€åŒ–å“åº”çš„åˆ›å»ºè¿‡ç¨‹ï¼Œå¹¶ç¡®ä¿APIçš„è¿”å›æ ¼å¼ç»Ÿä¸€å’Œæ ‡å‡†åŒ–ã€‚</p><p>å¯¹äºç»´æŠ¤APIçš„ä¸€è‡´æ€§å’Œå¯ç”¨æ€§éå¸¸é‡è¦ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>é¡¹ç›®</category>
      
    </categories>
    
    
    <tags>
      
      <tag>project</tag>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ¶ˆæ¯é˜Ÿåˆ—_åŸºç¡€æ¦‚å¿µ</title>
    <link href="/2023/12/11/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/"/>
    <url>/2023/12/11/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å¤§çº²</p></blockquote><ul><li>æ¶ˆæ¯é˜Ÿåˆ—çš„æ ¸å¿ƒä½¿ç”¨åœºæ™¯</li><li>æŠ€æœ¯é€‰å‹</li><li>JMSå’ŒAMQP</li><li>RPC å’Œæ¶ˆæ¯é˜Ÿåˆ—çš„åŒºåˆ«</li></ul><blockquote><p>Start</p></blockquote><p>åœ¨é¢è¯•çš„æ—¶å€™ï¼Œå½“ä½ çš„ç®€å†ä¸Šé¢å†™äº†ç”¨è¿‡<code>MQ</code> ,é‚£ä¹ˆé¢è¯•å®˜çš„é¢è¯•è¿™ä¸ªæ—¶å€™ä¾¿å¼€å§‹äº†ï¼š</p><ul><li><ol><li>ä½ åœ¨ç³»ç»Ÿé‡Œç”¨è¿‡æ¶ˆæ¯é˜Ÿåˆ—å—</li></ol></li><li><ol start="2"><li>ä½ ä»¬åœ¨é¡¹ç›®é‡Œæ˜¯å¦‚ä½•ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—çš„ã€‚</li></ol></li><li><ol start="3"><li>ä¸ºä»€ä¹ˆä½ ä»¬è¿™é‡Œè¦ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—å‘¢ï¼Œä¸ºä»€ä¹ˆä¸ç›´æ¥è°ƒç”¨æ¥å£å¤„ç†å‘¢ã€‚</li></ol></li><li><ol start="4"><li>è¯´è¯´æ¶ˆæ¯é˜Ÿåˆ—æœ‰å“ªäº›ä¼˜ç‚¹å’Œç¼ºç‚¹å§ã€‚</li></ol></li><li><ol start="5"><li>æ¶ˆæ¯é˜Ÿåˆ—çš„é€‰å‹ï¼Œä»–ä»¬ä¹‹é—´çš„åŒºåˆ«ã€‚</li></ol></li><li><ol start="6"><li>å¦‚ä½•ä¿è¯æ¶ˆæ¯ä¸è¢«é‡å¤æ¶ˆæ¯ï¼Œå¦‚ä½•ä¿è¯æ¶ˆè´¹çš„æ—¶å€™æ˜¯å¹‚ç­‰ï¼Œå¦‚ä½•ä¿è¯æ¶ˆæ¯çš„å¯é æ€§ï¼Œå¦‚ä½•ä¿è¯æ¶ˆæ¯çš„é¡ºåºæ€§ã€‚</li></ol></li><li><ol start="7"><li>å¦‚ä½•è§£å†³æ¶ˆæ¯é˜Ÿåˆ—çš„å»¶æ—¶ä»¥åŠè¿‡æœŸå¤±æ•ˆé—®é¢˜ï¼Ÿæ¶ˆæ¯é˜Ÿåˆ—æ»¡äº†ä»¥åè¯¥å¦‚ä½•å¤„ç†ï¼Ÿæœ‰å‡ ç™¾ä¸‡æ¶ˆæ¯æŒç»­å †ç§¯å‡ å°æ—¶ï¼Œè¦æ€ä¹ˆè§£å†³ï¼Ÿ</li></ol></li><li><ol start="8"><li>è®©ä½ å»è®¾è®¡ä¸€ä¸ªMQï¼Œè¯¥å¦‚ä½•è¿›è¡Œæ¶æ„è®¾è®¡ï¼Œè¯´ä¸€ä¸‹ä½ çš„æ€è·¯ã€‚</li></ol></li></ul><p>å‰å‡ ä¸ªé—®é¢˜çš„æ€è€ƒä¸»è¦æ˜¯å›´ç»•ï¼šä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—ï¼›</p><p>é™ˆè¿°å›ç­”çš„æ—¶å€™éœ€è¦ä»æ¶ˆæ¯é˜Ÿåˆ—åˆ©å¼Šã€ä¼˜ç¼ºç‚¹ã€é£é™©ç‚¹ç­‰æ–¹é¢è€ƒè™‘ï¼Œåœ¨è¿›è¡ŒæŠ€æœ¯é€‰å‹çš„æ—¶å€™ï¼Œä¸»è¦è¿˜æ˜¯å›´ç»•ä½¿ç”¨åœºæ™¯æ¥å†³å®šã€‚</p><div style="box-shadow: 2px 2px 5px #888888; padding: 10px; border: 1px solid #3271ae;">    æ¯ä¸€ä¸ª MQÂ æ²¡æœ‰ç»å¯¹çš„å¥½åï¼Œä½†æ˜¯è¦çœ‹ç”¨åœ¨å“ªä¸ªåœºæ™¯å¯ä»¥æ‰¬é•¿é¿çŸ­ï¼Œåˆ©ç”¨å…¶ä¼˜åŠ¿ï¼Œè§„é¿å…¶åŠ£åŠ¿ã€‚</div><h3 id="1ã€æ¶ˆæ¯é˜Ÿåˆ—çš„æ ¸å¿ƒä½¿ç”¨åœºæ™¯"><a href="#1ã€æ¶ˆæ¯é˜Ÿåˆ—çš„æ ¸å¿ƒä½¿ç”¨åœºæ™¯" class="headerlink" title="1ã€æ¶ˆæ¯é˜Ÿåˆ—çš„æ ¸å¿ƒä½¿ç”¨åœºæ™¯"></a>1ã€æ¶ˆæ¯é˜Ÿåˆ—çš„æ ¸å¿ƒä½¿ç”¨åœºæ™¯</h3><p>æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼‰çš„æ ¸å¿ƒä½¿ç”¨åœºæ™¯ä¸»è¦åŒ…æ‹¬ä¸‰ä¸ªæ–¹é¢ï¼šè§£è€¦ã€å¼‚æ­¥å¤„ç†å’Œå‰Šå³°ã€‚</p><blockquote><p>è§£è€¦</p></blockquote><p><strong>ç±»æ¯”è§£é‡Š</strong></p><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ åœ¨ç»„ç»‡ä¸€ä¸ªå¤§å‹æ´¾å¯¹ï¼Œä½ éœ€è¦é€šçŸ¥å¾ˆå¤šæœ‹å‹ã€‚å¦‚æœä½ ç›´æ¥ä¸€ä¸ªä¸ªæ‰“ç”µè¯ï¼Œæ¯å½“æ–°æœ‹å‹åŠ å…¥æˆ–æŸäººé€€å‡ºï¼Œä½ éƒ½éœ€è¦æ›´æ–°ä½ çš„é€šçŸ¥åˆ—è¡¨ã€‚è¿™å¾ˆéº»çƒ¦ï¼Œå¯¹å§ï¼Ÿ</p><p>ç°åœ¨ï¼Œå‡è®¾ä½ åˆ›å»ºäº†ä¸€ä¸ªåœ¨çº¿æ´»åŠ¨é¡µé¢ï¼Œä½ åªéœ€è¦æ›´æ–°è¿™ä¸ªé¡µé¢ï¼Œè€Œä½ çš„æœ‹å‹ä»¬è‡ªå·±å†³å®šæ˜¯å¦æŸ¥çœ‹è¿™ä¸ªé¡µé¢ã€‚è¿™å°±å¤§å¤§ç®€åŒ–äº†ä½ çš„å·¥ä½œã€‚</p><p><strong>æŠ€æœ¯è§£é‡Š</strong></p><p>åœ¨æ²¡æœ‰æ¶ˆæ¯é˜Ÿåˆ—çš„æƒ…å†µä¸‹ï¼Œç³»ç»Ÿ A éœ€è¦ç›´æ¥å’Œå¤šä¸ªç³»ç»Ÿï¼ˆå¦‚ Bã€Cã€Dã€Eï¼‰è¿›è¡Œé€šä¿¡ã€‚è¿™ç§ç´§å¯†è€¦åˆçš„æ–¹å¼ä½¿å¾—ç³»ç»Ÿ A éœ€è¦ä¸æ–­æ›´æ–°ä¸å…¶ä»–ç³»ç»Ÿçš„äº¤äº’é€»è¾‘ã€‚ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—åï¼Œç³»ç»Ÿ A åªéœ€å°†æ¶ˆæ¯å‘å¸ƒåˆ°é˜Ÿåˆ—ï¼Œè€Œå…¶ä»–ç³»ç»Ÿæ ¹æ®éœ€è¦ä»é˜Ÿåˆ—ä¸­å–å‡ºæ¶ˆæ¯ã€‚</p><p>è¿™ç§å‘å¸ƒ&#x2F;è®¢é˜…æ¨¡å¼ï¼ˆPub&#x2F;Subï¼‰ä½¿å¾—ç³»ç»Ÿ A ä¸å…¶ä»–ç³»ç»Ÿè§£è€¦ï¼Œç®€åŒ–äº†ç»´æŠ¤å’Œæ‰©å±•çš„å¤æ‚æ€§ã€‚</p><blockquote><p>å¼‚æ­¥å¤„ç†</p></blockquote><p><strong>ç±»æ¯”è§£é‡Š</strong></p><p>å‡è®¾ä½ åœ¨ä¸€å®¶é¤å…ç‚¹é¤ã€‚å¦‚æœå¨å¸ˆéœ€è¦ç­‰å¾…ä¸€ä¸ªèœåšå®Œæ‰å¼€å§‹åšä¸‹ä¸€ä¸ªï¼Œè¿™å°†éå¸¸ä½æ•ˆã€‚ä½†å¦‚æœä»–ä»¬èƒ½åŒæ—¶å¤„ç†å¤šä¸ªè®¢å•ï¼Œæ¯é“èœå®Œæˆæ—¶å°±ç›´æ¥ä¸Šèœï¼Œè¿™æ ·æ•ˆç‡ä¼šæ›´é«˜ã€‚</p><p><strong>æŠ€æœ¯è§£é‡Š</strong></p><p>åœ¨åŒæ­¥å¤„ç†æ¨¡å¼ä¸­ï¼Œç³»ç»Ÿ A åœ¨å®Œæˆæ‰€æœ‰æ“ä½œï¼ˆå¦‚æ›´æ–°å¤šä¸ªæ•°æ®åº“ï¼‰ä¹‹å‰ä¸ä¼šå“åº”ç”¨æˆ·è¯·æ±‚ï¼Œå¯¼è‡´å»¶è¿Ÿã€‚<br>è€Œå¼‚æ­¥å¤„ç†ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—ï¼Œç³»ç»Ÿ A å¯ä»¥å¿«é€Ÿå“åº”ç”¨æˆ·è¯·æ±‚ï¼Œå°†åç»­ä»»åŠ¡ï¼ˆå¦‚æ•°æ®åº“æ›´æ–°ï¼‰æ”¾å…¥é˜Ÿåˆ—ä¸­ï¼Œç”±å…¶ä»–ç³»ç»Ÿæˆ–æœåŠ¡æ…¢æ…¢å¤„ç†ã€‚è¿™å‡å°‘äº†ç”¨æˆ·çš„ç­‰å¾…æ—¶é—´ï¼Œæé«˜äº†ç³»ç»Ÿçš„å“åº”èƒ½åŠ›ã€‚</p><blockquote><p>å‰Šå³°</p></blockquote><p><strong>ç±»æ¯”è§£é‡Š</strong></p><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä¸€ä¸ªå…¬äº¤è½¦ç«™åœ¨é«˜å³°æ—¶æ®µé¢ä¸´å¤§é‡ä¹˜å®¢ã€‚å¦‚æœæ¯ä¸ªäººéƒ½ç«‹å³ä¸Šè½¦ï¼Œå…¬äº¤è½¦ä¼šè¢«è¿…é€Ÿå¡æ»¡ã€‚ä½†å¦‚æœæœ‰ä¸€ä¸ªç­‰å€™åŒºï¼Œè®©ä¹˜å®¢æŒ‰é¡ºåºä¸Šè½¦ï¼Œè¿™æ ·æ—¢ä¿æŒäº†å…¬äº¤è½¦çš„æ­£å¸¸è¿è¡Œï¼Œåˆé¿å…äº†æ‹¥æŒ¤ã€‚</p><p><strong>æŠ€æœ¯è§£é‡Š</strong></p><p>åœ¨æµé‡å‰Šå³°åœºæ™¯ä¸­ï¼Œæ¶ˆæ¯é˜Ÿåˆ—å……å½“ç¼“å†²åŒºï¼Œå¸®åŠ©å¤„ç†çŸ­æ—¶çš„é«˜æµé‡ã€‚å½“ç³»ç»Ÿ A åœ¨é«˜å³°æ—¶æ®µé¢ä¸´å¤§é‡è¯·æ±‚æ—¶ï¼Œè¿™äº›è¯·æ±‚é¦–å…ˆè¢«æ”¾å…¥æ¶ˆæ¯é˜Ÿåˆ—ã€‚<br>ç³»ç»Ÿ A æ ¹æ®è‡ªå·±çš„å¤„ç†èƒ½åŠ›é€æ¸ä»é˜Ÿåˆ—ä¸­å–å‡ºå¹¶å¤„ç†è¿™äº›è¯·æ±‚ã€‚è¿™æ ·å¯ä»¥é¿å…åœ¨é«˜å³°æœŸå¯¹ç³»ç»Ÿé€ æˆè¿‡å¤§çš„å‹åŠ›ï¼ŒåŒæ—¶ä¿è¯äº†ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå¯ç”¨æ€§ã€‚</p><p>ä¸Šé¢æåŠåˆ°çš„å‰Šå³°ã€è§£è€¦ã€å¼‚æ­¥å°±æ˜¯<strong>åœ¨ç‰¹æ®Šåœºæ™¯ä¸‹å…¶å¯¹åº”çš„å¥½å¤„</strong>ï¼Œè€Œç¼ºç‚¹å¯¹åº”çš„æ˜¯ç³»ç»Ÿçš„å¤æ‚æ€§å˜é«˜ï¼Œå¯ç”¨æ€§é™ä½ï¼Œä»¥åŠè¿˜æœ‰ä¸€è‡´æ€§é—®é¢˜ã€‚</p><blockquote><p>ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—ä¼šå¸¦æ¥å“ªäº›é—®é¢˜ï¼Ÿ</p></blockquote><ul><li><strong>ç³»ç»Ÿå¯ç”¨æ€§é™ä½ï¼š</strong> ç³»ç»Ÿå¯ç”¨æ€§åœ¨æŸç§ç¨‹åº¦ä¸Šé™ä½ï¼Œä¸ºä»€ä¹ˆè¿™æ ·è¯´å‘¢ï¼Ÿåœ¨åŠ å…¥ MQ ä¹‹å‰ï¼Œä½ ä¸ç”¨è€ƒè™‘æ¶ˆæ¯ä¸¢å¤±æˆ–è€…è¯´ MQ æŒ‚æ‰ç­‰ç­‰çš„æƒ…å†µï¼Œä½†æ˜¯ï¼Œå¼•å…¥ MQ ä¹‹åä½ å°±éœ€è¦å»è€ƒè™‘äº†ï¼</li><li><strong>ç³»ç»Ÿå¤æ‚æ€§æé«˜ï¼š</strong> åŠ å…¥ MQ ä¹‹åï¼Œéœ€è¦ä¿è¯æ¶ˆæ¯æ²¡æœ‰è¢«é‡å¤æ¶ˆè´¹ã€å¤„ç†æ¶ˆæ¯ä¸¢å¤±çš„æƒ…å†µã€ä¿è¯æ¶ˆæ¯ä¼ é€’çš„é¡ºåºæ€§ç­‰ç­‰é—®é¢˜ï¼</li><li><strong>ä¸€è‡´æ€§é—®é¢˜ï¼š</strong> æ¶ˆæ¯é˜Ÿåˆ—å¯ä»¥å®ç°å¼‚æ­¥ï¼Œæ¶ˆæ¯é˜Ÿåˆ—å¸¦æ¥çš„å¼‚æ­¥ç¡®å®å¯ä»¥æé«˜ç³»ç»Ÿå“åº”é€Ÿåº¦ã€‚ä½†æ˜¯ï¼Œä¸‡ä¸€æ¶ˆæ¯çš„çœŸæ­£æ¶ˆè´¹è€…å¹¶æ²¡æœ‰æ­£ç¡®æ¶ˆè´¹æ¶ˆæ¯æ€ä¹ˆåŠï¼Ÿè¿™æ ·å°±ä¼šå¯¼è‡´æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µ</li></ul><h3 id="2ã€æŠ€æœ¯é€‰å‹"><a href="#2ã€æŠ€æœ¯é€‰å‹" class="headerlink" title="2ã€æŠ€æœ¯é€‰å‹"></a>2ã€æŠ€æœ¯é€‰å‹</h3><p>æŠ€æœ¯é€‰å‹å¯ä»¥å‚è€ƒçœ‹ä¸€ä¸‹ä¸‹é¢çš„å†…å®¹</p><table><thead><tr><th>ç‰¹æ€§</th><th>ActiveMQ</th><th>RabbitMQ</th><th>RocketMQ</th><th>Kafka</th></tr></thead><tbody><tr><td>å•æœºååé‡</td><td>ä¸‡çº§ï¼Œæ¯” RocketMQã€Kafka ä½ä¸€ä¸ªæ•°é‡çº§</td><td>åŒ ActiveMQ</td><td>10 ä¸‡çº§ï¼Œæ”¯æ’‘é«˜åå</td><td>10 ä¸‡çº§ï¼Œé«˜ååï¼Œä¸€èˆ¬é…åˆå¤§æ•°æ®ç±»çš„ç³»ç»Ÿæ¥è¿›è¡Œå®æ—¶æ•°æ®è®¡ç®—ã€æ—¥å¿—é‡‡é›†ç­‰åœºæ™¯</td></tr><tr><td>topic æ•°é‡å¯¹ååé‡çš„å½±å“</td><td></td><td></td><td>topic å¯ä»¥è¾¾åˆ°å‡ ç™¾&#x2F;å‡ åƒçš„çº§åˆ«ï¼Œååé‡ä¼šæœ‰è¾ƒå°å¹…åº¦çš„ä¸‹é™ï¼Œè¿™æ˜¯ RocketMQ çš„ä¸€å¤§ä¼˜åŠ¿ï¼Œåœ¨åŒç­‰æœºå™¨ä¸‹ï¼Œå¯ä»¥æ”¯æ’‘å¤§é‡çš„ topic</td><td>topic ä»å‡ ååˆ°å‡ ç™¾ä¸ªæ—¶å€™ï¼Œååé‡ä¼šå¤§å¹…åº¦ä¸‹é™ï¼Œåœ¨åŒç­‰æœºå™¨ä¸‹ï¼ŒKafka å°½é‡ä¿è¯ topic æ•°é‡ä¸è¦è¿‡å¤šï¼Œå¦‚æœè¦æ”¯æ’‘å¤§è§„æ¨¡çš„ topicï¼Œéœ€è¦å¢åŠ æ›´å¤šçš„æœºå™¨èµ„æº</td></tr><tr><td>æ—¶æ•ˆæ€§</td><td>ms çº§</td><td>å¾®ç§’çº§ï¼Œè¿™æ˜¯ RabbitMQ çš„ä¸€å¤§ç‰¹ç‚¹ï¼Œå»¶è¿Ÿæœ€ä½</td><td>ms çº§</td><td>å»¶è¿Ÿåœ¨ ms çº§ä»¥å†…</td></tr><tr><td>å¯ç”¨æ€§</td><td>é«˜ï¼ŒåŸºäºä¸»ä»æ¶æ„å®ç°é«˜å¯ç”¨</td><td>åŒ ActiveMQ</td><td>éå¸¸é«˜ï¼Œåˆ†å¸ƒå¼æ¶æ„</td><td>éå¸¸é«˜ï¼Œåˆ†å¸ƒå¼ï¼Œä¸€ä¸ªæ•°æ®å¤šä¸ªå‰¯æœ¬ï¼Œå°‘æ•°æœºå™¨å®•æœºï¼Œä¸ä¼šä¸¢å¤±æ•°æ®ï¼Œä¸ä¼šå¯¼è‡´ä¸å¯ç”¨</td></tr><tr><td>æ¶ˆæ¯å¯é æ€§</td><td>æœ‰è¾ƒä½çš„æ¦‚ç‡ä¸¢å¤±æ•°æ®</td><td>åŸºæœ¬ä¸ä¸¢</td><td>ç»è¿‡å‚æ•°ä¼˜åŒ–é…ç½®ï¼Œå¯ä»¥åšåˆ° 0 ä¸¢å¤±</td><td>åŒ RocketMQ</td></tr><tr><td>åŠŸèƒ½æ”¯æŒ</td><td>MQ é¢†åŸŸçš„åŠŸèƒ½æå…¶å®Œå¤‡</td><td>åŸºäº erlang å¼€å‘ï¼Œå¹¶å‘èƒ½åŠ›å¾ˆå¼ºï¼Œæ€§èƒ½æå¥½ï¼Œå»¶æ—¶å¾ˆä½</td><td>MQ åŠŸèƒ½è¾ƒä¸ºå®Œå–„ï¼Œè¿˜æ˜¯åˆ†å¸ƒå¼çš„ï¼Œæ‰©å±•æ€§å¥½</td><td>åŠŸèƒ½è¾ƒä¸ºç®€å•ï¼Œä¸»è¦æ”¯æŒç®€å•çš„ MQ åŠŸèƒ½ï¼Œåœ¨å¤§æ•°æ®é¢†åŸŸçš„å®æ—¶è®¡ç®—ä»¥åŠæ—¥å¿—é‡‡é›†è¢«å¤§è§„æ¨¡ä½¿ç”¨</td></tr></tbody></table><blockquote><p>Kafka</p></blockquote><p>ä¼˜ç‚¹</p><ol><li><strong>é«˜ååé‡</strong>ï¼šKafka è®¾è®¡ç”¨äºå¤„ç†é«˜ååé‡æ•°æ®ï¼Œé€‚åˆå¤§è§„æ¨¡æ¶ˆæ¯å¤„ç†åº”ç”¨ã€‚</li><li><strong>åˆ†å¸ƒå¼ç³»ç»Ÿ</strong>ï¼šå®ƒå¤©ç”Ÿå°±æ˜¯åˆ†å¸ƒå¼çš„ï¼Œæ˜“äºæ‰©å±•ã€‚</li><li><strong>æŒä¹…æ€§å’Œå¯é æ€§</strong>ï¼šKafka å¯ä»¥æŒä¹…åŒ–æ¶ˆæ¯åˆ°ç£ç›˜ï¼Œå› æ­¤å¯¹æ¶ˆæ¯ä¸ä¼šå› ä¸ºç³»ç»Ÿæ•…éšœè€Œä¸¢å¤±ã€‚</li><li><strong>é«˜æ•ˆ</strong>ï¼šKafka ä½¿ç”¨é¡ºåºç£ç›˜I&#x2F;Oï¼Œæä¾›é«˜æ€§èƒ½ä¸æ•°æ®ååã€‚</li></ol><p>ç¼ºç‚¹</p><ol><li><strong>å¤æ‚æ€§</strong>ï¼šKafka çš„è®¾ç½®å’Œç®¡ç†ç›¸å¯¹å¤æ‚ã€‚</li><li><strong>æ¶ˆæ¯ç§¯å‹</strong>ï¼šåœ¨é«˜è´Ÿè½½ä¸‹ï¼Œæ¶ˆæ¯å»¶è¿Ÿå¯èƒ½ä¼šå¢åŠ ã€‚</li><li><strong>ä¸æ”¯æŒä¼˜å…ˆçº§é˜Ÿåˆ—</strong>ã€‚</li></ol><blockquote><p>ActiveMQ</p></blockquote><p>ä¼˜ç‚¹</p><ol><li><strong>æ”¯æŒå¤šç§ä¼ è¾“åè®®</strong>ï¼šå¦‚ OpenWire, STOMP, MQTT ç­‰ã€‚</li><li><strong>æ˜“äºä½¿ç”¨å’Œé…ç½®</strong>ï¼šç›¸æ¯” Kafkaï¼ŒActiveMQ é…ç½®å’Œç®¡ç†è¾ƒä¸ºç®€å•ã€‚</li><li><strong>JMS æ”¯æŒ</strong>ï¼šå®Œå…¨æ”¯æŒ JMS API å’Œ J2EE é›†æˆã€‚</li></ol><p>ç¼ºç‚¹</p><ol><li><strong>è¾ƒä½çš„ååé‡</strong>ï¼šç›¸æ¯” Kafkaï¼ŒActiveMQ çš„ååé‡è¾ƒä½ã€‚</li><li><strong>å¯æ‰©å±•æ€§é—®é¢˜</strong>ï¼šåœ¨éå¸¸å¤§çš„æ•°æ®è´Ÿè½½ä¸‹ï¼Œæ‰©å±•æ€§å¯èƒ½æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚</li></ol><blockquote><p>RabbitMQ</p></blockquote><p>ä¼˜ç‚¹</p><ol><li><strong>çµæ´»çš„è·¯ç”±</strong>ï¼šæ”¯æŒå¤æ‚çš„è·¯ç”±ã€‚</li><li><strong>å¤šç§æ¶ˆæ¯åè®®</strong>ï¼šæ”¯æŒ AMQP, MQTT, STOMP ç­‰ã€‚</li><li><strong>ç®¡ç†ç•Œé¢å‹å¥½</strong>ï¼šæä¾›æ˜“äºä½¿ç”¨çš„ç®¡ç†ç•Œé¢ã€‚</li></ol><p>ç¼ºç‚¹</p><ol><li><strong>æ€§èƒ½é—®é¢˜</strong>ï¼šåœ¨é«˜ååé‡æ—¶ï¼Œæ€§èƒ½å¯èƒ½ä¼šå—é™ã€‚</li><li><strong>æŒä¹…åŒ–å¼€é”€</strong>ï¼šæ¶ˆæ¯æŒä¹…åŒ–å¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚</li></ol><blockquote><p>RocketMQ</p></blockquote><p>ä¼˜ç‚¹</p><ol><li><strong>é«˜æ€§èƒ½å’Œä½å»¶è¿Ÿ</strong>ï¼šåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­è¡¨ç°å‡ºè‰²ã€‚</li><li><strong>ä¸°å¯Œçš„åŠŸèƒ½</strong>ï¼šæä¾›äº†å¤§é‡çš„ç‰¹æ€§ï¼Œå¦‚æ¶ˆæ¯é¡ºåºã€äº‹åŠ¡æ¶ˆæ¯ç­‰ã€‚</li><li><strong>å¯é æ€§å’Œæ‰©å±•æ€§</strong>ï¼šä¿è¯äº†æ¶ˆæ¯çš„å¯é ä¼ è¾“ï¼ŒåŒæ—¶æ”¯æŒæ°´å¹³å’Œå‚ç›´æ‰©å±•ã€‚</li></ol><p>ç¼ºç‚¹</p><ol><li><strong>ç¤¾åŒºå’Œç”Ÿæ€</strong>ï¼šç›¸æ¯” Kafkaï¼ŒRocketMQ çš„ç¤¾åŒºå’Œç”Ÿæ€ç›¸å¯¹è¾ƒå°ã€‚</li><li><strong>å¤æ‚æ€§</strong>ï¼šé…ç½®å’Œç®¡ç†ç¨å¾®å¤æ‚ã€‚</li></ol><blockquote><p>æŠ€æœ¯é€‰å‹è€ƒè™‘å› ç´ </p></blockquote><ol><li><strong>ååé‡éœ€æ±‚</strong>ï¼šå¦‚æœä½ çš„ç³»ç»Ÿéœ€è¦å¤„ç†å¤§é‡çš„æ•°æ®ï¼ŒKafka æˆ– RocketMQ å¯èƒ½æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚</li><li><strong>ç³»ç»Ÿå¤æ‚æ€§</strong>ï¼šå¦‚æœä½ éœ€è¦ä¸€ä¸ªæ˜“äºè®¾ç½®å’Œç®¡ç†çš„ç³»ç»Ÿï¼ŒActiveMQ æˆ– RabbitMQ å¯èƒ½æ›´åˆé€‚ã€‚</li><li><strong>åŠŸèƒ½éœ€æ±‚</strong>ï¼šæ ¹æ®ä½ éœ€è¦çš„ç‰¹å®šåŠŸèƒ½ï¼ˆå¦‚æ¶ˆæ¯æ’åºã€äº‹åŠ¡å¤„ç†ç­‰ï¼‰é€‰æ‹©ç›¸åº”çš„ç³»ç»Ÿã€‚</li><li><strong>ç¤¾åŒºæ”¯æŒå’Œç”Ÿæ€ç³»ç»Ÿ</strong>ï¼šå¼ºå¤§çš„ç¤¾åŒºå¯ä»¥æä¾›æ›´å¥½çš„æ”¯æŒå’Œæ›´å¤šçš„èµ„æºã€‚</li><li><strong>å¯é æ€§å’ŒæŒä¹…æ€§</strong>ï¼šå¦‚æœè¿™äº›æ˜¯ä½ çš„ä¸»è¦å…³æ³¨ç‚¹ï¼ŒKafka å’Œ RocketMQ æ˜¯ä¸é”™çš„é€‰æ‹©</li></ol><p>é€‰æ‹©å»ºè®®ï¼š</p><ul><li><strong>ä¸­å°å‹å…¬å¸</strong>ï¼ŒæŠ€æœ¯å®åŠ›è¾ƒä¸ºä¸€èˆ¬ï¼ŒæŠ€æœ¯æŒ‘æˆ˜ä¸æ˜¯ç‰¹åˆ«é«˜ï¼Œç”¨ RabbitMQ æ˜¯ä¸é”™çš„é€‰æ‹©ï¼›</li><li><strong>å¤§å‹å…¬å¸</strong>ï¼ŒåŸºç¡€æ¶æ„ç ”å‘å®åŠ›è¾ƒå¼ºï¼Œç”¨ RocketMQ æ˜¯å¾ˆå¥½çš„é€‰æ‹©ã€‚</li><li>å¦‚æœæ˜¯<strong>å¤§æ•°æ®é¢†åŸŸ</strong>çš„å®æ—¶è®¡ç®—ã€æ—¥å¿—é‡‡é›†ç­‰åœºæ™¯ï¼ŒKafka æ˜¯ä¸šå†…æ ‡å‡†ï¼Œç¤¾åŒºæ´»è·ƒåº¦å¾ˆé«˜ï¼Œå‡ ä¹æ˜¯å…¨ä¸–ç•Œè¯¥é¢†åŸŸçš„äº‹å®æ€§è§„èŒƒã€‚</li><li>ActiveMQï¼Œæœ€è¿‘é€å¹´ä½¿ç”¨å‡å°‘ï¼Œæ²¡ç»è¿‡å¤§è§„æ¨¡ååé‡åœºæ™¯çš„éªŒè¯ï¼Œç¤¾åŒºä¸æ˜¯å¾ˆæ´»è·ƒã€‚</li></ul><h3 id="3ã€JMSå’ŒAMQP"><a href="#3ã€JMSå’ŒAMQP" class="headerlink" title="3ã€JMSå’ŒAMQP"></a>3ã€JMSå’ŒAMQP</h3><p>JMSï¼ˆJava Message Serviceï¼‰å’Œ AMQPï¼ˆAdvanced Message Queuing Protocolï¼‰éƒ½æ˜¯æ¶ˆæ¯ä¼ é€’çš„æ ‡å‡†å’Œè§„èŒƒï¼Œä½†å®ƒä»¬åœ¨è®¾è®¡ç†å¿µã€å®ç°æ–¹å¼å’Œä½¿ç”¨åœºæ™¯ä¸Šæœ‰æ‰€ä¸åŒ</p><blockquote><p>JMSï¼ˆJava Message Serviceï¼‰</p></blockquote><p>å®šä¹‰</p><ul><li>JMS æ˜¯ä¸€ä¸ª Java å¹³å°ä¸­å…³äºé¢å‘æ¶ˆæ¯ä¸­é—´ä»¶ï¼ˆMOMï¼‰çš„ APIï¼Œç”¨äºåœ¨ä¸¤ä¸ªåº”ç”¨ç¨‹åºä¹‹é—´ï¼Œæˆ–åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å‘é€æ¶ˆæ¯ï¼Œè¿›è¡Œå¼‚æ­¥é€šä¿¡ã€‚</li></ul><p>ç‰¹ç‚¹</p><ul><li><strong>Java æ ‡å‡†</strong>ï¼šJMS æ˜¯ Java EE çš„ä¸€éƒ¨åˆ†ï¼Œä¸»è¦ç”¨äº Java åº”ç”¨ç¨‹åºã€‚</li><li><strong>API è§„èŒƒ</strong>ï¼šå®šä¹‰äº†ä¸€ä¸ªé€šç”¨çš„ API æ¥ä¸æ¶ˆæ¯æœåŠ¡è¿›è¡Œäº¤äº’ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªç½‘ç»œåè®®ã€‚</li><li><strong>æä¾›è€…ä¾èµ–</strong>ï¼šJMS API å¯ä»¥ç”±å¤šç§ä¾›åº”å•†å®ç°ï¼Œå¦‚ ActiveMQã€IBM MQ ç­‰ã€‚</li><li><strong>ä¸¤ç§æ¶ˆæ¯æ¨¡å‹</strong>ï¼šæ”¯æŒç‚¹å¯¹ç‚¹ï¼ˆQueueï¼‰å’Œå‘å¸ƒ&#x2F;è®¢é˜…ï¼ˆTopicï¼‰æ¨¡å‹ã€‚</li><li><strong>ä¸è·¨è¯­è¨€</strong>ï¼šä¸»è¦ç”¨äº Java åº”ç”¨ç¨‹åºï¼Œä¸é€‚ç”¨äºä¸åŒè¯­è¨€ä¹‹é—´çš„é€šä¿¡ã€‚</li></ul><blockquote><p>AMQPï¼ˆAdvanced Message Queuing Protocolï¼‰</p></blockquote><p>å®šä¹‰</p><ul><li>AMQP æ˜¯ä¸€ä¸ªå¼€æ”¾æ ‡å‡†çš„åº”ç”¨å±‚åè®®ï¼Œä¸“ä¸ºå¼‚æ­¥æ¶ˆæ¯ä¼ é€’æä¾›ä¸€ä¸ªç»Ÿä¸€çš„æ¡†æ¶ï¼Œæ”¯æŒè·¨å¹³å°å’Œè·¨è¯­è¨€çš„æ¶ˆæ¯é€šä¿¡ã€‚</li></ul><p>ç‰¹ç‚¹</p><ul><li><strong>åè®®æ ‡å‡†</strong>ï¼šAMQP å®šä¹‰äº†ç½‘ç»œåè®®ï¼ŒåŒ…æ‹¬æ¶ˆæ¯çš„æ ¼å¼ã€ä¼ è¾“æ–¹å¼å’Œé˜Ÿåˆ—çš„è¡Œä¸ºã€‚</li><li><strong>ä¾›åº”å•†ä¸­ç«‹</strong>ï¼šæ—¨åœ¨å…è®¸ä»ä¸åŒä¾›åº”å•†çš„æ¶ˆæ¯ç³»ç»Ÿä¸­äº’æ“ä½œã€‚</li><li><strong>è·¨è¯­è¨€æ”¯æŒ</strong>ï¼šä¸é™äº Javaï¼Œæ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€å’Œå¹³å°ã€‚</li><li><strong>å¤šç§æ¶ˆæ¯æ¨¡å¼</strong>ï¼šæ”¯æŒçµæ´»çš„æ¶ˆæ¯æ¨¡å¼ï¼ŒåŒ…æ‹¬ç‚¹å¯¹ç‚¹ã€å‘å¸ƒ&#x2F;è®¢é˜…ã€è¯·æ±‚&#x2F;å“åº”ç­‰ã€‚</li><li><strong>å¯é æ€§å’Œå®‰å…¨æ€§</strong>ï¼šæä¾›äº†æ¶ˆæ¯ç¡®è®¤ã€äº¤æ˜“ã€å®‰å…¨ç­‰æœºåˆ¶ã€‚</li></ul><blockquote><p>ä¸»è¦åŒºåˆ«</p></blockquote><ul><li><strong>è®¾è®¡èŒƒå›´</strong>ï¼šJMS æ˜¯ä¸€ä¸ªé’ˆå¯¹ Java çš„ API è§„èŒƒï¼Œè€Œ AMQP æ˜¯ä¸€ä¸ªè·¨è¯­è¨€ã€è·¨å¹³å°çš„ç½‘ç»œåè®®ã€‚</li><li><strong>é€‚ç”¨èŒƒå›´</strong>ï¼šJMS ä¸»è¦ç”¨äº Java åº”ç”¨ï¼ŒAMQP é€‚ç”¨äºä»»ä½•æ”¯æŒè¯¥åè®®çš„å®¢æˆ·ç«¯ã€‚</li><li><strong>å®ç°ä¾èµ–</strong>ï¼šä½¿ç”¨ JMS æ—¶ï¼Œéœ€è¦ä¾èµ–ç‰¹å®šä¾›åº”å•†çš„å®ç°ï¼Œè€Œ AMQP çš„å®ç°æ˜¯ä¾›åº”å•†ä¸­ç«‹çš„ï¼Œç†è®ºä¸Šä»»ä½• AMQP å…¼å®¹çš„å®¢æˆ·ç«¯éƒ½å¯ä»¥ä¸ä»»ä½• AMQP å…¼å®¹çš„æœåŠ¡å™¨é€šä¿¡ã€‚</li><li><strong>å…¼å®¹æ€§</strong>ï¼šAMQP çš„è®¾è®¡ç›®æ ‡æ˜¯å®ç°ä¸åŒæ¶ˆæ¯ç³»ç»Ÿä¹‹é—´çš„äº’æ“ä½œæ€§ï¼Œè€Œ JMS æ— æ³•åšåˆ°è¿™ä¸€ç‚¹ã€‚</li></ul><p><strong>ActiveMQï¼ˆå·²è¢«æ·˜æ±°ï¼‰ æ˜¯åŸºäº JMS è§„èŒƒå®ç°çš„ã€‚</strong></p><p><strong>RabbitMQ æ˜¯åŸºäº AMQP åè®®å®ç°çš„ã€‚</strong></p><blockquote><p>JMS vs AMQP</p></blockquote><table><thead><tr><th>å¯¹æ¯”æ–¹å‘</th><th>JMS</th><th>AMQP</th></tr></thead><tbody><tr><td>å®šä¹‰</td><td>Java API</td><td>åè®®</td></tr><tr><td>è·¨è¯­è¨€</td><td>å¦</td><td>æ˜¯</td></tr><tr><td>è·¨å¹³å°</td><td>å¦</td><td>æ˜¯</td></tr><tr><td>æ”¯æŒæ¶ˆæ¯ç±»å‹</td><td>æä¾›ä¸¤ç§æ¶ˆæ¯æ¨¡å‹ï¼šâ‘ Peer-2-Peer;â‘¡Pub&#x2F;sub</td><td>æä¾›äº†äº”ç§æ¶ˆæ¯æ¨¡å‹ï¼šâ‘ direct exchangeï¼›â‘¡fanout exchangeï¼›â‘¢topic changeï¼›â‘£headers exchangeï¼›â‘¤system exchangeã€‚æœ¬è´¨æ¥è®²ï¼Œåå››ç§å’Œ JMS çš„ pub&#x2F;sub æ¨¡å‹æ²¡æœ‰å¤ªå¤§å·®åˆ«ï¼Œä»…æ˜¯åœ¨è·¯ç”±æœºåˆ¶ä¸Šåšäº†æ›´è¯¦ç»†çš„åˆ’åˆ†ï¼›</td></tr><tr><td>æ”¯æŒæ¶ˆæ¯ç±»å‹</td><td>æ”¯æŒå¤šç§æ¶ˆæ¯ç±»å‹ ï¼Œæˆ‘ä»¬åœ¨ä¸Šé¢æåˆ°è¿‡</td><td>byte[]ï¼ˆäºŒè¿›åˆ¶ï¼‰</td></tr></tbody></table><ul><li>AMQP ä¸ºæ¶ˆæ¯å®šä¹‰äº†çº¿è·¯å±‚ï¼ˆwire-level protocolï¼‰çš„åè®®ï¼Œè€Œ JMS æ‰€å®šä¹‰çš„æ˜¯ API è§„èŒƒã€‚åœ¨ Java ä½“ç³»ä¸­ï¼Œå¤šä¸ª client å‡å¯ä»¥é€šè¿‡ JMS è¿›è¡Œäº¤äº’ï¼Œä¸éœ€è¦åº”ç”¨ä¿®æ”¹ä»£ç ï¼Œä½†æ˜¯å…¶å¯¹è·¨å¹³å°çš„æ”¯æŒè¾ƒå·®ã€‚è€Œ AMQP å¤©ç„¶å…·æœ‰è·¨å¹³å°ã€è·¨è¯­è¨€ç‰¹æ€§ã€‚</li><li>JMS æ”¯æŒ <code>TextMessage</code>ã€<code>MapMessage</code> ç­‰å¤æ‚çš„æ¶ˆæ¯ç±»å‹ï¼›è€Œ AMQP ä»…æ”¯æŒ <code>byte[]</code> æ¶ˆæ¯ç±»å‹ï¼ˆå¤æ‚çš„ç±»å‹å¯åºåˆ—åŒ–åå‘é€ï¼‰ã€‚</li><li>ç”±äº Exchange æä¾›çš„è·¯ç”±ç®—æ³•ï¼ŒAMQP å¯ä»¥æä¾›å¤šæ ·åŒ–çš„è·¯ç”±æ–¹å¼æ¥ä¼ é€’æ¶ˆæ¯åˆ°æ¶ˆæ¯é˜Ÿåˆ—ï¼Œè€Œ JMS ä»…æ”¯æŒ é˜Ÿåˆ— å’Œ ä¸»é¢˜&#x2F;è®¢é˜… æ–¹å¼ä¸¤ç§</li></ul><h3 id="4ã€RPC-å’Œæ¶ˆæ¯é˜Ÿåˆ—çš„åŒºåˆ«"><a href="#4ã€RPC-å’Œæ¶ˆæ¯é˜Ÿåˆ—çš„åŒºåˆ«" class="headerlink" title="4ã€RPC å’Œæ¶ˆæ¯é˜Ÿåˆ—çš„åŒºåˆ«"></a>4ã€RPC å’Œæ¶ˆæ¯é˜Ÿåˆ—çš„åŒºåˆ«</h3><p>RPCï¼ˆRemote Procedure Callï¼‰å’Œæ¶ˆæ¯é˜Ÿåˆ—æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„ä¸¤ç§ä¸åŒçš„é€šä¿¡æœºåˆ¶ï¼Œå®ƒä»¬åœ¨è®¾è®¡ç›®çš„ã€é€šä¿¡æ–¹å¼ã€æ¶æ„è¦æ±‚å’Œæ—¶æ•ˆæ€§ç­‰æ–¹é¢å­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚</p><blockquote><p>ç”¨é€”</p></blockquote><ul><li><strong>RPC</strong>ï¼š<ul><li>ç›®çš„æ˜¯å®ç°ä¸åŒæœåŠ¡ä¹‹é—´çš„ç›´æ¥åŒæ­¥è°ƒç”¨ã€‚</li><li>ç±»ä¼¼äºæœ¬åœ°å‡½æ•°è°ƒç”¨ï¼Œç”¨äºæœåŠ¡ä¸æœåŠ¡ä¹‹é—´çš„ç´§å¯†åä½œã€‚</li><li>é€‚ç”¨äºå¯¹å“åº”æ—¶é—´æœ‰ä¸¥æ ¼è¦æ±‚çš„åœºæ™¯ã€‚</li></ul></li><li><strong>æ¶ˆæ¯é˜Ÿåˆ—</strong>ï¼š<ul><li>ç›®çš„æ˜¯æä¾›å¼‚æ­¥é€šä¿¡èƒ½åŠ›ï¼Œè§£è€¦æœåŠ¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚</li><li>ç”¨äºä»»åŠ¡çš„å¼‚æ­¥å¤„ç†ã€æµé‡å‰Šå³°å’Œåˆ†å¸ƒå¼äº‹åŠ¡ç­‰ã€‚</li><li>é€‚ç”¨äºå¤„ç†é«˜å³°æœŸæµé‡æˆ–è€…æ‰§è¡Œè€—æ—¶æ“ä½œã€‚</li></ul></li></ul><blockquote><p>é€šä¿¡æ–¹å¼</p></blockquote><ul><li><strong>RPC</strong>ï¼š<ul><li>æ˜¯ä¸€ç§åŒæ­¥æ“ä½œï¼Œè°ƒç”¨æ–¹å‘èµ·è¯·æ±‚å¹¶ç­‰å¾…å“åº”ï¼Œç›´åˆ°è¿œç¨‹è¿‡ç¨‹æ‰§è¡Œå®Œæˆå¹¶è¿”å›ç»“æœã€‚</li><li>ä¾èµ–ç›´æ¥çš„ç½‘ç»œè¿æ¥å’Œå³æ—¶çš„æ•°æ®ä¼ è¾“ã€‚</li></ul></li><li><strong>æ¶ˆæ¯é˜Ÿåˆ—</strong>ï¼š<ul><li>æä¾›äº†ä¸€ç§å¼‚æ­¥é€šä¿¡æ–¹å¼ï¼Œå‘é€æ–¹å°†æ¶ˆæ¯å‘é€åˆ°é˜Ÿåˆ—ï¼Œæ¥æ”¶æ–¹å¯ä»¥åœ¨ä»»ä½•æ—¶é—´ä»é˜Ÿåˆ—ä¸­è·å–æ¶ˆæ¯ã€‚</li><li>å¼•å…¥äº†ä¸­é—´ä»¶ä½œä¸ºæ¶ˆæ¯ä¼ é€’çš„ä¸­é—´å±‚ï¼Œå¢åŠ äº†æ¶ˆæ¯çš„æŒä¹…æ€§ã€‚</li></ul></li></ul><blockquote><p>æ¶æ„</p></blockquote><ul><li><strong>RPC</strong>ï¼š<ul><li>æ²¡æœ‰æ¶ˆæ¯å­˜å‚¨çš„éœ€æ±‚ï¼Œå› ä¸ºå®ƒä¾èµ–å³æ—¶çš„è¯·æ±‚-å“åº”æ¨¡å‹ã€‚</li><li>é€šå¸¸ä¸éœ€è¦ä¸­é—´å±‚æ¥ç¼“å­˜æˆ–ç®¡ç†æ¶ˆæ¯ã€‚</li></ul></li><li><strong>æ¶ˆæ¯é˜Ÿåˆ—</strong>ï¼š<ul><li>å¿…é¡»è¦æœ‰æ¶ˆæ¯å­˜å‚¨å’Œç®¡ç†çš„æœºåˆ¶ï¼Œå› ä¸ºæ¶ˆæ¯éœ€è¦åœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…è¢«å¤„ç†ã€‚</li><li>æ¶ˆæ¯ä¸­é—´ä»¶è´Ÿè´£ä¿è¯æ¶ˆæ¯çš„æŒä¹…æ€§å’Œå¯é æ€§ã€‚</li></ul></li></ul><blockquote><p>æ—¶æ•ˆæ€§</p></blockquote><ul><li><strong>RPC</strong>ï¼š<ul><li>ä¸€èˆ¬æœŸæœ›ç«‹å³å¤„ç†ï¼Œè°ƒç”¨æ–¹é€šå¸¸ä¼šé˜»å¡ç­‰å¾…ç›´åˆ°å¾—åˆ°å“åº”ã€‚</li><li>æ›´é€‚åˆäºéœ€è¦å¿«é€Ÿå®Œæˆçš„äº¤äº’å¼æ“ä½œã€‚</li></ul></li><li><strong>æ¶ˆæ¯é˜Ÿåˆ—</strong>ï¼š<ul><li>æ¶ˆæ¯å¯èƒ½ä¸ä¼šç«‹å³å¤„ç†ï¼Œå…è®¸åœ¨ç³»ç»Ÿèµ„æºå…è®¸çš„æƒ…å†µä¸‹éšåå¤„ç†ã€‚</li><li>æ”¯æŒé«˜å³°æœŸçš„æµé‡å¹³æ»‘ï¼Œå…è®¸ç³»ç»ŸæŒ‰ç…§è‡ªå·±çš„èŠ‚å¥å’Œèƒ½åŠ›å¤„ç†æ¶ˆæ¯ã€‚</li></ul></li></ul><p><strong>æ€»ç»“</strong></p><p>RPC å’Œæ¶ˆæ¯é˜Ÿåˆ—è§£å†³çš„æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ä¸åŒçš„é—®é¢˜ã€‚</p><p>RPC å¼ºè°ƒçš„æ˜¯å³æ—¶æ€§å’ŒåŒæ­¥ï¼Œé€‚åˆäºéœ€è¦è¿…é€Ÿå“åº”çš„åœºæ™¯ã€‚è€Œæ¶ˆæ¯é˜Ÿåˆ—å¼ºè°ƒçš„æ˜¯å¼‚æ­¥æ€§å’Œè§£è€¦ï¼Œé€‚åˆäºéœ€è¦æé«˜ç³»ç»Ÿæ•´ä½“æ•ˆç‡å’Œç¨³å®šæ€§çš„åœºæ™¯ã€‚</p><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä¸¤è€…å¾€å¾€ç›¸äº’è¡¥å……ï¼Œå…±åŒæ”¯æ’‘èµ·ä¸€ä¸ªé«˜æ•ˆã€å¯é ã€å¯æ‰©å±•çš„åˆ†å¸ƒå¼ç³»ç»Ÿæ¶æ„ã€‚</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://javaguide.cn/high-performance/message-queue/message-queue.html">https://javaguide.cn/high-performance/message-queue/message-queue.html</a></li><li><a href="https://doocs.github.io/advanced-java/#/docs/high-concurrency/mq-interview">https://doocs.github.io/advanced-java/#/docs/high-concurrency/mq-interview</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>ä¸­é—´ä»¶</category>
      
      <category>MQ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MQ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è˜‘è‡åšå®¢é¡¹ç›®_Day02</title>
    <link href="/2023/12/11/%E8%98%91%E8%8F%87%E5%8D%9A%E5%AE%A2%E9%A1%B9%E7%9B%AE_Day02/"/>
    <url>/2023/12/11/%E8%98%91%E8%8F%87%E5%8D%9A%E5%AE%A2%E9%A1%B9%E7%9B%AE_Day02/</url>
    
    <content type="html"><![CDATA[<h3 id="Part01-æˆ‘ä»¬åº”è¯¥å»äº†è§£ä»€ä¹ˆä¸œè¥¿å‘¢"><a href="#Part01-æˆ‘ä»¬åº”è¯¥å»äº†è§£ä»€ä¹ˆä¸œè¥¿å‘¢" class="headerlink" title="Part01: æˆ‘ä»¬åº”è¯¥å»äº†è§£ä»€ä¹ˆä¸œè¥¿å‘¢"></a>Part01: æˆ‘ä»¬åº”è¯¥å»äº†è§£ä»€ä¹ˆä¸œè¥¿å‘¢</h3><p>è¿™éƒ¨åˆ†å†…å®¹ä¸»è¦è®²è¿°ä¸€ä¸‹åŸºç¡€çš„åšå®¢ç®¡ç†æ˜¯æ€ä¹ˆåšçš„ï¼Œå¦‚æœéœ€è¦åšä¸€ä¸ªåŸºç¡€çš„åšå®¢ç³»ç»Ÿéœ€è¦æ€ä¹ˆåšï¼Œè€ƒè™‘å“ªäº›æ–¹é¢ã€‚</p><p>up ä¸» CodeSheep  åœ¨è§†é¢‘å¯¹äºé¡¹ç›®å­¦ä¹ çš„ä¸€äº›å»ºè®®ï¼Œè®°å½•ä¸€ä¸‹ <a href="https://www.bilibili.com/video/BV1y4411p74E/">https://www.bilibili.com/video/BV1y4411p74E/</a></p><ul><li><ol><li>è¿è¡Œé¡¹ç›®å¹¶è·‘èµ·æ¥</li></ol></li><li><ol start="2"><li>é˜…è¯»é¡¹ç›®æºç å¹¶è°ƒè¯•ï¼ˆå¯ä»¥ç»“åˆæŸä¸ªè¿è¡Œçš„åŠŸèƒ½å…¥æ‰‹ï¼Œä¸€ä¸ªç»„ä»¶ä¸€ä¸ªç»„ä»¶å¼„ç†Ÿã€çœ‹æŠ¥é”™ã€çœ‹æ—¥å¿—ã€çœ‹æ‰“å°å˜é‡ï¼‰</li></ol></li><li><ol start="3"><li>è®°å½•æ–‡æ¡£ï¼Œä»ä¸šåŠ¡é€»è¾‘å‡ºå‘ï¼ˆé€»è¾‘å¾ˆé‡è¦ï¼Œä½ å…ˆå­¦ä¹ è¿™ä¸ªï¼Œå‰ç«¯é¡µé¢å®ç°å’ŒäºŒæ¬¡æ”¹é€ æƒ³æ³•å…ˆæ”¾åé¢ï¼Œå…ˆå»äº†è§£ï¼Œå†å»æ‘¸ç´¢ï¼‰</li></ol></li></ul><p>è§†é¢‘ä¸­æ¨èè¿‡è¿™ä¸ªé¡¹ç›®ï¼ˆä¸€ä¸ªå•ä½“é¡¹ç›®ï¼‰ï¼Œæœ‰ç©ºä¹Ÿå¯ä»¥å­¦ä¹ ä¸€ä¸‹ï¼š <a href="https://github.com/halo-dev/halo">https://github.com/halo-dev/halo</a></p><p>åœ¨åå°ç®¡ç†ç•Œé¢ä¸­ï¼Œæœ‰ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„æ¨¡å—æ˜¯ï¼šåšå®¢ç®¡ç†</p><p>åšå®¢ç®¡ç†ï¼ˆç•Œé¢ï¼‰</p><ul><li>åšå®¢ç®¡ç†</li><li>åˆ†ç±»ç®¡ç†</li><li>æ”¶è—ç®¡ç†</li><li>æ ‡ç­¾ç®¡ç†</li><li>æ¨èç®¡ç†</li><li>ä¸“é¢˜ç®¡ç†</li></ul><h3 id="Part02-è˜‘è‡åšå®¢ä¸­åšå®¢ç®¡ç†æ˜¯å¦‚ä½•å®ç°çš„ã€‚"><a href="#Part02-è˜‘è‡åšå®¢ä¸­åšå®¢ç®¡ç†æ˜¯å¦‚ä½•å®ç°çš„ã€‚" class="headerlink" title="Part02: è˜‘è‡åšå®¢ä¸­åšå®¢ç®¡ç†æ˜¯å¦‚ä½•å®ç°çš„ã€‚"></a>Part02: è˜‘è‡åšå®¢ä¸­åšå®¢ç®¡ç†æ˜¯å¦‚ä½•å®ç°çš„ã€‚</h3><p>å…ˆäº†è§£è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå›åˆ°æŠ€æœ¯æ ˆçš„ä½¿ç”¨ï¼ŒçŸ¥é“ä»–ä½¿ç”¨çš„æ˜¯ä»€ä¹ˆæŠ€æœ¯æ ˆï¼Œæ‰èƒ½å¯¹åé¢æœ‰æ›´å¥½çš„äº†è§£ã€‚</p><p>å…·ä½“å†…å®¹çœ‹ä¸€ä¸‹ <a href="https://gitee.com/moxi159753/mogu_blog_v2.git">https://gitee.com/moxi159753/mogu_blog_v2.git</a></p><p>è¿™é‡Œå°±ä¸ä¸€ä¸€åˆ—ä¸¾ï¼Œéœ€è¦çŸ¥é“çš„ä¸€ä¸ªæ˜¯é¡¹ç›®ä¸­ä½¿ç”¨çš„ Java æŒä¹…å±‚æ¡†æ¶ æ˜¯ MyBatis-Plusã€‚</p><p>é€šè¿‡è¿™ä¸ªæ¡†æ¶ï¼Œä½ å¯ä»¥å®ç° <strong>ä»£ç ç”Ÿæˆå™¨</strong>ã€<strong>è‡ªåŠ¨ CRUDï¼ˆCreate, Read, Update, Deleteï¼‰</strong> ç­‰æ“ä½œã€‚</p><h4 id="åšå®¢ç®¡ç†"><a href="#åšå®¢ç®¡ç†" class="headerlink" title="åšå®¢ç®¡ç†"></a>åšå®¢ç®¡ç†</h4><blockquote><p>æŸ¥æ‰¾</p></blockquote><p>æŸ¥è¯¢å¹¶åˆ†é¡µè·å–åšå®¢åˆ—è¡¨</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æ ¹æ®æ¡ä»¶è·å–åšå®¢åˆ—è¡¨ï¼Œå¹¶è¿›è¡Œåˆ†é¡µã€‚</span><br><span class="hljs-comment"> * ä½¿ç”¨MyBatis-Plusçš„QueryWrapperæ¥æ„å»ºæŸ¥è¯¢æ¡ä»¶ã€‚</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * @param blogVO åŒ…å«æŸ¥è¯¢æ¡ä»¶çš„VOå¯¹è±¡</span><br><span class="hljs-comment"> * @return åˆ†é¡µåçš„åšå®¢åˆ—è¡¨</span><br><span class="hljs-comment"> */</span><br>@Override<br>public IPage&lt;Blog&gt; getPageList(BlogVO blogVO) &#123;<br>    <span class="hljs-comment">// åˆ›å»ºæŸ¥è¯¢åŒ…è£…å™¨</span><br>    QueryWrapper&lt;Blog&gt; queryWrapper = <span class="hljs-keyword">new</span> QueryWrapper&lt;&gt;();<br><br>    <span class="hljs-comment">// æ„å»ºæœç´¢æ¡ä»¶</span><br>    <span class="hljs-keyword">if</span> (StringUtils.isNotEmpty(blogVO.getKeyword()) &amp;&amp; !StringUtils.<span class="hljs-built_in">isEmpty</span>(blogVO.getKeyword().<span class="hljs-built_in">trim</span>())) &#123;<br>        queryWrapper.like(SQLConf.TITLE, blogVO.getKeyword().<span class="hljs-built_in">trim</span>());<br>    &#125;<br>    <span class="hljs-keyword">if</span> (!StringUtils.<span class="hljs-built_in">isEmpty</span>(blogVO.getTagUid())) &#123;<br>        queryWrapper.like(SQLConf.TAG_UID, blogVO.getTagUid());<br>    &#125;<br>    <span class="hljs-keyword">if</span> (!StringUtils.<span class="hljs-built_in">isEmpty</span>(blogVO.getBlogSortUid())) &#123;<br>        queryWrapper.like(SQLConf.BLOG_SORT_UID, blogVO.getBlogSortUid());<br>    &#125;<br>    <span class="hljs-keyword">if</span> (!StringUtils.<span class="hljs-built_in">isEmpty</span>(blogVO.getLevelKeyword())) &#123;<br>        queryWrapper.eq(SQLConf.LEVEL, blogVO.getLevelKeyword());<br>    &#125;<br>    <span class="hljs-keyword">if</span> (!StringUtils.<span class="hljs-built_in">isEmpty</span>(blogVO.getIsPublish())) &#123;<br>        queryWrapper.eq(SQLConf.IS_PUBLISH, blogVO.getIsPublish());<br>    &#125;<br>    <span class="hljs-keyword">if</span> (!StringUtils.<span class="hljs-built_in">isEmpty</span>(blogVO.getIsOriginal())) &#123;<br>        queryWrapper.eq(SQLConf.IS_ORIGINAL, blogVO.getIsOriginal());<br>    &#125;<br>    <span class="hljs-keyword">if</span>(!StringUtils.<span class="hljs-built_in">isEmpty</span>(blogVO.getType())) &#123;<br>        queryWrapper.eq(SQLConf.TYPE, blogVO.getType());<br>    &#125;<br><br>    <span class="hljs-comment">// è®¾ç½®åˆ†é¡µå‚æ•°</span><br>    Page&lt;Blog&gt; page = <span class="hljs-keyword">new</span> Page&lt;&gt;();<br>    page.setCurrent(blogVO.getCurrentPage());<br>    page.setSize(blogVO.getPageSize());<br>    queryWrapper.eq(SQLConf.STATUS, EStatus.ENABLE);<br><br>    <span class="hljs-comment">// è®¾ç½®æ’åºæ–¹å¼</span><br>    <span class="hljs-keyword">if</span>(StringUtils.isNotEmpty(blogVO.getOrderByAscColumn())) &#123;<br>        <span class="hljs-comment">// å°†é©¼å³°å‘½åè½¬æ¢æˆä¸‹åˆ’çº¿å‘½å</span><br>        String column = StringUtils.underLine(<span class="hljs-keyword">new</span> StringBuffer(blogVO.getOrderByAscColumn())).toString();<br>        queryWrapper.orderByAsc(column);<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(StringUtils.isNotEmpty(blogVO.getOrderByDescColumn())) &#123;<br>        String column = StringUtils.underLine(<span class="hljs-keyword">new</span> StringBuffer(blogVO.getOrderByDescColumn())).toString();<br>        queryWrapper.orderByDesc(column);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// é»˜è®¤æ’åº</span><br>        <span class="hljs-keyword">if</span> (blogVO.getUseSort() == <span class="hljs-number">0</span>) &#123;<br>            queryWrapper.orderByDesc(SQLConf.CREATE_TIME);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            queryWrapper.orderByDesc(SQLConf.<span class="hljs-built_in">SORT</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// æ‰§è¡Œåˆ†é¡µæŸ¥è¯¢</span><br>    IPage&lt;Blog&gt; pageList = blogService.page(page, queryWrapper);<br>    List&lt;Blog&gt; list = pageList.getRecords();<br><br>    <span class="hljs-comment">// è‹¥ç»“æœä¸ºç©ºï¼Œç›´æ¥è¿”å›</span><br>    <span class="hljs-keyword">if</span> (list.size() == <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">return</span> pageList;<br>    &#125;<br><br>    <span class="hljs-comment">// å¤„ç†æŸ¥è¯¢ç»“æœï¼Œä¾‹å¦‚æ·»åŠ åˆ†ç±»ã€æ ‡ç­¾ç­‰é¢å¤–ä¿¡æ¯</span><br>    <span class="hljs-comment">// ... çœç•¥äº†é¢å¤–ä¿¡æ¯å¤„ç†çš„ä»£ç  ...</span><br><br>    <span class="hljs-comment">// è¿”å›å¤„ç†åçš„åˆ†é¡µç»“æœ</span><br>    pageList.setRecords(list);<br>    <span class="hljs-keyword">return</span> pageList;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¤„ç†æŸ¥è¯¢ç»“æœ</p><figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs pf">// ...çœç•¥æ–¹æ³•çš„å…¶å®ƒéƒ¨åˆ†...<br><br>List<span class="hljs-variable">&lt;Blog&gt;</span> list = pageList.getRecords();<br><br>// è‹¥æŸ¥è¯¢ç»“æœä¸ºç©ºï¼Œç›´æ¥è¿”å›<br>if (list.isEmpty()) &#123;<br>    return pageList;<br>&#125;<br><br>// åˆå§‹åŒ–å­˜å‚¨åˆ†ç±»UIDå’Œæ ‡ç­¾UIDçš„é›†åˆ<br>List<span class="hljs-variable">&lt;String&gt;</span> sortUids = new ArrayList<span class="hljs-variable">&lt;&gt;</span>();<br>List<span class="hljs-variable">&lt;String&gt;</span> <span class="hljs-keyword">tag</span>Uids = new ArrayList<span class="hljs-variable">&lt;&gt;</span>();<br><br>// éå†æŸ¥è¯¢ç»“æœï¼Œæ”¶é›†åˆ†ç±»UIDå’Œæ ‡ç­¾UID<br><span class="hljs-keyword">for</span> (B<span class="hljs-keyword">log</span> blog : list) &#123;<br>    if (StringUtils.isNotEmpty(blog.getB<span class="hljs-keyword">log</span>SortUid())) &#123;<br>        sortUids.add(blog.getB<span class="hljs-keyword">log</span>SortUid());<br>    &#125;<br>    if (StringUtils.isNotEmpty(blog.getTagUid())) &#123;<br>        <span class="hljs-keyword">tag</span>Uids.addAll(StringUtils.changeStringToString(blog.getTagUid(), SysConf.FILE_SEGMENTATION));<br>    &#125;<br>&#125;<br><br>// æ ¹æ®åˆ†ç±»UIDså’Œæ ‡ç­¾UIDsè·å–å¯¹åº”çš„åˆ†ç±»å’Œæ ‡ç­¾å¯¹è±¡<br>Collection<span class="hljs-variable">&lt;BlogSort&gt;</span> sortList = blogSortService.listByIds(sortUids);<br>Collection<span class="hljs-variable">&lt;Tag&gt;</span> <span class="hljs-keyword">tag</span>List = <span class="hljs-keyword">tag</span>Service.listByIds(<span class="hljs-keyword">tag</span>Uids);<br><br>// å°†åˆ†ç±»å’Œæ ‡ç­¾å¯¹è±¡è½¬æ¢ä¸ºMapï¼Œä¾¿äºå¿«é€ŸæŸ¥æ‰¾<br>Map<span class="hljs-variable">&lt;String, BlogSort&gt;</span> sortMap = sortList.stream()<br>    .collect(Collectors.<span class="hljs-keyword">to</span>Map(B<span class="hljs-keyword">log</span>Sort::getUid, Function.identity()));<br>Map<span class="hljs-variable">&lt;String, Tag&gt;</span> <span class="hljs-keyword">tag</span>Map = <span class="hljs-keyword">tag</span>List.stream()<br>    .collect(Collectors.<span class="hljs-keyword">to</span>Map(Tag::getUid, Function.identity()));<br><br>// éå†æŸ¥è¯¢ç»“æœï¼Œè®¾ç½®æ¯ä¸ªåšå®¢çš„åˆ†ç±»å’Œæ ‡ç­¾<br><span class="hljs-keyword">for</span> (B<span class="hljs-keyword">log</span> blog : list) &#123;<br>    blog.<span class="hljs-built_in">set</span>B<span class="hljs-keyword">log</span>Sort(sortMap.get(blog.getB<span class="hljs-keyword">log</span>SortUid()));<br>    List<span class="hljs-variable">&lt;String&gt;</span> <span class="hljs-keyword">tag</span>UidList = StringUtils.changeStringToString(blog.getTagUid(), SysConf.FILE_SEGMENTATION);<br>    List<span class="hljs-variable">&lt;Tag&gt;</span> blogTags = <span class="hljs-keyword">tag</span>UidList.stream()<br>        .map(<span class="hljs-keyword">tag</span>Map::get)<br>        .collect(Collectors.<span class="hljs-keyword">to</span>List());<br>    blog.<span class="hljs-built_in">set</span>TagList(blogTags);<br>&#125;<br><br>// æ›´æ–°å¤„ç†åçš„æŸ¥è¯¢ç»“æœ<br>pageList.<span class="hljs-built_in">set</span>Records(list);<br><br>// ...çœç•¥æ–¹æ³•çš„å…¶ä½™éƒ¨åˆ†...<br></code></pre></td></tr></table></figure><ol><li>é¦–å…ˆæ£€æŸ¥æŸ¥è¯¢ç»“æœåˆ—è¡¨æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ºç©ºåˆ™ç›´æ¥è¿”å›ã€‚</li><li>éå†åšå®¢åˆ—è¡¨ï¼Œä»æ¯ä¸ªåšå®¢å¯¹è±¡ä¸­æå–åˆ†ç±»å’Œæ ‡ç­¾çš„UIDã€‚</li><li>ä½¿ç”¨æ”¶é›†çš„UIDsä»æœåŠ¡å±‚è·å–ç›¸åº”çš„åˆ†ç±»å’Œæ ‡ç­¾å¯¹è±¡ã€‚</li><li>å°†åˆ†ç±»å’Œæ ‡ç­¾å¯¹è±¡è½¬æ¢æˆMapï¼Œæ–¹ä¾¿åç»­æ ¹æ®UIDå¿«é€ŸæŸ¥æ‰¾ã€‚</li><li>å†æ¬¡éå†åšå®¢åˆ—è¡¨ï¼Œä¸ºæ¯ä¸ªåšå®¢è®¾ç½®å¯¹åº”çš„åˆ†ç±»å’Œæ ‡ç­¾åˆ—è¡¨ã€‚</li><li>æœ€åï¼Œå°†æ›´æ–°åçš„åšå®¢åˆ—è¡¨è®¾ç½®å›åˆ†é¡µç»“æœå¯¹è±¡ä¸­ã€‚</li></ol><p>è¿™ä¸ªè¿‡ç¨‹å…è®¸åœ¨è¿”å›åšå®¢åˆ—è¡¨ä¹‹å‰ä¸°å¯Œæ¯ä¸ªåšå®¢å¯¹è±¡çš„ä¿¡æ¯ï¼Œå¦‚æ·»åŠ åˆ†ç±»å’Œæ ‡ç­¾æ•°æ®ã€‚ä»¥ä¾¿æä¾›æ›´è¯¦ç»†çš„ä¿¡æ¯ç»™å‰ç«¯æ˜¾ç¤ºã€‚</p><blockquote><p>æ·»åŠ åšå®¢</p></blockquote><p>to be continedâ€¦.</p>]]></content>
    
    
    <categories>
      
      <category>é¡¹ç›®</category>
      
    </categories>
    
    
    <tags>
      
      <tag>project</tag>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸šåŠ¡åœºæ™¯å’ŒæŠ€æœ¯é€‰å‹</title>
    <link href="/2023/12/11/%E4%B8%9A%E5%8A%A1%E5%9C%BA%E6%99%AF%E5%92%8C%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B/"/>
    <url>/2023/12/11/%E4%B8%9A%E5%8A%A1%E5%9C%BA%E6%99%AF%E5%92%8C%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B/</url>
    
    <content type="html"><![CDATA[<h3 id="ä¸šåŠ¡åœºæ™¯å’ŒæŠ€æœ¯é€‰å‹éœ€è¦è€ƒè™‘çš„å› ç´ "><a href="#ä¸šåŠ¡åœºæ™¯å’ŒæŠ€æœ¯é€‰å‹éœ€è¦è€ƒè™‘çš„å› ç´ " class="headerlink" title="ä¸šåŠ¡åœºæ™¯å’ŒæŠ€æœ¯é€‰å‹éœ€è¦è€ƒè™‘çš„å› ç´ "></a>ä¸šåŠ¡åœºæ™¯å’ŒæŠ€æœ¯é€‰å‹éœ€è¦è€ƒè™‘çš„å› ç´ </h3><h3 id="æˆé•¿å’Œæ€è€ƒ"><a href="#æˆé•¿å’Œæ€è€ƒ" class="headerlink" title="æˆé•¿å’Œæ€è€ƒ"></a>æˆé•¿å’Œæ€è€ƒ</h3><h4 id="1ã€å½“å°A-æ¥åˆ°éœ€æ±‚åçš„ååº”-ğŸŒï¸"><a href="#1ã€å½“å°A-æ¥åˆ°éœ€æ±‚åçš„ååº”-ğŸŒï¸" class="headerlink" title="1ã€å½“å°A æ¥åˆ°éœ€æ±‚åçš„ååº” ğŸŒï¸"></a>1ã€å½“å°A æ¥åˆ°éœ€æ±‚åçš„ååº” ğŸŒï¸</h4><p>å¯¹äºä¸€ä¸ªéœ€æ±‚æ¥è¯´ï¼Œæˆ‘ä»¬åº”è¯¥ç«™åœ¨ä¸€ä¸ªè¯„å®¡çš„æ€åº¦å»çœ‹å¾…ä»–ã€‚</p><p>æ¥åˆ°äº§å“ç»ç†çš„éœ€æ±‚åï¼Œæˆ‘ä»¬åº”è¯¥ä»æœ‰åˆ©äºä¸šåŠ¡çš„è§’åº¦å‡ºå‘æ€è€ƒï¼Œå¯¹è¿™ä¸ªéœ€æ±‚è¿›è¡Œåˆ ã€æ”¹ã€å¢ã€‚</p><p>åŒæ—¶æœ€é‡è¦çš„ä¸€ä¸ªåœ°æ–¹æ˜¯ï¼Œä½ éœ€è¦æœ‰è‡ªå·±çš„ä¸€ä¸ªæ€è€ƒå’Œè‡ªå·±çš„å®è·µï¼Œå¹¶å»è½å®ä»–å’Œæ¨åŠ¨ä¸€äº›ä¸œè¥¿ï¼Œè®©ä½ çš„æ€è€ƒèƒ½å¤Ÿè½åœ°å¹¶çœ‹åˆ°æˆæ•ˆã€‚</p><p>æœ‰è‡ªå·±çš„æ€è€ƒå’Œæ•´ä½“ä¸šåŠ¡çš„ç†è§£ï¼Œå°†æœ‰åŠ©äºä½ æ•´ä½“çš„ä¸€ä¸ªèŒä¸šç”Ÿæ¶¯ï¼Œå¯¹äºä½ ç›®å‰æ‰€åšçš„äº‹æƒ…ï¼Œä¹Ÿè®¸åœ¨æœªæ¥æŸä¸ªåœ°æ–¹ï¼Œèƒ½å¤Ÿç»“åˆä½ å½“æ—¶çš„ä¸€ä¸ªèƒŒæ™¯ï¼Œåšå‡ºæœ‰ç‚¹é…·å¹¶å¾ˆæœ‰ç”¨çš„ä¸œè¥¿ã€‚</p><h4 id="2ã€æé«˜æŸä»¶äº‹æƒ…çš„æ•ˆç‡-ğŸ¦–"><a href="#2ã€æé«˜æŸä»¶äº‹æƒ…çš„æ•ˆç‡-ğŸ¦–" class="headerlink" title="2ã€æé«˜æŸä»¶äº‹æƒ…çš„æ•ˆç‡  ğŸ¦–"></a>2ã€æé«˜æŸä»¶äº‹æƒ…çš„æ•ˆç‡  ğŸ¦–</h4><p>å¯¹äºé¡¹ç›®ä¸­çš„ç°æˆä»£ç ï¼Œæˆ‘ä»¬åº”è¯¥å»ç†æ€§æ€è€ƒï¼Œ</p><ul><li>ç¬¬ä¸€ï¼Œè¿™äº›ä»£ç ä¸ºä»€ä¹ˆè¿™ä¹ˆå†™å‘¢ï¼Œå†™çš„é€»è¾‘æ˜¯ä»€ä¹ˆï¼Œæœ‰ä»€ä¹ˆå¥½å¤„å‘¢ã€‚</li><li>ç¬¬äºŒï¼Œè¿™äº›ä»£ç èƒ½å¤Ÿä¼˜åŒ–å—ï¼Œå“ªäº›åœ°æ–¹å­˜åœ¨ç“¶é¢ˆå‘¢ï¼Œå¦‚ä½•ä¼˜åŒ–ã€‚ä¼˜åŒ–çš„è§£å†³æ–¹æ¡ˆæœ‰å“ªäº›ï¼Œæˆ‘ä»¬åº”è¯¥æ€ä¹ˆå¤„ç†ã€‚</li><li>ç¬¬ä¸‰ï¼Œä¿æŒæŒç»­å­¦ä¹ ï¼Œäº†è§£ç¨‹åºå®ç°çš„åº•å±‚é€»è¾‘ï¼Œå¯¹äºè®¡ç®—æœºæ“ä½œç³»ç»Ÿã€æ•°æ®ç»“æ„ã€ç»„æˆåŸç†ç­‰èƒ½å¤Ÿæœ‰æ¯”è¾ƒå¥½çš„è®¤è¯†å’Œç†è§£ã€‚</li><li>ç¬¬å››ï¼Œå¯¹äº ToC  çš„é¡¹ç›®ï¼Œæˆ‘ä»¬åº”è¯¥è€ƒè™‘ä¸€ä¸‹æœåŠ¡ QPS èƒ½æ”¯æ’‘å¤šå°‘ï¼Œå¿ƒé‡Œå¯¹äºæµé‡é˜ˆå€¼æœ‰ä¸€ä¸ªæ¸…æ¥šè®¤çŸ¥ï¼Œé’ˆå¯¹è¿™ä¸ªé˜ˆå€¼å¦‚ä½•æé«˜ä¼˜åŒ–ï¼Œæ€§èƒ½æ˜¯å¦ç¬¦åˆé¢„æœŸï¼Œæ˜¯ä¸€ä¸ªéœ€è¦è€ƒè™‘å¾ˆå¤šæ–¹é¢å’Œå†…å®¹çš„é—®é¢˜ã€‚</li><li>ç¬¬äº”ï¼Œå¯¹äºç”Ÿäº§ç¯å¢ƒå’Œæµ‹è¯•ç¯å¢ƒçš„åŒºåˆ«ï¼Œæ˜¯éå¸¸å¤§çš„ï¼Œç”Ÿäº§ç¯å¢ƒé‡åˆ°çš„å¤æ‚æ€§é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦éšæ—¶å…»æˆå…³æ³¨çº¿ä¸ŠæœåŠ¡è¿è¡Œçš„ä¸€ä¸ªæƒ…å†µï¼›ä¸€äº›åŸºç¡€çš„å†…å®¹ï¼Œæ¯”å¦‚è¯·æ±‚å³°å€¼çš„æ—¶å€™ CPUã€å†…å­˜çš„æ¶ˆè€—ã€ç½‘ç»œç«¯å£æ¶ˆè€—ç­‰éƒ½æ˜¯æˆ‘ä»¬éœ€è¦å»å…³æ³¨çš„ä¸€äº›ç‚¹ï¼Œå¹¶åœ¨å®è·µä¸­å…»æˆè¿™ä¸ªä¹ æƒ¯ã€‚</li><li>ç¬¬å…­ï¼Œäº†è§£æ•´ä¸ªé¡¹ç›®æ•´ä½“ä¸šåŠ¡ï¼Œä¸è¦ç»™è‡ªå·±çš„å·¥ä½œè®¾å®šè¾¹ç•Œã€‚</li><li>ç¬¬ä¸ƒï¼Œå½’çº³æ€»ç»“å¤ç›˜ã€‚</li></ul><p>å…³äºç¬¬äºŒç‚¹ï¼Œåœ¨ JavaGuide ç½‘ç«™æ–‡ç« ä¸­ä¸€å¥è¯å†™çš„å¾ˆå¥½ï¼Œå€Ÿé‰´å¼•ç”¨ä¸€ä¸‹ï¼š</p><div style="background-color: #3498db; color: white; padding: 10px;">   ä¸»åŠ¨æ€è€ƒä¸€ä¸‹ç°æœ‰å·¥ä½œä¸­å“ªäº›åœ°æ–¹æ•ˆç‡æœ‰æ”¹è¿›çš„ç©ºé—´ï¼Œæƒ³åˆ°äº†å°±ä¸»åŠ¨å»æ”¹è¿›å®ƒï¼</div><h4 id="3ã€å­¦ä¹ çš„æ—¶å€™ä¸€äº›å‘ä¸è¦å»ç¢°-ğŸ¤•"><a href="#3ã€å­¦ä¹ çš„æ—¶å€™ä¸€äº›å‘ä¸è¦å»ç¢°-ğŸ¤•" class="headerlink" title="3ã€å­¦ä¹ çš„æ—¶å€™ä¸€äº›å‘ä¸è¦å»ç¢° ğŸ¤•"></a>3ã€å­¦ä¹ çš„æ—¶å€™ä¸€äº›å‘ä¸è¦å»ç¢° ğŸ¤•</h4><ul><li>å¤šå»çœ‹å®˜æ–¹æ–‡æ¡£ï¼Œå¤šå»çœ‹å®é™…çš„æºç ï¼Œå°½é‡å°‘çš„å»çœ‹ä¸€ä¸‹åƒåœ¾åšå®¢</li><li>å…³æ³¨ç»†èŠ‚</li><li>åŠæ—¶åé¦ˆ</li><li>è§„èŒƒï¼Œä»¥åŠè§„èŒƒï¼ˆä»£ç ï¼Œæ³¨é‡Šï¼Œæ¥å£ï¼Œæ–¹æ³•åç§°ï¼Œæ–‡æ¡£ï¼ŒæŠ€æœ¯åç§°ï¼Œæ—¥å¿—ï¼Œæµ‹è¯•ï¼‰</li><li>å¤šå®é™…å»å†™ä»£ç ï¼ˆä¸è¦ä¸€è¯´å°±ä¼šï¼Œä¸€å†™å°±åºŸï¼‰</li><li>é‡è¦çš„å˜æ›´å’Œæ¥å£å†…å®¹ä¸€å®šè¦å†™æ–‡æ¡£</li><li>ç†è§£éœ€æ±‚åï¼Œå†å¼€å§‹å†™ä»£ç </li><li>å¤šæ€è€ƒï¼Œæœ‰è‡ªå·±çš„ç†è§£åå†å»è¯¢é—®ä¸€äº›ä¸œè¥¿ï¼ˆç§¯ææ²Ÿé€šï¼‰</li><li>ç”Ÿäº§ç¯å¢ƒä¸è¦åŠ¨</li></ul><h3 id="æœªæ¥å°±ä¸šæ–¹å‘é€‰æ‹©"><a href="#æœªæ¥å°±ä¸šæ–¹å‘é€‰æ‹©" class="headerlink" title="æœªæ¥å°±ä¸šæ–¹å‘é€‰æ‹©"></a>æœªæ¥å°±ä¸šæ–¹å‘é€‰æ‹©</h3><p>åœ¨ç›®å‰è¿™ç§è¶‹åŠ¿çš„æœªæ¥ä¸­ï¼Œå¯¹äºé¡¶å±‚è®¾è®¡çš„è¦æ±‚ä»ä¸šäººå‘˜å…¶å®æ˜¯è¶Šæ¥è¶Šé«˜çš„ï¼Œéœ€æ±‚é‡ä¹Ÿè¦å‡å°‘ï¼ˆå·²ç»æœ‰å¾ˆå¤šç°æˆçš„è§£å†³æ–¹æ¡ˆï¼‰ï¼Œæœªæ¥çš„å°±ä¸šå¸‚åœºéœ€è¦çš„åè€Œæ˜¯ä¸­ä½å±‚äººå‘˜ï¼Œè€Œéšç€GPTç­‰äººå·¥æ™ºèƒ½çš„å‘å±•ï¼ŒæŠ€æœ¯äººå‘˜çš„å¯æ›¿ä»£æ€§å…¶å®æ˜¯å¾ˆå¼ºçš„ã€‚</p><div style="background: linear-gradient(to right, #6dd5fa, #ff758c); color: white; padding: 15px;">  ä¹‰æ— åé¡¾çš„æŠ“ä½æ¯ä¸€ä¸ªç®¡ç†å²—æœºä¼šã€‚</div><ul><li>é©¾é©­ç®¡ç†<ul><li>æ¨¡ä»¿å‘¨å›´ä¼˜ç§€ç®¡ç†è€…</li><li>æ‰¾æœºä¼šé”»ç‚¼ å±•ç¤ºèƒ½åŠ›</li></ul></li><li>é¡¶å±‚æ¶æ„<ul><li>å¤§é‡ç ”è¯»å¸æ”¶  æ¶æ„è®¾è®¡æ–¹æ¡ˆ</li></ul></li></ul><p>æ¨èä¹¦ç±ï¼šã€Šè½¯ä»¶å¹³å°ç®¡ç†æ¶æ„è®¾è®¡ä¸æŠ€æœ¯ç®¡ç†ä¹‹é“ã€‹</p>]]></content>
    
    
    <categories>
      
      <category>é¡¹ç›®</category>
      
    </categories>
    
    
    <tags>
      
      <tag>project</tag>
      
      <tag>thinking</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Rediså…¥é—¨_åŸºç¡€æ¦‚å¿µ</title>
    <link href="/2023/12/08/Redis%E5%85%A5%E9%97%A8_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/"/>
    <url>/2023/12/08/Redis%E5%85%A5%E9%97%A8_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å¤§çº²</p></blockquote><ul><li>Redis æ˜¯ä»€ä¹ˆ</li><li>Redis çš„å¸¸ç”¨æ•°æ®ç±»å‹</li><li>Redisä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«</li><li>Redis å’Œ Memcached çš„åŒºåˆ«å’Œå…±åŒç‚¹</li><li>Redisçš„ç¼“å­˜è¯»å†™ç­–ç•¥</li><li>Redis èƒ½åšä»€ä¹ˆ</li><li>RedisæŒä¹…åŒ–æœºåˆ¶</li><li>Redisçº¿ç¨‹æ¨¡å‹</li><li>Rediså†…å­˜ç®¡ç†</li></ul><h3 id="1ã€Redis-æ˜¯ä»€ä¹ˆ"><a href="#1ã€Redis-æ˜¯ä»€ä¹ˆ" class="headerlink" title="1ã€Redis æ˜¯ä»€ä¹ˆ"></a>1ã€Redis æ˜¯ä»€ä¹ˆ</h3><p>Redisæ˜¯ä¸€ç§æ”¯æŒkey-valueç­‰å¤šç§æ•°æ®ç»“æ„çš„å­˜å‚¨ç³»ç»Ÿï¼›æ•°æ®ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œæ”¯æŒæŒä¹…åŒ–ã€‚</p><p>å¯ç”¨äºç¼“å­˜ï¼Œäº‹ä»¶å‘å¸ƒæˆ–è®¢é˜…ï¼Œé«˜é€Ÿé˜Ÿåˆ—ç­‰åœºæ™¯ã€‚æ”¯æŒç½‘ç»œï¼Œæä¾›å­—ç¬¦ä¸²ï¼Œå“ˆå¸Œï¼Œåˆ—è¡¨ï¼Œé˜Ÿåˆ—ï¼Œé›†åˆç»“æ„ç›´æ¥å­˜å–ï¼Œæ”¯æŒäº‹åŠ¡ã€æŒä¹…åŒ–ã€Luaè„šæœ¬ï¼Œé›†ç¾¤ã€‚</p><p>ä¸‹é¢æ˜¯éƒ¨åˆ†ç‰¹æ€§ï¼š</p><ul><li><strong>è¯»å†™æ€§èƒ½ä¼˜å¼‚</strong><ul><li>Redisèƒ½è¯»çš„é€Ÿåº¦æ˜¯110000æ¬¡&#x2F;s,å†™çš„é€Ÿåº¦æ˜¯81000æ¬¡&#x2F;s ï¼ˆåŸºäºå†…å­˜ï¼ŒåŸºäºReactor æ¨¡å¼ï¼‰</li></ul></li><li><strong>æ•°æ®ç±»å‹ä¸°å¯Œ</strong><ul><li>Redisæ”¯æŒäºŒè¿›åˆ¶æ¡ˆä¾‹çš„ Strings, Lists, Hashes, Sets åŠ Ordered Sets æ•°æ®ç±»å‹æ“ä½œã€‚</li></ul></li><li><strong>åŸå­æ€§</strong><ul><li>Redisçš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯åŸå­æ€§çš„ï¼ŒåŒæ—¶Redisè¿˜æ”¯æŒå¯¹å‡ ä¸ªæ“ä½œå…¨å¹¶åçš„åŸå­æ€§æ‰§è¡Œã€‚</li></ul></li><li><strong>ä¸°å¯Œçš„ç‰¹æ€§</strong><ul><li>Redisæ”¯æŒ publish&#x2F;subscribe, é€šçŸ¥, key è¿‡æœŸç­‰ç‰¹æ€§ã€‚</li></ul></li><li><strong>æŒä¹…åŒ–</strong><ul><li>Redisæ”¯æŒRDB, AOFç­‰æŒä¹…åŒ–æ–¹å¼</li></ul></li><li><strong>åˆ†å¸ƒå¼</strong><ul><li>Redis Cluster</li></ul></li></ul><h3 id="2ã€Redis-çš„å¸¸ç”¨æ•°æ®ç±»å‹"><a href="#2ã€Redis-çš„å¸¸ç”¨æ•°æ®ç±»å‹" class="headerlink" title="2ã€Redis çš„å¸¸ç”¨æ•°æ®ç±»å‹"></a>2ã€Redis çš„å¸¸ç”¨æ•°æ®ç±»å‹</h3><ul><li><strong>5ç§åŸºç¡€æ•°æ®ç±»å‹</strong>ï¼Œåˆ†åˆ«æ˜¯ï¼šStringã€Listã€Setã€Zsetã€Hashã€‚</li></ul><table><thead><tr><th>ç»“æ„ç±»å‹</th><th>ç»“æ„å­˜å‚¨çš„å€¼</th><th>ç»“æ„çš„è¯»å†™èƒ½åŠ›</th></tr></thead><tbody><tr><td><strong>Stringå­—ç¬¦ä¸²</strong></td><td>å¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€æ•´æ•°æˆ–æµ®ç‚¹æ•°</td><td>å¯¹æ•´ä¸ªå­—ç¬¦ä¸²æˆ–å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†è¿›è¡Œæ“ä½œï¼›å¯¹æ•´æ•°æˆ–æµ®ç‚¹æ•°è¿›è¡Œè‡ªå¢æˆ–è‡ªå‡æ“ä½œï¼›</td></tr><tr><td><strong>Liståˆ—è¡¨</strong></td><td>ä¸€ä¸ªé“¾è¡¨ï¼Œé“¾è¡¨ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹éƒ½åŒ…å«ä¸€ä¸ªå­—ç¬¦ä¸²</td><td>å¯¹é“¾è¡¨çš„ä¸¤ç«¯è¿›è¡Œpushå’Œpopæ“ä½œï¼Œè¯»å–å•ä¸ªæˆ–å¤šä¸ªå…ƒç´ ï¼›æ ¹æ®å€¼æŸ¥æ‰¾æˆ–åˆ é™¤å…ƒç´ ï¼›</td></tr><tr><td><strong>Seté›†åˆ</strong></td><td>åŒ…å«å­—ç¬¦ä¸²çš„æ— åºé›†åˆ</td><td>å­—ç¬¦ä¸²çš„é›†åˆï¼ŒåŒ…å«åŸºç¡€çš„æ–¹æ³•æœ‰çœ‹æ˜¯å¦å­˜åœ¨æ·»åŠ ã€è·å–ã€åˆ é™¤ï¼›è¿˜åŒ…å«è®¡ç®—äº¤é›†ã€å¹¶é›†ã€å·®é›†ç­‰</td></tr><tr><td><strong>Hashæ•£åˆ—</strong></td><td>åŒ…å«é”®å€¼å¯¹çš„æ— åºæ•£åˆ—è¡¨</td><td>åŒ…å«æ–¹æ³•æœ‰æ·»åŠ ã€è·å–ã€åˆ é™¤å•ä¸ªå…ƒç´ </td></tr><tr><td><strong>Zsetæœ‰åºé›†åˆ</strong></td><td>å’Œæ•£åˆ—ä¸€æ ·ï¼Œç”¨äºå­˜å‚¨é”®å€¼å¯¹</td><td>å­—ç¬¦ä¸²æˆå‘˜ä¸æµ®ç‚¹æ•°åˆ†æ•°ä¹‹é—´çš„æœ‰åºæ˜ å°„ï¼›å…ƒç´ çš„æ’åˆ—é¡ºåºç”±åˆ†æ•°çš„å¤§å°å†³å®šï¼›åŒ…å«æ–¹æ³•æœ‰æ·»åŠ ã€è·å–ã€åˆ é™¤å•ä¸ªå…ƒç´ ä»¥åŠæ ¹æ®åˆ†å€¼èŒƒå›´æˆ–æˆå‘˜æ¥è·å–å…ƒç´ </td></tr></tbody></table><ul><li><strong>ä¸‰ç§ç‰¹æ®Šçš„æ•°æ®ç±»å‹</strong>Â åˆ†åˆ«æ˜¯ HyperLogLogsï¼ˆåŸºæ•°ç»Ÿè®¡ï¼‰ï¼Œ Bitmaps (ä½å›¾) å’Œ geospatial ï¼ˆåœ°ç†ä½ç½®)</li></ul><p>Redis çš„æ•°æ®è¡¨ç¤º</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202312251645493.png" alt="image.png"></p><h3 id="3ã€Redisä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«ï¼Ÿ"><a href="#3ã€Redisä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«ï¼Ÿ" class="headerlink" title="3ã€Redisä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«ï¼Ÿ"></a>3ã€Redisä¸ºä»€ä¹ˆè¿™ä¹ˆå¿«ï¼Ÿ</h3><ul><li>åŸºäºå†…å­˜æ“ä½œ</li><li>æ•°æ®ç»“æ„ä¼˜åŒ–</li><li>å•çº¿ç¨‹äº‹ä»¶é©±åŠ¨æ¨¡å‹</li><li>ä¸“é—¨ä¸ºé«˜æ€§èƒ½è€Œè®¾è®¡ï¼ˆä¸“æ³¨äºæ ¸å¿ƒåŠŸèƒ½ï¼Œè®¾è®¡ç®€æ´ï¼ŒåŠŸèƒ½å¼ºå¤§ï¼‰</li></ul><h3 id="4ã€Redis-å’Œ-Memcached-çš„åŒºåˆ«å’Œå…±åŒç‚¹"><a href="#4ã€Redis-å’Œ-Memcached-çš„åŒºåˆ«å’Œå…±åŒç‚¹" class="headerlink" title="4ã€Redis å’Œ Memcached çš„åŒºåˆ«å’Œå…±åŒç‚¹"></a>4ã€Redis å’Œ Memcached çš„åŒºåˆ«å’Œå…±åŒç‚¹</h3><div style="background-color: #ecf0f1; color: #34495e; padding: 15px; border: 2px solid #bdc3c7; border-radius: 5px;">  <strong>åŒºåˆ«ç‚¹ï¼š</strong>å®é™…å›ç­”çš„æ—¶å€™å»ºè®®é€šè¿‡ä»Redis çš„ä¸€äº›ç‰¹æ€§å»å›ç­”ï¼Œå¦‚æœé—®åˆ° Memcached åˆ°æ—¶å€™å¯ä»¥ä» æ•°æ®ç±»å‹ã€è¿‡æœŸç­–ç•¥ã€é›†ç¾¤ã€æŒä¹…åŒ–æ–¹é¢å»å›ç­”ä¸»è¦åŒºåˆ«ç‚¹ã€‚</div><p>Rediså’ŒMemcachedéƒ½æ˜¯å¹¿æ³›ä½¿ç”¨çš„é«˜æ€§èƒ½å†…å­˜ç¼“å­˜ç³»ç»Ÿï¼Œä½†å®ƒä»¬åœ¨è®¾è®¡ã€åŠŸèƒ½å’Œä½¿ç”¨æ¡ˆä¾‹æ–¹é¢æœ‰ä¸€äº›æ˜¾è‘—çš„åŒºåˆ«å’Œå…±åŒç‚¹ã€‚</p><p>å…±åŒç‚¹</p><ol><li><strong>åŸºäºå†…å­˜çš„å­˜å‚¨</strong>ï¼šRediså’ŒMemcachedéƒ½æ˜¯åŸºäºå†…å­˜çš„é”®å€¼å­˜å‚¨ç³»ç»Ÿï¼Œæä¾›å¿«é€Ÿçš„æ•°æ®è¯»å†™èƒ½åŠ›ã€‚</li><li><strong>é«˜æ€§èƒ½</strong>ï¼šä¸¤è€…éƒ½æ˜¯ä¸ºäº†æé«˜æ•°æ®è®¿é—®é€Ÿåº¦è€Œè®¾è®¡çš„ï¼Œèƒ½å¤Ÿå¤„ç†å¤§é‡å¹¶å‘è¯·æ±‚ã€‚</li><li><strong>ç®€å•çš„é”®å€¼æ•°æ®æ¨¡å‹</strong>ï¼šå®ƒä»¬ä½¿ç”¨ç®€å•çš„é”®å€¼å¯¹æ¨¡å‹æ¥å­˜å‚¨æ•°æ®ã€‚</li><li><strong>ç¼“å­˜ç”¨é€”</strong>ï¼šé€šå¸¸è¢«ç”¨ä½œæ•°æ®åº“å‰çš„ç¼“å­˜ç³»ç»Ÿï¼Œä»¥å‡å°‘å¯¹åç«¯æ•°æ®åº“çš„è®¿é—®å‹åŠ›ã€‚</li></ol><p>åŒºåˆ«</p><ol><li><strong>æ•°æ®ç±»å‹æ”¯æŒ</strong>ï¼š<ul><li><strong>Redis</strong>ï¼šæ”¯æŒæ›´ä¸°å¯Œçš„æ•°æ®ç±»å‹ï¼Œå¦‚å­—ç¬¦ä¸²ã€å“ˆå¸Œã€åˆ—è¡¨ã€é›†åˆã€æœ‰åºé›†åˆã€ä½å›¾ã€HyperLogLogsç­‰ã€‚</li><li><strong>Memcached</strong>ï¼šä¸»è¦æ”¯æŒç®€å•çš„é”®å€¼æ•°æ®ç±»å‹ã€‚</li></ul></li><li><strong>æŒä¹…åŒ–</strong>ï¼š<ul><li><strong>Redis</strong>ï¼šæä¾›æ•°æ®æŒä¹…åŒ–åŠŸèƒ½ï¼Œå¯ä»¥å°†å†…å­˜ä¸­çš„æ•°æ®ä¿å­˜åˆ°ç¡¬ç›˜ä¸­ï¼Œé˜²æ­¢æ•°æ®ä¸¢å¤±ã€‚Redisæ”¯æŒRDBï¼ˆå¿«ç…§ï¼‰å’ŒAOFï¼ˆè¿½åŠ æ–‡ä»¶ï¼‰ä¸¤ç§æŒä¹…åŒ–æ–¹å¼ã€‚</li><li><strong>Memcached</strong>ï¼šä¸æä¾›æŒä¹…åŒ–åŠŸèƒ½ï¼Œä¸»è¦ç”¨ä½œçº¯å†…å­˜ç¼“å­˜ã€‚</li></ul></li><li><strong>æ•°æ®è¿‡æœŸæœºåˆ¶</strong>ï¼š<ul><li><strong>Redis</strong>å’Œ<strong>Memcached</strong>éƒ½æ”¯æŒè®¾ç½®é”®çš„è¿‡æœŸæ—¶é—´ï¼Œä½†Redisåœ¨å¤„ç†è¿‡æœŸé”®æ–¹é¢æ›´ä¸ºçµæ´»ã€‚</li></ul></li><li><strong>åˆ†å¸ƒå¼æ”¯æŒ</strong>ï¼š<ul><li><strong>Redis</strong>ï¼šæœ‰åŸç”Ÿçš„é›†ç¾¤æ¨¡å¼ï¼Œæ”¯æŒæ•°æ®åˆ†ç‰‡å’Œé«˜å¯ç”¨æ€§ã€‚</li><li><strong>Memcached</strong>ï¼šé€šå¸¸ä¾èµ–å®¢æˆ·ç«¯æ¥å®ç°æ•°æ®åˆ†å¸ƒï¼Œæ²¡æœ‰å†…ç½®çš„é›†ç¾¤åŠŸèƒ½ã€‚</li></ul></li><li><strong>åŸå­æ“ä½œå’Œè„šæœ¬</strong>ï¼š<ul><li><strong>Redis</strong>ï¼šæ”¯æŒäº‹åŠ¡ã€åŸå­æ“ä½œå’ŒLuaè„šæœ¬ï¼Œè¿™å¢åŠ äº†å…¶åœ¨å¤æ‚æ“ä½œæ–¹é¢çš„èƒ½åŠ›ã€‚</li><li><strong>Memcached</strong>ï¼šæä¾›æœ‰é™çš„åŸå­æ“ä½œï¼Œä¸æ”¯æŒè„šæœ¬ã€‚</li></ul></li><li><strong>å‘å¸ƒ&#x2F;è®¢é˜…æ¨¡å¼</strong>ï¼š<ul><li><strong>Redis</strong>ï¼šæ”¯æŒå‘å¸ƒ&#x2F;è®¢é˜…æ¶ˆæ¯æ¨¡å¼ï¼Œé€‚ç”¨äºæ¶ˆæ¯é˜Ÿåˆ—ç­‰åº”ç”¨ã€‚</li><li><strong>Memcached</strong>ï¼šä¸æ”¯æŒå‘å¸ƒ&#x2F;è®¢é˜…æ¨¡å¼ã€‚</li></ul></li></ol><p>ä½¿ç”¨åœºæ™¯</p><ul><li><strong>Redis</strong>ï¼š<ul><li>ç”±äºå…¶ä¸°å¯Œçš„æ•°æ®ç±»å‹å’ŒåŠŸèƒ½ï¼Œé€‚ç”¨äºéœ€è¦å¤æ‚æ•°æ®ç»“æ„å’ŒåŸå­æ“ä½œçš„åœºæ™¯ã€‚</li><li>é€‚ç”¨äºéœ€è¦æ•°æ®æŒä¹…åŒ–çš„åœºæ™¯ã€‚</li><li>å¯ç”¨ä½œæ¶ˆæ¯é˜Ÿåˆ—ã€ä¼šè¯å­˜å‚¨ã€å…¨é¡µç¼“å­˜ç­‰ã€‚</li></ul></li><li><strong>Memcached</strong>ï¼š<ul><li>ç”±äºå…¶ç®€å•æ€§å’Œé«˜æ•ˆæ€§ï¼Œé€‚ç”¨äºéœ€è¦å¿«é€Ÿè½»é‡çº§ç¼“å­˜çš„åœºæ™¯ã€‚</li><li>é€‚åˆä½œä¸ºçº¯å†…å­˜ç¼“å­˜ä½¿ç”¨ï¼Œå¦‚ç®€å•çš„ä¼šè¯ç¼“å­˜ã€‚</li></ul></li></ul><p>Rediså’ŒMemcachedè™½ç„¶éƒ½æ˜¯å†…å­˜ç¼“å­˜ç³»ç»Ÿï¼Œä½†Redisæä¾›äº†æ›´ä¸°å¯Œçš„æ•°æ®ç±»å‹å’ŒåŠŸèƒ½ï¼ŒåŒ…æ‹¬æ•°æ®æŒä¹…åŒ–ã€å¤æ‚çš„æ“ä½œå’Œæ¶ˆæ¯é˜Ÿåˆ—åŠŸèƒ½ã€‚</p><p>è€ŒMemcachedåˆ™æ›´åŠ è½»é‡çº§ï¼Œé€‚ç”¨äºç®€å•çš„ç¼“å­˜éœ€æ±‚ã€‚é€‰æ‹©å“ªä¸€ä¸ªå–å†³äºå…·ä½“çš„åº”ç”¨éœ€æ±‚å’Œç¯å¢ƒã€‚</p><p>JavaGudie çš„ä¸€äº›å†…å®¹æ€»ç»“ï¼Œä¹Ÿå¯ä»¥å‚è€ƒä¸‹:</p><p><strong>å…±åŒç‚¹</strong>ï¼š</p><ol><li>éƒ½æ˜¯åŸºäºå†…å­˜çš„æ•°æ®åº“ï¼Œä¸€èˆ¬éƒ½ç”¨æ¥å½“åšç¼“å­˜ä½¿ç”¨ã€‚</li><li>éƒ½æœ‰è¿‡æœŸç­–ç•¥ã€‚</li><li>ä¸¤è€…çš„æ€§èƒ½éƒ½éå¸¸é«˜ã€‚</li></ol><p><strong>åŒºåˆ«</strong>ï¼š</p><ol><li><strong>Redis æ”¯æŒæ›´ä¸°å¯Œçš„æ•°æ®ç±»å‹ï¼ˆæ”¯æŒæ›´å¤æ‚çš„åº”ç”¨åœºæ™¯ï¼‰</strong>ã€‚Redis ä¸ä»…ä»…æ”¯æŒç®€å•çš„ k&#x2F;v ç±»å‹çš„æ•°æ®ï¼ŒåŒæ—¶è¿˜æä¾› listï¼Œsetï¼Œzsetï¼Œhash ç­‰æ•°æ®ç»“æ„çš„å­˜å‚¨ã€‚Memcached åªæ”¯æŒæœ€ç®€å•çš„ k&#x2F;v æ•°æ®ç±»å‹ã€‚</li><li><strong>Redis æ”¯æŒæ•°æ®çš„æŒä¹…åŒ–ï¼Œå¯ä»¥å°†å†…å­˜ä¸­çš„æ•°æ®ä¿æŒåœ¨ç£ç›˜ä¸­ï¼Œé‡å¯çš„æ—¶å€™å¯ä»¥å†æ¬¡åŠ è½½è¿›è¡Œä½¿ç”¨,è€Œ Memcached æŠŠæ•°æ®å…¨éƒ¨å­˜åœ¨å†…å­˜ä¹‹ä¸­ã€‚</strong></li><li><strong>Redis æœ‰ç¾éš¾æ¢å¤æœºåˆ¶ã€‚</strong> å› ä¸ºå¯ä»¥æŠŠç¼“å­˜ä¸­çš„æ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜ä¸Šã€‚</li><li><strong>Redis åœ¨æœåŠ¡å™¨å†…å­˜ä½¿ç”¨å®Œä¹‹åï¼Œå¯ä»¥å°†ä¸ç”¨çš„æ•°æ®æ”¾åˆ°ç£ç›˜ä¸Šã€‚ä½†æ˜¯ï¼ŒMemcached åœ¨æœåŠ¡å™¨å†…å­˜ä½¿ç”¨å®Œä¹‹åï¼Œå°±ä¼šç›´æ¥æŠ¥å¼‚å¸¸ã€‚</strong></li><li><strong>Memcached æ²¡æœ‰åŸç”Ÿçš„é›†ç¾¤æ¨¡å¼ï¼Œéœ€è¦ä¾é å®¢æˆ·ç«¯æ¥å®ç°å¾€é›†ç¾¤ä¸­åˆ†ç‰‡å†™å…¥æ•°æ®ï¼›ä½†æ˜¯ Redis ç›®å‰æ˜¯åŸç”Ÿæ”¯æŒ cluster æ¨¡å¼çš„ã€‚</strong></li><li><strong>Memcached æ˜¯å¤šçº¿ç¨‹ï¼Œéé˜»å¡ IO å¤ç”¨çš„ç½‘ç»œæ¨¡å‹ï¼›Redis ä½¿ç”¨å•çº¿ç¨‹çš„å¤šè·¯ IO å¤ç”¨æ¨¡å‹ã€‚</strong> ï¼ˆRedis 6.0 é’ˆå¯¹ç½‘ç»œæ•°æ®çš„è¯»å†™å¼•å…¥äº†å¤šçº¿ç¨‹ï¼‰</li><li><strong>Redis æ”¯æŒå‘å¸ƒè®¢é˜…æ¨¡å‹ã€Lua è„šæœ¬ã€äº‹åŠ¡ç­‰åŠŸèƒ½ï¼Œè€Œ Memcached ä¸æ”¯æŒã€‚å¹¶ä¸”ï¼ŒRedis æ”¯æŒæ›´å¤šçš„ç¼–ç¨‹è¯­è¨€ã€‚</strong></li><li><strong>Memcached è¿‡æœŸæ•°æ®çš„åˆ é™¤ç­–ç•¥åªç”¨äº†æƒ°æ€§åˆ é™¤ï¼Œè€Œ Redis åŒæ—¶ä½¿ç”¨äº†æƒ°æ€§åˆ é™¤ä¸å®šæœŸåˆ é™¤ã€‚</strong></li></ol><h3 id="5ã€å¸¸ç”¨çš„ç¼“å­˜è¯»å†™ç­–ç•¥"><a href="#5ã€å¸¸ç”¨çš„ç¼“å­˜è¯»å†™ç­–ç•¥" class="headerlink" title="5ã€å¸¸ç”¨çš„ç¼“å­˜è¯»å†™ç­–ç•¥"></a>5ã€å¸¸ç”¨çš„ç¼“å­˜è¯»å†™ç­–ç•¥</h3><div style="background-color: #f2c867; color: #34495e; padding: 15px; border: 2px solid #bdc3c7; border-radius: 5px;">  <strong>ç¼“å­˜å¸¸ç”¨çš„ä¸‰ç§è¯»å†™ç­–ç•¥ï¼š</strong>Cache Aside Patternï¼ˆæ—è·¯ç¼“å­˜æ¨¡å¼ï¼‰ã€Read/Write Through Patternï¼ˆè¯»å†™ç©¿é€ï¼‰ã€Write Behind Patternï¼ˆå¼‚æ­¥ç¼“å­˜å†™å…¥ï¼‰</div><p><strong>ä¸‰ç§æ¨¡å¼å„æœ‰ä¼˜åŠ£ï¼Œä¸å­˜åœ¨æœ€ä½³æ¨¡å¼ï¼Œæ ¹æ®å…·ä½“çš„ä¸šåŠ¡åœºæ™¯é€‰æ‹©é€‚åˆè‡ªå·±çš„ç¼“å­˜è¯»å†™æ¨¡å¼ã€‚</strong></p><h4 id="Cache-Aside-Patternï¼ˆæ—è·¯ç¼“å­˜æ¨¡å¼ï¼‰"><a href="#Cache-Aside-Patternï¼ˆæ—è·¯ç¼“å­˜æ¨¡å¼ï¼‰" class="headerlink" title="Cache Aside Patternï¼ˆæ—è·¯ç¼“å­˜æ¨¡å¼ï¼‰"></a>Cache Aside Patternï¼ˆæ—è·¯ç¼“å­˜æ¨¡å¼ï¼‰</h4><p>é€‚åˆè¯»æ¯”è¾ƒå¤šçš„æƒ…å†µ</p><p>å†™ï¼š</p><ul><li>å…ˆæ›´æ–° db</li><li>ç„¶åç›´æ¥åˆ é™¤ cache</li></ul><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231225211100.png" alt="image.png"></p><p><strong>è¯»</strong>Â :</p><ul><li>ä» cache ä¸­è¯»å–æ•°æ®ï¼Œè¯»å–åˆ°å°±ç›´æ¥è¿”å›</li><li>cache ä¸­è¯»å–ä¸åˆ°çš„è¯ï¼Œå°±ä» db ä¸­è¯»å–æ•°æ®è¿”å›</li><li>å†æŠŠæ•°æ®æ”¾åˆ° cache ä¸­ã€‚</li></ul><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231225211235.png" alt="image.png"></p><blockquote><p><strong>åœ¨å†™æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥å…ˆåˆ é™¤ cache ï¼Œåæ›´æ–° db ä¹ˆï¼Ÿ</strong></p></blockquote><p>è¿™ç§æ“ä½œä¸èƒ½è¿›è¡Œï¼Œä¼šé€ æˆæ•°æ®åº“å’Œç¼“å­˜æ•°æ®ä¸ä¸€è‡´ã€‚</p><p>ä¸¾ä¾‹ï¼šè¯·æ±‚ 1 å…ˆå†™æ•°æ® Aï¼Œè¯·æ±‚ 2 éšåè¯»æ•°æ® A çš„è¯ï¼Œå°±å¾ˆæœ‰å¯èƒ½äº§ç”Ÿæ•°æ®ä¸ä¸€è‡´æ€§çš„é—®é¢˜ã€‚</p><p>è¯´æ˜ï¼š</p><p>å½“æœ‰ä¸€ä¸ªè¯·æ±‚ï¼ˆæˆ‘ä»¬ç§°ä¹‹ä¸ºè¯·æ±‚1ï¼‰æ¥æ›´æ–°æŸä¸ªæ•°æ®é¡¹ï¼ˆç§°ä¸ºæ•°æ®Aï¼‰æ—¶ï¼Œä½ é¢ä¸´ä¸€ä¸ªé€‰æ‹©ï¼šæ˜¯å…ˆæ›´æ–°æ•°æ®åº“ä¸­çš„æ•°æ®Aï¼Œç„¶åå†åˆ é™¤ç¼“å­˜ä¸­çš„æ•°æ®Aï¼Œè¿˜æ˜¯å…ˆåˆ é™¤ç¼“å­˜ä¸­çš„æ•°æ®Aï¼Œç„¶åæ›´æ–°æ•°æ®åº“ï¼Ÿ</p><p>å¦‚æœé€‰æ‹©åè€…ï¼ˆå³å…ˆåˆ é™¤ç¼“å­˜ï¼Œåæ›´æ–°æ•°æ®åº“ï¼‰ï¼Œä¼šæœ‰ä»¥ä¸‹é£é™©ï¼š</p><ol><li><strong>è¯·æ±‚1</strong>å…ˆåˆ é™¤äº†ç¼“å­˜ä¸­çš„æ•°æ®Aã€‚</li><li>ç„¶åï¼Œåœ¨<strong>è¯·æ±‚1</strong>æ›´æ–°æ•°æ®åº“ä¸­çš„æ•°æ®Aä¹‹å‰ï¼Œå¦ä¸€ä¸ªè¯·æ±‚ï¼ˆç§°ä¹‹ä¸ºè¯·æ±‚2ï¼‰æ¥è¯»å–æ•°æ®Aã€‚</li><li><strong>è¯·æ±‚2</strong>åœ¨ç¼“å­˜ä¸­æ‰¾ä¸åˆ°æ•°æ®Aï¼ˆå› ä¸ºå·²ç»è¢«åˆ é™¤ï¼‰ï¼Œæ‰€ä»¥å®ƒä»æ•°æ®åº“ä¸­è¯»å–äº†æ—§çš„æ•°æ®Aã€‚</li><li>æ­¤æ—¶ï¼Œ<strong>è¯·æ±‚1</strong>æ›´æ–°äº†æ•°æ®åº“ä¸­çš„æ•°æ®Aã€‚</li><li>ç»“æœæ˜¯ï¼Œç¼“å­˜ä¸­æ²¡æœ‰æ•°æ®Açš„è®°å½•ï¼ˆå·²è¢«åˆ é™¤ï¼‰ï¼Œè€Œæ•°æ®åº“ä¸­æœ‰æ–°çš„æ•°æ®Aã€‚<strong>è¯·æ±‚2</strong>æŒæœ‰çš„æ˜¯è¿‡æ—¶çš„æ•°æ®ã€‚</li></ol><p>è¿™ç§æƒ…å†µå°±å¯¼è‡´äº†æ•°æ®ä¸ä¸€è‡´ï¼šç¼“å­˜å¤±æ•ˆäº†ï¼Œä½†æ˜¯è¯·æ±‚2è¯»å–åˆ°äº†æ—§çš„æ•°æ®ã€‚ä¸‹æ¬¡æœ‰è¯·æ±‚æ¥è¯»å–æ•°æ®Aæ—¶ï¼Œå®ƒä¼šå†æ¬¡ä»æ•°æ®åº“ä¸­è¯»å–å¹¶ç¼“å­˜æ–°çš„æ•°æ®Aï¼Œä½†åœ¨è¿™ä¹‹å‰ï¼Œç³»ç»Ÿä¸­å­˜åœ¨æ•°æ®ä¸ä¸€è‡´çš„çŠ¶æ€ã€‚</p><p>é€šå¸¸ï¼Œæ›´å¥½çš„åšæ³•æ˜¯ï¼š</p><ol><li><strong>å…ˆæ›´æ–°æ•°æ®åº“</strong>ä¸­çš„æ•°æ®Aã€‚</li><li><strong>ç„¶ååˆ é™¤ç¼“å­˜</strong>ä¸­çš„æ•°æ®Aã€‚</li></ol><p>è¿™æ ·ï¼Œå³ä½¿åœ¨æ•°æ®åº“æ›´æ–°å’Œç¼“å­˜åˆ é™¤ä¹‹é—´æœ‰è¯»å–è¯·æ±‚ï¼Œå®ƒä¹Ÿåªä¼šè¯»åˆ°æ—§çš„æ•°æ®ï¼Œä¸€æ—¦ç¼“å­˜è¢«åˆ é™¤ï¼Œ<strong>ä¸‹ä¸€ä¸ªè¯»å–è¯·æ±‚å°†ä»æ•°æ®åº“ä¸­è·å–æœ€æ–°çš„æ•°æ®ï¼Œå¹¶æ›´æ–°ç¼“å­˜</strong>ï¼Œä»è€Œä¿æŒäº†ä¸€è‡´æ€§ã€‚</p><blockquote><p><strong>åœ¨å†™æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œå…ˆæ›´æ–° dbï¼Œååˆ é™¤ cache å°±æ²¡æœ‰é—®é¢˜äº†ä¹ˆï¼Ÿ</strong></p></blockquote><p>ç†è®ºä¸Šä»ç„¶æ˜¯ä¼šå‡ºç°çš„ï¼Œä½†æ¦‚ç‡éå¸¸å°ï¼Œç¼“å­˜çš„å†™å…¥é€Ÿåº¦æ¯”æ•°æ®åº“çš„å†™å…¥é€Ÿåº¦å¿«å¾ˆå¤šã€‚</p><p>ç‰¹å®šæƒ…å†µï¼š</p><ul><li>åœ¨æ•°æ®åº“æ›´æ–°ä¹‹åï¼Œä½†åœ¨ç¼“å­˜åˆ é™¤ä¹‹å‰ï¼Œå¦‚æœå¦ä¸€ä¸ªè¯·æ±‚ï¼ˆç§°ä¸ºè¯·æ±‚2ï¼‰æ¥è¯»å–åŒä¸€æ•°æ®ï¼Œå®ƒå°†ä»ç¼“å­˜ä¸­è·å–åˆ°æ—§çš„æ•°æ®ã€‚å› ä¸ºæ­¤æ—¶ç¼“å­˜å°šæœªè¢«æ›´æ–°æˆ–åˆ é™¤ã€‚</li><li>ä¸€æ—¦ç¼“å­˜è¢«åˆ é™¤ï¼Œéšåçš„è¯·æ±‚å°†ä»æ•°æ®åº“ä¸­è¯»å–æœ€æ–°çš„æ•°æ®ï¼Œå¹¶æ›´æ–°ç¼“å­˜ã€‚ä½†åœ¨è¿™ä¸ªçŸ­æš‚çš„æ—¶æœŸå†…ï¼Œæ—§çš„ç¼“å­˜æ•°æ®å’Œæ–°çš„æ•°æ®åº“æ•°æ®ä¹‹é—´å­˜åœ¨ä¸ä¸€è‡´ã€‚</li></ul><blockquote><p><strong>Cache Aside Pattern çš„ç¼ºé™·</strong>ä»¥åŠè§£å†³æ–¹æ¡ˆ</p></blockquote><p><strong>ç¼ºé™· 1ï¼šé¦–æ¬¡è¯·æ±‚æ•°æ®ä¸€å®šä¸åœ¨ cache çš„é—®é¢˜</strong></p><p>è§£å†³åŠæ³•ï¼šå¯ä»¥å°†çƒ­ç‚¹æ•°æ®å¯ä»¥æå‰æ”¾å…¥ cache ä¸­ã€‚</p><p><strong>ç¼ºé™· 2ï¼šå†™æ“ä½œæ¯”è¾ƒé¢‘ç¹çš„è¯å¯¼è‡´ cache ä¸­çš„æ•°æ®ä¼šè¢«é¢‘ç¹è¢«åˆ é™¤ï¼Œè¿™æ ·ä¼šå½±å“ç¼“å­˜å‘½ä¸­ç‡ ã€‚</strong></p><p>è§£å†³åŠæ³•ï¼š</p><ul><li>æ•°æ®åº“å’Œç¼“å­˜æ•°æ®å¼ºä¸€è‡´åœºæ™¯ï¼š<ul><li>æ›´æ–° db çš„æ—¶å€™åŒæ ·æ›´æ–° cacheï¼Œä¸è¿‡æˆ‘ä»¬éœ€è¦åŠ ä¸€ä¸ªé”&#x2F;åˆ†å¸ƒå¼é”æ¥ä¿è¯æ›´æ–° cache çš„æ—¶å€™ä¸å­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚</li></ul></li><li>å¯ä»¥çŸ­æš‚åœ°å…è®¸æ•°æ®åº“å’Œç¼“å­˜æ•°æ®ä¸ä¸€è‡´çš„åœºæ™¯ï¼š<ul><li>æ›´æ–° db çš„æ—¶å€™åŒæ ·æ›´æ–° cacheï¼Œä½†æ˜¯ç»™ç¼“å­˜åŠ ä¸€ä¸ªæ¯”è¾ƒçŸ­çš„è¿‡æœŸæ—¶é—´ï¼Œè¿™æ ·çš„è¯å°±å¯ä»¥ä¿è¯å³ä½¿æ•°æ®ä¸ä¸€è‡´çš„è¯å½±å“ä¹Ÿæ¯”è¾ƒå°</li></ul></li></ul><h4 id="Read-Write-Through-Patternï¼ˆè¯»å†™ç©¿é€ï¼‰"><a href="#Read-Write-Through-Patternï¼ˆè¯»å†™ç©¿é€ï¼‰" class="headerlink" title="Read&#x2F;Write Through Patternï¼ˆè¯»å†™ç©¿é€ï¼‰"></a>Read&#x2F;Write Through Patternï¼ˆè¯»å†™ç©¿é€ï¼‰</h4><p>Read&#x2F;Write Through Pattern ä¸­æœåŠ¡ç«¯æŠŠ cache è§†ä¸ºä¸»è¦æ•°æ®å­˜å‚¨ï¼Œä»ä¸­è¯»å–æ•°æ®å¹¶å°†æ•°æ®å†™å…¥å…¶ä¸­ã€‚</p><p>cache æœåŠ¡è´Ÿè´£å°†æ­¤æ•°æ®è¯»å–å’Œå†™å…¥ dbï¼Œä»è€Œå‡è½»äº†åº”ç”¨ç¨‹åºçš„èŒè´£ã€‚</p><p><strong>å†™ï¼ˆWrite Throughï¼‰ï¼š</strong></p><ul><li>å…ˆæŸ¥ cacheï¼Œcache ä¸­ä¸å­˜åœ¨ï¼Œç›´æ¥æ›´æ–° dbã€‚</li><li>cache ä¸­å­˜åœ¨ï¼Œåˆ™å…ˆæ›´æ–° cacheï¼Œç„¶å cache æœåŠ¡è‡ªå·±æ›´æ–° dbï¼ˆ<strong>åŒæ­¥æ›´æ–° cache å’Œ db</strong>ï¼‰ã€‚</li></ul><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231225212801.png" alt="image.png"></p><p><strong>è¯»(Read Through)ï¼š</strong></p><ul><li>ä» cache ä¸­è¯»å–æ•°æ®ï¼Œè¯»å–åˆ°å°±ç›´æ¥è¿”å› ã€‚</li><li>è¯»å–ä¸åˆ°çš„è¯ï¼Œå…ˆä» db åŠ è½½ï¼Œå†™å…¥åˆ° cache åè¿”å›å“åº”ã€‚</li></ul><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231225212846.png" alt="image.png"></p><p>å’Œ Cache Aside Pattern ä¸€æ ·ï¼Œ Read-Through Pattern ä¹Ÿæœ‰é¦–æ¬¡è¯·æ±‚æ•°æ®ä¸€å®šä¸å† cache çš„é—®é¢˜ï¼Œå¯¹äºçƒ­ç‚¹æ•°æ®å¯ä»¥æå‰æ”¾å…¥ç¼“å­˜ä¸­ã€‚</p><p>Read&#x2F;Write Through Patternï¼ˆè¯»å†™ç©¿é€ï¼‰è¿™ç§æ–¹å¼ä½¿ç”¨çš„ä¸å¤šï¼Œæˆ‘ä»¬å¸¸ç”¨çš„åˆ†å¸ƒå¼ç¼“å­˜Rediså¹¶æ²¡æœ‰æä¾› cache å°†æ•°æ®å†™å…¥ db çš„åŠŸèƒ½ã€‚</p><h4 id="Write-Behind-Patternï¼ˆå¼‚æ­¥ç¼“å­˜å†™å…¥ï¼‰"><a href="#Write-Behind-Patternï¼ˆå¼‚æ­¥ç¼“å­˜å†™å…¥ï¼‰" class="headerlink" title="Write Behind Patternï¼ˆå¼‚æ­¥ç¼“å­˜å†™å…¥ï¼‰"></a>Write Behind Patternï¼ˆå¼‚æ­¥ç¼“å­˜å†™å…¥ï¼‰</h4><p>Write Behind Pattern å’Œ Read&#x2F;Write Through Pattern å¾ˆç›¸ä¼¼ï¼Œä¸¤è€…éƒ½æ˜¯ç”± cache æœåŠ¡æ¥è´Ÿè´£ cache å’Œ db çš„è¯»å†™ã€‚</p><p>ä¸åŒç‚¹ï¼š</p><ul><li>**Read&#x2F;Write Through æ˜¯åŒæ­¥æ›´æ–° cache å’Œ dbï¼Œ</li><li>Write Behind åˆ™æ˜¯åªæ›´æ–°ç¼“å­˜ï¼Œä¸ç›´æ¥æ›´æ–° dbï¼Œè€Œæ˜¯æ”¹ä¸ºå¼‚æ­¥æ‰¹é‡çš„æ–¹å¼æ¥æ›´æ–° db</li></ul><p>æ•°æ®ä¸€è‡´æ€§é£é™©å¾ˆå¤§ï¼Œä¸è¿‡Write Behind Pattern ä¸‹ db çš„å†™æ€§èƒ½éå¸¸é«˜ï¼Œéå¸¸é€‚åˆä¸€äº›æ•°æ®ç»å¸¸å˜åŒ–åˆå¯¹æ•°æ®ä¸€è‡´æ€§è¦æ±‚æ²¡é‚£ä¹ˆé«˜çš„åœºæ™¯ï¼Œæ¯”å¦‚æµè§ˆé‡ã€ç‚¹èµé‡ã€‚</p><h3 id="6ã€Redis-èƒ½åšä»€ä¹ˆ"><a href="#6ã€Redis-èƒ½åšä»€ä¹ˆ" class="headerlink" title="6ã€Redis èƒ½åšä»€ä¹ˆ"></a>6ã€Redis èƒ½åšä»€ä¹ˆ</h3><ul><li>ç¼“å­˜</li><li><strong>åˆ†å¸ƒå¼é”</strong></li><li>é™æµ</li><li>æ¶ˆæ¯é˜Ÿåˆ—</li><li>å»¶æ—¶é˜Ÿåˆ—</li><li>åˆ†å¸ƒå¼ session</li><li>å¤æ‚ä¸šåŠ¡åœºæ™¯ â€¦..</li></ul><h3 id="7-ã€Redis-æŒä¹…åŒ–æœºåˆ¶"><a href="#7-ã€Redis-æŒä¹…åŒ–æœºåˆ¶" class="headerlink" title="7 ã€Redis æŒä¹…åŒ–æœºåˆ¶"></a>7 ã€Redis æŒä¹…åŒ–æœºåˆ¶</h3><p>to be continedâ€¦.</p><h3 id="8ã€Redis-çº¿ç¨‹æ¨¡å‹"><a href="#8ã€Redis-çº¿ç¨‹æ¨¡å‹" class="headerlink" title="8ã€Redis çº¿ç¨‹æ¨¡å‹"></a>8ã€Redis çº¿ç¨‹æ¨¡å‹</h3><h3 id="9ã€Redis-å†…å­˜ç®¡ç†"><a href="#9ã€Redis-å†…å­˜ç®¡ç†" class="headerlink" title="9ã€Redis å†…å­˜ç®¡ç†"></a>9ã€Redis å†…å­˜ç®¡ç†</h3><hr><p>å‚è€ƒ</p><ul><li><a href="https://javaguide.cn/database/redis/cache-basics.html">https://javaguide.cn/database/redis/cache-basics.html</a></li><li><a href="https://www.pdai.tech/md/interview/x-interview.html#_8-3-redis">https://www.pdai.tech/md/interview/x-interview.html#_8-3-redis</a></li><li><a href="https://www.cnblogs.com/powertoolsteam/p/redis.html">https://www.cnblogs.com/powertoolsteam/p/redis.html</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>ä¸­é—´ä»¶</category>
      
      <category>Redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>NoSQL</tag>
      
      <tag>redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaå¹¶å‘ç¼–ç¨‹_è¿›é˜¶å†…å®¹</title>
    <link href="/2023/12/08/Java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B_%E8%BF%9B%E9%98%B6%E5%86%85%E5%AE%B9/"/>
    <url>/2023/12/08/Java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B_%E8%BF%9B%E9%98%B6%E5%86%85%E5%AE%B9/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å¤§çº²</p></blockquote><ul><li>çº¿ç¨‹æ¨¡å‹</li><li>æ‚²è§‚é”</li><li>ä¹è§‚é”</li><li>ReentrantLock<ul><li>AQS</li><li>CAS</li></ul></li></ul><h3 id="1ã€ä»€ä¹ˆæ˜¯çº¿ç¨‹æ¨¡å‹ï¼Ÿ"><a href="#1ã€ä»€ä¹ˆæ˜¯çº¿ç¨‹æ¨¡å‹ï¼Ÿ" class="headerlink" title="1ã€ä»€ä¹ˆæ˜¯çº¿ç¨‹æ¨¡å‹ï¼Ÿ"></a>1ã€ä»€ä¹ˆæ˜¯çº¿ç¨‹æ¨¡å‹ï¼Ÿ</h3><blockquote><p>å…ˆå›é¡¾ä¸€ä¸‹çº¿ç¨‹å’Œè¿›ç¨‹çš„åŒºåˆ†</p></blockquote><ul><li>è¿›ç¨‹ï¼š<ul><li>ä¸€ä¸ªåœ¨å†…å­˜ä¸­è¿è¡Œçš„åº”ç”¨ç¨‹åºã€‚æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„ä¸€å—å†…å­˜ç©ºé—´ï¼Œä¸€ä¸ªè¿›ç¨‹å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œæ¯”å¦‚åœ¨Windowsç³»ç»Ÿä¸­ï¼Œä¸€ä¸ªè¿è¡Œçš„xx.exeå°±æ˜¯ä¸€ä¸ªè¿›ç¨‹ã€‚</li></ul></li><li>çº¿ç¨‹<ul><li>è¿›ç¨‹ä¸­çš„ä¸€ä¸ªæ‰§è¡Œä»»åŠ¡ï¼ˆæ§åˆ¶å•å…ƒï¼‰ï¼Œè´Ÿè´£å½“å‰è¿›ç¨‹ä¸­ç¨‹åºçš„æ‰§è¡Œã€‚ä¸€ä¸ªè¿›ç¨‹è‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªè¿›ç¨‹å¯ä»¥è¿è¡Œå¤šä¸ªçº¿ç¨‹ï¼Œå¤šä¸ªçº¿ç¨‹å¯å…±äº«æ•°æ®ã€‚</li><li>ä¸è¿›ç¨‹ä¸åŒçš„æ˜¯åŒç±»çš„å¤šä¸ªçº¿ç¨‹å…±äº«è¿›ç¨‹çš„<strong>å †</strong>å’Œ<strong>æ–¹æ³•åŒº</strong>èµ„æºï¼Œä½†æ¯ä¸ªçº¿ç¨‹æœ‰è‡ªå·±çš„<strong>ç¨‹åºè®¡æ•°å™¨</strong>ã€<strong>è™šæ‹Ÿæœºæ ˆ</strong>å’Œ<strong>æœ¬åœ°æ–¹æ³•æ ˆ</strong>ï¼Œæ‰€ä»¥ç³»ç»Ÿåœ¨äº§ç”Ÿä¸€ä¸ªçº¿ç¨‹ï¼Œæˆ–æ˜¯åœ¨å„ä¸ªçº¿ç¨‹ä¹‹é—´ä½œåˆ‡æ¢å·¥ä½œæ—¶ï¼Œè´Ÿæ‹…è¦æ¯”è¿›ç¨‹å°å¾—å¤šï¼Œä¹Ÿæ­£å› ä¸ºå¦‚æ­¤ï¼Œçº¿ç¨‹ä¹Ÿè¢«ç§°ä¸ºè½»é‡çº§è¿›ç¨‹ã€‚</li></ul></li></ul><p><strong>æ ¹æœ¬åŒºåˆ«</strong>ï¼šè¿›ç¨‹æ˜¯æ“ä½œç³»ç»Ÿèµ„æºåˆ†é…çš„åŸºæœ¬å•ä½ï¼Œè€Œçº¿ç¨‹æ˜¯å¤„ç†å™¨ä»»åŠ¡è°ƒåº¦å’Œæ‰§è¡Œçš„åŸºæœ¬å•ä½</p><blockquote><p>ä»€ä¹ˆæ˜¯çº¿ç¨‹æ¨¡å‹</p></blockquote><p>å¹¶å‘ç¼–ç¨‹åœ¨è®¡ç®—æœºä¸­å¦‚ä½•å®ç°çš„ï¼Œåœ¨ Java å¼€å‘é¢†åŸŸä¸­ï¼ŒJVMçº¿ç¨‹å¯¹ä¸åŒæ“ä½œç³»ç»Ÿä¸Šçš„åŸç”Ÿçº¿ç¨‹è¿›è¡Œäº†é«˜çº§æŠ½è±¡ï¼Œä½¿å¼€å‘è€…å¤§å¤šæ•°æƒ…å†µä¸‹å¯ä»¥ä¸ç”¨å…³æ³¨ä¸‹å±‚ç»†èŠ‚ï¼Œè€Œåªè¦ä¸“æ³¨ä¸Šå±‚å¼€å‘ã€‚</p><p>JVMçº¿ç¨‹ä¸æ“ä½œç³»ç»Ÿçº¿ç¨‹ä¹‹é—´å­˜åœ¨ç€æŸç§æ˜ å°„å…³ç³»ï¼Œè¿™ä¸¤ç§<strong>ä¸åŒç»´åº¦çš„çº¿ç¨‹ä¹‹é—´çš„è§„èŒƒå’Œåè®®</strong>ï¼Œå°±æ˜¯çº¿ç¨‹æ¨¡å‹ã€‚</p><blockquote><p>ç”¨æˆ·çº¿ç¨‹å’Œå†…æ ¸çº¿ç¨‹</p></blockquote><ul><li>ç”¨æˆ·çº¿ç¨‹ï¼šç”±ç”¨æˆ·ç©ºé—´ç¨‹åºç®¡ç†å’Œè°ƒåº¦çš„çº¿ç¨‹ï¼Œè¿è¡Œåœ¨ç”¨æˆ·ç©ºé—´ï¼ˆä¸“é—¨ç»™åº”ç”¨ç¨‹åºä½¿ç”¨ï¼‰ã€‚</li><li>å†…æ ¸çº¿ç¨‹ï¼šç”±æ“ä½œç³»ç»Ÿå†…æ ¸ç®¡ç†å’Œè°ƒåº¦çš„çº¿ç¨‹ï¼Œè¿è¡Œåœ¨å†…æ ¸ç©ºé—´ï¼ˆåªæœ‰å†…æ ¸ç¨‹åºå¯ä»¥è®¿é—®ï¼‰ã€‚</li></ul><blockquote><p>çº¿ç¨‹æ¨¡å‹ç±»å‹</p></blockquote><p>JVMçº¿ç¨‹æ¨¡å‹æœ‰ä¸‰ç§æ¨¡å‹ï¼šä¸€å¯¹ä¸€ã€å¤šå¯¹ä¸€ã€å¤šå¯¹å¤šã€‚</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311161619698.png" alt="image.png"></p><p><strong>ä¸€å¯¹ä¸€</strong></p><p>åœ¨Jvaçº¿ç¨‹ï¼ˆç”¨æˆ·çº¿ç¨‹ï¼‰ä¸æ“ä½œç³»ç»Ÿçº¿ç¨‹(KLT)ä¹‹é—´å»ºç«‹ä¸€å¯¹ä¸€çš„å…³ç³»ï¼Œç®€å•ç²—æš´ï¼Œä½†å¥½ç”¨ã€‚</p><ul><li>ä¼˜ç‚¹ï¼š<ul><li>æ¯ä¸ªçº¿ç¨‹éƒ½æ˜¯ç‹¬ç«‹çš„è°ƒåº¦å•å…ƒï¼Œç›´æ¥åˆ©ç”¨æ“ä½œç³»ç»Ÿå†…æ ¸æä¾›çš„è°ƒåº¦åŠŸèƒ½ã€‚</li></ul></li><li>ç¼ºç‚¹ï¼š<ul><li>ç”¨æˆ·çº¿ç¨‹çš„é˜»å¡å”¤é†’ï¼Œä¼šç›´æ¥æ˜ å°„åˆ°å†…æ ¸çº¿ç¨‹ä¸Šï¼Œå®¹æ˜“<strong>å¼•èµ·é¢‘ç¹åˆ‡æ¢ï¼Œé™ä½æ€§</strong>èƒ½ã€‚ä½†æ˜¯ä¸€äº›è¯­è¨€å¼•å…¥äº†CASæ¥é¿å…ä¸€éƒ¨åˆ†çš„å†…æ ¸è°ƒç”¨ï¼Œæ¯”å¦‚Java å¼•å…¥äº†AQSè¿™ç§å‡½æ•°çº§åˆ«çš„é”ï¼Œ<strong>å‡å°‘ä½¿ç”¨å†…æ ¸çº§åˆ«çš„é”</strong>ï¼Œå°±èƒ½æå‡æ€§èƒ½ã€‚</li></ul></li></ul><p>ç›®å‰å¤§éƒ¨åˆ†ä¸»æµ JVM ä¸Šéƒ½æ˜¯é‡‡ç”¨çš„è¿™ç§çº¿ç¨‹æ¨¡å‹ã€‚</p><p><strong>å¤šå¯¹ä¸€æ¨¡å‹</strong></p><ul><li>ä¼˜ç‚¹<ul><li>ç”¨æˆ·çº¿ç¨‹çš„å¾ˆå¤šæ“ä½œå¯¹å†…æ ¸æ¥è¯´éƒ½æ˜¯é€æ˜çš„ï¼Œä¸éœ€è¦ç”¨æˆ·æ€å’Œå†…æ ¸æ€çš„é¢‘ç¹åˆ‡æ¢ï¼Œä½¿çº¿ç¨‹çš„åˆ›å»ºã€è°ƒåº¦ã€åŒæ­¥ç­‰éå¸¸å¿«ï¼š</li></ul></li><li>ç¼ºç‚¹<ul><li>å¦‚æœå…¶ä¸­ä¸€ä¸ªç”¨æˆ·çº¿ç¨‹é˜»å¡ï¼Œå…¶ä»–ç”¨æˆ·çº¿ç¨‹ä¹Ÿæ— æ³•æ‰§è¡Œ</li><li>è¿™ç§æ¨¡å‹ä¸‹ï¼Œå†…æ ¸å¹¶ä¸çŸ¥é“ç”¨æˆ·æ€æœ‰å“ªäº›çº¿ç¨‹ï¼Œè°ƒåº¦å’Œä¼˜å…ˆçº§ç­‰ä¸å®Œæ•´ã€‚</li></ul></li></ul><p><strong>å¤šå¯¹å¤šæ¨¡å‹</strong></p><ul><li>ä¼˜ç‚¹ï¼šå…¼å…·å‰ä¸¤è€…çš„ä¼˜ç‚¹</li><li>ç¼ºç‚¹ï¼šå®ç°å¤æ‚</li></ul><p>ç›®å‰ä¸»æµè¯­è¨€ä¸­ï¼ŒJava ä½¿ç”¨çš„æ˜¯ ä¸€å¯¹ä¸€çº¿ç¨‹æ¨¡å‹ï¼›Go è¯­è¨€ä½¿ç”¨çš„æ˜¯ å¤šå¯¹å¤šçº¿ç¨‹æ¨¡å‹ï¼›Python çš„ gevent ä½¿ç”¨çš„å¤šå¯¹ä¸€çº¿ç¨‹æ¨¡å‹ã€‚</p><h3 id="2ã€æ‚²è§‚é”æœºåˆ¶"><a href="#2ã€æ‚²è§‚é”æœºåˆ¶" class="headerlink" title="2ã€æ‚²è§‚é”æœºåˆ¶"></a>2ã€æ‚²è§‚é”æœºåˆ¶</h3><p>åœ¨äº†è§£æ‚²è§‚é”æœºåˆ¶å‰ï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯é”ã€‚</p><h4 id="ä»€ä¹ˆæ˜¯é”"><a href="#ä»€ä¹ˆæ˜¯é”" class="headerlink" title="ä»€ä¹ˆæ˜¯é”"></a>ä»€ä¹ˆæ˜¯é”</h4><p>åœ¨å¹¶å‘ç¯å¢ƒä¸‹ï¼Œä¼šå‡ºç°å¤šä¸ªçº¿ç¨‹å¯¹åŒä¸€ä¸ªèµ„æºè¿›è¡Œäº‰æŠ¢çš„æƒ…å†µï¼Œå‡è®¾Açº¿ç¨‹å¯¹èµ„æºæ­£åœ¨è¿›è¡Œä¿®æ”¹ï¼Œæ­¤æ—¶<br>Bçº¿ç¨‹æ­¤æ—¶åˆå¯¹èµ„æºè¿›è¡Œäº†ä¿®æ”¹ï¼Œè¿™å°±å¯èƒ½ä¼šå¯¼è‡´æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¼•å…¥äº†é”æœºåˆ¶ï¼Œ<strong>é€šè¿‡ä¸€ç§æŠ½è±¡çš„â€œé”â€æ¥å¯¹èµ„æºè¿›è¡Œé”å®š</strong>ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹æŒæœ‰â€œé”â€çš„æ—¶å€™ï¼Œå…¶ä»–çº¿ç¨‹å¿…é¡»ç­‰å¾…â€œé”â€ï¼Œæœ¬è´¨ä¸Šæ˜¯åœ¨ä¸´ç•Œèµ„æºä¸Šå¯¹çº¿ç¨‹è¿›è¡Œä¸€ç§ä¸²è¡ŒåŒ–ã€‚</p><h4 id="Javaè¯­è¨€çš„é”æœºåˆ¶"><a href="#Javaè¯­è¨€çš„é”æœºåˆ¶" class="headerlink" title="Javaè¯­è¨€çš„é”æœºåˆ¶"></a>Javaè¯­è¨€çš„é”æœºåˆ¶</h4><blockquote><p>Java è™šæ‹Ÿæœºçš„å†…å­˜ç»“æ„</p></blockquote><p>åœ¨äº†è§£ Javaè¯­è¨€é”æœºåˆ¶ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆå¯¹ç®€å•äº†è§£ä¸€ä¸‹ Java è™šæ‹Ÿæœºçš„å†…å­˜ç»“æ„ã€‚</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231116222015.png" alt="image.png"></p><p>JVM è¿è¡Œæ—¶å†…å­˜ç»“æ„ä¸»è¦åŒ…å«äº†äº”ä¸ªéƒ¨åˆ†ï¼š</p><ul><li>ç¨‹åºè®¡æ•°å™¨(PCå¯„å­˜å™¨)ã€</li><li>JVMæ ˆã€</li><li>Nativeæ–¹æ³•æ ˆã€</li><li>å †ã€</li><li>æ–¹æ³•åŒºã€‚</li></ul><p>ä¸Šå›¾ä¸­ï¼Œçº¢è‰²åŒºåŸŸæ˜¯å„ä¸ªçº¿ç¨‹ç§æœ‰çš„ã€‚è¿™ä¸ªåŒºåŸŸä¸­çš„æ•°æ®ï¼Œä¸ä¼šå‡ºç°çº¿ç¨‹ç«äº‰çš„å…³ç³»ã€‚</p><p>è€Œè“è‰²åŒºåŸŸä¸­çš„æ•°æ®è¢«æ‰€æœ‰çº¿ç¨‹å…±äº«ï¼Œå…¶ä¸­Jvaå †ä¸­å­˜æ”¾çš„æ˜¯å¤§é‡å¯¹è±¡ï¼Œæ–¹æ³•åŒºä¸­<strong>å­˜æ”¾ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜<br>é‡</strong>ç­‰æ•°æ®ã€‚</p><p>å½“å¤šä¸ªçº¿ç¨‹åœ¨ç«äº‰å…¶ä¸­çš„ä¸€äº›æ•°æ®æ—¶ï¼Œå¯èƒ½ä¼šå‘ç”Ÿéš¾ä»¥é¢„æ–™çš„å¼‚å¸¸æƒ…å†µã€‚åœ¨ç¨‹åºå¼€å‘ä¸­ï¼Œé”çš„ä¸»è¦åº”ç”¨èŒƒå›´å°±æ˜¯åœ¨æ•°æ®å…±äº«åŒºåŸŸã€‚</p><p>åœ¨ä»£ç å±‚é¢ï¼ŒJvva ä¸»è¦é‡‡ç”¨äº†ä¸¤ç§å®ç°æ–¹å¼ï¼š</p><ul><li>1.åŸºäºObjectçš„æ‚²è§‚é”ã€‚</li><li>2.åŸºäºCASçš„ä¹è§‚é”ã€‚</li></ul><p>æœ¬ç« ä¸»è¦è®²è§£åŸºäºObjectçš„æ‚²è§‚é”ã€‚</p><blockquote><p>æ‚²è§‚é”æœºåˆ¶</p></blockquote><p>æ‚²è§‚é”æ€»æ˜¯å‡è®¾æœ€åçš„æƒ…å†µï¼Œè®¤ä¸ºå…±äº«èµ„æº<strong>æ¯æ¬¡è¢«è®¿é—®çš„æ—¶å€™å°±ä¼šå‡ºç°é—®é¢˜</strong>(æ¯”å¦‚å…±äº«æ•°æ®è¢«ä¿®æ”¹)ï¼Œæ‰€ä»¥æ¯æ¬¡åœ¨è·å–èµ„æºæ“ä½œçš„æ—¶å€™éƒ½ä¼šä¸Šé”ï¼Œè¿™æ ·å…¶ä»–çº¿ç¨‹æƒ³æ‹¿åˆ°è¿™ä¸ªèµ„æºå°±ä¼šé˜»å¡ç›´åˆ°é”è¢«ä¸Šä¸€ä¸ªæŒæœ‰è€…é‡Šæ”¾ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>å…±äº«èµ„æºæ¯æ¬¡åªç»™ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨ï¼Œå…¶å®ƒçº¿ç¨‹é˜»å¡ï¼Œç”¨å®Œåå†æŠŠèµ„æºè½¬è®©ç»™å…¶å®ƒçº¿ç¨‹</strong>ã€‚</p><blockquote><p>åŸºäºObjectçš„æ‚²è§‚é”</p></blockquote><p>åœ¨Javaä¸­ï¼Œæ¯ä¸ªObject,ä¹Ÿå°±æ˜¯æ¯ä¸ªå¯¹è±¡éƒ½æ‹¥æœ‰ä¸€æŠŠé”ï¼Œè¿™æŠŠé”å­˜æ”¾åœ¨å¯¹è±¡å¤´ä¸­ï¼Œè®°å½•äº†å½“å‰å¯¹è±¡è¢«å“ªä¸ªçº¿ç¨‹å ç”¨ã€‚</p><blockquote><p>å¯¹è±¡å’Œå¯¹è±¡å¤´çš„ç»“æ„</p></blockquote><p><strong>Java å¯¹è±¡</strong></p><p>Javaå¯¹è±¡åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š</p><ul><li>å¯¹è±¡å¤´</li><li>å®ä¾‹æ•°æ®</li><li>å¯¹é½å¡«å……å­—èŠ‚</li></ul><p>å…¶ä¸­å¯¹é½å¡«å……å­—èŠ‚æ˜¯ä¸ºäº†æ»¡è¶³â€œJavaå¯¹è±¡å¤§å°æ˜¯8å­—èŠ‚çš„å€æ•°â€è¿™ä¸€æ¡ä»¶è€Œè®¾è®¡çš„ï¼Œä¸ºå¯¹è±¡å¯¹é½å¡«å……äº†ä¸€äº›æ— ç”¨å­—èŠ‚ã€‚</p><p>å®ä¾‹æ•°æ®æ˜¯åœ¨åˆå§‹åŒ–å¯¹è±¡æ—¶è®¾å®šçš„å±æ€§å’ŒçŠ¶æ€ç­‰å†…å®¹ã€‚</p><p><strong>å¯¹è±¡å¤´</strong></p><p>å¯¹è±¡å¤´å­˜æ”¾äº†ä¸€äº›å¯¹è±¡æœ¬èº«çš„è¿è¡Œæ—¶ä¿¡æ¯ã€‚å¯¹è±¡å¤´åŒ…å«äº†ä¸¤éƒ¨åˆ†ï¼š</p><ul><li>Mark Word</li><li>Class Pointer</li></ul><p>ç›¸è¾ƒäºå®ä¾‹æ•°æ®ï¼Œå¯¹è±¡å¤´å±äºä¸€äº›é¢å¤–çš„å­˜å‚¨å¼€é”€ï¼Œå®ƒè¢«è®¾è®¡å¾—æå°ï¼ˆä¸€èˆ¬ä¸º232btæˆ–264bt) æ¥æå‡æ•ˆç‡ã€‚</p><p>Class Pointeræ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘å½“å‰å¯¹è±¡ç±»å‹æ‰€åœ¨æ–¹æ³•åŒºä¸­çš„Classä¿¡æ¯ï¼›</p><p>Mark Word å­˜å‚¨äº†<strong>å¾ˆå¤šå½“å‰å¯¹è±¡çš„è¿è¡Œæ—¶çŠ¶æ€ä¿¡æ¯</strong>ï¼Œæ¯”å¦‚ HashCode.ã€é”çŠ¶æ€æ ‡å¿—ã€æŒ‡å‘é”è®°å½•çš„æŒ‡é’ˆã€åå‘çº¿ç¨‹ IDã€é”æ ‡å¿—ä½ç­‰ç­‰ã€‚</p><p>å¯ä»¥é€šè¿‡ä¸‹é¢è¿™å¼ è¡¨å¯¹ Mark Wordæœ‰ä¸€ä¸ªæ›´ç›´è§‚çš„è®¤è¯†ï¼š</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231116223405.png" alt="image.png"></p><p>â€œé”â€çš„ä¿¡æ¯å­˜å‚¨åœ¨å¯¹è±¡å¤´çš„Mark Wordä¸­ã€‚Mark Word çš„æœ€åä¸¤ä½ï¼Œä»£è¡¨é”æ ‡å¿—ä½ï¼Œåˆ†åˆ«å¯¹åº”â€œæ— é”â€ã€â€œåå‘é”â€ã€â€œè½»é‡çº§é”â€ã€â€œé‡é‡çº§é”â€å››ç§çŠ¶æ€ã€‚</p><p>åœ¨Javaä¸­ï¼Œå¯ç”¨å¯¹è±¡é”çš„æ–¹å¼æ˜¯ä½¿ç”¨<code>synchronized</code>å…³é”®å­—ã€‚</p><h4 id="å¯¹è±¡é”çš„å››ç§çŠ¶æ€"><a href="#å¯¹è±¡é”çš„å››ç§çŠ¶æ€" class="headerlink" title="å¯¹è±¡é”çš„å››ç§çŠ¶æ€"></a>å¯¹è±¡é”çš„å››ç§çŠ¶æ€</h4><p>é”ä¸»è¦å­˜åœ¨å››ç§çŠ¶æ€ï¼Œä¾æ¬¡æ˜¯ï¼šæ— é”çŠ¶æ€ã€åå‘é”çŠ¶æ€ã€è½»é‡çº§é”çŠ¶æ€ã€é‡é‡çº§é”çŠ¶æ€ï¼Œä»–ä»¬ä¼šéšç€ç«äº‰çš„æ¿€çƒˆè€Œé€æ¸å‡çº§ã€‚</p><p>é”å¯ä»¥å‡çº§ä¸å¯é™çº§ï¼Œè¿™ç§ç­–ç•¥æ˜¯ä¸ºäº†æé«˜è·å¾—é”å’Œé‡Šæ”¾é”çš„æ•ˆç‡</p><h3 id="3ã€ä¹è§‚é”æœºåˆ¶"><a href="#3ã€ä¹è§‚é”æœºåˆ¶" class="headerlink" title="3ã€ä¹è§‚é”æœºåˆ¶"></a>3ã€ä¹è§‚é”æœºåˆ¶</h3><p>åœ¨å¤šä¸ªçº¿ç¨‹å¯¹äºåŒä¸€ä¸ªèµ„æºè¿›è¡Œè®¿é—®çš„è®¿é—®ï¼Œäº’æ–¥é”çš„æ–¹å¼æ˜¯æ‚²è§‚çš„ï¼Œåœ¨çº¿ç¨‹è®¿é—®çš„æ—¶å€™ï¼Œäº’æ–¥é”ä¼šé”å®šèµ„æºï¼Œ<strong>åªä¾›ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ï¼Œè€Œé˜»å¡å…¶ä»–çº¿ç¨‹</strong>ï¼Œè®©å…¶ä»–çº¿ç¨‹ç­‰å¾…ã€‚</p><p>åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼ŒåŒæ­¥ä»£ç å—æ‰§è¡Œçš„è€—æ—¶è¿œè¿œå°äºçº¿ç¨‹åˆ‡æ¢çš„è€—æ—¶ï¼Œè¿™ç§æƒ…å†µä¸‹ä½¿ç”¨äº’æ–¥é”å¯¹æ€§èƒ½æ˜¯ä¸å¤ªåˆ’ç®—çš„ã€‚åœ¨è¿™ç§åœºæ™¯ä¸‹ï¼Œç›´æ¥åœ¨ç”¨æˆ·æ€å¯¹çº¿ç¨‹çš„åˆ‡æ¢è¿›è¡Œç®¡ç†ï¼Œæ•ˆç‡æ›´é«˜ã€‚å®é™…æ“ä½œçš„æ—¶å€™æ˜¯é€šè¿‡æ¯æ¬¡ä½¿ç”¨åŒæ­¥åŸè¯­å¯¹å…±äº«èµ„æºè¿›è¡Œé”å®šï¼Œè®©çº¿ç¨‹åå¤â€œä¹è§‚â€åœ°å»å°è¯•è·å–å…±äº«èµ„æºï¼Œå¦‚æœå‘ç°ç©ºé—²ï¼Œé‚£ä¹ˆä½¿ç”¨ï¼Œå¦‚æœè¢«å ç”¨ï¼Œé‚£ä¹ˆç»§ç»­â€œä¹è§‚â€åœ°é‡è¯•ã€‚</p><blockquote><p>ä¹è§‚é”å’Œæ‚²è§‚é”<br><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231207231904.png" alt="image.png"></p></blockquote><blockquote><p>CAS</p></blockquote><p>åœ¨ Java ä¸­ï¼Œå®ç°è¿™ç§åŒæ­¥åŸè¯­çš„ç®—æ³•æ˜¯ CAS (Compare And Swap)ã€‚</p><p>ç®€å•ç¿»è¯‘æ˜¯ï¼šæ¯”è¾ƒç„¶åäº¤æ¢</p><p>CASæ“ä½œåŒ…å«ä¸‰ä¸ªæ“ä½œæ•°ï¼šå†…å­˜ä½ç½®ï¼ˆè¦æ›´æ–°çš„å˜é‡ï¼‰ã€é¢„æœŸåŸå€¼å’Œæ–°å€¼ã€‚</p><p><strong>å·¥ä½œåŸç†</strong></p><ol><li><strong>æ£€æŸ¥å’Œæ›´æ–°</strong>ï¼š<ul><li>CASé¦–å…ˆæ£€æŸ¥<strong>ç›®æ ‡å†…å­˜ä½ç½®çš„å½“å‰å€¼</strong>æ˜¯å¦ä¸é¢„æœŸåŸå€¼ç›¸åŒã€‚å¦‚æœç›¸åŒï¼Œå®ƒä¼šå°†è¯¥å†…å­˜ä½ç½®çš„å€¼æ›´æ–°ä¸ºæ–°å€¼ã€‚</li><li>å¦‚æœç›®æ ‡å€¼å·²è¢«å…¶ä»–çº¿ç¨‹æ”¹å˜ï¼ˆä¸ç­‰äºé¢„æœŸåŸå€¼ï¼‰ï¼ŒCASæ“ä½œå¤±è´¥ã€‚</li></ul></li><li><strong>æ— é”æ“ä½œ</strong>ï¼š<ul><li>CASæä¾›äº†ä¸€ç§æ— éœ€é”å®šçš„æ–¹å¼æ¥å®ç°å¹¶å‘æ§åˆ¶ï¼Œå‡å°‘äº†é”çš„å¼€é”€å’Œå¤æ‚æ€§ã€‚</li></ul></li></ol><div style="border: 1px solid #999; border-radius: 5px; padding: 10px;">    CASæ“ä½œæ˜¯åŸå­æ€§çš„ã€‚</div><h3 id="4ã€æ‚²è§‚é”å’Œä¹è§‚é”"><a href="#4ã€æ‚²è§‚é”å’Œä¹è§‚é”" class="headerlink" title="4ã€æ‚²è§‚é”å’Œä¹è§‚é”"></a>4ã€æ‚²è§‚é”å’Œä¹è§‚é”</h3><h4 id="æ‚²è§‚é”ç¤ºä¾‹"><a href="#æ‚²è§‚é”ç¤ºä¾‹" class="headerlink" title="æ‚²è§‚é”ç¤ºä¾‹"></a>æ‚²è§‚é”ç¤ºä¾‹</h4><p>åœ¨Javaä¸­ï¼Œæ‚²è§‚é”é€šå¸¸æ˜¯é€šè¿‡<code>synchronized</code>å…³é”®å­—æˆ–<code>ReentrantLock</code>ç±»å®ç°çš„ã€‚</p><p><code>synchronized</code> ä½¿ç”¨ç¤ºä¾‹ï¼š</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> PessimisticLockExample &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-keyword">count</span> = <span class="hljs-number">0</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> increment() &#123;<br>        <span class="hljs-keyword">count</span>++;  <span class="hljs-comment">// ä»…å½“æŒæœ‰å¯¹è±¡é”æ—¶ï¼Œæ‰èƒ½æ‰§è¡Œæ­¤æ“ä½œ</span><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">int</span> getCount() &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">count</span>;  <span class="hljs-comment">// åŒæ ·ï¼Œéœ€è¦æŒæœ‰å¯¹è±¡é”æ‰èƒ½æ‰§è¡Œ</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ç”¨<code>synchronized</code>å…³é”®å­—é”å®šäº†æ•´ä¸ªæ–¹æ³•ã€‚</p><p>å½“ä¸€ä¸ªçº¿ç¨‹è¿›å…¥<code>increment</code>æˆ–<code>getCount</code>æ–¹æ³•æ—¶ï¼Œå®ƒå¿…é¡»å…ˆè·å¾—è¿™ä¸ªå¯¹è±¡çš„é”ã€‚åœ¨è¿™æ®µæ—¶é—´å†…ï¼Œå…¶ä»–ä»»ä½•è¯•å›¾è¿›å…¥è¿™äº›åŒæ­¥æ–¹æ³•çš„çº¿ç¨‹éƒ½ä¼šè¢«é˜»å¡ã€‚</p><h4 id="ä¹è§‚é”ç¤ºä¾‹"><a href="#ä¹è§‚é”ç¤ºä¾‹" class="headerlink" title="ä¹è§‚é”ç¤ºä¾‹"></a>ä¹è§‚é”ç¤ºä¾‹</h4><p>ä¹è§‚é”é€šå¸¸æ˜¯é€šè¿‡CASï¼ˆæ¯”è¾ƒå¹¶äº¤æ¢ï¼‰æ“ä½œå®ç°çš„ã€‚</p><p>åœ¨Javaä¸­ï¼Œ<code>AtomicInteger</code>ç±»æä¾›äº†ä¸€ç§ä½¿ç”¨ä¹è§‚é”çš„æ–¹å¼ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨<code>AtomicInteger</code>å®ç°ä¹è§‚é”çš„ç¤ºä¾‹ï¼š</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs haxe"><span class="hljs-keyword">import</span> java.util.concurrent.atomic.AtomicInteger;<br><br><span class="hljs-keyword">public</span> <span class="hljs-title class_"><span class="hljs-keyword">class</span> <span class="hljs-title">OptimisticLockExample</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> AtomicInteger count = <span class="hljs-keyword">new</span> <span class="hljs-type">AtomicInteger</span>(<span class="hljs-number">0</span>);<br><br>    <span class="hljs-keyword">public</span> void increment() &#123;<br>        int currentValue;<br>        int <span class="hljs-keyword">new</span><span class="hljs-type">Value</span>;<br>        <span class="hljs-keyword">do</span> &#123;<br>            currentValue = count.<span class="hljs-keyword">get</span>(); <span class="hljs-comment">// è·å–å½“å‰å€¼</span><br>            <span class="hljs-keyword">new</span><span class="hljs-type">Value</span> = currentValue + <span class="hljs-number">1</span>; <span class="hljs-comment">// è®¡ç®—æ–°å€¼</span><br>        &#125; <span class="hljs-keyword">while</span> (!count.compareAndSet(currentValue, <span class="hljs-keyword">new</span><span class="hljs-type">Value</span>)); <span class="hljs-comment">// CASæ“ä½œ</span><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> int getCount() &#123;<br>        <span class="hljs-keyword">return</span> count.<span class="hljs-keyword">get</span>();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>AtomicInteger</code>çš„<code>compareAndSet</code>æ–¹æ³•å®ç°äº†CASæ“ä½œã€‚</p><p>å®ƒä¼šæ¯”è¾ƒ<code>count</code>çš„å½“å‰å€¼å’Œ<code>currentValue</code>ã€‚å¦‚æœç›¸åŒï¼Œå®ƒä¼šæ›´æ–°<code>count</code>ä¸º<code>newValue</code>ã€‚è¿™ä¸ªè¿‡ç¨‹æ˜¯æ— é”çš„ï¼Œå³ä½¿åœ¨å¹¶å‘ç¯å¢ƒä¸‹ä¹Ÿä¸ä¼šé˜»å¡å…¶ä»–çº¿ç¨‹ã€‚å¦‚æœ<code>count</code>çš„å€¼åœ¨æ­¤æœŸé—´è¢«å…¶ä»–çº¿ç¨‹ä¿®æ”¹ï¼Œ<code>compareAndSet</code>ä¼šè¿”å›<code>false</code>ï¼Œå¾ªç¯ç»§ç»­ï¼Œç›´åˆ°æ›´æ–°æˆåŠŸã€‚</p><blockquote><p>å¯¹æ¯”</p></blockquote><ul><li><strong>æ‚²è§‚é”</strong>ï¼ˆ<code>synchronized</code>ï¼Œ<code>ReentrantLock</code>ï¼‰é€‚ç”¨äºå†™æ“ä½œå¤šçš„åœºæ™¯ï¼Œå› ä¸ºå®ƒé˜²æ­¢äº†å¤šä¸ªçº¿ç¨‹åŒæ—¶å†™å…¥ï¼Œå‡å°‘äº†å†²çªã€‚</li><li><strong>ä¹è§‚é”</strong>ï¼ˆå¦‚<code>AtomicInteger</code>çš„CASæ“ä½œï¼‰é€‚ç”¨äºè¯»æ“ä½œå¤šçš„åœºæ™¯ï¼Œå®ƒä¸ä¼šé˜»å¡çº¿ç¨‹ï¼Œä½†åœ¨å†™æ“ä½œé¢‘ç¹çš„æƒ…å†µä¸‹å¯èƒ½ä¼šå¯¼è‡´é«˜é‡è¯•æˆæœ¬ã€‚</li></ul><h3 id="5ã€ReentrantLock"><a href="#5ã€ReentrantLock" class="headerlink" title="5ã€ReentrantLock"></a>5ã€ReentrantLock</h3><h4 id="ReentrantLock-çš„åŸºç¡€ä½¿ç”¨"><a href="#ReentrantLock-çš„åŸºç¡€ä½¿ç”¨" class="headerlink" title="ReentrantLock çš„åŸºç¡€ä½¿ç”¨"></a>ReentrantLock çš„åŸºç¡€ä½¿ç”¨</h4><p>åœ¨å¹¶å‘ç¼–ç¨‹ä¸­ï¼Œæ‚²è§‚é”æ˜¯ä¸€ç§ç­–ç•¥ï¼Œå®ƒå‡è®¾æœ€åçš„æƒ…å†µï¼šå³åœ¨å¤šä¸ªçº¿ç¨‹å°è¯•åŒæ—¶è®¿é—®å…±äº«èµ„æºæ—¶ï¼Œä¼šå‘ç”Ÿå†²çªã€‚å› æ­¤ï¼Œæ‚²è§‚é”åœ¨è®¿é—®ä»»ä½•å…±äº«èµ„æºä¹‹å‰ä¼šå…ˆé”å®šå®ƒï¼Œä»¥é˜²æ­¢å…¶ä»–çº¿ç¨‹çš„è®¿é—®ï¼Œç›´åˆ°å®ƒå®Œæˆæ“ä½œå¹¶é‡Šæ”¾é”ã€‚</p><blockquote><p>ReentrantLockï¼ˆå¯é‡å…¥é”ï¼‰</p></blockquote><p><code>ReentrantLock</code> æ˜¯ä¸€ä¸ªå¯é‡å…¥çš„äº’æ–¥é”ï¼Œå®ƒæä¾›äº†æ¯” <code>synchronized</code> å…³é”®å­—æ›´é«˜çº§çš„åŠŸèƒ½ï¼Œå¦‚å¯ä¸­æ–­çš„é”è·å–æ“ä½œã€å…¬å¹³é”ç­–ç•¥ã€é”ç»‘å®šå¤šä¸ªæ¡ä»¶ç­‰ã€‚</p><blockquote><p>åŸºäº AQS çš„å®ç°</p></blockquote><ul><li>AQS æä¾›äº†ä¸€ç§ç®¡ç†é”çŠ¶æ€çš„æ¡†æ¶ï¼Œå¹¶å¤„ç†äº†çº¿ç¨‹çš„æ’é˜Ÿå’Œé˜»å¡ã€‚åœ¨ <code>ReentrantLock</code> çš„å®ç°ä¸­ï¼ŒAQS è´Ÿè´£ç»´æŠ¤ä¸€ä¸ªè¡¨ç¤ºé”çŠ¶æ€çš„å˜é‡å’Œä¸€ä¸ªç”±ç­‰å¾…é”çš„çº¿ç¨‹ç»„æˆçš„é˜Ÿåˆ—ã€‚</li><li>å½“ä¸€ä¸ªçº¿ç¨‹å°è¯•è·å– <code>ReentrantLock</code> æ—¶ï¼ŒAQS ä¼šæ£€æŸ¥é”çš„çŠ¶æ€ï¼Œç„¶åè¦ä¹ˆæˆäºˆé”ï¼ˆå¦‚æœå½“å‰æœªè¢«å…¶ä»–çº¿ç¨‹æŒæœ‰ï¼‰ï¼Œè¦ä¹ˆå°†å°è¯•è·å–é”çš„çº¿ç¨‹æ”¾å…¥ç­‰å¾…é˜Ÿåˆ—ã€‚</li></ul><blockquote><p>æ‚²è§‚é”çš„ç‰¹æ€§</p></blockquote><ul><li><code>ReentrantLock</code> ä½œä¸ºä¸€ç§æ‚²è§‚é”ï¼Œæ˜¯åŸºäºè¿™æ ·çš„å‡è®¾ï¼šå¦‚æœä¸é‡‡å–æªæ–½ï¼Œå¤šä¸ªçº¿ç¨‹åŒæ—¶ä¿®æ”¹åŒä¸€ä¸ªèµ„æºä¼šå¯¼è‡´é—®é¢˜ã€‚å› æ­¤ï¼Œå®ƒåœ¨ä¿®æ”¹èµ„æºä¹‹å‰å…ˆåŠ é”ï¼Œé˜²æ­¢å…¶ä»–çº¿ç¨‹åŒæ—¶è¿›è¡Œå†™æ“ä½œã€‚</li><li>è¿™ä¸ä¹è§‚é”çš„ç­–ç•¥ä¸åŒï¼Œä¹è§‚é”å…è®¸å¤šä¸ªçº¿ç¨‹è¿›å…¥ä¸´ç•ŒåŒºï¼Œä½†åœ¨å®é™…ä¿®æ”¹æ•°æ®æ—¶æ£€æŸ¥æ˜¯å¦å­˜åœ¨å†²çªã€‚</li></ul><p>ç¤ºä¾‹</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs csharp">import java.util.concurrent.locks.ReentrantLock;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">ReentrantLockExample</span> &#123;<br>    <span class="hljs-keyword">private</span> final ReentrantLock <span class="hljs-keyword">lock</span> = <span class="hljs-keyword">new</span> ReentrantLock();<br>    <span class="hljs-keyword">private</span> <span class="hljs-built_in">int</span> count = <span class="hljs-number">0</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">increment</span>()</span> &#123;<br>        <span class="hljs-keyword">lock</span>.<span class="hljs-keyword">lock</span>();  <span class="hljs-comment">// è·å–é”</span><br>        <span class="hljs-keyword">try</span> &#123;<br>            count++;<br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            <span class="hljs-keyword">lock</span>.unlock();  <span class="hljs-comment">// é‡Šæ”¾é”</span><br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> <span class="hljs-title">getCount</span>()</span> &#123;<br>        <span class="hljs-keyword">return</span> count;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åœ¨ä¿®æ”¹ <code>count</code> å˜é‡ä¹‹å‰è·å–äº†é”ï¼Œå¹¶åœ¨æ“ä½œå®Œæˆåé‡Šæ”¾äº†é”ã€‚</p><p>è¿™ç¡®ä¿äº†å³ä½¿å¤šä¸ªçº¿ç¨‹å°è¯•åŒæ—¶è°ƒç”¨ <code>increment</code> æ–¹æ³•ï¼Œ<code>count</code> çš„å¢åŠ ä¹Ÿæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p><h4 id="ReentrantLock-çš„å®ç°åŸç†"><a href="#ReentrantLock-çš„å®ç°åŸç†" class="headerlink" title="ReentrantLock çš„å®ç°åŸç†"></a>ReentrantLock çš„å®ç°åŸç†</h4><p><code>ReentrantLock</code> æ˜¯ Java å¹¶å‘åŒ…ä¸­çš„ä¸€ä¸ªé‡è¦ç»„ä»¶ï¼ŒåŸºäº AQS å®ç°ã€‚</p><p>åŸºæœ¬åŸç†</p><ol><li><strong>å¯é‡å…¥æ€§</strong>ï¼š<ul><li><code>ReentrantLock</code> æ˜¯ä¸€ä¸ªå¯é‡å…¥é”ã€‚è¿™æ„å‘³ç€åŒä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¤šæ¬¡è·å–åŒä¸€ä¸ªé”è€Œä¸ä¼šå‘ç”Ÿæ­»é”ã€‚è¿™æ˜¯é€šè¿‡ä¸ºæ¯ä¸ªé”ç»´æŠ¤ä¸€ä¸ªæŒæœ‰è®¡æ•°å’Œä¸€ä¸ªæŒ‡å‘å½“å‰æŒæœ‰é”çš„çº¿ç¨‹çš„å¼•ç”¨æ¥å®ç°çš„ã€‚</li></ul></li><li><strong>åŸºäº AQS</strong>ï¼š<ul><li><code>ReentrantLock</code> çš„å®ç°ä¾èµ–äº AQSã€‚AQS ä½¿ç”¨ä¸€ä¸ªæ•´å‹çš„ volatile å˜é‡æ¥è¡¨ç¤ºåŒæ­¥çŠ¶æ€ï¼Œå¹¶ä½¿ç”¨ä¸€ä¸ª FIFO é˜Ÿåˆ—æ¥ç®¡ç†é‚£äº›ç­‰å¾…è·å–é”çš„çº¿ç¨‹ã€‚</li></ul></li><li><strong>é”çš„çŠ¶æ€</strong>ï¼š<ul><li>åœ¨ <code>ReentrantLock</code> ä¸­ï¼Œé”çš„çŠ¶æ€æ˜¯ç”± AQS çš„åŒæ­¥çŠ¶æ€å˜é‡æ¥è¡¨ç¤ºçš„ã€‚çŠ¶æ€ä¸º 0 è¡¨ç¤ºé”æ˜¯å¯ç”¨çš„ï¼ŒçŠ¶æ€ä¸º 1 è¡¨ç¤ºé”è¢«ä¸€ä¸ªçº¿ç¨‹æŒæœ‰ï¼Œå¤§äº 1 è¡¨ç¤ºåŒä¸€ä¸ªçº¿ç¨‹é‡å…¥äº†è¿™ä¸ªé”ã€‚</li></ul></li><li><strong>è·å–é”</strong>ï¼š<ul><li>å½“ä¸€ä¸ªçº¿ç¨‹å°è¯•è·å–é”æ—¶ï¼Œå¦‚æœåŒæ­¥çŠ¶æ€ä¸º 0ï¼ŒAQS ä¼šå°è¯•é€šè¿‡ CASï¼ˆæ¯”è¾ƒå¹¶äº¤æ¢ï¼‰æ“ä½œå°†çŠ¶æ€è®¾ç½®ä¸º 1ï¼Œä»è€Œè·å–é”ã€‚</li><li>å¦‚æœé”å·²ç»è¢«å…¶ä»–çº¿ç¨‹æŒæœ‰ï¼ˆåŒæ­¥çŠ¶æ€é 0ï¼‰ï¼Œé‚£ä¹ˆå°è¯•è·å–é”çš„çº¿ç¨‹ä¼šè¢«åŠ å…¥åˆ° AQS ç»´æŠ¤çš„ç­‰å¾…é˜Ÿåˆ—ä¸­ã€‚</li></ul></li><li><strong>é‡Šæ”¾é”</strong>ï¼š<ul><li>å½“çº¿ç¨‹å®Œæˆä»»åŠ¡åï¼Œå®ƒä¼šè°ƒç”¨ <code>unlock</code> æ–¹æ³•æ¥é‡Šæ”¾é”ã€‚è¿™å°†å‡å°‘ AQS åŒæ­¥çŠ¶æ€çš„è®¡æ•°ã€‚å½“è®¡æ•°é™åˆ° 0 æ—¶ï¼Œé”è¢«å®Œå…¨é‡Šæ”¾ï¼Œç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä¸‹ä¸€ä¸ªçº¿ç¨‹å°†æœ‰æœºä¼šè·å–é”ã€‚</li></ul></li></ol><p>å…¬å¹³æ€§å’Œéå…¬å¹³æ€§</p><ul><li><strong>å…¬å¹³é”</strong>ï¼šåœ¨å…¬å¹³æ¨¡å¼ä¸‹ï¼Œ<code>ReentrantLock</code> ä¼šæŒ‰ç…§çº¿ç¨‹åœ¨ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ç­‰å¾…é¡ºåºæ¥è·å–é”ã€‚è¿™æ„å‘³ç€é¦–å…ˆè¿›å…¥ç­‰å¾…é˜Ÿåˆ—çš„çº¿ç¨‹å°†å…ˆè·å¾—é”ã€‚</li><li><strong>éå…¬å¹³é”</strong>ï¼šåœ¨éå…¬å¹³æ¨¡å¼ä¸‹ï¼Œå½“é”å¯ç”¨æ—¶ï¼Œä»»ä½•è¯·æ±‚å®ƒçš„çº¿ç¨‹éƒ½æœ‰æœºä¼šè·å–é”ã€‚è¿™å¯èƒ½ä¸ä¼šéµå®ˆç­‰å¾…é˜Ÿåˆ—ä¸­çš„é¡ºåºã€‚</li></ul><p>æ€§èƒ½è€ƒé‡</p><ul><li><strong>é€‰æ‹©å…¬å¹³æ€§</strong>ï¼šå…¬å¹³é”é€šå¸¸ä¼šæœ‰è¾ƒä½çš„æ€§èƒ½ï¼Œå› ä¸ºå®ƒä¸¥æ ¼æŒ‰ç…§ç­‰å¾…é˜Ÿåˆ—æ¥åˆ†é…é”ï¼Œä½†å®ƒå¯ä»¥å‡å°‘çº¿ç¨‹é¥¥é¥¿çš„æƒ…å†µã€‚</li><li><strong>é€‰æ‹©éå…¬å¹³æ€§</strong>ï¼šéå…¬å¹³é”å¯èƒ½ä¼šæœ‰æ›´å¥½çš„æ€§èƒ½ï¼Œä½†å¯èƒ½å¯¼è‡´çº¿ç¨‹é¥¥é¥¿ï¼Œå› ä¸ºæŸäº›çº¿ç¨‹å¯èƒ½ä¼šé•¿æ—¶é—´ç­‰å¾…è€Œä¸å¾—ä¸é¢‘ç¹åœ°é‡æ–°è°ƒåº¦ã€‚</li></ul><p><code>ReentrantLock</code> æä¾›äº†ä¸€ç§çµæ´»çš„é”å®šæœºåˆ¶ï¼Œé€šè¿‡ AQS å®ç°äº†å¯é‡å…¥æ€§å’Œå¯é€‰çš„å…¬å¹³æ€§ã€‚</p><p>å®ƒå…è®¸æ›´ç»†ç²’åº¦çš„é”æ§åˆ¶ï¼Œä»è€Œåœ¨é«˜åº¦ç«äº‰çš„ç¯å¢ƒä¸­æä¾›æ¯”å†…ç½® <code>synchronized</code> æ›´é«˜çš„æ€§èƒ½å’Œæ›´å¼ºçš„åŠŸèƒ½ã€‚</p><h4 id="æºç è§£æ"><a href="#æºç è§£æ" class="headerlink" title="æºç è§£æ"></a>æºç è§£æ</h4><h5 id="ReentrantLock-ç±»ç»“æ„"><a href="#ReentrantLock-ç±»ç»“æ„" class="headerlink" title="ReentrantLock ç±»ç»“æ„"></a>ReentrantLock ç±»ç»“æ„</h5><p><code>ReentrantLock</code> æœ¬èº«æ˜¯ä¸€ä¸ªç›¸å¯¹ç®€å•çš„ç±»ï¼Œå®ƒä¾èµ–äºå†…éƒ¨ç±» <code>Sync</code> çš„å®ç°ï¼Œè€Œ <code>Sync</code> æ˜¯ <code>AbstractQueuedSynchronizer</code> çš„å­ç±»ã€‚</p><p>åœ¨ <code>ReentrantLock</code> ä¸­ï¼Œæœ‰ä¸¤ä¸ªä¸»è¦çš„å†…éƒ¨ç±»ï¼š<code>FairSync</code> å’Œ <code>NonfairSync</code>ï¼Œåˆ†åˆ«å¯¹åº”å…¬å¹³é”å’Œéå…¬å¹³é”çš„å®ç°ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs scala">public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ReentrantLock</span> <span class="hljs-title">implements</span> <span class="hljs-title">Lock</span>, <span class="hljs-title">java</span>.<span class="hljs-title">io</span>.<span class="hljs-title">Serializable</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Sync</span> sync;<br><br>    <span class="hljs-keyword">abstract</span> static <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Sync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractQueuedSynchronizer</span> </span>&#123;<br>        <span class="hljs-comment">// ... å®ç°ç»†èŠ‚</span><br>    &#125;<br><br>    static <span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NonfairSync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Sync</span> </span>&#123;<br>        <span class="hljs-comment">// ... éå…¬å¹³é”å®ç°</span><br>    &#125;<br><br>    static <span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FairSync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Sync</span> </span>&#123;<br>        <span class="hljs-comment">// ... å…¬å¹³é”å®ç°</span><br>    &#125;<br><br>    <span class="hljs-comment">// æ„é€ å‡½æ•°ç­‰å…¶ä»–æ–¹æ³•</span><br>&#125;<br></code></pre></td></tr></table></figure><h5 id="Sync-ç±»"><a href="#Sync-ç±»" class="headerlink" title="Sync ç±»"></a>Sync ç±»</h5><p><code>Sync</code> ç±»æ˜¯ <code>AbstractQueuedSynchronizer</code> çš„ä¸€ä¸ªæ‰©å±•ï¼Œæä¾›äº†å¤§éƒ¨åˆ†ä¸é”çŠ¶æ€ç®¡ç†ç›¸å…³çš„åŠŸèƒ½ã€‚</p><p>å®ƒä½¿ç”¨ AQS çš„çŠ¶æ€å˜é‡æ¥è¡¨ç¤ºé”çš„æŒæœ‰æ¬¡æ•°ï¼Œä»¥åŠæŒæœ‰é”çš„çº¿ç¨‹ã€‚</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs scala"><span class="hljs-keyword">abstract</span> static <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Sync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractQueuedSynchronizer</span> </span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> boolean isHeldExclusively() &#123;<br>        <span class="hljs-keyword">return</span> getExclusiveOwnerThread() == <span class="hljs-type">Thread</span>.currentThread();<br>    &#125;<br><br>    <span class="hljs-keyword">final</span> void lock() &#123;<br>        acquire(<span class="hljs-number">1</span>);<br>    &#125;<br><br>    <span class="hljs-comment">// å…¶ä»–æ–¹æ³•ï¼ŒåŒ…æ‹¬ tryAcquire, tryRelease ç­‰</span><br>&#125;<br></code></pre></td></tr></table></figure><h5 id="å…¬å¹³é”å’Œéå…¬å¹³é”çš„å®ç°"><a href="#å…¬å¹³é”å’Œéå…¬å¹³é”çš„å®ç°" class="headerlink" title="å…¬å¹³é”å’Œéå…¬å¹³é”çš„å®ç°"></a>å…¬å¹³é”å’Œéå…¬å¹³é”çš„å®ç°</h5><p><code>FairSync</code> å’Œ <code>NonfairSync</code> ç±»é‡å†™äº† <code>tryAcquire</code> æ–¹æ³•ä»¥æä¾›ä¸åŒçš„é”è·å–ç­–ç•¥ã€‚</p><ul><li><strong>éå…¬å¹³é”</strong>ï¼ˆ<code>NonfairSync</code>ï¼‰ï¼šåœ¨å°è¯•è·å–é”æ—¶ï¼Œä¼šç«‹å³å°è¯•æ”¹å˜çŠ¶æ€ï¼Œè€Œä¸æ£€æŸ¥ç­‰å¾…é˜Ÿåˆ—ã€‚</li><li><strong>å…¬å¹³é”</strong>ï¼ˆ<code>FairSync</code>ï¼‰ï¼šåœ¨å°è¯•è·å–é”ä¹‹å‰ï¼Œä¼šæ£€æŸ¥ç­‰å¾…é˜Ÿåˆ—ï¼Œä»¥ç¡®ä¿é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹å…ˆè·å¾—æœåŠ¡ã€‚</li></ul><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs scala">static <span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NonfairSync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Sync</span> </span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> boolean tryAcquire(int acquires) &#123;<br>        <span class="hljs-comment">// å®ç°éå…¬å¹³çš„é”è·å–é€»è¾‘</span><br>    &#125;<br>&#125;<br><br>static <span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FairSync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Sync</span> </span>&#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> boolean tryAcquire(int acquires) &#123;<br>        <span class="hljs-comment">// å®ç°å…¬å¹³çš„é”è·å–é€»è¾‘</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="AbstractQueuedSynchronizerï¼ˆAQSï¼‰"><a href="#AbstractQueuedSynchronizerï¼ˆAQSï¼‰" class="headerlink" title="AbstractQueuedSynchronizerï¼ˆAQSï¼‰"></a>AbstractQueuedSynchronizerï¼ˆAQSï¼‰</h5><p>AQS æ˜¯å®ç°é”å’Œå…¶ä»–åŒæ­¥å™¨çš„æ¡†æ¶ã€‚å®ƒä½¿ç”¨ä¸€ä¸ª int ç±»å‹çš„ volatile å˜é‡æ¥è¡¨ç¤ºåŒæ­¥çŠ¶æ€ï¼Œå¹¶ä½¿ç”¨ä¸€ä¸ªé˜Ÿåˆ—æ¥ç®¡ç†é‚£äº›æœªèƒ½æˆåŠŸè·å–åŒæ­¥çŠ¶æ€çš„çº¿ç¨‹ã€‚</p><ul><li><strong>çŠ¶æ€ç®¡ç†</strong>ï¼šAQS æä¾›äº†ä¸€ç³»åˆ—æ–¹æ³•æ¥æ“ä½œå…¶çŠ¶æ€å˜é‡ï¼Œå¦‚ <code>getState()</code>, <code>setState(int)</code> å’Œ <code>compareAndSetState(int, int)</code>ã€‚</li><li><strong>é˜Ÿåˆ—ç®¡ç†</strong>ï¼šAQS ç»´æŠ¤äº†ä¸€ä¸ªç­‰å¾…é˜Ÿåˆ—ï¼Œå½“çº¿ç¨‹å°è¯•è·å–èµ„æºå¤±è´¥æ—¶ï¼Œå®ƒä¼šè¢«åŠ å…¥åˆ°è¿™ä¸ªé˜Ÿåˆ—ä¸­ã€‚</li></ul><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs scala">public <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AbstractQueuedSynchronizer</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractOwnableSynchronizer</span> <span class="hljs-title">implements</span> <span class="hljs-title">java</span>.<span class="hljs-title">io</span>.<span class="hljs-title">Serializable</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> transient volatile <span class="hljs-type">Node</span> head;<br>    <span class="hljs-keyword">private</span> transient volatile <span class="hljs-type">Node</span> tail;<br>    <span class="hljs-keyword">private</span> volatile int state;<br><br>    <span class="hljs-comment">// å†…éƒ¨ç±» Nodeï¼Œé˜Ÿåˆ—èŠ‚ç‚¹çš„å®šä¹‰</span><br>    static <span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Node</span> </span>&#123;<br>        <span class="hljs-comment">// Node çš„ç»“æ„å’Œæ–¹æ³•</span><br>    &#125;<br><br>    <span class="hljs-comment">// çŠ¶æ€ç®¡ç†å’Œé˜Ÿåˆ—æ“ä½œçš„æ–¹æ³•</span><br>&#125;<br></code></pre></td></tr></table></figure><h5 id="é”çš„è·å–ä¸é‡Šæ”¾"><a href="#é”çš„è·å–ä¸é‡Šæ”¾" class="headerlink" title="é”çš„è·å–ä¸é‡Šæ”¾"></a>é”çš„è·å–ä¸é‡Šæ”¾</h5><ul><li><strong>è·å–é”</strong>ï¼šå½“ <code>ReentrantLock</code> çš„ <code>lock()</code> æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œå®é™…ä¸Šæ˜¯è°ƒç”¨äº† <code>Sync</code> ç±»çš„ <code>acquire</code> æ–¹æ³•ï¼Œè¯¥æ–¹æ³•åˆä¼šè°ƒç”¨ <code>tryAcquire</code> æ–¹æ³•ã€‚<code>tryAcquire</code> çš„å…·ä½“å®ç°å–å†³äºæ˜¯ <code>FairSync</code> è¿˜æ˜¯ <code>NonfairSync</code>ã€‚</li><li><strong>é‡Šæ”¾é”</strong>ï¼š<code>unlock()</code> æ–¹æ³•è°ƒç”¨ <code>Sync</code> ç±»çš„ <code>release</code> æ–¹æ³•ï¼Œè¿›è€Œè°ƒç”¨<code>tryRelease</code> æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•ä¼šæ›´æ–°åŒæ­¥çŠ¶æ€ï¼Œå¹¶åœ¨çŠ¶æ€å˜ä¸º 0 æ—¶ï¼ˆå³é”è¢«å®Œå…¨é‡Šæ”¾æ—¶ï¼‰ï¼Œå”¤é†’ç­‰å¾…é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹.</li></ul><h5 id="è·å–é”çš„è¿‡ç¨‹"><a href="#è·å–é”çš„è¿‡ç¨‹" class="headerlink" title="è·å–é”çš„è¿‡ç¨‹"></a>è·å–é”çš„è¿‡ç¨‹</h5><ol><li>å½“ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ <code>lock()</code> æ–¹æ³•æ—¶ï¼Œå®ƒå®é™…ä¸Šè°ƒç”¨çš„æ˜¯ <code>Sync</code> ç±»ä¸­çš„ <code>acquire(int)</code> æ–¹æ³•ã€‚</li><li><code>acquire(int)</code> æ–¹æ³•ä¼šè°ƒç”¨é‡å†™çš„ <code>tryAcquire(int)</code> æ–¹æ³•ï¼ˆå–å†³äºæ˜¯ <code>FairSync</code> è¿˜æ˜¯ <code>NonfairSync</code>ï¼‰ã€‚<ul><li>åœ¨ <code>NonfairSync</code> ä¸­ï¼Œå®ƒä¼šç«‹å³å°è¯•è·å–é”ï¼Œä¸ç®¡å…¶ä»–çº¿ç¨‹æ˜¯å¦åœ¨ç­‰å¾…ã€‚</li><li>åœ¨ <code>FairSync</code> ä¸­ï¼Œå®ƒä¼šå…ˆæ£€æŸ¥é˜Ÿåˆ—ï¼Œä»¥ç¡®ä¿æ²¡æœ‰å…¶ä»–çº¿ç¨‹åœ¨ç­‰å¾…æ—¶é—´æ›´é•¿ã€‚</li></ul></li></ol><h5 id="é‡Šæ”¾é”çš„è¿‡ç¨‹"><a href="#é‡Šæ”¾é”çš„è¿‡ç¨‹" class="headerlink" title="é‡Šæ”¾é”çš„è¿‡ç¨‹"></a>é‡Šæ”¾é”çš„è¿‡ç¨‹</h5><ol><li>å½“çº¿ç¨‹è°ƒç”¨ <code>unlock()</code> æ–¹æ³•æ—¶ï¼Œå®é™…ä¸Šæ˜¯è°ƒç”¨ <code>Sync</code> ç±»çš„ <code>release(int)</code> æ–¹æ³•ã€‚</li><li><code>release(int)</code> æ–¹æ³•å†…éƒ¨ä¼šè°ƒç”¨ <code>tryRelease(int)</code> æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ£€æŸ¥å½“å‰çº¿ç¨‹æ˜¯å¦æ˜¯é”çš„æŒæœ‰è€…ï¼Œå¹¶å°è¯•å°†åŒæ­¥çŠ¶æ€è®¾ç½®å› 0ã€‚</li><li>å¦‚æœåŒæ­¥çŠ¶æ€æˆåŠŸè®¾ç½®å› 0ï¼Œè¡¨ç¤ºé”å·²ç»è¢«é‡Šæ”¾ï¼Œç­‰å¾…é˜Ÿåˆ—ä¸­çš„å…¶ä»–çº¿ç¨‹å¯èƒ½ä¼šè¢«å”¤é†’å¹¶å°è¯•è·å–é”ã€‚</li></ol><h5 id="AQS-ä¸­çš„ç­‰å¾…é˜Ÿåˆ—"><a href="#AQS-ä¸­çš„ç­‰å¾…é˜Ÿåˆ—" class="headerlink" title="AQS ä¸­çš„ç­‰å¾…é˜Ÿåˆ—"></a>AQS ä¸­çš„ç­‰å¾…é˜Ÿåˆ—</h5><p>AQS ä½¿ç”¨ä¸€ä¸ªå†…éƒ¨çš„ FIFO é˜Ÿåˆ—æ¥ç®¡ç†é‚£äº›æ— æ³•è·å–åˆ°é”çš„çº¿ç¨‹ã€‚</p><p>æ¯ä¸ªèŠ‚ç‚¹ä»£è¡¨ä¸€ä¸ªçº¿ç¨‹ã€‚å½“ä¸€ä¸ªçº¿ç¨‹æ— æ³•è·å–åˆ°é”æ—¶ï¼Œå®ƒä¼šè¢«åŒ…è£…æˆä¸€ä¸ªèŠ‚ç‚¹åŠ å…¥åˆ°é˜Ÿåˆ—çš„æœ«å°¾ã€‚å½“é”è¢«é‡Šæ”¾æ—¶ï¼Œé˜Ÿåˆ—å¤´éƒ¨çš„èŠ‚ç‚¹ä¼šè¢«å”¤é†’å¹¶å°è¯•å†æ¬¡è·å–é”ã€‚</p><h5 id="CAS-åœ¨-AQS-ä¸­çš„ä½¿ç”¨"><a href="#CAS-åœ¨-AQS-ä¸­çš„ä½¿ç”¨" class="headerlink" title="CAS åœ¨ AQS ä¸­çš„ä½¿ç”¨"></a>CAS åœ¨ AQS ä¸­çš„ä½¿ç”¨</h5><p>AQS ä½¿ç”¨ CAS æ“ä½œæ¥å®‰å…¨åœ°ä¿®æ”¹åŒæ­¥çŠ¶æ€ã€‚è¿™æ˜¯ä¸€ç§æ— é”çš„åŸå­æ“ä½œï¼Œå¯ä»¥ä¿è¯å³ä½¿åœ¨å¤šä¸ªçº¿ç¨‹åŒæ—¶å°è¯•ä¿®æ”¹çŠ¶æ€æ—¶ï¼ŒåŒæ­¥çŠ¶æ€çš„æ›´æ–°ä¹Ÿæ˜¯ä¸€è‡´çš„ã€‚</p><blockquote><p>æ€»ç»“</p></blockquote><p><code>ReentrantLock</code> çš„å®ç°ä¾èµ–äº AQS çš„å¼ºå¤§åŠŸèƒ½ï¼Œæä¾›äº†ä¸€ç§çµæ´»ä¸”é«˜æ•ˆçš„æ–¹å¼æ¥å¤„ç†å¹¶å‘ç¼–ç¨‹ä¸­çš„åŒæ­¥é—®é¢˜ã€‚</p><p>é€šè¿‡å°†é”çš„å…·ä½“å®ç°ç»†èŠ‚å§”æ‰˜ç»™ AQSï¼Œ<code>ReentrantLock</code> ä¸ä»…æä¾›äº†åŸºæœ¬çš„é”åŠŸèƒ½ï¼Œè¿˜æ”¯æŒå¦‚å…¬å¹³æ€§&#x2F;éå…¬å¹³æ€§é€‰æ‹©ã€æ¡ä»¶å˜é‡ã€ä»¥åŠé”çš„å¯é‡å…¥æ€§ç­‰é«˜çº§ç‰¹æ€§ã€‚</p><hr><p>å‚è€ƒ:</p><ul><li><a href="https://blog.csdn.net/wang_yong_hui_1234/article/details/130165866">https://blog.csdn.net/wang_yong_hui_1234/article/details/130165866</a></li><li><a href="https://www.bilibili.com/video/BV12K411G7Fg">https://www.bilibili.com/video/BV12K411G7Fg</a></li><li><a href="https://javaguide.cn/java/concurrent/java-concurrent-questions-01.html">https://javaguide.cn/java/concurrent/java-concurrent-questions-01.html</a></li><li><a href="https://www.bilibili.com/video/BV1z44y1X7BJ">https://www.bilibili.com/video/BV1z44y1X7BJ</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
      <category>Thread</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>thread</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Springå­¦ä¹ _SpringMVC</title>
    <link href="/2023/12/05/Spring%E5%AD%A6%E4%B9%A0_SpringMVC/"/>
    <url>/2023/12/05/Spring%E5%AD%A6%E4%B9%A0_SpringMVC/</url>
    
    <content type="html"><![CDATA[<h3 id="1ã€ä»€ä¹ˆæ˜¯SpringMVC"><a href="#1ã€ä»€ä¹ˆæ˜¯SpringMVC" class="headerlink" title="1ã€ä»€ä¹ˆæ˜¯SpringMVC"></a>1ã€ä»€ä¹ˆæ˜¯SpringMVC</h3><p>SpringMVCæ˜¯Springæ¡†æ¶ä¸­çš„ä¸€ä¸ªæ¨¡å—ï¼Œç”¨äºæ„å»ºWebåº”ç”¨ç¨‹åºï¼Œé‡‡ç”¨äº†ç»å…¸çš„MVCè®¾è®¡æ¨¡å¼ã€‚</p><p>MVCè‹±æ–‡æ˜¯Model View Controllerï¼Œæ˜¯æ¨¡å‹(model)ï¼è§†å›¾(view)ï¼æ§åˆ¶å™¨(controller)çš„ç¼©å†™ï¼Œä¸€ç§è½¯ä»¶è®¾è®¡è§„èŒƒã€‚æœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€ç§è§£è€¦ã€‚æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡å°†ä¸šåŠ¡é€»è¾‘ã€æ•°æ®ã€æ˜¾ç¤ºåˆ†ç¦»æ¥ç»„ç»‡ä»£ç ã€‚</p><ol><li><strong>æ¨¡å‹ï¼ˆModelï¼‰ï¼š</strong><ul><li>æ¨¡å‹ä»£è¡¨åº”ç”¨ç¨‹åºçš„ä¸šåŠ¡é€»è¾‘å’Œæ•°æ®ã€‚åœ¨SpringMVCä¸­ï¼Œæ¨¡å‹é€šå¸¸æ˜¯ä¸€ä¸ªPOJOï¼ˆPlain Old Java Objectï¼‰ç±»ï¼Œè´Ÿè´£å°è£…ä¸šåŠ¡æ•°æ®ã€‚</li><li>æ¨¡å‹å¯¹è±¡å­˜å‚¨åº”ç”¨ç¨‹åºçš„çŠ¶æ€ï¼Œä¸æ•°æ®åº“è¿›è¡Œäº¤äº’ï¼Œæ‰§è¡Œä¸šåŠ¡é€»è¾‘ç­‰ã€‚</li></ul></li><li><strong>è§†å›¾ï¼ˆViewï¼‰ï¼š</strong><ul><li>è§†å›¾è´Ÿè´£æ¸²æŸ“æ¨¡å‹æ•°æ®å¹¶å±•ç¤ºç»™ç”¨æˆ·ã€‚åœ¨SpringMVCä¸­ï¼Œè§†å›¾é€šå¸¸æ˜¯JSPï¼ˆJavaServer Pagesï¼‰æˆ–Thymeleafç­‰æ¨¡æ¿å¼•æ“ã€‚</li><li>è§†å›¾è´Ÿè´£å°†æ¨¡å‹çš„æ•°æ®ä»¥ç”¨æˆ·å‹å¥½çš„æ–¹å¼å‘ˆç°ï¼Œä¸ç”¨æˆ·è¿›è¡Œäº¤äº’ã€‚</li></ul></li><li><strong>æ§åˆ¶å™¨ï¼ˆControllerï¼‰ï¼š</strong><ul><li>æ§åˆ¶å™¨æ¥æ”¶ç”¨æˆ·çš„è¯·æ±‚å¹¶å†³å®šè°ƒç”¨å“ªä¸ªä¸šåŠ¡é€»è¾‘å¤„ç†æ–¹æ³•ã€‚åœ¨SpringMVCä¸­ï¼Œæ§åˆ¶å™¨é€šå¸¸æ˜¯ä¸€ä¸ªç±»ï¼Œä½¿ç”¨æ³¨è§£æ¥æ ‡è¯†å¤„ç†è¯·æ±‚çš„æ–¹æ³•ã€‚</li><li>æ§åˆ¶å™¨å¤„ç†è¯·æ±‚åï¼Œè°ƒç”¨é€‚å½“çš„ä¸šåŠ¡é€»è¾‘ï¼Œè·å–æˆ–æ›´æ–°æ¨¡å‹æ•°æ®ï¼Œç„¶åé€‰æ‹©åˆé€‚çš„è§†å›¾æ¥æ¸²æŸ“å“åº”ã€‚</li></ul></li><li><strong>å‰ç«¯æ§åˆ¶å™¨ï¼ˆFront Controllerï¼‰ï¼š</strong><ul><li>SpringMVC ä½¿ç”¨DispatcherServletä½œä¸ºå‰ç«¯æ§åˆ¶å™¨ï¼Œå®ƒæ˜¯Servletçš„ä¸€ä¸ªå­ç±»ï¼Œè´Ÿè´£æ‹¦æˆªæ‰€æœ‰è¿›å…¥åº”ç”¨çš„è¯·æ±‚ã€‚</li><li>DispatcherServletå°†è¯·æ±‚åˆ†å‘ç»™ç›¸åº”çš„å¤„ç†å™¨ï¼ˆControllerï¼‰ï¼Œå¹¶å°†æ¨¡å‹æ•°æ®ä¼ é€’ç»™åˆé€‚çš„è§†å›¾è¿›è¡Œæ¸²æŸ“ã€‚</li></ul></li><li><strong>å¤„ç†å™¨æ˜ å°„å™¨å’Œè§†å›¾è§£æå™¨ï¼š</strong><ul><li>å¤„ç†å™¨æ˜ å°„å™¨è´Ÿè´£å°†è¯·æ±‚æ˜ å°„åˆ°åˆé€‚çš„æ§åˆ¶å™¨ï¼Œæ ¹æ®è¯·æ±‚URLæ‰¾åˆ°å¯¹åº”çš„å¤„ç†å™¨ã€‚</li><li>è§†å›¾è§£æå™¨è´Ÿè´£å°†é€»è¾‘è§†å›¾åè§£æä¸ºå®é™…çš„è§†å›¾å¯¹è±¡ï¼Œå†³å®šä½¿ç”¨å“ªä¸ªè§†å›¾æ¥å‘ˆç°æ¨¡å‹æ•°æ®ã€‚</li></ul></li></ol><h3 id="2ã€SpringMVCçš„æ ¸å¿ƒç»„ä»¶"><a href="#2ã€SpringMVCçš„æ ¸å¿ƒç»„ä»¶" class="headerlink" title="2ã€SpringMVCçš„æ ¸å¿ƒç»„ä»¶"></a>2ã€SpringMVCçš„æ ¸å¿ƒç»„ä»¶</h3><ul><li><strong><code>DispatcherServlet</code><strong>ï¼š</strong>æ ¸å¿ƒçš„ä¸­å¤®å¤„ç†å™¨</strong>ï¼Œè´Ÿè´£æ¥æ”¶è¯·æ±‚ã€åˆ†å‘ï¼Œå¹¶ç»™äºˆå®¢æˆ·ç«¯å“åº”ã€‚</li><li><strong><code>HandlerMapping</code><strong>ï¼š</strong>å¤„ç†å™¨æ˜ å°„å™¨</strong>ï¼Œæ ¹æ® URL å»åŒ¹é…æŸ¥æ‰¾èƒ½å¤„ç†çš„ <code>Handler</code> ï¼Œå¹¶ä¼šå°†è¯·æ±‚æ¶‰åŠåˆ°çš„æ‹¦æˆªå™¨å’Œ <code>Handler</code> ä¸€èµ·å°è£…ã€‚</li><li><strong><code>HandlerAdapter</code><strong>ï¼š</strong>å¤„ç†å™¨é€‚é…å™¨</strong>ï¼Œæ ¹æ® <code>HandlerMapping</code> æ‰¾åˆ°çš„ <code>Handler</code> ï¼Œé€‚é…æ‰§è¡Œå¯¹åº”çš„ <code>Handler</code>ï¼›</li><li><strong><code>Handler</code><strong>ï¼š</strong>è¯·æ±‚å¤„ç†å™¨</strong>ï¼Œå¤„ç†å®é™…è¯·æ±‚çš„å¤„ç†å™¨ã€‚</li><li><strong><code>ViewResolver</code><strong>ï¼š</strong>è§†å›¾è§£æå™¨</strong>ï¼Œæ ¹æ® <code>Handler</code> è¿”å›çš„é€»è¾‘è§†å›¾ &#x2F; è§†å›¾ï¼Œè§£æå¹¶æ¸²æŸ“çœŸæ­£çš„è§†å›¾ï¼Œå¹¶ä¼ é€’ç»™ <code>DispatcherServlet</code> å“åº”å®¢æˆ·ç«¯</li></ul><h3 id="3ã€SpringMVCçš„å·¥ä½œåŸç†"><a href="#3ã€SpringMVCçš„å·¥ä½œåŸç†" class="headerlink" title="3ã€SpringMVCçš„å·¥ä½œåŸç†"></a>3ã€SpringMVCçš„å·¥ä½œåŸç†</h3><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202312061453227.png" alt="image.png"></p><p><strong>æµç¨‹è¯´æ˜ï¼ˆé‡è¦ï¼‰ï¼š</strong></p><ol><li>å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰å‘é€è¯·æ±‚ï¼Œ <code>DispatcherServlet</code>æ‹¦æˆªè¯·æ±‚ã€‚</li><li><code>DispatcherServlet</code> æ ¹æ®è¯·æ±‚ä¿¡æ¯è°ƒç”¨ <code>HandlerMapping</code> ã€‚<code>HandlerMapping</code> æ ¹æ® URL å»åŒ¹é…æŸ¥æ‰¾èƒ½å¤„ç†çš„ <code>Handler</code>ï¼ˆä¹Ÿå°±æ˜¯æˆ‘ä»¬å¹³å¸¸è¯´çš„ <code>Controller</code> æ§åˆ¶å™¨ï¼‰ ï¼Œå¹¶ä¼šå°†è¯·æ±‚æ¶‰åŠåˆ°çš„æ‹¦æˆªå™¨å’Œ <code>Handler</code> ä¸€èµ·å°è£…ã€‚</li><li><code>DispatcherServlet</code> è°ƒç”¨ <code>HandlerAdapter</code>é€‚é…å™¨æ‰§è¡Œ <code>Handler</code> ã€‚</li><li><code>Handler</code> å®Œæˆå¯¹ç”¨æˆ·è¯·æ±‚çš„å¤„ç†åï¼Œä¼šè¿”å›ä¸€ä¸ª <code>ModelAndView</code> å¯¹è±¡ç»™<code>DispatcherServlet</code>ï¼Œ<code>ModelAndView</code> é¡¾åæ€ä¹‰ï¼ŒåŒ…å«äº†æ•°æ®æ¨¡å‹ä»¥åŠç›¸åº”çš„è§†å›¾çš„ä¿¡æ¯ã€‚<code>Model</code> æ˜¯è¿”å›çš„æ•°æ®å¯¹è±¡ï¼Œ<code>View</code> æ˜¯ä¸ªé€»è¾‘ä¸Šçš„ <code>View</code>ã€‚</li><li><code>ViewResolver</code> ä¼šæ ¹æ®é€»è¾‘ <code>View</code> æŸ¥æ‰¾å®é™…çš„ <code>View</code>ã€‚</li><li><code>DispaterServlet</code> æŠŠè¿”å›çš„ <code>Model</code> ä¼ ç»™ <code>View</code>ï¼ˆè§†å›¾æ¸²æŸ“ï¼‰ã€‚</li><li>æŠŠ <code>View</code> è¿”å›ç»™è¯·æ±‚è€…ï¼ˆæµè§ˆå™¨ï¼‰</li></ol><p>to be continedâ€¦.</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://www.pdai.tech/md/spring/spring-x-framework-springmvc.html">https://www.pdai.tech/md/spring/spring-x-framework-springmvc.html</a></li><li><a href="https://javaguide.cn/system-design/framework/spring/spring-knowledge-and-questions-summary.html#spring-mvc">https://javaguide.cn/system-design/framework/spring/spring-knowledge-and-questions-summary.html#spring-mvc</a></li><li><a href="https://blog.csdn.net/Zhangsama1/article/details/131237139">https://blog.csdn.net/Zhangsama1/article/details/131237139</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>æ¡†æ¶</category>
      
      <category>Spring</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>spring</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Springå­¦ä¹ _AOP</title>
    <link href="/2023/12/05/Spring%E5%AD%A6%E4%B9%A0_AOP/"/>
    <url>/2023/12/05/Spring%E5%AD%A6%E4%B9%A0_AOP/</url>
    
    <content type="html"><![CDATA[<h3 id="1ã€ä»€ä¹ˆæ˜¯AOP"><a href="#1ã€ä»€ä¹ˆæ˜¯AOP" class="headerlink" title="1ã€ä»€ä¹ˆæ˜¯AOP"></a>1ã€ä»€ä¹ˆæ˜¯AOP</h3><p>AOPï¼ˆAspect-Oriented Programming:é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰æ˜¯ä¸€ç§ç¼–ç¨‹èŒƒå¼ï¼Œé€šè¿‡åœ¨ä»£ç ä¸­æ¨ªå‘æ’å…¥å…³æ³¨ç‚¹ï¼ˆå¦‚æ—¥å¿—ã€äº‹åŠ¡ï¼‰ï¼Œå®ç°å¯¹åº”ç”¨ç¨‹åºæ¨¡å—åŒ–ã€å¯ç»´æŠ¤æ€§å’Œå¯é‡ç”¨æ€§çš„æå‡ã€‚</p><p>AOP åˆ‡é¢ç¼–ç¨‹æ¶‰åŠåˆ°çš„ä¸€äº›ä¸“ä¸šæœ¯è¯­ï¼š</p><table><thead><tr><th>æœ¯è¯­</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>ç›®æ ‡(Target)</td><td>è¢«é€šçŸ¥çš„å¯¹è±¡</td></tr><tr><td>ä»£ç†(Proxy)</td><td>å‘ç›®æ ‡å¯¹è±¡åº”ç”¨é€šçŸ¥ä¹‹ååˆ›å»ºçš„ä»£ç†å¯¹è±¡</td></tr><tr><td>è¿æ¥ç‚¹(JoinPoint)</td><td>ç›®æ ‡å¯¹è±¡çš„æ‰€å±ç±»ä¸­ï¼Œå®šä¹‰çš„æ‰€æœ‰æ–¹æ³•å‡ä¸ºè¿æ¥ç‚¹</td></tr><tr><td>åˆ‡å…¥ç‚¹(Pointcut)</td><td>è¢«åˆ‡é¢æ‹¦æˆª &#x2F; å¢å¼ºçš„è¿æ¥ç‚¹ï¼ˆåˆ‡å…¥ç‚¹ä¸€å®šæ˜¯è¿æ¥ç‚¹ï¼Œè¿æ¥ç‚¹ä¸ä¸€å®šæ˜¯åˆ‡å…¥ç‚¹ï¼‰</td></tr><tr><td>é€šçŸ¥(Advice)</td><td>å¢å¼ºçš„é€»è¾‘ &#x2F; ä»£ç ï¼Œä¹Ÿå³æ‹¦æˆªåˆ°ç›®æ ‡å¯¹è±¡çš„è¿æ¥ç‚¹ä¹‹åè¦åšçš„äº‹æƒ…</td></tr><tr><td>åˆ‡é¢(Aspect)</td><td>åˆ‡å…¥ç‚¹(Pointcut)+é€šçŸ¥(Advice)</td></tr><tr><td>Weaving(ç»‡å…¥)</td><td>å°†é€šçŸ¥åº”ç”¨åˆ°ç›®æ ‡å¯¹è±¡ï¼Œè¿›è€Œç”Ÿæˆä»£ç†å¯¹è±¡çš„è¿‡ç¨‹åŠ¨ä½œ</td></tr></tbody></table><h3 id="2ã€Spring-AOP-çš„å®ç°"><a href="#2ã€Spring-AOP-çš„å®ç°" class="headerlink" title="2ã€Spring AOP çš„å®ç°"></a>2ã€Spring AOP çš„å®ç°</h3><p>Spring AOPåŸºäºåŠ¨æ€ä»£ç†å®ç°ï¼Œ</p><ul><li>å¯¹äºå®ç°äº†æ¥å£çš„å¯¹è±¡ï¼Œä½¿ç”¨JDK Proxyåˆ›å»ºä»£ç†å¯¹è±¡ï¼›</li><li>å¯¹äºæœªå®ç°æ¥å£çš„å¯¹è±¡ï¼Œä½¿ç”¨Cglibç”Ÿæˆè¢«ä»£ç†å¯¹è±¡çš„å­ç±»ã€‚</li></ul><p>Spring AOPè¿˜é›†æˆäº†AspectJï¼ŒAspectJæ˜¯Javaç”Ÿæ€ç³»ç»Ÿä¸­æœ€å®Œæ•´çš„AOPæ¡†æ¶ï¼Œæ‹¥æœ‰æ›´å¤šåŠŸèƒ½ï¼Œç‰¹åˆ«åœ¨åˆ‡é¢è¾ƒå¤šçš„æƒ…å†µä¸‹ï¼Œé€‰æ‹©AspectJç›¸æ¯”Spring AOPæ›´ä¸ºé«˜æ•ˆã€‚</p><p>to be continedâ€¦..</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://www.pdai.tech/md/spring/spring-x-framework-aop.html">https://www.pdai.tech/md/spring/spring-x-framework-aop.html</a></li><li><a href="https://javaguide.cn/system-design/framework/spring/spring-knowledge-and-questions-summary.html#spring-aop">https://javaguide.cn/system-design/framework/spring/spring-knowledge-and-questions-summary.html#spring-aop</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>æ¡†æ¶</category>
      
      <category>Spring</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>spring</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringCloud_ç»„ä»¶åŸºæœ¬ä½¿ç”¨_Stream</title>
    <link href="/2023/12/04/SpringCloud_%E7%BB%84%E4%BB%B6%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8_Stream/"/>
    <url>/2023/12/04/SpringCloud_%E7%BB%84%E4%BB%B6%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8_Stream/</url>
    
    <content type="html"><![CDATA[<p>Stream ç»„ä»¶æ˜¯ç”¨äºå°è£…æ¶ˆæ¯é˜Ÿåˆ—æ¥ä½¿ç”¨çš„ï¼ŒBusè¿™ä¸ªç»„ä»¶ä¸€èˆ¬ä¼šç»“åˆ Stream ä½¿ç”¨ï¼›</p><p>çœ‹ä¸€èˆ¬æ€§æ–‡æ¡£è§£é‡Šï¼Œä¸»è¦æ˜¯å›´ç»• Bus å¯ä»¥åšåˆ°é…ç½®çš„åŠ¨æ€åˆ·æ–°ã€äº‹ä»¶çš„ä¼ é€’ã€‚å…·ä½“ä½¿ç”¨çš„æ—¶å€™å¯ä»¥çœ‹ä¸€ä¸‹ç›¸å…³å†…å®¹ã€‚</p><p>ä¸‹é¢å†…å®¹æ˜¯å¼•ç”¨ ChatGpt çš„å†…å®¹ï¼Œåˆ†åˆ«æ˜¯ Stream å’Œ Bus çš„åŸºæœ¬ä½¿ç”¨ã€‚</p><h3 id="1ã€Spring-Cloud-Streamçš„ä½¿ç”¨"><a href="#1ã€Spring-Cloud-Streamçš„ä½¿ç”¨" class="headerlink" title="1ã€Spring Cloud Streamçš„ä½¿ç”¨"></a>1ã€Spring Cloud Streamçš„ä½¿ç”¨</h3><p>Spring Cloud Stream æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºæ¶ˆæ¯é©±åŠ¨å¾®æœåŠ¡æ¶æ„çš„æ¡†æ¶ï¼Œå®ƒåŸºäºSpring Bootå’ŒSpring Integrationï¼Œæä¾›äº†ä¸€ç§ç®€å•çš„æ–¹å¼æ¥å®ç°å„ä¸ªå¾®æœåŠ¡ç»„ä»¶ä¹‹é—´çš„æ¶ˆæ¯é€šä¿¡ã€‚</p><p>ä»¥ä¸‹æ˜¯Spring Cloud Streamçš„åŸºæœ¬ä½¿ç”¨æ­¥éª¤ï¼š</p><blockquote><ol><li>å¼•å…¥ä¾èµ–</li></ol></blockquote><p>åœ¨é¡¹ç›®çš„ <code>pom.xml</code> æ–‡ä»¶ä¸­ï¼Œæ·»åŠ  Spring Cloud Stream çš„ä¾èµ–ï¼š</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-stream-</span><span class="hljs-template-variable">&#123;binder&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p><code>&#123;binder&#125;</code> å¯ä»¥æ˜¯ä¸åŒçš„æ¶ˆæ¯ä¸­é—´ä»¶çš„åç§°ï¼Œæ¯”å¦‚ RabbitMQã€Kafka ç­‰ã€‚</p><blockquote><ol start="2"><li>é…ç½®æ¶ˆæ¯ä¸­é—´ä»¶</li></ol></blockquote><p>åœ¨ <code>application.properties</code> æˆ– <code>application.yml</code> æ–‡ä»¶ä¸­é…ç½®æ¶ˆæ¯ä¸­é—´ä»¶çš„è¿æ¥ä¿¡æ¯ï¼Œä»¥ RabbitMQ ä¸ºä¾‹ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">cloud:</span><br>    <span class="hljs-attr">stream:</span><br>      <span class="hljs-attr">bindings:</span><br>        <span class="hljs-attr">output:</span><br>          <span class="hljs-attr">destination:</span> <span class="hljs-string">my-output-topic</span><br>          <span class="hljs-attr">binder:</span> <span class="hljs-string">rabbit</span> <span class="hljs-comment"># RabbitMQçš„binder</span><br>      <span class="hljs-attr">rabbit:</span><br>        <span class="hljs-attr">bindings:</span><br>          <span class="hljs-attr">output:</span><br>            <span class="hljs-attr">exchangeType:</span> <span class="hljs-string">topic</span><br>            <span class="hljs-attr">routingKeyExpression:</span> <span class="hljs-string">&#x27;my-output-topic&#x27;</span><br></code></pre></td></tr></table></figure><blockquote><ol start="3"><li>å‘é€æ¶ˆæ¯</li></ol></blockquote><p>åœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ <code>Source</code> æ¥å£å®šä¹‰æ¶ˆæ¯å‘é€çš„è¾“å‡ºé€šé“ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.springframework.cloud.stream.annotation.Output;<br><span class="hljs-keyword">import</span> org.springframework.messaging.MessageChannel;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">MySource</span> &#123;<br><br>    <span class="hljs-type">String</span> <span class="hljs-variable">OUTPUT</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;output&quot;</span>;<br><br>    <span class="hljs-meta">@Output(OUTPUT)</span><br>    MessageChannel <span class="hljs-title function_">output</span><span class="hljs-params">()</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç„¶ååœ¨éœ€è¦å‘é€æ¶ˆæ¯çš„åœ°æ–¹æ³¨å…¥ <code>MySource</code>ï¼Œå¹¶ä½¿ç”¨ <code>output()</code> æ–¹æ³•å‘é€æ¶ˆæ¯ï¼š</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">beans</span>.<span class="hljs-property">factory</span>.<span class="hljs-property">annotation</span>.<span class="hljs-property">Autowired</span>;<br><span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">messaging</span>.<span class="hljs-property">Message</span>;<br><span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">messaging</span>.<span class="hljs-property">support</span>.<span class="hljs-property">MessageBuilder</span>;<br><span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">stereotype</span>.<span class="hljs-property">Service</span>;<br><br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MessageSenderService</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-title class_">MySource</span> mySource;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">sendMessage</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> payload</span>) &#123;<br>        <span class="hljs-title class_">Message</span>&lt;<span class="hljs-title class_">String</span>&gt; message = <span class="hljs-title class_">MessageBuilder</span>.<span class="hljs-title function_">withPayload</span>(payload).<span class="hljs-title function_">build</span>();<br>        mySource.<span class="hljs-title function_">output</span>().<span class="hljs-title function_">send</span>(message);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><ol start="4"><li>æ¥æ”¶æ¶ˆæ¯</li></ol></blockquote><p>åœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ <code>@StreamListener</code> æ³¨è§£å®šä¹‰æ¶ˆæ¯æ¥æ”¶çš„è¾“å…¥é€šé“ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">import</span> org.springframework.cloud.stream.<span class="hljs-keyword">annotation</span>.StreamListener;<br><span class="hljs-keyword">import</span> org.springframework.messaging.handler.<span class="hljs-keyword">annotation</span>.Payload;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Service;<br><br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MessageReceiverService</span> &#123;<br><br>    <span class="hljs-meta">@StreamListener(MySource.INPUT)</span><br>    <span class="hljs-keyword">public</span> void receiveMessage(<span class="hljs-meta">@Payload</span> String payload) &#123;<br>        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">&quot;Received message: &quot;</span> + payload);<br>        <span class="hljs-comment">// å¤„ç†æ¥æ”¶åˆ°çš„æ¶ˆæ¯</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><ol start="5"><li>è¿è¡Œæ—¶ç»‘å®š</li></ol></blockquote><p>Spring Cloud Stream ä¼šåœ¨è¿è¡Œæ—¶å°†æ¶ˆæ¯é€šé“ç»‘å®šåˆ°æ¶ˆæ¯ä¸­é—´ä»¶ä¸Šï¼Œä½¿å¾—æ¶ˆæ¯çš„å‘é€å’Œæ¥æ”¶å¯ä»¥ä¸åº•å±‚çš„æ¶ˆæ¯ä¸­é—´ä»¶è§£è€¦ã€‚æ ¹æ®é…ç½®çš„ <code>&#123;binder&#125;</code> ä¸åŒï¼Œå¯ä»¥æ”¯æŒ RabbitMQã€Kafkaã€ActiveMQ ç­‰å¤šç§æ¶ˆæ¯ä¸­é—´ä»¶ã€‚</p><p>é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨ Spring Cloud Stream åœ¨å¾®æœåŠ¡ä¸­å®ç°æ¶ˆæ¯çš„å‘é€å’Œæ¥æ”¶ï¼Œä»è€Œæ„å»ºæ¶ˆæ¯é©±åŠ¨çš„å¾®æœåŠ¡æ¶æ„ã€‚</p><h3 id="2ã€SpringCloud-Bus-çš„ä½¿ç”¨"><a href="#2ã€SpringCloud-Bus-çš„ä½¿ç”¨" class="headerlink" title="2ã€SpringCloud Bus çš„ä½¿ç”¨"></a>2ã€SpringCloud Bus çš„ä½¿ç”¨</h3><p>Spring Cloud Busæ˜¯ä¸€ä¸ªç”¨äºåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ä¼ æ’­äº‹ä»¶çš„å·¥å…·ï¼Œå®ƒå»ºç«‹åœ¨Spring Cloud Streamä¹‹ä¸Šã€‚å®ƒå…è®¸å¾®æœåŠ¡æ¶æ„ä¸­çš„ç»„ä»¶ä¹‹é—´è¿›è¡Œæ¶ˆæ¯æ¨é€ï¼Œå®ç°é…ç½®çš„åŠ¨æ€åˆ·æ–°ã€äº‹ä»¶çš„ä¼ é€’ç­‰åŠŸèƒ½ã€‚</p><p>ä»¥ä¸‹æ˜¯Spring Cloud Busçš„åŸºæœ¬ä½¿ç”¨æ­¥éª¤ï¼š</p><blockquote><ol><li>å¼•å…¥ä¾èµ–</li></ol></blockquote><p>åœ¨é¡¹ç›®çš„<code>pom.xml</code>æ–‡ä»¶ä¸­æ·»åŠ Spring Cloud Busçš„ä¾èµ–ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-bus-amqp<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ç¤ºä¾‹ä¸­ä½¿ç”¨äº†AMQPï¼ˆAdvanced Message Queuing Protocolï¼‰ä½œä¸ºæ¶ˆæ¯ä¼ é€’çš„ä¸­é—´ä»¶ï¼Œä½ ä¹Ÿå¯ä»¥é€‰æ‹©å…¶ä»–æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œå¦‚Kafkaç­‰ã€‚</p><blockquote><ol start="2"><li>é…ç½®æ¶ˆæ¯ä¸­é—´ä»¶</li></ol></blockquote><p>åœ¨<code>application.properties</code>æˆ–<code>application.yml</code>ä¸­é…ç½®æ¶ˆæ¯ä¸­é—´ä»¶çš„è¿æ¥ä¿¡æ¯ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">rabbitmq:</span><br>    <span class="hljs-attr">host:</span> <span class="hljs-string">localhost</span><br>    <span class="hljs-attr">port:</span> <span class="hljs-number">5672</span><br>    <span class="hljs-attr">username:</span> <span class="hljs-string">guest</span><br>    <span class="hljs-attr">password:</span> <span class="hljs-string">guest</span><br></code></pre></td></tr></table></figure><blockquote><ol start="3"><li>é…ç½®Bus</li></ol></blockquote><p>åœ¨å¾®æœåŠ¡çš„<code>application.properties</code>æˆ–<code>application.yml</code>ä¸­ï¼Œæ·»åŠ ä»¥ä¸‹é…ç½®ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">cloud:</span><br>    <span class="hljs-attr">bus:</span><br>      <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><blockquote><p>4.å‘é€æ¶ˆæ¯</p></blockquote><p>åœ¨ä»»æ„å¾®æœåŠ¡ä¸­ï¼Œå¯ä»¥ä½¿ç”¨Spring Cloud Buså‘é€æ¶ˆæ¯æ¥è§¦å‘äº‹ä»¶ã€‚å¯ä»¥ä½¿ç”¨HTTP POSTè¯·æ±‚å‘<code>/actuator/bus-refresh</code>ç«¯ç‚¹å‘é€åˆ·æ–°è¯·æ±‚ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">curl -X POST http:<span class="hljs-regexp">//</span>localhost:<span class="hljs-number">8080</span><span class="hljs-regexp">/actuator/</span>bus-refresh<br></code></pre></td></tr></table></figure><p>è¿™æ ·å°±ä¼šè§¦å‘Spring Cloud Buså‘é€ä¸€ä¸ªåˆ·æ–°äº‹ä»¶ï¼Œç„¶åå„ä¸ªå¾®æœåŠ¡éƒ½ä¼šæ¥æ”¶åˆ°è¿™ä¸ªäº‹ä»¶ï¼Œä»è€Œè§¦å‘é…ç½®çš„åˆ·æ–°æ“ä½œã€‚</p><blockquote><ol start="5"><li>æ¥æ”¶æ¶ˆæ¯</li></ol></blockquote><p>åœ¨å¾®æœåŠ¡ä¸­ï¼Œå¯ä»¥ä½¿ç”¨<code>@RefreshScope</code>æ³¨è§£æ ‡è®°ä¸€ä¸ªç±»ï¼Œä½¿å¾—è¯¥ç±»ä¸­çš„é…ç½®åœ¨æ¥æ”¶åˆ°åˆ·æ–°äº‹ä»¶æ—¶èƒ½å¤Ÿé‡æ–°åŠ è½½ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">import</span> org.springframework.cloud.context.config.<span class="hljs-keyword">annotation</span>.RefreshScope;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.<span class="hljs-keyword">annotation</span>.GetMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.<span class="hljs-keyword">annotation</span>.RestController;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-meta">@RefreshScope</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyController</span> &#123;<br><br>    <span class="hljs-meta">@Value(<span class="hljs-string">&quot;<span class="hljs-subst">$&#123;my.property&#125;</span>&quot;</span>)</span><br>    <span class="hljs-keyword">private</span> String myProperty;<br><br>    <span class="hljs-meta">@GetMapping(<span class="hljs-string">&quot;/property&quot;</span>)</span><br>    <span class="hljs-keyword">public</span> String getProperty() &#123;<br>        <span class="hljs-keyword">return</span> myProperty;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œ<code>@RefreshScope</code>æ³¨è§£ä½¿å¾—<code>MyController</code>ç±»ä¸­çš„é…ç½®åœ¨æ¥æ”¶åˆ°åˆ·æ–°äº‹ä»¶æ—¶ä¼šé‡æ–°åŠ è½½ã€‚</p><p>é€šè¿‡è¿™äº›æ­¥éª¤ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨Spring Cloud Buså®ç°åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ä¼ æ’­äº‹ä»¶ï¼Œä¾‹å¦‚åŠ¨æ€åˆ·æ–°é…ç½®ã€ä¼ é€’æ¶ˆæ¯ç­‰ã€‚</p><p>to be continedâ€¦..</p>]]></content>
    
    
    <categories>
      
      <category>å¾®æœåŠ¡</category>
      
    </categories>
    
    
    <tags>
      
      <tag>springcloud</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringCloud_ç»„ä»¶åŸºæœ¬ä½¿ç”¨_Seata</title>
    <link href="/2023/12/04/SpringCloud_%E7%BB%84%E4%BB%B6%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8_Seata/"/>
    <url>/2023/12/04/SpringCloud_%E7%BB%84%E4%BB%B6%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8_Seata/</url>
    
    <content type="html"><![CDATA[<h3 id="1ã€ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼äº‹åŠ¡"><a href="#1ã€ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼äº‹åŠ¡" class="headerlink" title="1ã€ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼äº‹åŠ¡"></a>1ã€ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼äº‹åŠ¡</h3><p>é¦–å…ˆç†è§£ä¸€ä¸‹ï¼Œä¸ºä»€ä¹ˆä¼šç”¨åˆ°åˆ†å¸ƒå¼äº‹åŠ¡ã€‚</p><p>åœ¨åˆ†å¸ƒå¼æœåŠ¡ä¸­ï¼ŒæœåŠ¡Aä¸­é€šè¿‡feignæ¥è°ƒç”¨æœåŠ¡Bçš„æ–¹æ³•ï¼Œä½†æ˜¯æœåŠ¡Bçš„æ–¹æ³•å¹¶ä¸å½’å±äºæœåŠ¡Açš„äº‹åŠ¡ä½“ç³»ä¸­ï¼Œå› æ­¤å¦‚æœæ­¤æ—¶æœåŠ¡BæŠ¥é”™ï¼Œå¹¶ä¸ä¼šå¯¼è‡´å·²ç»æ‰§è¡Œäº†çš„æœåŠ¡Açš„æ“ä½œå›é€€ã€‚</p><p>æƒ³è¦è®©æœåŠ¡Aå›é€€ï¼Œé‚£ä¹ˆå°±è¦è®©æœåŠ¡Bçº³å…¥åˆ°æœåŠ¡Açš„äº‹åŠ¡ä½“ç³»ä¸­ï¼Œä¹Ÿå°±æ˜¯ä¸¤è€…æ˜¯åŒä¸€ä¸ªäº‹åŠ¡IDã€‚è¿™å°±æ˜¯æˆ‘ä»¬çš„åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œå®ƒ<strong>å¯ä»¥è·¨è¶ŠæœåŠ¡æ¥å®ç°äº‹åŠ¡</strong>ã€‚</p><p>æƒ³è¦å®ç°åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œæˆ‘ä»¬æœ‰å¤šç§æ–¹å¼ï¼Œå¯ä»¥é€šè¿‡åƒredisè¿™æ ·çš„ä¸­é—´ä»¶æ¥å®ç°ã€‚</p><p>ä½†ä¹Ÿå¯ä»¥ç”¨åˆ°æˆ‘ä»¬ä»Šå¤©ä»‹ç»çš„seataç»„ä»¶æ¥å®ç°ã€‚ç”šè‡³å‘å±•è‡³ä»Šï¼Œä¸€èˆ¬æˆ‘ä»¬è°ˆåˆ°åˆ†å¸ƒå¼äº‹åŠ¡ï¼ŒåŸºæœ¬ä¸Šseataå·²ç»æˆäº†æˆ‘ä»¬çš„ä¸äºŒé€‰æ‹©ã€‚</p><h3 id="2ã€Seata-æ˜¯ä»€ä¹ˆ"><a href="#2ã€Seata-æ˜¯ä»€ä¹ˆ" class="headerlink" title="2ã€Seata æ˜¯ä»€ä¹ˆ"></a>2ã€Seata æ˜¯ä»€ä¹ˆ</h3><p>Seata æ˜¯ä¸€æ¬¾åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆï¼Œä¸ºå¾®æœåŠ¡æ¶æ„æä¾›äº†å¼ºä¸€è‡´æ€§çš„åˆ†å¸ƒå¼äº‹åŠ¡æ”¯æŒã€‚æä¾›äº†å…¨å±€äº‹åŠ¡ç®¡ç†å’Œæœ¬åœ°äº‹åŠ¡åè°ƒçš„åŠŸèƒ½ï¼Œå¯ä»¥ç”¨äºç¡®ä¿å¤šä¸ªå¾®æœåŠ¡ä¹‹é—´çš„äº‹åŠ¡æ“ä½œçš„ä¸€è‡´æ€§ï¼›æä¾›äº† ATã€TCCã€SAGAå’ŒXAç­‰å‡ ç§äº‹åŠ¡æ¨¡å¼ã€‚</p><p>å¸¸è§çš„ä¸¤ç§åˆ†å¸ƒå¼äº‹åŠ¡æ¨¡å‹ï¼šAT æ¨¡å‹ï¼ˆåŸºäº TCCï¼ŒTry-Confirm-Cancelï¼‰å’Œ TCC æ¨¡å‹ï¼ˆåŸºäºä¸¤é˜¶æ®µæäº¤ï¼‰ã€‚</p><blockquote><p>ATæ¨¡å‹</p></blockquote><p>é»˜è®¤ä½¿ç”¨çš„æ˜¯ATæ¨¡å¼</p><ol><li>åœ¨ä¸šåŠ¡è¡¨æ‰€åœ¨çš„æ•°æ®åº“ä¸­åˆ›å»ºä¸€ä¸ªåä¸ºundo_logçš„è¡¨ï¼Œç”¨äºè®°å½•å›æ»šSQLï¼Œå³ä¸æ‰§è¡ŒSQLç›¸åçš„SQLï¼ˆä¾‹å¦‚ï¼Œæ‰§è¡Œinsertåˆ™å¯¹åº”deleteï¼‰ã€‚</li><li>å½“ä¸šåŠ¡è¡¨æ‰§è¡Œæ“ä½œæ—¶ï¼ŒSeataä¼šè§£ææ‰§è¡Œçš„SQLï¼Œç”Ÿæˆå›æ»šSQLå¹¶å­˜å‚¨åˆ°undo_logè¡¨ä¸­ã€‚</li><li>åœ¨æœ¬åœ°äº‹åŠ¡æäº¤å‰ï¼Œå‘SeataæœåŠ¡ç«¯æ³¨å†Œåˆ†æ”¯ï¼Œç”³è¯·ä¸šåŠ¡è¡¨ä¸­å¯¹åº”æ•°æ®è¡Œçš„å…¨å±€é”ï¼Œé˜»æ­¢å…¶ä»–äº‹åŠ¡å¯¹è¯¥æ•°æ®è¿›è¡Œæ›´æ–°æ“ä½œã€‚</li><li>æœ¬åœ°äº‹åŠ¡æäº¤æ—¶ï¼Œä¸šåŠ¡æ•°æ®çš„æ›´æ–°å’Œç”Ÿæˆçš„undo logä¸€èµ·æäº¤ã€‚</li><li>å°†æœ¬åœ°äº‹åŠ¡æ‰§è¡Œç»“æœæŠ¥å‘Šç»™SeataæœåŠ¡ç«¯ï¼Œå¤šä¸ªæœåŠ¡çš„æœ¬åœ°äº‹åŠ¡ä½¿ç”¨ç›¸åŒçš„äº‹åŠ¡IDå’Œåˆ†æ”¯IDè®°å½•åœ¨SeataæœåŠ¡ç«¯ã€‚</li><li>å¦‚æœæŸä¸ªæœ¬åœ°äº‹åŠ¡å‘ç”Ÿé”™è¯¯ï¼ŒSeataæœåŠ¡ç«¯å‘èµ·å¯¹åº”åˆ†æ”¯çš„å›æ»šè¯·æ±‚ã€‚</li><li>åŒæ—¶å¼€å¯æœ¬åœ°äº‹åŠ¡ï¼Œé€šè¿‡äº‹åŠ¡IDå’Œåˆ†æ”¯IDæŸ¥è¯¢undo_logè¡¨ï¼Œæ‰§è¡Œå›æ»šSQLï¼Œå¹¶å°†æ‰§è¡Œç»“æœæŠ¥å‘Šç»™SeataæœåŠ¡ç«¯ã€‚</li><li>å¦‚æœæ²¡æœ‰é”™è¯¯å‘ç”Ÿï¼ŒSeataæœåŠ¡ç«¯ä¼šåœ¨å¯¹åº”åˆ†æ”¯ä¸Šå‘èµ·è¯·æ±‚ï¼Œå¼‚æ­¥æ‰¹é‡åˆ é™¤undo_logè¡¨ä¸­çš„è®°å½•ã€‚</li></ol><p>æ€»ä½“æ¥è¯´ï¼ŒSeataæœåŠ¡ç«¯è®°å½•äº†æ‰€æœ‰æœ¬åœ°äº‹åŠ¡ï¼ŒåŒæ—¶åœ¨æ¯ä¸ªåº“ä¸­è®°å½•äº†undo logã€‚</p><p>å½“å‘ç”Ÿé”™è¯¯æ—¶ï¼Œé€šè¿‡äº‹åŠ¡IDå’Œåˆ†æ”¯IDæ‰¾åˆ°åŒä¸€ç»„çš„æ‰€æœ‰æœ¬åœ°äº‹åŠ¡ï¼Œåˆ©ç”¨è®°å½•çš„undo logç»Ÿä¸€å›é€€æ•°æ®ã€‚</p><h3 id="3ã€ä½¿ç”¨-Seata-çš„åŸºæœ¬æ­¥éª¤"><a href="#3ã€ä½¿ç”¨-Seata-çš„åŸºæœ¬æ­¥éª¤" class="headerlink" title="3ã€ä½¿ç”¨ Seata çš„åŸºæœ¬æ­¥éª¤"></a>3ã€ä½¿ç”¨ Seata çš„åŸºæœ¬æ­¥éª¤</h3><p>seataåˆ†ä¸ºæœåŠ¡ç«¯ï¼ˆTCï¼‰å’Œå®¢æˆ·ç«¯ï¼ˆTM,RMï¼‰,</p><p>å®¢æˆ·ç«¯é€šè¿‡å¼•å…¥jaråŒ…æ¥ä½¿ç”¨ã€‚æœåŠ¡ç«¯éœ€è¦æˆ‘ä»¬å•ç‹¬å®‰è£…ã€‚</p><ul><li>TC(Transaction Coordinator)ï¼šäº‹åŠ¡åè°ƒå™¨ï¼Œç»´æŠ¤å…¨å±€äº‹åŠ¡çš„è¿è¡ŒçŠ¶æ€ï¼Œåè°ƒå’Œè½å®å…¨å±€äº‹åŠ¡çš„å›æ»šæäº¤</li><li>TM(Transaction Manager)ï¼šæ§åˆ¶å…¨å±€äº‹åŠ¡çš„è¾¹ç•Œï¼Œè´Ÿè´£å¼€å¯ä¸€ä¸ªå…¨å±€äº‹åŠ¡ï¼Œå¹¶æœ€ç»ˆå‘èµ·å…¨å±€äº‹åŠ¡æäº¤æˆ–å›æ»šçš„å†³è®®</li><li>RM(Resource Manager)ï¼šæ§åˆ¶åˆ†æ”¯ï¼ˆæœ¬åœ°ï¼‰äº‹åŠ¡ï¼Œè´Ÿè´£åˆ†æ”¯æ³¨å†Œã€çŠ¶æ€æ±‡æŠ¥ï¼Œå¹¶æ¥å—TCçš„æŒ‡ä»¤ï¼Œé©±åŠ¨æœ¬åœ°äº‹åŠ¡çš„æäº¤å’Œå›æ»š</li></ul><h4 id="1-éƒ¨ç½²-Seata-æœåŠ¡å™¨"><a href="#1-éƒ¨ç½²-Seata-æœåŠ¡å™¨" class="headerlink" title="1. éƒ¨ç½² Seata æœåŠ¡å™¨"></a>1. éƒ¨ç½² Seata æœåŠ¡å™¨</h4><p>æœåŠ¡ç«¯ä¸‹è½½åœ°å€ï¼š <a href="https://github.com/seata/seata/releases">https://github.com/seata/seata/releases</a></p><p>éƒ¨ç½²è¿‡ç¨‹ï¼šç•¥</p><h4 id="2-seataå®¢æˆ·ç«¯é…ç½®"><a href="#2-seataå®¢æˆ·ç«¯é…ç½®" class="headerlink" title="2. seataå®¢æˆ·ç«¯é…ç½®"></a>2. seataå®¢æˆ·ç«¯é…ç½®</h4><p>åœ¨å¾®æœåŠ¡çš„é¡¹ç›®ä¸­ï¼Œæ·»åŠ  Seata çš„ä¾èµ–ã€‚å¦‚æœä½¿ç”¨ Mavenï¼Œå¯ä»¥åœ¨é¡¹ç›®çš„ <code>pom.xml</code> æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ä¾èµ–ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.seata<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>seata-all<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.5.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span> <span class="hljs-comment">&lt;!-- è¯·æ ¹æ®å®é™…æƒ…å†µé€‰æ‹©ç‰ˆæœ¬ --&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>é…ç½®æ–‡ä»¶</p><p>åœ¨å¾®æœåŠ¡çš„é…ç½®æ–‡ä»¶ä¸­ï¼Œé…ç½® Seata å®¢æˆ·ç«¯ã€‚é€šå¸¸éœ€è¦æŒ‡å®š Seata æœåŠ¡å™¨çš„åœ°å€ç­‰ä¿¡æ¯ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹é…ç½®ï¼š</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">seata:</span><br>  application-id: my-app<br>  tx-service-group: my-tx-group<br><span class="hljs-symbol">  enabled:</span> true<br><span class="hljs-symbol">  config:</span><br><span class="hljs-symbol">    type:</span> nacos<br><span class="hljs-symbol">    nacos:</span><br><span class="hljs-symbol">      serverAddr:</span> nacos-server:<span class="hljs-number">8848</span><br><span class="hljs-symbol">      groupId:</span> SEATA_GROUP<br><span class="hljs-symbol">      namespace:</span> <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-symbol">  registry:</span><br><span class="hljs-symbol">    type:</span> nacos<br><span class="hljs-symbol">    nacos:</span><br><span class="hljs-symbol">      serverAddr:</span> nacos-server:<span class="hljs-number">8848</span><br><span class="hljs-symbol">      groupId:</span> SEATA_GROUP<br><span class="hljs-symbol">      namespace:</span> <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-symbol">  service:</span><br><span class="hljs-symbol">    vgroup:</span> <span class="hljs-string">&quot;my-tx-group&quot;</span><br><span class="hljs-symbol">    group:</span> <span class="hljs-string">&quot;my-tx-group&quot;</span><br></code></pre></td></tr></table></figure><h4 id="æ·»åŠ äº‹åŠ¡æ³¨è§£"><a href="#æ·»åŠ äº‹åŠ¡æ³¨è§£" class="headerlink" title="æ·»åŠ äº‹åŠ¡æ³¨è§£"></a>æ·»åŠ äº‹åŠ¡æ³¨è§£</h4><p>ä½¿ç”¨ @GlobalTransactional æ³¨è§£</p><p>åœ¨éœ€è¦åˆ†å¸ƒå¼äº‹åŠ¡çš„æ–¹æ³•ä¸Šï¼Œä½¿ç”¨ <code>@GlobalTransactional</code> æ³¨è§£æ ‡è®°ã€‚è¿™ä¸ªæ³¨è§£è¡¨ç¤ºè¿™ä¸ªæ–¹æ³•éœ€è¦å‚ä¸å…¨å±€äº‹åŠ¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> io.seata.spring.annotation.GlobalTransactional;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Service;<br><br><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyService</span> &#123;<br><br>    <span class="hljs-meta">@GlobalTransactional(rollbackFor = Exception.class)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">businessMethod</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">// ä¸šåŠ¡é€»è¾‘</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>to be continedâ€¦.</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://blog.csdn.net/github_38592071/article/details/131136986">https://blog.csdn.net/github_38592071/article/details/131136986</a></li><li><a href="https://juejin.cn/post/7087551217781620749">https://juejin.cn/post/7087551217781620749</a></li><li><a href="https://seata.io/zh-cn/docs/overview/what-is-seata.html">https://seata.io/zh-cn/docs/overview/what-is-seata.html</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>å¾®æœåŠ¡</category>
      
    </categories>
    
    
    <tags>
      
      <tag>springcloud</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringCloud_ç»„ä»¶åŸºæœ¬ä½¿ç”¨_OpenFeign</title>
    <link href="/2023/12/04/SpringCloud_%E7%BB%84%E4%BB%B6%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8_OpenFeign/"/>
    <url>/2023/12/04/SpringCloud_%E7%BB%84%E4%BB%B6%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8_OpenFeign/</url>
    
    <content type="html"><![CDATA[<h3 id="1ã€æœåŠ¡è°ƒç”¨"><a href="#1ã€æœåŠ¡è°ƒç”¨" class="headerlink" title="1ã€æœåŠ¡è°ƒç”¨"></a>1ã€æœåŠ¡è°ƒç”¨</h3><h4 id="æœåŠ¡æ³¨å†Œã€æœåŠ¡å‘ç°ã€æœåŠ¡è°ƒç”¨"><a href="#æœåŠ¡æ³¨å†Œã€æœåŠ¡å‘ç°ã€æœåŠ¡è°ƒç”¨" class="headerlink" title="æœåŠ¡æ³¨å†Œã€æœåŠ¡å‘ç°ã€æœåŠ¡è°ƒç”¨"></a>æœåŠ¡æ³¨å†Œã€æœåŠ¡å‘ç°ã€æœåŠ¡è°ƒç”¨</h4><p>åœ¨Spring Cloud Alibabaç”Ÿæ€ç³»ç»Ÿä¸­ï¼ŒæœåŠ¡è°ƒç”¨çš„æ ¸å¿ƒç»„ä»¶æ˜¯ <strong>Nacos Discovery</strong> å’Œ <strong>Feign</strong>ã€‚</p><blockquote><p>Nacos Discovery</p></blockquote><p>Nacosæ˜¯ä¸€ä¸ªå¼€æºçš„æœåŠ¡å‘ç°å’Œé…ç½®ç®¡ç†å¹³å°ï¼Œå®ƒæä¾›äº†æœåŠ¡æ³¨å†Œä¸å‘ç°çš„åŠŸèƒ½ï¼Œå¯ä»¥è®©å¾®æœåŠ¡åº”ç”¨åœ¨æ³¨å†Œåˆ°Nacosæ³¨å†Œä¸­å¿ƒåï¼Œæ–¹ä¾¿åœ°å‘ç°å…¶ä»–æœåŠ¡ï¼Œå¹¶å®ç°æœåŠ¡ä¹‹é—´çš„è°ƒç”¨ã€‚é€šè¿‡Nacos Discoveryï¼ŒæœåŠ¡ä¹‹é—´çš„å…³ç³»å’Œä½ç½®ä¿¡æ¯èƒ½å¤Ÿå¾—åˆ°ç»´æŠ¤ï¼Œå®ç°äº†æœåŠ¡æ³¨å†Œå’ŒæœåŠ¡å‘ç°ã€‚</p><blockquote><p>Feign</p></blockquote><p>Feignæ˜¯ä¸€ä¸ªå£°æ˜å¼çš„WebæœåŠ¡å®¢æˆ·ç«¯ï¼Œå®ƒç®€åŒ–äº†æœåŠ¡è°ƒç”¨çš„è¿‡ç¨‹ã€‚é€šè¿‡åœ¨æ¥å£ä¸Šæ·»åŠ æ³¨è§£ï¼ŒFeignèƒ½å¤Ÿè‡ªåŠ¨æ„é€ HTTPè¯·æ±‚å¹¶å°†å…¶å‘é€åˆ°æœåŠ¡æä¾›æ–¹ã€‚åœ¨Spring Cloud Alibabaä¸­ï¼ŒFeignä¸Nacos Discoveryé›†æˆï¼Œå¯ä»¥ä½¿ç”¨Feignæ¥å‘èµ·æœåŠ¡è°ƒç”¨ï¼Œè€ŒNacos Discoveryåˆ™ç”¨äºæœåŠ¡çš„æ³¨å†Œå’Œå‘ç°ã€‚</p><h4 id="å¾®æœåŠ¡é—´çš„è°ƒç”¨æ–¹å¼"><a href="#å¾®æœåŠ¡é—´çš„è°ƒç”¨æ–¹å¼" class="headerlink" title="å¾®æœåŠ¡é—´çš„è°ƒç”¨æ–¹å¼"></a>å¾®æœåŠ¡é—´çš„è°ƒç”¨æ–¹å¼</h4><blockquote><p>å¾®æœåŠ¡è°ƒç”¨</p></blockquote><p>å¾®æœåŠ¡ä¹‹é—´çš„é€šä¿¡æ–¹å¼å¸¸è§çš„æ–¹å¼æœ‰ä¸¤ç§ï¼š</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">RPC</span> ä»£è¡¨ï¼šdubbo  <br>HTTP ä»£è¡¨ï¼šSpringCloud<br></code></pre></td></tr></table></figure><p>åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œæœ€å¸¸è§çš„åœºæ™¯å°±æ˜¯å¾®æœåŠ¡é—´çš„ç›¸äº’è°ƒç”¨ã€‚</p><p>åœ¨ SpringCloud ä¸­ï¼Œé»˜è®¤æ˜¯ä½¿ç”¨ HTTP  æ¥è¿›è¡Œå¾®æœåŠ¡çš„é€šä¿¡ï¼Œå¾®æœåŠ¡é—´çš„ç›¸äº’è°ƒç”¨æ–¹å¼ä¸»è¦æœ‰<code>RestTemplate</code>ã€<code>Feign</code>Â ã€å’Œ<code>OpenFeign</code></p><blockquote><p>RestTemplate</p></blockquote><p>RestTemplate æ˜¯ä» Spring3.0 å¼€å§‹æ”¯æŒçš„ä¸€ä¸ª http è¯·æ±‚å·¥å…·ï¼Œè¿™ä¸ªè¯·æ±‚å·¥å…·æ˜¯ Spring è‡ªå¸¦çš„</p><p>RestTemplate æä¾›äº†å¸¸è§çš„ REST è¯·æ±‚æ–¹æ³•æ¨¡æ¿ï¼Œå¦‚ GETã€POSTã€PUTã€DELETE è¯·æ±‚ä»¥åŠä¸€äº›é€šç”¨çš„è¯·æ±‚æ‰§è¡Œæ–¹æ³• exchange å’Œ execute æ–¹æ³•</p><blockquote><p>Feign</p></blockquote><p>Feign æ˜¯ Spring Cloud ç»„ä»¶ä¸­çš„ä¸€ä¸ª<code>å£°æ˜å¼</code>çš„<code>è½»é‡çº§ RESTful çš„ HTTP æœåŠ¡å®¢æˆ·ç«¯</code></p><p>Feign å†…ç½®äº† Ribbonï¼Œç”¨æ¥åš<code>å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡</code>ï¼Œå»è°ƒç”¨æœåŠ¡æ³¨å†Œä¸­å¿ƒçš„æœåŠ¡ï¼›</p><blockquote><p>OpenFeign</p></blockquote><p>OpenFeign æ˜¯ Spring Cloud åœ¨ Feign çš„åŸºç¡€ä¸Šæ”¯æŒ SpringMVC çš„æ³¨è§£ï¼Œå¦‚ @RequesMapping ç­‰ç­‰ã€‚</p><p>OpenFeign çš„ @FeignClient å¯ä»¥è§£æ SpringMVC çš„ @RequestMapping æ³¨è§£ä¸‹çš„æ¥å£ï¼Œå¹¶é€šè¿‡åŠ¨æ€ä»£ç†çš„æ–¹å¼äº§ç”Ÿå®ç°ç±»ï¼Œå®ç°ç±»ä¸­åšè´Ÿè½½å‡è¡¡å¹¶è°ƒç”¨å…¶ä»–æœåŠ¡</p><blockquote><p>OpenFeign å’Œ Feign ç»„ä»¶çš„åŒºåˆ«å’Œå…³è”</p></blockquote><p>OpenFeign æ˜¯ Feign çš„å¢å¼ºç‰ˆï¼Œå®ƒæ˜¯ Spring Cloud å¯¹ Feign è¿›è¡Œäº†æ‰©å±•å’Œä¼˜åŒ–çš„ç»“æœã€‚è™½ç„¶ä¸¤è€…æœ‰å…³è”ï¼Œä½†åœ¨ä¸€äº›åŠŸèƒ½å’Œä½¿ç”¨ä¸Šå­˜åœ¨ä¸€äº›åŒºåˆ«ã€‚</p><p><strong>Feign:</strong></p><ul><li>Feign æ˜¯ä¸€ä¸ªå£°æ˜å¼çš„WebæœåŠ¡å®¢æˆ·ç«¯ï¼Œç”¨äºç®€åŒ–æœåŠ¡è°ƒç”¨çš„è¿‡ç¨‹ã€‚</li><li>å®ƒåŸºäºæ¥å£å®šä¹‰ï¼Œé€šè¿‡æ·»åŠ æ³¨è§£ï¼Œå¯ä»¥è½»æ¾åœ°å‘èµ·HTTPè¯·æ±‚ã€‚</li><li>åœ¨åŸå§‹çš„ Spring Cloud ä¸­ï¼ŒFeign çš„é»˜è®¤å®ç°ä¸æ”¯æŒ Spring MVC æ³¨è§£ï¼Œå› æ­¤ä½¿ç”¨èµ·æ¥æœ‰ä¸€äº›é™åˆ¶ã€‚</li></ul><p><strong>OpenFeign:</strong></p><ul><li>OpenFeign æ˜¯å¯¹ Feign çš„å¢å¼ºï¼Œå®ƒå¼•å…¥äº†å¯¹ Spring MVC æ³¨è§£çš„æ”¯æŒï¼Œä½¿å¾— Feign åœ¨ä½¿ç”¨ä¸Šæ›´åŠ çµæ´»ã€‚</li><li>OpenFeign æä¾›äº†æ›´ä¸°å¯Œçš„åŠŸèƒ½ï¼Œä¾‹å¦‚ç»§æ‰¿æ€§ã€æ”¯æŒ Spring Cloud Contractã€æ”¯æŒå¤šéƒ¨åˆ†è¯·æ±‚å’Œå“åº”ç­‰ã€‚</li><li>OpenFeign å¯ä»¥é€šè¿‡ <code>@FeignClient</code> æ³¨è§£çš„ <code>contextId</code> å±æ€§æ¥å®ç°å¤šä¸ª Feign å®¢æˆ·ç«¯å®ä¾‹ä¹‹é—´çš„éš”ç¦»ã€‚</li></ul><p>åœ¨Spring Cloudé¡¹ç›®ä¸­ï¼Œå¦‚æœä½ ä½¿ç”¨ <code>@FeignClient</code> æ³¨è§£ï¼Œå®é™…ä¸Šé»˜è®¤æ˜¯ä½¿ç”¨çš„ OpenFeignã€‚</p><p>Spring Cloud åœ¨ Hoxton.RELEASE ç‰ˆæœ¬ä¹‹å<strong>é»˜è®¤ä½¿ç”¨ OpenFeignï¼Œè€Œä¸æ˜¯åŸå§‹çš„ Feignã€‚</strong></p><p>å…³äºä½¿ç”¨ <code>@FeignClient</code> æ³¨è§£åˆ›å»º Feign å®¢æˆ·ç«¯çš„ä¾‹å­ï¼š</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-meta">@FeignClient(name = <span class="hljs-string">&quot;example-service&quot;</span>, url = <span class="hljs-string">&quot;http://example.com&quot;</span>)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ExampleFeignClient</span> &#123;<br><br>    <span class="hljs-meta">@GetMapping(<span class="hljs-string">&quot;/hello&quot;</span>)</span><br>    String hello();<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œ<code>@FeignClient</code> æ³¨è§£æŒ‡å®šäº†æœåŠ¡çš„åç§°å’ŒURLï¼Œ<code>ExampleFeignClient</code> æ¥å£å®šä¹‰äº†æœåŠ¡è°ƒç”¨çš„å¥‘çº¦ã€‚é€šè¿‡æ·»åŠ  <code>@GetMapping</code> æ³¨è§£ï¼Œå®ç°äº†å¯¹æœåŠ¡æä¾›è€…çš„ <code>/hello</code> æ¥å£çš„è°ƒç”¨ã€‚</p><p>æ€»ä½“è€Œè¨€ï¼ŒOpenFeign æ˜¯å¯¹ Feign çš„å¢å¼ºç‰ˆæœ¬ï¼Œæä¾›äº†æ›´å¤šçš„åŠŸèƒ½å’Œæ›´å¥½çš„çµæ´»æ€§ï¼Œè€Œåœ¨ Spring Cloud ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸é€šè¿‡ <code>@FeignClient</code> æ³¨è§£æ¥ä½¿ç”¨ OpenFeignã€‚</p><h3 id="2ã€OpenFeign-çš„ä½¿ç”¨"><a href="#2ã€OpenFeign-çš„ä½¿ç”¨" class="headerlink" title="2ã€OpenFeign çš„ä½¿ç”¨"></a>2ã€OpenFeign çš„ä½¿ç”¨</h3><h4 id="FeignClientçš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•"><a href="#FeignClientçš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•" class="headerlink" title="@FeignClientçš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•"></a><code>@FeignClient</code>çš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•</h4><p><code>@FeignClient</code> æ˜¯ Spring Cloud ä¸­ç”¨äºå£°æ˜å¼RESTå®¢æˆ·ç«¯çš„æ³¨è§£ã€‚é€šè¿‡ä½¿ç”¨è¯¥æ³¨è§£ï¼Œå¯ä»¥å®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œè€Œä¸éœ€è¦å®ç°è¯¥æ¥å£ï¼ŒSpring Cloudä¼šåœ¨è¿è¡Œæ—¶è‡ªåŠ¨ç”Ÿæˆè¯¥æ¥å£çš„å®ç°ç±»ï¼Œç”¨äºå‘èµ·æœåŠ¡é—´çš„HTTPè¯·æ±‚ã€‚</p><p>ä»¥ä¸‹æ˜¯<code>@FeignClient</code>çš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•ï¼š</p><blockquote><p><strong>ç®€å•ä½¿ç”¨ï¼š</strong></p></blockquote><p>åœ¨ä¸€ä¸ªæ¥å£ä¸Šæ·»åŠ  <code>@FeignClient</code> æ³¨è§£ï¼Œå¹¶æŒ‡å®šè¦è°ƒç”¨çš„æœåŠ¡åç§°</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">import</span> org.springframework.cloud.openfeign.FeignClient;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.<span class="hljs-keyword">annotation</span>.GetMapping;<br><br><span class="hljs-meta">@FeignClient(name = <span class="hljs-string">&quot;example-service&quot;</span>)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ExampleFeignClient</span> &#123;<br><br>    <span class="hljs-meta">@GetMapping(<span class="hljs-string">&quot;/hello&quot;</span>)</span><br>    String hello();<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œ<code>ExampleFeignClient</code> æ¥å£ç”¨äºè°ƒç”¨åä¸º â€œexample-serviceâ€ çš„å¾®æœåŠ¡ï¼Œå…¶ä¸­ <code>@GetMapping(&quot;/hello&quot;)</code> å®šä¹‰äº†è°ƒç”¨æœåŠ¡çš„è·¯å¾„ã€‚</p><blockquote><p>æŒ‡å®š URL</p></blockquote><p>å¯ä»¥é€šè¿‡ <code>url</code> å±æ€§æŒ‡å®šæœåŠ¡çš„URLï¼Œè€Œä¸æ˜¯é€šè¿‡æœåŠ¡åç§°è¿›è¡Œè°ƒç”¨ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-meta">@FeignClient(name = <span class="hljs-string">&quot;example-service&quot;</span>, url = <span class="hljs-string">&quot;http://example.com&quot;</span>)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ExampleFeignClient</span> &#123;<br><br>    <span class="hljs-meta">@GetMapping(<span class="hljs-string">&quot;/hello&quot;</span>)</span><br>    String hello();<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒæœåŠ¡çš„URLè¢«ç¡¬ç¼–ç ä¸º â€œ<a href="http://example.com"./">http://example.com&quot;ã€‚</a></p><blockquote><p><strong>æŒ‡å®šFallback</strong></p></blockquote><p>å¯ä»¥é€šè¿‡ <code>fallback</code> å±æ€§æŒ‡å®šä¸€ä¸ªå®ç°äº† <code>ExampleFeignClient</code> æ¥å£çš„ç±»ï¼Œä½œä¸ºè°ƒç”¨å¤±è´¥æ—¶çš„é™çº§å¤„ç†ã€‚</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs haxe"><span class="hljs-meta">@FeignClient</span>(name = <span class="hljs-string">&quot;example-service&quot;</span>, fallback = ExampleFeignClientFallback.class)<br><span class="hljs-keyword">public</span> <span class="hljs-title class_"><span class="hljs-keyword">interface</span> <span class="hljs-title">ExampleFeignClient</span> </span>&#123;<br><br>    <span class="hljs-meta">@GetMapping</span>(<span class="hljs-string">&quot;/hello&quot;</span>)<br>    <span class="hljs-keyword">String</span> hello();<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-title class_"><span class="hljs-keyword">class</span> <span class="hljs-title">ExampleFeignClientFallback</span> <span class="hljs-keyword"><span class="hljs-keyword">implements</span> <span class="hljs-type">ExampleFeignClient</span></span> </span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">String</span> hello() &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Fallback Hello&quot;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå½“è°ƒç”¨æœåŠ¡å¤±è´¥æ—¶ï¼Œä¼šæ‰§è¡Œ <code>ExampleFeignClientFallback</code> ä¸­çš„é€»è¾‘ã€‚</p><blockquote><p><strong>æŒ‡å®šDecoderå’ŒEncoder</strong></p></blockquote><p>å¯ä»¥é€šè¿‡ <code>decoder</code> å’Œ <code>encoder</code> å±æ€§æŒ‡å®šè‡ªå®šä¹‰çš„è§£ç å™¨å’Œç¼–ç å™¨ã€‚</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-meta">@FeignClient(name = <span class="hljs-string">&quot;example-service&quot;</span>, decoder = MyDecoder.class, encoder = MyEncoder.class)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ExampleFeignClient</span> &#123;<br><br>    <span class="hljs-meta">@GetMapping(<span class="hljs-string">&quot;/hello&quot;</span>)</span><br>    String hello();<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>MyDecoder</code> å’Œ <code>MyEncoder</code> åˆ†åˆ«æ˜¯è‡ªå®šä¹‰çš„è§£ç å™¨å’Œç¼–ç å™¨ã€‚</p><p>è¿™äº›æ˜¯ <code>@FeignClient</code> æ³¨è§£çš„åŸºæœ¬ç”¨æ³•ï¼Œé€šè¿‡çµæ´»ä½¿ç”¨è¿™äº›å±æ€§ï¼Œå¯ä»¥å®ç°æ›´å¤šå®šåˆ¶åŒ–çš„æœåŠ¡è°ƒç”¨é…ç½®ã€‚</p><p>to be continuedâ€¦.</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://blog.csdn.net/IT__learning/article/details/116349843">https://blog.csdn.net/IT__learning/article/details/116349843</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>å¾®æœåŠ¡</category>
      
    </categories>
    
    
    <tags>
      
      <tag>springcloud</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringCloud_ç»„ä»¶åŸºæœ¬ä½¿ç”¨_Gateway</title>
    <link href="/2023/12/04/SpringCloud_%E7%BB%84%E4%BB%B6%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8_Gateway/"/>
    <url>/2023/12/04/SpringCloud_%E7%BB%84%E4%BB%B6%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8_Gateway/</url>
    
    <content type="html"><![CDATA[<h3 id="1ã€å¾®æœåŠ¡ç½‘å…³æ˜¯ä»€ä¹ˆ"><a href="#1ã€å¾®æœåŠ¡ç½‘å…³æ˜¯ä»€ä¹ˆ" class="headerlink" title="1ã€å¾®æœåŠ¡ç½‘å…³æ˜¯ä»€ä¹ˆ"></a>1ã€å¾®æœåŠ¡ç½‘å…³æ˜¯ä»€ä¹ˆ</h3><p>å¾®æœåŠ¡ç½‘å…³æ˜¯ä¸€ä¸ªä½äºå¾®æœåŠ¡æ¶æ„å‰ç«¯çš„æœåŠ¡ï¼Œä½œä¸ºå®¢æˆ·ç«¯å’Œåç«¯å¾®æœåŠ¡ä¹‹é—´çš„ä¸­ä»‹ã€‚å®ƒçš„ä½œç”¨æ˜¯é›†ä¸­å¤„ç†å’Œç®¡ç†å¾®æœåŠ¡ç³»ç»Ÿçš„ä¸€äº›å…±äº«çš„éä¸šåŠ¡åŠŸèƒ½ï¼Œæä¾›ç»Ÿä¸€çš„å…¥å£ï¼ŒåŒæ—¶å¯ä»¥è¿›è¡Œè·¯ç”±ã€è½¬å‘ã€è¿‡æ»¤ã€ç›‘æ§ç­‰æ“ä½œã€‚</p><blockquote><p>Gateway çš„åŸºæœ¬åŠŸèƒ½</p></blockquote><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202312041349886.png" alt="image.png"></p><ol><li><strong>è·¯ç”±è½¬å‘ï¼š</strong><ul><li>ç½‘å…³è´Ÿè´£æ¥æ”¶å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œæ ¹æ®é…ç½®çš„è·¯ç”±è§„åˆ™å°†è¯·æ±‚è½¬å‘åˆ°ä¸åŒçš„å¾®æœåŠ¡ã€‚è¿™æœ‰åŠ©äºå®ç°å‰åç«¯çš„è§£è€¦ï¼Œä½¿å¾—å¾®æœåŠ¡å¯ä»¥ç‹¬ç«‹æ¼”è¿›ã€‚</li></ul></li><li><strong>æµé‡æ§åˆ¶ï¼š</strong><ul><li>ç½‘å…³å¯ä»¥å¯¹è¯·æ±‚è¿›è¡Œæµé‡æ§åˆ¶ï¼Œé™åˆ¶æ¯ä¸ªå¾®æœåŠ¡çš„è®¿é—®é¢‘ç‡ï¼Œé˜²æ­¢æŸä¸ªå¾®æœåŠ¡è¢«è¿‡åº¦è¯·æ±‚è€Œå½±å“æ•´ä½“ç³»ç»Ÿçš„ç¨³å®šæ€§ã€‚</li></ul></li><li><strong>ç†”æ–­ä¿æŠ¤ï¼š</strong><ul><li>ç½‘å…³å¯ä»¥å®ç°ç†”æ–­ä¿æŠ¤ï¼Œå½“æŸä¸ªå¾®æœåŠ¡å‡ºç°æ•…éšœæˆ–è¶…æ—¶æ—¶ï¼Œç½‘å…³å¯ä»¥å¿«é€Ÿæ‹¦æˆªè¯·æ±‚ï¼Œé¿å…è¯·æ±‚å †ç§¯å¯¼è‡´æ•´ä¸ªç³»ç»Ÿçš„å´©æºƒã€‚Sentinelæ˜¯ä¸€ç§ä¸“æ³¨äºæµé‡æ§åˆ¶ã€ç†”æ–­é™çº§ã€ç³»ç»Ÿè‡ªé€‚åº”ä¿æŠ¤çš„å¼€æºæ¡†æ¶ï¼Œå®ƒæä¾›äº†æ›´ä¸°å¯Œçš„ç†”æ–­ä¿æŠ¤åŠŸèƒ½ï¼Œå› æ­¤æœ‰äº›é¡¹ç›®é€‰æ‹©å¼•å…¥Sentinelæ¥å¢å¼ºç†”æ–­ä¿æŠ¤èƒ½åŠ›ã€‚</li></ul></li><li><strong>æ—¥å¿—ç›‘æ§ï¼š</strong><ul><li>ç½‘å…³é€šå¸¸ä¼šè®°å½•è¯·æ±‚å’Œå“åº”çš„æ—¥å¿—ä¿¡æ¯ï¼Œè¿™æœ‰åŠ©äºè¿›è¡Œç³»ç»Ÿçš„ç›‘æ§å’Œæ•…éšœæ’æŸ¥ã€‚ä¸šåŠ¡æ—¥å¿—å’Œé“¾è·¯è¿½è¸ªä¹Ÿæ˜¯é‡è¦çš„ç›‘æ§æ‰‹æ®µã€‚</li></ul></li><li><strong>å®‰å…¨è®¤è¯ï¼š</strong><ul><li>ç½‘å…³å¯ä»¥æä¾›å®‰å…¨è®¤è¯æœºåˆ¶ï¼Œç¡®ä¿åªæœ‰ç»è¿‡è®¤è¯å’Œæˆæƒçš„ç”¨æˆ·æ‰èƒ½è®¿é—®å¾®æœåŠ¡ã€‚è¿™å¯ä»¥é€šè¿‡é›†æˆæ¡†æ¶ï¼ˆå¦‚Spring Securityï¼‰æˆ–ä½¿ç”¨ä¸“é—¨çš„è®¤è¯æœåŠ¡æ¥å®ç°ã€‚</li></ul></li></ol><blockquote><p>å…³äº Gateway çš„ç†”æ–­ä¿æŠ¤åŠŸèƒ½çš„è¯´æ˜</p></blockquote><p>Spring Cloud Gatewayè‡ªèº«å…·å¤‡åŸºæœ¬çš„ç†”æ–­ä¿æŠ¤æœºåˆ¶ï¼Œå¯ä»¥åœ¨é…ç½®ä¸­è®¾ç½®æ–­è·¯å™¨çš„ä¸€äº›å‚æ•°ï¼Œä½†ç›¸å¯¹ç®€å•ã€‚å¯¹äºä¸€äº›æ›´å¤æ‚çš„ç†”æ–­ã€é™æµã€é™çº§ç­‰åœºæ™¯ï¼Œå¯èƒ½éœ€è¦å¼•å…¥ä¸“é—¨çš„æ¡†æ¶å¦‚Sentinelã€‚</p><p>åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œå¯ä»¥æ ¹æ®å…·ä½“çš„éœ€æ±‚æ¥é€‰æ‹©æ˜¯å¦å¼•å…¥Sentinelã€‚å¦‚æœé¡¹ç›®å¯¹ç†”æ–­ä¿æŠ¤ç­‰åŠŸèƒ½çš„éœ€æ±‚ç›¸å¯¹ç®€å•ï¼ŒGatewayçš„åŸºæœ¬ç†”æ–­ä¿æŠ¤è¶³å¤Ÿä½¿ç”¨ã€‚å¦‚æœéœ€è¦æ›´å¤æ‚çš„æµé‡æ§åˆ¶å’Œç†”æ–­é™çº§ç­–ç•¥ï¼Œå¼•å…¥Sentinelå¯èƒ½ä¼šæ›´ä¸ºåˆé€‚ã€‚</p><blockquote><p>æœåŠ¡ç½‘å…³å’Œæµé‡ç½‘å…³çš„åŒºåˆ«</p></blockquote><p>å¯¹äº Nginx å’Œ Gateway çš„ä¸¤è€…åŒºåˆ«ï¼š</p><p>æµé‡ç½‘å…³ï¼ˆå¦‚Nignx)æä¾›å…¨å±€æ€§çš„ã€ä¸åç«¯ä¸šåŠ¡åº”ç”¨æ— å…³çš„ç­–ç•¥ï¼Œä¾‹å¦‚ HTTPSè¯ä¹¦å¸è½½ã€Webé˜²ç«å¢™ã€å…¨å±€æµé‡ç›‘æ§ç­‰ã€‚</p><p>å¾®æœåŠ¡ç½‘å…³ï¼ˆå¦‚Spring Cloud Gatewayï¼‰æ˜¯æŒ‡ä¸ä¸šåŠ¡ç´§è€¦åˆçš„ã€æä¾›å•ä¸ªä¸šåŠ¡åŸŸçº§åˆ«çš„ç­–ç•¥ï¼Œå¦‚æœåŠ¡æ²»ç†ã€èº«ä»½è®¤è¯ç­‰ã€‚</p><p>æµé‡ç½‘å…³è´Ÿè´£å—åŒ—å‘æµé‡è°ƒåº¦åŠå®‰å…¨é˜²æŠ¤ï¼Œå¾®æœåŠ¡ç½‘å…³è´Ÿè´£ä¸œè¥¿å‘æµé‡è°ƒåº¦åŠæœåŠ¡æ²»ç†ã€‚</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202312041354467.png" alt="image.png|400"></p><h3 id="2ã€Gateway-çš„æ­å»ºå’Œä½¿ç”¨"><a href="#2ã€Gateway-çš„æ­å»ºå’Œä½¿ç”¨" class="headerlink" title="2ã€Gateway çš„æ­å»ºå’Œä½¿ç”¨"></a>2ã€Gateway çš„æ­å»ºå’Œä½¿ç”¨</h3><blockquote><p>ç½‘å…³çš„æ­å»º</p></blockquote><p>ç•¥</p><blockquote><p>Spring Cloud Gateway çš„é…ç½®é¡¹</p></blockquote><p>Spring Cloud Gatewayçš„æ ¸å¿ƒæ¦‚å¿µåŒ…æ‹¬è·¯ç”±ï¼ˆRouteï¼‰ã€æ–­è¨€ï¼ˆPredicateï¼‰å’Œè¿‡æ»¤å™¨ï¼ˆFilterï¼‰ã€‚</p><p>è¿™äº›æ¦‚å¿µå…±åŒæ„æˆäº†Gatewayçš„åŸºç¡€ï¼Œç”¨äºå®šä¹‰è¯·æ±‚çš„è·¯ç”±è§„åˆ™ã€è¯·æ±‚çš„åŒ¹é…æ¡ä»¶å’Œè¯·æ±‚çš„å¤„ç†æµç¨‹ã€‚</p><blockquote><p>è·¯ç”±</p></blockquote><p>è·¯ç”±å®šä¹‰äº†è¯·æ±‚åº”è¯¥è¢«å®šå‘åˆ°å“ªä¸ªç›®æ ‡æœåŠ¡ã€‚æ¯ä¸ªè·¯ç”±éƒ½åŒ…å«ä¸€ä¸ªå”¯ä¸€çš„IDã€ç›®æ ‡URIã€ä¸€ç»„æ–­è¨€å’Œè¿‡æ»¤å™¨ã€‚é€šè¿‡é…ç½®å¤šä¸ªè·¯ç”±ï¼Œå¯ä»¥å®ç°å¯¹è¯·æ±‚çš„åŠ¨æ€è·¯ç”±å’Œè´Ÿè½½å‡è¡¡ã€‚</p><figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs nestedtext"><span class="hljs-attribute">spring</span><span class="hljs-punctuation">:</span><br>  <span class="hljs-attribute">cloud</span><span class="hljs-punctuation">:</span><br>    <span class="hljs-attribute">gateway</span><span class="hljs-punctuation">:</span><br>      <span class="hljs-attribute">routes</span><span class="hljs-punctuation">:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-string">id: example</span><br>          <span class="hljs-attribute">uri</span><span class="hljs-punctuation">:</span> <span class="hljs-string">http://example.com</span><br>          <span class="hljs-attribute">predicates</span><span class="hljs-punctuation">:</span><br>            <span class="hljs-bullet">-</span> <span class="hljs-string">Path=/example/**</span><br>          <span class="hljs-attribute">filters</span><span class="hljs-punctuation">:</span><br>            <span class="hljs-bullet">-</span> <span class="hljs-string">StripPrefix=1</span><br></code></pre></td></tr></table></figure><p>ä¸Šè¿°é…ç½®è¡¨ç¤ºå°†ä»¥<code>/example/**</code>è·¯å¾„å¼€å¤´çš„è¯·æ±‚è½¬å‘åˆ°<code>http://example.com</code>ï¼Œå¹¶åœ¨è½¬å‘æ—¶å»æ‰è·¯å¾„çš„ç¬¬ä¸€ä¸ªæ®µï¼ˆStripPrefix&#x3D;1ï¼‰ã€‚</p><blockquote><p>æ–­è¨€</p></blockquote><p>æ–­è¨€å®šä¹‰äº†è¯·æ±‚åŒ¹é…çš„æ¡ä»¶ï¼Œå½“æ¡ä»¶æ»¡è¶³æ—¶ï¼Œå¯¹åº”çš„è·¯ç”±è§„åˆ™ç”Ÿæ•ˆã€‚æ–­è¨€å¯ä»¥åŸºäºè¯·æ±‚çš„è·¯å¾„ã€æ–¹æ³•ã€å¤´éƒ¨ä¿¡æ¯ç­‰è¿›è¡ŒåŒ¹é…ã€‚</p><blockquote><p>è¿‡æ»¤å™¨</p></blockquote><p>è¿‡æ»¤å™¨æ˜¯å¤„ç†è¯·æ±‚å’Œå“åº”çš„é€»è¾‘çš„ç»„ä»¶ï¼Œå®ƒä»¬å¯ä»¥ä¿®æ”¹è¯·æ±‚å’Œå“åº”ï¼Œå®ç°ä¸€äº›é¢å¤–çš„åŠŸèƒ½ï¼Œå¦‚æ·»åŠ å¤´ä¿¡æ¯ã€ä¿®æ”¹è¯·æ±‚ä½“ã€è¿›è¡Œè®¤è¯ç­‰</p><figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs nestedtext"><span class="hljs-attribute">spring</span><span class="hljs-punctuation">:</span><br>  <span class="hljs-attribute">cloud</span><span class="hljs-punctuation">:</span><br>    <span class="hljs-attribute">gateway</span><span class="hljs-punctuation">:</span><br>      <span class="hljs-attribute">routes</span><span class="hljs-punctuation">:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-string">id: example</span><br>          <span class="hljs-attribute">uri</span><span class="hljs-punctuation">:</span> <span class="hljs-string">http://example.com</span><br>          <span class="hljs-attribute">predicates</span><span class="hljs-punctuation">:</span><br>            <span class="hljs-bullet">-</span> <span class="hljs-string">Path=/example/**</span><br>          <span class="hljs-attribute">filters</span><span class="hljs-punctuation">:</span><br>            <span class="hljs-bullet">-</span> <span class="hljs-string">StripPrefix=1</span><br>            <span class="hljs-bullet">-</span> <span class="hljs-string">AddRequestHeader=X-Header=foo</span><br></code></pre></td></tr></table></figure><p>ä¸Šè¿°é…ç½®ä¸­çš„è¿‡æ»¤å™¨<code>AddRequestHeader=X-Header=foo</code>è¡¨ç¤ºåœ¨è½¬å‘è¯·æ±‚å‰ï¼Œå‘è¯·æ±‚å¤´ä¸­æ·»åŠ ä¸€ä¸ªåä¸º<code>X-Header</code>çš„å¤´ï¼Œå…¶å€¼ä¸º<code>foo</code>ã€‚</p><blockquote><p>Gatewayé›†æˆ nacos æ³¨å†Œä¸­å¿ƒå®ç°æœåŠ¡å‘ç°</p></blockquote><p>ç•¥</p><blockquote><p>Gateway æ•´åˆ Apollo å®ç°åŠ¨æ€è·¯ç”±é…ç½®</p></blockquote><p>ç•¥</p><blockquote><p>è‡ªå®šä¹‰å…¨å±€å¼‚å¸¸å¤„ç†å™¨</p></blockquote><p>to be continedâ€¦.</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://blog.csdn.net/yao583224426/article/details/122216804">https://blog.csdn.net/yao583224426/article/details/122216804</a></li><li><a href="https://cloud.tencent.com/developer/article/2135737">https://cloud.tencent.com/developer/article/2135737</a></li><li><a href="https://spring.io/projects/spring-cloud-gateway">https://spring.io/projects/spring-cloud-gateway</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>å¾®æœåŠ¡</category>
      
    </categories>
    
    
    <tags>
      
      <tag>springcloud</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringCloud_ç»„ä»¶åŸºæœ¬ä½¿ç”¨_Sentinel</title>
    <link href="/2023/12/04/SpringCloud_%E7%BB%84%E4%BB%B6%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8_Sentinel/"/>
    <url>/2023/12/04/SpringCloud_%E7%BB%84%E4%BB%B6%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8_Sentinel/</url>
    
    <content type="html"><![CDATA[<p>ä½¿ç”¨ç±»ä¼¼äº Sleuthï¼Œåœ¨å¯¹åº”æœåŠ¡æ·»åŠ ä¾èµ–å’Œæ³¨è§£é…ç½®åï¼ŒSentinel èƒ½å¤Ÿå¯¹æœåŠ¡åšä¸€ä¸ªæœåŠ¡æµé‡ç›‘å¬ï¼Œè¿›è¡Œç†”æ–­é™çº§ã€ç³»ç»Ÿè´Ÿè½½ç­‰æ“ä½œã€‚</p><p><strong>Sentinelæ§åˆ¶å°çš„ä¸‹è½½</strong></p><p>ä¸‹è½½åœ°å€ï¼š <a href="https://github.com/alibaba/Sentinel/releases/tag/1.8.3">https://github.com/alibaba/Sentinel/releases/tag/1.8.3</a></p><p>æ³¨æ„çš„ä¸€äº›å†…å®¹</p><ul><li>æ³¨è§£ä½¿ç”¨ï¼ˆæœåŠ¡ç¨‹åºä¸­ä½¿ç”¨ï¼‰</li><li>æµæ§è§„åˆ™</li><li>ç†”æ–­è§„åˆ™</li><li>ç³»ç»Ÿè§„åˆ™</li></ul><p>to be continedâ€¦.</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://blog.csdn.net/qq_36903261/article/details/106899215">https://blog.csdn.net/qq_36903261/article/details/106899215</a></li><li><a href="https://blog.csdn.net/qq_38374397/article/details/125603109">https://blog.csdn.net/qq_38374397/article/details/125603109</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>å¾®æœåŠ¡</category>
      
    </categories>
    
    
    <tags>
      
      <tag>springcloud</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RabbitMQçš„å®‰è£…ä¸ä½¿ç”¨</title>
    <link href="/2023/12/03/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97_RabbitMQ%E7%9A%84%E5%AE%89%E8%A3%85/"/>
    <url>/2023/12/03/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97_RabbitMQ%E7%9A%84%E5%AE%89%E8%A3%85/</url>
    
    <content type="html"><![CDATA[<h3 id="1ã€windowsä¸‹rabbitMQ-çš„å®‰è£…"><a href="#1ã€windowsä¸‹rabbitMQ-çš„å®‰è£…" class="headerlink" title="1ã€windowsä¸‹rabbitMQ çš„å®‰è£…"></a>1ã€windowsä¸‹rabbitMQ çš„å®‰è£…</h3><p>RabbitMQæœåŠ¡ç«¯ä»£ç æ˜¯ä½¿ç”¨å¹¶å‘å¼è¯­è¨€Erlangç¼–å†™çš„ï¼Œå®‰è£…Rabbit MQçš„å‰ææ˜¯éœ€è¦å®‰è£…ä¸€ä¸‹Erlang</p><p>Erlang ä¸‹è½½åœ°å€ï¼š <a href="https://www.erlang.org/downloads">https://www.erlang.org/downloads</a></p><p>ç¯å¢ƒå˜é‡é…ç½®</p><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs haml">ERLANG_HOME<br><span class="hljs-tag">%<span class="hljs-selector-tag">ERLANG_HOME</span></span>%\bin<br></code></pre></td></tr></table></figure><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231203233950.png" alt="image.png"></p><p>æ‰“å¼€ cmd è¾“å…¥ erl -version å‡ºç°ç‰ˆæœ¬å·å³å®‰è£…æˆåŠŸ</p><blockquote><p>RabbitMQ</p></blockquote><p>rabbitmq ä¸‹è½½åœ°å€ï¼š <a href="https://www.rabbitmq.com/download.html">https://www.rabbitmq.com/download.html</a></p><p>ä¸‹è½½è¿›è¡Œå®‰è£…æ“ä½œã€‚</p><p>CMD è¿›å…¥ç»ˆç«¯ è¿›å…¥åˆ°å®‰è£…ç›®å½• æ‰§è¡Œ rabbitmq-plugins enable rabbitmq_management å‘½ä»¤å®‰è£…ç®¡ç†é¡µé¢çš„æ’ä»¶ï¼Œ</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231203234341.png" alt="image.png"></p><p>å¯åŠ¨rabbitMQæœåŠ¡ï¼šrabbitmq-service.bat start</p><p>åŒå‡» rabbitmq-service.bat å³å®Œæˆå®‰è£…ã€‚ï¼ˆå…³é—­çš„è¯æ‰‹åŠ¨åœ¨æœåŠ¡åˆ—è¡¨è¿›è¡Œå…³é—­ä¸€ä¸‹ï¼‰</p><p>ç™»é™†ï¼š <a href="http://127.0.0.1:15672/">http://127.0.0.1:15672/</a></p><p>åˆå§‹çš„é»˜è®¤ç”¨æˆ·åŠå¯†ç éƒ½æ˜¯Â <code>guest</code>Â ï¼Œ è¾“å…¥åå³å¯ç™»å½•</p><h3 id="2ã€centos-ç³»ç»Ÿä¸‹-rabbitMQ-çš„å®‰è£…"><a href="#2ã€centos-ç³»ç»Ÿä¸‹-rabbitMQ-çš„å®‰è£…" class="headerlink" title="2ã€centos ç³»ç»Ÿä¸‹ rabbitMQ çš„å®‰è£…"></a>2ã€centos ç³»ç»Ÿä¸‹ rabbitMQ çš„å®‰è£…</h3><h4 id="RabbitMQ-æœåŠ¡å®‰è£…"><a href="#RabbitMQ-æœåŠ¡å®‰è£…" class="headerlink" title="RabbitMQ æœåŠ¡å®‰è£…"></a>RabbitMQ æœåŠ¡å®‰è£…</h4><p>ç•¥</p><h4 id="Dockerå®¹å™¨æ–¹å¼å®‰è£…RabbitMQ"><a href="#Dockerå®¹å™¨æ–¹å¼å®‰è£…RabbitMQ" class="headerlink" title="Dockerå®¹å™¨æ–¹å¼å®‰è£…RabbitMQ"></a>Dockerå®¹å™¨æ–¹å¼å®‰è£…RabbitMQ</h4><p>1ã€æ‹‰å–é•œåƒï¼ˆé»˜è®¤å®‰è£…æœ€æ–°ç‰ˆæœ¬ï¼‰</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">docker pull rabbitmq<br></code></pre></td></tr></table></figure><p>2ã€å¯åŠ¨RabbitMQå®¹å™¨</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">docker</span> run -d --hostname myRabbitMQ --name rabbit -p <span class="hljs-number">5672</span>:<span class="hljs-number">5672</span> -p <span class="hljs-number">15672</span>:<span class="hljs-number">15672</span> rabbitmq<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªå‘½ä»¤çš„ç»„æˆéƒ¨åˆ†è§£é‡Šå¦‚ä¸‹ï¼š</p><ul><li><code>docker run</code>ï¼šå¯åŠ¨ä¸€ä¸ªæ–°çš„å®¹å™¨ã€‚</li><li><code>-d</code>ï¼šä»¥å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼è¿è¡Œå®¹å™¨ï¼Œå³å®¹å™¨åœ¨åå°è¿è¡Œã€‚</li><li><code>--hostname myRabbitMQ</code>ï¼šä¸ºå®¹å™¨è®¾ç½®ä¸»æœºåï¼ˆ<code>myRabbitMQ</code>ï¼‰ã€‚ä½ å¯ä»¥æ ¹æ®éœ€è¦æ›´æ”¹è¿™ä¸ªå€¼ã€‚</li><li><code>--name rabbit</code>ï¼šè®¾ç½®å®¹å™¨çš„åç§°ï¼ˆ<code>rabbit</code>ï¼‰ã€‚è¿™ä¹Ÿå¯ä»¥æ ¹æ®ä½ çš„å‘½åçº¦å®šæ¥æ›´æ”¹ã€‚</li><li><code>-p 5672:5672</code>ï¼šå°†å®¹å™¨å†…éƒ¨çš„ 5672 ç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœºçš„ 5672 ç«¯å£ã€‚5672 ç«¯å£æ˜¯ RabbitMQ çš„é»˜è®¤AMQPç«¯å£ã€‚</li><li><code>-p 15672:15672</code>ï¼šå°†å®¹å™¨å†…çš„ 15672 ç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœºçš„ 15672 ç«¯å£ã€‚15672 ç«¯å£æ˜¯ RabbitMQ ç®¡ç†ç•Œé¢ï¼ˆManagement Consoleï¼‰çš„é»˜è®¤ç«¯å£ã€‚</li><li><code>rabbitmq</code>ï¼šæŒ‡å®šè¦ä½¿ç”¨çš„ Docker é•œåƒã€‚</li></ul><p>åœ¨ Docker å‘½ä»¤ä¸­ä½¿ç”¨ <code>-p</code> å‚æ•°æ¥æ˜ å°„ç«¯å£æ—¶ï¼Œæ ¼å¼ä¸º <code>-p &lt;å®¿ä¸»æœºç«¯å£&gt;:&lt;å®¹å™¨ç«¯å£&gt;</code>ã€‚</p><p>å¼€æ”¾ä¸€ä¸‹ç«¯å£</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">firewall-<span class="hljs-keyword">cmd</span><span class="language-bash"> --permanent --add-port=5672/tcp</span><br>firewall-<span class="hljs-keyword">cmd</span><span class="language-bash"> --permanent --add-port=15672/tcp</span><br>firewall-<span class="hljs-keyword">cmd</span><span class="language-bash"> --reload      <span class="hljs-comment"># é‡å¯é˜²ç«å¢™</span></span><br></code></pre></td></tr></table></figure><p>è®¿é—®æ§åˆ¶å°ç•Œé¢</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">http:</span><span class="hljs-comment">//linuxip:15672</span><br></code></pre></td></tr></table></figure><p>ç”¨æˆ·åå’Œå¯†ç é»˜è®¤éƒ½æ˜¯guest</p><p>3ã€å¼€å¯ Web ç•Œé¢ç®¡æ§å°æ’ä»¶</p><p>å¯¹äº Docker å®¹å™¨ä¸­çš„ RabbitMQ</p><p>å¦‚æœä½ æ˜¯é€šè¿‡ Docker å®¹å™¨è¿è¡Œ RabbitMQï¼Œå¹¶ä¸”æƒ³è¦å¯ç”¨ç®¡ç†æ§åˆ¶å°ï¼Œé€šå¸¸æœ€ç®€å•çš„æ–¹å¼æ˜¯ç›´æ¥ä½¿ç”¨å¸¦æœ‰ç®¡ç†æ’ä»¶çš„ RabbitMQ é•œåƒã€‚ä¾‹å¦‚ï¼š</p><p><code>docker run -d --hostname myRabbitMQ --name some-rabbit -p 5672:5672 -p 15672:15672 rabbitmq:3-management</code></p><p>åœ¨è¿™ä¸ªå‘½ä»¤ä¸­ï¼Œ<code>rabbitmq:3-management</code> é•œåƒå·²ç»åŒ…å«äº†ç®¡ç†æ’ä»¶ã€‚å¦‚æœä½ å·²ç»è¿è¡Œäº†ä¸€ä¸ªä¸åŒ…å«ç®¡ç†æ’ä»¶çš„ RabbitMQ å®¹å™¨ï¼Œä½ å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤å¯ç”¨ç®¡ç†æ’ä»¶ï¼š</p><ol><li><p>æ‰¾å‡ºä½ çš„ RabbitMQ å®¹å™¨çš„ ID æˆ–åç§°ï¼š</p><p> <code>docker ps</code></p></li><li><p>è¿›å…¥å®¹å™¨ï¼š</p><p> <code>docker exec -it [å®¹å™¨IDæˆ–åç§°] bash</code></p></li><li><p>åœ¨å®¹å™¨å†…éƒ¨ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥å¯ç”¨ç®¡ç†æ’ä»¶ï¼š</p><p> <code>rabbitmq-plugins enable rabbitmq_management</code></p></li><li><p>é€€å‡ºå®¹å™¨ï¼š</p><p> <code>exit</code></p></li><li><p>é‡å¯ RabbitMQ å®¹å™¨ä»¥åº”ç”¨æ›´æ”¹ã€‚</p></li></ol><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">docker</span> restart<span class="hljs-meta"> [å®¹å™¨åç§°æˆ–ID]</span><br></code></pre></td></tr></table></figure><p>ä¸€æ—¦å®Œæˆï¼Œä½ å°±å¯ä»¥é€šè¿‡<code>http://linuxip:15672</code></p><p>è®¿é—® RabbitMQ çš„ç®¡ç†ç•Œé¢ã€‚ç¡®ä¿ä½ å·²ç»å°† 15672 ç«¯å£æ˜ å°„åˆ°äº†å®¿ä¸»æœºä¸Šã€‚</p><hr><p>å‚è€ƒï¼š </p><ul><li><a href="https://blog.csdn.net/u011709538/article/details/131396367">https://blog.csdn.net/u011709538/article/details/131396367</a></li><li><a href="https://zhuanlan.zhihu.com/p/609676322?utm_id=0">https://zhuanlan.zhihu.com/p/609676322?utm_id=0</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>ä¸­é—´ä»¶</category>
      
      <category>MQ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>docker</tag>
      
      <tag>MQ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å‰ç«¯ä¾èµ–å¸¸è§æŠ¥é”™è§£å†³æ–¹æ¡ˆ</title>
    <link href="/2023/12/03/%E5%89%8D%E7%AB%AF%E4%BE%9D%E8%B5%96%E5%B8%B8%E8%A7%81%E6%8A%A5%E9%94%99%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/"/>
    <url>/2023/12/03/%E5%89%8D%E7%AB%AF%E4%BE%9D%E8%B5%96%E5%B8%B8%E8%A7%81%E6%8A%A5%E9%94%99%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/</url>
    
    <content type="html"><![CDATA[<blockquote><p>é—®é¢˜1ï¼š npmé”™è¯¯â€”â€”npm ERR! code ERESOLVE è§£å†³æ–¹æ³•</p></blockquote><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">npm ERR! code ERESOLVE<br>npm ERR! ERESOLVE unable to resolve dependency tree<br>npm ERR!<br>npm ERR! While resolving: vol.vue3@<span class="hljs-number">0.1</span>.<span class="hljs-number">0</span><br>npm ERR! Found: vue@<span class="hljs-number">3.2</span>.<span class="hljs-number">20</span><br>npm ERR! node_modules/vue<br>npm ERR!   vue@<span class="hljs-string">&quot;^3.0.0&quot;</span> from the root project<br>npm ERR!<br>npm ERR! Could not resolve dependency:<br>npm ERR! peer vue@<span class="hljs-string">&quot;^2.5.17&quot;</span> from element-ui@<span class="hljs-number">2.15</span>.<span class="hljs-number">6</span><br>npm ERR! node_modules/element-ui<br>npm ERR!   element-ui@<span class="hljs-string">&quot;*&quot;</span> from the root project<br>npm ERR!<br>npm ERR! Fix the upstream dependency conflict, or retry<br>npm ERR! this command with --force, or --legacy-peer-deps<br>npm ERR! to accept an incorrect (and potentially broken) dependency resolution.<br>npm ERR!<br>npm ERR! See C:\Users\Administrator\AppData\Local\npm-cache\eresolve-report.txt for a full report.<br> <br>npm ERR! A complete log of this run can be found in:<br>npm ERR!     C:\Users\Administrator\AppData\Local\npm-cache\_logs\<span class="hljs-number">2021</span>-<span class="hljs-number">10</span>-<span class="hljs-number">11</span>T06_27_44_908Z-debug.log<br></code></pre></td></tr></table></figure><p>åœ¨å®‰è£…ç»„ä»¶çš„æ—¶å€™å‡ºç°ä»¥ä¸Šé—®é¢˜ï¼Œnpmç‰ˆæœ¬é—®é¢˜æŠ¥é”™</p><p>è§£å†³æ–¹æ³•ï¼š</p><p>åœ¨å‘½ä»¤åé¢åŠ ä¸Š</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada"><span class="hljs-comment">--legacy-peer-deps</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>éƒ¨ç½²</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
      <tag>node</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Pythonç¯å¢ƒå®‰è£…</title>
    <link href="/2023/12/03/Python%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85/"/>
    <url>/2023/12/03/Python%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85/</url>
    
    <content type="html"><![CDATA[<h3 id="1ã€python-3-9-ç‰ˆæœ¬å®‰è£…"><a href="#1ã€python-3-9-ç‰ˆæœ¬å®‰è£…" class="headerlink" title="1ã€python 3.9 ç‰ˆæœ¬å®‰è£…"></a>1ã€python 3.9 ç‰ˆæœ¬å®‰è£…</h3><p>ä¸‹è½½åœ°å€ï¼š <a href="https://www.python.org/downloads/release/python-396/">https://www.python.org/downloads/release/python-396/</a></p><p>å‚è€ƒï¼š <a href="https://blog.csdn.net/qq_53280175/article/details/121107748">https://blog.csdn.net/qq_53280175/article/details/121107748</a></p><p>ä¸‹è½½é“¾æ¥ï¼š <a href="https://www.python.org/ftp/python/3.9.6/python-3.9.6-amd64.exe">https://www.python.org/ftp/python/3.9.6/python-3.9.6-amd64.exe</a></p><p>è¿™é‡Œä¸‹è½½çš„æ˜¯ win 64 ä½å®‰è£…ç‰ˆ</p><p>å®‰è£…çš„æ—¶å€™å‹¾é€‰ä¸€ä¸‹  Add Python 3.9 to PATH</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231203214357.png" alt="image.png"></p><p>é€‰æ‹©è‡ªå®šä¹‰å®‰è£…</p><p>æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸï¼Œcmd çª—å£è¾“å…¥ä¸€ä¸‹ <code>python</code> çœ‹ä¸€ä¸‹</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231203214605.png" alt="image.png"></p><h3 id="2ã€é™çº§pythonä¸º2-0-ç‰ˆæœ¬"><a href="#2ã€é™çº§pythonä¸º2-0-ç‰ˆæœ¬" class="headerlink" title="2ã€é™çº§pythonä¸º2.0 ç‰ˆæœ¬"></a>2ã€é™çº§pythonä¸º2.0 ç‰ˆæœ¬</h3><p>ç”±äºç‰ˆæœ¬å‰ç«¯é¡¹ç›® node-sass å®‰è£…å¤±è´¥ï¼Œéƒ¨åˆ†å»ºè®®æ˜¯é™çº§ Python ä¸º 2.x ç‰ˆæœ¬ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹å®é™…æ“ä½œã€‚</p><p>æ‰¾äº†ä¸€ä¸ª 2.7.2 ç‰ˆæœ¬ï¼š<a href="https://www.python.org/downloads/release/python-273/">https://www.python.org/downloads/release/python-273/</a></p><p>ä»ç„¶é€‰æ‹©å®‰è£…ç‰ˆæœ¬</p><p>å®‰è£…å®ŒæˆååŠ ä¸€ä¸‹ Path ç¯å¢ƒå˜é‡ï¼ˆåˆ é™¤ä¹‹å‰çš„ï¼‰</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">xxx\Pytho<span class="hljs-symbol">n27</span><br></code></pre></td></tr></table></figure><p>è¾“å…¥ <code>Python -V</code> éªŒè¯é‡Šæ”¾å®‰è£…æˆåŠŸ</p><p>å®é™…æ“ä½œåœ¨è¿™ä¸€æ­¥è¾“å…¥åï¼Œæ²¡åæ˜ ï¼Œ<strong>ä½¿ç”¨å®Œæ•´è·¯å¾„è¿è¡Œ Python</strong> å´åˆæ˜¯æ­£å¸¸çš„</p><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs moonscript"><span class="hljs-name">D</span>:\<span class="hljs-number">02</span>_Soft\xxxxx\Python27\python.exe -V<br></code></pre></td></tr></table></figure><p>å®é™…çš„ä¸€ä¸ªæ“ä½œï¼Œ<strong>éœ€è¦è®¾ç½®pathä¼˜å…ˆçº§ï¼ŒæŠŠpythonçš„è·¯å¾„æ”¾ç½®é¡¶éƒ¨</strong></p>]]></content>
    
    
    <categories>
      
      <category>éƒ¨ç½²</category>
      
    </categories>
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>linuxç³»ç»Ÿä¸‹ javaç¯å¢ƒå˜é‡çš„é…ç½®</title>
    <link href="/2023/12/03/linux%E7%B3%BB%E7%BB%9F%E4%B8%8BJava%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E7%9A%84%E9%85%8D%E7%BD%AE/"/>
    <url>/2023/12/03/linux%E7%B3%BB%E7%BB%9F%E4%B8%8BJava%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E7%9A%84%E9%85%8D%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<h3 id="linuxç³»ç»Ÿä¸‹-javaç¯å¢ƒå˜é‡çš„é…ç½®"><a href="#linuxç³»ç»Ÿä¸‹-javaç¯å¢ƒå˜é‡çš„é…ç½®" class="headerlink" title="linuxç³»ç»Ÿä¸‹ javaç¯å¢ƒå˜é‡çš„é…ç½®"></a>linuxç³»ç»Ÿä¸‹ javaç¯å¢ƒå˜é‡çš„é…ç½®</h3><p>è¾“å…¥<code>echo $JAVA_HOME</code>ç»“æœä¸ºç©ºï¼Œè¯´æ˜æ²¡æœ‰é…ç½®javaç¯å¢ƒå˜é‡</p><p>æŸ¥çœ‹yumå®‰è£…çš„jdkåœ¨å“ªä¸ªç›®å½•ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ls</span> -l /etc/alternatives/java<br></code></pre></td></tr></table></figure><p>é»˜è®¤å®‰è£…è·¯å¾„æ˜¯åœ¨ <code>/usr/lib/jvm</code></p><p>é…ç½®ç¯å¢ƒå˜é‡  <code>vim /etc/profile</code></p><p>è¿½åŠ å†…å®¹</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">export</span> <span class="hljs-attribute">JAVA_HOME</span>=/usr/local/lib/java/jdk1.8.0_231 <br><span class="hljs-built_in">export</span> <span class="hljs-attribute">JRE_HOME</span>=<span class="hljs-variable">$&#123;JAVA_HOME&#125;</span>/jre  <br><span class="hljs-built_in">export</span> <span class="hljs-attribute">CLASSPATH</span>=.:$&#123;JAVA_HOME&#125;/lib:<span class="hljs-variable">$&#123;JRE_HOME&#125;</span>/lib  <br><span class="hljs-built_in">export</span>  <span class="hljs-attribute">PATH</span>=<span class="hljs-variable">$&#123;JAVA_HOME&#125;</span>/bin:$PATH<br></code></pre></td></tr></table></figure><p>åˆ·æ–°ç¯å¢ƒå˜é‡é…ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">source</span> /etc/profile<br></code></pre></td></tr></table></figure><blockquote><p>å¸è½½é‡è£…</p></blockquote><p>å¸è½½å‚è€ƒï¼ˆLinuxä¸Šå¸è½½JDKï¼‰ï¼š <a href="https://blog.csdn.net/weixin_44990104/article/details/117589372">https://blog.csdn.net/weixin_44990104/article/details/117589372</a></p><p>linuxå®‰è£…jdk8è¯¦ç»†æ­¥éª¤ï¼Œå‚è€ƒï¼š <a href="https://blog.csdn.net/qq_33794744/article/details/107838128">https://blog.csdn.net/qq_33794744/article/details/107838128</a></p>]]></content>
    
    
    <categories>
      
      <category>éƒ¨ç½²</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
      <tag>jdk</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>centos7 å®‰è£… nacos æ“ä½œ</title>
    <link href="/2023/12/03/centos7%E5%AE%89%E8%A3%85nacos%E6%93%8D%E4%BD%9C/"/>
    <url>/2023/12/03/centos7%E5%AE%89%E8%A3%85nacos%E6%93%8D%E4%BD%9C/</url>
    
    <content type="html"><![CDATA[<h3 id="centos7-å®‰è£…-nacos-æ“ä½œ"><a href="#centos7-å®‰è£…-nacos-æ“ä½œ" class="headerlink" title="centos7 å®‰è£… nacos æ“ä½œ"></a>centos7 å®‰è£… nacos æ“ä½œ</h3><p>å‰æéœ€è¦ï¼šé¡¹ç›®è¿è¡Œç¯å¢ƒéœ€è¦å®‰è£… nacos </p><p>åœ¨ centos ä¸­è¿›è¡Œå®‰è£…nacosï¼Œè¿™é‡Œæ¼”ç¤ºå®‰è£…ç‰ˆæœ¬æ˜¯ 1.3.2ï¼Œ</p><p>ä¸‹è½½åœ°å€ï¼š <a href="https://github.com/alibaba/nacos/releases/tag/1.3.2">https://github.com/alibaba/nacos/releases/tag/1.3.2</a></p><p>nacos è¿è¡Œéœ€è¦å…ˆå®‰è£…ä¸€ä¸‹ JDK ç¯å¢ƒï¼Œæ³¨æ„ä¸€ä¸‹</p><p>å¯ä»¥è‡ªå·±ç‚¹å‡»ä¸‹è½½   <code>nacos-server-1.3.2.tar.gz</code></p><p>æˆ–è€…åœ¨ Linuxç³»ç»Ÿä¸­ä¸‹è½½å‘½ä»¤ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">wget</span> https://github.com/alibaba/nacos/releases/download/<span class="hljs-number">1</span>.<span class="hljs-number">3</span>.<span class="hljs-number">2</span>/nacos-server-<span class="hljs-number">1</span>.<span class="hljs-number">3</span>.<span class="hljs-number">2</span>.tar.gz<br></code></pre></td></tr></table></figure><p>ä¸‹è½½å®Œå‹ç¼©åŒ…ä¹‹åï¼Œä¸Šä¼ æŒ‡æœåŠ¡å™¨ä»»æ„ç›®å½•ï¼Œè¿›è¡Œè§£å‹</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">tar</span> -zxvf nacos-server-<span class="hljs-number">1</span>.<span class="hljs-number">3</span>.<span class="hljs-number">2</span>.tar.gz<br></code></pre></td></tr></table></figure><p>è§£å‹åä¼šç”Ÿæˆ nacos æ–‡ä»¶å¤¹ï¼Œè¿›å…¥åˆ° nacos ç›®å½•ï¼Œè¾“å…¥å‘½ä»¤å¯åŠ¨(ä»¥å•æœºçš„å½¢å¼å¯åŠ¨)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">bin/startup.sh -m standalone<br></code></pre></td></tr></table></figure><p>å¦‚æœéœ€è¦æŒä¹…åŒ– é…ç½®åˆ°mysqlï¼Œåˆ™è°ƒæ•´nacosçš„é…ç½®</p><p>å¦‚æœä½ çš„æœåŠ¡å™¨å¼€äº†é˜²ç«å¢™ï¼Œåˆ™éœ€è¦å¼€æ”¾ç›¸åº”çš„ç«¯å£</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-comment">#å¼€æ”¾ç«¯å£</span><br>firewall-cmd <span class="hljs-params">--zone=public</span> <span class="hljs-params">--add-port=8848/tcp</span> <span class="hljs-params">--permanent</span> <br><span class="hljs-comment"># é‡å¯é˜²ç«å¢™ </span><br>firewall-cmd <span class="hljs-params">--reload</span><br><span class="hljs-comment"># æŸ¥çœ‹å¼€æ”¾çš„ç«¯å£åˆ—è¡¨ </span><br>firewall-cmd <span class="hljs-params">--list-port</span><br></code></pre></td></tr></table></figure><p>nacosé»˜è®¤çš„å¯åŠ¨ç«¯å£æ˜¯ 8848ï¼Œè®¿é—®Â <code>http://ip:ç«¯å£/nacos</code>Â å³å¯çœ‹åˆ°ç™»å½•é¡µé¢.é»˜è®¤çš„ç”¨æˆ·åå¯†ç æ˜¯Â <code>nacos/naocs</code>ï¼Œç™»å½•å³å¯ä½¿ç”¨</p>]]></content>
    
    
    <categories>
      
      <category>Records</category>
      
    </categories>
    
    
    <tags>
      
      <tag>nacos</tag>
      
      <tag>linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å†…ç½‘ç©¿é€å·¥å…·Neutrino-Proxy</title>
    <link href="/2023/12/01/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E5%B7%A5%E5%85%B7Neutrino-Proxy/"/>
    <url>/2023/12/01/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E5%B7%A5%E5%85%B7Neutrino-Proxy/</url>
    
    <content type="html"><![CDATA[<p>ä¸€æ¬¾ç®€å•æ˜“ç”¨çš„å†…ç½‘ç©¿é€ä½¿ç”¨å·¥å…·</p><p>å®˜ç½‘ï¼š <a href="https://neutrino-proxy.dromara.org/">https://neutrino-proxy.dromara.org/</a></p><p>é¡¹ç›®åœ°å€ï¼š <a href="https://gitee.com/dromara/neutrino-proxy/releases">https://gitee.com/dromara/neutrino-proxy/releases</a></p><p>éƒ¨ç½²æ–¹å¼æœ‰ä¸‰ç§ï¼Œè¿™é‡Œé€šè¿‡åŸç”Ÿéƒ¨ç½²çš„æ–¹å¼è¿›è¡Œå¯åŠ¨</p><p>åŸç”Ÿéƒ¨ç½²çš„æ–¹å¼éœ€è¦ä¸‹è½½zipåŒ…ï¼Œè¿›è¡Œè§£å‹ï¼Œç„¶åå¯åŠ¨ exe æ–‡ä»¶ã€‚éƒ¨åˆ†exeç¨‹åºåŒä¸€ç›®å½•ä¸‹æœ‰Pom.xmlé…ç½®æ–‡ä»¶ï¼Œå¯è¿›è¡Œä¿®æ”¹å¯¹åº”é…ç½®ã€‚</p><p>æœåŠ¡å™¨ä¸‹è½½<code>neutrino-proxy-server-ubuntu-20.04-native.zip</code>æ–‡ä»¶ï¼Œ</p><p>å®¢æˆ·ç«¯ä¸‹è½½<code>neutrino-proxy-client-windows-2022-native.zip</code></p><blockquote><p>éƒ¨ç½²æœåŠ¡å™¨ç«¯</p></blockquote><p>é»˜è®¤å…ˆé‡‡ç”¨åŸç”Ÿé…ç½®h2æ•°æ®åº“ï¼Œå®é™…ä½¿ç”¨ä¸­ï¼Œä¸ªäººä½¿ç”¨çš„æ˜¯h2æ•°æ®åº“ï¼ˆè¿™ç§æ•°æ®åº“çš„ç¼ºç‚¹æ˜¯æ•°æ®æ”¾åœ¨å†…å­˜ä¸­ï¼Œå¦‚æœéœ€è¦æŒä¹…åŒ–æ”¾åˆ°æœ¬åœ°ï¼Œå»ºè®®ä¿®æ”¹é…ç½®ä¸º mysql æ•°æ®åº“ï¼‰</p><p>å®é™…æ“ä½œï¼š</p><p>1ã€å°†ä¸‹è½½æ–‡ä»¶å¤åˆ¶åˆ°æœåŠ¡å™¨çš„æŸä¸ªç›®å½•ä¸‹ï¼Œè¿›è¡Œè§£å‹æ“ä½œï¼š</p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs axapta">unzip  neutrino-proxy-<span class="hljs-keyword">server</span>-ubuntu<span class="hljs-number">-20.04</span>-native.zip<br><br><span class="hljs-meta">#å¯åŠ¨æœåŠ¡ç«¯å¯æ‰§è¡Œç¨‹åº</span><br>./neutrino-proxy-<span class="hljs-keyword">server</span><br></code></pre></td></tr></table></figure><ul><li>æœåŠ¡ç«¯éƒ¨ç½²æˆåŠŸåï¼Œè®¿é—®http:&#x2F;&#x2F;{æœåŠ¡ç«¯IP}:8888æ‰“å¼€åå°ç®¡ç†é¡µé¢ã€‚ä½¿ç”¨é»˜è®¤çš„ç®¡ç†å‘˜å¸å·ç™»å½•ï¼šadmin&#x2F;123456</li><li>æ‰“å¼€ä»£ç†é…ç½®&gt;Licenseç®¡ç†é¡µé¢ï¼Œç³»ç»Ÿå·²ç»è‡ªåŠ¨ä¸ºç®¡ç†å‘˜åˆå§‹åŒ–äº†ä¸€æ¡Licenseè®°å½•ï¼Œå¤åˆ¶è¯¥LicenseKeyå¤‡ç”¨ï¼Œåç»­å®¢æˆ·ç«¯é…ç½®éœ€è¦ã€‚</li></ul><p>2ã€å°† exe ç¨‹åºåå°è¿è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">nohup</span> ./neutrino-proxy-server &amp;<br></code></pre></td></tr></table></figure><p><code>nohup</code> å‘½ä»¤ç”¨äºå¿½ç•¥æŒ‚æ–­ä¿¡å·ï¼ˆSIGHUPï¼‰ï¼Œå¹¶ä¸” <code>&amp;</code> ç¬¦å·ç”¨äºå°†ç¨‹åºæ”¾åˆ°åå°è¿è¡Œã€‚</p><p><code>nohup.out</code> æ–‡ä»¶é€šå¸¸ä¼šç”Ÿæˆåœ¨ä½ è¿è¡Œ <code>nohup</code> å‘½ä»¤çš„å½“å‰å·¥ä½œç›®å½•ï¼ˆcurrent working directoryï¼‰ã€‚å¦‚æœä½ æ²¡æœ‰æŒ‡å®šå…·ä½“çš„è¾“å‡ºæ–‡ä»¶è·¯å¾„ï¼Œ<code>nohup</code> é»˜è®¤å°†è¾“å‡ºé‡å®šå‘åˆ° <code>nohup.out</code> æ–‡ä»¶</p><p>å…³é—­åå°ç¨‹åº</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-comment">#æŸ¥çœ‹è¿›ç¨‹å·PID</span><br>ps aux | <span class="hljs-keyword">grep</span> neutrino-proxy-server<br><span class="hljs-comment">#æ€æ­»è¿›ç¨‹</span><br><span class="hljs-keyword">kill</span> &lt;PID&gt;<br></code></pre></td></tr></table></figure><p>åå°è¿è¡Œçš„æ—¶å€™å‘ç°ä½¿ç”¨ xshell ç›´æ¥å¯åŠ¨ç¨‹åºä¼šéšç€å…³é—­ ssh è¿æ¥è€Œä¸­æ–­è¿è¡Œï¼Œè¿™é‡Œæ˜¯é‡‡ç”¨ screen + nohup çš„æ–¹å¼è¿è¡Œç¨‹åºã€‚</p><p>ä¸Šé¢è¿™ç§æ–¹å¼åœ¨å…³é—­ ssh è¿æ¥åï¼Œä¼šè¯ä¸­çš„è¿›ç¨‹å°±ç›´æ¥å…³é—­äº†ã€‚å°è¯•ä¸€ä¸‹ screen çš„ä½¿ç”¨</p><p><code>screen</code> æ˜¯ä¸€ä¸ªç»ˆç«¯å¤ç”¨å·¥å…·ï¼Œå®ƒå…è®¸ä½ åœ¨ä¸€ä¸ªç»ˆç«¯çª—å£ä¸­åˆ›å»ºå¤šä¸ªè™šæ‹Ÿç»ˆç«¯ï¼Œå¹¶åœ¨è¿™äº›è™šæ‹Ÿç»ˆç«¯ä¸­è¿è¡Œä¸åŒçš„ç¨‹åºã€‚é€šè¿‡ä½¿ç”¨ <code>screen</code>ï¼Œä½ å¯ä»¥åœ¨ä¸€ä¸ªä¼šè¯ä¸­ä¿æŒä½ çš„ç¨‹åºåœ¨åå°è¿è¡Œï¼Œå³ä½¿ä½ å…³é—­äº†SSHè¿æ¥ä¹Ÿä¸ä¼šå½±å“è¿™äº›ç¨‹åºçš„æ‰§è¡Œ</p><p>å®‰è£…</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake">sudo yum <span class="hljs-keyword">install</span> screen<br></code></pre></td></tr></table></figure><ol><li><p><strong>å¯åŠ¨ä¸€ä¸ªæ–°çš„ <code>screen</code> ä¼šè¯ï¼š</strong></p><p> <code>screen</code></p><p> è¿™å°†åˆ›å»ºä¸€ä¸ªæ–°çš„ <code>screen</code> ä¼šè¯ï¼Œå¹¶å°†ä½ åˆ‡æ¢åˆ°è¯¥ä¼šè¯ä¸­ã€‚</p></li><li><p><strong>åœ¨ <code>screen</code> ä¼šè¯ä¸­è¿è¡Œä½ çš„ç¨‹åºï¼š</strong></p><p> åœ¨ <code>screen</code> ä¼šè¯ä¸­ï¼Œä½ å¯ä»¥è¿è¡Œä½ çš„ç¨‹åºï¼Œæ¯”å¦‚ï¼š</p><p> <code>./your_program.exe</code></p><p> å¦‚æœä½ éœ€è¦åœ¨ç¨‹åºåå°è¿è¡Œï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>Ctrl + A</code> ç„¶åæŒ‰ä¸‹ <code>d</code> é”®ï¼Œè¿™ä¼šå°† <code>screen</code> ä¼šè¯æ”¾å…¥åå°ï¼Œä½†ä¼šè¯ä¸­çš„ç¨‹åºä»åœ¨è¿è¡Œã€‚</p></li><li><p><strong>åˆ—å‡º <code>screen</code> ä¼šè¯ï¼š</strong></p><p> <code>screen -ls</code></p><p> è¿™å°†æ˜¾ç¤ºå½“å‰æ‰€æœ‰çš„ <code>screen</code> ä¼šè¯ã€‚</p></li><li><p><strong>é‡æ–°è¿æ¥åˆ° <code>screen</code> ä¼šè¯ï¼š</strong></p><p> å¦‚æœä½ å…³é—­äº†ç»ˆç«¯æˆ–æ–­å¼€äº†SSHè¿æ¥ï¼Œä½ å¯ä»¥é‡æ–°è¿æ¥åˆ°ä¹‹å‰åˆ›å»ºçš„ <code>screen</code> ä¼šè¯ï¼š</p><p> <code>screen -r</code></p><p> å¦‚æœæœ‰å¤šä¸ªä¼šè¯ï¼Œä½ å¯èƒ½éœ€è¦æŒ‡å®šè¦è¿æ¥çš„ä¼šè¯IDï¼Œä¾‹å¦‚ï¼š</p><p> <code>screen -r &lt;session_id&gt;</code></p></li><li><p><strong>é€€å‡º <code>screen</code> ä¼šè¯ï¼š</strong></p><p> åœ¨ <code>screen</code> ä¼šè¯ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>exit</code> æˆ–è€… <code>Ctrl + D</code> æ¥é€€å‡ºã€‚</p></li></ol><p>è¿™æ˜¯ <code>screen</code> çš„åŸºæœ¬ç”¨æ³•ã€‚</p><blockquote><p>éƒ¨ç½²å®¢æˆ·ç«¯</p></blockquote><p>éœ€è¦ä¸‹è½½åä¿®æ”¹ä¸€ä¸‹é…ç½®æ–‡ä»¶</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">neutrino:</span><br>  <span class="hljs-attr">proxy:</span><br>    <span class="hljs-attr">tunnel:</span><br>      <span class="hljs-comment"># sslè¯ä¹¦å¯†é’¥ï¼ˆä½¿ç”¨jjaråŒ…å†…è‡ªå¸¦çš„è¯ä¹¦ï¼Œåˆ™æ­¤å¤„æ— éœ€ä¿®æ”¹ï¼‰</span><br>      <span class="hljs-attr">key-store-password:</span> <span class="hljs-number">123456</span><br>      <span class="hljs-comment"># sslè¯ä¹¦ç®¡ç†å¯†é’¥ï¼ˆä½¿ç”¨jjaråŒ…å†…è‡ªå¸¦çš„è¯ä¹¦ï¼Œåˆ™æ­¤å¤„æ— éœ€ä¿®æ”¹ã€‚è‡ªå®šä¹‰è¯ä¹¦ï¼Œåˆ™æ­¤å¤„é…ç½®å¯¹åº”çš„è·¯å¾„ï¼‰</span><br>      <span class="hljs-attr">jks-path:</span> <span class="hljs-string">classpath:/test.jks</span><br>      <span class="hljs-comment"># ä»£ç†æœåŠ¡ç«¯IP</span><br>      <span class="hljs-attr">server-ip:</span> <span class="hljs-string">xxxx</span><br>      <span class="hljs-comment"># ä»£ç†æœåŠ¡ç«¯IP, è‹¥æ˜¯ésslç«¯å£ï¼Œåˆ™ssl-enableéœ€è¦é…ç½®ä¸ºfalse</span><br>      <span class="hljs-attr">server-port:</span> <span class="hljs-number">9002</span><br>      <span class="hljs-comment"># æ˜¯å¦å¯ç”¨ssl</span><br>      <span class="hljs-attr">ssl-enable:</span> <span class="hljs-literal">true</span><br>      <span class="hljs-comment"># licenseKeyï¼Œå®¢æˆ·ç«¯å‡­è¯ã€‚æ­¤å¤„éœ€è¦é…ç½®åˆšåˆšä»ç®¡ç†åå°å¤åˆ¶çš„LicenseKey</span><br>      <span class="hljs-attr">license-key:</span> <span class="hljs-string">xxxx</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ä¸€ä¸ªæ³¨æ„çš„åœ°æ–¹å°±æ˜¯ 9002 è¿™ä¸ªç«¯å£ï¼Œéœ€è¦æˆ‘ä»¬å»çœ‹ä¸€ä¸‹æœåŠ¡å™¨ç«¯çš„é…ç½®æ–‡ä»¶å¯¹åº”çš„ç«¯å£ï¼Œå®ƒé»˜è®¤æ˜¯ 9002 ï¼Œéœ€è¦åœ¨é˜²ç«å¢™ç«¯å£å¼€å¯ä¸€ä¸‹ï¼Œ<strong>æˆ–è€…æ”¹ä¸€ä¸‹è¿™ä¸ªç«¯å£é…ç½®</strong></p><p>server-port  â†’  æœåŠ¡ç«¯ç«¯å£(å¯¹åº”æœåŠ¡ç«¯app.ymlä¸­çš„tunnel.portã€tunnel.ssl-port)</p><p>ç„¶åå¤åˆ¶ä¸€ä¸‹å®¢æˆ·ç«¯å‡­è¯å³å¯</p><p>å¦‚æœå‡ºç°é—®é¢˜ï¼Œå»ºè®®å…ˆåˆ æ‰æ–‡ä»¶é‡æ–°è§£å‹ï¼Œå†é…ç½®ä¸€éï¼Œé‡æ–°å¯åŠ¨ã€‚</p><p>Linux å®¢æˆ·ç«¯é…ç½®åŒç†ã€‚ï¼ˆæ³¨æ„æ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯å¯¹åº”ä¸€ä¸ªå‡­è¯ï¼‰</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">unzip</span>  neutrino-proxy-client-ubuntu-<span class="hljs-number">20</span>.<span class="hljs-number">04</span>-native.zip<br><span class="hljs-attribute">cd</span> neutrino-proxy-client-ubuntu-<span class="hljs-number">20</span>.<span class="hljs-number">04</span>-native<br><br><span class="hljs-attribute">screen</span><br><br><span class="hljs-attribute">nohup</span> ./neutrino-proxy-client &amp;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å·¥å…·</category>
      
    </categories>
    
    
    <tags>
      
      <tag>computer</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringCloud_ç»„ä»¶åŸºæœ¬ä½¿ç”¨_Zipkin</title>
    <link href="/2023/12/01/SpringCloud_%E7%BB%84%E4%BB%B6%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8_Sleuth+Zipkin/"/>
    <url>/2023/12/01/SpringCloud_%E7%BB%84%E4%BB%B6%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8_Sleuth+Zipkin/</url>
    
    <content type="html"><![CDATA[<h3 id="1ã€ä»€ä¹ˆæ˜¯-Sleuth"><a href="#1ã€ä»€ä¹ˆæ˜¯-Sleuth" class="headerlink" title="1ã€ä»€ä¹ˆæ˜¯ Sleuth"></a>1ã€ä»€ä¹ˆæ˜¯ Sleuth</h3><p>Sleuthæ˜¯Spring Cloudçš„ç»„ä»¶ä¹‹ä¸€ï¼Œå®ƒä¸ºSpring Cloudå®ç°äº†ä¸€ç§åˆ†å¸ƒå¼è¿½è¸ªè§£å†³æ–¹æ¡ˆã€‚</p><p>ä¸€èˆ¬æ˜¯å’Œ zipkin æˆ–è€…å…¶ä»–åŸºäºæ—¥å¿—çš„è¿½è¸ªç³»ç»Ÿä¸€èµ·ä½¿ç”¨çš„ã€‚</p><p>ç®€å•ç†è§£ï¼šsleuth æ˜¯é“¾è·¯è¿½è¸ªå™¨ï¼Œå°†é“¾è·¯ä¿¡æ¯æ”¾åˆ°æ—¥å¿—ä¸­ï¼Œzipkin æ˜¯é“¾è·¯åˆ†æå™¨ï¼Œå°†é“¾è·¯æ—¥å¿—è¿›è¡Œå¯è§†åŒ–åˆ†æå’Œèšåˆæ£€ç´¢ã€‚</p><h3 id="2ã€Zipkinæ˜¯ä»€ä¹ˆ"><a href="#2ã€Zipkinæ˜¯ä»€ä¹ˆ" class="headerlink" title="2ã€Zipkinæ˜¯ä»€ä¹ˆ"></a>2ã€Zipkinæ˜¯ä»€ä¹ˆ</h3><p>Zipkinæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼è¿½è¸ªç³»ç»Ÿã€‚å®ƒæœ‰åŠ©äºæ”¶é›†å¯¹æœåŠ¡æ¶æ„ä¸­çš„å»¶è¿Ÿé—®é¢˜è¿›è¡Œæ•…éšœæ’é™¤æ‰€éœ€çš„è®¡æ—¶æ•°æ®ã€‚åŠŸèƒ½åŒ…æ‹¬æ”¶é›†å’ŒæŸ¥æ‰¾è¿™äº›æ•°æ®ã€‚</p><p>Zipkin is a distributed tracing system. It helps gather timing data needed to troubleshoot latency problems in service architectures. Features include both the collection and lookup of this data.</p><p>åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œéšç€ä¸šåŠ¡çš„ä¸æ–­æ‰©å¼ ï¼ŒæœåŠ¡ä¹‹é—´äº’ç›¸è°ƒç”¨ä¼šè¶Šæ¥è¶Šå¤æ‚ã€‚è€ŒZipkinèƒ½æ”¶é›†æœåŠ¡ä¸­çš„ä¸€äº›æ•°æ®ï¼Œæˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡æ˜æ˜¾çš„å¯è§†åŒ–æ•ˆæœå»æŸ¥çœ‹é“¾è·¯ä¸­çš„æƒ…å†µï¼ˆæ”¯æŒæ—¥å¿—èšåˆï¼Œè¿›è¡Œå¯è§†åŒ–å±•ç¤ºå’Œå…¨æ–‡æ£€ç´¢ï¼‰ã€‚</p><p><strong>åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ªï¼ˆDistributed Tracingï¼‰</strong>ï¼š å°†ä¸€æ¬¡åˆ†å¸ƒå¼è¯·æ±‚è¿˜åŸæˆè°ƒç”¨é“¾è·¯ï¼Œè¿›è¡Œæ—¥å¿—è®°å½•ï¼Œæ€§èƒ½ç›‘æ§å¹¶å°†ä¸€æ¬¡åˆ†å¸ƒå¼è¯·æ±‚çš„è°ƒç”¨æƒ…å†µé›†ä¸­å±•ç¤ºã€‚æ¯”å¦‚å„ä¸ªæœåŠ¡èŠ‚ç‚¹ä¸Šçš„è€—æ—¶ã€è¯·æ±‚å…·ä½“åˆ°è¾¾å“ªå°æœºå™¨ä¸Šã€æ¯ä¸ªæœåŠ¡èŠ‚ç‚¹çš„è¯·æ±‚çŠ¶æ€ç­‰ç­‰ã€‚</p><p>å¸¸ç”¨çš„é“¾è·¯è¿½è¸ªæŠ€æœ¯è¿˜æœ‰å¥½å‡ ç§ï¼Œæœ‰å…´è¶£å¯ä»¥å»äº†è§£ä¸€ä¸‹ã€‚</p><ul><li><a href="https://skywalking.apache.org/zh/2020-04-19-skywalking-quick-start/">https://skywalking.apache.org/zh/2020-04-19-skywalking-quick-start/</a></li><li><a href="https://logging.apache.org/log4j/2.x/">https://logging.apache.org/log4j/2.x/</a></li><li><a href="https://github.com/pinpoint-apm/pinpoint">https://github.com/pinpoint-apm/pinpoint</a></li></ul><hr><h3 id="3ã€Sleuthå…¥é—¨"><a href="#3ã€Sleuthå…¥é—¨" class="headerlink" title="3ã€Sleuthå…¥é—¨"></a>3ã€Sleuthå…¥é—¨</h3><blockquote><p>Sleuth æœ¯è¯­</p></blockquote><ul><li>Trace (ä¸€æ¡å®Œæ•´é“¾è·¯â€“åŒ…å«å¾ˆå¤šspan(å¾®æœåŠ¡æ¥å£))<ul><li>ç”±ä¸€ç»„Trace Idï¼ˆè´¯ç©¿æ•´ä¸ªé“¾è·¯ï¼‰ç›¸åŒçš„Spanä¸²è”å½¢æˆä¸€ä¸ªæ ‘çŠ¶ç»“æ„ã€‚ä¸ºäº†å®ç°è¯·æ±‚è·Ÿè¸ªï¼Œå½“è¯·æ±‚åˆ°è¾¾åˆ†å¸ƒå¼ç³»ç»Ÿçš„å…¥å£ç«¯ç‚¹æ—¶ï¼Œåªéœ€è¦æœåŠ¡è·Ÿè¸ªæ¡†æ¶ä¸ºè¯¥è¯·æ±‚åˆ›å»ºä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ï¼ˆå³TraceIdï¼‰ï¼ŒåŒæ—¶åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿå†…éƒ¨æµè½¬çš„æ—¶å€™ï¼Œæ¡†æ¶å§‹ç»ˆä¿æŒä¼ é€’è¯¥å”¯ä¸€å€¼ï¼Œç›´åˆ°æ•´ä¸ªè¯·æ±‚çš„è¿”å›ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è¯¥å”¯ä¸€æ ‡è¯†å°†æ‰€æœ‰çš„è¯·æ±‚ä¸²è”èµ·æ¥ï¼Œå½¢æˆä¸€æ¡å®Œæ•´çš„è¯·æ±‚é“¾è·¯ã€‚</li></ul></li><li>Span<ul><li>ä»£è¡¨äº†ä¸€ç»„åŸºæœ¬çš„å·¥ä½œå•å…ƒã€‚ä¸ºäº†ç»Ÿè®¡å„å¤„ç†å•å…ƒçš„å»¶è¿Ÿï¼Œå½“è¯·æ±‚åˆ°è¾¾å„ä¸ªæœåŠ¡ç»„ä»¶çš„æ—¶å€™ï¼Œä¹Ÿé€šè¿‡ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ï¼ˆSpanIdï¼‰æ¥æ ‡è®°å®ƒçš„å¼€å§‹ã€å…·ä½“è¿‡ç¨‹å’Œç»“æŸã€‚é€šè¿‡SpanIdçš„å¼€å§‹å’Œç»“æŸæ—¶é—´æˆ³ï¼Œå°±èƒ½ç»Ÿè®¡è¯¥spançš„è°ƒç”¨æ—¶é—´ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è·å–å¦‚äº‹ä»¶çš„åç§°ã€‚è¯·æ±‚ä¿¡æ¯ç­‰å…ƒæ•°æ®ã€‚</li></ul></li><li>Annotation<ul><li>ç”¨å®ƒè®°å½•ä¸€æ®µæ—¶é—´å†…çš„äº‹ä»¶ï¼Œå†…éƒ¨ä½¿ç”¨çš„é‡è¦æ³¨é‡Šï¼š<ul><li>csï¼ˆClient Sendï¼‰å®¢æˆ·ç«¯å‘å‡ºè¯·æ±‚ï¼Œå¼€å§‹ä¸€ä¸ªè¯·æ±‚çš„ç”Ÿå‘½</li><li>srï¼ˆServer Receivedï¼‰æœåŠ¡ç«¯æ¥å—åˆ°è¯·æ±‚å¼€å§‹è¿›è¡Œå¤„ç†ï¼Œ srï¼cs &#x3D; ç½‘ç»œå»¶è¿Ÿï¼ˆæœåŠ¡è°ƒç”¨çš„æ—¶é—´ï¼‰</li><li>ssï¼ˆServer Sendï¼‰æœåŠ¡ç«¯å¤„ç†å®Œæ¯•å‡†å¤‡å‘é€åˆ°å®¢æˆ·ç«¯ï¼Œss - sr &#x3D; æœåŠ¡å™¨ä¸Šçš„è¯·æ±‚å¤„ç†æ—¶é—´</li><li>crï¼ˆClient Reveivedï¼‰å®¢æˆ·ç«¯æ¥å—åˆ°æœåŠ¡ç«¯çš„å“åº”ï¼Œè¯·æ±‚ç»“æŸã€‚ cr - sr &#x3D; è¯·æ±‚çš„æ€»æ—¶é—´</li></ul></li></ul></li></ul><blockquote><p>Sleuth ä½¿ç”¨</p></blockquote><p>åœ¨pom.xmlæ–‡ä»¶æ·»åŠ Sleuthä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"> <span class="hljs-comment">&lt;!--sleuthä¾èµ–--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-sleuth<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>é¡¹ç›®æ•´åˆ sleuth åï¼Œåœ¨æ—¥å¿—è¾“å‡ºä¼šå¤šä¸€äº›é“¾è·¯ä¿¡æ¯ã€‚</p><p>æˆ‘ä»¬åœ¨å¯åŠ¨è¿™ä¸ªå¾®æœåŠ¡åï¼Œè°ƒç”¨å…¶ä¸­æŸä¸ªè¯·æ±‚ï¼Œå¯ä»¥åœ¨æ§åˆ¶å°è§‚å¯Ÿåˆ°sleuthçš„æ—¥å¿—è¾“å‡º</p><h3 id="4ã€é“¾è·¯è§£å†³æ–¹æ¡ˆ-Sleuth-Zipkin"><a href="#4ã€é“¾è·¯è§£å†³æ–¹æ¡ˆ-Sleuth-Zipkin" class="headerlink" title="4ã€é“¾è·¯è§£å†³æ–¹æ¡ˆ SleuthÂ +Â Zipkin"></a>4ã€é“¾è·¯è§£å†³æ–¹æ¡ˆ <strong>Sleuth</strong>Â +Â <strong>Zipkin</strong></h3><p>ä½¿ç”¨ Zipkin éœ€è¦ä¸‹è½½ä¸€ä¸‹ä»–çš„æœåŠ¡ç«¯ï¼š <a href="https://zipkin.io/pages/quickstart.html">https://zipkin.io/pages/quickstart.html</a></p><p>å®˜æ–¹æ–‡æ¡£é‡Œé¢æœ‰ä»‹ç»ä»–å¯¹åº”çš„ä¸‹è½½å’Œå¯åŠ¨æ–¹å¼ã€‚</p><p>é€šè¿‡æµè§ˆå™¨è®¿é—®Â <a href="http://localhost:9411/">http://localhost:9411</a>è®¿é—®</p><p>Zipkin è·Ÿ Nacos ç±»ä¼¼ï¼Œéœ€è¦å¯åŠ¨ä»–çš„æœåŠ¡ç«¯ç¨‹åºï¼Œå¹¶åœ¨å¾®æœåŠ¡æ¨¡å—ä¸­æ·»åŠ å®¢æˆ·ç«¯ç›¸å…³çš„é…ç½®ã€‚</p><blockquote><p><strong>Sleuth</strong>Â +Â <strong>Zipkin</strong> é›†æˆ</p></blockquote><p>è¿™é‡Œæ˜¯é€‰ç”¨ ZipKinå®¢æˆ·ç«¯å’ŒSleuth è¿›è¡Œé›†æˆã€‚</p><p>ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-zipkin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>é…ç½®æ–‡ä»¶</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment">#é…ç½®zipkin</span><br>  <span class="hljs-attr">zipkin:</span><br>    <span class="hljs-attr">base-url:</span> <span class="hljs-string">http://192.168.31.60:9411</span><br>    <span class="hljs-attr">discovery-client-enabled:</span> <span class="hljs-literal">false</span>  <span class="hljs-comment"># ä¸è¦è®©nacosæŠŠzipkinæ³¨å†Œè¿›å»ï¼ˆå¯ä»¥ä¸å†™ï¼‰</span><br>  <span class="hljs-attr">sleuth:</span><br>    <span class="hljs-attr">sampler:</span><br>      <span class="hljs-attr">probability:</span> <span class="hljs-number">1.0</span><br></code></pre></td></tr></table></figure><p>å¯åŠ¨åï¼Œä¾¿å¯ä»¥åœ¨ Zipkin è§‚å¯Ÿè¯¥æœåŠ¡ä¸‹çš„è¯·æ±‚é“¾è·¯ã€‚</p><blockquote><p>æŒä¹…åŒ–æ“ä½œ</p></blockquote><p>Zipkin é»˜è®¤æ˜¯å°†æ•°æ®ä¿å­˜åˆ°å†…å­˜ï¼Œç”Ÿäº§ç¯å¢ƒä¸€èˆ¬æ˜¯é€‰æ‹©æŒä¹…åŒ–åˆ°æœ¬åœ°ã€‚</p><p><strong>Zipkin</strong>Â æä¾›å¯æ’æ‹”æ•°æ®å­˜å‚¨æ–¹å¼ï¼Œä¸‹é¢è¿™äº›éƒ½æ”¯æŒï¼šIn-Memoryã€MySqlã€Cassandra ä»¥åŠ Elasticsearchã€‚</p><blockquote><p>ä½¿ç”¨mysqlå®ç°æ•°æ®æŒä¹…åŒ–æ“ä½œ</p></blockquote><p>ç•¥ï¼Œå¾…æ›´æ–°</p><p>to be continedâ€¦.</p><hr><p>å‚è€ƒï¼š</p><ul><li><a href="https://zipkin.io/pages/quickstart">https://zipkin.io/pages/quickstart</a></li><li><a href="https://blog.csdn.net/qq_40587263/article/details/117338097">https://blog.csdn.net/qq_40587263/article/details/117338097</a></li><li><a href="https://zhuanlan.zhihu.com/p/71024024">https://zhuanlan.zhihu.com/p/71024024</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>å¾®æœåŠ¡</category>
      
    </categories>
    
    
    <tags>
      
      <tag>springcloud</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MongoDB_åŸºæœ¬æ“ä½œ</title>
    <link href="/2023/11/30/MongoDB_%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/"/>
    <url>/2023/11/30/MongoDB_%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/</url>
    
    <content type="html"><![CDATA[<p>mongodb çš„æ•°æ®åº“ä¸­çš„ä¸€ç§ï¼Œæ˜¯é¢å‘æ–‡æ¡£å­˜å‚¨çš„æ•°æ®åº“ï¼›</p><p>ä»–çš„æ¦‚å¿µå’Œå…³ç³»å‹æ•°æ®æœ‰äº›åŒºåˆ«ã€‚</p><p>è·Ÿ MySQL ç±»ä¼¼ï¼Œä»–èƒ½å¤Ÿæ‰§è¡Œ CRUDï¼Œäº‹åŠ¡ï¼Œç´¢å¼• ç­‰æ“ä½œã€‚</p><p>åœ¨æŠ€æœ¯é€‰å‹çš„æ—¶å€™ï¼Œå¯¹äºé«˜å¹¶å‘ã€æµ·é‡æ•°æ®è¯»å†™ã€é«˜å¯ç”¨ã€æå¯æ‰©å±•æœ‰éœ€æ±‚ï¼Œæ•°æ®é‡å¤§ï¼Œå†™å…¥é¢‘ç‡ï¼Œä»·å€¼è¾ƒä½ï¼Œå¯¹äº‹åŠ¡æ€§è¦æ±‚ä¸é«˜çš„æ—¶å€™ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ MongoDBæ¥å®ç°æ•°æ®çš„å­˜å‚¨ã€‚</p><h4 id="ä½“ç³»ç»“æ„"><a href="#ä½“ç³»ç»“æ„" class="headerlink" title="ä½“ç³»ç»“æ„"></a>ä½“ç³»ç»“æ„</h4><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311301336438.png" alt="image.png"></p><hr><p>å‚è€ƒ</p><ul><li><a href="https://blog.csdn.net/efew212efe/article/details/124524863">https://blog.csdn.net/efew212efe/article/details/124524863</a></li><li><a href="https://www.mongodb.com/docs/manual/">https://www.mongodb.com/docs/manual/</a></li><li><a href="https://www.runoob.com/mongodb/mongodb-tutorial.html">https://www.runoob.com/mongodb/mongodb-tutorial.html</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
      <category>MongoDB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mongodb</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>windowså¸¸ç”¨æ“ä½œ</title>
    <link href="/2023/11/30/windows%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/"/>
    <url>/2023/11/30/windows%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/</url>
    
    <content type="html"><![CDATA[<blockquote><p>windows_æŸ¥çœ‹ç«¯å£è¢«å ç”¨æƒ…å†µã€ç»“æŸè¿›ç¨‹</p></blockquote><p>æŸ¥çœ‹æŒ‡å®šç«¯å£å ç”¨æƒ…å†µï¼ˆç«¯å£å¼•å·æœ‰æ²¡æœ‰éƒ½å¯ä»¥ï¼Œæ­¤å¤„ä»¥5040ä¸ºä¾‹ï¼‰</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">netstat -aon<span class="hljs-string">|findstr 5040</span><br></code></pre></td></tr></table></figure><p>æ ¹æ®PIDæŸ¥çœ‹ç›¸åº”çš„è¿›ç¨‹æˆ–ç¨‹åº(ä¹Ÿå¯ä»¥ä»»åŠ¡ç®¡ç†å™¨æŸ¥çœ‹)</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">tasklist<span class="hljs-string">|findstr 5340</span><br></code></pre></td></tr></table></figure><p>ç»“æŸè¿›ç¨‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">taskkill /f /t /im è¿›ç¨‹å<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>æ“ä½œç³»ç»Ÿ</category>
      
      <category>Windows</category>
      
    </categories>
    
    
    <tags>
      
      <tag>windows</tag>
      
      <tag>computer</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>vimå¸¸ç”¨æ“ä½œ</title>
    <link href="/2023/11/29/vim%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/"/>
    <url>/2023/11/29/vim%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/</url>
    
    <content type="html"><![CDATA[<h4 id="é€€å‡ºç¼–è¾‘å™¨"><a href="#é€€å‡ºç¼–è¾‘å™¨" class="headerlink" title="é€€å‡ºç¼–è¾‘å™¨"></a>é€€å‡ºç¼–è¾‘å™¨</h4><ul><li>wqï¼šä¿å­˜å½“å‰æ–‡ä»¶å¹¶é€€å‡º</li><li>wqaï¼šä¿å­˜æ‰€æœ‰æ–‡ä»¶å¹¶é€€å‡º</li><li>q!ï¼š ä¸ä¿å­˜ï¼Œå¼ºåˆ¶é€€å‡º</li><li>qa!ï¼š æœ‰å¤šä¸ªæ–‡ä»¶è¢«æ‰“å¼€ï¼ŒåŒæ—¶é€€å‡º</li></ul><hr><p>å‚è€ƒ</p><ul><li><a href="https://zhuanlan.zhihu.com/p/89042423">https://zhuanlan.zhihu.com/p/89042423</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>æ“ä½œç³»ç»Ÿ</category>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
      <tag>vim</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Springå­¦ä¹ _åŸºç¡€å†…å®¹</title>
    <link href="/2023/11/27/Spring%E5%AD%A6%E4%B9%A0_%E5%9F%BA%E7%A1%80%E5%86%85%E5%AE%B9/"/>
    <url>/2023/11/27/Spring%E5%AD%A6%E4%B9%A0_%E5%9F%BA%E7%A1%80%E5%86%85%E5%AE%B9/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å¤§çº²</p></blockquote><ul><li>Spring æ¦‚å¿µ</li><li>å¸¸ç”¨æ¨¡å—</li><li>IOC</li><li>AOP</li><li>Spring äº‹åŠ¡</li><li>Spring MVC</li></ul><blockquote><p>ä»€ä¹ˆæ˜¯Spring</p></blockquote><p>Spring æ˜¯ä¸€ä¸ªè½»é‡çº§çš„å¼€æºJavaå¼€å‘æ¡†æ¶ï¼Œæ—¨åœ¨æé«˜å¼€å‘äººå‘˜çš„å¼€å‘æ•ˆç‡ä»¥åŠç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§ã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬å¸¸è¯´çš„ Spring æ¡†æ¶æŒ‡çš„æ˜¯ Spring Framework, ä»–æ˜¯å¤šæ¨¡å—çš„ä¸€ä¸ªé›†åˆï¼Œè¿™äº›æ¨¡å—èƒ½å¤Ÿæ¯”è¾ƒæ–¹ä¾¿çš„å¸®åŠ©æˆ‘ä»¬æ¥è¿›è¡Œå¼€å‘ã€‚</p><p>Spring æœ‰å¾ˆå¤šç‰¹æ€§ï¼Œä¹Ÿæ”¯æŒå¾ˆå¤šåŠŸèƒ½ï¼Œäº†è§£Spring æ¡†æ¶ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šä»å®ƒæ”¯æŒçš„ IOC å’Œ AOP è¿™ä¸¤ä¸ªæ ¸å¿ƒåŠŸèƒ½æ¥æœ€å¼€å§‹è®¤è¯†å®ƒã€‚</p><p><strong>ç›®å‰Spring æœ€å¤§çš„ä¸€ä¸ªä¼˜åŠ¿æ˜¯å®ƒæ„å»ºäº†ä¸€ä¸ªéå¸¸ä¸é”™çš„Javaç”Ÿæ€ï¼Œä½ èƒ½å¤Ÿåœ¨è¿™é‡Œé¢æ‰¾åˆ°ä¸åŒéœ€æ±‚éœ€è¦çš„å¤„ç†æ–¹æ¡ˆã€‚</strong></p><p>Spring çš„å®˜ç½‘ï¼š <a href="https://spring.io/">https://spring.io/</a></p><p>Githubåœ°å€ï¼š <a href="https://github.com/spring-projects/spring-framework">https://github.com/spring-projects/spring-framework</a></p><p>Spring çš„å…·ä½“æ¨¡å—å¯ä»¥æ”¾åé¢äº†è§£ï¼Œä¸»è¦æ¨¡å—äº†è§£ä¸‹ã€‚</p><p>Spring 5.x ä¸»è¦æ¨¡å—</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231201212051.png" alt="image.png"><br>å„ä¸ªæ¨¡å—çš„ä¾èµ–å…³ç³»</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231201212107.png" alt="image.png"></p><blockquote><p>Core Container</p></blockquote><p>å…¶ä¸­ä¸»è¦æ¨¡å—ä¸­ï¼ŒCore Container  æ˜¯ Spring æ¡†æ¶çš„æ ¸å¿ƒæ¨¡å—ï¼Œä¹Ÿæ˜¯åŸºç¡€æ¨¡å—ï¼Œå®ƒæä¾›äº† IOC çš„ä¾èµ–æ³¨å…¥åŠŸèƒ½ï¼ŒSpring çš„<strong>å…¶ä»–æ¨¡å—å®ç°çš„åŠŸèƒ½ä¹Ÿæ˜¯åœ¨ä¾èµ–è¯¥æ¨¡å—çš„åŸºç¡€ä¸Šè¿›è¡Œå®ç°çš„</strong>ã€‚</p><p>Core Container çš„å­æ¨¡å—ï¼š</p><ul><li><strong>spring-core</strong>ï¼šSpring æ¡†æ¶åŸºæœ¬çš„æ ¸å¿ƒå·¥å…·ç±»ã€‚</li><li><strong>spring-beans</strong>ï¼šæä¾›å¯¹ bean çš„åˆ›å»ºã€é…ç½®å’Œç®¡ç†ç­‰åŠŸèƒ½çš„æ”¯æŒã€‚</li><li><strong>spring-context</strong>ï¼šæä¾›å¯¹å›½é™…åŒ–ã€äº‹ä»¶ä¼ æ’­ã€èµ„æºåŠ è½½ç­‰åŠŸèƒ½çš„æ”¯æŒã€‚</li><li><strong>spring-expression</strong>ï¼šæä¾›å¯¹è¡¨è¾¾å¼è¯­è¨€ï¼ˆSpring Expression Languageï¼‰ SpEL çš„æ”¯æŒï¼Œåªä¾èµ–äº core æ¨¡å—ï¼Œä¸ä¾èµ–äºå…¶ä»–æ¨¡å—ï¼Œå¯ä»¥å•ç‹¬ä½¿ç”¨</li></ul><blockquote><p>AOP</p></blockquote><ul><li><strong>spring-aspects</strong>ï¼šè¯¥æ¨¡å—ä¸ºä¸ AspectJ çš„é›†æˆæä¾›æ”¯æŒã€‚</li><li><strong>spring-aop</strong>ï¼šæä¾›äº†é¢å‘åˆ‡é¢çš„ç¼–ç¨‹å®ç°ã€‚</li><li><strong>spring-instrument</strong>ï¼šæä¾›äº†ä¸º JVM æ·»åŠ ä»£ç†ï¼ˆagentï¼‰çš„åŠŸèƒ½ã€‚ å…·ä½“æ¥è®²ï¼Œå®ƒä¸º Tomcat æä¾›äº†ä¸€ä¸ªç»‡å…¥ä»£ç†ï¼Œèƒ½å¤Ÿä¸º Tomcat ä¼ é€’ç±»æ–‡ ä»¶ï¼Œå°±åƒè¿™äº›æ–‡ä»¶æ˜¯è¢«ç±»åŠ è½½å™¨åŠ è½½çš„ä¸€æ ·ã€‚(è¿™ä¸ªæ¨¡å—çš„ä½¿ç”¨åœºæ™¯éå¸¸æœ‰é™)</li></ul><hr><p>å‚è€ƒ</p><ul><li><a href="https://javaguide.cn/system-design/framework/spring/spring-knowledge-and-questions-summary.html">https://javaguide.cn/system-design/framework/spring/spring-knowledge-and-questions-summary.html</a></li><li><a href="https://www.pdai.tech/md/spring/spring.html">https://www.pdai.tech/md/spring/spring.html</a></li><li><a href="https://blog.csdn.net/Mixzi/article/details/123980213">https://blog.csdn.net/Mixzi/article/details/123980213</a></li><li><a href="https://www.moguit.cn/info/794">https://www.moguit.cn/info/794</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>æ¡†æ¶</category>
      
      <category>Spring</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>spring</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>windowsæ—§ç”µè„‘é‡è£…CentOs7ç³»ç»Ÿåˆ¶ä½œä¸ºä¸ªäººæœåŠ¡å™¨</title>
    <link href="/2023/11/26/%E6%97%A7%E7%94%B5%E8%84%91%E6%94%B9%E9%80%A0%E4%B8%BA%E4%B8%AA%E4%BA%BA%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    <url>/2023/11/26/%E6%97%A7%E7%94%B5%E8%84%91%E6%94%B9%E9%80%A0%E4%B8%BA%E4%B8%AA%E4%BA%BA%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
    
    <content type="html"><![CDATA[<p>å¦‚æœéœ€è¦å°†ä¸€å° winodws ç”µè„‘é‡è£…ä¸º centos ç³»ç»Ÿï¼Œéœ€è¦åˆ†ä¸ºä¸‹é¢å‡ æ­¥</p><ul><li>1ã€å…ˆå¯¹ windows è¿›è¡Œç£ç›˜æ ¼å¼åŒ–æ“ä½œ</li><li>2ã€é€šè¿‡ iso æ–‡ä»¶è¿›è¡Œå¯¹æŸä¸ªUç›˜åˆ»å½•æ“ä½œ</li><li>3ã€ç”µè„‘é€šè¿‡è¿™ä¸ªUç›˜è¿›è¡Œå®‰è£… centos ç³»ç»Ÿ</li><li>4ã€åŸºæœ¬é…ç½®ä¸ä½¿ç”¨</li></ul><p>å…·ä½“æ“ä½œè§å¦‚ä¸‹å†…å®¹ï¼š</p><h3 id="1ã€æ ¼å¼åŒ–windows-çš„ç›˜ç¬¦"><a href="#1ã€æ ¼å¼åŒ–windows-çš„ç›˜ç¬¦" class="headerlink" title="1ã€æ ¼å¼åŒ–windows çš„ç›˜ç¬¦"></a>1ã€æ ¼å¼åŒ–windows çš„ç›˜ç¬¦</h3><p>é‡æ–°å®‰è£… centos ç³»ç»Ÿå‰ï¼Œéœ€è¦åœ¨ window ç³»ç»Ÿä¸‹å…ˆè¿›å…¥PEç¯å¢ƒï¼Œå°†åŸæ¥è£…æœ‰Windowsç³»ç»Ÿçš„ç›˜ç¬¦ä½¿ç”¨åˆ†åŒºå·¥å…·æ ¼å¼åŒ–ä¸ºFAT32æ ¼å¼.</p><blockquote><p>åˆ¶ä½œUç›˜å¯åŠ¨ç›˜</p></blockquote><p>ä½¿ç”¨è€æ¯›æ¡ƒUç›˜å¯åŠ¨å·¥å…·åˆ¶ä½œUç›˜å¯åŠ¨ç›˜:  <a href="http://lmt.psydrj.com/udisk.html">http://lmt.psydrj.com/udisk.html</a></p><p>æ¨¡å¼é€‰æ‹©USBâ€”HDDï¼Œæ ¼å¼é€‰æ‹©â€œNTFSâ€ï¼›åˆ¶ä½œå®Œæˆåï¼Œå¯ä»¥é€‰æ‹©æ¨¡æ‹Ÿå¯åŠ¨æµ‹è¯•ï¼Œè‹¥èƒ½å¤Ÿè¿›å…¥è€æ¯›æ¡ƒwinpeä¸»èœå•ï¼Œå³è¡¨ç¤ºè€æ¯›æ¡ƒUç›˜å¯åŠ¨ç›˜åˆ¶ä½œæˆåŠŸã€‚ã€è¿™é‡Œä¸»è¦æ˜¯è¦ç”¨åˆ°ä»–çš„ç¬¬å››ä¸ª DiskGenius å·¥å…·ã€‘</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231126214740.png" alt="image.png"></p><p>é‡æ–°å¯åŠ¨ç”µè„‘ï¼Œè¿›å…¥bios</p><p>ç•Œé¢ä¼šè®©ä½ é€‰æ‹©ä¸€ä¸ª boot device ï¼Œä½ è¿™é‡Œæ ¹æ®è‹±æ–‡é€‰æ‹©ä¸€ä¸‹ U ç›˜å¯åŠ¨ï¼ˆç•Œé¢æ˜¯æ˜¾ç¤ºçš„Uç›˜åç§°ï¼‰</p><p>ç„¶åä¼šè¿›å…¥åˆ°ä¸Šé¢å›¾ç‰‡çš„å†…å®¹ï¼ˆé€‰æ‹©  DiskGenius ï¼‰</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231126220736.png" alt="image.png"></p><p>é€‰æ‹©å¿«é€Ÿåˆ†åŒºï¼Œé€‰æ‹©åˆ†åŒºç±»å‹FAT32ï¼Œé€‰æ‹© 1 ä¸ªåˆ†åŒºï¼Œ</p><h3 id="2ã€é‡è£…-centos-ç³»ç»Ÿ"><a href="#2ã€é‡è£…-centos-ç³»ç»Ÿ" class="headerlink" title="2ã€é‡è£… centos ç³»ç»Ÿ"></a>2ã€é‡è£… centos ç³»ç»Ÿ</h3><p>ä¸‹è½½å¥½ centos7 çš„é•œåƒæ–‡ä»¶ï¼š </p><ul><li><a href="https://man.linuxde.net/download/CentOS_7_4">https://man.linuxde.net/download/CentOS_7_4</a></li><li><a href="http://mirrors.aliyun.com/centos/7/isos/x86_64/">http://mirrors.aliyun.com/centos/7/isos/x86_64/</a></li></ul><h4 id="åˆ»å½•æ“ä½œ"><a href="#åˆ»å½•æ“ä½œ" class="headerlink" title="åˆ»å½•æ“ä½œ"></a>åˆ»å½•æ“ä½œ</h4><p>ä¸‹è½½ UltraISO è½¯ç¢Ÿé€š </p><p>æ ¼å¼åŒ–ä¹‹å‰çš„Uç›˜ï¼Œæ ¼å¼åŒ–ä¸º FAT32 æ–‡ä»¶ç³»ç»Ÿï¼ˆæˆ–è€…å‡†å¤‡ç¬¬äºŒä¸ªUç›˜ï¼‰</p><p>é€‰æ‹©å†™å…¥ç¡¬ç›˜æ˜ åƒ</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231126222516.png" alt="image.png"></p><p>å†™å…¥æ–¹å¼é»˜è®¤ï¼ˆUSB-HDD+ï¼‰ï¼Œå•å‡»ä¾¿æºå¯åŠ¨ï¼Œå•å‡»å†™å…¥æ–°çš„é©±åŠ¨å™¨å¼•å¯¼æ‰‡åŒºï¼Œå•å‡»Syslinuxã€‚</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231126222715.png" alt="image.png"></p><p>å®Œæ¯•åï¼Œå•å‡»ä¸‹æ–¹å†™å…¥ï¼Œç­‰å¾…è¿›åº¦æ¡æ»¡å†™å…¥å®Œæ¯•ã€‚</p><blockquote><p>è®°ï¼šä¸­é—´é‡åˆ°ä¸€æ¬¡ æç¤ºæ ¼å¼åŒ–é‡æ–°æ“ä½œ</p></blockquote><p>UltraISOçš„è½¯ä»¶æç¤ºå…¶å®æ˜¯å‡†ç¡®çš„ï¼Œä½†å´æ˜¯ç¨‹åºå‘˜æ€ç»´ä¸‹ç§‘å­¦ç´ å…»çº§åˆ«çš„æç¤ºã€‚è¿™é‡Œçš„å»ºè®®æ ¼å¼åŒ–Uç›˜åå†è¯•ï¼Œæ„æ€æ˜¯å»ºè®®ä½ åˆ é™¤æ‰€æœ‰åˆ†åŒºåé‡è¯•</p><p>è§£å†³å¤„ç†ï¼š</p><ul><li>1ã€ä¸‹è½½ DiskGenius æ ¼å¼åŒ–æ‰€æœ‰åˆ†åŒº </li><li>2ã€ç”¨win+Ræ‰“å¼€cmdï¼Œè¾“å…¥â€œdiskpartâ€    è¾“å…¥â€œlist diskâ€æŸ¥çœ‹æ‰€æœ‰ç£ç›˜   ä¾æ®å¤§å°é€‰ä¸­å¯¹åº”ç£ç›˜â€œselect disk xâ€    è¾“å…¥â€œcleanâ€åˆ é™¤æ‰€æœ‰åˆ†åŒº</li></ul><p>ç¬¬ä¸€ç§æ–¹å¼çš„ä¸‹è½½åœ°å€ï¼š <a href="https://xiazai.zol.com.cn/detail/33/327603.shtml">https://xiazai.zol.com.cn/detail/33/327603.shtml</a></p><p>æ ¼å¼åŒ–è½¬æ¢ç›˜ç¬¦ä¸ºFAT32æ ¼å¼</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231126234720.png" alt="image.png|500"></p><p>å®é™…æ“ä½œçš„æ—¶å€™æ˜¾ç¤ºè®¾å¤‡å†™å…¥é”™è¯¯ 55</p><p>ä¹Ÿè¯•äº†ä¸€ä¸‹ç½‘ä¸Šè¯´çš„é€šè¿‡ç®¡ç†å‘˜è¿è¡Œï¼Œæˆ–è€…ä¸Šé¢è¯´çš„æ ¼å¼åŒ–æ“ä½œï¼Œéƒ½ä¸è¡Œï¼›æœ€åé€šè¿‡ä¹°äº†ä¸€ä¸ªæ–°çš„ U ç›˜è§£å†³ã€‚</p><blockquote><p>é€šè¿‡ balenaEtcher è¿›è¡Œåˆ»å½•æ“ä½œ</p></blockquote><p>ä¸‹è½½åœ°å€ï¼š</p><ul><li><a href="https://www.ssdtop.com/balenaetcher.html">https://www.ssdtop.com/balenaetcher.html</a></li><li><a href="https://github.com/balena-io/etcher/releases">https://github.com/balena-io/etcher/releases</a></li></ul><p>ä¸‹è½½  balenaEtcher è¿›è¡Œåˆ»å½•æ“ä½œï¼Œè¿˜æ˜¯å¤±è´¥</p><p>çŒœæµ‹å¤§æ¦‚æ˜¯Uç›˜æœ‰é—®é¢˜ï¼Œæˆ–è€…æ¢ä¸€å°ç”µè„‘è¿›è¡Œæ“ä½œï¼›è¿™é‡Œé€‰æ‹©é‡æ–°è´­ä¹°ä¸€ä¸ªæ–°çš„ U ç›˜è¿›è¡Œæ“ä½œ</p><p>Laterâ€¦</p><p>æ–° Uç›˜ é€šè¿‡ DiskGenius æ ¼å¼åŒ–Uç›˜åˆ†åŒºï¼Œå†é€šè¿‡ UltraISO æˆåŠŸè¿›è¡Œäº†åˆ»å½•æ“ä½œã€‚</p><hr><h4 id="é‡è£…ç³»ç»Ÿ"><a href="#é‡è£…ç³»ç»Ÿ" class="headerlink" title="é‡è£…ç³»ç»Ÿ"></a>é‡è£…ç³»ç»Ÿ</h4><p>å°† U ç›˜ æ’å…¥éœ€è¦é‡è£…çš„ç”µè„‘å¹¶å¼€æœºã€‚å¦‚æœå·²ç»è®¾ç½®å®Œæ¯•ä»¥USBä¸ºç¬¬ä¸€å¯åŠ¨é¡¹ï¼Œåˆ™ä¸ç”¨å†æ¬¡è¿›å…¥biosç•Œé¢ã€‚</p><p>æ²¡æœ‰çš„è¯å†è¿›å…¥ä¸€æ¬¡ï¼Œé€šè¿‡ USB å¯åŠ¨ã€‚</p><blockquote><p>å®‰è£…æ“ä½œ</p></blockquote><ul><li>1ã€é€‰æ‹©Install CentOS 7</li><li>2ã€æŒ‰å›è½¦é”®</li><li>3ã€æˆåŠŸè¿›å…¥CentOSç³»ç»Ÿå›¾å½¢åŒ–çš„å®‰è£…ç•Œé¢åï¼Œè¿›è¡Œåˆå§‹åŒ–</li></ul><p>åˆå§‹åŒ–é…ç½®</p><ul><li>â‘ ä¸­æ–‡ï¼ˆè¯­è¨€ï¼‰</li><li>â‘¡è½¯ä»¶é€‰æ‹©ï¼šGNOMEæ¡Œé¢</li><li>â‘¢å®‰è£…ä½ç½®ï¼šé€‰æ‹©ç£ç›˜ï¼Œæ‰‹åŠ¨åˆ†åŒºï¼ˆé€‰æ‹©â€œæˆ‘è¦é…ç½®åˆ†åŒºâ€ï¼‰<ul><li>&#x2F;boot     ä¹Ÿå¯ä»¥ä¸æ·»åŠ      1G</li><li>&#x2F;swap   äº¤äº’åˆ†åŒº             2G</li><li>&#x2F;            æ ¹ç›®å½•ï¼Œåˆ†é…å‰©ä¸‹æ‰€æœ‰ç©ºé—´</li></ul></li></ul><blockquote><p>åˆå§‹åŒ–é…ç½®</p></blockquote><p>â‘¡è½¯ä»¶é€‰æ‹©</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231127234606.png" alt="image.png"></p><p>â‘¢æ·»åŠ æ–°æŒ‚è½½ç‚¹ &#x2F;boot</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231127234855.png" alt="image.png"></p><p><strong>è®¾ç½®å¥½åç‚¹å‡»å®Œæˆï¼Œé€‰æ‹©æ¥å—æ›´æ”¹</strong></p><blockquote><p>ç½‘ç»œä¸ä¸»æœºå</p></blockquote><p>ç½‘ç»œä¸ä¸»æœºåï¼š<strong>æ‰“å¼€ç½‘ç»œï¼Œè‡ªå·±è®¾ç½®ä¸€ä¸ªä¸»æœºåï¼Œç„¶åç‚¹å‡»å®Œæˆ</strong></p><blockquote><p>ç”¨æˆ·è®¾ç½®</p></blockquote><p>å¼€å§‹å®‰è£…</p><ul><li><strong>ç‚¹å‡»è®¾ç½®rootå¯†ç </strong></li><li>ç­‰å¾…è¿‡ç¨‹ä¸­å¯ä»¥ <strong>åˆ›å»ºä¸€ä¸ªæ™®é€šç”¨æˆ·</strong></li></ul><blockquote><p>é‡å¯ç”µè„‘åé…ç½®å†…å®¹</p></blockquote><p>é‡å¯ç”µè„‘</p><p><strong>é‡å¯åè¿›å…¥åˆå§‹è®¾ç½®ç•Œé¢ï¼Œæ¥å—è®¸å¯ï¼Œç„¶åç‚¹å‡»å®Œæˆé…ç½®</strong>  â†’ å®Œæˆé…ç½®</p><p><strong>ç­‰å¾…ï¼Œç„¶åæ¥åˆ°ç™»å½•é¡µé¢ï¼Œæˆ‘ä»¬é€‰æ‹©æœªåˆ—å‡ºï¼Œç„¶åè¾“å…¥rootå’Œrootçš„å¯†ç ï¼Œç„¶åç‚¹å‡»ç™»å½•ã€‚</strong></p><p><strong>æ¥åˆ°æ¡Œé¢ï¼Œæˆ‘ä»¬é€‰æ‹©è¯­è¨€ä¸ºä¸­æ–‡</strong></p><p><strong>å…³é—­ä½ç½®æœåŠ¡</strong></p><p>è·³è¿‡åœ¨çº¿è´¦å·</p><hr><h3 id="3ã€ä½¿ç”¨-windows-è®¿é—®åŒä¸€ä¸ªå±€åŸŸç½‘ä¸‹çš„-linux-ç³»ç»Ÿ"><a href="#3ã€ä½¿ç”¨-windows-è®¿é—®åŒä¸€ä¸ªå±€åŸŸç½‘ä¸‹çš„-linux-ç³»ç»Ÿ" class="headerlink" title="3ã€ä½¿ç”¨ windows è®¿é—®åŒä¸€ä¸ªå±€åŸŸç½‘ä¸‹çš„ linux ç³»ç»Ÿ"></a>3ã€ä½¿ç”¨ windows è®¿é—®åŒä¸€ä¸ªå±€åŸŸç½‘ä¸‹çš„ linux ç³»ç»Ÿ</h3><p>è®¾ç½®å®Œæˆåï¼Œè¿æ¥åŒä¸€ä¸ªwife</p><p>åœ¨ windows ä¸­ä½¿ç”¨ xshell&#x2F;termius å·¥å…·è®¿é—®å³å¯</p><h3 id="4ã€å†…ç½‘ç©¿é€çš„ä½¿ç”¨"><a href="#4ã€å†…ç½‘ç©¿é€çš„ä½¿ç”¨" class="headerlink" title="4ã€å†…ç½‘ç©¿é€çš„ä½¿ç”¨"></a>4ã€å†…ç½‘ç©¿é€çš„ä½¿ç”¨</h3><p>ç•¥</p><p>æš‚æœªæœ‰è¿™ä¸ªéœ€æ±‚ï¼Œåç»­è€ƒè™‘ä½¿ç”¨ã€‚</p><hr><p>å‚è€ƒï¼š</p><ul><li><a href="https://blog.csdn.net/m0_59302403/article/details/132119884">https://blog.csdn.net/m0_59302403/article/details/132119884</a></li><li><a href="https://blog.csdn.net/weixin_42292697/article/details/110285529">https://blog.csdn.net/weixin_42292697/article/details/110285529</a></li><li><a href="https://www.bilibili.com/video/BV1c3411T7Td">https://www.bilibili.com/video/BV1c3411T7Td</a></li><li><a href="https://blog.csdn.net/m0_51545690/article/details/123238360">https://blog.csdn.net/m0_51545690/article/details/123238360</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>Records</category>
      
    </categories>
    
    
    <tags>
      
      <tag>computer</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸ªäººåœ¨çº¿ç½‘ç›˜_ZFile</title>
    <link href="/2023/11/26/%E4%B8%AA%E4%BA%BA%E5%9C%A8%E7%BA%BF%E7%BD%91%E7%9B%98_ZFile/"/>
    <url>/2023/11/26/%E4%B8%AA%E4%BA%BA%E5%9C%A8%E7%BA%BF%E7%BD%91%E7%9B%98_ZFile/</url>
    
    <content type="html"><![CDATA[<p>çœ‹åˆ°æœ‰ä¸€ä¸ªè¿˜ä¸é”™çš„é¡¹ç›®ï¼Œæœ‰æ—¶å€™éœ€è¦å°†æ–‡ä»¶æ”¾ç½®åœ¨äº‘ç«¯ï¼Œè¿™é‡Œå­¦ä¹ ä½¿ç”¨ä¸€ä¸‹è¿™ä¸ªå·¥å…·ã€‚ï¼ˆæ”¯æŒé¢„è§ˆæ“ä½œï¼‰</p><p>é¡¹ç›®åœ°å€ï¼š <a href="https://github.com/zfile-dev/zfile">https://github.com/zfile-dev/zfile</a></p><p>éƒ¨ç½²æ–‡æ¡£åœ°å€ï¼š <a href="https://docs.zfile.vip/">https://docs.zfile.vip/</a></p><h3 id="1ã€é¡¹ç›®è¿è¡Œ"><a href="#1ã€é¡¹ç›®è¿è¡Œ" class="headerlink" title="1ã€é¡¹ç›®è¿è¡Œ"></a>1ã€é¡¹ç›®è¿è¡Œ</h3><p>ä¸‹è½½é¡¹ç›®åï¼Œéœ€è¦ç³»ç»Ÿé‡Œé¢æœ‰ JDK8 çš„ç¯å¢ƒ</p><blockquote><p>Centos ç³»ç»Ÿè¿è¡Œ</p></blockquote><blockquote><p>å®‰è£… JDK8</p></blockquote><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">yum</span> install -y java-<span class="hljs-number">1</span>.<span class="hljs-number">8</span>.<span class="hljs-number">0</span>-openjdk unzip<br></code></pre></td></tr></table></figure><blockquote><p>ä¸‹è½½å¹¶è§£å‹</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">export</span> ZFILE_INSTALL_PATH=~/zfile                        <span class="hljs-comment"># å£°æ˜å®‰è£…åˆ°çš„è·¯å¾„</span><br><span class="hljs-built_in">mkdir</span> -p <span class="hljs-variable">$ZFILE_INSTALL_PATH</span> &amp;&amp; <span class="hljs-built_in">cd</span> <span class="hljs-variable">$ZFILE_INSTALL_PATH</span>   <span class="hljs-comment"># åˆ›å»ºæ–‡ä»¶å¤¹å¹¶è¿›å…¥</span><br>wget --no-check-certificate https://c.jun6.net/ZFILE/zfile-release.war          <span class="hljs-comment"># ä¸‹è½½ zfile æœ€æ–°ç‰ˆ</span><br>unzip zfile-release.war &amp;&amp; <span class="hljs-built_in">rm</span> -rf zfile-release.war      <span class="hljs-comment"># è§£å‹å¹¶åˆ é™¤å‹ç¼©åŒ…</span><br><span class="hljs-built_in">chmod</span> +x <span class="hljs-variable">$ZFILE_INSTALL_PATH</span>/bin/*.sh                    <span class="hljs-comment"># æˆæƒå¯åŠ¨åœæ­¢è„šæœ¬</span><br></code></pre></td></tr></table></figure><p>ZFile æä¾›äº†ä¸€ä¸ª åœ¨çº¿ä¸‹è½½è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æœ¬åœ°ä¸‹è½½åè‡ªå®šä¹‰è®¾å¤‡æŸäº›å†…å®¹åï¼Œæ‰“åŒ…ä¸º war ï¼Œæ”¾ç½®åœ¨ linux ç³»ç»Ÿä¸Šè¿è¡Œã€‚</p><p>å¦‚éœ€ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œé…ç½®æ–‡ä»¶è·¯å¾„ä¸ºï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">~<span class="hljs-regexp">/zfile/</span>WEB-INF<span class="hljs-regexp">/classes/</span>application.properties<br></code></pre></td></tr></table></figure><hr><p>å®‰è£…è¯´æ˜</p><p>ä¸‹é¢å‘½ä»¤ä¸­ç¬¬ä¸€è¡Œè¡¨ç¤ºé»˜è®¤å®‰è£…åˆ°ç”¨æˆ·ç›®å½•ä¸‹:Â <code>~/zfile</code>Â ä¸‹ã€‚</p><p>å¯¹äºÂ <code>root</code>Â ç”¨æˆ·,Â <code>~</code>Â &#x3D;Â <code>/root</code>,Â <code>~/zfile</code>Â è¡¨ç¤ºåœ¨Â <code>/root/zfile</code>Â è·¯å¾„ä¸‹ã€‚</p><p>å¯¹äºå…¶ä»–ç”¨æˆ·,Â <code>~</code>Â &#x3D;Â <code>/home/ç”¨æˆ·å</code>Â è¡¨ç¤ºåœ¨Â <code>/home/ç”¨æˆ·å/</code>Â è·¯å¾„ä¸‹ã€‚å¦‚å¯¹äºÂ <code>oracle</code>Â ç”¨æˆ·,Â <code>~/zfile</code>Â åˆ™è¡¨ç¤ºå®‰è£…åœ¨Â <code>/home/oracle/zfile</code>Â ä¸‹ã€‚</p><p>å¦‚éœ€æ›´æ”¹å®‰è£…è·¯å¾„, è¯·è‡ªè¡Œä¿®æ”¹ï¼Œå¦‚Â <code>export ZFILE_INSTALL_PATH=/data/zfile</code>ï¼Œè¡¨ç¤ºå®‰è£…åœ¨Â <code>/data/zfile</code>Â è·¯å¾„ä¸‹ã€‚</p><hr><h3 id="2ã€å¯åŠ¨é¡¹ç›®"><a href="#2ã€å¯åŠ¨é¡¹ç›®" class="headerlink" title="2ã€å¯åŠ¨é¡¹ç›®"></a>2ã€å¯åŠ¨é¡¹ç›®</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">~<span class="hljs-regexp">/zfile/</span>bin/start.sh       <span class="hljs-comment"># å¯åŠ¨</span><br></code></pre></td></tr></table></figure><hr><p>å¯åŠ¨åæµè§ˆå™¨è®¿é—®Â <strong><code>http://ip:8080</code></strong>Â å³å¯ï¼Œå¦‚å¯åŠ¨åæ— æ³•è®¿é—®ï¼Œè¯·æ£€æŸ¥Â <strong><code>ç«¯å£æ˜¯å¦å†²çª</code></strong>Â æˆ–Â <code>é˜²ç«å¢™/å®‰å…¨ç»„æ˜¯å¦å¼€å¯</code>ã€‚</p><p>ç®€å•æ£€æŸ¥æ–¹å¼ä¸ºåœ¨æœåŠ¡å™¨æ‰§è¡ŒÂ <code>curl http://127.0.0.1:8080</code></p><ul><li>å¦‚è¿”å›Â <code>curl: (7) Failed connect to 127.0.0.1:8080; Connection refused</code>Â è¡¨ç¤ºæœªå¯åŠ¨æˆåŠŸã€‚</li><li>å¦‚è¿”å›Â <code>&lt;!DOCTYPE html&gt; &lt;html lang=&quot;zh-CN&quot;&gt;â€¦â€¦</code>Â ç­‰å­—æ ·è¡¨ç¤ºå¯åŠ¨æˆåŠŸï¼Œå¦‚å¯åŠ¨æˆåŠŸä½†é€šè¿‡æœåŠ¡å™¨ IP æ— æ³•è®¿é—®ï¼Œé‚£ä¸€èˆ¬å°±æ˜¯é˜²ç«å¢™&#x2F;å®‰å…¨ç»„æœªæ”¾è¡Œç«¯å£é—®é¢˜ã€‚</li></ul><hr><p>æ›´æ–°ç¨‹åºå‰åŠ¡å¿…åœæ­¢ç¨‹åºå†è¿›è¡Œæ“ä½œ</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">~<span class="hljs-regexp">/zfile/</span>bin/start.sh       <span class="hljs-comment"># å¯åŠ¨</span><br>~<span class="hljs-regexp">/zfile/</span>bin/stop.sh        <span class="hljs-comment"># åœæ­¢</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>é¡¹ç›®</category>
      
    </categories>
    
    
    <tags>
      
      <tag>project</tag>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Elasticsearch_åŸºç¡€å†…å®¹</title>
    <link href="/2023/11/26/Elasticsearch_%E5%9F%BA%E7%A1%80%E5%86%85%E5%AE%B9/"/>
    <url>/2023/11/26/Elasticsearch_%E5%9F%BA%E7%A1%80%E5%86%85%E5%AE%B9/</url>
    
    <content type="html"><![CDATA[<p><code>Elasticsearch</code>æ˜¯ä¸€ä¸ªå¼€æºçš„é«˜æ‰©å±•çš„åˆ†å¸ƒå¼å…¨æ–‡æ£€ç´¢å¼•æ“ï¼Œå®ƒå¯ä»¥è¿‘ä¹å®æ—¶çš„å­˜å‚¨ã€æ£€ç´¢æ•°æ®ï¼›æœ¬  èº«æ‰©å±•æ€§å¾ˆå¥½ï¼Œå¯ä»¥æ‰©å±•åˆ°ä¸Šç™¾å°æœåŠ¡å™¨ï¼Œå¤„ç†PBçº§åˆ«çš„æ•°æ®ã€‚</p><p>ESä¹Ÿä½¿ç”¨Javaå¼€å‘å¹¶ä½¿ç”¨Luceneä½œä¸ºå…¶æ ¸å¿ƒæ¥å® ç°æ‰€æœ‰ç´¢å¼•å’Œæœç´¢çš„åŠŸèƒ½ï¼Œå®ƒçš„ç›®çš„æ˜¯é€šè¿‡ç®€å•çš„RESTful APIæ¥éšè—Luceneçš„å¤æ‚æ€§ï¼Œä»è€Œè®©å…¨æ–‡æœç´¢å˜å¾—  ç®€å•ã€‚</p><blockquote><p>Elasticsearchæ¯”ä¼ ç»Ÿå…³ç³»å‹æ•°æ®åº“å¦‚ä¸‹ï¼š</p></blockquote><figure class="highlight node-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs node-repl"><span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript"><span class="hljs-title class_">Relational</span> <span class="hljs-variable constant_">DB</span> â€&gt; <span class="hljs-title class_">Databases</span> â€&gt; <span class="hljs-title class_">Tables</span> â€&gt; <span class="hljs-title class_">Rows</span> â€&gt; <span class="hljs-title class_">Columns</span>  </span><br><span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript"><span class="hljs-title class_">Elasticsearch</span> â€&gt; <span class="hljs-title class_">Indices</span> â€&gt; <span class="hljs-title class_">Types</span> â€&gt; <span class="hljs-title class_">Documents</span> â€&gt; <span class="hljs-title class_">Fields</span></span><br></code></pre></td></tr></table></figure><p>to be continedâ€¦..</p><p>å‚è€ƒ</p><ul><li><a href="https://elasticsearch.bookhub.tech/getting_started/">https://elasticsearch.bookhub.tech/getting_started/</a></li><li><a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html">https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html</a></li><li><a href="https://www.cnblogs.com/coderxz/p/13268417.html">https://www.cnblogs.com/coderxz/p/13268417.html</a></li><li><a href="https://zhuanlan.zhihu.com/p/516698885">https://zhuanlan.zhihu.com/p/516698885</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>ä¸­é—´ä»¶</category>
      
      <category>Elasticsearch</category>
      
    </categories>
    
    
    <tags>
      
      <tag>elasticsearch</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Vueå­¦ä¹ _åŸºç¡€å†…å®¹</title>
    <link href="/2023/11/26/Vue%E5%AD%A6%E4%B9%A0_%E5%9F%BA%E7%A1%80%E5%86%85%E5%AE%B9/"/>
    <url>/2023/11/26/Vue%E5%AD%A6%E4%B9%A0_%E5%9F%BA%E7%A1%80%E5%86%85%E5%AE%B9/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å¤§çº²</p></blockquote><ul><li>Vue åŸºç¡€</li><li>Vue è¯­æ³•</li><li>ç»„ä»¶åŒ–å¼€å‘</li><li>è·¯ç”±</li><li>webpack</li><li>è„šæ‰‹æ¶</li></ul><hr><p>å‚è€ƒ</p><ul><li><a href="https://cn.vuejs.org/">https://cn.vuejs.org/</a></li><li><a href="https://blog.csdn.net/fmk1023/article/details/111381876">https://blog.csdn.net/fmk1023/article/details/111381876</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
      <category>Vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
      <tag>vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Mavenå·¥å…·_åŸºç¡€ä½¿ç”¨</title>
    <link href="/2023/11/24/Maven%E5%B7%A5%E5%85%B7_%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/"/>
    <url>/2023/11/24/Maven%E5%B7%A5%E5%85%B7_%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h3 id="1ã€Maven-ä¸‹è½½ä¸å®‰è£…"><a href="#1ã€Maven-ä¸‹è½½ä¸å®‰è£…" class="headerlink" title="1ã€Maven ä¸‹è½½ä¸å®‰è£…"></a>1ã€Maven ä¸‹è½½ä¸å®‰è£…</h3><p>ç•¥</p><h3 id="2ã€Mavené…ç½®æ–‡ä»¶ä¿®æ”¹"><a href="#2ã€Mavené…ç½®æ–‡ä»¶ä¿®æ”¹" class="headerlink" title="2ã€Mavené…ç½®æ–‡ä»¶ä¿®æ”¹"></a>2ã€Mavené…ç½®æ–‡ä»¶ä¿®æ”¹</h3><blockquote><p>maven é…ç½®æ–‡ä»¶å†…å®¹</p></blockquote><p>è®¾ç½®æœ¬åœ°ä»“åº“è·¯å¾„</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--è®¾ç½®æœ¬åœ°ä»“åº“è·¯å¾„--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">localRepository</span>&gt;</span>D:\java\maven\localRepository<span class="hljs-tag">&lt;/<span class="hljs-name">localRepository</span>&gt;</span><br></code></pre></td></tr></table></figure><p>é…ç½®é˜¿é‡Œäº‘ç§æœï¼ˆæˆ–æ¢æˆè‡ªå·±å…¬å¸æ­å»ºçš„ç§æœï¼‰</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- åœ¨mirrorsæ ‡ç­¾é‡Œæ·»åŠ mirroræ ‡ç­¾ï¼Œå¹¶æŒ‡å®šé˜¿é‡Œäº‘ç§æœä¸‹è½½ä¾èµ–ä¼šå¿«ç‚¹ --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mirror</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>alimaven<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>aliyun maven<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/groups/public/<span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">mirrorOf</span>&gt;</span>central<span class="hljs-tag">&lt;/<span class="hljs-name">mirrorOf</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mirror</span>&gt;</span><br></code></pre></td></tr></table></figure><p>é…ç½® maven é»˜è®¤jdkç‰ˆæœ¬</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- åœ¨å·²æœ‰çš„profilesæ ‡ç­¾ä¸­æ·»åŠ profileæ ‡ç­¾ï¼Œé™å®šmavené¡¹ç›®é»˜è®¤çš„jdkç‰ˆæœ¬ --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">profile</span>&gt;</span>    <br>    <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>myjdk<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span>    <br>    <span class="hljs-tag">&lt;<span class="hljs-name">activation</span>&gt;</span>    <br>        <span class="hljs-tag">&lt;<span class="hljs-name">activeByDefault</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">activeByDefault</span>&gt;</span>    <br>        <span class="hljs-tag">&lt;<span class="hljs-name">jdk</span>&gt;</span>1.8<span class="hljs-tag">&lt;/<span class="hljs-name">jdk</span>&gt;</span>    <br>    <span class="hljs-tag">&lt;/<span class="hljs-name">activation</span>&gt;</span>    <br>    <span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span>    <br>        <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.source</span>&gt;</span>1.8<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.source</span>&gt;</span>    <br>        <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.target</span>&gt;</span>1.8<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.target</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.compilerVersion</span>&gt;</span>1.8<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.compilerVersion</span>&gt;</span> <br>    <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span>    <br><span class="hljs-tag">&lt;/<span class="hljs-name">profile</span>&gt;</span><br> <br><span class="hljs-comment">&lt;!-- è®©å¢åŠ çš„ profileç”Ÿæ•ˆ --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">activeProfiles</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">activeProfile</span>&gt;</span>myjdk<span class="hljs-tag">&lt;/<span class="hljs-name">activeProfile</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">activeProfiles</span>&gt;</span><br></code></pre></td></tr></table></figure><p>é…ç½®åä¸ºäº‘</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"> <span class="hljs-tag">&lt;<span class="hljs-name">mirror</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>huaweicloud<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span>https://repo.huaweicloud.com/repository/maven/<span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mirrorOf</span>&gt;</span>central<span class="hljs-tag">&lt;/<span class="hljs-name">mirrorOf</span>&gt;</span><br> <span class="hljs-tag">&lt;/<span class="hljs-name">mirror</span>&gt;</span><br></code></pre></td></tr></table></figure><p>é˜¿é‡Œäº‘:   <a href="https://developer.aliyun.com/mvn/guide">https://developer.aliyun.com/mvn/guide</a></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">mirror</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>aliyunmaven<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">mirrorOf</span>&gt;</span>*<span class="hljs-tag">&lt;/<span class="hljs-name">mirrorOf</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>é˜¿é‡Œäº‘å…¬å…±ä»“åº“<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span>https://maven.aliyun.com/repository/public<span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mirror</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸‹é¢è¿™ä¸ªè®ºç‚¹ï¼Œé…ç½®çš„æ—¶å€™æ³¨æ„ä¸€ä¸‹ï¼š<strong>ä¸€ä¸ªä»“åº“åªèƒ½å¯¹åº”ä¸€ä¸ªé•œåƒï¼Œå½“æœ‰å¤šä¸ªé•œåƒçš„mirrorOfæŒ‡å®šäº†åŒä¸€ä¸ªä»“åº“ï¼Œmavenåªä¼šä»ç¬¬ä¸€ä¸ªåŒ¹é…çš„ä»“åº“ä¸­è¿›è¡ŒæŸ¥æ‰¾</strong></p><h3 id="3ã€IDEA-é…ç½®-maven"><a href="#3ã€IDEA-é…ç½®-maven" class="headerlink" title="3ã€IDEA é…ç½® maven"></a>3ã€IDEA é…ç½® maven</h3><blockquote><p>IDEA é…ç½® maven</p></blockquote><p>å¿«æ·æŸ¥æ‰¾æ¡†ä¸­è¾“å…¥mavenï¼ŒæŸ¥æ‰¾ä¸mavenç›¸å…³çš„è®¾ç½®ï¼Œç„¶åç‚¹å‡»maven</p><p>ä¿®æ”¹mavençš„è·¯å¾„ï¼ˆä½¿ç”¨æœ¬åœ°çš„Mavenï¼‰ï¼Œä»¥åŠä¿®æ”¹settingsæ–‡ä»¶çš„ä½ç½®å’Œæœ¬åœ°ä»“åº“çš„ä½ç½®</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311242131645.png" alt="image.png"></p><p>IDEA  æœ‰çš„ç‰ˆæœ¬ä¸‹é¢æœ‰ä¸€ä¸ª   use settings from .mvn&#x2F;maven.config  é€‰é¡¹ï¼Œè¿›è¡Œå‹¾é€‰</p><p>ä»–çš„æ„æ€æ˜¯ï¼š mvn(directory):  ä½äºé¡¹ç›®çš„é¡¶çº§ç›®å½•ä¸­ï¼Œæ–‡ä»¶ maven.configã€jvm.configå’Œextensions.xml åŒ…å«è¿è¡ŒMavençš„é¡¹ç›®ç‰¹å®šé…ç½®ã€‚è¿™ä¸ªç›®å½•åº”è¯¥æ˜¯é¡¹ç›®çš„ä¸€éƒ¨åˆ†ï¼Œéœ€è¦è¢«ç‰ˆæœ¬ç®¡ç†å·¥å…·ç®¡ç†</p><blockquote><p>æ¨èé…ç½®ï¼šè®¾ç½®mavenåœ¨ä¸è”ç½‘çš„æƒ…å†µä¸‹ä½¿ç”¨æœ¬åœ°æ’ä»¶</p></blockquote><p>ä¸€èˆ¬ä½¿ç”¨mavenä¸ºæˆ‘ä»¬æä¾›å¥½çš„éª¨æ¶æ—¶ï¼Œæ˜¯éœ€è¦è”ç½‘çš„ï¼Œé…ç½®è¿™ä¸ªï¼Œå¯ä»¥åœ¨æ²¡æœ‰ç½‘è·¯çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥æ­£å¸¸åˆ›å»ºå·¥ç¨‹ï¼Œå¹¶ä»ä¹‹å‰å·²ç»ä½¿ç”¨è¿‡çš„å·¥ç¨‹ä¸­æ‰¾åˆ°ç›¸åº”çš„éª¨æ¶ã€‚ï¼ˆæ ¹æ®éª¨æ¶åˆ›å»ºé¡¹ç›®é€Ÿåº¦ä¼šåŠ å¿«ï¼‰</p><p>è¾“å…¥å†…å®¹ï¼š<code>-DarchetypeCatalog=internal</code></p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311242133069.png" alt="image.png"></p><p>è¾“å…¥å†…å®¹ï¼š<code>-DarchetypeCatalog=internal</code></p><h3 id="4ã€IDEAå¯¼å…¥é¡¹ç›®åmaven-å¸¸è§æŠ¥é”™"><a href="#4ã€IDEAå¯¼å…¥é¡¹ç›®åmaven-å¸¸è§æŠ¥é”™" class="headerlink" title="4ã€IDEAå¯¼å…¥é¡¹ç›®åmaven å¸¸è§æŠ¥é”™"></a>4ã€IDEAå¯¼å…¥é¡¹ç›®åmaven å¸¸è§æŠ¥é”™</h3><p>æ–¹æ³•ä¸€ï¼šæ”¹ä¸€ä¸‹ maven é…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹ mirror ä»“åº“ä½ç½®ï¼Œé‡æ–°å¯¼å…¥é¡¹ç›®ï¼Œé‡æ–°åŠ è½½ maven ä¾èµ–</p><p>æ–¹æ³•äºŒï¼šIDEA  æœ‰çš„ç‰ˆæœ¬ä¸‹é¢æœ‰ä¸€ä¸ª   use settings from .mvn&#x2F;maven.config  é€‰é¡¹ï¼Œä¸è¿›è¡Œå‹¾é€‰è¯•ä¸€ä¸‹</p><p>æ–¹æ³•ä¸‰ï¼šå»ä¸€ä¸‹ä»“åº“åœ°å€ï¼ŒæŸ¥çœ‹æ˜¯å¦æ˜¯å¦æœ‰è¯¥ç‰ˆæœ¬ä¾èµ–ï¼Œå¦‚æœæ²¡æœ‰ï¼Œæ”¹ä¸€ä¸‹ç‰ˆæœ¬ï¼Œæˆ–è€…æ‰‹åŠ¨ä¸‹è½½ï¼Œæ‰‹åŠ¨å¯¼å…¥åˆ°æœ¬åœ°ä»“åº“ä¸­</p><blockquote><p>æŠ¥é”™1ï¼šè§£å†³Maven â€˜parent.relativePathâ€˜ of POM</p></blockquote><p>é”™è¯¯åˆ†æ  </p><p>å­æ¨¡å—çš„parentå†™çš„ä¸æ˜¯çˆ¶æ¨¡å—ï¼Œè€Œæ˜¯ç»§æ‰¿äº†springboot</p><p>è§£å†³æ–¹æ³•  </p><p>åœ¨è¯¥<code>&lt;parent&gt;</code>æ ‡ç­¾ä¸­åŠ ä¸Š<code>&lt;relativePath /&gt;</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.4.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">relativePath</span>   /&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span><br></code></pre></td></tr></table></figure><blockquote><p>æŠ¥é”™2ï¼šå¯¹äºç±»ä¼¼äºxxx-maven-pluginçš„æ’ä»¶æŠ¥çº¢</p></blockquote><p>ç±»ä¼¼äºè¿™æ ·çš„</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.codehaus.mojo<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>wagon-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span>    <br></code></pre></td></tr></table></figure><p>æŠ¥çº¢å°±ç›´æ¥ç”¨ä¸äº†äº†</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡æ·»åŠ ä¾èµ–çš„æ–¹å¼è§£å†³ï¼ˆåŸæ¥çš„æ’ä»¶å°±æ˜¯ä¸Šé¢çš„ä»£ç <strong>ä¸è¦åˆ </strong>ï¼‰:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.codehaus.mojo<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>wagon-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><hr><p>å‚è€ƒ</p><ul><li><a href="https://blog.csdn.net/yang_yzl11/article/details/120764764">https://blog.csdn.net/yang_yzl11/article/details/120764764</a></li><li><a href="https://blog.csdn.net/qq_42057154/article/details/106114515">https://blog.csdn.net/qq_42057154/article/details/106114515</a></li><li><a href="https://www.cnblogs.com/SherlockLynn/p/15079467.html">https://www.cnblogs.com/SherlockLynn/p/15079467.html</a></li><li><a href="https://blog.csdn.net/qq_38217990/article/details/129257106">https://blog.csdn.net/qq_38217990/article/details/129257106</a></li><li><a href="https://zhuanlan.zhihu.com/p/653017610">https://zhuanlan.zhihu.com/p/653017610</a></li><li><a href="https://blog.csdn.net/qq_39505065/article/details/111559890">https://blog.csdn.net/qq_39505065/article/details/111559890</a></li><li><a href="https://blog.csdn.net/m0_46682011/article/details/120626933">https://blog.csdn.net/m0_46682011/article/details/120626933</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>éƒ¨ç½²</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>maven</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringCloud_ç»„ä»¶åŸºæœ¬ä½¿ç”¨_Nacos</title>
    <link href="/2023/11/24/SpringCloud_%E7%BB%84%E4%BB%B6%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8_Nacos/"/>
    <url>/2023/11/24/SpringCloud_%E7%BB%84%E4%BB%B6%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8_Nacos/</url>
    
    <content type="html"><![CDATA[<h3 id="1ã€Nacos-æ˜¯ä»€ä¹ˆ"><a href="#1ã€Nacos-æ˜¯ä»€ä¹ˆ" class="headerlink" title="1ã€Nacos æ˜¯ä»€ä¹ˆ"></a>1ã€Nacos æ˜¯ä»€ä¹ˆ</h3><p>Nacos æ˜¯ä¸€ä¸ªæ„å»ºäº‘åŸç”Ÿåº”ç”¨çš„åŠ¨æ€æœåŠ¡å‘ç°ã€é…ç½®ç®¡ç†å’ŒæœåŠ¡ç®¡ç†å¹³å°ï¼›è‡´åŠ›äºå¸®åŠ©å‘ç°ã€é…ç½®å’Œç®¡ç†å¾®æœåŠ¡ã€‚</p><h3 id="2ã€ä¸‹è½½ä¸è¿è¡Œ"><a href="#2ã€ä¸‹è½½ä¸è¿è¡Œ" class="headerlink" title="2ã€ä¸‹è½½ä¸è¿è¡Œ"></a>2ã€ä¸‹è½½ä¸è¿è¡Œ</h3><p>ä¸‹è½½åœ°å€ï¼š <a href="https://github.com/alibaba/nacos/releases">https://github.com/alibaba/nacos/releases</a></p><p>windowsç‰ˆæœ¬ä½¿ç”¨<code>nacos-server-x.x.x.zip</code>åŒ…å³å¯</p><p>å°†è¿™ä¸ªåŒ…è§£å‹åˆ°ä»»æ„éä¸­æ–‡ç›®å½•ä¸‹ï¼Œå¦‚å›¾ï¼š</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231124154048.png" alt="image.png"><br>ç›®å½•è¯´æ˜ï¼š</p><ul><li>binï¼šå¯åŠ¨è„šæœ¬</li><li>confï¼šé…ç½®æ–‡ä»¶</li></ul><p>Nacosçš„é»˜è®¤ç«¯å£æ˜¯8848ï¼Œå¦‚æœç”µè„‘ä¸Šçš„å…¶å®ƒè¿›ç¨‹å ç”¨äº†8848ç«¯å£ï¼Œå…ˆå°è¯•å…³é—­è¯¥è¿›ç¨‹ã€‚</p><p><strong>å¦‚æœæ— æ³•å…³é—­å ç”¨8848ç«¯å£çš„è¿›ç¨‹</strong>ï¼Œä¹Ÿå¯ä»¥è¿›å…¥nacosçš„confç›®å½•ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„ç«¯å£<br><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231124154144.png" alt="image.png"></p><blockquote><p>å¯åŠ¨å‘½ä»¤(Windows)</p></blockquote><p>å¯åŠ¨éå¸¸ç®€å•ï¼Œè¿›å…¥binç›®å½•</p><p>å¯åŠ¨å‘½ä»¤(standaloneä»£è¡¨ç€å•æœºæ¨¡å¼è¿è¡Œï¼Œéé›†ç¾¤æ¨¡å¼):</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dos">startup.<span class="hljs-built_in">cmd</span> -m standalone<br></code></pre></td></tr></table></figure><blockquote><p>è®¿é—®</p></blockquote><p>åœ¨æµè§ˆå™¨è¾“å…¥åœ°å€ï¼š <a href="http://127.0.0.1:8848/nacos">http://127.0.0.1:8848/nacos</a> </p><p>é»˜è®¤çš„è´¦å·å’Œå¯†ç éƒ½æ˜¯nacos</p><blockquote><p>Namespace+Group+DataIDä¸‰è€…çš„å…³ç³»</p></blockquote><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311250024118.png" alt="image.png|400"></p><blockquote><p>å¤šç¯å¢ƒé…ç½®</p></blockquote><p>ç•¥</p><h3 id="3ã€Nacos-çš„åŸºæœ¬ä½¿ç”¨"><a href="#3ã€Nacos-çš„åŸºæœ¬ä½¿ç”¨" class="headerlink" title="3ã€Nacos çš„åŸºæœ¬ä½¿ç”¨"></a>3ã€Nacos çš„åŸºæœ¬ä½¿ç”¨</h3><h4 id="æœåŠ¡å‘ç°"><a href="#æœåŠ¡å‘ç°" class="headerlink" title="æœåŠ¡å‘ç°"></a>æœåŠ¡å‘ç°</h4><p>åœ¨Â spring-cloud-alibaba-service çš„ä¸»å¯åŠ¨ç±»ä¸Šï¼Œä½¿ç”¨ @EnableDiscoveryClient æ³¨è§£å¼€å¯ Nacos æœåŠ¡å‘ç°åŠŸèƒ½</p><p>ä½ è®¿é—®è¯¥æœåŠ¡ä¸‹çš„æŸä¸ªè¯·æ±‚é“¾æ¥ï¼Œå†æŸ¥çœ‹ nacos â€œæœåŠ¡ç®¡ç†â€ä¸‹çš„â€œæœåŠ¡åˆ—è¡¨â€ï¼Œä¼šå‘ç°å·²ç»æ³¨å†Œä¸Šäº†ã€‚</p><p>ä¸€èˆ¬åœ¨æ¶ˆè´¹ç«¯ä¼šå¼•å…¥Â spring-cloud-loadbalancer è¿›è¡Œè°ƒç”¨æœåŠ¡æä¾›è€…æä¾›çš„æœåŠ¡</p><h4 id="é…ç½®ä¸­å¿ƒ"><a href="#é…ç½®ä¸­å¿ƒ" class="headerlink" title="é…ç½®ä¸­å¿ƒ"></a>é…ç½®ä¸­å¿ƒ</h4><blockquote><p><strong>åŠ¨æ€è·å–é…ç½®å†…å®¹</strong></p></blockquote><p>åœ¨åº”ç”¨çš„ POM æ–‡ä»¶ä¸­å¼•å…¥Â spring-cloud-starter-alibaba-nacos-config ï¼Œå¯å®ç°é…ç½®çš„è·å–ä¸åŠ¨æ€åˆ·æ–°</p><p>ç¤ºä¾‹ </p><p>bootstrap.yml æ–‡ä»¶é…ç½®</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">3377</span> <span class="hljs-comment">#ç«¯å£å·</span><br><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">application:</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">config-client</span> <span class="hljs-comment">#æœåŠ¡å</span><br>  <span class="hljs-attr">cloud:</span><br>    <span class="hljs-attr">nacos:</span><br>      <span class="hljs-attr">discovery:</span><br>        <span class="hljs-attr">server-addr:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><span class="hljs-string">:8848</span> <span class="hljs-comment">#NacosæœåŠ¡æ³¨å†Œä¸­å¿ƒåœ°å€</span><br>      <span class="hljs-attr">config:</span><br>        <span class="hljs-attr">server-addr:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><span class="hljs-string">:8848</span> <span class="hljs-comment">#Nacosä½œä¸ºé…ç½®ä¸­å¿ƒåœ°å€</span><br>        <span class="hljs-attr">file-extension:</span> <span class="hljs-string">yaml</span> <span class="hljs-comment">#æŒ‡å®šyamlæ ¼å¼çš„é…ç½®</span><br>  <span class="hljs-attr">profiles:</span><br>    <span class="hljs-attr">active:</span> <span class="hljs-string">dev</span> <span class="hljs-comment">#æ¿€æ´» dev çš„é…ç½®</span><br></code></pre></td></tr></table></figure><p>åœ¨Â icu.luoqi.nacos.controller åŒ…ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªåä¸ºÂ ConfigClientController çš„ Controller ç±»ï¼Œå¹¶åœ¨è¯¥ç±»ä¸Šä½¿ç”¨ @RefreshScope æ³¨è§£å®ç°é…ç½®çš„è‡ªåŠ¨æ›´æ–°ï¼Œä»£ç å¦‚ä¸‹</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">import</span> org.springframework.beans.factory.<span class="hljs-keyword">annotation</span>.Value;<br><span class="hljs-keyword">import</span> org.springframework.cloud.context.config.<span class="hljs-keyword">annotation</span>.RefreshScope;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.<span class="hljs-keyword">annotation</span>.GetMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.<span class="hljs-keyword">annotation</span>.RestController;<br><span class="hljs-meta">@RestController</span><br><span class="hljs-meta">@RefreshScope</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConfigClientController</span> &#123;<br><br>    <span class="hljs-meta">@Value(<span class="hljs-string">&quot;<span class="hljs-subst">$&#123;config.info&#125;</span>&quot;</span>)</span><br>    <span class="hljs-keyword">private</span> String ConfigInfo;<br>    <br>    <span class="hljs-meta">@GetMapping(<span class="hljs-string">&quot;/config/info&quot;</span>)</span><br>    <span class="hljs-keyword">public</span> String getConfigInfo()&#123;<br>        <span class="hljs-keyword">return</span> ConfigInfo;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸»å¯åŠ¨ç±»ä¸Šï¼Œä½¿ç”¨ @EnableDiscoveryClient æ³¨è§£å¼€å¯æœåŠ¡å‘ç°åŠŸèƒ½</p><p>å¯åŠ¨ Nacos Serverï¼Œå¹¶åœ¨ Nacos Server æ§åˆ¶å°çš„â€œé…ç½®ç®¡ç†â€ä¸‹çš„â€œé…ç½®åˆ—è¡¨â€ä¸­ï¼Œç‚¹å‡»â€œ+â€æŒ‰é’®ï¼Œæ–°å»ºå¦‚ä¸‹é…ç½®</p><figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs nestedtext"><span class="hljs-attribute">Data ID</span><span class="hljs-punctuation">:</span> <span class="hljs-string">       config-client-dev.yaml</span><br><br><span class="hljs-attribute">Group</span><span class="hljs-punctuation">:</span> <span class="hljs-string">         DEFAULT_GROUP</span><br><br><span class="hljs-attribute">é…ç½®æ ¼å¼</span><span class="hljs-punctuation">:</span> <span class="hljs-string">      YAML</span><br><br><span class="hljs-attribute">é…ç½®å†…å®¹</span><span class="hljs-punctuation">:</span> <span class="hljs-string">      config:</span><br>                   <span class="hljs-attribute">info</span><span class="hljs-punctuation">:</span> <span class="hljs-string">xxxx</span><br></code></pre></td></tr></table></figure><p>åœ¨ Nacos Server ä¸­ï¼Œé…ç½®çš„ dataIdï¼ˆå³ Data IDï¼‰çš„å®Œæ•´æ ¼å¼å¦‚ä¸‹ï¼š</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-symbol">$</span>&#123;prefix&#125;-<span class="hljs-symbol">$</span>&#123;spring.profiles.active&#125;.<span class="hljs-symbol">$</span>&#123;<span class="hljs-keyword">file</span>-extension&#125;<br></code></pre></td></tr></table></figure><p>å¯åŠ¨è¯¥æœåŠ¡ï¼Œå¹¶ä½¿ç”¨æµè§ˆå™¨è®¿é—®â€œ<a href="http://localhost:3377/config/info%E2%80%9D%EF%BC%8C">http://localhost:3377/config/infoâ€ï¼Œ</a></p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œèƒ½å¤Ÿå®ç°ä¸é‡å¯åå°æœåŠ¡ï¼Œå½“ä½ æ‰‹åŠ¨ä¿®æ”¹ nacos çš„é…ç½®æ—¶ï¼Œèƒ½å¤ŸåŠ¨æ€è·å–åˆ°é…ç½®å†…å®¹ã€‚</p><blockquote><p>Nacos Configé…ç½®é›†çš„ä¸‰ç§æ–¹å¼å’ŒåŠ è½½é¡ºåº</p></blockquote><ul><li>é€šè¿‡ spring.cloud.nacos.config.shared-configs é…ç½®é¡¹ï¼Œæ”¯æŒå¤šä¸ªå…±äº« Nacos é…ç½®é›†ã€‚</li><li>é€šè¿‡ spring.cloud.nacos.config.extension-configs é…ç½®é¡¹ï¼Œæ”¯æŒå¤šä¸ªæ‹“å±• Nacos é…ç½®é›†ã€‚</li><li>é€šè¿‡ spring.cloud.nacos.config.name é…ç½®é¡¹ï¼Œæ”¯æŒä¸€ä¸ª Nacos é…ç½®é›†ã€‚</li></ul><p>å½“ä¸‰ç§æ–¹å¼å…±åŒä½¿ç”¨æ—¶ï¼Œå®ƒä»¬çš„ä¼˜å…ˆçº§å…³ç³»æ˜¯ï¼šA &lt; B &lt; Cã€‚å¦å¤–ï¼ŒA å’Œ B çš„å‘½åå¸¦æœ‰â€œå…±äº«â€æˆ–æ˜¯â€œæ‹“å±•â€ï¼Œæ²¡æœ‰ä»»ä½•å«ä¹‰ï¼Œåªæ˜¯ä¼˜å…ˆçº§ä¸åŒ</p><h3 id="4ã€æ³¨æ„äº‹é¡¹"><a href="#4ã€æ³¨æ„äº‹é¡¹" class="headerlink" title="4ã€æ³¨æ„äº‹é¡¹"></a>4ã€æ³¨æ„äº‹é¡¹</h3><p>å‘½åç©ºé—´idç”¨äºå”¯ä¸€æ ‡è¯†å‘½åç©ºé—´ï¼ŒÂ æ–°å»ºå‘½åç©ºé—´æ—¶å€™ï¼Œå¦‚æœä¸å¡«å†™å‘½åç©ºé—´idï¼Œåˆ™ç³»ç»Ÿä¼šè‡ªåŠ¨ç”Ÿæˆå‘½åç©ºé—´idï¼Œç”Ÿæˆè§„åˆ™ä¸ºUUIDæ–¹å¼ã€‚</p><p>ä½†åœ¨spring é¡¹ç›®ä¸­é›†æˆnacos çš„æ—¶å€™ï¼Œé…ç½®æ–‡ä»¶ä¸­å¡«å†™çš„namespaceå°±æ˜¯å‘½åç©ºé—´çš„id</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311260000905.png" alt="image.png"></p><p>å› æ­¤å°½é‡ä¿æŒnacosçš„å‘½åç©ºé—´åç§°å’Œid ä¸€è‡´</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311260002165.png" alt="image.png"></p><hr><p>å‚è€ƒ</p><ul><li><a href="https://blog.csdn.net/qq_36903261/article/details/106835279">https://blog.csdn.net/qq_36903261/article/details/106835279</a></li><li><a href="https://m.biancheng.net/springcloud/nacos.html">https://m.biancheng.net/springcloud/nacos.html</a></li><li><a href="https://nacos.io/zh-cn/docs/v2/ecology/use-nacos-with-spring-cloud.html">https://nacos.io/zh-cn/docs/v2/ecology/use-nacos-with-spring-cloud.html</a></li><li><a href="https://nacos.io/zh-cn/docs/quick-start-spring-cloud.html">https://nacos.io/zh-cn/docs/quick-start-spring-cloud.html</a></li><li><a href="https://blog.csdn.net/weixin_45397785/article/details/128076533">https://blog.csdn.net/weixin_45397785/article/details/128076533</a></li><li><a href="https://blog.csdn.net/ysj1241267542/article/details/112562611">https://blog.csdn.net/ysj1241267542/article/details/112562611</a></li><li><a href="https://blog.csdn.net/u010520146/article/details/118703413">https://blog.csdn.net/u010520146/article/details/118703413</a></li><li><a href="https://blog.csdn.net/wangwei021933/article/details/129590430">https://blog.csdn.net/wangwei021933/article/details/129590430</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>å¾®æœåŠ¡</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>springcloud</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>hexo_å®ç°åœ¨ç™¾åº¦ä¸­æœç´¢åˆ°è‡ªå·±çš„åšå®¢</title>
    <link href="/2023/11/24/hexo_%E5%AE%9E%E7%8E%B0%E5%9C%A8%E7%99%BE%E5%BA%A6%E4%B8%AD%E6%90%9C%E7%B4%A2%E5%88%B0%E8%87%AA%E5%B7%B1%E7%9A%84%E5%8D%9A%E5%AE%A2/"/>
    <url>/2023/11/24/hexo_%E5%AE%9E%E7%8E%B0%E5%9C%A8%E7%99%BE%E5%BA%A6%E4%B8%AD%E6%90%9C%E7%B4%A2%E5%88%B0%E8%87%AA%E5%B7%B1%E7%9A%84%E5%8D%9A%E5%AE%A2/</url>
    
    <content type="html"><![CDATA[<blockquote><p>1ã€æ³¨å†Œä¸€ä¸ªç™¾åº¦ç«™é•¿è´¦å·</p></blockquote><p>åœ°å€ï¼š <a href="https://ziyuan.baidu.com/?castk=LTE=">https://ziyuan.baidu.com/?castk=LTE%3D</a></p><p>éªŒè¯ç½‘ç«™æ‰€æœ‰æƒï¼š <a href="https://ziyuan.baidu.com/site/index">https://ziyuan.baidu.com/site/index</a></p><p>æ‰“å¼€ä¹‹åè¾“å…¥ä½ çš„åšå®¢é¦–é¡µåœ°å€ï¼Œå¯ä»¥æ˜¯<code>Github Pages</code>æˆ–è€…<code>Vercel</code>çš„åœ°å€ï¼Œç„¶åç‚¹å‡»ä¸‹ä¸€æ­¥ã€‚</p><p>ç«™ç‚¹é¢†åŸŸï¼š ä¿¡æ¯æŠ€æœ¯</p><p>éªŒè¯ï¼šé€‰æ‹©ç¬¬äºŒç§éªŒè¯æ–¹å¼  â†’  HTML éªŒè¯</p><p><strong>æœ¬åšå®¢ä½¿ç”¨çš„æ˜¯ fluid ä¸»é¢˜</strong>ï¼Œ</p><p>è¿›å…¥åšå®¢ç›®å½•ä¸‹Â <code>scripts</code>Â æ–‡ä»¶å¤¹ï¼ˆå¦‚ä¸å­˜åœ¨åˆ™åˆ›å»ºï¼‰ï¼Œåœ¨é‡Œé¢åˆ›å»ºä»»æ„åç§°çš„ js æ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶ä¸­å†™å…¥å¦‚ä¸‹å†…å®¹ï¼ˆcontent è§ç™¾åº¦å…·ä½“éªŒè¯å†…å®¹)ï¼š</p><figure class="highlight scilab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scilab">hexo.extend.filter.register(<span class="hljs-string">&#x27;theme_inject&#x27;</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(injects)</span> &#123;</span><br>  injects.head.raw(<span class="hljs-string">&#x27;home&#x27;</span>,<span class="hljs-string">&#x27;&lt;meta name=&quot;</span>baidu-site-verification<span class="hljs-string">&quot; content=&quot;</span>xxxxxxxxxxxxxxx<span class="hljs-string">&quot; /&gt;&#x27;</span>);<br>&#125;);<br></code></pre></td></tr></table></figure><p>åœ¨åšå®¢ <code>_config.yml</code> æ–‡ä»¶åŠ ä¸€å¥ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">baidu_site_verification:</span> <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>ç¼–è¯‘å‘å¸ƒä½ çš„åšå®¢ï¼Œåœ¨åšå®¢é¦–é¡µæŒ‰<code>F12</code>ï¼Œå¦‚æœåœ¨<code>head</code>æ ‡ç­¾ä¸­çœ‹åˆ°äº†éªŒè¯æ ‡ç­¾åˆ™æˆåŠŸäº†ã€‚</p><p>ç‚¹å‡»éªŒè¯æŒ‰é’®ï¼Œå¦‚æœæ²¡é—®é¢˜åˆ™å·²æˆåŠŸã€‚</p><blockquote><p>2ã€ç«™ç‚¹åœ°å›¾åŠŸèƒ½</p></blockquote><p>éœ€è¦ç”Ÿæˆä¸€ä¸ªç«™ç‚¹åœ°å›¾</p><p>å…ˆç¡®è®¤ä¸€ä¸‹ <code>_config.yml</code> é…ç½®é‡Œé¢çš„ URL å€¼ï¼Œå¦‚æœä¸æ˜¯æ”¹ä¸ºè‡ªå·±çš„åŸŸååœ°å€ã€‚</p><p>åšå®¢ç›®å½•æ‰§è¡Œå‘½ä»¤</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">npm <span class="hljs-keyword">install </span>hexo-generator-sitemap --save        <span class="hljs-comment">#å®‰è£…sitemapæ’ä»¶</span><br>npm <span class="hljs-keyword">install </span>hexo-generator-<span class="hljs-keyword">baidu-sitemap </span>--save  <span class="hljs-comment">#å®‰è£…baidu-sitemapæ’ä»¶</span><br><br>  <br>hexo g Â <span class="hljs-comment">#ç”Ÿæˆç½‘ç«™é™æ€æ–‡ä»¶åˆ°publicæ–‡ä»¶å¤¹</span><br></code></pre></td></tr></table></figure><blockquote><p>æŸ¥çœ‹æ ¹ç›®å½•ä¸‹çš„publicç›®å½•ï¼Œä¼šç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ï¼Œâ€œsitemap.xml â€å’Œ â€œbaidusitemap.xmlâ€</p></blockquote><p>å…¶ä¸­â€œsitemap.xmlâ€æ–‡ä»¶æ˜¯æœç´¢å¼•æ“é€šç”¨çš„æ–‡ä»¶ï¼Œ</p><p>â€œbaidusitemap.xmlâ€æ˜¯ç™¾åº¦ä¸“ç”¨çš„sitemapæ–‡ä»¶ï¼Œ</p><blockquote><p>3ã€æäº¤sitemapåˆ°ç™¾åº¦èµ„æºæœç´¢å¹³å°</p></blockquote><p>é€‰æ‹©èµ„æºæäº¤ï¼Œç‚¹å‡»æ™®é€šæ”¶å½•ï¼Œé€‰æ‹©sitemapï¼Œ <a href="https://ziyuan.baidu.com/linksubmit/index">https://ziyuan.baidu.com/linksubmit/index</a></p><p>å¡«å†™ç½‘ç«™åœ°å€ï¼Œä¾‹ï¼šâ€œåŸŸå&#x2F;baidusitemap.xmlâ€ï¼Œç‚¹å‡»æäº¤ï¼Œè¿‡ä¸€æ®µæ—¶é—´ååšå®¢å°±å¯ä»¥åœ¨ç™¾åº¦ä¸­æœç´ åˆ°ã€‚</p><p>ä¸ªäººä½¿ç”¨çš„æ—¶å€™è¿™ä¸€æ­¥æ˜¾ç¤ºæäº¤ä¸Šé™æ˜¯ 0 ï¼›åªèƒ½ä½¿ç”¨ä»–æ‰‹åŠ¨æäº¤çš„æ–¹å¼ï¼Œè€Œä¸”åªèƒ½æ˜¯è®¿é—®é“¾æ¥ã€‚</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://blog.csdn.net/Passerby_Wang/article/details/124704475">https://blog.csdn.net/Passerby_Wang/article/details/124704475</a></li><li><a href="https://py-wang.blog.csdn.net/article/details/121202486">https://py-wang.blog.csdn.net/article/details/121202486</a></li><li><a href="https://cloud.tencent.com/developer/article/2317858">https://cloud.tencent.com/developer/article/2317858</a></li><li><a href="https://fluid-dev.github.io/hexo-fluid-docs/advance/#fluid-%E6%B3%A8%E5%85%A5%E4%BB%A3%E7%A0%81">https://fluid-dev.github.io/hexo-fluid-docs/advance/#fluid-%E6%B3%A8%E5%85%A5%E4%BB%A3%E7%A0%81</a></li><li><a href="https://zhuanlan.zhihu.com/p/150999914">https://zhuanlan.zhihu.com/p/150999914</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>StatusPage</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Vercelçš„å¼€ç®±ä½¿ç”¨_åŒæ­¥Hexoé™æ€åšå®¢</title>
    <link href="/2023/11/23/Vercel%E7%9A%84%E5%BC%80%E7%AE%B1%E4%BD%BF%E7%94%A8_%E5%90%8C%E6%AD%A5Hexo%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2/"/>
    <url>/2023/11/23/Vercel%E7%9A%84%E5%BC%80%E7%AE%B1%E4%BD%BF%E7%94%A8_%E5%90%8C%E6%AD%A5Hexo%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2/</url>
    
    <content type="html"><![CDATA[<p>å®˜ç½‘ï¼š <a href="https://vercel.com/">https://vercel.com/</a></p><p>éƒ¨ç½²æ— è„‘å¼å¯¼å…¥ Github åŸé¡¹ç›®ï¼Œç„¶åè¿›è¡Œ deploy å°±è¡Œã€‚å‘½ä»¤å¯ä»¥è‡ªå®šä¹‰è®¾ç½®ï¼Œä¸€èˆ¬æ˜¯ hexo -s ä¹‹ç±»çš„ã€‚(Vercelsæ˜¯æ”¯æŒä½ æ¨é€ä»£ç åˆ°Githubçš„æ—¶å€™ä½ åœ¨Vercelçš„é¡¹ç›®ä¹Ÿæ˜¯ä¼šè¿›è¡Œè‡ªåŠ¨æ›´æ–°çš„)</p><p>ç‚¹å‡»éƒ¨ç½²çš„æ—¶å€™é¡¹ç›®é…ç½®æ·»åŠ è‡ªå®šä¹‰åŸŸåæ“ä½œï¼š</p><p>Setting â†’  Domains â†’  é€‰æ‹©æ·»åŠ è§£æåŸŸå</p><p>å®˜ç½‘æ–‡æ¡£å‚è€ƒçš„è§£æåŸŸååœ°å€</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311240050203.png" alt="image.png"></p><p>å®é™…æ“ä½œè®°å½•ï¼š</p><p>ä¸ªäººä½¿ç”¨çš„æ˜¯é˜¿é‡Œäº‘çš„åŸŸåè§£æï¼Œåœ¨å¯¹åº”åŸŸåä¸‹æ·»åŠ äº†è¿™ä¸€æ¡è®°å½•<br>ï¼ˆå¯¹åº” çš„è®°å½•å€¼æ˜¯ <code>cname.vercel-dns.com</code> ï¼Œè®°å½•ç±»å‹éœ€è¦æ˜¯ CNAMEï¼‰</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311240052961.png" alt="image.png"></p><p>domain é€‰æ‹©ç¼–è¾‘å¯¹åº”çš„åŸŸååœ°å€: </p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">varcel. + ä½ çš„é˜¿é‡Œäº‘åŸŸå<br></code></pre></td></tr></table></figure><p>æœ€åéƒ¨ç½²è®¿é—®æˆåŠŸã€‚</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://juejin.cn/post/7143067114025254919">https://juejin.cn/post/7143067114025254919</a></li><li><a href="https://zhuanlan.zhihu.com/p/646818470">https://zhuanlan.zhihu.com/p/646818470</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>StatusPage</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è˜‘è‡åšå®¢é¡¹ç›®_Day01</title>
    <link href="/2023/11/23/%E8%98%91%E8%8F%87%E5%8D%9A%E5%AE%A2%E9%A1%B9%E7%9B%AE_Day01/"/>
    <url>/2023/11/23/%E8%98%91%E8%8F%87%E5%8D%9A%E5%AE%A2%E9%A1%B9%E7%9B%AE_Day01/</url>
    
    <content type="html"><![CDATA[<h3 id="1ã€é¡¹ç›®ä¸‹è½½"><a href="#1ã€é¡¹ç›®ä¸‹è½½" class="headerlink" title="1ã€é¡¹ç›®ä¸‹è½½"></a>1ã€é¡¹ç›®ä¸‹è½½</h3><p>é¡¹ç›®ä¸‹è½½åœ°å€ï¼š <a href="https://gitee.com/moxi159753/mogu_blog_v2">https://gitee.com/moxi159753/mogu_blog_v2</a></p><h3 id="2ã€é¡¹ç›®åç«¯å¯åŠ¨"><a href="#2ã€é¡¹ç›®åç«¯å¯åŠ¨" class="headerlink" title="2ã€é¡¹ç›®åç«¯å¯åŠ¨"></a>2ã€é¡¹ç›®åç«¯å¯åŠ¨</h3><p>åç«¯é¡¹ç›®å¯åŠ¨ï¼š</p><p>ç›¸å…³ç¯å¢ƒéœ€è¦å…ˆå¯åŠ¨å’Œè¿è¡Œ</p><p><code>nacos</code>ï¼Œ<code>nginx</code>ï¼Œ<code>rabbitmq</code>ï¼ŒÂ <code>redis</code>ï¼Œ<code>mysql</code>ï¼Œ</p><p>æ¨¡å—å¯åŠ¨ï¼š</p><p><code>mogu-gateway</code>ï¼Œ<code>mogu-sms</code>ï¼Œ<code>mogu-picture</code>ï¼ŒÂ <code>mogu-web</code>,Â <code>mogu-admin</code></p><blockquote><p>é…ç½® Nacos</p></blockquote><p>æ¨¡å—å¯åŠ¨å‰å…ˆé…ç½®ä¸€ä¸‹ nacos </p><p>mogu çš„å¯åŠ¨æ–¹å¼æ˜¯å°†æ•°æ®æ”¾åœ¨äº† mysql æ•°æ®åº“ä¸­ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å…ˆæ‰§è¡Œå®ƒé¡¹ç›®ä¸­çš„ nacos_config.sql è„šæœ¬</p><p>åˆ›å»ºä¸€ä¸ªæ•°æ®åº“ nacos_configï¼Œå°†é…ç½®å¯¼å…¥åˆ°mysqlä¸­</p><p>è§£å‹nacos åˆ°å¦å¤–ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œç„¶åè¿›å…¥ confç›®å½•ï¼Œæ‰“å¼€ application.propertiesæ–‡ä»¶</p><p>åœ¨æ–‡ä»¶çš„æœ«å°¾æ·»åŠ mysqlçš„é…ç½®ä¿¡æ¯ï¼Œæ³¨æ„mysqlçš„è´¦å·å’Œå¯†ç </p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-comment"># mysqlé…ç½®</span><br><span class="hljs-attr">spring.datasource.platform</span>=mysql<br><span class="hljs-attr">db.num</span>=<span class="hljs-number">1</span><br><span class="hljs-attr">db.url.0</span>=jdbc:mysql://<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">3306</span>/nacos_config?characterEncoding=utf8&amp;connectTimeout=<span class="hljs-number">1000</span>&amp;socketTimeout=<span class="hljs-number">3000</span>&amp;autoReconnect=<span class="hljs-literal">true</span>&amp;serverTimezone=UTC<br><span class="hljs-attr">db.user</span>=root<br><span class="hljs-attr">db.password</span>=root<br></code></pre></td></tr></table></figure><p>åˆ°nacosä¸‹çš„ bin ç›®å½•ï¼Œå¯åŠ¨æœåŠ¡</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dos">startup.<span class="hljs-built_in">cmd</span> -m standalone<br></code></pre></td></tr></table></figure><p>è®¿é—®ï¼š <a href="http://127.0.0.1:8848/nacos/#/login">http://127.0.0.1:8848/nacos/#/login</a></p><p>å¯åŠ¨æ¨¡å—å‰å…ˆå°† dev å‘½åç©ºé—´ä¸‹çš„ é…ç½®æ–‡ä»¶å¯¹åº”çš„ redis, zipkin,mysql,rabbitmqçš„é…ç½®æ–‡ä»¶æ”¹ä¸€ä¸‹</p><p>å¯åŠ¨ä¸€ä¸‹ ç›¸åº”æœåŠ¡</p><blockquote><p>æ‰§è¡Œä¸€ä¸‹æ•°æ®åº“SQL è„šæœ¬</p></blockquote><blockquote><p>ä¿®æ”¹ä¸€ä¸‹ Nacos é…ç½®æ–‡ä»¶</p></blockquote><blockquote><p>ä¾æ¬¡å¯åŠ¨æœåŠ¡ï¼š<code>mogu-gateway</code>ï¼Œ<code>mogu-sms</code>ï¼Œ<code>mogu-picture</code>ï¼ŒÂ <code>mogu-web</code>,Â <code>mogu-admin</code></p></blockquote><p>å¦‚æœæ˜¾ç¤º zipkin è¿æ¥å¤±è´¥ï¼Œå°è¯•ä¿®æ”¹ä¸€ä¸‹é…ç½®ï¼Œæ·»åŠ ä¸€ä¸‹ serviceName</p><p>Spring Cloud Sleuthé…ç½®ä¸­è®¾ç½®æœåŠ¡åç§°çš„ç¤ºä¾‹ï¼š</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">spring:</span><br><span class="hljs-symbol">  sleuth:</span><br><span class="hljs-symbol">    sampler:</span><br><span class="hljs-symbol">      probability:</span> <span class="hljs-number">1.0</span><br><span class="hljs-symbol">    zipkin:</span><br><span class="hljs-symbol">      baseUrl:</span> http:<span class="hljs-comment">//192.168.31.79:9411</span><br><span class="hljs-symbol">      serviceName:</span> your-service-name<br></code></pre></td></tr></table></figure><p>åç«¯å¯åŠ¨æˆåŠŸåï¼Œèƒ½å¤ŸæŸ¥çœ‹åˆ°å¯¹åº”çš„Swaggeræ¥å£æ–‡æ¡£</p><blockquote><p>nacosç‰ˆæœ¬ï¼šswagger-uiä½¿ç”¨çš„æ˜¯3.Xï¼Œè®¿é—®çš„é¡µé¢æ˜¯Â <a href="http://localhost:8601/swagger-ui/index.html">http://localhost:8601/swagger-ui/index.html</a><br>sms æœåŠ¡é‡Œé¢æœ‰çŸ­ä¿¡å’Œé‚®ç®±çš„é…ç½®ï¼Œä¹Ÿæ³¨æ„æ”¹ä¸€ä¸‹</p></blockquote><hr><h3 id="3ã€å‰ç«¯é¡¹ç›®å¯åŠ¨"><a href="#3ã€å‰ç«¯é¡¹ç›®å¯åŠ¨" class="headerlink" title="3ã€å‰ç«¯é¡¹ç›®å¯åŠ¨"></a>3ã€å‰ç«¯é¡¹ç›®å¯åŠ¨</h3><blockquote><p>vue_mogu_admin</p></blockquote><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-comment"># æŒ‡å®šnode-sassçš„å›½å†…é•œåƒæº</span><br>npm i node-sass <span class="hljs-attribute">--sass_binary_site</span>=https://npm.taobao.org/mirrors/node-sass<br><br><span class="hljs-comment"># ä½¿ç”¨æ·˜å®é•œåƒæºè¿›è¡Œä¾èµ–å®‰è£…ï¼Œè§£å†³å›½å†…ä¸‹è½½ç¼“æ…¢çš„é—®é¢˜(å‡ºç°è­¦å‘Šå¯ä»¥å¿½ç•¥)</span><br>npm install <span class="hljs-attribute">--registry</span>=https://registry.npm.taobao.org<br><br><span class="hljs-comment"># å¯åŠ¨é¡¹ç›®</span><br>npm <span class="hljs-built_in">run</span> dev<br><br><span class="hljs-comment">#æ‰“åŒ…é¡¹ç›®ï¼ˆåœ¨éƒ¨ç½²çš„æ—¶å€™æ‰éœ€è¦ä½¿ç”¨ï¼‰</span><br>npm <span class="hljs-built_in">run</span> build<br></code></pre></td></tr></table></figure><p>å¯åŠ¨é¡¹ç›®æˆåŠŸåï¼Œä¼šè·³è½¬åˆ°ï¼šlocalhost:9528 ï¼Œ</p><p>é»˜è®¤è´¦å·å¯†ç ï¼š admin, mogu2018 </p><p>å®é™…åœ¨è¿è¡Œé¡¹ç›®çš„æ—¶å€™ï¼Œç¬¬ä¸€æ­¥æœ‰äº›é—®é¢˜ï¼Œåšäº†ä»¥ä¸‹æ“ä½œï¼š</p><ul><li><ol><li>æ›´æ–°äº†ä¸€ä¸‹ä¾èµ–ç‰ˆæœ¬ï¼šâ€html-webpack-pluginâ€:Â â€œ3.2.0â€,</li></ol></li><li><ol start="2"><li>å°†windows ä¸‹çš„ 3.x çš„python ç‰ˆæœ¬é™çº§å®‰è£…ä¸º 2.x ç‰ˆæœ¬ï¼Œä¸”ä¸è¶…è¿‡ 2.7</li></ol></li><li><ol start="3"><li>å®‰è£…äº† Visual C++ Build Tools for Visual Studio 2015</li></ol></li></ul><p>å…³äºç¬¬ä¸‰æ­¥ï¼Œä¸‹è½½åœ°å€ï¼š<a href="https://my.visualstudio.com/Downloads?q=C++%20build">Downloads &amp; Keys - Visual Studio Subscriptions</a></p><p>åœ¨ç±»å‹å¤„é€‰æ‹©DVDï¼Œç„¶åä¸‹è½½ä¸‹æ¥ï¼Œè§£å‹ç¼©åè¿è¡Œå…¶ä¸­çš„exeæ–‡ä»¶</p><blockquote><p>vue_mogu_web</p></blockquote><p>ä¸ä¸Šé¢ä¸€è‡´ï¼Œè®¿é—®ç•Œé¢ï¼šlocalhost:9527</p><p>å®é™…æ“ä½œï¼Œæœ‰ä¸€äº›æ›´æ”¹</p><ul><li><ol><li>ç”±äºä¾èµ–ä¸­ â€œnode-sassâ€:Â â€œ^4.14.1â€, éœ€è¦å’Œ node ç‰ˆæœ¬å¯¹åº”ï¼Œè¿™é‡Œåˆ‡æ¢ Node 14 ç‰ˆæœ¬ï¼ˆä½¿ç”¨NVM)</li></ol></li><li><ol start="2"><li>å†æ¬¡æ‰§è¡Œä¸Šé¢ç›¸åŒçš„è¿è¡Œå‘½ä»¤</li></ol></li><li><ol start="3"><li>é‡åˆ°è¿è¡Œå‘½ä»¤å¯ä»¥å°è¯•å…ˆåˆ é™¤node_module æ–‡ä»¶å¤¹å†æ‰§è¡Œï¼Œæˆ–è€…æ‰§è¡Œ <code>npm cache clean --force</code> å†è¯•ä¸€ä¸‹ã€‚</li></ol></li></ul><p>è‡³æ­¤ï¼Œé¡¹ç›®æ˜¯èƒ½å¤Ÿå®Œæ•´è¿è¡Œå¹¶åœ¨æµè§ˆå™¨ä¸Šé¢è®¿é—®ã€‚</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://gitee.com/moxi159753/mogu_blog_v2.git">https://gitee.com/moxi159753/mogu_blog_v2.git</a></li><li><a href="https://moxi159753.gitee.io/mogu_blog_doc/#/README">https://moxi159753.gitee.io/mogu_blog_doc/#/README</a></li><li><a href="https://blog.csdn.net/colleges/article/details/123769410">https://blog.csdn.net/colleges/article/details/123769410</a></li><li><a href="https://www.jb51.net/article/281818.htm">https://www.jb51.net/article/281818.htm</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>é¡¹ç›®</category>
      
    </categories>
    
    
    <tags>
      
      <tag>project</tag>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringCloud_ç»„ä»¶åŸºæœ¬ä½¿ç”¨_Eureka</title>
    <link href="/2023/11/22/SpringCloud_%E7%BB%84%E4%BB%B6%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8_Eureka/"/>
    <url>/2023/11/22/SpringCloud_%E7%BB%84%E4%BB%B6%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8_Eureka/</url>
    
    <content type="html"><![CDATA[<h3 id="1ã€Eureka-æ˜¯ä»€ä¹ˆ"><a href="#1ã€Eureka-æ˜¯ä»€ä¹ˆ" class="headerlink" title="1ã€Eureka æ˜¯ä»€ä¹ˆ"></a>1ã€Eureka æ˜¯ä»€ä¹ˆ</h3><p>Eureka æ˜¯ä¸€ä¸ªNetflix å¼€æºçš„æœåŠ¡å‘ç°ç»„ä»¶ï¼ŒåŒ…æ‹¬ Server å’Œ Client ä¸¤éƒ¨åˆ†ã€‚åœ¨ Spring Cloud å­é¡¹ç›® Spring Cloud Netflix ä¸­ã€‚</p><blockquote><p>æœåŠ¡æ³¨å†Œä¸å‘ç°</p></blockquote><p>Eurekaé‡‡ç”¨äº†CSçš„è®¾è®¡æ¶æ„ï¼ŒEureka Serverä½œä¸ºæœåŠ¡æ³¨å†ŒåŠŸèƒ½çš„æœåŠ¡å™¨ï¼Œå®ƒæ˜¯æœåŠ¡æ³¨å†Œä¸­å¿ƒã€‚</p><p>è€Œç³»ç»Ÿä¸­çš„å…¶ä»–å¾®æœåŠ¡ï¼Œä½¿ç”¨Eurekaçš„å®¢æˆ·ç«¯è¿æ¥åˆ°Eureka Serverå¹¶ç»´æŒå¿ƒè·³è¿æ¥ã€‚</p><p>è¿™æ ·ç³»ç»Ÿçš„ç»´æŠ¤äººå‘˜å°±å¯ä»¥é€šè¿‡Eureka Serveræ¥ç›‘æ§ç³»ç»Ÿä¸­å„ä¸ªå¾®æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œã€‚</p><p>åœ¨æœåŠ¡æ³¨å†Œä¸å‘ç°ä¸­ï¼Œæœ‰ä¸€ä¸ªæ³¨å†Œä¸­å¿ƒã€‚å½“æœåŠ¡å™¨å¯åŠ¨çš„æ—¶å€™ï¼Œä¼šæŠŠå½“å‰è‡ªå·±æœåŠ¡å™¨çš„ä¿¡æ¯æ¯”å¦‚æœåŠ¡åœ°å€é€šè®¯åœ°å€ç­‰ä»¥åˆ«åæ–¹å¼æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒä¸Šã€‚å¦ä¸€æ–¹ï¼ˆæ¶ˆè´¹è€…æœåŠ¡æä¾›è€…)ï¼Œä»¥è¯¥åˆ«åçš„æ–¹å¼å»æ³¨å†Œä¸­å¿ƒä¸Šè·å–åˆ°å®é™…çš„æœåŠ¡é€šè®¯åœ°å€ï¼Œç„¶åå†å®ç°æœ¬åœ°RPCè°ƒç”¨ã€‚</p><p>RPCè¿œç¨‹è°ƒç”¨æ¡†æ¶æ ¸å¿ƒè®¾è®¡æ€æƒ³ï¼šåœ¨äºæ³¨å†Œä¸­å¿ƒï¼Œå› ä¸ºä½¿ç”¨æ³¨å†Œä¸­å¿ƒç®¡ç†æ¯ä¸ªæœåŠ¡ä¸æœåŠ¡ä¹‹é—´çš„ä¸€ä¸ªä¾èµ–å…³ç³»ï¼ˆæœåŠ¡æ²»ç†æ¦‚å¿µï¼‰ã€‚åœ¨ä»»ä½• rpc è¿œç¨‹æ¡†æ¶ä¸­ï¼Œéƒ½ä¼šæœ‰ä¸€ä¸ªæ³¨å†Œä¸­å¿ƒï¼ˆå­˜æ”¾æœåŠ¡åœ°å€ç›¸å…³ä¿¡æ¯ï¼ˆæ¥å£åœ°å€ï¼‰)</p><p>Eureka ç³»ç»Ÿæ¶æ„ï¼ˆå³å›¾æ˜¯Dubboçš„æ¶æ„ï¼‰<br><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311222335266.png" alt="image.png"></p><blockquote><p>Eureka Server ä¸ Eureka Client</p></blockquote><p>Eureka Server æä¾›æœåŠ¡æ³¨å†ŒæœåŠ¡ï¼Œå„ä¸ªå¾®æœåŠ¡èŠ‚ç‚¹é€šè¿‡é…ç½®å¯åŠ¨åï¼Œä¼šåœ¨ Eureka Serverä¸­è¿›è¡Œæ³¨å†Œï¼Œè¿™æ ·EurekaServerä¸­çš„æœåŠ¡æ³¨å†Œè¡¨ä¸­å°†ä¼šå­˜å‚¨æ‰€æœ‰å¯ç”¨æœåŠ¡èŠ‚ç‚¹çš„ä¿¡æ¯ï¼ŒæœåŠ¡èŠ‚ç‚¹çš„ä¿¡æ¯å¯ä»¥åœ¨ç•Œé¢ä¸­ç›´è§‚çœ‹åˆ°ã€‚</p><p>Eureka Clienté€šè¿‡æ³¨å†Œä¸­å¿ƒè¿›è¡Œè®¿é—®ï¼Œ Eureka Client æ˜¯ä¸€ä¸ªJavaå®¢æˆ·ç«¯ï¼Œç”¨äºç®€åŒ–Eureka Serverçš„äº¤äº’ï¼Œå®¢æˆ·ç«¯åŒæ—¶ä¹Ÿå…·å¤‡ä¸€ä¸ªå†…ç½®çš„ã€ä½¿ç”¨è½®è¯¢(round-robin)è´Ÿè½½ç®—æ³•çš„è´Ÿè½½å‡è¡¡å™¨ã€‚</p><p>åœ¨åº”ç”¨å¯åŠ¨åï¼Œå°†ä¼šå‘Eureka Serverå‘é€å¿ƒè·³ï¼ˆé»˜è®¤å‘¨æœŸä¸º30ç§’ï¼‰ã€‚å¦‚æœEureka Server åœ¨å¤šä¸ªå¿ƒè·³å‘¨æœŸå†…æ²¡æœ‰æ¥æ”¶åˆ°æŸä¸ªèŠ‚ç‚¹çš„å¿ƒè·³ï¼ŒEurekaServerå°†ä¼šä»æœåŠ¡æ³¨å†Œè¡¨ä¸­æŠŠè¿™ä¸ªæœåŠ¡èŠ‚ç‚¹ç§»é™¤ï¼ˆé»˜è®¤90ç§’ï¼‰</p><h3 id="2ã€åŸºæœ¬ä½¿ç”¨"><a href="#2ã€åŸºæœ¬ä½¿ç”¨" class="headerlink" title="2ã€åŸºæœ¬ä½¿ç”¨"></a>2ã€åŸºæœ¬ä½¿ç”¨</h3><blockquote><p>æœåŠ¡ç«¯</p></blockquote><p>pom</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-eureka-server<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.4.7.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--çƒ­éƒ¨ç½²å·¥å…·--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-devtools<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br></code></pre></td></tr></table></figure><p>application.yml</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">7001</span><br><br><span class="hljs-comment">#Eurekaé…ç½®</span><br><span class="hljs-attr">eureka:</span><br>  <span class="hljs-attr">instance:</span><br>    <span class="hljs-attr">hostname:</span> <span class="hljs-string">localhost</span> <span class="hljs-comment">#EurekaæœåŠ¡ç«¯çš„å®ä¾‹åç§°</span><br>  <span class="hljs-attr">client:</span><br>    <span class="hljs-attr">register-with-eureka:</span> <span class="hljs-literal">false</span>   <span class="hljs-comment">#è¡¨ç¤ºæ˜¯å¦å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±</span><br>    <span class="hljs-attr">fetch-registry:</span> <span class="hljs-literal">false</span>   <span class="hljs-comment">#ä¸ºfalseè¡¨ç¤ºè‡ªå·±æ˜¯æ³¨å†Œä¸­å¿ƒ</span><br>    <span class="hljs-attr">service-url:</span>    <span class="hljs-comment">#ç›‘æ§é¡µé¢</span><br>      <span class="hljs-attr">defaultZone:</span> <span class="hljs-string">http://$&#123;eureka.instance.hostname&#125;:$&#123;server.port&#125;/eureka/</span><br></code></pre></td></tr></table></figure><p>å¯åŠ¨ç±»</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@EnableEurekaServer</span> <span class="hljs-comment">//å¯åŠ¨æœåŠ¡å‘ç°ï¼Œæ¥å—æ³¨å†Œ</span><br><span class="hljs-variable">@SpringBootApplication</span><br>public class EurekaServer_7001 &#123;<br><br>    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">static</span> <span class="hljs-selector-tag">void</span> <span class="hljs-selector-tag">main</span>(String[] args) &#123;<br>        <span class="hljs-selector-tag">SpringApplication</span><span class="hljs-selector-class">.run</span>(EurekaServer_7001.class, args);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯åŠ¨é¡¹ç›®ï¼Œè®¿é—® <a href="http://localhost:7001/">http://localhost:7001/</a></p><blockquote><p>å®¢æˆ·ç«¯</p></blockquote><p>pom</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-eureka<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.4.7.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>application</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment">#Eurekaé…ç½®</span><br><span class="hljs-attr">eureka:</span><br>  <span class="hljs-attr">client:</span><br>    <span class="hljs-attr">service-url:</span><br>      <span class="hljs-attr">defaultZone:</span> <span class="hljs-string">http://localhost:7001/eureka/</span><br>  <span class="hljs-attr">instance:</span><br>    <span class="hljs-attr">instance-id:</span> <span class="hljs-string">springcloud-provider-dept-8001</span>   <span class="hljs-comment"># ä¿®æ”¹eurekaä¸Šçš„é»˜è®¤æè¿°ä¿¡æ¯</span><br>    <span class="hljs-attr">prefer-ip-address:</span> <span class="hljs-literal">true</span>  <span class="hljs-comment"># true,å¯ä»¥æ˜¾ç¤ºæœåŠ¡çš„IPåœ°å€</span><br></code></pre></td></tr></table></figure><p>å¯åŠ¨ç±»</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@SpringBootApplication</span><br><span class="hljs-variable">@EnableEurekaClient</span><br>public class DeptProvider_8001 &#123;<br><br>    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">static</span> <span class="hljs-selector-tag">void</span> <span class="hljs-selector-tag">main</span>(String[] args) &#123;<br>        <span class="hljs-selector-tag">SpringApplication</span><span class="hljs-selector-class">.run</span>(DeptProvider_8001.class,args);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>to be continedâ€¦.</p><p>å‚è€ƒ</p><ul><li><a href="https://blog.csdn.net/qq_36903261/article/details/106551120">https://blog.csdn.net/qq_36903261/article/details/106551120</a></li><li><a href="https://blog.csdn.net/qq_45078781/article/details/118671285">https://blog.csdn.net/qq_45078781/article/details/118671285</a></li><li><a href="https://www.bilibili.com/video/BV18E411x7eT">https://www.bilibili.com/video/BV18E411x7eT</a></li><li><a href="https://zhuanlan.zhihu.com/p/142941185">https://zhuanlan.zhihu.com/p/142941185</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>å¾®æœåŠ¡</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>springcloud</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é€šè¿‡RestTemplateè¿›è¡Œè¿œç¨‹è°ƒç”¨</title>
    <link href="/2023/11/22/%E9%80%9A%E8%BF%87RestTemplate%E8%BF%9B%E8%A1%8C%E8%BF%9C%E7%A8%8B%E8%B0%83%E7%94%A8/"/>
    <url>/2023/11/22/%E9%80%9A%E8%BF%87RestTemplate%E8%BF%9B%E8%A1%8C%E8%BF%9C%E7%A8%8B%E8%B0%83%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<p>RestTemplate æ˜¯ä» Spring3.0 å¼€å§‹æ”¯æŒçš„ä¸€ä¸ª HTTP è¯·æ±‚å·¥å…·ï¼Œå®ƒæä¾›äº†å¸¸è§çš„RESTè¯·æ±‚æ–¹æ¡ˆçš„æ¨¡ç‰ˆã€‚å¯¹äºè¿œç¨‹è¯·æ±‚è¿›è¡Œäº†ä¸€å®šå°è£…ï¼Œä»è€Œé€šè¿‡å»ºè®®é…ç½®å¯ä»¥å®ç°è¿œç¨‹è°ƒç”¨ã€‚</p><p>ä»–åº•å±‚ç”¨çš„æ˜¯ JDK çš„ HTTP è¯·æ±‚</p><ol><li>æ·»åŠ ä¾èµ–</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.2.2.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.httpcomponents<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>httpclient<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.5.7<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><ol start="2"><li>é…ç½®ç±»</li></ol><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs haxe"><span class="hljs-keyword">package</span> com.example.demo.config;<br><br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><span class="hljs-keyword">import</span> org.springframework.http.client.ClientHttpRequestFactory;<br><span class="hljs-keyword">import</span> org.springframework.http.client.SimpleClientHttpRequestFactory;<br><span class="hljs-keyword">import</span> org.springframework.web.client.RestTemplate;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * RestTemplateé…ç½®ç±»</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-title class_"><span class="hljs-keyword">class</span> <span class="hljs-title">RestTemplateConfig</span> </span>&#123;<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> RestTemplate restTemplate(ClientHttpRequestFactory factory)&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-type">RestTemplate</span>(factory);<br>    &#125;<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> ClientHttpRequestFactory simpleClientHttpRequestFactory()&#123;<br>        SimpleClientHttpRequestFactory factory = <span class="hljs-keyword">new</span> <span class="hljs-type">SimpleClientHttpRequestFactory</span>();<br>        factory.setReadTimeout(<span class="hljs-number">5000</span>);<span class="hljs-comment">//å•ä½ä¸ºms</span><br>        factory.setConnectTimeout(<span class="hljs-number">5000</span>);<span class="hljs-comment">//å•ä½ä¸ºms</span><br>        <span class="hljs-keyword">return</span> factory;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol start="3"><li>ç¤ºä¾‹è°ƒç”¨æ“ä½œ</li></ol><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-meta">@RestController</span><br><span class="hljs-meta">@Slf4j</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderController</span> &#123;<br><br>    <span class="hljs-keyword">public</span> static <span class="hljs-keyword">final</span> String PAYMENT_URL = <span class="hljs-string">&quot;http://localhost:8001&quot;</span>;<br><br>    <span class="hljs-meta">@Resource</span><br>    <span class="hljs-keyword">private</span> RestTemplate restTemplate;<br><br>    <span class="hljs-comment">//å› ä¸ºæµè§ˆå™¨åªæ”¯æŒgetè¯·æ±‚ï¼Œä¸ºäº†æ–¹ä¾¿è¿™é‡Œå°±ç”¨get</span><br>    <span class="hljs-meta">@GetMapping(<span class="hljs-string">&quot;/consumer/payment/create&quot;</span>)</span><br>    <span class="hljs-keyword">public</span> CommonResult&lt;Payment&gt; create(Payment payment)&#123;<br>        log.info(<span class="hljs-string">&quot;********æ’å…¥çš„æ•°æ®ï¼š&quot;</span> + payment);<br>        <span class="hljs-comment">//postForObjectåˆ†åˆ«æœ‰ä¸‰ä¸ªå‚æ•°ï¼šè¯·æ±‚åœ°å€ï¼Œè¯·æ±‚å‚æ•°ï¼Œè¿”å›çš„å¯¹è±¡ç±»å‹</span><br>        <span class="hljs-keyword">return</span> restTemplate.postForObject(PAYMENT_URL + <span class="hljs-string">&quot;/payment/create&quot;</span>, payment, CommonResult.<span class="hljs-keyword">class</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@GetMapping(<span class="hljs-string">&quot;/consumer/payment/get/&#123;id&#125;&quot;</span>)</span><br>    <span class="hljs-keyword">public</span> CommonResult&lt;Payment&gt; getPayment(<span class="hljs-meta">@PathVariable(<span class="hljs-string">&quot;id&quot;</span>)</span> <span class="hljs-built_in">Long</span> id)&#123;<br>        log.info(<span class="hljs-string">&quot;********æŸ¥è¯¢çš„idï¼š&quot;</span> + id);<br>        <span class="hljs-comment">//getForObjectä¸¤ä¸ªå‚æ•°ï¼šè¯·æ±‚åœ°å€ï¼Œè¿”å›çš„å¯¹è±¡ç±»å‹</span><br>        <span class="hljs-keyword">return</span> restTemplate.getForObject(PAYMENT_URL + <span class="hljs-string">&quot;/payment/get/&quot;</span> + id, CommonResult.<span class="hljs-keyword">class</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>to be continedâ€¦ </p><p>å‚è€ƒ</p><ul><li><a href="https://blog.csdn.net/weixin_44073321/article/details/102804615">https://blog.csdn.net/weixin_44073321/article/details/102804615</a></li><li><a href="https://blog.csdn.net/weixin_43702146/article/details/116567707">https://blog.csdn.net/weixin_43702146/article/details/116567707</a></li><li><a href="https://blog.csdn.net/dqxiaoxiao/article/details/114375873">https://blog.csdn.net/dqxiaoxiao/article/details/114375873</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>CodeProgram</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>spring</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¸¸è§å·¥ç¨‹æŠ¥é”™é—®é¢˜</title>
    <link href="/2023/11/22/%E5%B8%B8%E8%A7%81%E5%B7%A5%E7%A8%8B%E6%8A%A5%E9%94%99%E9%97%AE%E9%A2%98/"/>
    <url>/2023/11/22/%E5%B8%B8%E8%A7%81%E5%B7%A5%E7%A8%8B%E6%8A%A5%E9%94%99%E9%97%AE%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<p>to be continedâ€¦.</p>]]></content>
    
    
    <categories>
      
      <category>éƒ¨ç½²</category>
      
    </categories>
    
    
    <tags>
      
      <tag>project</tag>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringCloud_ç»„ä»¶åŸºæœ¬ä½¿ç”¨_åŸºç¡€æ¦‚å¿µ</title>
    <link href="/2023/11/22/SpringCloud_%E7%BB%84%E4%BB%B6%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/"/>
    <url>/2023/11/22/SpringCloud_%E7%BB%84%E4%BB%B6%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/</url>
    
    <content type="html"><![CDATA[<h3 id="1ã€SpringCloudæ˜¯ä»€ä¹ˆ"><a href="#1ã€SpringCloudæ˜¯ä»€ä¹ˆ" class="headerlink" title="1ã€SpringCloudæ˜¯ä»€ä¹ˆ"></a>1ã€SpringCloudæ˜¯ä»€ä¹ˆ</h3><p>SpringCloud æä¾›äº†ä¸€æ•´å¥—çš„åˆ†å¸ƒå¼ç³»ç»Ÿè§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡ Spring Boot é£æ ¼çš„å°è£…ï¼Œå±è”½æ‰äº†å¤æ‚çš„é…ç½®å’Œå®ç°åŸç†ï¼Œæœ€ç»ˆç»™å¼€å‘è€…ç•™å‡ºäº†ä¸€å¥—ç®€å•æ˜“æ‡‚ã€å®¹æ˜“éƒ¨ç½²çš„åˆ†å¸ƒå¼ç³»ç»Ÿå¼€å‘å·¥å…·åŒ…ã€‚</p><p>SpringCloud åŒ…å«äº†ï¼šæœåŠ¡æ³¨å†Œä¸å‘ç°ã€é…ç½®ä¸­å¿ƒã€æœåŠ¡ç½‘å…³ã€æ™ºèƒ½è·¯ç”±ã€è´Ÿè½½å‡è¡¡ã€æ–­è·¯å™¨ã€ç›‘æ§è·Ÿè¸ªã€åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—ç­‰ã€‚</p><p>Spring Cloud åŒ…å«å¾ˆå¤šå­é¡¹ç›®ï¼Œå›½å†…ä¸»è¦æ˜¯é‡‡ç”¨ Netflix å’Œ Alibaba ä¸¤ä¸ªæ ‡å‡†å®ç°ï¼Œå‰è€…ç”±äºä¸å†ç»´æŠ¤ï¼Œç›®å‰ä¸€èˆ¬é‡‡ç”¨Spring Cloud Alibaba è¿™ä¸€å¥—å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆã€‚</p><blockquote><p>äº†è§£ç»„ä»¶</p></blockquote><p>Spring Cloud Netflix ç¬¬ä¸€ä»£</p><p>é’ˆå¯¹å¤šç§ Netflix ç»„ä»¶æä¾›çš„å¼€å‘å·¥å…·åŒ…ï¼Œå…¶ä¸­åŒ…æ‹¬ Eurekaã€Ribbonã€Feignã€Hystrixã€Zuulã€Archaius ç­‰ã€‚</p><ul><li><code>Netflix Eureka</code>ï¼šä¸€ä¸ªåŸºäº Rest æœåŠ¡çš„æœåŠ¡æ²»ç†ç»„ä»¶ï¼ŒåŒ…æ‹¬æœåŠ¡æ³¨å†Œä¸­å¿ƒã€æœåŠ¡æ³¨å†Œä¸æœåŠ¡å‘ç°æœºåˆ¶çš„å®ç°ï¼Œå®ç°äº†äº‘ç«¯è´Ÿè½½å‡è¡¡å’Œä¸­é—´å±‚æœåŠ¡å™¨çš„æ•…éšœè½¬ç§»ã€‚</li><li><code>Netflix Ribbon</code>ï¼šå®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡çš„æœåŠ¡è°ƒç”¨ç»„ä»¶ã€‚</li><li><code>Netflix Hystrix</code>ï¼šå®¹é”™ç®¡ç†å·¥å…·ï¼Œå®ç°æ–­è·¯å™¨æ¨¡å¼ï¼Œé€šè¿‡æ§åˆ¶æœåŠ¡çš„èŠ‚ç‚¹ï¼Œä»è€Œå¯¹å»¶è¿Ÿå’Œæ•…éšœæä¾›æ›´å¼ºå¤§çš„å®¹é”™èƒ½åŠ›ã€‚</li><li><code>Netflix Feign</code>ï¼šåŸºäº Ribbon å’Œ Hystrix çš„å£°æ˜å¼æœåŠ¡è°ƒç”¨ç»„ä»¶ã€‚</li><li><code>Netflix Zuul</code>ï¼šå¾®æœåŠ¡ç½‘å…³ï¼Œæä¾›åŠ¨æ€è·¯ç”±ï¼Œè®¿é—®è¿‡æ»¤ç­‰æœåŠ¡ã€‚</li><li><code>Netflix Archaius</code>ï¼šé…ç½®ç®¡ç† APIï¼ŒåŒ…å«ä¸€ç³»åˆ—é…ç½®ç®¡ç† APIï¼Œæä¾›åŠ¨æ€ç±»å‹åŒ–å±æ€§ã€çº¿ç¨‹å®‰å…¨é…ç½®æ“ä½œã€è½®è¯¢æ¡†æ¶ã€å›è°ƒæœºåˆ¶ç­‰åŠŸèƒ½ã€‚</li></ul><p>Spring Cloud Alibaba ç¬¬äºŒä»£</p><p><strong>é˜¿é‡Œå¼€æºç»„ä»¶</strong></p><ul><li><code>Nacos</code>ï¼šé˜¿é‡Œå·´å·´å¼€æºäº§å“ï¼Œä¸€ä¸ªæ›´æ˜“äºæ„å»ºäº‘åŸç”Ÿåº”ç”¨çš„åŠ¨æ€æœåŠ¡å‘ç°ã€é…ç½®ç®¡ç†å’ŒæœåŠ¡ç®¡ç†å¹³å°ã€‚</li><li><code>Sentinel</code>ï¼šé¢å‘åˆ†å¸ƒå¼æœåŠ¡æ¶æ„çš„è½»é‡çº§æµé‡æ§åˆ¶äº§å“ï¼ŒæŠŠæµé‡ä½œä¸ºåˆ‡å…¥ç‚¹ï¼Œä»æµé‡æ§åˆ¶ã€ç†”æ–­é™çº§ã€ç³»ç»Ÿè´Ÿè½½ä¿æŠ¤ç­‰å¤šä¸ªç»´åº¦ä¿æŠ¤æœåŠ¡çš„ç¨³å®šæ€§ã€‚</li><li><code>RocketMQ</code>ï¼šä¸€æ¬¾å¼€æºçš„åˆ†å¸ƒå¼æ¶ˆæ¯ç³»ç»Ÿï¼ŒåŸºäºé«˜å¯ç”¨åˆ†å¸ƒå¼é›†ç¾¤æŠ€æœ¯ï¼Œæä¾›ä½å»¶æ—¶çš„ã€é«˜å¯é çš„æ¶ˆæ¯å‘å¸ƒä¸è®¢é˜…æœåŠ¡ã€‚</li><li><code>Dubbo</code>ï¼šApache Dubboâ„¢ æ˜¯ä¸€æ¬¾é«˜æ€§èƒ½ Java RPC æ¡†æ¶ï¼Œç”¨äºå®ç°æœåŠ¡é€šä¿¡ã€‚</li><li><code>Seata</code>ï¼šé˜¿é‡Œå·´å·´å¼€æºäº§å“ï¼Œä¸€ä¸ªæ˜“äºä½¿ç”¨çš„é«˜æ€§èƒ½å¾®æœåŠ¡åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆã€‚</li></ul><p><strong>é˜¿é‡Œå•†ä¸šåŒ–ç»„ä»¶</strong></p><ul><li><code>Alibaba Cloud ACM</code>ï¼šä¸€æ¬¾åœ¨åˆ†å¸ƒå¼æ¶æ„ç¯å¢ƒä¸­å¯¹åº”ç”¨é…ç½®è¿›è¡Œé›†ä¸­ç®¡ç†å’Œæ¨é€çš„åº”ç”¨é…ç½®ä¸­å¿ƒäº§å“ã€‚</li><li><code>Alibaba Cloud OSS</code>ï¼šé˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨æœåŠ¡ï¼ˆObject Storage Serviceï¼Œç®€ç§° OSSï¼‰ï¼Œæ˜¯é˜¿é‡Œäº‘æä¾›çš„æµ·é‡ã€å®‰å…¨ã€ä½æˆæœ¬ã€é«˜å¯é çš„äº‘å­˜å‚¨æœåŠ¡ã€‚æ‚¨å¯ä»¥åœ¨ä»»ä½•åº”ç”¨ã€ä»»ä½•æ—¶é—´ã€ä»»ä½•åœ°ç‚¹å­˜å‚¨å’Œè®¿é—®ä»»æ„ç±»å‹çš„æ•°æ®ã€‚</li><li><code>Alibaba Cloud SchedulerX</code>ï¼šé˜¿é‡Œä¸­é—´ä»¶å›¢é˜Ÿå¼€å‘çš„ä¸€æ¬¾åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦äº§å“ï¼Œæä¾›ç§’çº§ã€ç²¾å‡†ã€é«˜å¯é ã€é«˜å¯ç”¨çš„å®šæ—¶ï¼ˆåŸºäº Cron è¡¨è¾¾å¼ï¼‰ä»»åŠ¡è°ƒåº¦æœåŠ¡ã€‚</li><li><code>Alibaba Cloud SMS</code>ï¼šè¦†ç›–å…¨çƒçš„çŸ­ä¿¡æœåŠ¡ï¼Œå‹å¥½ã€é«˜æ•ˆã€æ™ºèƒ½çš„äº’è”åŒ–é€šè®¯èƒ½åŠ›ï¼Œå¸®åŠ©ä¼ä¸šè¿…é€Ÿæ­å»ºå®¢æˆ·è§¦è¾¾é€šé“ã€‚</li></ul><blockquote><p>å…³äºCloudå„ç§ç»„ä»¶çš„åœæ›´å‡çº§æ›¿æ¢</p></blockquote><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311221942122.png" alt="image.png"></p><blockquote><p>SpringCloud ç‰ˆæœ¬ä»‹ç»</p></blockquote><p>ç•¥</p><h3 id="2ã€åˆ›å»ºcloudèšåˆçˆ¶å·¥ç¨‹"><a href="#2ã€åˆ›å»ºcloudèšåˆçˆ¶å·¥ç¨‹" class="headerlink" title="2ã€åˆ›å»ºcloudèšåˆçˆ¶å·¥ç¨‹"></a>2ã€åˆ›å»ºcloudèšåˆçˆ¶å·¥ç¨‹</h3><h4 id="åˆå§‹åŒ–å·¥ç¨‹åŠé…ç½®"><a href="#åˆå§‹åŒ–å·¥ç¨‹åŠé…ç½®" class="headerlink" title="åˆå§‹åŒ–å·¥ç¨‹åŠé…ç½®"></a>åˆå§‹åŒ–å·¥ç¨‹åŠé…ç½®</h4><ol><li>New Project</li></ol><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311221957842.png" alt="image.png"></p><ol start="2"><li>èšåˆæ€»çˆ¶å·¥ç¨‹åå­—</li><li>Mavené€‰ç‰ˆæœ¬</li><li>å¼€å¯è‡ªåŠ¨å¯¼å…¥</li></ol><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311221958787.png" alt="image.png"></p><ol start="5"><li>å­—ç¬¦ç¼–ç </li></ol><p>Settings â†’ Editor â†’  File Encodings</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311222220247.png" alt="image.png"></p><ol start="6"><li>æ³¨è§£ç”Ÿæ•ˆæ¿€æ´»</li></ol><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311222222672.png" alt="image.png"></p><ol start="7"><li>javaç¼–è¯‘ç‰ˆæœ¬é€‰8</li></ol><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311222223525.png" alt="image.png"></p><ol start="8"><li>File Typeè¿‡æ»¤</li></ol><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311222225655.png" alt="image.png"></p><p>è¿™é‡ŒFile Type é…ç½®</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-comment">*.idea</span><br><span class="hljs-comment">*.iml</span><br></code></pre></td></tr></table></figure><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311222226068.png" alt="image.png"></p><h4 id="çˆ¶å·¥ç¨‹-pom-é…ç½®"><a href="#çˆ¶å·¥ç¨‹-pom-é…ç½®" class="headerlink" title="çˆ¶å·¥ç¨‹ pom é…ç½®"></a>çˆ¶å·¥ç¨‹ pom é…ç½®</h4><p>çˆ¶å·¥ç¨‹ Pom æ–‡ä»¶å‚è€ƒé…ç½®</p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.luoqi.springcloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>  </span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>cloud2023<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>  </span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>  </span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">packaging</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">packaging</span>&gt;</span>  </span><br><span class="language-xml">  </span><br><span class="language-xml"><span class="hljs-comment">&lt;!--ç»Ÿä¸€ç®¡ç†jaråŒ…ç‰ˆæœ¬--&gt;</span>  </span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span>  </span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="hljs-tag">&lt;/<span class="hljs-name">project.build.sourceEncoding</span>&gt;</span>  </span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.source</span>&gt;</span>1.8<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.source</span>&gt;</span>  </span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.target</span>&gt;</span>1.8<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.target</span>&gt;</span>  </span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">junit.version</span>&gt;</span>4.12<span class="hljs-tag">&lt;/<span class="hljs-name">junit.version</span>&gt;</span>  </span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">lombok.version</span>&gt;</span>1.18.10<span class="hljs-tag">&lt;/<span class="hljs-name">lombok.version</span>&gt;</span>  </span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">log4j.version</span>&gt;</span>1.2.17<span class="hljs-tag">&lt;/<span class="hljs-name">log4j.version</span>&gt;</span>  </span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">mysql.version</span>&gt;</span>8.0.18<span class="hljs-tag">&lt;/<span class="hljs-name">mysql.version</span>&gt;</span>  </span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">druid.version</span>&gt;</span>1.1.20<span class="hljs-tag">&lt;/<span class="hljs-name">druid.version</span>&gt;</span>  </span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">mybatis.spring.boot.version</span>&gt;</span>1.3.2<span class="hljs-tag">&lt;/<span class="hljs-name">mybatis.spring.boot.version</span>&gt;</span>  </span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span>  </span><br><span class="language-xml">  </span><br><span class="language-xml"><span class="hljs-comment">&lt;!--å­æ¨¡å—ç»§æ‰¿ä¹‹åï¼Œæä¾›ä½œç”¨ï¼šé”å®šç‰ˆæœ¬+å­moduleä¸ç”¨å†™groupIdå’Œversion--&gt;</span>  </span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencyManagement</span>&gt;</span>  </span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>  </span><br><span class="language-xml">    <span class="hljs-comment">&lt;!--spring boot 2.2.2--&gt;</span>  </span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-dependencies<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.2.2.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>  </span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>  </span><br><span class="language-xml">    <span class="hljs-comment">&lt;!--spring cloud Hoxton.SR1--&gt;</span>  </span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-dependencies<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>Hoxton.SR1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>  </span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>  </span><br><span class="language-xml">    <span class="hljs-comment">&lt;!--spring cloud alibaba--&gt;</span>  </span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-alibaba-dependencies<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.2.0.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>  </span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>  </span><br><span class="language-xml">    <span class="hljs-comment">&lt;!--mysql--&gt;</span>  </span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>$</span><span class="hljs-template-variable">&#123;mysql.version&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>runtime<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>  </span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>  </span><br><span class="language-xml">    <span class="hljs-comment">&lt;!-- druid--&gt;</span>  </span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>druid-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>$</span><span class="hljs-template-variable">&#123;druid.version&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>  </span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>  </span><br><span class="language-xml">  </span><br><span class="language-xml">    <span class="hljs-comment">&lt;!--mybatis--&gt;</span>  </span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>$</span><span class="hljs-template-variable">&#123;mybatis.spring.boot.version&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>  </span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>  </span><br><span class="language-xml">    <span class="hljs-comment">&lt;!--junit--&gt;</span>  </span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>$</span><span class="hljs-template-variable">&#123;junit.version&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>  </span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>  </span><br><span class="language-xml">    <span class="hljs-comment">&lt;!--log4j--&gt;</span>  </span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>log4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>log4j<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>$</span><span class="hljs-template-variable">&#123;log4j.version&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>  </span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>  </span><br><span class="language-xml">  </span><br><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>  </span><br><span class="language-xml">  </span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">dependencyManagement</span>&gt;</span>  </span><br><span class="language-xml">  </span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span>  </span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span>  </span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.2.2.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span>  </span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">fork</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">fork</span>&gt;</span>  </span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">addResources</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">addResources</span>&gt;</span>  </span><br><span class="language-xml">      <span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span>  </span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span>  </span><br><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span>  </span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span></span><br></code></pre></td></tr></table></figure><h4 id="åˆ›å»ºå­æ¨¡å—"><a href="#åˆ›å»ºå­æ¨¡å—" class="headerlink" title="åˆ›å»ºå­æ¨¡å—"></a>åˆ›å»ºå­æ¨¡å—</h4><ul><li><ol><li>æ–°å»ºæ¨¡å—</li></ol></li><li><ol start="2"><li>pomæ–‡ä»¶å¯¹åº”ä¾èµ–</li></ol></li><li><ol start="3"><li>yml é…ç½®æ–‡ä»¶</li></ol></li><li><ol start="4"><li>å¯åŠ¨ç±»ä»¥åŠå…¶ä»–ä¸šåŠ¡ç±»</li></ol></li></ul><hr><p>å‚è€ƒ</p><ul><li><a href="https://gitee.com/lixiaogou/cloud2020">https://gitee.com/lixiaogou/cloud2020</a></li><li><a href="https://blog.csdn.net/qq_36903261/article/details/106507150">https://blog.csdn.net/qq_36903261/article/details/106507150</a></li><li><a href="https://github.com/angenin/cloud2020">https://github.com/angenin/cloud2020</a></li><li><a href="https://www.bilibili.com/video/BV18E411x7eT">https://www.bilibili.com/video/BV18E411x7eT</a></li><li><a href="https://zhuanlan.zhihu.com/p/110249846">https://zhuanlan.zhihu.com/p/110249846</a></li></ul><p>å¼•ç”¨</p><ul><li><a href="https://www.bookstack.cn/read/spring-cloud-docs/docs-index.md">https://www.bookstack.cn/read/spring-cloud-docs/docs-index.md</a></li><li><a href="https://www.springcloud.cc/">https://www.springcloud.cc/</a></li><li><a href="https://cloud.spring.io/spring-cloud-static/Hoxton.SR5/reference/htmlsingle/">https://cloud.spring.io/spring-cloud-static/Hoxton.SR5/reference/htmlsingle/</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>å¾®æœåŠ¡</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>springcloud</tag>
      
      <tag>spring</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Chapters1_æé™ä¸è¿ç»­</title>
    <link href="/2023/11/21/Chapters1_%E6%9E%81%E9%99%90%E4%B8%8E%E8%BF%9E%E7%BB%AD/"/>
    <url>/2023/11/21/Chapters1_%E6%9E%81%E9%99%90%E4%B8%8E%E8%BF%9E%E7%BB%AD/</url>
    
    <content type="html"><![CDATA[<h3 id="1ã€æ˜ å°„ä¸å‡½æ•°"><a href="#1ã€æ˜ å°„ä¸å‡½æ•°" class="headerlink" title="1ã€æ˜ å°„ä¸å‡½æ•°"></a>1ã€æ˜ å°„ä¸å‡½æ•°</h3><p>å­¦ä¹ æé™å‰ï¼Œå…ˆäº†è§£ä¸€äº›åŸºç¡€æ¦‚å¿µï¼Œå¯¹äºå‡½æ•°æ•´ä¸ªå†…å®¹æœ‰ä¸€ä¸ªè®¤è¯†ã€‚</p><h4 id="å‡½æ•°çš„æ¦‚å¿µ"><a href="#å‡½æ•°çš„æ¦‚å¿µ" class="headerlink" title="å‡½æ•°çš„æ¦‚å¿µ"></a>å‡½æ•°çš„æ¦‚å¿µ</h4><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311210437941.png" alt="image.png"></p><p>å®šä¹‰ï¼šå®šä¹‰åŸŸå†…<strong>ä»»ä½•</strong>å…ƒç´ ï¼Œéƒ½åœ¨å€¼åŸŸä¸­æœ‰<strong>å”¯ä¸€</strong>çš„å…ƒç´ ä¸ä¹‹å¯¹åº”ã€‚</p><p>å‡½æ•°æ¦‚å¿µæœ‰ä¸¤ä¸ªåŸºæœ¬è¦ç´ ï¼šå®šä¹‰åŸŸã€å¯¹åº”æ³•åˆ™ã€‚</p><p>ç†è§£ï¼šå‡½æ•°æ˜¯ç ”ç©¶å…³ç³»çš„ï¼Œæ˜¯åœ¨ç ”ç©¶ä¸¤ä¸ªå˜é‡ä¹‹é—´çš„å…³ç³»ã€‚å…·ä½“æ¥è¯´ï¼Œå‡½æ•°æ˜¯ç ”ç©¶å› å˜é‡æ˜¯æ€ä¹ˆéšç€è‡ªå˜é‡çš„å˜åŒ–è€Œå˜åŒ–çš„ã€‚</p><blockquote><p>ä¸¾ä¾‹</p></blockquote><p>ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨é€Ÿåº¦ä¸º40km&#x2F;hçš„åŒ€é€Ÿè¿åŠ¨è¿‡ç¨‹ä¸­ï¼Œè·¯ç¨‹éšæ—¶é—´çš„å˜åŒ–è€Œå˜åŒ–ï¼š</p><ul><li>æ—¶é—´æ˜¯1æ—¶ï¼Œè·¯ç¨‹æ˜¯40ï¼›</li><li>æ—¶é—´æ˜¯2æ—¶ï¼Œè·¯ç¨‹å°±æ˜¯80ã€‚</li></ul><p>è·¯ç¨‹&#x3D;40 * æ—¶é—´ã€‚è·¯ç¨‹å°±å«åšæ—¶é—´çš„å‡½æ•°ã€‚</p><p>ä½†ä¸æ˜¯æœ‰å…³ç³»å°±æ˜¯å‡½æ•°ï¼Œä¸æ˜¯å› å˜é‡éšè‡ªå˜é‡å˜åŒ–å°±æ˜¯å‡½æ•°ã€‚è¿˜å¾—æ»¡è¶³ä¸€ä¸ªé‡è¦çš„æ¡ä»¶ï¼šå¯¹äºè‡ªå˜é‡çš„æ¯ä¸€ä¸ªå–å€¼ï¼Œå› å˜é‡éƒ½æœ‰å”¯ä¸€çš„å€¼ä¸å®ƒå¯¹åº”ï¼</p><p>ä¾‹å¦‚ï¼Œä¸Šè¿°åŒ€é€Ÿè¿åŠ¨è¿‡ç¨‹ä¸­ï¼Œæ—¶é—´æ¯å–ä¸€ä¸ªå€¼ï¼Œå¯¹åº”è®¡ç®—å‡ºè·¯ç¨‹ä¹Ÿæ˜¯ä¸€ä¸ªå€¼ã€‚</p><p>åä¾‹ï¼š|y|&#x3D;xï¼Œåœ¨è¿™ä¸ªå¼å­é‡Œï¼Œyä¹Ÿéšxçš„å˜åŒ–è€Œå˜åŒ–ï¼Œä½†x&#x3D;1æ—¶ï¼Œy&#x3D;1æˆ–â€”1ï¼Œæœ‰ä¸¤ä¸ªå€¼äº†ã€‚é‚£yå°±ä¸æ˜¯xçš„å‡½æ•°äº†ã€‚</p><p>æ‰€ä»¥ï¼Œå‡½æ•°æ˜¯ä¸¤ä¸ªå˜é‡ä¹‹é—´çš„ç‰¹æ®Šå…³ç³»</p><h4 id="å‡ ä¸ªå¸¸è§å‡½æ•°"><a href="#å‡ ä¸ªå¸¸è§å‡½æ•°" class="headerlink" title="å‡ ä¸ªå¸¸è§å‡½æ•°"></a>å‡ ä¸ªå¸¸è§å‡½æ•°</h4><ul><li>ç»å¯¹å€¼å‡½æ•°</li><li>ç¬¦å·å‡½æ•°</li><li>å–æ•´å‡½æ•°</li></ul><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311210449362.png" alt="image.png"></p><h4 id="å‡½æ•°çš„ç‰¹æ€§"><a href="#å‡½æ•°çš„ç‰¹æ€§" class="headerlink" title="å‡½æ•°çš„ç‰¹æ€§"></a>å‡½æ•°çš„ç‰¹æ€§</h4><ul><li>æœ‰ç•Œæ€§</li><li>å•è°ƒæ€§</li><li>å¥‡å¶æ€§</li><li>å‘¨æœŸæ€§</li></ul><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311210452693.png" alt="image.png"></p><h4 id="åå‡½æ•°ä¸å¤åˆå‡½æ•°"><a href="#åå‡½æ•°ä¸å¤åˆå‡½æ•°" class="headerlink" title="åå‡½æ•°ä¸å¤åˆå‡½æ•°"></a>åå‡½æ•°ä¸å¤åˆå‡½æ•°</h4><blockquote><p>åå‡½æ•°</p></blockquote><p>å®šä¹‰ï¼š</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311210455686.png" alt="image.png"></p><blockquote><p>å¤åˆå‡½æ•°</p></blockquote><p>å¤åˆæ¡ä»¶ï¼šå†…å±‚å‡½æ•°å€¼åŸŸä¸å¤–å±‚å‡½æ•°å®šä¹‰åŸŸçš„äº¤é›†éç©º</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311210456045.png" alt="image.png"></p><h4 id="å‡½æ•°çš„è¿ç®—"><a href="#å‡½æ•°çš„è¿ç®—" class="headerlink" title="å‡½æ•°çš„è¿ç®—"></a>å‡½æ•°çš„è¿ç®—</h4><p>å‡½æ•°çš„è¿ç®—ï¼ˆåŠ å‡ä¹˜é™¤ï¼‰</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311210457870.png" alt="image.png"></p><p>å…¶ä¸­å‡½æ•°ç›¸é™¤çš„æ—¶å€™ g(x) ä¸ç­‰äº 0 </p><p>ç›¸å…³å®šç†ï¼šä»»ä½•ä¸€ä¸ªå‡½æ•°(å®šä¹‰åŸŸå¯¹ç§°)éƒ½å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªå¥‡å‡½æ•°å’Œä¸€ä¸ªå¶å‡½æ•°ï¼Œä½¿å¾—è¿™ä¸ªå‡½æ•°ç­‰äºå¶å‡½æ•°åŠ å¥‡å‡½æ•°</p><blockquote><p>ä¾‹é¢˜ï¼ˆè¯æ˜é¢˜ï¼‰</p></blockquote><p>ä»¥å‡½æ•°çš„è¿ç®—è¯æ˜:ä»»ç»™f(x)çš„å®šä¹‰åŸŸä¸º(-L,L),è¯æ˜å¿…å­˜åœ¨(-L,L)ä¸Šçš„å¶å‡½æ•°g(x)ä»¥åŠå¥‡å‡½æ•°h(x),ä½¿å¾—f(x)&#x3D;g(x)+h(x)</p><p>è§£æï¼š</p><p>æ ¹æ®å‰é¢å‡½æ•°ç‰¹å¾ä¸­çš„å¥‡å¶æ€§ï¼Œå¯ä»¥å¾—çŸ¥ å¥‡å‡½æ•° h( -x ) &#x3D; -h(x) ; å¶å‡½æ•° g(-x) &#x3D; g(x)</p><p>å…ˆå‡è®¾å­˜åœ¨è¿™æ ·çš„å¥‡å¶å‡½æ•°ï¼Œ</p><p>to be improveâ€¦.</p><p>è§£ç­”ï¼š</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311210502430.png" alt="image.png"></p><h4 id="åˆç­‰å‡½æ•°"><a href="#åˆç­‰å‡½æ•°" class="headerlink" title="åˆç­‰å‡½æ•°"></a>åˆç­‰å‡½æ•°</h4><p>å®šä¹‰ï¼šç”±å¸¸æ•°å’ŒåŸºæœ¬åˆç­‰å‡½æ•°ç»è¿‡æœ‰é™æ¬¡çš„åŠ ã€å‡ã€ä¹˜ã€ é™¤å’Œå¤åˆæ‰€å¾—åˆ°ä¸”èƒ½ç”¨ä¸€ä¸ªè§£æå¼è¡¨ç¤ºçš„å‡½æ•°,ç§°ä¸ºåˆç­‰å‡½æ•°</p><blockquote><p>åŸºæœ¬åˆç­‰å‡½æ•°</p></blockquote><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311210504661.png" alt="image.png"></p><blockquote><p>å…³äºåä¸‰è§’å‡½æ•°</p></blockquote><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311210505070.png" alt="image.png"></p><blockquote><p>å†…å®¹å°ç»“</p></blockquote><ul><li>å‡½æ•°çš„å®šä¹‰åŠå‡½æ•°çš„äºŒè¦ç´ <ul><li>å®šä¹‰åŸŸ</li><li>å¯¹åº”æ³•åˆ™</li></ul></li><li>å‡½æ•°çš„ç‰¹æ€§<ul><li>æœ‰ç•Œæ€§ï¼Œå•è°ƒæ€§ï¼Œå¥‡å¶æ€§ï¼Œå‘¨æœŸæ€§</li></ul></li><li>å¤åˆå‡½æ•°ä¸åå‡½æ•°</li><li>åŸºæœ¬åˆç­‰å‡½æ•°ä¸åˆç­‰å‡½æ•°</li></ul><h3 id="2ã€æ•°åˆ—çš„æé™"><a href="#2ã€æ•°åˆ—çš„æé™" class="headerlink" title="2ã€æ•°åˆ—çš„æé™"></a>2ã€æ•°åˆ—çš„æé™</h3><h4 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h4><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311210548604.png" alt="image.png"></p><blockquote><p>ä¾‹é¢˜</p></blockquote><p>ç”¨å®šä¹‰è¯æ˜ä¸‹åˆ—æé™</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311210550053.png" alt="image.png"></p><h4 id="æ”¶æ•›å‡½æ•°çš„æ€§è´¨"><a href="#æ”¶æ•›å‡½æ•°çš„æ€§è´¨" class="headerlink" title="æ”¶æ•›å‡½æ•°çš„æ€§è´¨"></a>æ”¶æ•›å‡½æ•°çš„æ€§è´¨</h4><p>æ”¶æ•›å‡½æ•°çš„æ€§è´¨</p><ul><li>å”¯ä¸€æ€§<ul><li>æ”¶æ•›æ•°åˆ—çš„æé™å”¯ä¸€</li></ul></li><li>æœ‰ç•Œæ€§<ul><li>æ”¶æ•›æ•°åˆ—å¿…æœ‰ç•Œ</li></ul></li><li>ä¿å·æ€§</li><li>ä»»ä¸€å­æ•°åˆ—æ”¶æ•›äºåŒä¸€æé™</li></ul><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311210553054.png" alt="image.png"></p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311210554140.png" alt="image.png"></p><p>to be continedâ€¦</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://zhuanlan.zhihu.com/p/563178651">https://zhuanlan.zhihu.com/p/563178651</a></li><li><a href="https://www.zhihu.com/question/457091692/answer/2763695044">https://www.zhihu.com/question/457091692/answer/2763695044</a></li><li><a href="https://zhuanlan.zhihu.com/p/31206539">https://zhuanlan.zhihu.com/p/31206539</a></li><li>ã€Šæ­¦å¿ è¯¦é«˜æ•°é›¶åŸºç¡€ã€‹</li></ul>]]></content>
    
    
    <categories>
      
      <category>Exam</category>
      
    </categories>
    
    
    <tags>
      
      <tag>math</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Nginx_åŸºç¡€æ¦‚å¿µ</title>
    <link href="/2023/11/20/Nginx_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/"/>
    <url>/2023/11/20/Nginx_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/</url>
    
    <content type="html"><![CDATA[<h3 id="1ã€å¯åŠ¨Nginx"><a href="#1ã€å¯åŠ¨Nginx" class="headerlink" title="1ã€å¯åŠ¨Nginx"></a>1ã€å¯åŠ¨Nginx</h3><blockquote><p>Windows ä¸‹å¯åŠ¨ nginx</p></blockquote><p>åœ¨ä¸‹è½½ nginx åï¼Œåœ¨nginxå®‰è£…ç›®å½•çš„ç»å¯¹è·¯å¾„çš„æ¡†æ¡†å†…è¾“å…¥Â <code>cmd</code></p><p>ç›´æ¥è¾“å…¥Â <code>nginx</code>Â æˆ–è€…Â <code>start nginx</code>ï¼Œç„¶åå›è½¦ï¼Œå°±å¯ä»¥å¯åŠ¨nginx</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">nginx<br><br><span class="hljs-literal">start</span> nginx<br></code></pre></td></tr></table></figure><p>åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥Â <code>localhost:80</code>ï¼Œç„¶åå†å›è½¦, æŸ¥çœ‹æ˜¯å¦æœ‰ nginx è®¿é—®ä¸»é¡µï¼Œå¦‚æœæœ‰ï¼Œåˆ™å¯åŠ¨æˆåŠŸã€‚</p><p>ä¸€èˆ¬è®¿é—®é—®é¢˜æ˜¯ç«¯å£å ç”¨ï¼Œå¯ä»¥æ”¹ä¸€ä¸‹ nginx è®¿é—®ç«¯å£ï¼Œæˆ–è€…æ€æ‰å¯¹åº”è¿›ç¨‹ã€‚</p><p>å…³é—­nginxçš„å‘½ä»¤ï¼š</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">nginx -s stop<br></code></pre></td></tr></table></figure><p>é‡æ–°åŠ è½½</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">nginx -s reload</span><br></code></pre></td></tr></table></figure><p>to be continedâ€¦.</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://blog.csdn.net/weixin_44251179/article/details/129700793">https://blog.csdn.net/weixin_44251179/article/details/129700793</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>éƒ¨ç½²</category>
      
    </categories>
    
    
    <tags>
      
      <tag>nginx</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Docsifyä½¿ç”¨æ•™ç¨‹</title>
    <link href="/2023/11/19/Docsify%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/"/>
    <url>/2023/11/19/Docsify%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/</url>
    
    <content type="html"><![CDATA[<h3 id="1ã€å¿«é€Ÿå¼€å§‹"><a href="#1ã€å¿«é€Ÿå¼€å§‹" class="headerlink" title="1ã€å¿«é€Ÿå¼€å§‹"></a>1ã€å¿«é€Ÿå¼€å§‹</h3><p>å…¨å±€å®‰è£…Â <code>docsify-cli</code>Â å·¥å…·ï¼Œå¯ä»¥æ–¹ä¾¿åœ°åˆ›å»ºåŠåœ¨æœ¬åœ°é¢„è§ˆç”Ÿæˆçš„æ–‡æ¡£ã€‚</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm">npm i docsify-<span class="hljs-keyword">cli</span> -g<br></code></pre></td></tr></table></figure><blockquote><p>åˆå§‹åŒ–é¡¹ç›®</p></blockquote><p>å¦‚æœæƒ³åœ¨é¡¹ç›®çš„Â <code>./docs</code>Â ç›®å½•é‡Œå†™æ–‡æ¡£ï¼Œç›´æ¥é€šè¿‡Â <code>init</code>Â åˆå§‹åŒ–é¡¹ç›®ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docsify init ./docs<br></code></pre></td></tr></table></figure><blockquote><p>å¼€å§‹å†™æ–‡æ¡£</p></blockquote><p>åˆå§‹åŒ–æˆåŠŸåï¼Œå¯ä»¥çœ‹åˆ°Â <code>./docs</code>Â ç›®å½•ä¸‹åˆ›å»ºçš„å‡ ä¸ªæ–‡ä»¶</p><ul><li><code>index.html</code>Â å…¥å£æ–‡ä»¶</li><li><code>README.md</code>Â ä¼šåšä¸ºä¸»é¡µå†…å®¹æ¸²æŸ“</li><li><code>.nojekyll</code>Â ç”¨äºé˜»æ­¢ GitHub Pages å¿½ç•¥æ‰ä¸‹åˆ’çº¿å¼€å¤´çš„æ–‡ä»¶</li></ul><p>ç›´æ¥ç¼–è¾‘Â <code>docs/README.md</code>Â å°±èƒ½æ›´æ–°æ–‡æ¡£å†…å®¹ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ·»åŠ æ›´å¤šé¡µé¢ã€‚</p><blockquote><p>æœ¬åœ°é¢„è§ˆ</p></blockquote><p>é€šè¿‡è¿è¡ŒÂ <code>docsify serve</code>Â å¯åŠ¨ä¸€ä¸ªæœ¬åœ°æœåŠ¡å™¨ï¼Œå¯ä»¥æ–¹ä¾¿åœ°å®æ—¶é¢„è§ˆæ•ˆæœã€‚</p><p>é»˜è®¤è®¿é—®åœ°å€Â <a href="http://localhost:3000/">http://localhost:3000</a>Â ã€‚</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">docsify serve docs</span><br></code></pre></td></tr></table></figure><h3 id="2ã€å¤šé¡µæ–‡æ¡£è®¾ç½®"><a href="#2ã€å¤šé¡µæ–‡æ¡£è®¾ç½®" class="headerlink" title="2ã€å¤šé¡µæ–‡æ¡£è®¾ç½®"></a>2ã€å¤šé¡µæ–‡æ¡£è®¾ç½®</h3><p>åœ¨ docsify ä¸­ï¼Œä½ è®¿é—®çš„æ–‡æ¡£ URL è·¯å¾„åœ°å€å’Œä½ çš„æ–‡æ¡£æ–‡ä»¶å¤¹ç»“æ„æ˜¯ä¸€ä¸ªæ˜ å°„å…³ç³»ï¼ˆå®ç°å¤šçº§è·¯ç”±ï¼‰ï¼›</p><p>æ¯”å¦‚ä½ åœ¨ doc æ–‡ä»¶å¤¹ä¸­åˆ›å»º<code>guide.md</code>ã€<code>zh-cn/READEME.md</code>ã€<code>zh-cn/guide.md</code>ï¼Œç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dos">.<br>â”œâ”€â”€ README.<span class="hljs-built_in">md</span><br>â”œâ”€â”€ guide.<span class="hljs-built_in">md</span><br>â”œâ”€â”€ index.html<br>â””â”€â”€ zh-cn<br>    â”œâ”€â”€ README.<span class="hljs-built_in">md</span><br>    â””â”€â”€ guide.<span class="hljs-built_in">md</span><br></code></pre></td></tr></table></figure><p>æ­¤æ—¶æˆ‘ä»¬è®¿é—®å¦‚ä¸‹urlå³å¯ä»¥è®¿é—®åˆ°å¯¹åº”çš„é¡µé¢ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs awk">README.md=&gt; http:<span class="hljs-regexp">//</span>localhost:<span class="hljs-number">3000</span><span class="hljs-regexp">/#/</span><br>guide.md=&gt; http:<span class="hljs-regexp">//</span>localhost:<span class="hljs-number">3000</span><span class="hljs-regexp">/#/gui</span>de<br><span class="hljs-regexp">/zh-cn/</span>README.md  =&gt; http:<span class="hljs-regexp">//</span>localhost:<span class="hljs-number">3000</span><span class="hljs-regexp">/#/</span>zh-cn/<br><span class="hljs-regexp">/zh-cn/gui</span>de.md   =&gt; http:<span class="hljs-regexp">//</span>localhost:<span class="hljs-number">3000</span><span class="hljs-regexp">/#/</span>zh-cn/guide<br><br></code></pre></td></tr></table></figure><h3 id="3ã€å®šåˆ¶åŒ–é…ç½®"><a href="#3ã€å®šåˆ¶åŒ–é…ç½®" class="headerlink" title="3ã€å®šåˆ¶åŒ–é…ç½®"></a>3ã€å®šåˆ¶åŒ–é…ç½®</h3><h4 id="ä¾§è¾¹æ è®¾ç½®"><a href="#ä¾§è¾¹æ è®¾ç½®" class="headerlink" title="ä¾§è¾¹æ è®¾ç½®"></a>ä¾§è¾¹æ è®¾ç½®</h4><p>éœ€è¦å…ˆåœ¨ docs&#x2F;index.html ä¸­ä¿®æ”¹ä¸€ä¸‹é…ç½®ï¼Œå¼€å¯ä¾§è¾¹æ çš„é€‰é¡¹æ·»åŠ <code>loadSiderbar: true</code></p><p>è¿™æ ·è®¾ç½®åå°±ä¼šåŠ è½½ Docsify ç›®å½•ä¸‹çš„ _ sidebar.md æ–‡ä»¶,  è¿›è¡ŒåŠ è½½è€Œæ¸²æŸ“æˆæˆ‘ä»¬å®šåˆ¶çš„ä¾§è¾¹æ </p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs actionscript"><span class="hljs-comment">// å¼€å¯ä¾§è¾¹æ å®šåˆ¶,åŠ è½½_sidebar.md </span><br>loadSidebar: <span class="hljs-literal">true</span>,<br></code></pre></td></tr></table></figure><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311201949003.png" alt="image.png"></p><p>æˆ‘ä»¬åœ¨ docs ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªÂ <code>_sidebar.md</code>Â æ–‡ä»¶ï¼Œé‡Œé¢å¯ä»¥å¯¹ä¾§è¾¹æ è¿›è¡Œé…ç½®ï¼Œæ¯”å¦‚è¿™é‡Œé…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- docs/_sidebar.md --&gt;</span><br><br>* [é¦–é¡µ](/) <br>* [guide](/guide)<br>* [zh-cn](zh-cn/)<br>* [zh-cn guide](zh-cn/guide)<br></code></pre></td></tr></table></figure><p>è¿™é‡Œä½¿ç”¨çš„æ˜¯ MarkDown ä¸­çš„è¶…é“¾æ¥è¯­æ³•ï¼Œåé¢çš„è·¯å¾„å¯¹åº”ç€ä¸Šè¿°å¤šé¡µæ–‡æ¡£çš„è·¯ç”±è·¯å¾„</p><p>æˆ‘ä»¬è¿˜å¯ä»¥æŒ‡å®šé¡µé¢çš„æ ‡é¢˜ï¼Œæ¯”å¦‚è¿™é‡ŒæŒ‡å®šé¦–é¡µçš„æ ‡é¢˜ä¸ºhome ã€åé¢æ·»åŠ åŒå¼•å·è¿›è¡Œåˆ«åã€‘</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- docs/_sidebar.md --&gt;</span><br><br>* [é¦–é¡µ](/ &quot;home&quot;) <br>* [guide](/guide)<br>* [zh-cn](zh-cn/)<br>* [zh-cn guide](zh-cn/guide)<br></code></pre></td></tr></table></figure><h4 id="ä¾§è¾¹æ åµŒå¥—è®¾ç½®"><a href="#ä¾§è¾¹æ åµŒå¥—è®¾ç½®" class="headerlink" title="ä¾§è¾¹æ åµŒå¥—è®¾ç½®"></a>ä¾§è¾¹æ åµŒå¥—è®¾ç½®</h4><p>åœ¨å¯¹åº”å­ç›®å½• docs&#x2F;zh-cn ä¸‹åˆ›å»ºä¸€ä¸ªÂ <code>_sidebar.md</code> æ–‡ä»¶ï¼Œé…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- docs/zh-cn/_sidebar.md --&gt;</span><br><br>* [zh-ché¦–é¡µ](/zh-cn) <br>* [zh-cn guide](zh-cn/guide)<br></code></pre></td></tr></table></figure><p>_ sidebar.md çš„åŠ è½½é€»è¾‘æ˜¯ä»æ¯å±‚ç›®å½•ä¸‹è·å–æ–‡ä»¶ï¼Œå¦‚æœå½“å‰ç›®å½•ä¸å­˜åœ¨è¯¥æ–‡ä»¶åˆ™å›é€€åˆ°ä¸Šä¸€çº§ç›®å½•ã€‚<br>ä¾‹å¦‚å½“å‰è·¯å¾„ä¸º &#x2F;zh-cn åˆ™ä» &#x2F;zh-cn&#x2F;_ sidebar.md è·å–æ–‡ä»¶ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™ä» &#x2F;_ sidebar.md è·å–ï¼Œ</p><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ index.html ä¸­å¦‚ä¸‹é…ç½®è¡¨ç¤ºé»˜è®¤éƒ½èµ°æ ¹è·¯å¾„ä¸‹çš„Â <code>_sidebar.md</code>Â æ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">  <span class="hljs-variable language_">window</span>.<span class="hljs-property">$docsify</span> = &#123;</span><br><span class="language-javascript">    <span class="hljs-attr">loadSidebar</span>: <span class="hljs-literal">true</span>,</span><br><span class="language-javascript">    <span class="hljs-attr">alias</span>: &#123;</span><br><span class="language-javascript">      <span class="hljs-string">&#x27;/.*/_sidebar.md&#x27;</span>: <span class="hljs-string">&#x27;/_sidebar.md&#x27;</span></span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript">  &#125;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="å¼€å¯ç›®å½•åŠŸèƒ½"><a href="#å¼€å¯ç›®å½•åŠŸèƒ½" class="headerlink" title="å¼€å¯ç›®å½•åŠŸèƒ½"></a>å¼€å¯ç›®å½•åŠŸèƒ½</h4><p>è‡ªå®šä¹‰ä¾§è¾¹æ åŒæ—¶ä¹Ÿå¯ä»¥å¼€å¯ç›®å½•åŠŸèƒ½ã€‚è®¾ç½®Â <code>subMaxLevel</code>Â é…ç½®é¡¹</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- index.html --&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">  <span class="hljs-variable language_">window</span>.<span class="hljs-property">$docsify</span> = &#123;</span><br><span class="language-javascript">    <span class="hljs-attr">loadSidebar</span>: <span class="hljs-literal">true</span>,</span><br><span class="language-javascript">    <span class="hljs-comment">// å¼€å¯ç›®å½•,æœ€å¤§å±‚çº§ä¸º2</span></span><br><span class="language-javascript">    <span class="hljs-attr">subMaxLevel</span>: <span class="hljs-number">2</span></span><br><span class="language-javascript">  &#125;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;//cdn.jsdelivr.net/npm/docsify/lib/docsify.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="ç›®å½•æŠ˜å åŠŸèƒ½"><a href="#ç›®å½•æŠ˜å åŠŸèƒ½" class="headerlink" title="ç›®å½•æŠ˜å åŠŸèƒ½"></a>ç›®å½•æŠ˜å åŠŸèƒ½</h4><p>éœ€è¦å¼•å…¥ä¸€ä¸‹ docsify-sidebar-collapse æ ·å¼ , å…·ä½“é…ç½®å¯ä»¥çœ‹ä¸€ä¸‹ä¸‹é¢ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge,chrome=1&quot;</span> /&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;description&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;Description&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0, minimum-scale=1.0&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;//cdn.jsdelivr.net/npm/docsify@4/lib/themes/vue.css&quot;</span>&gt;</span><br>  <span class="hljs-comment">&lt;!-- æ–‡ä»¶å¤¹æ ·å¼ --&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;//cdn.jsdelivr.net/npm/docsify-sidebar-collapse/dist/sidebar-folder.min.css&quot;</span> /&gt;</span><br>  <span class="hljs-comment">&lt;!-- ç®­å¤´æ ·å¼ --&gt;</span><br>  <span class="hljs-comment">&lt;!-- &lt;link rel=&quot;stylesheet&quot; href=&quot;//cdn.jsdelivr.net/npm/docsify-sidebar-collapse/dist/sidebar.min.css&quot; /&gt; --&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;app&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-variable language_">window</span>.<span class="hljs-property">$docsify</span> = &#123;</span><br><span class="language-javascript">      <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;&#x27;</span>,</span><br><span class="language-javascript">      <span class="hljs-attr">repo</span>: <span class="hljs-string">&#x27;&#x27;</span>,</span><br><span class="language-javascript">  <span class="hljs-comment">// å¼€å¯ä¾§è¾¹æ å®šåˆ¶,åŠ è½½_sidebar.md </span></span><br><span class="language-javascript">  <span class="hljs-attr">loadSidebar</span>: <span class="hljs-literal">true</span>,</span><br><span class="language-javascript">  <span class="hljs-comment">// å¼€å¯ç›®å½•,æœ€å¤§å±‚çº§ä¸º2</span></span><br><span class="language-javascript">  <span class="hljs-attr">subMaxLevel</span>: <span class="hljs-number">2</span>,</span><br><span class="language-javascript">  <span class="hljs-attr">alias</span>: &#123;</span><br><span class="language-javascript">    <span class="hljs-string">&#x27;/.*/_sidebar.md&#x27;</span>: <span class="hljs-string">&#x27;/_sidebar.md&#x27;</span></span><br><span class="language-javascript">  &#125;,</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>  <span class="hljs-comment">&lt;!-- Docsify v4 --&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;//cdn.jsdelivr.net/npm/docsify@4&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>  <span class="hljs-comment">&lt;!-- ä¾§è¾¹æ ç›®å½•æŠ˜å  --&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://cdn.jsdelivr.net/npm/docsify-sidebar-collapse/dist/docsify-sidebar-collapse.min.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="å¯¼èˆªæ "><a href="#å¯¼èˆªæ " class="headerlink" title="å¯¼èˆªæ "></a>å¯¼èˆªæ </h4><p>æ·»åŠ å¯¼èˆªæ æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€æ˜¯ç›´æ¥åˆ° index.html ä¸­æ·»åŠ ï¼ŒäºŒæ˜¯å’Œä¾§è¾¹æ ç±»ä¼¼ï¼Œé€šè¿‡ md æ–‡ä»¶çš„å½¢å¼æ¥æ·»åŠ ã€‚</p><blockquote><p><strong>é€šè¿‡mdæ–‡ä»¶æ¥æ·»åŠ </strong></p></blockquote><p>é¦–å…ˆåœ¨ index.html ä¸­é…ç½®Â <code>loadNavbar</code>ï¼Œé»˜è®¤åŠ è½½çš„æ–‡ä»¶ä¸ºÂ <code>_navbar.md</code> </p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs actionscript"><span class="hljs-comment">// å¼€å¯å¯¼èˆªæ ,åŠ è½½_navbar.md </span><br>loadNavbar: <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><blockquote><p>åµŒå¥—åˆ—è¡¨</p></blockquote><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs scss">&lt;!-- _navbar<span class="hljs-selector-class">.md</span> --&gt;<br><br>* å…¥é—¨<br>  * <span class="hljs-selector-attr">[å¿«é€Ÿå¼€å§‹]</span>(zh-cn/quickstart.md)<br>  * <span class="hljs-selector-attr">[å¤šé¡µæ–‡æ¡£]</span>(zh-cn/more-pages.md)<br>  * <span class="hljs-selector-attr">[å®šåˆ¶å¯¼èˆªæ ]</span>(zh-cn/custom-navbar.md)<br>  * <span class="hljs-selector-attr">[å°é¢]</span>(zh-cn/cover.md)<br><br><br>* é…ç½®<br>  * <span class="hljs-selector-attr">[é…ç½®é¡¹]</span>(zh-cn/configuration.md)<br>  * <span class="hljs-selector-attr">[ä¸»é¢˜]</span>(zh-cn/themes.md)<br>  * <span class="hljs-selector-attr">[ä½¿ç”¨æ’ä»¶]</span>(zh-cn/plugins.md)<br>  * <span class="hljs-selector-attr">[Markdown é…ç½®]</span>(zh-cn/markdown.md)<br>  * <span class="hljs-selector-attr">[ä»£ç é«˜äº®]</span>(zh-cn/language-highlight.md)<br></code></pre></td></tr></table></figure><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311202158957.png" alt="image.png"></p><h4 id="å°é¢"><a href="#å°é¢" class="headerlink" title="å°é¢"></a>å°é¢</h4><p>åœ¨ index.html ä¸­è®¾ç½®Â <code>coverpage</code>Â å‚æ•°å¼€å¯å°é¢åŠŸèƒ½</p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs actionscript"><span class="hljs-comment">// å¼€å¯å°é¢,åŠ è½½_coverpage.md</span><br>coverpage: <span class="hljs-literal">true</span>,<br></code></pre></td></tr></table></figure><p>åœ¨æ–‡æ¡£æ ¹ç›®å½•åˆ›å»ºÂ <code>_coverpage.md</code>Â æ–‡ä»¶ï¼Œç”¨äºé…ç½®å°é¢å†…å®¹</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs markdown"><span class="hljs-section"># docsify <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">small</span>&gt;</span></span>3.5<span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">small</span>&gt;</span></span></span><br><br><span class="hljs-quote">&gt; ä¸€ä¸ªç¥å¥‡çš„æ–‡æ¡£ç½‘ç«™ç”Ÿæˆå™¨ã€‚</span><br><br><span class="hljs-bullet">-</span> ç®€å•ã€è½»ä¾¿ (å‹ç¼©å ~21kB)<br><span class="hljs-bullet">-</span> æ— éœ€ç”Ÿæˆ html æ–‡ä»¶<br><span class="hljs-bullet">-</span> ä¼—å¤šä¸»é¢˜<br><br>[<span class="hljs-string">GitHub</span>](<span class="hljs-link">https://github.com/docsifyjs/docsify/</span>)<br></code></pre></td></tr></table></figure><p>ç›®å‰çš„èƒŒæ™¯æ˜¯éšæœºç”Ÿæˆçš„æ¸å˜è‰²ï¼Œå¯ä»¥è‡ªå®šä¹‰èƒŒæ™¯è‰²æˆ–è€…èƒŒæ™¯å›¾ã€‚åœ¨æ–‡æ¡£æœ«å°¾ç”¨æ·»åŠ å›¾ç‰‡çš„ Markdown è¯­æ³•è®¾ç½®èƒŒæ™¯ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- ç½‘ç«™å›¾æ ‡ --&gt;</span><br>![logo](_media/icon.jpg)<br><br># docsify <span class="hljs-tag">&lt;<span class="hljs-name">small</span>&gt;</span>3.5<span class="hljs-tag">&lt;/<span class="hljs-name">small</span>&gt;</span><br><br>&gt; ä¸€ä¸ªç¥å¥‡çš„æ–‡æ¡£ç½‘ç«™ç”Ÿæˆå™¨ã€‚<br><br>- ç®€å•ã€è½»ä¾¿ (å‹ç¼©å ~21kB)<br>- æ— éœ€ç”Ÿæˆ html æ–‡ä»¶<br>- ä¼—å¤šä¸»é¢˜<br><br>[GitHub](https://github.com/docsifyjs/docsify/)<br><br><span class="hljs-comment">&lt;!-- èƒŒæ™¯å›¾ç‰‡ --&gt;</span><br>![](_media/ç©å®¶.png)<br><br><span class="hljs-comment">&lt;!-- èƒŒæ™¯è‰² --&gt;</span><br>![color](#f0f0f0)<br></code></pre></td></tr></table></figure><p>é€šå¸¸å°é¢å’Œé¦–é¡µæ˜¯åŒæ—¶å‡ºç°çš„ï¼Œä½ å¯ä»¥å°†å°é¢ç‹¬ç«‹å‡ºæ¥</p><p>é…ç½®ï¼ˆåªåœ¨è®¿é—®ä¸»é¡µæ—¶åŠ è½½å°é¢ï¼‰ï¼š</p><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xquery"><span class="hljs-keyword">window</span>.<span class="hljs-variable">$docsify</span> = &#123;<br>  onlyCover:<span class="hljs-built_in"> false</span>,<br>&#125;;<br></code></pre></td></tr></table></figure><h4 id="ä¸»é¢˜"><a href="#ä¸»é¢˜" class="headerlink" title="ä¸»é¢˜"></a>ä¸»é¢˜</h4><p>è§ï¼š <a href="https://docsify.js.org/#/zh-cn/themes">https://docsify.js.org/#/zh-cn/themes</a></p><h3 id="4ã€åŸºäºnginx-docsifyæ­å»º"><a href="#4ã€åŸºäºnginx-docsifyæ­å»º" class="headerlink" title="4ã€åŸºäºnginx + docsifyæ­å»º"></a>4ã€åŸºäºnginx + docsifyæ­å»º</h3><p>nginx é…ç½®æ–‡ä»¶ä¸­ï¼Œåœ¨Â <code>http</code>Â å—å†…æ·»åŠ ä¸€ä¸ªæ–°çš„Â <code>server</code>Â é…ç½®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">location /docs &#123;<br><span class="hljs-built_in">alias</span> D:/shareDocs/docs; <span class="hljs-comment"># ä¿®æ”¹ä¸ºä½ çš„ Docsify é¡¹ç›®ç»å¯¹è·¯å¾„</span><br>index index.html;<br>try_files <span class="hljs-variable">$uri</span> <span class="hljs-variable">$uri</span>/ /index.html;<br>&#125;<br></code></pre></td></tr></table></figure><hr><p>å‚è€ƒ</p><ul><li><a href="https://docsify.js.org/#/zh-cn/quickstart">https://docsify.js.org/#/zh-cn/quickstart</a></li><li><a href="https://www.cnblogs.com/Can-daydayup/p/15413267.html">https://www.cnblogs.com/Can-daydayup/p/15413267.html</a></li><li><a href="https://ysgstudyhards.github.io/Docsify-Guide/#/README">https://ysgstudyhards.github.io/Docsify-Guide/#/README</a></li><li><a href="https://blog.csdn.net/qq_45173404/article/details/122683872">https://blog.csdn.net/qq_45173404/article/details/122683872</a></li><li><a href="https://developer.aliyun.com/article/1266542">https://developer.aliyun.com/article/1266542</a></li><li><a href="https://clotliu.com/archives/docsify-advanced">https://clotliu.com/archives/docsify-advanced</a></li><li><a href="https://www.cnblogs.com/yangstar/articles/16690435.html">https://www.cnblogs.com/yangstar/articles/16690435.html</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>StatusPage</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hexo</tag>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NoSQL_åŸºç¡€æ¦‚å¿µ</title>
    <link href="/2023/11/19/NoSQL_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/"/>
    <url>/2023/11/19/NoSQL_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/</url>
    
    <content type="html"><![CDATA[<h3 id="1ã€NoSQL-æ˜¯ä»€ä¹ˆ"><a href="#1ã€NoSQL-æ˜¯ä»€ä¹ˆ" class="headerlink" title="1ã€NoSQL æ˜¯ä»€ä¹ˆ"></a>1ã€NoSQL æ˜¯ä»€ä¹ˆ</h3><p>NoSQLï¼ˆNot Only SQL çš„ç¼©å†™ï¼‰æ³›æŒ‡éå…³ç³»å‹çš„æ•°æ®åº“ï¼Œä¸»è¦é’ˆå¯¹çš„æ˜¯é”®å€¼ã€æ–‡æ¡£ä»¥åŠå›¾å½¢ç±»å‹æ•°æ®å­˜å‚¨ã€‚å¹¶ä¸”ï¼ŒNoSQL æ•°æ®åº“å¤©ç”Ÿæ”¯æŒåˆ†å¸ƒå¼ï¼Œæ•°æ®å†—ä½™å’Œæ•°æ®åˆ†ç‰‡ç­‰ç‰¹æ€§ï¼Œæ—¨åœ¨æä¾›å¯æ‰©å±•çš„é«˜å¯ç”¨é«˜æ€§èƒ½æ•°æ®å­˜å‚¨è§£å†³æ–¹æ¡ˆã€‚</p><p>NoSQL æ•°æ®åº“ä»£è¡¨ï¼šHBaseã€Cassandraã€MongoDBã€Redisã€‚</p><h4 id="SQL-å’Œ-NoSQL-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#SQL-å’Œ-NoSQL-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="SQL å’Œ NoSQL æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>SQL å’Œ NoSQL æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h4><table><thead><tr><th></th><th>SQL æ•°æ®åº“</th><th>NoSQL æ•°æ®åº“</th></tr></thead><tbody><tr><td>æ•°æ®å­˜å‚¨æ¨¡å‹</td><td>ç»“æ„åŒ–å­˜å‚¨ï¼Œå…·æœ‰å›ºå®šè¡Œå’Œåˆ—çš„è¡¨æ ¼</td><td>éç»“æ„åŒ–å­˜å‚¨ã€‚æ–‡æ¡£ï¼šJSON æ–‡æ¡£ï¼Œé”®å€¼ï¼šé”®å€¼å¯¹ï¼Œå®½åˆ—ï¼šåŒ…å«è¡Œå’ŒåŠ¨æ€åˆ—çš„è¡¨ï¼Œå›¾ï¼šèŠ‚ç‚¹å’Œè¾¹</td></tr><tr><td>å‘å±•å†ç¨‹</td><td>å¼€å‘äº 1970 å¹´ä»£ï¼Œé‡ç‚¹æ˜¯å‡å°‘æ•°æ®é‡å¤</td><td>å¼€å‘äº 2000 å¹´ä»£åæœŸï¼Œé‡ç‚¹æ˜¯æå‡å¯æ‰©å±•æ€§ï¼Œå‡å°‘å¤§è§„æ¨¡æ•°æ®çš„å­˜å‚¨æˆæœ¬</td></tr><tr><td>ä¾‹å­</td><td>Oracleã€MySQLã€Microsoft SQL Serverã€PostgreSQL</td><td>æ–‡æ¡£ï¼šMongoDBã€CouchDBï¼Œé”®å€¼ï¼šRedisã€DynamoDBï¼Œå®½åˆ—ï¼šCassandraã€ HBaseï¼Œå›¾è¡¨ï¼šNeo4jã€ Amazon Neptuneã€Giraph</td></tr><tr><td>ACID å±æ€§</td><td>æä¾›åŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§å’ŒæŒä¹…æ€§ (ACID) å±æ€§</td><td>é€šå¸¸ä¸æ”¯æŒ ACID äº‹åŠ¡ï¼Œä¸ºäº†å¯æ‰©å±•ã€é«˜æ€§èƒ½è¿›è¡Œäº†æƒè¡¡ï¼Œå°‘éƒ¨åˆ†æ”¯æŒæ¯”å¦‚ MongoDB ã€‚ä¸è¿‡ï¼ŒMongoDB å¯¹ ACID äº‹åŠ¡ çš„æ”¯æŒå’Œ MySQL è¿˜æ˜¯æœ‰æ‰€åŒºåˆ«çš„ã€‚</td></tr><tr><td>æ€§èƒ½</td><td>æ€§èƒ½é€šå¸¸å–å†³äºç£ç›˜å­ç³»ç»Ÿã€‚è¦è·å¾—æœ€ä½³æ€§èƒ½ï¼Œé€šå¸¸éœ€è¦ä¼˜åŒ–æŸ¥è¯¢ã€ç´¢å¼•å’Œè¡¨ç»“æ„ã€‚</td><td>æ€§èƒ½é€šå¸¸ç”±åº•å±‚ç¡¬ä»¶é›†ç¾¤å¤§å°ã€ç½‘ç»œå»¶è¿Ÿä»¥åŠè°ƒç”¨åº”ç”¨ç¨‹åºæ¥å†³å®šã€‚</td></tr><tr><td>æ‰©å±•</td><td>å‚ç›´ï¼ˆä½¿ç”¨æ€§èƒ½æ›´å¼ºå¤§çš„æœåŠ¡å™¨è¿›è¡Œæ‰©å±•ï¼‰ã€è¯»å†™åˆ†ç¦»ã€åˆ†åº“åˆ†è¡¨</td><td>æ¨ªå‘ï¼ˆå¢åŠ æœåŠ¡å™¨çš„æ–¹å¼æ¨ªå‘æ‰©å±•ï¼Œé€šå¸¸æ˜¯åŸºäºåˆ†ç‰‡æœºåˆ¶ï¼‰</td></tr><tr><td>ç”¨é€”</td><td>æ™®é€šä¼ä¸šçº§çš„é¡¹ç›®çš„æ•°æ®å­˜å‚¨</td><td>ç”¨é€”å¹¿æ³›æ¯”å¦‚å›¾æ•°æ®åº“æ”¯æŒåˆ†æå’Œéå†è¿æ¥æ•°æ®ä¹‹é—´çš„å…³ç³»ã€é”®å€¼æ•°æ®åº“å¯ä»¥å¤„ç†å¤§é‡æ•°æ®æ‰©å±•å’Œæé«˜çš„çŠ¶æ€å˜åŒ–</td></tr><tr><td>æŸ¥è¯¢è¯­æ³•</td><td>ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€ (SQL)</td><td>æ•°æ®è®¿é—®è¯­æ³•å¯èƒ½å› æ•°æ®åº“è€Œå¼‚</td></tr></tbody></table><h4 id="NoSQL-æ•°æ®åº“æœ‰å“ªäº›ç±»å‹ï¼Ÿ"><a href="#NoSQL-æ•°æ®åº“æœ‰å“ªäº›ç±»å‹ï¼Ÿ" class="headerlink" title="NoSQL æ•°æ®åº“æœ‰å“ªäº›ç±»å‹ï¼Ÿ"></a>NoSQL æ•°æ®åº“æœ‰å“ªäº›ç±»å‹ï¼Ÿ</h4><p>NoSQL æ•°æ®åº“ä¸»è¦å¯ä»¥åˆ†ä¸ºä¸‹é¢å››ç§ç±»å‹ï¼š</p><ul><li><strong>é”®å€¼</strong>ï¼šé”®å€¼æ•°æ®åº“æ˜¯ä¸€ç§è¾ƒç®€å•çš„æ•°æ®åº“ï¼Œå…¶ä¸­æ¯ä¸ªé¡¹ç›®éƒ½åŒ…å«é”®å’Œå€¼ã€‚è¿™æ˜¯æä¸ºçµæ´»çš„ NoSQL æ•°æ®åº“ç±»å‹ï¼Œå› ä¸ºåº”ç”¨å¯ä»¥å®Œå…¨æ§åˆ¶ value å­—æ®µä¸­å­˜å‚¨çš„å†…å®¹ï¼Œæ²¡æœ‰ä»»ä½•é™åˆ¶ã€‚Redis å’Œ DynanoDB æ˜¯ä¸¤æ¬¾éå¸¸æµè¡Œçš„é”®å€¼æ•°æ®åº“ã€‚</li><li><strong>æ–‡æ¡£</strong>ï¼šæ–‡æ¡£æ•°æ®åº“ä¸­çš„æ•°æ®è¢«å­˜å‚¨åœ¨ç±»ä¼¼äº JSONï¼ˆJavaScript å¯¹è±¡è¡¨ç¤ºæ³•ï¼‰å¯¹è±¡çš„æ–‡æ¡£ä¸­ï¼Œéå¸¸æ¸…æ™°ç›´è§‚ã€‚æ¯ä¸ªæ–‡æ¡£åŒ…å«æˆå¯¹çš„å­—æ®µå’Œå€¼ã€‚è¿™äº›å€¼é€šå¸¸å¯ä»¥æ˜¯å„ç§ç±»å‹ï¼ŒåŒ…æ‹¬å­—ç¬¦ä¸²ã€æ•°å­—ã€å¸ƒå°”å€¼ã€æ•°ç»„æˆ–å¯¹è±¡ç­‰ï¼Œå¹¶ä¸”å®ƒä»¬çš„ç»“æ„é€šå¸¸ä¸å¼€å‘è€…åœ¨ä»£ç ä¸­ä½¿ç”¨çš„å¯¹è±¡ä¿æŒä¸€è‡´ã€‚MongoDB å°±æ˜¯ä¸€æ¬¾éå¸¸æµè¡Œçš„æ–‡æ¡£æ•°æ®åº“ã€‚</li><li><strong>å›¾å½¢</strong>ï¼šå›¾å½¢æ•°æ®åº“æ—¨åœ¨è½»æ¾æ„å»ºå’Œè¿è¡Œä¸é«˜åº¦è¿æ¥çš„æ•°æ®é›†ä¸€èµ·ä½¿ç”¨çš„åº”ç”¨ç¨‹åºã€‚å›¾å½¢æ•°æ®åº“çš„å…¸å‹ä½¿ç”¨æ¡ˆä¾‹åŒ…æ‹¬ç¤¾äº¤ç½‘ç»œã€æ¨èå¼•æ“ã€æ¬ºè¯ˆæ£€æµ‹å’ŒçŸ¥è¯†å›¾å½¢ã€‚Neo4j å’Œ Giraph æ˜¯ä¸¤æ¬¾éå¸¸æµè¡Œçš„å›¾å½¢æ•°æ®åº“ã€‚</li><li><strong>å®½åˆ—</strong>ï¼šå®½åˆ—å­˜å‚¨æ•°æ®åº“éå¸¸é€‚åˆéœ€è¦å­˜å‚¨å¤§é‡çš„æ•°æ®ã€‚Cassandra å’Œ HBase æ˜¯ä¸¤æ¬¾éå¸¸æµè¡Œçš„å®½åˆ—å­˜å‚¨æ•°æ®åº“ã€‚</li></ul><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231119123254.png" alt="image.png"></p><hr><p>å‚è€ƒ</p><ul><li><a href="https://javaguide.cn/database/nosql.html">https://javaguide.cn/database/nosql.html</a></li><li><a href="https://www.ibm.com/cn-zh/topics/nosql-databases">https://www.ibm.com/cn-zh/topics/nosql-databases</a></li><li><a href="https://zhuanlan.zhihu.com/p/345342966">https://zhuanlan.zhihu.com/p/345342966</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
      <category>NoSQL</category>
      
    </categories>
    
    
    <tags>
      
      <tag>NoSQL</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ’ä»¶å®ç°Obsidianå®æ—¶åŒæ­¥</title>
    <link href="/2023/11/17/%E6%8F%92%E4%BB%B6%E5%AE%9E%E7%8E%B0Obsidian%E5%AE%9E%E6%97%B6%E5%90%8C%E6%AD%A5/"/>
    <url>/2023/11/17/%E6%8F%92%E4%BB%B6%E5%AE%9E%E7%8E%B0Obsidian%E5%AE%9E%E6%97%B6%E5%90%8C%E6%AD%A5/</url>
    
    <content type="html"><![CDATA[<h3 id="1ã€æ’ä»¶ä¸‹è½½å’ŒæœåŠ¡å®‰è£…"><a href="#1ã€æ’ä»¶ä¸‹è½½å’ŒæœåŠ¡å®‰è£…" class="headerlink" title="1ã€æ’ä»¶ä¸‹è½½å’ŒæœåŠ¡å®‰è£…"></a>1ã€æ’ä»¶ä¸‹è½½å’ŒæœåŠ¡å®‰è£…</h3><p>ä½¿ç”¨æ’ä»¶ï¼š Self-hosted LiveSync</p><p>åœ¨æœåŠ¡å™¨ä¸Šé¢å®‰è£… docker åï¼Œ</p><p>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ <code>local.ini</code></p><p>å¤åˆ¶ä»¥ä¸‹å†…å®¹</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[couchdb]</span><br><span class="hljs-attr">single_node</span>=<span class="hljs-literal">true</span><br><br><span class="hljs-section">[chttpd]</span><br><span class="hljs-attr">require_valid_user</span> = <span class="hljs-literal">true</span><br><br><span class="hljs-section">[chttpd_auth]</span><br><span class="hljs-attr">require_valid_user</span> = <span class="hljs-literal">true</span><br><span class="hljs-attr">authentication_redirect</span> = /_utils/session.html<br><br><span class="hljs-section">[httpd]</span><br><span class="hljs-attr">WWW-Authenticate</span> = Basic realm=<span class="hljs-string">&quot;couchdb&quot;</span><br><span class="hljs-attr">enable_cors</span> = <span class="hljs-literal">true</span><br><br><span class="hljs-section">[cors]</span><br><span class="hljs-attr">origins</span> = app://obsidian.md,capacitor://localhost,http://localhost<br><span class="hljs-attr">credentials</span> = <span class="hljs-literal">true</span><br><span class="hljs-attr">headers</span> = accept, authorization, content-type, origin, referer<br><span class="hljs-attr">methods</span> = GET, PUT, POST, HEAD, DELETE<br><span class="hljs-attr">max_age</span> = <span class="hljs-number">3600</span><br></code></pre></td></tr></table></figure><p>å°†è¯¥æ–‡ä»¶ç§»åŠ¨åˆ° <code>/opt/couchdb</code>ç›®å½•ä¸‹</p><p>è¿è¡Œä¸‹é¢å‘½ä»¤ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">docker <span class="hljs-built_in">run</span> -d --restart always -e <span class="hljs-attribute">COUCHDB_USER</span>=luo -e <span class="hljs-attribute">COUCHDB_PASSWORD</span>=luo123 -v /opt/couchdb/local.ini:/opt/couchdb/etc/local.ini -p 6900:5984 couchdb<br></code></pre></td></tr></table></figure><p>å…¶ä¸­:</p><ul><li><code>COUCHDB_USER</code>Â åé¢çš„æ˜¯ä½ çš„ç”¨æˆ·å</li><li><code>COUCHDB_PASSWORD</code>Â åé¢çš„æ˜¯ä½ çš„å¯†ç </li><li><code>/opt/couchdb/local.ini</code>Â æ˜¯é…ç½®æ–‡ä»¶çš„è·¯å¾„</li><li><code>/opt/couchdb/db</code>Â æ˜¯æ•°æ®åº“çš„è·¯å¾„</li><li><code>-p 6900:5984</code>Â å‰é¢çš„ 6900 æ˜¯æš´éœ²åœ¨å¤–çš„ç«¯å£ã€‚</li></ul><p>æ£€æŸ¥æ˜¯å¦è¿è¡ŒæˆåŠŸ</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">sudo docker <span class="hljs-keyword">ps</span> |<span class="hljs-keyword">grep</span> couchdb<br></code></pre></td></tr></table></figure><h3 id="2ã€æ’ä»¶é…ç½®"><a href="#2ã€æ’ä»¶é…ç½®" class="headerlink" title="2ã€æ’ä»¶é…ç½®"></a>2ã€æ’ä»¶é…ç½®</h3><p>æ‰“å¼€Obsidiançš„è®¾ç½®-ç¬¬ä¸‰æ–¹æ’ä»¶ï¼Œåœ¨æ’ä»¶å¸‚åœºå®‰è£…<code>Self-hosted LiveSync</code></p><blockquote><p>å®¢æˆ·ç«¯é…ç½®</p></blockquote><p>å®‰è£…å¹¶å¯ç”¨åæ‰“å¼€æ’ä»¶çš„è®¾ç½®ç•Œé¢ï¼Œå¡«å†™ç®­å¤´å†…å®¹ï¼ŒURI ä¸ºåˆšåˆšçš„<code>http://IP+ç«¯å£ï¼ˆ6900ï¼‰</code>ï¼Œä¾‹å¦‚ï¼š<code>http://127.0.0.1:6900</code>ï¼Œ</p><p>Username å’Œ Password ä¸ºå‰é¢çš„å‚æ•°è®¾ç½®çš„å†…å®¹ï¼Œ</p><p>Database name å¯ä»¥è‡ªå·±å–ï¼Œæ³¨æ„ä¸è¦å¡«å¤§å†™å­—æ¯ï¼Œå®Œæˆåç‚¹å‡»test æŒ‰é’®</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231118230051.png" alt="image.png"></p><p>å³ä¸Šè§’å‡ºç°Â <code>Connect to æ•°æ®åº“å</code>ï¼Œåˆ™ä¸ºè¿æ¥æˆåŠŸ</p><p>å¦‚æœä½ ä¹‹å‰é…ç½®è¿æ¥è¿‡ï¼Œå¹¶å­˜æ”¾è¿‡æ•°æ®ï¼Œä½ è¿æ¥åä¼šå°†å¯¹åº”çš„æ•°æ®åº“ä¸­çš„æ–‡ä»¶åŒæ­¥åˆ°ä½ ç›®å‰çš„å·¥ä½œç©ºé—´ä¸­ï¼›ä¹Ÿå¯ä»¥ç†è§£ä»–çš„æ•°æ®æ˜¯å­˜æ”¾åœ¨äº†æœåŠ¡å™¨ä¸­çš„æ•°æ®åº“ï¼Œè®¾å¤‡è¿æ¥è¯¥æœåŠ¡åçš„åŒæ­¥æ“ä½œï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯åœ¨æ“ä½œæ›´æ–°æœåŠ¡å™¨ä¸Šé¢çš„æ•°æ®åº“æ–‡ä»¶å†…å®¹ï¼Œç„¶åæ›´æ–°å¯¹åº”æ˜ å°„å†…å®¹åˆ°è®¾å¤‡çš„Obsidianæ–‡ä»¶ä¸­ã€‚</p><p>å®Œæˆåç‚¹å‡»ä¸‹é¢çš„check ï¼Œå°†æ‰€æœ‰æç¤ºé”™è¯¯çš„é€‰æ‹©fixï¼Œç„¶åå†æ¬¡ç‚¹å‡»check ï¼Œç›´åˆ°æ²¡æœ‰é”™è¯¯</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231118230528.png" alt="image.png"></p><p>åˆ’åˆ°æœ€ä¸‹æ–¹ï¼Œé€‰æ‹©ç«¯å¯¹ç«¯åŠ å¯†ï¼ˆEnd to End Encryptionï¼‰ï¼Œåœ¨è¾“å…¥æ¡†ä¸­è®¾ç½®å¯†ç ï¼Œç‚¹å‡»å¯ç”¨</p><p><strong>å¦‚æœä»…æƒ³è¦åŒæ­¥æ–‡ç« æ— éœ€å¼€å¯ç«¯å¯¹ç«¯åŠ å¯†</strong></p><p>åœ¨Sync Setting é€‰é¡¹å¡ä¸­ï¼Œé€‰æ‹©LiveSyncï¼ˆå®æ—¶åŒæ­¥ï¼‰ï¼Œç‚¹å‡»Applyå¯ç”¨</p><p>å»ºè®®å¯ç”¨Â <code>Use Trash for deleted files</code>ï¼ˆåˆ é™¤æ–‡ä»¶åˆ°å›æ”¶ç«™ï¼‰</p><p>å»ºè®®å¯ç”¨Â <code>Miscellaneous</code>Â é€‰é¡¹å¡ä¸­çš„Â <code>Show staus inside editor</code>Â ï¼ˆä¼šåœ¨ç¼–è¾‘å™¨å³ä¸Šè§’æ˜¾ç¤ºçŠ¶æ€ï¼‰</p><blockquote><p>å¤åˆ¶é…ç½®åˆ°å…¶ä»–è®¾å¤‡</p></blockquote><p>åœ¨æ’ä»¶Setup wizard é€‰é¡¹å¡ä¸­ï¼Œç‚¹å‡»Â <code>Copy Setup URI</code>ï¼Œå¼¹å‡ºçš„å¯¹è¯æ¡†è®¾ç½®å¯†ç ï¼Œå³å¯å¤åˆ¶å½“å‰çš„é…ç½®ä¿¡æ¯</p><p>å¤åˆ¶åæ‰“å¼€è‡ªå·±éœ€è¦åŒæ­¥çš„è®¾å¤‡ç‚¹å‡»Open setup URI ç²˜è´´å¤åˆ¶çš„å†…å®¹ï¼Œè¾“å…¥è®¾ç½®çš„å¯†ç ï¼Œç‚¹å‡»ç¬¬ä¸€ä¸ª</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://sspai.com/post/82161#">https://sspai.com/post/82161#</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>å·¥å…·</category>
      
    </categories>
    
    
    <tags>
      
      <tag>obsidian</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>nodeå®‰è£…å’Œä¸‹è½½</title>
    <link href="/2023/11/17/node%E5%AE%89%E8%A3%85%E5%92%8C%E4%B8%8B%E8%BD%BD/"/>
    <url>/2023/11/17/node%E5%AE%89%E8%A3%85%E5%92%8C%E4%B8%8B%E8%BD%BD/</url>
    
    <content type="html"><![CDATA[<h3 id="1ã€Node-js-ä¸‹è½½å®‰è£…"><a href="#1ã€Node-js-ä¸‹è½½å®‰è£…" class="headerlink" title="1ã€Node.js ä¸‹è½½å®‰è£…"></a>1ã€Node.js ä¸‹è½½å®‰è£…</h3><p>å®˜ç½‘ä¸‹è½½ï¼š <a href="https://nodejs.org/en">https://nodejs.org/en</a></p><p>å®‰è£…åï¼ŒéªŒè¯ä¸€ä¸‹æ˜¯å¦å®‰è£…æˆåŠŸ</p><p>æ‰“å¼€ cmd, è¾“å…¥node -vï¼Œnpm -vï¼Œå‡ºç°å¦‚ä¸‹ç•Œé¢å®‰è£…æˆåŠŸ</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231117221300.png" alt="image.png"></p><h3 id="2ã€ç¯å¢ƒé…ç½®"><a href="#2ã€ç¯å¢ƒé…ç½®" class="headerlink" title="2ã€ç¯å¢ƒé…ç½®"></a>2ã€ç¯å¢ƒé…ç½®</h3><blockquote><p>ç¯å¢ƒå˜é‡é…ç½®</p></blockquote><p>æ–°å¢<strong>ç”¨æˆ·å˜é‡</strong>  <code>NODE_PATH</code>ï¼Œå˜é‡å€¼è®¾ç½®ä¸º <code>xxx\nodejs</code></p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231117224932.png" alt="image.png"></p><p>ç¼–è¾‘<strong>ç”¨æˆ·å˜é‡</strong>ä¸­çš„ã€Pathã€‘</p><p>ä¿®æ”¹ å˜é‡å <code>Path</code></p><p>å°†é»˜è®¤çš„ C ç›˜ä¸‹ã€Â <code>AppData\Roaming\npm</code>Â ã€‘ä¿®æ”¹æˆ <code>%NODE_PATH%</code></p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231117224741.png" alt="image.png"></p><p>è®¾ç½®å®Œåä¹Ÿæ‰“å¼€ cmd, è¾“å…¥ä¸€ä¸‹  node -vï¼Œnpm -v  çœ‹æ˜¯å¦OKã€‚</p><blockquote><p>é…ç½®npmçš„å…¨å±€æ¨¡å—çš„å­˜æ”¾è·¯å¾„ä»¥åŠcacheçš„è·¯å¾„</p></blockquote><p>æ‰¾åˆ°å®‰è£…çš„ç›®å½•ï¼Œåœ¨å®‰è£…ç›®å½•ä¸‹æ–°å»ºä¸¤ä¸ªæ–‡ä»¶å¤¹ã€node_globalã€‘å’Œã€node_cacheã€‘</p><p>ä½¿ç”¨ç®¡ç†å‘˜èº«ä»½æ‰“å¼€cmdçª—å£ï¼Œæ‰§è¡Œ</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">npm<span class="hljs-built_in"> config </span><span class="hljs-built_in">set</span><span class="hljs-built_in"> prefix </span><span class="hljs-string">&quot;xxx\Node.js\node_global&quot;</span><br><br>npm<span class="hljs-built_in"> config </span><span class="hljs-built_in">set</span> cache <span class="hljs-string">&quot;xxx\Node.js\node_cache&quot;</span><br></code></pre></td></tr></table></figure><blockquote><p>æ–°å¢ç³»ç»ŸPathå˜é‡</p></blockquote><p>åœ¨ã€ç³»ç»Ÿå˜é‡ã€‘ä¸­é€‰æ‹©ã€Pathã€‘ç‚¹å‡»ã€ç¼–è¾‘ã€‘æ·»åŠ ä½ åˆšæ‰é…ç½®çš„ä¸¤ä¸ªè·¯å¾„ã€‚</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231117225456.png" alt="image.png"></p><h3 id="3ã€å®‰è£…æ·˜å®é•œåƒ"><a href="#3ã€å®‰è£…æ·˜å®é•œåƒ" class="headerlink" title="3ã€å®‰è£…æ·˜å®é•œåƒ"></a>3ã€å®‰è£…æ·˜å®é•œåƒ</h3><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">npm config set registry https:<span class="hljs-comment">//registry.npm.taobao.org</span><br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹æ˜¯å¦æˆåŠŸï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm config get registry<br></code></pre></td></tr></table></figure><h3 id="4ã€NVM-å®‰è£…"><a href="#4ã€NVM-å®‰è£…" class="headerlink" title="4ã€NVM å®‰è£…"></a>4ã€NVM å®‰è£…</h3><p>ä¸‹è½½åœ°å€ï¼š <a href="https://github.com/coreybutler/nvm-windows/releases">https://github.com/coreybutler/nvm-windows/releases</a></p><p>NVM æ˜¯ä¸€ä¸ª node ç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼Œè¿™é‡Œä¸»è¦æ˜¯ç”±äºå‰ç«¯é¡¹ç›®ä¸­æœ‰æ—¶å€™éœ€è¦çš„ç‰ˆæœ¬ä¸åŒï¼Œéœ€è¦åˆ‡æ¢</p><ul><li><ol><li>ä¸‹è½½ nvm-setup.zip æ–‡ä»¶</li></ol></li><li><ol start="2"><li>å¸è½½ç”µè„‘å®‰è£…çš„ node ï¼Œåœ¨ç¨‹åºä¸åŠŸèƒ½ä¸Šå¸è½½ node ï¼ŒåŒæ—¶åˆ é™¤ä¹‹å‰çš„ç¯å¢ƒå˜é‡</li></ol></li><li>3.è§£å‹æ–‡ä»¶åï¼Œæœ‰ä¸€ä¸ª nvm-setup.exe ï¼Œç‚¹å‡»å®‰è£…</li><li>4.å®‰è£…ä½ éœ€è¦çš„ç‰ˆæœ¬</li><li>5.å¯èƒ½éœ€è¦é‡æ–°å¯åŠ¨ä¸€ä¸‹ä½ çš„ç”µè„‘</li></ul><p>å¸¸ç”¨å‘½ä»¤</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">nvm ls               // æŸ¥çœ‹å·²å®‰è£…<span class="hljs-keyword">node</span><span class="hljs-title">ç‰ˆæœ¬</span><br><span class="hljs-title">nvm</span> install vXX      // å®‰è£…å¯¹åº”vXXç‰ˆæœ¬çš„<span class="hljs-keyword">node</span><br><span class="hljs-title">nvm</span> uninstall vXX    // å¸è½½å¯¹åº”vXXç‰ˆæœ¬çš„<span class="hljs-keyword">node</span><br><span class="hljs-title">nvm</span> use xxx          // é€‰æ‹©ä½¿ç”¨XXXç‰ˆæœ¬<br></code></pre></td></tr></table></figure><p>å®é™…æ“ä½œ</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment">#å®‰è£…å¹¶åˆ‡æ¢ç‰ˆæœ¬åˆ° 14.21.3ï¼Œå®‰è£…éœ€è¦ä¸€ç‚¹æ—¶é—´</span><br><span class="hljs-attribute">nvm</span> install <span class="hljs-number">14</span>.<span class="hljs-number">21</span>.<span class="hljs-number">3</span><br><span class="hljs-attribute">nvm</span> use <span class="hljs-number">14</span>.<span class="hljs-number">21</span>.<span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><hr><p>å‚è€ƒ</p><ul><li><a href="https://blog.csdn.net/m0_62617719/article/details/130423504">https://blog.csdn.net/m0_62617719/article/details/130423504</a></li><li><a href="https://blog.csdn.net/JingYan_Chan/article/details/125405423">https://blog.csdn.net/JingYan_Chan/article/details/125405423</a></li><li><a href="https://blog.csdn.net/MyronCham/article/details/119561972">https://blog.csdn.net/MyronCham/article/details/119561972</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
      <category>Node</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
      <tag>node</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Dokcerå…¥é—¨_åŸºç¡€æ¦‚å¿µ</title>
    <link href="/2023/11/17/Docker%E5%85%A5%E9%97%A8_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/"/>
    <url>/2023/11/17/Docker%E5%85%A5%E9%97%A8_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/</url>
    
    <content type="html"><![CDATA[<h3 id="1ã€ä»€ä¹ˆæ˜¯-Docker"><a href="#1ã€ä»€ä¹ˆæ˜¯-Docker" class="headerlink" title="1ã€ä»€ä¹ˆæ˜¯ Docker"></a>1ã€ä»€ä¹ˆæ˜¯ Docker</h3><blockquote><p>ç†è§£è™šæ‹ŸåŒ–æŠ€æœ¯</p></blockquote><p>äººä»¬ä¸ºäº†æé«˜ç³»ç»ŸåŠç¡¬ä»¶èµ„æºçš„åˆ©ç”¨ç‡è€Œå¼•å…¥äº†<strong>è™šæ‹ŸåŒ–æŠ€æœ¯</strong>ã€‚è™šæ‹ŸåŒ–æ˜¯ä¸€ç§<strong>èµ„æºç®¡ç†æŠ€æœ¯</strong>ï¼Œå®ƒå¯ä»¥å„ç§å®ä½“èµ„æºæŠ½åƒåå†åˆ†éš”ï¼Œä»è€Œæ‰“ç ´å®ä½“ç»“æ„çš„é™åˆ¶ï¼Œæœ€å¤§ç¨‹åº¦çš„æé«˜èµ„æºçš„åˆ©ç”¨ç‡ã€‚</p><p>è™šæ‹ŸåŒ–çš„ç›®çš„æ˜¯ä¸ºäº†åœ¨åŒä¸€ä¸ªä¸»æœºä¸Šè¿è¡Œå¤šä¸ªç³»ç»Ÿæˆ–åº”ç”¨ï¼Œä»è€Œæé«˜ç³»ç»Ÿèµ„æºçš„åˆ©ç”¨ç‡ï¼Œå¹¶å¸¦æ¥é™ä½æˆæœ¬ã€æ–¹ä¾¿ç®¡ç†å’Œå®¹é”™å®¹ç¾ç­‰å¥½å¤„ã€‚</p><p>ä»å®ç°å½¢å¼æ¥åˆ†ï¼Œè™šæ‹ŸåŒ–æŠ€æœ¯å¯åˆ†ä¸ºåŸºäºç¡¬ä»¶çš„è™šæ‹ŸåŒ–å’ŒåŸºäºè½¯ä»¶çš„è™šæ‹ŸåŒ–ã€‚</p><blockquote><p>åŸºäºè½¯ä»¶çš„è™šæ‹ŸåŒ–</p></blockquote><p>è½¯ä»¶è™šæ‹ŸåŒ–æ˜¯åˆ©ç”¨è½¯ä»¶æŠ€æœ¯ï¼Œåœ¨ç°æœ‰çš„ç‰©ç†å¹³å°ä¸Šå®ç°å¯¹ç‰©ç†å¹³å°è®¿é—®çš„æˆªè·å’Œæ¨¡æ‹Ÿã€‚</p><p>å¯¹è½¯ä»¶è™šæ‹ŸåŒ–è¿›è¡Œç»†åˆ†ï¼Œåˆå¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼š</p><ul><li>å®Œå…¨è™šæ‹ŸåŒ–</li><li>ç¡¬ä»¶è¾…åŠ©è™šæ‹ŸåŒ–</li><li>éƒ¨åˆ†è™šæ‹ŸåŒ–</li><li>å¹³è¡Œè™šæ‹ŸåŒ–</li><li>æ“ä½œç³»ç»Ÿå±‚è™šæ‹ŸåŒ–</li></ul><p>Dockerå®¹å™¨æŠ€æœ¯å°±æ˜¯å±äºæ“ä½œç³»ç»Ÿå±‚è™šæ‹ŸåŒ–çš„èŒƒç•´ã€‚</p><p>è™šæ‹ŸåŒ–æ˜¯é€šè¿‡è½¯ä»¶çš„æ–¹å¼æ¨¡æ‹Ÿå®ä½“æœåŠ¡å™¨ï¼Œå…¶åˆè¡·æ˜¯ä¸ºäº†è§£å†³â€œä¸€ç§åº”ç”¨å ç”¨ä¸€å°æœåŠ¡å™¨â€æ¨¡å¼æ‰€å¸¦æ¥çš„æœåŠ¡å™¨æ•°é‡å‰§å¢çš„é—®é¢˜ï¼Œä»è€Œé™ä½æ•°æ®ä¸­å¿ƒå¤æ‚åº¦ï¼Œç®€åŒ–ç®¡ç†éš¾åº¦ã€‚</p><blockquote><p>è™šæ‹Ÿæœºå’ŒDocker</p></blockquote><p>å®¹å™¨è™šæ‹ŸåŒ–çš„æ˜¯æ“ä½œç³»ç»Ÿè€Œä¸æ˜¯ç¡¬ä»¶ï¼Œå®¹å™¨ä¹‹é—´æ˜¯å…±äº«åŒä¸€å¥—æ“ä½œç³»ç»Ÿèµ„æºã€‚</p><p>è™šæ‹ŸæœºæŠ€æœ¯æ˜¯è™šæ‹Ÿå‡ºä¸€å¥—ç¡¬ä»¶åï¼Œåœ¨å…¶ä¸Šè¿è¡Œä¸€ä¸ªå®Œæ•´æ“ä½œç³»ç»Ÿã€‚å› æ­¤å®¹å™¨çš„éš”ç¦»çº§åˆ«ä¼šç¨ä½ä¸€äº›ã€‚</p><blockquote><p>è™šæ‹Ÿæœºå’Œ Docker çš„å¯¹æ¯”<br><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311171252304.png" alt="image.png"></p></blockquote><blockquote><p>å›¾è§£ç‰©ç†æœº,è™šæ‹Ÿæœºä¸å®¹å™¨</p></blockquote><p>ç‰©ç†æœº</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311171456074.png" alt="image.png"></p><p>è™šæ‹Ÿæœº</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311171456887.png" alt="image.png"><br>å®¹å™¨</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311171457700.png" alt="image.png"></p><p>è™šæ‹Ÿæœºå’ŒDockerå®¹å™¨å„è‡ªæœ‰è‡ªå·±çš„åº”ç”¨åœºæ™¯ï¼Œ<strong>è™šæ‹Ÿæœºæ›´æ“…é•¿äºå½»åº•éš”ç¦»æ•´ä¸ªè¿è¡Œç¯å¢ƒ</strong>ã€‚ä¾‹å¦‚ï¼Œäº‘æœåŠ¡æä¾›å•†é€šå¸¸é‡‡ç”¨è™šæ‹ŸæœºæŠ€æœ¯éš”ç¦»ä¸åŒçš„ç”¨æˆ·ã€‚</p><p>è€ŒÂ <strong>Docker é€šå¸¸ç”¨äºéš”ç¦»ä¸åŒçš„åº”ç”¨</strong>Â ï¼Œä¾‹å¦‚å‰ç«¯ï¼Œåç«¯ä»¥åŠæ•°æ®åº“ã€‚</p><h3 id="2ã€Docker-åŸºæœ¬æ¦‚å¿µ"><a href="#2ã€Docker-åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="2ã€Docker åŸºæœ¬æ¦‚å¿µ"></a>2ã€Docker åŸºæœ¬æ¦‚å¿µ</h3><p>Docker åŒ…æ‹¬ä¸‰ä¸ªåŸºæœ¬æ¦‚å¿µ:</p><ul><li><strong>é•œåƒï¼ˆImageï¼‰</strong>ï¼šDocker é•œåƒï¼ˆImageï¼‰ï¼Œå°±ç›¸å½“äºæ˜¯ä¸€ä¸ª root æ–‡ä»¶ç³»ç»Ÿã€‚æ¯”å¦‚å®˜æ–¹é•œåƒ ubuntu:16.04 å°±åŒ…å«äº†å®Œæ•´çš„ä¸€å¥— Ubuntu16.04 æœ€å°ç³»ç»Ÿçš„ root æ–‡ä»¶ç³»ç»Ÿã€‚</li><li><strong>å®¹å™¨ï¼ˆContainerï¼‰</strong>ï¼šé•œåƒï¼ˆImageï¼‰å’Œå®¹å™¨ï¼ˆContainerï¼‰çš„å…³ç³»ï¼Œå°±åƒæ˜¯é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ä¸­çš„ç±»å’Œå®ä¾‹ä¸€æ ·ï¼Œ<strong>é•œåƒæ˜¯é™æ€çš„å®šä¹‰ï¼Œå®¹å™¨æ˜¯é•œåƒè¿è¡Œæ—¶çš„å®ä½“</strong>ã€‚å®¹å™¨å¯ä»¥è¢«åˆ›å»ºã€å¯åŠ¨ã€åœæ­¢ã€åˆ é™¤ã€æš‚åœç­‰ã€‚</li><li><strong>ä»“åº“ï¼ˆRepositoryï¼‰</strong>ï¼šä»“åº“å¯çœ‹æˆä¸€ä¸ªä»£ç æ§åˆ¶ä¸­å¿ƒï¼Œç”¨æ¥ä¿å­˜é•œåƒã€‚</li></ul><blockquote><p><strong>Docker Registry å…¬å¼€æœåŠ¡å’Œç§æœ‰ Docker Registry</strong></p></blockquote><p><strong>Docker Registry å…¬å¼€æœåŠ¡</strong> æ˜¯å¼€æ”¾ç»™ç”¨æˆ·ä½¿ç”¨ã€å…è®¸ç”¨æˆ·ç®¡ç†é•œåƒçš„ Registry æœåŠ¡ã€‚ä¸€èˆ¬è¿™ç±»å…¬å¼€æœåŠ¡å…è®¸ç”¨æˆ·å…è´¹ä¸Šä¼ ã€ä¸‹è½½å…¬å¼€çš„é•œåƒï¼Œå¹¶å¯èƒ½æä¾›æ”¶è´¹æœåŠ¡ä¾›ç”¨æˆ·ç®¡ç†ç§æœ‰é•œåƒã€‚</p><p>æœ€å¸¸ä½¿ç”¨çš„ Registry å…¬å¼€æœåŠ¡æ˜¯å®˜æ–¹çš„ <strong>Docker Hub</strong> ï¼Œè¿™ä¹Ÿæ˜¯é»˜è®¤çš„ Registryï¼Œå¹¶æ‹¥æœ‰å¤§é‡çš„é«˜è´¨é‡çš„å®˜æ–¹é•œåƒï¼Œç½‘å€ä¸ºï¼š<a href="https://hub.docker.com/" title="https://hub.docker.com/">https://hub.docker.com/open in new window</a> ã€‚å®˜æ–¹æ˜¯è¿™æ ·ä»‹ç» Docker Hub çš„ï¼š</p><blockquote><p>Docker Hub æ˜¯ Docker å®˜æ–¹æä¾›çš„ä¸€é¡¹æœåŠ¡ï¼Œç”¨äºä¸æ‚¨çš„å›¢é˜ŸæŸ¥æ‰¾å’Œå…±äº«å®¹å™¨é•œåƒã€‚</p></blockquote><p>æ¯”å¦‚æˆ‘ä»¬æƒ³è¦æœç´¢è‡ªå·±æƒ³è¦çš„é•œåƒï¼š</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311171534204.png" alt="image.png"></p><p>åœ¨ Docker Hub çš„æœç´¢ç»“æœä¸­ï¼Œæœ‰å‡ é¡¹å…³é”®çš„ä¿¡æ¯æœ‰åŠ©äºæˆ‘ä»¬é€‰æ‹©åˆé€‚çš„é•œåƒï¼š</p><ul><li><strong>OFFICIAL Image</strong>ï¼šä»£è¡¨é•œåƒä¸º Docker å®˜æ–¹æä¾›å’Œç»´æŠ¤ï¼Œç›¸å¯¹æ¥è¯´ç¨³å®šæ€§å’Œå®‰å…¨æ€§è¾ƒé«˜ã€‚</li><li><strong>Stars</strong>ï¼šå’Œç‚¹èµå·®ä¸å¤šçš„æ„æ€ï¼Œç±»ä¼¼ GitHub çš„ Starã€‚</li><li><strong>Downloads</strong>ï¼šä»£è¡¨é•œåƒè¢«æ‹‰å–çš„æ¬¡æ•°ï¼ŒåŸºæœ¬ä¸Šèƒ½å¤Ÿè¡¨ç¤ºé•œåƒè¢«ä½¿ç”¨çš„é¢‘åº¦ã€‚</li></ul><p>é™¤äº†ç›´æ¥é€šè¿‡ Docker Hub ç½‘ç«™æœç´¢é•œåƒè¿™ç§æ–¹å¼å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ <code>docker search</code> è¿™ä¸ªå‘½ä»¤æœç´¢ Docker Hub ä¸­çš„é•œåƒï¼Œæœç´¢çš„ç»“æœæ˜¯ä¸€è‡´çš„ã€‚</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">âœ  ~ docker <span class="hljs-keyword">search</span> mysql<br><span class="hljs-type">NAME</span>                              DESCRIPTION                                     STARS               OFFICIAL            AUTOMATED<br>mysql                             MySQL <span class="hljs-keyword">is</span> a widely used, <span class="hljs-keyword">open</span>-source relationâ€¦   <span class="hljs-number">8763</span>                [OK]<br>mariadb                           MariaDB <span class="hljs-keyword">is</span> a community-developed fork <span class="hljs-keyword">of</span> MySâ€¦   <span class="hljs-number">3073</span>                [OK]<br>mysql/mysql-<span class="hljs-keyword">server</span>                Optimized MySQL <span class="hljs-keyword">Server</span> Docker images. <span class="hljs-keyword">Create</span>â€¦   <span class="hljs-number">650</span>                                     [OK]<br></code></pre></td></tr></table></figure><p>åœ¨å›½å†…è®¿é—®<strong>Docker Hub</strong> å¯èƒ½ä¼šæ¯”è¾ƒæ…¢å›½å†…ä¹Ÿæœ‰ä¸€äº›äº‘æœåŠ¡å•†æä¾›ç±»ä¼¼äº Docker Hub çš„å…¬å¼€æœåŠ¡ã€‚æ¯”å¦‚ <a href="https://www.aliyun.com/product/containerservice?utm_content=se_1292836" title="é˜¿é‡Œäº‘é•œåƒåº“">é˜¿é‡Œäº‘é•œåƒåº“</a>ã€‚</p><p>é™¤äº†ä½¿ç”¨å…¬å¼€æœåŠ¡å¤–ï¼Œç”¨æˆ·è¿˜å¯ä»¥åœ¨ <strong>æœ¬åœ°æ­å»ºç§æœ‰ Docker Registry</strong> ã€‚</p><p>Docker å®˜æ–¹æä¾›äº† Docker Registry é•œåƒï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨åšä¸ºç§æœ‰ Registry æœåŠ¡ã€‚å¼€æºçš„ Docker Registry é•œåƒåªæä¾›äº† Docker Registry API çš„æœåŠ¡ç«¯å®ç°ï¼Œè¶³ä»¥æ”¯æŒ docker å‘½ä»¤ï¼Œä¸å½±å“ä½¿ç”¨ã€‚ä½†ä¸åŒ…å«å›¾å½¢ç•Œé¢ï¼Œä»¥åŠé•œåƒç»´æŠ¤ã€ç”¨æˆ·ç®¡ç†ã€è®¿é—®æ§åˆ¶ç­‰é«˜çº§åŠŸèƒ½ã€‚</p><h3 id="3ã€åŸºæœ¬å‘½ä»¤"><a href="#3ã€åŸºæœ¬å‘½ä»¤" class="headerlink" title="3ã€åŸºæœ¬å‘½ä»¤"></a>3ã€åŸºæœ¬å‘½ä»¤</h3><h4 id="åŸºæœ¬å‘½ä»¤"><a href="#åŸºæœ¬å‘½ä»¤" class="headerlink" title="åŸºæœ¬å‘½ä»¤"></a>åŸºæœ¬å‘½ä»¤</h4><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">docker <span class="hljs-keyword">version</span> <span class="hljs-comment"># æŸ¥çœ‹dockerç‰ˆæœ¬</span><br>docker images <span class="hljs-comment"># æŸ¥çœ‹æ‰€æœ‰å·²ä¸‹è½½é•œåƒï¼Œç­‰ä»·äºï¼šdocker image ls å‘½ä»¤</span><br>docker container <span class="hljs-keyword">ls</span> <span class="hljs-comment"># æŸ¥çœ‹æ‰€æœ‰å®¹å™¨</span><br>docker ps <span class="hljs-comment">#æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨</span><br>docker image prune <span class="hljs-comment"># æ¸…ç†ä¸´æ—¶çš„ã€æ²¡æœ‰è¢«ä½¿ç”¨çš„é•œåƒæ–‡ä»¶ã€‚-a, --all: åˆ é™¤æ‰€æœ‰æ²¡æœ‰ç”¨çš„é•œåƒï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸´æ—¶æ–‡ä»¶ï¼›</span><br></code></pre></td></tr></table></figure><h4 id="æ‹‰å–é•œåƒ"><a href="#æ‹‰å–é•œåƒ" class="headerlink" title="æ‹‰å–é•œåƒ"></a>æ‹‰å–é•œåƒ</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker search mysql <span class="hljs-comment"># æŸ¥çœ‹mysqlç›¸å…³é•œåƒ</span><br>docker pull mysql:5.7 <span class="hljs-comment"># æ‹‰å–mysqlé•œåƒ</span><br>docker image <span class="hljs-built_in">ls</span> <span class="hljs-comment"># æŸ¥çœ‹æ‰€æœ‰å·²ä¸‹è½½é•œåƒ</span><br></code></pre></td></tr></table></figure><h4 id="åˆ é™¤é•œåƒ"><a href="#åˆ é™¤é•œåƒ" class="headerlink" title="åˆ é™¤é•œåƒ"></a>åˆ é™¤é•œåƒ</h4><p>æ¯”å¦‚æˆ‘ä»¬è¦åˆ é™¤æˆ‘ä»¬ä¸‹è½½çš„ mysql é•œåƒã€‚</p><p>é€šè¿‡ <code>docker rmi [image]</code> ï¼ˆç­‰ä»·äº<code>docker image rm [image]</code>ï¼‰åˆ é™¤é•œåƒä¹‹å‰é¦–å…ˆè¦ç¡®ä¿è¿™ä¸ªé•œåƒæ²¡æœ‰è¢«å®¹å™¨å¼•ç”¨ï¼ˆå¯ä»¥é€šè¿‡æ ‡ç­¾åç§°æˆ–è€…é•œåƒ ID åˆ é™¤ï¼‰ã€‚</p><p>é€šè¿‡æˆ‘ä»¬å‰é¢è®²çš„<code>docker ps</code>å‘½ä»¤å³å¯æŸ¥çœ‹ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">âœ  ~ docker ps<br>CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                               NAMES<br>c4cd691d9f80        mysql:5.7           <span class="hljs-string">&quot;docker-entrypoint.sâ€¦&quot;</span>   7 weeks ago         Up 12 days          0.0.0.0:3306-&gt;3306/tcp, 33060/tcp   mysql<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ° mysql æ­£åœ¨è¢« id ä¸º c4cd691d9f80 çš„å®¹å™¨å¼•ç”¨ï¼Œæˆ‘ä»¬éœ€è¦é¦–å…ˆé€šè¿‡ <code>docker stop c4cd691d9f80</code> æˆ–è€… <code>docker stop mysql</code>æš‚åœè¿™ä¸ªå®¹å™¨ã€‚</p><p>ç„¶åæŸ¥çœ‹ mysql é•œåƒçš„ id</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">âœ  ~ docker images<br>REPOSITORY              <span class="hljs-keyword">TAG</span>                 <span class="hljs-title">IMAGE</span> ID            CREATED             SIZE<br>mysql                   <span class="hljs-number">5.7</span>                 f6509bac4980        <span class="hljs-number">3</span> months ago        <span class="hljs-number">373M</span>B<br></code></pre></td></tr></table></figure><p>é€šè¿‡ IMAGE ID æˆ–è€… REPOSITORY åå­—å³å¯åˆ é™¤</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">docker</span> rmi f6509bac4980 <span class="hljs-comment">#  æˆ–è€… docker rmi mysql</span><br></code></pre></td></tr></table></figure><h3 id="4ã€Build-Ship-and-Run"><a href="#4ã€Build-Ship-and-Run" class="headerlink" title="4ã€Build Ship and Run"></a>4ã€Build Ship and Run</h3><p>æœç´¢ Docker å®˜ç½‘ï¼Œä¼šå‘ç°å¦‚ä¸‹çš„å­—æ ·ï¼š<strong>â€œDocker - Build, Ship, and Run Any App, Anywhereâ€</strong>ã€‚</p><ul><li><strong>Buildï¼ˆæ„å»ºé•œåƒï¼‰</strong>ï¼šé•œåƒå°±åƒæ˜¯é›†è£…ç®±åŒ…æ‹¬æ–‡ä»¶ä»¥åŠè¿è¡Œç¯å¢ƒç­‰ç­‰èµ„æºã€‚</li><li><strong>Shipï¼ˆè¿è¾“é•œåƒï¼‰</strong>ï¼šä¸»æœºå’Œä»“åº“é—´è¿è¾“ï¼Œè¿™é‡Œçš„ä»“åº“å°±åƒæ˜¯è¶…çº§ç å¤´ä¸€æ ·ã€‚</li><li><strong>Run ï¼ˆè¿è¡Œé•œåƒï¼‰</strong>ï¼šè¿è¡Œçš„é•œåƒå°±æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œå®¹å™¨å°±æ˜¯è¿è¡Œç¨‹åºçš„åœ°æ–¹ã€‚</li></ul><p>Docker è¿è¡Œè¿‡ç¨‹æ˜¯ä¼šå»ä»“åº“æŠŠé•œåƒæ‹‰åˆ°æœ¬åœ°ï¼Œç„¶åç”¨ä¸€æ¡å‘½ä»¤æŠŠé•œåƒè¿è¡Œèµ·æ¥å˜æˆå®¹å™¨ã€‚</p><p>Docker ä¹Ÿè¢«ç§°ä¸ºç å¤´å·¥äººæˆ–ç å¤´è£…å¸å·¥ï¼Œè¿™å’Œ Docker çš„ä¸­æ–‡ç¿»è¯‘<strong>æ¬è¿å·¥äºº</strong>å¦‚å‡ºä¸€è¾™ã€‚</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311171603190.png" alt="image.png"></p><hr><p>å‚è€ƒ</p><ul><li><a href="https://javaguide.cn/tools/docker/docker-intro.html">https://javaguide.cn/tools/docker/docker-intro.html</a></li><li><a href="https://www.pdai.tech/md/devops/docker/docker-01-docker-vm.html">https://www.pdai.tech/md/devops/docker/docker-01-docker-vm.html</a></li><li><a href="https://www.pdai.tech/md/devops/docker/docker-03-basic2.html">https://www.pdai.tech/md/devops/docker/docker-03-basic2.html</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>éƒ¨ç½²</category>
      
    </categories>
    
    
    <tags>
      
      <tag>docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JVMå…¥é—¨_åŸºç¡€æ¦‚å¿µ</title>
    <link href="/2023/11/16/JVM%E5%85%A5%E9%97%A8_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/"/>
    <url>/2023/11/16/JVM%E5%85%A5%E9%97%A8_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/</url>
    
    <content type="html"><![CDATA[<h3 id="1ã€ä»€ä¹ˆæ˜¯-JVM"><a href="#1ã€ä»€ä¹ˆæ˜¯-JVM" class="headerlink" title="1ã€ä»€ä¹ˆæ˜¯ JVM"></a>1ã€ä»€ä¹ˆæ˜¯ JVM</h3><p>JVM å…¨ç§°æ˜¯ Java Virtual Machineï¼Œä¸­æ–‡åç§°å«Javaè™šæ‹Ÿæœºï¼Œå®ƒæ˜¯ç”±è½¯ä»¶æŠ€æœ¯æ¨¡æ‹Ÿå‡ºè®¡ç®—æœºè¿è¡Œçš„ä¸€ä¸ªè™šæ‹Ÿçš„è®¡ç®—æœºã€‚</p><p>JVM å……å½“ç€ä¸€ä¸ªç¿»è¯‘å®˜çš„è§’è‰²ï¼Œèƒ½å¤Ÿå°†æˆ‘ä»¬ç¼–å†™å‡ºçš„Javaç¨‹åºï¼Œç¿»è¯‘ç»™ç³»ç»Ÿâ€œå¬â€ï¼Œå‘Šè¯‰å®ƒæˆ‘ä»¬çš„ç¨‹åºéœ€è¦åšä»€ä¹ˆæ“ä½œã€‚</p><p>Javaçš„ä»£ç éœ€è¦ç»è¿‡ç¼–è¯‘å™¨ï¼Œç”Ÿæˆ.Classæ–‡ä»¶åï¼ŒJVMæ‰èƒ½è¯†åˆ«å¹¶è¿è¡Œå®ƒï¼ŒJVMé’ˆå¯¹æ¯ä¸ªæ“ä½œç³»ç»Ÿå¼€å‘å…¶å¯¹åº”çš„è§£é‡Šå™¨ï¼Œæ‰€ä»¥åªè¦å…¶æ“ä½œç³»ç»Ÿæœ‰å¯¹åº”ç‰ˆæœ¬çš„JVMï¼Œé‚£ä¹ˆè¿™ä»½Javaç¼–è¯‘åçš„ä»£ç å°±èƒ½å¤Ÿè¿è¡Œèµ·æ¥ï¼Œè¿™å°±æ˜¯Javaèƒ½ä¸€æ¬¡ç¼–è¯‘ï¼Œåˆ°å¤„è¿è¡Œçš„åŸå› ã€‚</p><p>å½“å‰å¸‚é¢ä¸Šä½¿ç”¨èŒƒå›´æœ€å¹¿çš„ï¼Œæ˜¯Sun&#x2F;OracleJDKæˆ–è€…OpenJDKä¸­é»˜è®¤çš„ HotSpot è™šæ‹Ÿæœºï¼Œè¿™é‡Œä¹Ÿæ˜¯ä»¥ HotSpot è™šæ‹Ÿæœºå±•å¼€ï¼Œå¯¹JVM åŸºç¡€æ¦‚å¿µè¿›è¡Œé˜è¿°ã€‚</p><h3 id="2ã€ç±»åŠ è½½æœºåˆ¶"><a href="#2ã€ç±»åŠ è½½æœºåˆ¶" class="headerlink" title="2ã€ç±»åŠ è½½æœºåˆ¶"></a>2ã€ç±»åŠ è½½æœºåˆ¶</h3><p>ä¸Šæ–‡æåˆ°ï¼ŒJavaçš„ä»£ç ç»è¿‡ç¼–è¯‘å™¨ï¼Œç”Ÿæˆ.Classæ–‡ä»¶åï¼ŒJVMæ‰èƒ½è¯†åˆ«å¹¶è¿è¡Œã€‚</p><blockquote><p>ç±»åŠ è½½è¿‡ç¨‹</p></blockquote><p><strong>Class æ–‡ä»¶éœ€è¦åŠ è½½åˆ°è™šæ‹Ÿæœºä¸­ä¹‹åæ‰èƒ½è¿è¡Œå’Œä½¿ç”¨ï¼Œé‚£ä¹ˆè™šæ‹Ÿæœºæ˜¯å¦‚ä½•åŠ è½½è¿™äº› Class æ–‡ä»¶å‘¢ï¼Ÿ</strong></p><p>ç³»ç»ŸåŠ è½½ Class ç±»å‹çš„æ–‡ä»¶ä¸»è¦ä¸‰æ­¥ï¼š<strong>åŠ è½½-&gt;è¿æ¥-&gt;åˆå§‹åŒ–</strong>ã€‚è¿æ¥è¿‡ç¨‹åˆå¯åˆ†ä¸ºä¸‰æ­¥ï¼š<strong>éªŒè¯-&gt;å‡†å¤‡-&gt;è§£æ</strong>ã€‚</p><p>æ•´ä¸ªç±»åŠ è½½çš„è¿‡ç¨‹ä¸­ï¼ŒåŒ…æ‹¬<strong>åŠ è½½ã€éªŒè¯ã€å‡†å¤‡ã€è§£æã€åˆå§‹åŒ–</strong>äº”ä¸ªé˜¶æ®µã€‚</p><p>åœ¨è¿™äº”ä¸ªé˜¶æ®µä¸­ï¼ŒåŠ è½½ã€éªŒè¯ã€å‡†å¤‡å’Œåˆå§‹åŒ–è¿™å››ä¸ªé˜¶æ®µå‘ç”Ÿçš„é¡ºåºæ˜¯ç¡®å®šçš„ï¼Œè€Œè§£æé˜¶æ®µåˆ™ä¸ä¸€å®šï¼Œå®ƒåœ¨æŸäº›æƒ…å†µä¸‹å¯ä»¥åœ¨åˆå§‹åŒ–é˜¶æ®µä¹‹åå¼€å§‹ï¼Œè¿™æ˜¯ä¸ºäº†æ”¯æŒJavaè¯­è¨€çš„è¿è¡Œæ—¶ç»‘å®š(ä¹Ÿæˆä¸ºåŠ¨æ€ç»‘å®šæˆ–æ™šæœŸç»‘å®š)ã€‚</p><p>å¦å¤–æ³¨æ„<strong>è¿™é‡Œçš„å‡ ä¸ªé˜¶æ®µæ˜¯æŒ‰é¡ºåºå¼€å§‹ï¼Œè€Œä¸æ˜¯æŒ‰é¡ºåºè¿›è¡Œæˆ–å®Œæˆ</strong>ï¼Œå› ä¸ºè¿™äº›é˜¶æ®µé€šå¸¸éƒ½æ˜¯äº’ç›¸äº¤å‰åœ°æ··åˆè¿›è¡Œçš„ï¼Œé€šå¸¸åœ¨ä¸€ä¸ªé˜¶æ®µæ‰§è¡Œçš„è¿‡ç¨‹ä¸­è°ƒç”¨æˆ–æ¿€æ´»å¦ä¸€ä¸ªé˜¶æ®µã€‚</p><ul><li>ç±»çš„åŠ è½½: æŸ¥æ‰¾å¹¶åŠ è½½ç±»çš„äºŒè¿›åˆ¶æ•°æ®</li><li>è¿æ¥<ul><li>éªŒè¯: ç¡®ä¿è¢«åŠ è½½çš„ç±»çš„æ­£ç¡®æ€§</li><li>å‡†å¤‡: ä¸ºç±»çš„é™æ€å˜é‡åˆ†é…å†…å­˜ï¼Œå¹¶å°†å…¶åˆå§‹åŒ–ä¸ºé»˜è®¤å€¼</li><li>è§£æ: æŠŠç±»ä¸­çš„ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºç›´æ¥å¼•ç”¨</li></ul></li><li>åˆå§‹åŒ–ï¼šä¸ºç±»çš„é™æ€å˜é‡èµ‹äºˆæ­£ç¡®çš„åˆå§‹å€¼ï¼ŒJVMè´Ÿè´£å¯¹ç±»è¿›è¡Œåˆå§‹åŒ–ï¼Œä¸»è¦å¯¹ç±»å˜é‡è¿›è¡Œåˆå§‹åŒ–ã€‚</li><li>ä½¿ç”¨ï¼š ç±»è®¿é—®æ–¹æ³•åŒºå†…çš„æ•°æ®ç»“æ„çš„æ¥å£ï¼Œ å¯¹è±¡æ˜¯HeapåŒºçš„æ•°æ®</li><li>å¸è½½ï¼š ç»“æŸç”Ÿå‘½å‘¨æœŸ</li></ul><blockquote><p>ç±»åŠ è½½çš„å±‚æ¬¡</p></blockquote><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231116234810.png" alt="image.png"></p><ul><li><strong>å¯åŠ¨ç±»åŠ è½½å™¨</strong>: Bootstrap ClassLoaderï¼Œ<ul><li>è´Ÿè´£åŠ è½½å­˜æ”¾åœ¨<code>JDK\jre\lib</code> (JDKä»£è¡¨JDKçš„å®‰è£…ç›®å½•ï¼Œä¸‹åŒ)ä¸‹ï¼Œæˆ–è¢«-Xbootclasspathå‚æ•°æŒ‡å®šçš„è·¯å¾„ä¸­çš„ï¼Œå¹¶ä¸”èƒ½è¢«è™šæ‹Ÿæœºè¯†åˆ«çš„ç±»åº“(å¦‚rt.jarï¼Œæ‰€æœ‰çš„java.* å¼€å¤´çš„ç±»å‡è¢«Bootstrap ClassLoaderåŠ è½½)ã€‚</li><li>å¯åŠ¨ç±»åŠ è½½å™¨æ˜¯æ— æ³•è¢«Javaç¨‹åºç›´æ¥å¼•ç”¨çš„ã€‚</li></ul></li><li><strong>æ‰©å±•ç±»åŠ è½½å™¨</strong>: Extension ClassLoaderï¼Œ<ul><li>è¯¥åŠ è½½å™¨ç”±<code>sun.misc.Launcher$ExtClassLoader</code>å®ç°ï¼Œå®ƒè´Ÿè´£åŠ è½½<code>JDK\jre\lib\ext</code>ç›®å½•ä¸­ï¼Œæˆ–è€…ç”± java.ext.dirs ç³»ç»Ÿå˜é‡æŒ‡å®šçš„è·¯å¾„ä¸­çš„æ‰€æœ‰ç±»åº“(å¦‚javax.* å¼€å¤´çš„ç±»)ï¼Œ</li><li>å¼€å‘è€…å¯ä»¥ç›´æ¥ä½¿ç”¨æ‰©å±•ç±»åŠ è½½å™¨ã€‚</li></ul></li><li><strong>åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨</strong>: Application ClassLoaderï¼Œ<ul><li>è¯¥ç±»åŠ è½½å™¨ç”±<code>sun.misc.Launcher$AppClassLoader</code>æ¥å®ç°ï¼Œå®ƒè´Ÿè´£åŠ è½½ç”¨æˆ·ç±»è·¯å¾„(ClassPath)æ‰€æŒ‡å®šçš„ç±»ï¼Œ</li><li>å¼€å‘è€…å¯ä»¥ç›´æ¥ä½¿ç”¨è¯¥ç±»åŠ è½½å™¨ï¼Œå¦‚æœåº”ç”¨ç¨‹åºä¸­æ²¡æœ‰è‡ªå®šä¹‰è¿‡è‡ªå·±çš„ç±»åŠ è½½å™¨ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è¿™ä¸ªå°±æ˜¯ç¨‹åºä¸­é»˜è®¤çš„ç±»åŠ è½½å™¨ã€‚</li></ul></li><li><strong>è‡ªå®šä¹‰ç±»åŠ è½½å™¨</strong>: <ul><li>å› ä¸ºJVMè‡ªå¸¦çš„ ClassLoader åªæ˜¯æ‡‚å¾—ä»æœ¬åœ°æ–‡ä»¶ç³»ç»ŸåŠ è½½æ ‡å‡†çš„ java class æ–‡ä»¶ï¼Œå› æ­¤å¦‚æœç¼–å†™äº†è‡ªå·±çš„ClassLoaderï¼Œä¾¿å¯ä»¥åšåˆ°å¦‚ä¸‹å‡ ç‚¹:<ul><li>åœ¨æ‰§è¡Œéç½®ä¿¡ä»£ç ä¹‹å‰ï¼Œè‡ªåŠ¨éªŒè¯æ•°å­—ç­¾åã€‚</li><li>åŠ¨æ€åœ°åˆ›å»ºç¬¦åˆç”¨æˆ·ç‰¹å®šéœ€è¦çš„å®šåˆ¶åŒ–æ„å»ºç±»ã€‚</li><li>ä»ç‰¹å®šçš„åœºæ‰€å–å¾—java classï¼Œä¾‹å¦‚æ•°æ®åº“ä¸­å’Œç½‘ç»œä¸­ã€‚</li></ul></li></ul></li></ul><blockquote><p>Class.forName() å’Œ ClassLoader.loadClass()åŒºåˆ«?</p></blockquote><ul><li><code>Class.forName()</code>: å°†ç±»çš„.classæ–‡ä»¶åŠ è½½åˆ°jvmä¸­ä¹‹å¤–ï¼Œè¿˜ä¼šå¯¹ç±»è¿›è¡Œè§£é‡Šï¼Œæ‰§è¡Œç±»ä¸­çš„staticå—ï¼›</li><li><code>ClassLoader.loadClass()</code>: åªå¹²ä¸€ä»¶äº‹æƒ…ï¼Œå°±æ˜¯å°†.classæ–‡ä»¶åŠ è½½åˆ°jvmä¸­ï¼Œä¸ä¼šæ‰§è¡Œstaticä¸­çš„å†…å®¹,åªæœ‰åœ¨newInstanceæ‰ä¼šå»æ‰§è¡Œstaticå—ã€‚</li><li><code>Class.forName(name, initialize, loader)</code>å¸¦å‚å‡½æ•°ä¹Ÿå¯æ§åˆ¶æ˜¯å¦åŠ è½½staticå—ã€‚å¹¶ä¸”åªæœ‰è°ƒç”¨äº†newInstance()æ–¹æ³•é‡‡ç”¨è°ƒç”¨æ„é€ å‡½æ•°ï¼Œåˆ›å»ºç±»çš„å¯¹è±¡</li></ul><h3 id="3ã€JVMçš„ç»“æ„ä½“ç³»"><a href="#3ã€JVMçš„ç»“æ„ä½“ç³»" class="headerlink" title="3ã€JVMçš„ç»“æ„ä½“ç³»"></a>3ã€JVMçš„ç»“æ„ä½“ç³»</h3><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231116235359.png" alt="image.png"></p><p>Java è™šæ‹Ÿæœºåœ¨æ‰§è¡Œ Java ç¨‹åºçš„è¿‡ç¨‹ä¸­ä¼šæŠŠå®ƒç®¡ç†çš„å†…å­˜åˆ’åˆ†æˆè‹¥å¹²ä¸ªä¸åŒçš„æ•°æ®åŒºåŸŸã€‚</p><blockquote><p>è¿è¡Œæ—¶æ•°æ®åŒºæ ¹æ®çº¿ç¨‹æ˜¯å¦ç§æœ‰æˆ–è€…å…±äº«è¿›è¡ŒåŒºåˆ†</p></blockquote><p><strong>çº¿ç¨‹ç§æœ‰çš„ï¼š</strong></p><ul><li>ç¨‹åºè®¡æ•°å™¨</li><li>è™šæ‹Ÿæœºæ ˆ</li><li>æœ¬åœ°æ–¹æ³•æ ˆ</li></ul><p><strong>çº¿ç¨‹å…±äº«çš„ï¼š</strong></p><ul><li>å †</li><li>æ–¹æ³•åŒº</li><li>ç›´æ¥å†…å­˜ (éè¿è¡Œæ—¶æ•°æ®åŒºçš„ä¸€éƒ¨åˆ†)</li></ul><p>Java è™šæ‹Ÿæœºè§„èŒƒå¯¹äºè¿è¡Œæ—¶æ•°æ®åŒºåŸŸçš„è§„å®šæ˜¯ç›¸å½“å®½æ¾çš„ã€‚ä»¥å †ä¸ºä¾‹ï¼šå †å¯ä»¥æ˜¯è¿ç»­ç©ºé—´ï¼Œä¹Ÿå¯ä»¥ä¸è¿ç»­ã€‚å †çš„å¤§å°å¯ä»¥å›ºå®šï¼Œä¹Ÿå¯ä»¥åœ¨è¿è¡Œæ—¶æŒ‰éœ€æ‰©å±• ã€‚è™šæ‹Ÿæœºå®ç°è€…å¯ä»¥ä½¿ç”¨ä»»ä½•åƒåœ¾å›æ”¶ç®—æ³•ç®¡ç†å †ï¼Œç”šè‡³å®Œå…¨ä¸è¿›è¡Œåƒåœ¾æ”¶é›†ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p><p>ç›´æ¥å†…å­˜ï¼ˆJava7çš„æ°¸ä¹…ä»£æˆ–JDK8çš„å…ƒç©ºé—´ã€ä»£ç ç¼“å­˜ï¼‰</p><blockquote><p>JDK 1.8 å’Œä¹‹å‰çš„ç‰ˆæœ¬ç•¥æœ‰ä¸åŒï¼Œæˆ‘ä»¬è¿™é‡Œä»¥ JDK 1.7 å’Œ JDK 1.8 è¿™ä¸¤ä¸ªç‰ˆæœ¬ä¸ºä¾‹ä»‹ç»ã€‚</p></blockquote><p>1.8ä¹‹å‰ç‰ˆæœ¬</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231117000248.png" alt="image.png|600"></p><p>JVM1.8ä¹‹åç‰ˆæœ¬</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231117000319.png" alt="image.png|600"></p><p>1.8ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œçº¿ç¨‹å…±äº«ä¸ºä¸¤ä¸ªåŒºåŸŸï¼šå †ä¸æ–¹æ³•åŒºï¼›å…¶ä¸­æ–¹æ³•åŒºåªæ˜¯JVMè™šæ‹Ÿæœºè§„èŒƒçš„ä¸€éƒ¨åˆ†ï¼Œä¸æ˜¯å®é™…çš„å®ç°ï¼›</p><p>ç›´æ¥å†…å­˜ï¼šæ˜¯JVMä»¥å¤–çš„æœ¬åœ°å†…å­˜ï¼›</p><p><strong>ç‰ˆæœ¬åŒºåˆ«ä»‹ç»</strong></p><ul><li>åŒºåˆ«ä¸€ï¼ˆæ–¹æ³•åŒºï¼‰<ul><li>1.8ç‰ˆæœ¬ä¹‹åï¼Œä½¿ç”¨å…ƒæ•°æ®åŒºå®ç°äº†æ–¹æ³•åŒºï¼Œä¹‹å‰æ˜¯ä½¿ç”¨æ°¸ä¹…ä»£æ¥å®ç°æ–¹æ³•åŒºï¼Œå¤§å°æ˜¯å¯åŠ¨æ—¶å›ºå®šå¥½çš„ï¼›</li><li>å…ƒç©ºé—´ä¸åœ¨è™šæ‹Ÿæœºä¸­ï¼Œè€Œæ˜¯ä½¿ç”¨æœ¬åœ°å†…å­˜ï¼Œå¹¶ä¸”å¤§å°å¯ä»¥è‡ªåŠ¨å¢é•¿ï¼Œå‡å°‘äº†OOMï¼ˆå†…å­˜æº¢å‡ºï¼‰çš„å‡ ç‡ï¼›</li></ul></li><li>åŒºåˆ«äºŒï¼ˆå †åŒºï¼‰<ul><li>Java7ä¹‹åè¿è¡Œæ—¶å¸¸é‡æ± ä»æ–¹æ³•åŒºç§»åˆ°äº†è¿™é‡Œï¼Œä¸ºJava8ç§»å‡ºæ°¸ä¹…ä»£åšå¥½å‡†å¤‡ï¼›</li></ul></li></ul><h4 id="ç¨‹åºè®¡æ•°å™¨"><a href="#ç¨‹åºè®¡æ•°å™¨" class="headerlink" title="ç¨‹åºè®¡æ•°å™¨"></a>ç¨‹åºè®¡æ•°å™¨</h4><p>ç¨‹åºè®¡æ•°å™¨æ˜¯ä¸€å—è¾ƒå°çš„å†…å­˜ç©ºé—´ï¼Œå¯ä»¥çœ‹ä½œæ˜¯å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨ã€‚å­—èŠ‚ç è§£é‡Šå™¨å·¥ä½œæ—¶é€šè¿‡æ”¹å˜è¿™ä¸ªè®¡æ•°å™¨çš„å€¼æ¥é€‰å–ä¸‹ä¸€æ¡éœ€è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ï¼Œåˆ†æ”¯ã€å¾ªç¯ã€è·³è½¬ã€å¼‚å¸¸å¤„ç†ã€çº¿ç¨‹æ¢å¤ç­‰åŠŸèƒ½éƒ½éœ€è¦ä¾èµ–è¿™ä¸ªè®¡æ•°å™¨æ¥å®Œæˆã€‚</p><p>å¦å¤–ï¼Œä¸ºäº†çº¿ç¨‹åˆ‡æ¢åèƒ½æ¢å¤åˆ°æ­£ç¡®çš„æ‰§è¡Œä½ç½®ï¼Œæ¯æ¡çº¿ç¨‹éƒ½éœ€è¦æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ç¨‹åºè®¡æ•°å™¨ï¼Œå„çº¿ç¨‹ä¹‹é—´è®¡æ•°å™¨äº’ä¸å½±å“ï¼Œç‹¬ç«‹å­˜å‚¨ï¼Œæˆ‘ä»¬ç§°è¿™ç±»å†…å­˜åŒºåŸŸä¸ºâ€œçº¿ç¨‹ç§æœ‰â€çš„å†…å­˜ã€‚</p><p>to be continued â€¦.</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://javaguide.cn/java/jvm/memory-area.html">https://javaguide.cn/java/jvm/memory-area.html</a></li><li><a href="https://www.pdai.tech/md/interview/x-interview.html#_5-jvm%E5%92%8C%E8%B0%83%E4%BC%98">https://www.pdai.tech/md/interview/x-interview.html#_5-jvm%E5%92%8C%E8%B0%83%E4%BC%98</a></li><li><a href="http://moxi159753.gitee.io/learningnotes/#/">http://moxi159753.gitee.io/learningnotes/#/</a></li><li><a href="https://www.bilibili.com/video/BV1iJ411d7jS">https://www.bilibili.com/video/BV1iJ411d7jS</a></li><li><a href="https://blog.csdn.net/fllow_wind/article/details/117027924">https://blog.csdn.net/fllow_wind/article/details/117027924</a></li><li><a href="https://zhuanlan.zhihu.com/p/25713880">https://zhuanlan.zhihu.com/p/25713880</a></li><li><a href="https://blog.csdn.net/xianyun1992/article/details/126555575">https://blog.csdn.net/xianyun1992/article/details/126555575</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
      <category>JVM</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>jvm</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaå¹¶å‘ç¼–ç¨‹_åŸºç¡€æ¦‚å¿µ</title>
    <link href="/2023/11/15/Java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/"/>
    <url>/2023/11/15/Java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å¤§çº²</p></blockquote><ul><li>çº¿ç¨‹åŸºç¡€æ¦‚å¿µ</li><li>Java çº¿ç¨‹</li><li>ç”Ÿå‘½å‘¨æœŸ</li><li>åˆ›å»ºçº¿ç¨‹</li><li>çº¿ç¨‹çš„è°ƒç”¨æ–¹æ³•</li><li>Synchronized å’Œ Lock</li></ul><h3 id="1ã€åŸºç¡€æ¦‚å¿µ"><a href="#1ã€åŸºç¡€æ¦‚å¿µ" class="headerlink" title="1ã€åŸºç¡€æ¦‚å¿µ"></a>1ã€åŸºç¡€æ¦‚å¿µ</h3><p>è¿›ç¨‹å’Œçº¿ç¨‹</p><ul><li>è¿›ç¨‹ï¼ˆProcessï¼‰æ˜¯ç³»ç»Ÿè¿›è¡Œèµ„æºåˆ†é…å’Œè°ƒåº¦çš„åŸºæœ¬å•ä½ï¼Œæ˜¯æ“ä½œç³»ç»Ÿç»“æ„çš„åŸºç¡€ã€‚</li><li>çº¿ç¨‹ï¼ˆThreadï¼‰æ˜¯æ“ä½œç³»ç»Ÿèƒ½å¤Ÿè¿›è¡Œè¿ç®—è°ƒåº¦çš„æœ€å°å•ä½ã€‚</li></ul><p>å¹¶è¡Œå’Œå¹¶å‘çš„åŒºåˆ«</p><ul><li>å¹¶è¡Œï¼šä¸¤ä¸ªåŠä¸¤ä¸ªä»¥ä¸Šçš„ä½œä¸šåœ¨åŒä¸€Â <strong>æ—¶åˆ»</strong>Â æ‰§è¡Œã€‚</li><li>å¹¶å‘ï¼šä¸¤ä¸ªåŠä¸¤ä¸ªä»¥ä¸Šçš„ä½œä¸šåœ¨åŒä¸€Â <strong>æ—¶é—´æ®µ</strong>Â å†…æ‰§è¡Œã€‚</li></ul><p>æœ€å…³é”®çš„ç‚¹æ˜¯ï¼šæ˜¯å¦æ˜¯Â <strong>åŒæ—¶</strong>Â æ‰§è¡Œ</p><p>åŒæ­¥å’Œå¼‚æ­¥çš„åŒºåˆ«</p><ul><li><strong>åŒæ­¥</strong>ï¼šå‘å‡ºä¸€ä¸ªè°ƒç”¨ä¹‹åï¼Œåœ¨æ²¡æœ‰å¾—åˆ°ç»“æœä¹‹å‰ï¼Œ è¯¥è°ƒç”¨å°±ä¸å¯ä»¥è¿”å›ï¼Œä¸€ç›´ç­‰å¾…ã€‚</li><li><strong>å¼‚æ­¥</strong>ï¼šè°ƒç”¨åœ¨å‘å‡ºä¹‹åï¼Œ<strong>ä¸ç”¨ç­‰å¾…è¿”å›ç»“æœ</strong>ï¼Œè¯¥è°ƒç”¨ç›´æ¥è¿”å›ã€‚</li></ul><h3 id="2ã€ä»€ä¹ˆæ˜¯Java-çº¿ç¨‹"><a href="#2ã€ä»€ä¹ˆæ˜¯Java-çº¿ç¨‹" class="headerlink" title="2ã€ä»€ä¹ˆæ˜¯Java çº¿ç¨‹"></a>2ã€ä»€ä¹ˆæ˜¯Java çº¿ç¨‹</h3><p>åœ¨ JDK 1.2 åŠä»¥åï¼ŒJava çº¿ç¨‹åŸºäºåŸç”Ÿçº¿ç¨‹ï¼ˆNative Threadsï¼‰å®ç°ï¼Œ JVM ç›´æ¥ä½¿ç”¨æ“ä½œç³»ç»ŸåŸç”Ÿçš„å†…æ ¸çº§çº¿ç¨‹ï¼ˆå†…æ ¸çº¿ç¨‹ï¼‰æ¥å®ç° Java çº¿ç¨‹ï¼Œç”±æ“ä½œç³»ç»Ÿå†…æ ¸è¿›è¡Œçº¿ç¨‹çš„è°ƒåº¦å’Œç®¡ç†ã€‚</p><p>ç”¨ä¸€å¥è¯æ¦‚æ‹¬ Java çº¿ç¨‹å’Œæ“ä½œç³»ç»Ÿçº¿ç¨‹çš„å…³ç³»ï¼š<strong>ç°åœ¨çš„ Java çº¿ç¨‹çš„æœ¬è´¨å…¶å®å°±æ˜¯æ“ä½œç³»ç»Ÿçš„çº¿ç¨‹</strong>ã€‚</p><p>åœ¨ Windows å’Œ Linux ç­‰ä¸»æµæ“ä½œç³»ç»Ÿä¸­ï¼ŒJava çº¿ç¨‹é‡‡ç”¨çš„æ˜¯ä¸€å¯¹ä¸€çš„çº¿ç¨‹æ¨¡å‹ï¼Œä¸€ä¸ª Java çº¿ç¨‹å¯¹åº”ä¸€ä¸ªç³»ç»Ÿå†…æ ¸çº¿ç¨‹ã€‚</p><h3 id="3ã€çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸåŠäº”ç§åŸºæœ¬çŠ¶æ€"><a href="#3ã€çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸåŠäº”ç§åŸºæœ¬çŠ¶æ€" class="headerlink" title="3ã€çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸåŠäº”ç§åŸºæœ¬çŠ¶æ€"></a>3ã€çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸåŠäº”ç§åŸºæœ¬çŠ¶æ€</h3><p>äº”ç§åŸºæœ¬çŠ¶æ€ï¼šæ–°å»ºï¼Œå°±ç»ªï¼Œé˜»å¡ï¼Œè¿è¡Œï¼Œæ­»äº¡</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311161130480.png" alt="image.png"></p><p>å…³äºJavaä¸­çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸï¼Œé¦–å…ˆçœ‹ä¸€ä¸‹ä¸‹é¢è¿™å¼ è¾ƒä¸ºç»å…¸çš„å›¾ï¼š</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311161129688.png" alt="image.png"></p><p>ä¸Šå›¾ä¸­åŸºæœ¬ä¸Šå›Šæ‹¬äº†Javaä¸­å¤šçº¿ç¨‹å„é‡è¦çŸ¥è¯†ç‚¹ã€‚æŒæ¡äº†ä¸Šå›¾ä¸­çš„å„çŸ¥è¯†ç‚¹ï¼ŒJavaä¸­çš„å¤šçº¿ç¨‹ä¹Ÿå°±åŸºæœ¬ä¸ŠæŒæ¡äº†ã€‚ä¸»è¦åŒ…æ‹¬ï¼š</p><p>Javaçº¿ç¨‹å…·æœ‰äº”ä¸­åŸºæœ¬çŠ¶æ€</p><ul><li>æ–°å»ºçŠ¶æ€ï¼ˆNewï¼‰<ul><li>å½“çº¿ç¨‹å¯¹è±¡å¯¹åˆ›å»ºåï¼Œå³è¿›å…¥äº†æ–°å»ºçŠ¶æ€ï¼Œå¦‚ï¼šThread t &#x3D; new MyThread();</li></ul></li><li>å°±ç»ªçŠ¶æ€ï¼ˆRunnableï¼‰<ul><li>å½“è°ƒç”¨çº¿ç¨‹å¯¹è±¡çš„start()æ–¹æ³•ï¼ˆt.start();ï¼‰ï¼Œçº¿ç¨‹å³è¿›å…¥å°±ç»ªçŠ¶æ€ã€‚</li><li>å¤„äºå°±ç»ªçŠ¶æ€çš„çº¿ç¨‹ï¼Œåªæ˜¯è¯´æ˜æ­¤çº¿ç¨‹å·²ç»åšå¥½äº†å‡†å¤‡ï¼Œéšæ—¶ç­‰å¾…CPUè°ƒåº¦æ‰§è¡Œï¼Œå¹¶ä¸æ˜¯è¯´æ‰§è¡Œäº†t.start()æ­¤çº¿ç¨‹ç«‹å³å°±ä¼šæ‰§è¡Œï¼›</li></ul></li><li>è¿è¡ŒçŠ¶æ€ï¼ˆRunningï¼‰<ul><li>å½“CPUå¼€å§‹è°ƒåº¦å¤„äºå°±ç»ªçŠ¶æ€çš„çº¿ç¨‹æ—¶ï¼Œæ­¤æ—¶çº¿ç¨‹æ‰å¾—ä»¥çœŸæ­£æ‰§è¡Œï¼Œå³è¿›å…¥åˆ°è¿è¡ŒçŠ¶æ€ã€‚</li><li>æ³¨ï¼šå°± ç»ªçŠ¶æ€æ˜¯è¿›å…¥åˆ°è¿è¡ŒçŠ¶æ€çš„å”¯ä¸€å…¥å£ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œçº¿ç¨‹è¦æƒ³è¿›å…¥è¿è¡ŒçŠ¶æ€æ‰§è¡Œï¼Œé¦–å…ˆå¿…é¡»å¤„äºå°±ç»ªçŠ¶æ€ä¸­</li></ul></li><li>é˜»å¡çŠ¶æ€ï¼ˆBlockedï¼‰<ul><li>å¤„äºè¿è¡ŒçŠ¶æ€ä¸­çš„çº¿ç¨‹ç”±äºæŸç§åŸå› ï¼Œæš‚æ—¶æ”¾å¼ƒå¯¹CPUçš„ä½¿ç”¨æƒï¼Œåœæ­¢æ‰§è¡Œï¼Œæ­¤æ—¶è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œç›´åˆ°å…¶è¿›å…¥åˆ°å°±ç»ªçŠ¶æ€ï¼Œæ‰ æœ‰æœºä¼šå†æ¬¡è¢«CPUè°ƒç”¨ä»¥è¿›å…¥åˆ°è¿è¡ŒçŠ¶æ€ã€‚</li><li>æ ¹æ®é˜»å¡äº§ç”Ÿçš„åŸå› ä¸åŒï¼Œé˜»å¡çŠ¶æ€åˆå¯ä»¥åˆ†ä¸ºä¸‰ç§<ul><li><strong>1.ç­‰å¾…é˜»å¡ï¼šè¿è¡ŒçŠ¶æ€ä¸­çš„çº¿ç¨‹æ‰§è¡Œwait()æ–¹æ³•ï¼Œä½¿æœ¬çº¿ç¨‹è¿›å…¥åˆ°ç­‰å¾…é˜»å¡çŠ¶æ€</strong>ï¼›</li><li><strong>2.åŒæ­¥é˜»å¡ :</strong> çº¿ç¨‹åœ¨è·å–synchronizedåŒæ­¥é”å¤±è´¥(å› ä¸ºé”è¢«å…¶å®ƒçº¿ç¨‹æ‰€å ç”¨)ï¼Œå®ƒä¼šè¿›å…¥åŒæ­¥é˜»å¡çŠ¶æ€ï¼›</li><li><strong>3.å…¶ä»–é˜»å¡ :</strong> é€šè¿‡è°ƒç”¨çº¿ç¨‹çš„sleep()æˆ–join()æˆ–å‘å‡ºäº†I&#x2F;Oè¯·æ±‚æ—¶ï¼Œçº¿ç¨‹ä¼šè¿›å…¥åˆ°é˜»å¡çŠ¶æ€ã€‚å½“sleep()çŠ¶æ€è¶…æ—¶ã€join()ç­‰å¾…çº¿ç¨‹ç»ˆæ­¢æˆ–è€…è¶…æ—¶ã€æˆ–è€…I&#x2F;Oå¤„ç†å®Œæ¯•æ—¶ï¼Œçº¿ç¨‹é‡æ–°è½¬å…¥å°±ç»ªçŠ¶æ€ã€‚</li></ul></li></ul></li><li>æ­»äº¡çŠ¶æ€ï¼ˆDeadï¼‰<ul><li>çº¿ç¨‹æ‰§è¡Œå®Œäº†æˆ–è€…å› å¼‚å¸¸é€€å‡ºäº†run()æ–¹æ³•ï¼Œè¯¥çº¿ç¨‹ç»“æŸç”Ÿå‘½å‘¨æœŸã€‚</li></ul></li></ul><blockquote><p>Javaå¤šçº¿ç¨‹çš„å°±ç»ªã€è¿è¡Œå’Œæ­»äº¡çŠ¶æ€</p></blockquote><p>å°±ç»ªçŠ¶æ€è½¬æ¢ä¸ºè¿è¡ŒçŠ¶æ€ï¼šå½“æ­¤çº¿ç¨‹å¾—åˆ°å¤„ç†å™¨èµ„æºï¼›</p><p>è¿è¡ŒçŠ¶æ€è½¬æ¢ä¸ºå°±ç»ªçŠ¶æ€ï¼šå½“æ­¤çº¿ç¨‹ä¸»åŠ¨è°ƒç”¨yield()æ–¹æ³•æˆ–åœ¨è¿è¡Œè¿‡ç¨‹ä¸­å¤±å»å¤„ç†å™¨èµ„æºã€‚</p><p>è¿è¡ŒçŠ¶æ€è½¬æ¢ä¸ºæ­»äº¡çŠ¶æ€ï¼šå½“æ­¤çº¿ç¨‹çº¿ç¨‹æ‰§è¡Œä½“æ‰§è¡Œå®Œæ¯•æˆ–å‘ç”Ÿäº†å¼‚å¸¸ã€‚</p><p>æ­¤å¤„éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼šå½“è°ƒç”¨çº¿ç¨‹çš„yield()æ–¹æ³•æ—¶ï¼Œçº¿ç¨‹ä»è¿è¡ŒçŠ¶æ€è½¬æ¢ä¸ºå°±ç»ªçŠ¶æ€ï¼Œä½†æ¥ä¸‹æ¥CPUè°ƒåº¦å°±ç»ªçŠ¶æ€ä¸­çš„å“ªä¸ªçº¿ç¨‹å…·æœ‰ä¸€å®šçš„éšæœºæ€§ï¼Œå› æ­¤ï¼Œå¯èƒ½ä¼šå‡ºç°Açº¿ç¨‹è°ƒç”¨äº†yield()æ–¹æ³•åï¼Œæ¥ä¸‹æ¥CPUä»ç„¶è°ƒåº¦äº†Açº¿ç¨‹çš„æƒ…å†µã€‚</p><h3 id="4ã€åˆ›å»ºçº¿ç¨‹"><a href="#4ã€åˆ›å»ºçº¿ç¨‹" class="headerlink" title="4ã€åˆ›å»ºçº¿ç¨‹"></a>4ã€åˆ›å»ºçº¿ç¨‹</h3><p>åœ¨Javaä¸­ï¼Œæœ‰ä¸‰ç§å¸¸è§çš„çº¿ç¨‹åˆ›å»ºæ–¹å¼ï¼šä½¿ç”¨Threadç±»ã€å®ç°Runnableæ¥å£å’Œå®ç°Callableæ¥å£ã€‚</p><ol><li>Threadç±»ï¼šThreadç±»æ˜¯ Java æä¾›çš„ä¸€ä¸ªçº¿ç¨‹ç±»ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç»§æ‰¿Threadç±»æ¥åˆ›å»ºçº¿ç¨‹ã€‚<strong>é€šè¿‡é‡å†™Threadç±»çš„run()æ–¹æ³•æ¥å®šä¹‰çº¿ç¨‹çš„æ‰§è¡Œé€»è¾‘</strong>ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyThread</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Thread</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">// çº¿ç¨‹çš„æ‰§è¡Œé€»è¾‘</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// åˆ›å»ºçº¿ç¨‹</span><br><span class="hljs-type">MyThread</span> <span class="hljs-variable">myThread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyThread</span>();<br>myThread.start();<br></code></pre></td></tr></table></figure><ol start="2"><li>Runnableæ¥å£ï¼šRunnableæ¥å£æ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®ç°Runnableæ¥å£æ¥åˆ›å»ºçº¿ç¨‹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒRunnableæ¥å£å¹¶ä¸æ˜¯ä¸€ä¸ªçº¿ç¨‹ç±»ï¼Œ<strong>è€Œæ˜¯ä¸€ä¸ªä»»åŠ¡ï¼Œéœ€è¦é€šè¿‡Threadç±»æ¥åˆ›å»ºçº¿ç¨‹</strong>å¹¶æ‰§è¡Œä»»åŠ¡ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyRunnable</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Runnable</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">// çº¿ç¨‹çš„æ‰§è¡Œé€»è¾‘</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// åˆ›å»ºçº¿ç¨‹</span><br><span class="hljs-type">MyRunnable</span> <span class="hljs-variable">myRunnable</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyRunnable</span>();<br><span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(myRunnable);<br>thread.start();<br></code></pre></td></tr></table></figure><ol start="3"><li>Callableæ¥å£ï¼šCallableæ¥å£ä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼Œä¸Runnableæ¥å£ç±»ä¼¼ï¼Œå¯ä»¥é€šè¿‡å®ç°Callableæ¥å£æ¥åˆ›å»ºçº¿ç¨‹ã€‚ä¸åŒçš„æ˜¯ï¼Œ<strong>Callableæ¥å£çš„call()æ–¹æ³•å¯ä»¥è¿”å›ä¸€ä¸ªç»“æœï¼Œå¹¶ä¸”å¯ä»¥æŠ›å‡ºå¼‚å¸¸</strong>ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyCallable</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Callable</span>&lt;Integer&gt; &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Integer <span class="hljs-title function_">call</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-comment">// çº¿ç¨‹çš„æ‰§è¡Œé€»è¾‘</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-number">42</span>; <span class="hljs-comment">// è¿”å›ä¸€ä¸ªç»“æœ</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// åˆ›å»ºçº¿ç¨‹</span><br><span class="hljs-type">MyCallable</span> <span class="hljs-variable">myCallable</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyCallable</span>();<br><span class="hljs-type">ExecutorService</span> <span class="hljs-variable">executorService</span> <span class="hljs-operator">=</span> Executors.newSingleThreadExecutor();<br>Future&lt;Integer&gt; future = executorService.submit(myCallable);<br></code></pre></td></tr></table></figure><ul><li>ä½¿ç”¨Threadç±»åˆ›å»ºçº¿ç¨‹æ˜¯æœ€ç›´æ¥çš„æ–¹å¼ï¼Œä½†æ˜¯ç”±äºJavaä¸æ”¯æŒå¤šç»§æ‰¿ï¼Œæ‰€ä»¥å¦‚æœå·²ç»æœ‰ä¸€ä¸ªçˆ¶ç±»ï¼Œå°±ä¸èƒ½å†ç›´æ¥ä½¿ç”¨Threadç±»åˆ›å»ºçº¿ç¨‹ã€‚</li><li>å®ç°Runnableæ¥å£æ˜¯ä¸€ç§æ›´åŠ çµæ´»çš„æ–¹å¼ï¼Œå¯ä»¥é¿å…å•ç»§æ‰¿çš„é™åˆ¶ï¼Œè¿˜å¯ä»¥å…±äº«æ•°æ®ã€‚</li><li>Callableæ¥å£ä¸Runnableæ¥å£ç±»ä¼¼ï¼Œä½†å¯ä»¥è¿”å›ä¸€ä¸ªç»“æœï¼Œå¹¶ä¸”å¯ä»¥æŠ›å‡ºå¼‚å¸¸ã€‚å¯ä»¥é€šè¿‡ExecutorServiceçš„submit()æ–¹æ³•æ¥æ‰§è¡ŒCallableä»»åŠ¡ï¼Œå¹¶è¿”å›ä¸€ä¸ªFutureå¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡è¯¥å¯¹è±¡è·å–ä»»åŠ¡çš„ç»“æœã€‚</li></ul><blockquote><p>å†™æ³•ç®€åŒ–ï¼ˆJava 8)</p></blockquote><ul><li><strong>æ–¹å¼ä¸€ï¼š</strong></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>()&#123; <br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123; <br>        System.out.println(<span class="hljs-string">&quot;thread run ...&quot;</span>);<br>    &#125;<br>&#125;;<br><br>thread.start();<br></code></pre></td></tr></table></figure><p>ç®€åŒ–åï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; System.out.println(<span class="hljs-string">&quot;thread run ...&quot;</span>));<br><br>thread.start();<br></code></pre></td></tr></table></figure><ul><li><strong>æ–¹å¼äºŒï¼š</strong></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() &#123; <br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123; <br>        System.out.println(<span class="hljs-string">&quot;runnable run ...&quot;</span>);<br>    &#125;<br>&#125;);<br><br>thread.start();<br></code></pre></td></tr></table></figure><p>ç®€åŒ–åï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; System.out.println(<span class="hljs-string">&quot;runnable run ...&quot;</span>));<br><br>thread.start();<br></code></pre></td></tr></table></figure><ul><li><strong>æ–¹å¼ä¸‰ï¼š</strong></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java">Callable&lt;Integer&gt; callable = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Callable</span>() &#123; <br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">call</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception &#123; <br>        System.out.println(<span class="hljs-string">&quot;callable run ...&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">521</span>;<br>    &#125;<br>&#125;;<br><span class="hljs-type">FutureTask</span> <span class="hljs-variable">futureTask</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FutureTask</span>(callable);<br><span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(futureTask);<br>thread.start();<br></code></pre></td></tr></table></figure><p>ç®€åŒ–åï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FutureTask</span>(() -&gt; &#123; <br>    System.out.println(<span class="hljs-string">&quot;callable run ...&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">521</span>;<br>&#125;));<br><br>thread.start();<br></code></pre></td></tr></table></figure><h3 id="5ã€çº¿ç¨‹åŸºæœ¬æ–¹æ³•"><a href="#5ã€çº¿ç¨‹åŸºæœ¬æ–¹æ³•" class="headerlink" title="5ã€çº¿ç¨‹åŸºæœ¬æ–¹æ³•"></a>5ã€çº¿ç¨‹åŸºæœ¬æ–¹æ³•</h3><blockquote><p>æ³¨æ„ï¼šæ ‡é»„è‰²çš„æ–¹æ³•ä»£è¡¨æ˜¯ <code>static</code>â€‹ æ–¹æ³•ï¼Œå¯ç›´æ¥ç±»åè°ƒç”¨ï¼Œæ— éœ€åˆ›å»ºå¯¹è±¡ã€‚</p></blockquote><table><thead><tr><th>åç§°</th><th>æè¿°</th><th>æ³¨æ„äº‹é¡¹</th></tr></thead><tbody><tr><td>â€‹<code>start()</code>â€‹</td><td>å¯åŠ¨ä¸€ä¸ªæ–°çº¿ç¨‹ï¼Œ<br />åœ¨æ–°çš„çº¿ç¨‹è¿è¡Œ run æ–¹æ³•</td><td>start æ–¹æ³•åªæ˜¯è®©çº¿ç¨‹è¿›å…¥å°±ç»ªï¼Œé‡Œé¢ä»£ç ä¸ä¸€å®šç«‹åˆ»<br />è¿è¡Œï¼ˆCPU çš„æ—¶é—´ç‰‡è¿˜æ²¡åˆ†ç»™å®ƒï¼‰ã€‚æ¯ä¸ªçº¿ç¨‹å¯¹è±¡çš„<br />startæ–¹æ³•åªèƒ½è°ƒç”¨ä¸€æ¬¡ï¼Œå¦‚æœè°ƒç”¨äº†å¤šæ¬¡ä¼šå‡ºç°<br />IllegalThreadStateException</td></tr><tr><td>â€‹<code>run()</code>â€‹</td><td>æ–°çº¿ç¨‹å¯åŠ¨åä¼šè°ƒç”¨çš„æ–¹æ³•</td><td>å¦‚æœåœ¨æ„é€  Thread å¯¹è±¡æ—¶ä¼ é€’äº† Runnable å‚æ•°ï¼Œåˆ™<br />çº¿ç¨‹å¯åŠ¨åä¼šè°ƒç”¨ Runnable ä¸­çš„ run æ–¹æ³•ï¼Œå¦åˆ™é»˜<br />è®¤ä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚ä½†å¯ä»¥åˆ›å»º Thread çš„å­ç±»å¯¹è±¡ï¼Œ<br />æ¥è¦†ç›–é»˜è®¤è¡Œä¸º</td></tr><tr><td>â€‹<code>join()</code>â€‹</td><td>ç­‰å¾…çº¿ç¨‹è¿è¡Œç»“æŸ</td><td></td></tr><tr><td>â€‹<code>join(long n)</code>â€‹</td><td>ç­‰å¾…çº¿ç¨‹è¿è¡Œç»“æŸï¼Œ<br />æœ€å¤šç­‰å¾… n æ¯«ç§’</td><td></td></tr><tr><td>â€‹<code>getId()</code>â€‹</td><td>è·å–çº¿ç¨‹é•¿æ•´å‹çš„ id</td><td>id å”¯ä¸€</td></tr><tr><td>â€‹<code>getName()</code>â€‹</td><td>è·å–çº¿ç¨‹å</td><td></td></tr><tr><td>â€‹<code>setName(String name)</code>â€‹</td><td>ä¿®æ”¹çº¿ç¨‹å</td><td></td></tr><tr><td>â€‹<code>getPriority()</code>â€‹</td><td>è·å–çº¿ç¨‹ä¼˜å…ˆçº§</td><td></td></tr><tr><td>â€‹<code>setPriority(int priority)</code>â€‹</td><td>ä¿®æ”¹çº¿ç¨‹ä¼˜å…ˆçº§</td><td>Java ä¸­è§„å®šçº¿ç¨‹ä¼˜å…ˆçº§æ˜¯1~10 çš„æ•´æ•°ï¼Œè¾ƒå¤§çš„ä¼˜å…ˆçº§<br />èƒ½æé«˜è¯¥çº¿ç¨‹è¢« CPU è°ƒåº¦çš„æœºç‡</td></tr><tr><td>â€‹<code>getState()</code>â€‹</td><td>è·å–çº¿ç¨‹çŠ¶æ€</td><td>Java ä¸­çº¿ç¨‹çŠ¶æ€æ˜¯ç”¨ 6 ä¸ª enum è¡¨ç¤ºï¼Œåˆ†åˆ«ä¸ºï¼š<br />NEW, RUNNABLE, BLOCKED, WAITING,<br />TIMED_WAITING, TERMINATED</td></tr><tr><td>â€‹<code>interrupt()</code>â€‹</td><td>æ‰“æ–­çº¿ç¨‹</td><td>å¦‚æœè¢«æ‰“æ–­çº¿ç¨‹æ­£åœ¨ sleepï¼Œwaitï¼Œjoin ä¼šå¯¼è‡´è¢«<br />æ‰“æ–­çš„çº¿ç¨‹æŠ›å‡º InterruptedExceptionï¼Œå¹¶æ¸…é™¤<br />æ‰“æ–­æ ‡è®°ï¼›å¦‚æœæ‰“æ–­æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹ï¼Œåˆ™ä¼šè®¾ç½®<br />æ‰“æ–­æ ‡è®°ï¼›park çš„çº¿ç¨‹è¢«æ‰“æ–­ï¼Œä¹Ÿä¼šè®¾ç½®æ‰“æ–­æ ‡è®°</td></tr><tr><td><font color=Coral>interrupted()</font></td><td>åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦è¢«æ‰“æ–­</td><td>ä¼šæ¸…é™¤æ‰“æ–­æ ‡è®°</td></tr><tr><td>â€‹<code>isInterrupted()</code>â€‹</td><td>åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦è¢«æ‰“æ–­</td><td>ä¸ä¼šæ¸…é™¤æ‰“æ–­æ ‡è®°</td></tr><tr><td>â€‹<code>isAlive()</code>â€‹</td><td>åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦å­˜æ´»</td><td></td></tr><tr><td>â€‹<code>isDaemon()</code>â€‹</td><td>åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦æ˜¯å®ˆæŠ¤çº¿ç¨‹</td><td></td></tr><tr><td>â€‹<code>setDaemon(boolean on)</code>â€‹</td><td>è®¾ç½®å½“å‰çº¿ç¨‹ä¸ºå®ˆæŠ¤çº¿ç¨‹</td><td></td></tr><tr><td><font color=Coral>currentThread()</font></td><td>è·å–å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹</td><td></td></tr><tr><td><font color=Coral>sleep(long n)</font></td><td>è®©å½“å‰æ‰§è¡Œçš„çº¿ç¨‹ä¼‘çœ næ¯«ç§’ï¼Œ<br />ä¼‘çœ æ—¶è®©å‡º CPU çš„æ—¶é—´ç‰‡<br />ç»™å…¶å®ƒçº¿ç¨‹</td><td></td></tr><tr><td><font color=Coral>yield()</font></td><td>æç¤ºçº¿ç¨‹è°ƒåº¦å™¨è®©å‡ºå½“å‰çº¿ç¨‹<br />å¯¹ CPU çš„ä½¿ç”¨</td><td>ä¸»è¦æ˜¯ä¸ºäº†æµ‹è¯•å’Œè°ƒè¯•ï¼Œå®ƒçš„å…·ä½“çš„å®ç°ä¾èµ–äº<br />æ“ä½œç³»ç»Ÿçš„ä»»åŠ¡è°ƒåº¦å™¨</td></tr></tbody></table><h3 id="6ã€Synchronized-å’Œ-Lock-çš„ä½¿ç”¨"><a href="#6ã€Synchronized-å’Œ-Lock-çš„ä½¿ç”¨" class="headerlink" title="6ã€Synchronized å’Œ Lock çš„ä½¿ç”¨"></a>6ã€Synchronized å’Œ Lock çš„ä½¿ç”¨</h3><p>å¹¶å‘ç¼–ç¨‹ä¸­ï¼Œé”æ˜¯ç»å¸¸éœ€è¦ç”¨åˆ°çš„ã€‚è¿™é‡Œè®²è¿°ä¸€ä¸‹ Synchronized å’Œ Lock çš„ä½¿ç”¨ã€‚</p><p>Synchronized æ˜¯ Java å¹¶å‘ç¼–ç¨‹ ä¸­å¾ˆé‡è¦çš„å…³é”®å­—ï¼Œå¦å¤–ä¸€ä¸ªå¾ˆé‡è¦çš„æ˜¯ volatileã€‚</p><p>Syncronized çš„ç›®çš„æ˜¯ä¸€æ¬¡<strong>åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è¿›å…¥ç”±ä»–ä¿®é¥°çš„ä»£ç æ®µ</strong>ï¼Œä»è€Œå…è®¸ä»–ä»¬è¿›è¡Œè‡ªæˆ‘ä¿æŠ¤ã€‚</p><p>Lock æ˜¯ Javaå¹¶å‘ç¼–ç¨‹ä¸­<strong>å¾ˆé‡è¦çš„ä¸€ä¸ªæ¥å£</strong>ï¼Œå®ƒè¦æ¯” Synchronized å…³é”®å­—æ›´èƒ½ç›´è¯‘â€é”â€çš„æ¦‚å¿µï¼ŒLockéœ€è¦<strong>æ‰‹åŠ¨åŠ é”å’Œæ‰‹åŠ¨è§£é”</strong>ï¼Œä¸€èˆ¬é€šè¿‡ lock.lock() æ–¹æ³•æ¥è¿›è¡ŒåŠ é”ï¼Œ é€šè¿‡ lock.unlock() æ–¹æ³•è¿›è¡Œè§£é”ã€‚ä¸ Lock å…³è”å¯†åˆ‡çš„é”æœ‰ ReetrantLock å’Œ ReadWriteLockã€‚</p><h4 id="Synchronized"><a href="#Synchronized" class="headerlink" title="Synchronized"></a>Synchronized</h4><blockquote><p>åœ¨æ–¹æ³•ä¸Šä½¿ç”¨ Synchronized</p></blockquote><p>æ–¹æ³•å£°æ˜æ—¶ä½¿ç”¨ï¼Œæ”¾åœ¨èŒƒå›´æ“ä½œç¬¦ä¹‹å,è¿”å›ç±»å‹å£°æ˜ä¹‹å‰ã€‚å³ä¸€æ¬¡åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹è¿›å…¥è¯¥æ–¹æ³•ï¼Œå…¶ä»–çº¿ç¨‹è¦æƒ³åœ¨æ­¤æ—¶è°ƒç”¨è¯¥æ–¹æ³•ï¼Œåªèƒ½æ’é˜Ÿç­‰å€™ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-type">int</span> number;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">numIncrease</span><span class="hljs-params">()</span>&#123;<br>  number++;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>åœ¨æŸä¸ªä»£ç æ®µä½¿ç”¨ Synchronized</p></blockquote><p>å¯ä»¥åœ¨æŸä¸ªä»£ç å—ä¸Šä½¿ç”¨ Synchronized å…³é”®å­—ï¼Œè¡¨ç¤ºåªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹è¿›å…¥æŸä¸ªä»£ç æ®µã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">numDecrease</span><span class="hljs-params">(Object num)</span>&#123;<br>  <span class="hljs-keyword">synchronized</span> (num)&#123;<br>    number++;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>ä½¿ç”¨ Synchronized é”ä½æ•´ä¸ªå¯¹è±¡</p></blockquote><p>synchronizedåé¢æ‹¬å·é‡Œæ˜¯ä¸€å¯¹è±¡ï¼Œæ­¤æ—¶çº¿ç¨‹è·å¾—çš„æ˜¯å¯¹è±¡é”ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span> &#123;<br>  <span class="hljs-keyword">synchronized</span> (<span class="hljs-built_in">this</span>) &#123;<br>    <span class="hljs-comment">// ...</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="Lock"><a href="#Lock" class="headerlink" title="Lock"></a>Lock</h4><p>Lock æ˜¯ Javaå¹¶å‘ç¼–ç¨‹ä¸­<strong>å¾ˆé‡è¦çš„ä¸€ä¸ªæ¥å£</strong>ï¼Œç›¸å…³æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Lock</span> &#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">lock</span><span class="hljs-params">()</span>;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">lockInterruptibly</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException;<br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryLock</span><span class="hljs-params">()</span>;<br>    <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryLock</span><span class="hljs-params">(<span class="hljs-type">long</span> time, TimeUnit unit)</span> <span class="hljs-keyword">throws</span> InterruptedException;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">unlock</span><span class="hljs-params">()</span>;<br>    Condition <span class="hljs-title function_">newCondition</span><span class="hljs-params">()</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¸¸ç”¨æ–¹æ³•</p><ul><li>lock()<ul><li>ç”¨æ¥è·å–é”ã€‚å¦‚æœé”è¢«å…¶ä»–çº¿ç¨‹è·å–ï¼Œåˆ™è¿›è¡Œç­‰å¾…ã€‚</li><li>å¦‚æœé‡‡ç”¨Lockï¼Œå¿…é¡»ä¸»åŠ¨å»é‡Šæ”¾é”ï¼Œå¹¶ä¸”åœ¨å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œä¸ä¼šè‡ªåŠ¨é‡Šæ”¾é”</li></ul></li><li>tryLock()<ul><li>æ–¹æ³•æ˜¯æœ‰è¿”å›å€¼çš„ï¼Œå®ƒè¡¨ç¤ºç”¨æ¥å°è¯•è·å–é”ï¼Œå¦‚æœè·å–æˆåŠŸï¼Œåˆ™è¿”å›trueï¼Œå¦‚æœè·å–å¤±è´¥ï¼ˆå³é”å·²è¢«å…¶ä»–çº¿ç¨‹è·å–ï¼‰ï¼Œåˆ™è¿”å›falseï¼Œ</li><li>è¿™ä¸ªæ–¹æ³•æ— è®ºå¦‚ä½•éƒ½ä¼šç«‹å³è¿”å›ã€‚åœ¨æ‹¿ä¸åˆ°é”æ—¶ä¸ä¼šä¸€ç›´ç­‰å¾…ã€‚</li></ul></li><li>tryLock(long time, TimeUnit unit)<ul><li>å’ŒtryLock()æ–¹æ³•æ˜¯ç±»ä¼¼</li><li>åœ¨æ‹¿ä¸åˆ°é”æ—¶<strong>ä¼šç­‰å¾…ä¸€å®šçš„æ—¶é—´</strong>ï¼Œåœ¨æ—¶é—´æœŸé™ä¹‹å†…å¦‚æœè¿˜æ‹¿ä¸åˆ°é”ï¼Œå°±è¿”å›falseã€‚å¦‚æœå¦‚æœä¸€å¼€å§‹æ‹¿åˆ°é”æˆ–è€…åœ¨ç­‰å¾…æœŸé—´å†…æ‹¿åˆ°äº†é”ï¼Œåˆ™è¿”å›trueã€‚</li></ul></li><li>lockInterruptibly()<ul><li>å»è·å–é”æ—¶ï¼Œå¦‚æœçº¿ç¨‹æ­£åœ¨ç­‰å¾…è·å–é”ï¼Œåˆ™è¿™ä¸ªçº¿ç¨‹èƒ½å¤Ÿå“åº”ä¸­æ–­ï¼Œå³<strong>ä¸­æ–­çº¿ç¨‹çš„ç­‰å¾…çŠ¶æ€</strong>ã€‚</li><li>å½“ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶é€šè¿‡ lock.lockInterruptibly() æƒ³è·å–æŸä¸ªé”æ—¶ï¼Œå‡è‹¥æ­¤æ—¶çº¿ç¨‹Aè·å–åˆ°äº†é”ï¼Œè€Œçº¿ç¨‹Båªæœ‰åœ¨ç­‰å¾…ï¼Œé‚£ä¹ˆå¯¹çº¿ç¨‹Bè°ƒç”¨ threadB.interrupt() æ–¹æ³•èƒ½å¤Ÿä¸­æ–­çº¿ç¨‹Bçš„ç­‰å¾…è¿‡ç¨‹ã€‚</li><li>ç”±äº lockInterruptibly() çš„å£°æ˜ä¸­æŠ›å‡ºäº†å¼‚å¸¸ï¼Œæ‰€ä»¥ lock.lockInterruptibly() å¿…é¡»æ”¾åœ¨tryå—ä¸­æˆ–è€…åœ¨è°ƒç”¨lockInterruptibly() çš„æ–¹æ³•å¤–å£°æ˜æŠ›å‡º InterruptedExceptionã€‚</li></ul></li></ul><blockquote><p>ä»£ç ç¤ºä¾‹ï¼š</p></blockquote><p>lock()</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Lock</span> <span class="hljs-variable">lock</span> <span class="hljs-operator">=</span> ...;<br>lock.lock();<br><span class="hljs-keyword">try</span>&#123;<br>    <span class="hljs-comment">//å¤„ç†ä»»åŠ¡</span><br>&#125;<span class="hljs-keyword">catch</span>(Exception ex)&#123;<br>     <br>&#125;<span class="hljs-keyword">finally</span>&#123;<br>    lock.unlock();   <span class="hljs-comment">//é‡Šæ”¾é”</span><br>&#125;<br></code></pre></td></tr></table></figure><p>tryLock()</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Lock</span> lock = ...;<br><span class="hljs-keyword">if</span>(lock.<span class="hljs-title function_">tryLock</span>()) &#123;<br>     <span class="hljs-keyword">try</span>&#123;<br>         <span class="hljs-comment">//å¤„ç†ä»»åŠ¡</span><br>     &#125;<span class="hljs-keyword">catch</span>(<span class="hljs-title class_">Exception</span> ex)&#123;<br>         <br>     &#125;<span class="hljs-keyword">finally</span>&#123;<br>         lock.<span class="hljs-title function_">unlock</span>();   <span class="hljs-comment">//é‡Šæ”¾é”</span><br>     &#125;<br>&#125;<span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-comment">//å¦‚æœä¸èƒ½è·å–é”ï¼Œåˆ™ç›´æ¥åšå…¶ä»–äº‹æƒ…</span><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>lockInterruptibly()</strong> </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript">public <span class="hljs-keyword">void</span> <span class="hljs-title function_">method</span>() throws <span class="hljs-title class_">InterruptedException</span> &#123;<br>    lock.<span class="hljs-title function_">lockInterruptibly</span>();<br>    <span class="hljs-keyword">try</span> &#123;<br>     <span class="hljs-comment">//.....</span><br>    &#125;<br>    <span class="hljs-keyword">finally</span> &#123;<br>        lock.<span class="hljs-title function_">unlock</span>();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸€èˆ¬æ¥è¯´ï¼Œä½¿ç”¨Lockå¿…é¡»åœ¨try{}catch{}å—ä¸­è¿›è¡Œï¼Œå¹¶ä¸”å°†<strong>é‡Šæ”¾é”çš„æ“ä½œæ”¾åœ¨finallyå—ä¸­è¿›è¡Œ</strong>ï¼Œä»¥ä¿è¯é”ä¸€å®šè¢«è¢«é‡Šæ”¾ï¼Œé˜²æ­¢æ­»é”çš„å‘ç”Ÿã€‚</p><blockquote><p>æ³¨æ„ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è·å–äº†é”ä¹‹åï¼Œæ˜¯ä¸ä¼šè¢«interrupt()æ–¹æ³•ä¸­æ–­çš„ã€‚<br>å•ç‹¬è°ƒç”¨ interrupt() æ–¹æ³•ä¸èƒ½ä¸­æ–­æ­£åœ¨è¿è¡Œè¿‡ç¨‹ä¸­çš„çº¿ç¨‹ï¼Œåªèƒ½<strong>ä¸­æ–­é˜»å¡è¿‡ç¨‹ä¸­çš„çº¿ç¨‹</strong>ã€‚å› æ­¤å½“é€šè¿‡lockInterruptibly()æ–¹æ³•è·å–æŸä¸ªé”æ—¶ï¼Œå¦‚æœä¸èƒ½è·å–åˆ°ï¼Œ<strong>åªæœ‰è¿›è¡Œç­‰å¾…çš„æƒ…å†µä¸‹ï¼Œæ˜¯å¯ä»¥å“åº”ä¸­æ–­çš„</strong>ã€‚<br>è€Œ<strong>ç”¨synchronizedä¿®é¥°çš„è¯</strong>ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹å¤„äºç­‰å¾…æŸä¸ªé”çš„çŠ¶æ€ï¼Œæ˜¯æ— æ³•è¢«ä¸­æ–­çš„ï¼Œåªæœ‰ä¸€ç›´ç­‰å¾…ä¸‹å»ã€‚</p></blockquote><hr><p>å‚è€ƒï¼š</p><ul><li><a href="https://javaguide.cn/java/concurrent/java-concurrent-questions-01.html">https://javaguide.cn/java/concurrent/java-concurrent-questions-01.html</a></li><li><a href="https://www.cnblogs.com/fmgao-technology/p/11077543.html">https://www.cnblogs.com/fmgao-technology/p/11077543.html</a></li><li><a href="https://caochenlei.blog.csdn.net/article/details/119992847">https://caochenlei.blog.csdn.net/article/details/119992847</a></li><li><a href="https://cloud.tencent.com/developer/article/1497476">https://cloud.tencent.com/developer/article/1497476</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
      <category>Thread</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>thread</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaé›†åˆ_HashMapå­¦ä¹ </title>
    <link href="/2023/11/15/Java%E9%9B%86%E5%90%88_HashMap%E5%AD%A6%E4%B9%A0/"/>
    <url>/2023/11/15/Java%E9%9B%86%E5%90%88_HashMap%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h3 id="1ã€åŸºç¡€æ¦‚å¿µ"><a href="#1ã€åŸºç¡€æ¦‚å¿µ" class="headerlink" title="1ã€åŸºç¡€æ¦‚å¿µ"></a>1ã€åŸºç¡€æ¦‚å¿µ</h3><p>HashMap ä¸»è¦ç”¨æ¥å­˜æ”¾é”®å€¼å¯¹ï¼ŒåŸºäºå“ˆå¸Œè¡¨çš„ Map æ¥å£å®ç°ï¼Œæ˜¯å¸¸ç”¨çš„ Java é›†åˆä¹‹ä¸€ã€‚</p><p>HashMapæ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼Œæ•ˆç‡è¾ƒé«˜ã€‚</p><p>å®ƒå¯ä»¥å­˜å‚¨ null çš„ key å’Œ valueï¼Œä½† null ä½œä¸ºé”®åªèƒ½æœ‰ä¸€ä¸ªï¼Œnull ä½œä¸ºå€¼å¯ä»¥æœ‰å¤šä¸ª</p><p><strong>åº•å±‚æ•°æ®ç»“æ„</strong>ï¼š</p><ul><li>JDK1.8 ä¹‹å‰ HashMap ç”± æ•°ç»„+é“¾è¡¨ ç»„æˆçš„ï¼Œæ•°ç»„æ˜¯ HashMap çš„ä¸»ä½“ï¼Œé“¾è¡¨åˆ™æ˜¯ä¸»è¦ä¸ºäº†è§£å†³å“ˆå¸Œå†²çªè€Œå­˜åœ¨çš„ï¼ˆâ€œæ‹‰é“¾æ³•â€è§£å†³å†²çªï¼‰ã€‚</li><li>JDK1.8 ä»¥åçš„ <code>HashMap</code> åœ¨è§£å†³å“ˆå¸Œå†²çªæ—¶æœ‰äº†è¾ƒå¤§çš„å˜åŒ–ï¼Œå½“é“¾è¡¨é•¿åº¦å¤§äºç­‰äºé˜ˆå€¼ï¼ˆé»˜è®¤ä¸º 8ï¼‰ï¼ˆå°†é“¾è¡¨è½¬æ¢æˆçº¢é»‘æ ‘å‰ä¼šåˆ¤æ–­ï¼Œå¦‚æœå½“å‰æ•°ç»„çš„é•¿åº¦å°äº 64ï¼Œé‚£ä¹ˆä¼šé€‰æ‹©å…ˆè¿›è¡Œæ•°ç»„æ‰©å®¹ï¼Œè€Œä¸æ˜¯è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼‰æ—¶ï¼Œå°†é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œä»¥å‡å°‘æœç´¢æ—¶é—´ã€‚</li></ul><p><strong>æ‰©å……æœºåˆ¶</strong>ï¼š<code>HashMap</code> é»˜è®¤çš„åˆå§‹åŒ–å¤§å°ä¸º 16ã€‚ä¹‹åæ¯æ¬¡æ‰©å……ï¼Œå®¹é‡å˜ä¸ºåŸæ¥çš„ 2 å€ã€‚å¹¶ä¸”ï¼Œ <code>HashMap</code> æ€»æ˜¯ä½¿ç”¨ 2 çš„å¹‚ä½œä¸ºå“ˆå¸Œè¡¨çš„å¤§å°ã€‚</p><blockquote><p>HashMapçš„å¸¸ç”¨æ–¹æ³•</p></blockquote><p>1ã€put(K key, V value)ï¼š å°†é”®ï¼ˆkeyï¼‰&#x2F;å€¼ï¼ˆvalueï¼‰æ˜ å°„å­˜æ”¾åˆ°Mapé›†åˆä¸­ã€‚</p><p>2ã€get(Object key)ï¼š è¿”å›æŒ‡å®šé”®æ‰€æ˜ å°„çš„å€¼ï¼Œæ²¡æœ‰è¯¥keyå¯¹åº”çš„å€¼åˆ™è¿”å› nullã€‚</p><p>3ã€size()ï¼š è¿”å›Mapé›†åˆä¸­æ•°æ®æ•°é‡ã€‚</p><p>4ã€clear()ï¼š æ¸…ç©ºMapé›†åˆã€‚</p><p>5ã€isEmpty()ï¼š åˆ¤æ–­Mapé›†åˆä¸­æ˜¯å¦æœ‰æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰åˆ™è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚</p><p>6ã€remove(Object key)ï¼š åˆ é™¤Mapé›†åˆä¸­é”®ä¸ºkeyçš„æ•°æ®å¹¶è¿”å›å…¶æ‰€å¯¹åº”valueå€¼ã€‚</p><p>7ã€values()ï¼š è¿”å›Mapé›†åˆä¸­æ‰€æœ‰valueç»„æˆçš„ä»¥Collectionæ•°æ®ç±»å‹æ ¼å¼æ•°æ®ã€‚</p><p>8ã€containsKey(Object key)ï¼š åˆ¤æ–­é›†åˆä¸­æ˜¯å¦åŒ…å«æŒ‡å®šé”®ï¼ŒåŒ…å«è¿”å› trueï¼Œå¦åˆ™è¿”å›falseã€‚</p><p>9ã€containsValue(Object value)ï¼š åˆ¤æ–­é›†åˆä¸­æ˜¯å¦åŒ…å«æŒ‡å®šå€¼ï¼ŒåŒ…å«è¿”å› trueï¼Œå¦åˆ™è¿”å›falseã€‚</p><p>10ã€keySet()ï¼š è¿”å›Mapé›†åˆä¸­æ‰€æœ‰keyç»„æˆçš„Seté›†åˆã€‚</p><p>11ã€entrySet()ï¼š å°†Mapé›†åˆæ¯ä¸ªkey-valueè½¬æ¢ä¸ºä¸€ä¸ªEntryå¯¹è±¡å¹¶è¿”å›ç”±æ‰€æœ‰çš„Entryå¯¹è±¡ç»„æˆçš„Seté›†åˆã€‚</p><blockquote><p>HashMap å¸¸ç”¨æ–¹æ³•æµ‹è¯•</p></blockquote><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs sas">package map;<br><br>import java.util.Collection;<br>import java.util.HashMap;<br>import java.util.<span class="hljs-keyword">Set</span>;<br><br>public class HashMapDemo &#123;<br><br>    public static void mai<span class="hljs-meta">n</span>(String[] args) &#123;<br>        HashMap&lt;String, String&gt; map = new HashMap&lt;String, String&gt;();<br>        // é”®ä¸èƒ½é‡å¤ï¼Œå€¼å¯ä»¥é‡å¤<br>        map.<span class="hljs-meta">put</span>(<span class="hljs-string">&quot;san&quot;</span>, <span class="hljs-string">&quot;å¼ ä¸‰&quot;</span>);<br>        map.<span class="hljs-meta">put</span>(<span class="hljs-string">&quot;si&quot;</span>, <span class="hljs-string">&quot;æå››&quot;</span>);<br>        map.<span class="hljs-meta">put</span>(<span class="hljs-string">&quot;wu&quot;</span>, <span class="hljs-string">&quot;ç‹äº”&quot;</span>);<br>        map.<span class="hljs-meta">put</span>(<span class="hljs-string">&quot;wang&quot;</span>, <span class="hljs-string">&quot;è€ç‹&quot;</span>);<br>        map.<span class="hljs-meta">put</span>(<span class="hljs-string">&quot;wang&quot;</span>, <span class="hljs-string">&quot;è€ç‹2&quot;</span>);// è€ç‹è¢«è¦†ç›–<br>        map.<span class="hljs-meta">put</span>(<span class="hljs-string">&quot;lao&quot;</span>, <span class="hljs-string">&quot;è€ç‹&quot;</span>);<br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;-------ç›´æ¥è¾“å‡ºhashmap:-------&quot;</span>);<br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(map);<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * éå†HashMap</span><br><span class="hljs-comment">         */</span><br>        // 1.è·å–Mapä¸­çš„æ‰€æœ‰é”®<br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;-------foreachè·å–Mapä¸­æ‰€æœ‰çš„é”®:------&quot;</span>);<br>        <span class="hljs-keyword">Set</span>&lt;String&gt; keys = map.keySet();<br>        for (String <span class="hljs-keyword">key</span> : keys) &#123;<br>            System.<span class="hljs-keyword">out</span>.pr<span class="hljs-meta">int</span>(<span class="hljs-keyword">key</span>+<span class="hljs-string">&quot;  &quot;</span>);<br>        &#125;<br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>();//æ¢è¡Œ<br>        // 2.è·å–Mapä¸­æ‰€æœ‰å€¼<br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;-------foreachè·å–Mapä¸­æ‰€æœ‰çš„å€¼:------&quot;</span>);<br>        Collection&lt;String&gt; values = map.values();<br>        for (String value : values) &#123;<br>            System.<span class="hljs-keyword">out</span>.pr<span class="hljs-meta">int</span>(value+<span class="hljs-string">&quot;  &quot;</span>);<br>        &#125;<br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>();//æ¢è¡Œ<br>        // 3.å¾—åˆ°<span class="hljs-keyword">key</span>çš„å€¼çš„åŒæ—¶å¾—åˆ°<span class="hljs-keyword">key</span>æ‰€å¯¹åº”çš„å€¼<br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;-------å¾—åˆ°keyçš„å€¼çš„åŒæ—¶å¾—åˆ°keyæ‰€å¯¹åº”çš„å€¼:-------&quot;</span>);<br>        <span class="hljs-keyword">Set</span>&lt;String&gt; keys2 = map.keySet();<br>        for (String <span class="hljs-keyword">key</span> : keys2) &#123;<br>            System.<span class="hljs-keyword">out</span>.pr<span class="hljs-meta">int</span>(<span class="hljs-keyword">key</span> + <span class="hljs-string">&quot;ï¼š&quot;</span> + map.get(<span class="hljs-keyword">key</span>)+<span class="hljs-string">&quot;   &quot;</span>);<br><br>        &#125;<br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * å¦‚æœæ—¢è¦éå†keyåˆè¦valueï¼Œé‚£ä¹ˆå»ºè®®è¿™ç§æ–¹å¼ï¼Œå› ä¸ºå¦‚æœå…ˆè·å–keySetç„¶åå†æ‰§è¡Œmap.get(key)ï¼Œmapå†…éƒ¨ä¼šæ‰§è¡Œä¸¤æ¬¡éå†ã€‚</span><br><span class="hljs-comment">         * ä¸€æ¬¡æ˜¯åœ¨è·å–keySetçš„æ—¶å€™ï¼Œä¸€æ¬¡æ˜¯åœ¨éå†æ‰€æœ‰keyçš„æ—¶å€™ã€‚</span><br><span class="hljs-comment">         */</span><br>        // å½“æˆ‘è°ƒç”¨<span class="hljs-meta">put</span>(<span class="hljs-keyword">key</span>,value)æ–¹æ³•çš„æ—¶å€™ï¼Œé¦–å…ˆä¼šæŠŠ<span class="hljs-keyword">key</span>å’Œvalueå°è£…åˆ°<br>        // Entryè¿™ä¸ªé™æ€å†…éƒ¨ç±»å¯¹è±¡ä¸­ï¼ŒæŠŠEntryå¯¹è±¡å†æ·»åŠ åˆ°æ•°ç»„ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬æƒ³è·å–<br>        // mapä¸­çš„æ‰€æœ‰é”®å€¼å¯¹ï¼Œæˆ‘ä»¬åªè¦è·å–æ•°ç»„ä¸­çš„æ‰€æœ‰Entryå¯¹è±¡ï¼Œæ¥ä¸‹æ¥<br>        // è°ƒç”¨Entryå¯¹è±¡ä¸­çš„getKey()å’ŒgetValue()æ–¹æ³•å°±èƒ½è·å–é”®å€¼å¯¹äº†<br>        <span class="hljs-keyword">Set</span>&lt;java.util.Map.Entry&lt;String, String&gt;&gt; entrys = map.entrySet();<br>        for (java.util.Map.Entry&lt;String, String&gt; entry : entrys) &#123;<br>            System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(entry.getKey() + <span class="hljs-string">&quot;--&quot;</span> + entry.getValue());<br>        &#125;<br><br>        <span class="hljs-comment">/**</span><br><span class="hljs-comment">         * HashMapå…¶ä»–å¸¸ç”¨æ–¹æ³•</span><br><span class="hljs-comment">         */</span><br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;after map.size()ï¼š&quot;</span>+map.size());<br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;after map.isEmpty()ï¼š&quot;</span>+map.isEmpty());<br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(map.<span class="hljs-keyword">remove</span>(<span class="hljs-string">&quot;san&quot;</span>));<br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;after map.remove()ï¼š&quot;</span>+map);<br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;after map.get(si)ï¼š&quot;</span>+map.get(<span class="hljs-string">&quot;si&quot;</span>));<br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;after map.containsKey(si)ï¼š&quot;</span>+map.containsKey(<span class="hljs-string">&quot;si&quot;</span>));<br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;after containsValue(æå››)ï¼š&quot;</span>+map.containsValue(<span class="hljs-string">&quot;æå››&quot;</span>));<br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(map.<span class="hljs-keyword">replace</span>(<span class="hljs-string">&quot;si&quot;</span>, <span class="hljs-string">&quot;æå››2&quot;</span>));<br>        System.<span class="hljs-keyword">out</span>.printl<span class="hljs-meta">n</span>(<span class="hljs-string">&quot;after map.replace(si, æå››2):&quot;</span>+map);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2ã€åº•å±‚æ•°æ®ç»“æ„"><a href="#2ã€åº•å±‚æ•°æ®ç»“æ„" class="headerlink" title="2ã€åº•å±‚æ•°æ®ç»“æ„"></a>2ã€åº•å±‚æ•°æ®ç»“æ„</h3><h4 id="JDK1-8-ä¹‹å‰"><a href="#JDK1-8-ä¹‹å‰" class="headerlink" title="JDK1.8 ä¹‹å‰"></a>JDK1.8 ä¹‹å‰</h4><p>JDK1.8 ä¹‹å‰ HashMap åº•å±‚æ˜¯ <strong>æ•°ç»„å’Œé“¾è¡¨</strong> ç»“åˆåœ¨ä¸€èµ·ä½¿ç”¨ï¼ˆ <strong>é“¾è¡¨æ•£åˆ—</strong>ï¼‰ã€‚</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231115224010.png" alt="image.png"></p><p>HashMap é€šè¿‡ key çš„ hashCode ç»è¿‡æ‰°åŠ¨å‡½æ•°å¤„ç†è¿‡åå¾—åˆ° hash å€¼ï¼Œç„¶åé€šè¿‡ <code>(n - 1) &amp; hash</code> åˆ¤æ–­å½“å‰å…ƒç´ å­˜æ”¾çš„ä½ç½®ï¼ˆè¿™é‡Œçš„ n æŒ‡çš„æ˜¯æ•°ç»„çš„é•¿åº¦ï¼‰ï¼Œå¦‚æœå½“å‰ä½ç½®å­˜åœ¨å…ƒç´ çš„è¯ï¼Œå°±åˆ¤æ–­è¯¥å…ƒç´ ä¸è¦å­˜å…¥çš„å…ƒç´ çš„ hash å€¼ä»¥åŠ key æ˜¯å¦ç›¸åŒï¼Œ<strong>å¦‚æœç›¸åŒçš„è¯ï¼Œç›´æ¥è¦†ç›–</strong>ï¼Œä¸ç›¸åŒå°±é€šè¿‡æ‹‰é“¾æ³•è§£å†³å†²çªã€‚</p><p>æ‰€è°“æ‰°åŠ¨å‡½æ•°æŒ‡çš„å°±æ˜¯ HashMap çš„ hash æ–¹æ³•ã€‚</p><p>ä½¿ç”¨ hash æ–¹æ³•ï¼ˆæ‰°åŠ¨å‡½æ•°ï¼‰æ˜¯ä¸ºäº†é˜²æ­¢ä¸€äº›å®ç°æ¯”è¾ƒå·®çš„ hashCode() æ–¹æ³• ï¼Œä½¿ç”¨æ‰°åŠ¨å‡½æ•°ä¹‹åå¯ä»¥å‡å°‘ç¢°æ’ã€‚</p><p>æ‰€è°“ <strong>â€œæ‹‰é“¾æ³•â€</strong> æ˜¯ï¼šå°†é“¾è¡¨å’Œæ•°ç»„ç›¸ç»“åˆã€‚ä¹Ÿå°±æ˜¯è¯´åˆ›å»ºä¸€ä¸ªé“¾è¡¨æ•°ç»„ï¼Œ<strong>æ•°ç»„ä¸­æ¯ä¸€æ ¼å°±æ˜¯ä¸€ä¸ªé“¾è¡¨</strong>ã€‚è‹¥é‡åˆ°å“ˆå¸Œå†²çªï¼Œåˆ™å°†å†²çªçš„å€¼åŠ åˆ°é“¾è¡¨ä¸­å³å¯ã€‚</p><p><strong>hash æ–¹æ³•</strong></p><p>JDK 1.8 HashMap çš„ hash æ–¹æ³•æºç :</p><p>JDK 1.8 çš„ hash æ–¹æ³• ç›¸æ¯”äº JDK 1.7 hash æ–¹æ³•æ›´åŠ ç®€åŒ–ï¼Œä½†æ˜¯åŸç†ä¸å˜</p><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs processing">  <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">hash</span>(<span class="hljs-built_in">Object</span> <span class="hljs-built_in">key</span>) &#123;<br>    <span class="hljs-type">int</span> h;<br>    <span class="hljs-comment">// key.hashCode()ï¼šè¿”å›æ•£åˆ—å€¼ä¹Ÿå°±æ˜¯hashcode</span><br>    <span class="hljs-comment">// ^ï¼šæŒ‰ä½å¼‚æˆ–</span><br>    <span class="hljs-comment">// &gt;&gt;&gt;:æ— ç¬¦å·å³ç§»ï¼Œå¿½ç•¥ç¬¦å·ä½ï¼Œç©ºä½éƒ½ä»¥0è¡¥é½</span><br>    <span class="hljs-title function_">return</span> (<span class="hljs-built_in">key</span> == <span class="hljs-literal">null</span>) ? <span class="hljs-number">0</span> : (h = <span class="hljs-built_in">key</span>.<span class="hljs-property">hashCode</span>()) ^ (h &gt;&gt;&gt; <span class="hljs-number">16</span>);<br>&#125;<br><br></code></pre></td></tr></table></figure><p> JDK1.7 çš„ HashMap çš„ hash æ–¹æ³•æºç .</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs arduino"><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">int</span> <span class="hljs-title">hash</span><span class="hljs-params">(<span class="hljs-type">int</span> h)</span> </span>&#123;<br>    <span class="hljs-comment">// This function ensures that hashCodes that differ only by</span><br>    <span class="hljs-comment">// constant multiples at each bit position have a bounded</span><br>    <span class="hljs-comment">// number of collisions (approximately 8 at default load factor).</span><br><br>    h ^= (h &gt;&gt;&gt; <span class="hljs-number">20</span>) ^ (h &gt;&gt;&gt; <span class="hljs-number">12</span>);<br>    <span class="hljs-keyword">return</span> h ^ (h &gt;&gt;&gt; <span class="hljs-number">7</span>) ^ (h &gt;&gt;&gt; <span class="hljs-number">4</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>ç›¸æ¯”äº JDK1.8 çš„ hash æ–¹æ³• ï¼ŒJDK 1.7 çš„ hash æ–¹æ³•çš„æ€§èƒ½ç¨å·®ä¸€ç‚¹ï¼Œå› ä¸ºæ¯•ç«Ÿæ‰°åŠ¨äº† 4 æ¬¡ã€‚</p><h4 id="JDK1-8-ä¹‹å"><a href="#JDK1-8-ä¹‹å" class="headerlink" title="JDK1.8 ä¹‹å"></a>JDK1.8 ä¹‹å</h4><p>å½“é“¾è¡¨é•¿åº¦å¤§äºé˜ˆå€¼ï¼ˆé»˜è®¤ä¸º 8ï¼‰æ—¶ï¼Œä¼šé¦–å…ˆè°ƒç”¨ <code>treeifyBin()</code>æ–¹æ³•ã€‚</p><p>è¿™ä¸ªæ–¹æ³•ä¼šæ ¹æ® HashMap æ•°ç»„æ¥å†³å®šæ˜¯å¦è½¬æ¢ä¸ºçº¢é»‘æ ‘ã€‚åªæœ‰å½“æ•°ç»„é•¿åº¦å¤§äºæˆ–è€…ç­‰äº 64 çš„æƒ…å†µä¸‹ï¼Œæ‰ä¼šæ‰§è¡Œè½¬æ¢çº¢é»‘æ ‘æ“ä½œï¼Œä»¥å‡å°‘æœç´¢æ—¶é—´ã€‚</p><p>å¦åˆ™ï¼Œå°±æ˜¯åªæ˜¯æ‰§è¡Œ <code>resize()</code> æ–¹æ³•å¯¹æ•°ç»„æ‰©å®¹ã€‚</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231115223309.png" alt="image.png"></p><h4 id="HashMap-çš„ç±»å±æ€§"><a href="#HashMap-çš„ç±»å±æ€§" class="headerlink" title="HashMap çš„ç±»å±æ€§"></a>HashMap çš„ç±»å±æ€§</h4><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-symbol">HashMap</span>&lt;<span class="hljs-symbol">K,<span class="hljs-symbol">V</span></span>&gt; <span class="hljs-symbol">extends</span> <span class="hljs-symbol">AbstractMap</span>&lt;<span class="hljs-symbol">K,<span class="hljs-symbol">V</span></span>&gt; <span class="hljs-symbol">implements</span> <span class="hljs-symbol">Map</span>&lt;<span class="hljs-symbol">K,<span class="hljs-symbol">V</span></span>&gt;, <span class="hljs-symbol">Cloneable, <span class="hljs-symbol">Serializable</span></span> &#123;<br>    <span class="hljs-comment">// åºåˆ—å·</span><br>    <span class="hljs-keyword">private</span> static <span class="hljs-keyword">final</span> long serialVersionUID = <span class="hljs-number">362498820763181265</span>L;<br>    <span class="hljs-comment">// é»˜è®¤çš„åˆå§‹å®¹é‡æ˜¯16</span><br>    static <span class="hljs-keyword">final</span> <span class="hljs-built_in">int</span> DEFAULT_INITIAL_CAPACITY = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">4</span>;<br>    <span class="hljs-comment">// æœ€å¤§å®¹é‡</span><br>    static <span class="hljs-keyword">final</span> <span class="hljs-built_in">int</span> MAXIMUM_CAPACITY = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">30</span>;<br>    <span class="hljs-comment">// é»˜è®¤çš„è´Ÿè½½å› å­</span><br>    static <span class="hljs-keyword">final</span> <span class="hljs-built_in">float</span> DEFAULT_LOAD_FACTOR = <span class="hljs-number">0.75f</span>;<br>    <span class="hljs-comment">// å½“æ¡¶(bucket)ä¸Šçš„ç»“ç‚¹æ•°å¤§äºç­‰äºè¿™ä¸ªå€¼æ—¶ä¼šè½¬æˆçº¢é»‘æ ‘</span><br>    static <span class="hljs-keyword">final</span> <span class="hljs-built_in">int</span> TREEIFY_THRESHOLD = <span class="hljs-number">8</span>;<br>    <span class="hljs-comment">// å½“æ¡¶(bucket)ä¸Šçš„ç»“ç‚¹æ•°å°äºç­‰äºè¿™ä¸ªå€¼æ—¶æ ‘è½¬é“¾è¡¨</span><br>    static <span class="hljs-keyword">final</span> <span class="hljs-built_in">int</span> UNTREEIFY_THRESHOLD = <span class="hljs-number">6</span>;<br>    <span class="hljs-comment">// æ¡¶ä¸­ç»“æ„è½¬åŒ–ä¸ºçº¢é»‘æ ‘å¯¹åº”çš„tableçš„æœ€å°å®¹é‡</span><br>    static <span class="hljs-keyword">final</span> <span class="hljs-built_in">int</span> MIN_TREEIFY_CAPACITY = <span class="hljs-number">64</span>;<br>    <span class="hljs-comment">// å­˜å‚¨å…ƒç´ çš„æ•°ç»„ï¼Œæ€»æ˜¯2çš„å¹‚æ¬¡å€</span><br>    transient Node&lt;k,v&gt;[] table;<br>    <span class="hljs-comment">// å­˜æ”¾å…·ä½“å…ƒç´ çš„é›†</span><br>    transient Set&lt;map.entry&lt;k,v&gt;&gt; entrySet;<br>    <span class="hljs-comment">// å­˜æ”¾å…ƒç´ çš„ä¸ªæ•°ï¼Œæ³¨æ„è¿™ä¸ªä¸ç­‰äºæ•°ç»„çš„é•¿åº¦ã€‚</span><br>    transient <span class="hljs-built_in">int</span> size;<br>    <span class="hljs-comment">// æ¯æ¬¡æ‰©å®¹å’Œæ›´æ”¹mapç»“æ„çš„è®¡æ•°å™¨</span><br>    transient <span class="hljs-built_in">int</span> modCount;<br>    <span class="hljs-comment">// é˜ˆå€¼(å®¹é‡*è´Ÿè½½å› å­) å½“å®é™…å¤§å°è¶…è¿‡é˜ˆå€¼æ—¶ï¼Œä¼šè¿›è¡Œæ‰©å®¹</span><br>    <span class="hljs-built_in">int</span> threshold;<br>    <span class="hljs-comment">// è´Ÿè½½å› å­</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-built_in">float</span> loadFactor;<br>&#125;<br></code></pre></td></tr></table></figure><p>å‡ ä¸ªé‡è¦çš„å­—æ®µ</p><ul><li>loadFactor   è´Ÿè½½å› å­</li><li>threshold   é˜ˆå€¼ï¼ˆHashMap å®é™…èƒ½å­˜å‚¨çš„å¤§å°ï¼‰</li><li>DEFAULT_INITIAL_CAPACITY  é»˜è®¤åˆå§‹å®¹é‡</li><li>MAXIMUM_CAPACITY  æœ€å¤§å®¹é‡</li><li>size   HashMapå®é™…å­˜å‚¨çš„å…ƒç´ ä¸ªæ•°</li><li>modCount     HashMapçš„ç»“æ„è¢«ä¿®æ”¹çš„æ¬¡æ•°ï¼Œç”¨äºè¿­ä»£å™¨</li></ul><blockquote><p>loadFactor è´Ÿè½½å› å­</p></blockquote><p>loadFactor è´Ÿè½½å› å­ æ˜¯æ§åˆ¶æ•°ç»„å­˜æ”¾æ•°æ®çš„ç–å¯†ç¨‹åº¦ï¼ŒloadFactor è¶Šè¶‹è¿‘äº 1ï¼Œé‚£ä¹ˆ æ•°ç»„ä¸­å­˜æ”¾çš„æ•°æ®(entry)ä¹Ÿå°±è¶Šå¤šï¼Œä¹Ÿå°±è¶Šå¯†ï¼Œä¹Ÿå°±æ˜¯ä¼šè®©é“¾è¡¨çš„é•¿åº¦å¢åŠ ï¼ŒloadFactor è¶Šå°ï¼Œä¹Ÿå°±æ˜¯è¶‹è¿‘äº 0ï¼Œæ•°ç»„ä¸­å­˜æ”¾çš„æ•°æ®(entry)ä¹Ÿå°±è¶Šå°‘ï¼Œä¹Ÿå°±è¶Šç¨€ç–ã€‚</p><p>loadFactor å¤ªå¤§å¯¼è‡´æŸ¥æ‰¾å…ƒç´ æ•ˆç‡ä½ï¼Œå¤ªå°å¯¼è‡´æ•°ç»„çš„åˆ©ç”¨ç‡ä½ï¼Œå­˜æ”¾çš„æ•°æ®ä¼šå¾ˆåˆ†æ•£ã€‚<strong>loadFactor çš„é»˜è®¤å€¼ä¸º 0.75f</strong> ï¼Œæ˜¯å®˜æ–¹ç»™å‡ºçš„ä¸€ä¸ªæ¯”è¾ƒå¥½çš„ä¸´ç•Œå€¼ã€‚</p><p>HashMap ç»™å®šçš„é»˜è®¤å®¹é‡ä¸º 16ï¼Œè´Ÿè½½å› å­ä¸º 0.75ã€‚<br>Map åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä¸æ–­çš„å¾€é‡Œé¢å­˜æ”¾æ•°æ®ï¼Œå½“æ•°é‡è¶…è¿‡äº† 16 * 0.75 &#x3D; 12 , å°±éœ€è¦å°†å½“å‰ 16 çš„å®¹é‡è¿›è¡Œæ‰©å®¹ï¼Œè€Œæ‰©å®¹è¿™ä¸ªè¿‡ç¨‹æ¶‰åŠåˆ° rehashã€å¤åˆ¶æ•°æ®ç­‰æ“ä½œï¼Œæ‰€ä»¥éå¸¸æ¶ˆè€—æ€§èƒ½ã€‚</p><blockquote><p>threshold   é˜ˆå€¼</p></blockquote><p><strong>threshold &#x3D; capacity * loadFactor</strong>ï¼Œé˜ˆå€¼(å®¹é‡ * è´Ÿè½½å› å­) </p><p>å½“å®é™…å¤§å°è¶…è¿‡é˜ˆå€¼æ—¶ï¼Œå°±è¦è€ƒè™‘å¯¹æ•°ç»„çš„æ‰©å¢ã€‚é˜ˆå€¼æ˜¯è¡¡é‡æ•°ç»„æ˜¯å¦éœ€è¦æ‰©å¢çš„ä¸€ä¸ªæ ‡å‡†ã€‚</p><h4 id="Node-èŠ‚ç‚¹ç±»æºç "><a href="#Node-èŠ‚ç‚¹ç±»æºç " class="headerlink" title="Node èŠ‚ç‚¹ç±»æºç "></a>Node èŠ‚ç‚¹ç±»æºç </h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">// ç»§æ‰¿è‡ª Map.Entry&lt;K,V&gt;</span><br>static <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span>&lt;<span class="hljs-type">K,V</span>&gt; <span class="hljs-title">implements</span> <span class="hljs-title">Map</span>.<span class="hljs-title">Entry</span>&lt;<span class="hljs-type">K,V</span>&gt; &#123;<br>       <span class="hljs-keyword">final</span> int hash;<span class="hljs-comment">// å“ˆå¸Œå€¼ï¼Œå­˜æ”¾å…ƒç´ åˆ°hashmapä¸­æ—¶ç”¨æ¥ä¸å…¶ä»–å…ƒç´ hashå€¼æ¯”è¾ƒ</span><br>       <span class="hljs-keyword">final</span> K key;<span class="hljs-comment">//é”®</span><br>       V value;<span class="hljs-comment">//å€¼</span><br>       <span class="hljs-comment">// æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span><br>       Node&lt;K,V&gt; next;<br>       <br>       Node(int hash, K key, V value, Node&lt;K,V&gt; next) &#123;<br>            <span class="hljs-keyword">this</span>.hash = hash;<br>            <span class="hljs-keyword">this</span>.key = key;<br>            <span class="hljs-keyword">this</span>.value = value;<br>            <span class="hljs-keyword">this</span>.next = next;<br>        &#125;<br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> K getKey()        &#123; <span class="hljs-keyword">return</span> key; &#125;<br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> V getValue()      &#123; <span class="hljs-keyword">return</span> value; &#125;<br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> String toString() &#123; <span class="hljs-keyword">return</span> key + <span class="hljs-string">&quot;=&quot;</span> + value; &#125;<br>        <span class="hljs-comment">// é‡å†™hashCode()æ–¹æ³•</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> int hashCode() &#123;<br>            <span class="hljs-keyword">return</span> Objects.hashCode(key) ^ Objects.hashCode(value);<br>        &#125;<br><br><span class="hljs-comment">//ç›¸å½“äºæŠŠåŸæ¥çš„å€¼ç»™è¦†ç›–æ‰ï¼Œä½†æ˜¯è¿”å›è¢«è¦†ç›–æ‰çš„å€¼</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> V setValue(V newValue) &#123;<br>            V oldValue = value;<br>            value = newValue;<br>            <span class="hljs-keyword">return</span> oldValue;<br>        &#125;<br>        <br>        <span class="hljs-comment">// é‡å†™ equals() æ–¹æ³•</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> boolean equals(Object o) &#123;<br>            <span class="hljs-keyword">if</span> (o == <span class="hljs-keyword">this</span>)<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            <span class="hljs-keyword">if</span> (o instanceof Map.Entry) &#123;<br>                Map.Entry&lt;?,?&gt; e = (Map.Entry&lt;?,?&gt;)o;<br>                <span class="hljs-keyword">if</span> (Objects.equals(key, e.getKey()) &amp;&amp;<br>                    Objects.equals(value, e.getValue()))<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            &#125;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="æ ‘èŠ‚ç‚¹ç±»æºç "><a href="#æ ‘èŠ‚ç‚¹ç±»æºç " class="headerlink" title="æ ‘èŠ‚ç‚¹ç±»æºç "></a>æ ‘èŠ‚ç‚¹ç±»æºç </h4><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs scala">static <span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TreeNode&lt;K</span>,<span class="hljs-title">V&gt;</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">LinkedHashMap</span>.<span class="hljs-title">Entry&lt;K</span>,<span class="hljs-title">V&gt;</span> </span>&#123;<br>        <span class="hljs-type">TreeNode</span>&lt;<span class="hljs-type">K</span>,<span class="hljs-type">V</span>&gt; parent;  <span class="hljs-comment">// çˆ¶</span><br>        <span class="hljs-type">TreeNode</span>&lt;<span class="hljs-type">K</span>,<span class="hljs-type">V</span>&gt; left;    <span class="hljs-comment">// å·¦</span><br>        <span class="hljs-type">TreeNode</span>&lt;<span class="hljs-type">K</span>,<span class="hljs-type">V</span>&gt; right;   <span class="hljs-comment">// å³</span><br>        <span class="hljs-type">TreeNode</span>&lt;<span class="hljs-type">K</span>,<span class="hljs-type">V</span>&gt; prev;    <span class="hljs-comment">// needed to unlink next upon deletion</span><br>        boolean red;           <span class="hljs-comment">// åˆ¤æ–­é¢œè‰²</span><br>        <span class="hljs-type">TreeNode</span>(int hash, <span class="hljs-type">K</span> key, <span class="hljs-type">V</span> <span class="hljs-keyword">val</span>, <span class="hljs-type">Node</span>&lt;<span class="hljs-type">K</span>,<span class="hljs-type">V</span>&gt; next) &#123;<br>            <span class="hljs-keyword">super</span>(hash, key, <span class="hljs-keyword">val</span>, next);<br>        &#125;<br>        <br>        <span class="hljs-comment">// è¿”å›æ ¹èŠ‚ç‚¹</span><br>        <span class="hljs-keyword">final</span> <span class="hljs-type">TreeNode</span>&lt;<span class="hljs-type">K</span>,<span class="hljs-type">V</span>&gt; root() &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">TreeNode</span>&lt;<span class="hljs-type">K</span>,<span class="hljs-type">V</span>&gt; r = <span class="hljs-keyword">this</span>, p;;) &#123;<br>                <span class="hljs-keyword">if</span> ((p = r.parent) == <span class="hljs-literal">null</span>)<br>                    <span class="hljs-keyword">return</span> r;<br>                r = p;<br>       &#125;<br><br></code></pre></td></tr></table></figure><h3 id="3ã€HashMap-æºç åˆ†æ"><a href="#3ã€HashMap-æºç åˆ†æ" class="headerlink" title="3ã€HashMap æºç åˆ†æ"></a>3ã€HashMap æºç åˆ†æ</h3><h4 id="æ„é€ æ–¹æ³•"><a href="#æ„é€ æ–¹æ³•" class="headerlink" title="æ„é€ æ–¹æ³•"></a>æ„é€ æ–¹æ³•</h4><p>HashMap ä¸­æœ‰å››ä¸ªæ„é€ æ–¹æ³•ï¼Œå®ƒä»¬åˆ†åˆ«å¦‚ä¸‹ï¼š</p><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs aspectj">   <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">float</span> DEFAULT_LOAD_FACTOR = <span class="hljs-number">0.75</span>f;<br><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> MAXIMUM_CAPACITY = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">30</span>;<br><br><span class="hljs-keyword">int</span> threshold;<br>   <br>   <span class="hljs-comment">// é»˜è®¤æ„é€ å‡½æ•°ã€‚</span><br>   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">HashMap</span><span class="hljs-params">()</span> </span>&#123;<br>       <span class="hljs-keyword">this</span>.loadFactor = DEFAULT_LOAD_FACTOR; <span class="hljs-comment">// all   other fields defaulted</span><br>    &#125;<br><br>    <span class="hljs-comment">// åŒ…å«å¦ä¸€ä¸ªâ€œMapâ€çš„æ„é€ å‡½æ•°</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">HashMap</span><span class="hljs-params">(Map&lt;? <span class="hljs-keyword">extends</span> K, ? <span class="hljs-keyword">extends</span> V&gt; m)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>.loadFactor = DEFAULT_LOAD_FACTOR;<br>        putMapEntries(m, <span class="hljs-keyword">false</span>);<span class="hljs-comment">//ä¸‹é¢ä¼šåˆ†æ</span><br>    &#125;<br><br>    <span class="hljs-comment">// æŒ‡å®šâ€œå®¹é‡å¤§å°â€çš„æ„é€ å‡½æ•°</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">HashMap</span><span class="hljs-params">(<span class="hljs-keyword">int</span> initialCapacity)</span> </span>&#123;<br>        <span class="hljs-keyword">this</span>(initialCapacity, DEFAULT_LOAD_FACTOR);<br>    &#125;<br><br>    <span class="hljs-comment">// æŒ‡å®šâ€œå®¹é‡å¤§å°â€å’Œâ€œè´Ÿè½½å› å­â€çš„æ„é€ å‡½æ•°</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">HashMap</span><span class="hljs-params">(<span class="hljs-keyword">int</span> initialCapacity, <span class="hljs-keyword">float</span> loadFactor)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (initialCapacity &lt; <span class="hljs-number">0</span>)<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(<span class="hljs-string">&quot;Illegal initial capacity: &quot;</span> + initialCapacity);<br>        <span class="hljs-keyword">if</span> (initialCapacity &gt; MAXIMUM_CAPACITY)<br>            initialCapacity = MAXIMUM_CAPACITY;<br>        <span class="hljs-keyword">if</span> (loadFactor &lt;= <span class="hljs-number">0</span> || Float.isNaN(loadFactor))<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(<span class="hljs-string">&quot;Illegal load factor: &quot;</span> + loadFactor);<br>        <span class="hljs-comment">//æŒ‡å®šè´Ÿè½½å› å­</span><br>        <span class="hljs-keyword">this</span>.loadFactor = loadFactor;<br>        <span class="hljs-comment">// åˆå§‹å®¹é‡æš‚æ—¶å­˜æ”¾åˆ° threshold ï¼Œåœ¨ resize ä¸­å†èµ‹å€¼ç»™ newCap è¿›è¡Œtableåˆå§‹åŒ–</span><br>        <span class="hljs-keyword">this</span>.threshold = tableSizeFor(initialCapacity);<br>    &#125;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢ç¬¬äºŒä¸ªæ„é€ å‡½æ•°ä¸­è°ƒç”¨äº† putMapEntries æ–¹æ³•ï¼Œä¸‹é¢è¿›è¡Œåˆ†æï¼š</p><p><strong>putMapEntries æ–¹æ³•</strong></p><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs aspectj"><span class="hljs-keyword">transient</span> Node&lt;K,V&gt;[] table;<br><br><span class="hljs-keyword">final</span> <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">putMapEntries</span><span class="hljs-params">(Map&lt;? <span class="hljs-keyword">extends</span> K, ? <span class="hljs-keyword">extends</span> V&gt; m, <span class="hljs-keyword">boolean</span> evict)</span> </span>&#123;  <br>    <span class="hljs-keyword">int</span> s = m.size();  <br>    <span class="hljs-keyword">if</span> (s &gt; <span class="hljs-number">0</span>) &#123;  <br>        <span class="hljs-comment">// åˆ¤æ–­tableæ˜¯å¦å·²ç»åˆå§‹åŒ–</span><br>        <span class="hljs-keyword">if</span> (table == <span class="hljs-keyword">null</span>) &#123; <span class="hljs-comment">// pre-size  </span><br>            <span class="hljs-comment">//å¦‚æœæœªåˆå§‹åŒ–ï¼Œs ä¸º m çš„å®é™…å…ƒç´ ä¸ªæ•°ï¼›ft=s/loadFactor =&gt; s=ft*loadFactorï¼›å…¶ä¸­ ft æŒ‡çš„æ˜¯è¦æ·»åŠ  s ä¸ªå…ƒç´ æ‰€éœ€è¦çš„æœ€å°çš„å®¹é‡</span><br>            <span class="hljs-keyword">float</span> ft = ((<span class="hljs-keyword">float</span>)s / loadFactor) + <span class="hljs-number">1.0</span>F;  <br>            <span class="hljs-comment">//ä¸æœ€å¤§å®¹é‡ä½œæ¯”è¾ƒï¼Œå¦‚æœå°äºåˆ™ t ä¸º ftï¼Œå¦åˆ™ä¸º MAXIMUM_CAPACITY</span><br>            <span class="hljs-keyword">int</span> t = ((ft &lt; (<span class="hljs-keyword">float</span>)MAXIMUM_CAPACITY) ?  <br>                     (<span class="hljs-keyword">int</span>)ft : MAXIMUM_CAPACITY);  <br>            <span class="hljs-comment">//æ ¹æ®ä¸Šé¢çš„æ„é€ å‡½æ•°ï¼Œå¯ä»¥å¾—çŸ¥æ­¤æ—¶ table æœªåˆå§‹åŒ–ï¼Œthreshold å®é™…ä¸Šæ˜¯å­˜æ”¾çš„åˆå§‹åŒ–å®¹é‡</span><br>            <span class="hljs-comment">//å¦‚æœæ·»åŠ sä¸ªå…ƒç´ æ‰€éœ€çš„æœ€å°å®¹é‡å¤§äºåˆå§‹åŒ–å®¹é‡ï¼Œåˆ™å°†æœ€å°å®¹é‡æ‰©å®¹ä¸ºæœ€æ¥è¿‘çš„2çš„å¹‚æ¬¡æ–¹å¤§å°ä½œä¸ºåˆå§‹åŒ–ã€‚ï¼ˆæ³¨æ„è¿™é‡Œä¸æ˜¯åˆå§‹åŒ–é˜ˆå€¼ï¼‰</span><br>            <span class="hljs-keyword">if</span> (t &gt; threshold)  <br>                threshold = tableSizeFor(t);  <br>        &#125;  <br>        <span class="hljs-comment">// å¦‚æœå·²ç»åˆå§‹åŒ–ï¼Œå¹¶ä¸”må…ƒç´ ä¸ªæ•°å¤§äºé˜ˆå€¼ï¼Œè¿›è¡Œæ‰©å®¹å¤„ç†</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (s &gt; threshold)  <br>            resize();  <br>        <span class="hljs-comment">// å°†mä¸­çš„æ‰€æœ‰å…ƒç´ æ·»åŠ è‡³HashMapä¸­ï¼Œå¦‚æœtableæœªåˆå§‹åŒ–ï¼ŒputValä¸­ä¼šè°ƒç”¨resizeåˆå§‹åŒ–æˆ–æ‰©å®¹    </span><br>        <span class="hljs-keyword">for</span> (Map.Entry&lt;? <span class="hljs-keyword">extends</span> K, ? <span class="hljs-keyword">extends</span> V&gt; e : m.entrySet()) &#123;  <br>            K key = e.getKey();  <br>            V value = e.getValue();  <br>            putVal(hash(key), key, value, <span class="hljs-keyword">false</span>, evict);  <br>        &#125;  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p>tableSizeFor æ–¹æ³•ï¼šè¿”å›ä¸€ä¸ªæœ€æ¥è¿‘ cap çš„2çš„å¹‚æ¬¡æ–¹å¤§å°æ•°å€¼</p><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs excel">static final <span class="hljs-built_in">int</span> tableSizeFor(<span class="hljs-built_in">int</span> cap) &#123;  <br>    <span class="hljs-built_in">int</span> <span class="hljs-built_in">n</span> = cap - <span class="hljs-number">1</span>;  <br>    <span class="hljs-built_in">n</span> |= <span class="hljs-built_in">n</span> &gt;&gt;&gt; <span class="hljs-number">1</span>;  <br>    <span class="hljs-built_in">n</span> |= <span class="hljs-built_in">n</span> &gt;&gt;&gt; <span class="hljs-number">2</span>;  <br>    <span class="hljs-built_in">n</span> |= <span class="hljs-built_in">n</span> &gt;&gt;&gt; <span class="hljs-number">4</span>;  <br>    <span class="hljs-built_in">n</span> |= <span class="hljs-built_in">n</span> &gt;&gt;&gt; <span class="hljs-number">8</span>;  <br>    <span class="hljs-built_in">n</span> |= <span class="hljs-built_in">n</span> &gt;&gt;&gt; <span class="hljs-number">16</span>;  <br>    return (<span class="hljs-built_in">n</span> &lt; <span class="hljs-number">0</span>) ? <span class="hljs-number">1</span> <span class="hljs-symbol">:</span> (<span class="hljs-built_in">n</span> &gt;= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY <span class="hljs-symbol">:</span> <span class="hljs-built_in">n</span> + <span class="hljs-number">1</span>;  <br>&#125;<br></code></pre></td></tr></table></figure><h4 id="put-æ–¹æ³•"><a href="#put-æ–¹æ³•" class="headerlink" title="put æ–¹æ³•"></a>put æ–¹æ³•</h4><p>HashMap åªæä¾›äº† put ç”¨äºæ·»åŠ å…ƒç´ ï¼ŒputVal æ–¹æ³•æ˜¯ put æ–¹æ³•è°ƒç”¨çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¹¶æ²¡æœ‰æä¾›ç»™ç”¨æˆ·ä½¿ç”¨ã€‚</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs maxima">public V <span class="hljs-built_in">put</span>(K <span class="hljs-built_in">key</span>, V value) &#123;<br>    <span class="hljs-built_in">return</span> putVal(hash(<span class="hljs-built_in">key</span>), <span class="hljs-built_in">key</span>, value, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>putVal æ–¹æ³• å›¾è§£</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/20231115230931.png" alt="image.png"></p><p>putVal æ–¹æ³•æ·»åŠ å…ƒç´ åˆ†æï¼š</p><ul><li>å¦‚æœå®šä½åˆ°çš„æ•°ç»„ä½ç½®æ²¡æœ‰å…ƒç´  å°±ç›´æ¥æ’å…¥ã€‚</li><li>å¦‚æœå®šä½åˆ°çš„æ•°ç»„ä½ç½®æœ‰å…ƒç´ å°±å’Œè¦æ’å…¥çš„ key æ¯”è¾ƒï¼Œ<ul><li>å¦‚æœ key ç›¸åŒå°±ç›´æ¥è¦†ç›–ï¼Œ</li><li>å¦‚æœ key ä¸ç›¸åŒï¼Œå°±åˆ¤æ–­ p æ˜¯å¦æ˜¯ä¸€ä¸ªæ ‘èŠ‚ç‚¹ï¼Œ<ul><li>å¦‚æœæ˜¯å°±è°ƒç”¨<code>e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value)</code>å°†å…ƒç´ æ·»åŠ è¿›å…¥ã€‚</li><li>å¦‚æœä¸æ˜¯å°±éå†é“¾è¡¨æ’å…¥(æ’å…¥çš„æ˜¯é“¾è¡¨å°¾éƒ¨)ã€‚</li></ul></li></ul></li></ul><blockquote><p>putVal æ–¹æ³•</p></blockquote><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs arcade">final V putVal(int <span class="hljs-built_in">hash</span>, K key, V value, <span class="hljs-built_in">boolean</span> onlyIfAbsent,<br>                   <span class="hljs-built_in">boolean</span> evict) &#123;<br>    Node&lt;K,V&gt;[] <span class="hljs-literal">tab</span>; Node&lt;K,V&gt; p; int n, i;<br>    <span class="hljs-comment">// tableæœªåˆå§‹åŒ–æˆ–è€…é•¿åº¦ä¸º0ï¼Œè¿›è¡Œæ‰©å®¹</span><br>    <span class="hljs-keyword">if</span> ((<span class="hljs-literal">tab</span> = table) == <span class="hljs-literal">null</span> || (n = <span class="hljs-literal">tab</span>.<span class="hljs-built_in">length</span>) == <span class="hljs-number">0</span>)<br>        n = (<span class="hljs-literal">tab</span> = <span class="hljs-built_in">resize</span>()).<span class="hljs-built_in">length</span>;<br>    <span class="hljs-comment">// (n - 1) &amp; hash ç¡®å®šå…ƒç´ å­˜æ”¾åœ¨å“ªä¸ªæ¡¶ä¸­ï¼Œæ¡¶ä¸ºç©ºï¼Œæ–°ç”Ÿæˆç»“ç‚¹æ”¾å…¥æ¡¶ä¸­(æ­¤æ—¶ï¼Œè¿™ä¸ªç»“ç‚¹æ˜¯æ”¾åœ¨æ•°ç»„ä¸­)</span><br>    <span class="hljs-keyword">if</span> ((p = <span class="hljs-literal">tab</span>[i = (n - <span class="hljs-number">1</span>) &amp; <span class="hljs-built_in">hash</span>]) == <span class="hljs-literal">null</span>)<br>        <span class="hljs-literal">tab</span>[i] = newNode(<span class="hljs-built_in">hash</span>, key, value, <span class="hljs-literal">null</span>);<br>    <span class="hljs-comment">// æ¡¶ä¸­å·²ç»å­˜åœ¨å…ƒç´ ï¼ˆå¤„ç†hashå†²çªï¼‰</span><br>    <span class="hljs-keyword">else</span> &#123;<br>        Node&lt;K,V&gt; e; K k;<br>        <span class="hljs-comment">//å¿«é€Ÿåˆ¤æ–­ç¬¬ä¸€ä¸ªèŠ‚ç‚¹table[i]çš„keyæ˜¯å¦ä¸æ’å…¥çš„keyä¸€æ ·ï¼Œè‹¥ç›¸åŒå°±ç›´æ¥ä½¿ç”¨æ’å…¥çš„å€¼pæ›¿æ¢æ‰æ—§çš„å€¼eã€‚</span><br>        <span class="hljs-keyword">if</span> (p.<span class="hljs-built_in">hash</span> == <span class="hljs-built_in">hash</span> &amp;&amp;<br>            ((k = p.key) == key || (key != <span class="hljs-literal">null</span> &amp;&amp; key.<span class="hljs-built_in">equals</span>(k))))<br>                e = p;<br>        <span class="hljs-comment">// åˆ¤æ–­æ’å…¥çš„æ˜¯å¦æ˜¯çº¢é»‘æ ‘èŠ‚ç‚¹</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (p instanceof TreeNode)<br>            <span class="hljs-comment">// æ”¾å…¥æ ‘ä¸­</span><br>            e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, <span class="hljs-literal">tab</span>, <span class="hljs-built_in">hash</span>, key, value);<br>        <span class="hljs-comment">// ä¸æ˜¯çº¢é»‘æ ‘èŠ‚ç‚¹åˆ™è¯´æ˜ä¸ºé“¾è¡¨ç»“ç‚¹</span><br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// åœ¨é“¾è¡¨æœ€æœ«æ’å…¥ç»“ç‚¹</span><br>            <span class="hljs-keyword">for</span> (int binCount = <span class="hljs-number">0</span>; ; ++binCount) &#123;<br>                <span class="hljs-comment">// åˆ°è¾¾é“¾è¡¨çš„å°¾éƒ¨</span><br>                <span class="hljs-keyword">if</span> ((e = p.next) == <span class="hljs-literal">null</span>) &#123;<br>                    <span class="hljs-comment">// åœ¨å°¾éƒ¨æ’å…¥æ–°ç»“ç‚¹</span><br>                    p.next = newNode(<span class="hljs-built_in">hash</span>, key, value, <span class="hljs-literal">null</span>);<br>                    <span class="hljs-comment">// ç»“ç‚¹æ•°é‡è¾¾åˆ°é˜ˆå€¼(é»˜è®¤ä¸º 8 )ï¼Œæ‰§è¡Œ treeifyBin æ–¹æ³•</span><br>                    <span class="hljs-comment">// è¿™ä¸ªæ–¹æ³•ä¼šæ ¹æ® HashMap æ•°ç»„æ¥å†³å®šæ˜¯å¦è½¬æ¢ä¸ºçº¢é»‘æ ‘ã€‚</span><br>                    <span class="hljs-comment">// åªæœ‰å½“æ•°ç»„é•¿åº¦å¤§äºæˆ–è€…ç­‰äº 64 çš„æƒ…å†µä¸‹ï¼Œæ‰ä¼šæ‰§è¡Œè½¬æ¢çº¢é»‘æ ‘æ“ä½œï¼Œä»¥å‡å°‘æœç´¢æ—¶é—´ã€‚å¦åˆ™ï¼Œå°±æ˜¯åªæ˜¯å¯¹æ•°ç»„æ‰©å®¹ã€‚</span><br>                    <span class="hljs-keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class="hljs-number">1</span>) <span class="hljs-comment">// -1 for 1st</span><br>                        treeifyBin(<span class="hljs-literal">tab</span>, <span class="hljs-built_in">hash</span>);<br>                    <span class="hljs-comment">// è·³å‡ºå¾ªç¯</span><br>                    <span class="hljs-keyword">break</span>;<br>                &#125;<br>                <span class="hljs-comment">// åˆ¤æ–­é“¾è¡¨ä¸­ç»“ç‚¹çš„keyå€¼ä¸æ’å…¥çš„å…ƒç´ çš„keyå€¼æ˜¯å¦ç›¸ç­‰</span><br>                <span class="hljs-keyword">if</span> (e.<span class="hljs-built_in">hash</span> == <span class="hljs-built_in">hash</span> &amp;&amp;<br>                    ((k = e.key) == key || (key != <span class="hljs-literal">null</span> &amp;&amp; key.<span class="hljs-built_in">equals</span>(k))))<br>                    <span class="hljs-comment">// ç›¸ç­‰ï¼Œè·³å‡ºå¾ªç¯</span><br>                    <span class="hljs-keyword">break</span>;<br>                <span class="hljs-comment">// ç”¨äºéå†æ¡¶ä¸­çš„é“¾è¡¨ï¼Œä¸å‰é¢çš„e = p.nextç»„åˆï¼Œå¯ä»¥éå†é“¾è¡¨</span><br>                p = e;<br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">// è¡¨ç¤ºåœ¨æ¡¶ä¸­æ‰¾åˆ°keyå€¼ã€hashå€¼ä¸æ’å…¥å…ƒç´ ç›¸ç­‰çš„ç»“ç‚¹</span><br>        <span class="hljs-keyword">if</span> (e != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-comment">// è®°å½•eçš„value</span><br>            V oldValue = e.value;<br>            <span class="hljs-comment">// onlyIfAbsentä¸ºfalseæˆ–è€…æ—§å€¼ä¸ºnull</span><br>            <span class="hljs-keyword">if</span> (!onlyIfAbsent || oldValue == <span class="hljs-literal">null</span>)<br>                <span class="hljs-comment">//ç”¨æ–°å€¼æ›¿æ¢æ—§å€¼</span><br>                e.value = value;<br>            <span class="hljs-comment">// è®¿é—®åå›è°ƒ</span><br>            afterNodeAccess(e);<br>            <span class="hljs-comment">// è¿”å›æ—§å€¼</span><br>            <span class="hljs-keyword">return</span> oldValue;<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">// ç»“æ„æ€§ä¿®æ”¹</span><br>    ++modCount;<br>    <span class="hljs-comment">// å®é™…å¤§å°å¤§äºé˜ˆå€¼åˆ™æ‰©å®¹</span><br>    <span class="hljs-keyword">if</span> (++size &gt; threshold)<br>        <span class="hljs-built_in">resize</span>();<br>    <span class="hljs-comment">// æ’å…¥åå›è°ƒ</span><br>    afterNodeInsertion(evict);<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p><strong>å¯¹æ¯” JDK1.7 put æ–¹æ³•çš„ä»£ç </strong></p></blockquote><p><strong>å¯¹äº put æ–¹æ³•çš„åˆ†æå¦‚ä¸‹ï¼š</strong></p><ul><li>â‘  å¦‚æœå®šä½åˆ°çš„æ•°ç»„ä½ç½®æ²¡æœ‰å…ƒç´  å°±ç›´æ¥æ’å…¥ã€‚</li><li>â‘¡ å¦‚æœå®šä½åˆ°çš„æ•°ç»„ä½ç½®æœ‰å…ƒç´ ï¼Œéå†ä»¥è¿™ä¸ªå…ƒç´ ä¸ºå¤´ç»“ç‚¹çš„é“¾è¡¨ï¼Œä¾æ¬¡å’Œæ’å…¥çš„ key æ¯”è¾ƒï¼Œå¦‚æœ key ç›¸åŒå°±ç›´æ¥è¦†ç›–ï¼Œä¸åŒå°±é‡‡ç”¨å¤´æ’æ³•æ’å…¥å…ƒç´ ã€‚</li></ul><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs processing"><span class="hljs-keyword">public</span> V <span class="hljs-title function_">put</span>(K <span class="hljs-built_in">key</span>, V value)<br>    <span class="hljs-keyword">if</span> (table == EMPTY_TABLE) &#123;<br>    <span class="hljs-title function_">inflateTable</span>(threshold);<br>&#125;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">key</span> == <span class="hljs-literal">null</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">putForNullKey</span>(value);<br>    <span class="hljs-type">int</span> hash = <span class="hljs-title function_">hash</span>(<span class="hljs-built_in">key</span>);<br>    <span class="hljs-type">int</span> i = <span class="hljs-title function_">indexFor</span>(hash, table.<span class="hljs-property">length</span>);<br>    <span class="hljs-keyword">for</span> (Entry&lt;K,V&gt; e = table[i]; e != <span class="hljs-literal">null</span>; e = e.<span class="hljs-property">next</span>) &#123; <span class="hljs-comment">// å…ˆéå†</span><br>        <span class="hljs-built_in">Object</span> k;<br>        <span class="hljs-keyword">if</span> (e.<span class="hljs-property">hash</span> == hash &amp;&amp; ((k = e.<span class="hljs-property">key</span>) == <span class="hljs-built_in">key</span> || <span class="hljs-built_in">key</span>.<span class="hljs-property">equals</span>(k))) &#123;<br>            V oldValue = e.<span class="hljs-property">value</span>;<br>            e.<span class="hljs-property">value</span> = value;<br>            e.<span class="hljs-property">recordAccess</span>(<span class="hljs-variable">this</span>);<br>            <span class="hljs-keyword">return</span> oldValue;<br>        &#125;<br>    &#125;<br><br>    modCount++;<br>    <span class="hljs-title function_">addEntry</span>(hash, <span class="hljs-built_in">key</span>, value, i);  <span class="hljs-comment">// å†æ’å…¥</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="get-æ–¹æ³•"><a href="#get-æ–¹æ³•" class="headerlink" title="get æ–¹æ³•"></a>get æ–¹æ³•</h4><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs arcade">public V get(Object key) &#123;<br>    Node&lt;K,V&gt; e;<br>    <span class="hljs-keyword">return</span> (e = getNode(<span class="hljs-built_in">hash</span>(key), key)) == <span class="hljs-literal">null</span> ? <span class="hljs-literal">null</span> : e.value;<br>&#125;<br><br>final Node&lt;K,V&gt; getNode(int <span class="hljs-built_in">hash</span>, Object key) &#123;<br>    Node&lt;K,V&gt;[] <span class="hljs-literal">tab</span>; Node&lt;K,V&gt; <span class="hljs-built_in">first</span>, e; int n; K k;<br>    <span class="hljs-keyword">if</span> ((<span class="hljs-literal">tab</span> = table) != <span class="hljs-literal">null</span> &amp;&amp; (n = <span class="hljs-literal">tab</span>.<span class="hljs-built_in">length</span>) &gt; <span class="hljs-number">0</span> &amp;&amp;<br>        (<span class="hljs-built_in">first</span> = <span class="hljs-literal">tab</span>[(n - <span class="hljs-number">1</span>) &amp; <span class="hljs-built_in">hash</span>]) != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-comment">// æ•°ç»„å…ƒç´ ç›¸ç­‰</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">first</span>.<span class="hljs-built_in">hash</span> == <span class="hljs-built_in">hash</span> &amp;&amp; <span class="hljs-comment">// always check first node</span><br>            ((k = <span class="hljs-built_in">first</span>.key) == key || (key != <span class="hljs-literal">null</span> &amp;&amp; key.<span class="hljs-built_in">equals</span>(k))))<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">first</span>;<br>        <span class="hljs-comment">// æ¡¶ä¸­ä¸æ­¢ä¸€ä¸ªèŠ‚ç‚¹</span><br>        <span class="hljs-keyword">if</span> ((e = <span class="hljs-built_in">first</span>.next) != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-comment">// åœ¨æ ‘ä¸­get</span><br>            <span class="hljs-keyword">if</span> (<span class="hljs-built_in">first</span> instanceof TreeNode)<br>                <span class="hljs-keyword">return</span> ((TreeNode&lt;K,V&gt;)<span class="hljs-built_in">first</span>).getTreeNode(<span class="hljs-built_in">hash</span>, key);<br>            <span class="hljs-comment">// åœ¨é“¾è¡¨ä¸­get</span><br>            <span class="hljs-keyword">do</span> &#123;<br>                <span class="hljs-keyword">if</span> (e.<span class="hljs-built_in">hash</span> == <span class="hljs-built_in">hash</span> &amp;&amp;<br>                    ((k = e.key) == key || (key != <span class="hljs-literal">null</span> &amp;&amp; key.<span class="hljs-built_in">equals</span>(k))))<br>                    <span class="hljs-keyword">return</span> e;<br>            &#125; <span class="hljs-keyword">while</span> ((e = e.next) != <span class="hljs-literal">null</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="resize-æ–¹æ³•"><a href="#resize-æ–¹æ³•" class="headerlink" title="resize æ–¹æ³•"></a>resize æ–¹æ³•</h4><p>è¿›è¡Œæ‰©å®¹ï¼Œä¼šä¼´éšç€ä¸€æ¬¡é‡æ–° hash åˆ†é…ï¼Œå¹¶ä¸”ä¼šéå† hash è¡¨ä¸­æ‰€æœ‰çš„å…ƒç´ ï¼Œæ˜¯éå¸¸è€—æ—¶çš„ã€‚åœ¨ç¼–å†™ç¨‹åºä¸­ï¼Œè¦å°½é‡é¿å… resizeã€‚</p><p>resize æ–¹æ³•å®é™…ä¸Šæ˜¯å°† table åˆå§‹åŒ–å’Œ table æ‰©å®¹ è¿›è¡Œäº†æ•´åˆï¼Œåº•å±‚çš„è¡Œä¸ºéƒ½æ˜¯ç»™ table èµ‹å€¼ä¸€ä¸ªæ–°çš„æ•°ç»„ã€‚</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><code class="hljs haxe"><span class="hljs-keyword">final</span> Node&lt;K,V&gt;[] resize() &#123;<br>    Node&lt;K,V&gt;[] oldTab = table;<br>    int oldCap = (oldTab == <span class="hljs-literal">null</span>) ? <span class="hljs-number">0</span> : <span class="hljs-type">oldTab</span>.length;<br>    int oldThr = threshold;<br>    int <span class="hljs-keyword">new</span><span class="hljs-type">Cap</span>, <span class="hljs-keyword">new</span><span class="hljs-type">Thr</span> = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">if</span> (oldCap &gt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-comment">// è¶…è¿‡æœ€å¤§å€¼å°±ä¸å†æ‰©å……äº†ï¼Œå°±åªå¥½éšä½ ç¢°æ’å»å§</span><br>        <span class="hljs-keyword">if</span> (oldCap &gt;= MAXIMUM_CAPACITY) &#123;<br>            threshold = Integer.MAX_VALUE;<br>            <span class="hljs-keyword">return</span> oldTab;<br>        &#125;<br>        <span class="hljs-comment">// æ²¡è¶…è¿‡æœ€å¤§å€¼ï¼Œå°±æ‰©å……ä¸ºåŸæ¥çš„2å€</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((<span class="hljs-keyword">new</span><span class="hljs-type">Cap</span> = oldCap &lt;&lt; <span class="hljs-number">1</span>) &lt; MAXIMUM_CAPACITY &amp;&amp; oldCap &gt;= DEFAULT_INITIAL_CAPACITY)<br>            <span class="hljs-keyword">new</span><span class="hljs-type">Thr</span> = oldThr &lt;&lt; <span class="hljs-number">1</span>; <span class="hljs-comment">// double threshold</span><br>    &#125;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (oldThr &gt; <span class="hljs-number">0</span>) <span class="hljs-comment">// initial capacity was placed in threshold</span><br>        <span class="hljs-comment">// åˆ›å»ºå¯¹è±¡æ—¶åˆå§‹åŒ–å®¹é‡å¤§å°æ”¾åœ¨thresholdä¸­ï¼Œæ­¤æ—¶åªéœ€è¦å°†å…¶ä½œä¸ºæ–°çš„æ•°ç»„å®¹é‡</span><br>        <span class="hljs-keyword">new</span><span class="hljs-type">Cap</span> = oldThr;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// signifies using defaults æ— å‚æ„é€ å‡½æ•°åˆ›å»ºçš„å¯¹è±¡åœ¨è¿™é‡Œè®¡ç®—å®¹é‡å’Œé˜ˆå€¼</span><br>        <span class="hljs-keyword">new</span><span class="hljs-type">Cap</span> = DEFAULT_INITIAL_CAPACITY;<br>        <span class="hljs-keyword">new</span><span class="hljs-type">Thr</span> = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);<br>    &#125;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">new</span><span class="hljs-type">Thr</span> == <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-comment">// åˆ›å»ºæ—¶æŒ‡å®šäº†åˆå§‹åŒ–å®¹é‡æˆ–è€…è´Ÿè½½å› å­ï¼Œåœ¨è¿™é‡Œè¿›è¡Œé˜ˆå€¼åˆå§‹åŒ–ï¼Œ</span><br>    <span class="hljs-comment">// æˆ–è€…æ‰©å®¹å‰çš„æ—§å®¹é‡å°äº16ï¼Œåœ¨è¿™é‡Œè®¡ç®—æ–°çš„resizeä¸Šé™</span><br>        float ft = (float)<span class="hljs-keyword">new</span><span class="hljs-type">Cap</span> * loadFactor;<br>        <span class="hljs-keyword">new</span><span class="hljs-type">Thr</span> = (<span class="hljs-keyword">new</span><span class="hljs-type">Cap</span> &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (float)MAXIMUM_CAPACITY ? (int)ft : <span class="hljs-type">Integer</span>.MAX_VALUE);<br>    &#125;<br>    threshold = <span class="hljs-keyword">new</span><span class="hljs-type">Thr</span>;<br>    <span class="hljs-meta">@SuppressWarnings</span>(&#123;<span class="hljs-string">&quot;rawtypes&quot;</span>,<span class="hljs-string">&quot;unchecked&quot;</span>&#125;)<br>        Node&lt;K,V&gt;[] <span class="hljs-keyword">new</span><span class="hljs-type">Tab</span> = (Node&lt;K,V&gt;[])<span class="hljs-keyword">new</span> <span class="hljs-type">Node</span>[<span class="hljs-keyword">new</span><span class="hljs-type">Cap</span>];<br>    table = <span class="hljs-keyword">new</span><span class="hljs-type">Tab</span>;<br>    <span class="hljs-keyword">if</span> (oldTab != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-comment">// æŠŠæ¯ä¸ªbucketéƒ½ç§»åŠ¨åˆ°æ–°çš„bucketsä¸­</span><br>        <span class="hljs-keyword">for</span> (int j = <span class="hljs-number">0</span>; j &lt; oldCap; ++j) &#123;<br>            Node&lt;K,V&gt; e;<br>            <span class="hljs-keyword">if</span> ((e = oldTab[j]) != <span class="hljs-literal">null</span>) &#123;<br>                oldTab[j] = <span class="hljs-literal">null</span>;<br>                <span class="hljs-keyword">if</span> (e.next == <span class="hljs-literal">null</span>)<br>                    <span class="hljs-comment">// åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç›´æ¥è®¡ç®—å…ƒç´ æ–°çš„ä½ç½®å³å¯</span><br>                    <span class="hljs-keyword">new</span><span class="hljs-type">Tab</span>[e.hash &amp; (<span class="hljs-keyword">new</span><span class="hljs-type">Cap</span> - <span class="hljs-number">1</span>)] = e;<br>                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (e instanceof TreeNode)<br>                    <span class="hljs-comment">// å°†çº¢é»‘æ ‘æ‹†åˆ†æˆ2æ£µå­æ ‘ï¼Œå¦‚æœå­æ ‘èŠ‚ç‚¹æ•°å°äºç­‰äº UNTREEIFY_THRESHOLDï¼ˆé»˜è®¤ä¸º 6ï¼‰ï¼Œåˆ™å°†å­æ ‘è½¬æ¢ä¸ºé“¾è¡¨ã€‚</span><br>                    <span class="hljs-comment">// å¦‚æœå­æ ‘èŠ‚ç‚¹æ•°å¤§äº UNTREEIFY_THRESHOLDï¼Œåˆ™ä¿æŒå­æ ‘çš„æ ‘ç»“æ„ã€‚</span><br>                    ((TreeNode&lt;K,V&gt;)e).split(<span class="hljs-built_in">this</span>, <span class="hljs-keyword">new</span><span class="hljs-type">Tab</span>, j, oldCap);<br>                <span class="hljs-keyword">else</span> &#123;<br>                    Node&lt;K,V&gt; loHead = <span class="hljs-literal">null</span>, loTail = <span class="hljs-literal">null</span>;<br>                    Node&lt;K,V&gt; hiHead = <span class="hljs-literal">null</span>, hiTail = <span class="hljs-literal">null</span>;<br>                    Node&lt;K,V&gt; next;<br>                    <span class="hljs-keyword">do</span> &#123;<br>                        next = e.next;<br>                        <span class="hljs-comment">// åŸç´¢å¼•</span><br>                        <span class="hljs-keyword">if</span> ((e.hash &amp; oldCap) == <span class="hljs-number">0</span>) &#123;<br>                            <span class="hljs-keyword">if</span> (loTail == <span class="hljs-literal">null</span>)<br>                                loHead = e;<br>                            <span class="hljs-keyword">else</span><br>                                loTail.next = e;<br>                            loTail = e;<br>                        &#125;<br>                        <span class="hljs-comment">// åŸç´¢å¼•+oldCap</span><br>                        <span class="hljs-keyword">else</span> &#123;<br>                            <span class="hljs-keyword">if</span> (hiTail == <span class="hljs-literal">null</span>)<br>                                hiHead = e;<br>                            <span class="hljs-keyword">else</span><br>                                hiTail.next = e;<br>                            hiTail = e;<br>                        &#125;<br>                    &#125; <span class="hljs-keyword">while</span> ((e = next) != <span class="hljs-literal">null</span>);<br>                    <span class="hljs-comment">// åŸç´¢å¼•æ”¾åˆ°bucketé‡Œ</span><br>                    <span class="hljs-keyword">if</span> (loTail != <span class="hljs-literal">null</span>) &#123;<br>                        loTail.next = <span class="hljs-literal">null</span>;<br>                        <span class="hljs-keyword">new</span><span class="hljs-type">Tab</span>[j] = loHead;<br>                    &#125;<br>                    <span class="hljs-comment">// åŸç´¢å¼•+oldCapæ”¾åˆ°bucketé‡Œ</span><br>                    <span class="hljs-keyword">if</span> (hiTail != <span class="hljs-literal">null</span>) &#123;<br>                        hiTail.next = <span class="hljs-literal">null</span>;<br>                        <span class="hljs-keyword">new</span><span class="hljs-type">Tab</span>[j + oldCap] = hiHead;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span><span class="hljs-type">Tab</span>;<br>&#125;<br></code></pre></td></tr></table></figure><hr><p>å‚è€ƒï¼š</p><ul><li><a href="https://javaguide.cn/java/collection/hashmap-source-code.html">https://javaguide.cn/java/collection/hashmap-source-code.html</a></li><li><a href="https://blog.csdn.net/xiao_a_ruo_ya/article/details/98882507">https://blog.csdn.net/xiao_a_ruo_ya/article/details/98882507</a></li><li><a href="https://blog.csdn.net/rain67/article/details/124043769">https://blog.csdn.net/rain67/article/details/124043769</a></li><li><a href="https://segmentfault.com/a/1190000039302830">https://segmentfault.com/a/1190000039302830</a></li><li><a href="https://blog.csdn.net/weixin_47257050/article/details/118926555">https://blog.csdn.net/weixin_47257050/article/details/118926555</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
      <category>é›†åˆ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>é›†åˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaå­¦ä¹ çš„è½»æ¾ä¹‹æ—…</title>
    <link href="/2023/11/15/Java%E5%AD%A6%E4%B9%A0%E7%9A%84%E8%BD%BB%E6%9D%BE%E4%B9%8B%E6%97%85/"/>
    <url>/2023/11/15/Java%E5%AD%A6%E4%B9%A0%E7%9A%84%E8%BD%BB%E6%9D%BE%E4%B9%8B%E6%97%85/</url>
    
    <content type="html"><![CDATA[<p>é¢è¯•é¢˜</p><ul><li><a href="/2023/12/30/%E9%9D%A2%E8%AF%95%E9%A2%98_Java%E5%9F%BA%E7%A1%80/" title="é¢è¯•é¢˜_JavaåŸºç¡€">é¢è¯•é¢˜_JavaåŸºç¡€</a></li><li><a href="/2023/12/30/%E9%9D%A2%E8%AF%95%E9%A2%98_Java%E9%9B%86%E5%90%88/" title="é¢è¯•é¢˜_Javaé›†åˆ">é¢è¯•é¢˜_Javaé›†åˆ</a></li><li><a href="/2024/01/02/%E9%9D%A2%E8%AF%95%E9%A2%98_Java%E5%B9%B6%E5%8F%91/" title="é¢è¯•é¢˜_Javaå¹¶å‘">é¢è¯•é¢˜_Javaå¹¶å‘</a></li><li><a href="/2024/01/02/%E9%9D%A2%E8%AF%95%E9%A2%98_JVM/" title="é¢è¯•é¢˜_JVM">é¢è¯•é¢˜_JVM</a></li><li><a href="/2024/01/02/%E9%9D%A2%E8%AF%95%E9%A2%98_MySQL/" title="é¢è¯•é¢˜_MySQL">é¢è¯•é¢˜_MySQL</a></li><li><a href="/2024/01/02/%E9%9D%A2%E8%AF%95%E9%A2%98_Redis/" title="é¢è¯•é¢˜_Redis">é¢è¯•é¢˜_Redis</a></li></ul><h3 id="JavaåŸºç¡€"><a href="#JavaåŸºç¡€" class="headerlink" title="JavaåŸºç¡€"></a>JavaåŸºç¡€</h3><p>Java åŸºç¡€</p><p><strong>Java é›†åˆ</strong></p><ul><li><a href="/2023/11/14/Java%E9%9B%86%E5%90%88_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/" title="Java é›†åˆ_åŸºç¡€æ¦‚å¿µ">Java é›†åˆ_åŸºç¡€æ¦‚å¿µ</a></li><li><a href="/2023/11/14/Java%E9%9B%86%E5%90%88_%E8%BF%9B%E9%98%B6%E5%86%85%E5%AE%B9/" title="Java é›†åˆ_è¿›é˜¶å†…å®¹">Java é›†åˆ_è¿›é˜¶å†…å®¹</a></li><li><a href="/2023/11/14/Java%E9%9B%86%E5%90%88_%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/" title="Javaé›†åˆ_ç›¸å…³é—®é¢˜">Javaé›†åˆ_ç›¸å…³é—®é¢˜</a></li><li><a href="/2023/11/14/Java%E9%9B%86%E5%90%88_ArrayList%E5%AD%A6%E4%B9%A0/" title="Javaé›†åˆ_ArrayList å­¦ä¹ ">Javaé›†åˆ_ArrayList å­¦ä¹ </a></li><li><a href="/2023/11/15/Java%E9%9B%86%E5%90%88_HashMap%E5%AD%A6%E4%B9%A0/" title="Javaé›†åˆ_HashMapå­¦ä¹ ">Javaé›†åˆ_HashMapå­¦ä¹ </a></li></ul><p> <strong>Javaå¤šçº¿ç¨‹</strong></p><ul><li><a href="/2023/11/15/Java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/" title="Javaå¹¶å‘ç¼–ç¨‹_åŸºç¡€æ¦‚å¿µ">Javaå¹¶å‘ç¼–ç¨‹_åŸºç¡€æ¦‚å¿µ</a></li><li><a href="/2023/12/08/Java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B_%E8%BF%9B%E9%98%B6%E5%86%85%E5%AE%B9/" title="Javaå¹¶å‘ç¼–ç¨‹_è¿›é˜¶å†…å®¹">Javaå¹¶å‘ç¼–ç¨‹_è¿›é˜¶å†…å®¹</a></li><li><a href="/2023/12/19/Java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B_%E7%BA%BF%E7%A8%8B%E6%B1%A0/" title="Javaå¹¶å‘ç¼–ç¨‹_çº¿ç¨‹æ± ">Javaå¹¶å‘ç¼–ç¨‹_çº¿ç¨‹æ± </a></li><li><a href="/2023/12/21/Java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B_%E7%BA%BF%E7%A8%8B%E6%B1%A0%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/" title="Javaå¹¶å‘ç¼–ç¨‹_çº¿ç¨‹æ± æœ€ä½³å®è·µ">Javaå¹¶å‘ç¼–ç¨‹_çº¿ç¨‹æ± æœ€ä½³å®è·µ</a></li><li><a href="/2023/12/21/Java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B_%E4%BB%8EJava%E6%9E%84%E5%BB%BA%E7%BA%BF%E7%A8%8B%E7%9A%84%E6%96%B9%E5%BC%8F%E5%88%B0%E7%BA%BF%E7%A8%8B%E6%B1%A0ThreadPoolExecutor%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90/" title="ä»Javaæ„å»ºçº¿ç¨‹çš„æ–¹å¼åˆ°çº¿ç¨‹æ± ThreadPoolExecutoræºç å‰–æ">ä»Javaæ„å»ºçº¿ç¨‹çš„æ–¹å¼åˆ°çº¿ç¨‹æ± ThreadPoolExecutoræºç å‰–æ</a></li></ul><p><strong>Java 8</strong> </p><ul><li><a href="/2023/12/20/Java8%E6%96%B0%E7%89%B9%E6%80%A7/" title="Java8æ–°ç‰¹æ€§">Java8æ–°ç‰¹æ€§</a></li></ul><h3 id="JVM"><a href="#JVM" class="headerlink" title="JVM"></a>JVM</h3><ul><li><a href="/2023/11/16/JVM%E5%85%A5%E9%97%A8_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/" title="JVMå…¥é—¨_åŸºç¡€æ¦‚å¿µ">JVMå…¥é—¨_åŸºç¡€æ¦‚å¿µ</a></li></ul><h3 id="æ•°æ®åº“"><a href="#æ•°æ®åº“" class="headerlink" title="æ•°æ®åº“"></a>æ•°æ®åº“</h3><p>æ•°æ®åº“åŸºç¡€</p><ul><li><a href="/2023/12/24/%E6%95%B0%E6%8D%AE%E5%BA%93_%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" title="æ•°æ®åº“_åŸºç¡€çŸ¥è¯†">æ•°æ®åº“_åŸºç¡€çŸ¥è¯†</a></li><li><a href="/2023/12/24/%E6%95%B0%E6%8D%AE%E5%BA%93_SQL%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" title="æ•°æ®åº“_SQLè¯­æ³•åŸºç¡€çŸ¥è¯†">æ•°æ®åº“_SQLè¯­æ³•åŸºç¡€çŸ¥è¯†</a></li><li><a href="/2023/12/24/%E6%95%B0%E6%8D%AE%E5%BA%93_SQL%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98/" title="æ•°æ®åº“_SQLå¸¸è§é¢è¯•é¢˜">æ•°æ®åº“_SQLå¸¸è§é¢è¯•é¢˜</a></li></ul><p>MySQL</p><ul><li><a href="/2023/12/22/MySQL%E5%AD%A6%E4%B9%A0_%E5%9F%BA%E7%A1%80%E5%86%85%E5%AE%B901/" title="MySQLå­¦ä¹ _åŸºç¡€å†…å®¹01">MySQLå­¦ä¹ _åŸºç¡€å†…å®¹01</a></li><li><a href="/2023/12/22/MySQL%E5%AD%A6%E4%B9%A0_%E5%9F%BA%E7%A1%80%E5%86%85%E5%AE%B902/" title="MySQLå­¦ä¹ _åŸºç¡€å†…å®¹02">MySQLå­¦ä¹ _åŸºç¡€å†…å®¹02</a></li><li><a href="/2023/12/24/MySQL%E5%AD%A6%E4%B9%A0_%E5%9F%BA%E7%A1%80%E5%86%85%E5%AE%B903/" title="MySQLå­¦ä¹ _åŸºç¡€å†…å®¹03">MySQLå­¦ä¹ _åŸºç¡€å†…å®¹03</a></li><li><a href="/2023/12/15/MySQL%E5%AD%A6%E4%B9%A0_%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" title="MySQLå­¦ä¹ _æ€§èƒ½ä¼˜åŒ–">MySQLå­¦ä¹ _æ€§èƒ½ä¼˜åŒ–</a></li></ul><p>NOSQL</p><ul><li><a href="/2023/11/19/NoSQL_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/" title="NoSQL_åŸºç¡€æ¦‚å¿µ">NoSQL_åŸºç¡€æ¦‚å¿µ</a></li></ul><h3 id="å¸¸ç”¨æ¡†æ¶"><a href="#å¸¸ç”¨æ¡†æ¶" class="headerlink" title="å¸¸ç”¨æ¡†æ¶"></a>å¸¸ç”¨æ¡†æ¶</h3><p>Spring</p><ul><li><a href="/2023/11/27/Spring%E5%AD%A6%E4%B9%A0_%E5%9F%BA%E7%A1%80%E5%86%85%E5%AE%B9/" title="Springå­¦ä¹ _åŸºç¡€å†…å®¹">Springå­¦ä¹ _åŸºç¡€å†…å®¹</a></li><li><a href="/2023/12/14/Spring%E5%AD%A6%E4%B9%A0_IOC/" title="Springå­¦ä¹ _IOC">Springå­¦ä¹ _IOC</a></li><li><a href="/2023/12/14/Spring%E5%AD%A6%E4%B9%A0_Spring_Bean%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F/" title="Springå­¦ä¹ _Spring_Beançš„ä½œç”¨åŸŸ">Springå­¦ä¹ _Spring_Beançš„ä½œç”¨åŸŸ</a></li><li><a href="/2023/12/18/Spring%E5%AD%A6%E4%B9%A0_Spring_Bean%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/" title="Springå­¦ä¹ _Spring_Beançš„ç”Ÿå‘½å‘¨æœŸ">Springå­¦ä¹ _Spring_Beançš„ç”Ÿå‘½å‘¨æœŸ</a></li><li><a href="/2023/12/05/Spring%E5%AD%A6%E4%B9%A0_AOP/" title="Springå­¦ä¹ _AOP">Springå­¦ä¹ _AOP</a></li></ul><p>SpringMVC</p><ul><li><a href="/2023/12/05/Spring%E5%AD%A6%E4%B9%A0_SpringMVC/" title="Springå­¦ä¹ _SpringMVC">Springå­¦ä¹ _SpringMVC</a></li></ul><p>Mybatis</p><p>MybatisPlus</p><ul><li><a href="/2023/12/25/%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A0_MyBatis-Plus%E4%BD%BF%E7%94%A8/" title="æ¡†æ¶å­¦ä¹ _MyBatis-Plusä½¿ç”¨">æ¡†æ¶å­¦ä¹ _MyBatis-Plusä½¿ç”¨</a></li></ul><p>SpringSecurity</p><p>SpringBoot</p><ul><li><a href="/2023/12/19/SpringBoot%E5%AD%A6%E4%B9%A0_SpringBoot%E8%87%AA%E5%8A%A8%E8%A3%85%E9%85%8D%E5%8E%9F%E7%90%86/" title="SpringBootå­¦ä¹ _SpringBoot è‡ªåŠ¨è£…é…åŸç†">SpringBootå­¦ä¹ _SpringBoot è‡ªåŠ¨è£…é…åŸç†</a></li></ul><h3 id="ä¸­é—´ä»¶"><a href="#ä¸­é—´ä»¶" class="headerlink" title="ä¸­é—´ä»¶"></a>ä¸­é—´ä»¶</h3><p><strong>Redis</strong></p><ul><li><a href="/2023/12/08/Redis%E5%85%A5%E9%97%A8_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/" title="Rediså…¥é—¨_åŸºç¡€æ¦‚å¿µ">Rediså…¥é—¨_åŸºç¡€æ¦‚å¿µ</a></li><li><a href="/2023/12/21/Redis%E5%85%A5%E9%97%A8_%E8%BF%9B%E9%98%B6%E5%86%85%E5%AE%B9/" title="Rediså…¥é—¨_è¿›é˜¶å†…å®¹">Rediså…¥é—¨_è¿›é˜¶å†…å®¹</a></li><li><a href="/2023/12/25/Redis%E5%85%A5%E9%97%A8_%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98/" title="Rediså…¥é—¨_å¸¸è§é¢è¯•é¢˜">Rediså…¥é—¨_å¸¸è§é¢è¯•é¢˜</a></li><li><a href="/2023/12/25/Redis%E5%85%A5%E9%97%A8_Redis%E5%AE%9E%E6%88%98%E7%AF%87/" title="Rediså…¥é—¨_Rediså®æˆ˜ç¯‡">Rediså…¥é—¨_Rediså®æˆ˜ç¯‡</a></li></ul><p><strong>MQ</strong></p><ul><li><a href="/2023/12/11/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/" title="æ¶ˆæ¯é˜Ÿåˆ—_åŸºç¡€æ¦‚å¿µ">æ¶ˆæ¯é˜Ÿåˆ—_åŸºç¡€æ¦‚å¿µ</a></li></ul><p>RabbitMQ</p><ul><li><a href="/2023/12/28/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97_RabbitMQ_%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/" title="æ¶ˆæ¯é˜Ÿåˆ—_RabbitMQ_åŸºç¡€ä½¿ç”¨">æ¶ˆæ¯é˜Ÿåˆ—_RabbitMQ_åŸºç¡€ä½¿ç”¨</a></li><li><a href="/2023/12/03/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97_RabbitMQ%E7%9A%84%E5%AE%89%E8%A3%85/" title="RabbitMQçš„å®‰è£…ä¸ä½¿ç”¨">RabbitMQçš„å®‰è£…ä¸ä½¿ç”¨</a></li></ul><p>RocketMQ</p><ul><li><a href="/2023/12/28/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97_RocketMQ_%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/" title="æ¶ˆæ¯é˜Ÿåˆ—_RocketMQ_åŸºç¡€ä½¿ç”¨">æ¶ˆæ¯é˜Ÿåˆ—_RocketMQ_åŸºç¡€ä½¿ç”¨</a></li><li><a href="/2023/12/21/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97_RocketMQ_%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/" title="æ¶ˆæ¯é˜Ÿåˆ—_RocketMQ_å®‰è£…ä¸ä½¿ç”¨">æ¶ˆæ¯é˜Ÿåˆ—_RocketMQ_å®‰è£…ä¸ä½¿ç”¨</a></li></ul><p>Kafka</p><ul><li><a href="/2023/12/30/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97_Kafka_%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/" title="æ¶ˆæ¯é˜Ÿåˆ—_Kafka_åŸºç¡€ä½¿ç”¨">æ¶ˆæ¯é˜Ÿåˆ—_Kafka_åŸºç¡€ä½¿ç”¨</a></li></ul><p>Elasticsearch</p><ul><li><a href="/2023/11/26/Elasticsearch_%E5%9F%BA%E7%A1%80%E5%86%85%E5%AE%B9/" title="Elasticsearch_åŸºç¡€å†…å®¹">Elasticsearch_åŸºç¡€å†…å®¹</a></li></ul><p>MongoDB</p><ul><li><a href="/2023/11/30/MongoDB_%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/" title="MongoDB_åŸºæœ¬æ“ä½œ">MongoDB_åŸºæœ¬æ“ä½œ</a></li></ul><h3 id="SpringCloud"><a href="#SpringCloud" class="headerlink" title="SpringCloud"></a>SpringCloud</h3><ul><li><a href="/2023/11/22/SpringCloud_%E7%BB%84%E4%BB%B6%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/" title="SpringCloud_ç»„ä»¶åŸºæœ¬ä½¿ç”¨_åŸºç¡€æ¦‚å¿µ">SpringCloud_ç»„ä»¶åŸºæœ¬ä½¿ç”¨_åŸºç¡€æ¦‚å¿µ</a></li><li><a href="/2023/11/22/SpringCloud_%E7%BB%84%E4%BB%B6%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8_Eureka/" title="SpringCloud_ç»„ä»¶åŸºæœ¬ä½¿ç”¨_Eureka">SpringCloud_ç»„ä»¶åŸºæœ¬ä½¿ç”¨_Eureka</a></li><li><a href="/2023/11/24/SpringCloud_%E7%BB%84%E4%BB%B6%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8_Nacos/" title="SpringCloud_ç»„ä»¶åŸºæœ¬ä½¿ç”¨_Nacos">SpringCloud_ç»„ä»¶åŸºæœ¬ä½¿ç”¨_Nacos</a></li><li><a href="/2023/12/04/SpringCloud_%E7%BB%84%E4%BB%B6%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8_OpenFeign/" title="SpringCloud_ç»„ä»¶åŸºæœ¬ä½¿ç”¨_OpenFeign">SpringCloud_ç»„ä»¶åŸºæœ¬ä½¿ç”¨_OpenFeign</a></li><li><a href="/2023/12/04/SpringCloud_%E7%BB%84%E4%BB%B6%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8_Gateway/" title="SpringCloud_ç»„ä»¶åŸºæœ¬ä½¿ç”¨_Gateway">SpringCloud_ç»„ä»¶åŸºæœ¬ä½¿ç”¨_Gateway</a></li><li><a href="/2023/12/04/SpringCloud_%E7%BB%84%E4%BB%B6%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8_Seata/" title="SpringCloud_ç»„ä»¶åŸºæœ¬ä½¿ç”¨_Seata">SpringCloud_ç»„ä»¶åŸºæœ¬ä½¿ç”¨_Seata</a></li><li><a href="/2023/12/04/SpringCloud_%E7%BB%84%E4%BB%B6%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8_Stream/" title="SpringCloud_ç»„ä»¶åŸºæœ¬ä½¿ç”¨_Stream">SpringCloud_ç»„ä»¶åŸºæœ¬ä½¿ç”¨_Stream</a></li><li><a href="/2023/12/04/SpringCloud_%E7%BB%84%E4%BB%B6%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8_Sentinel/" title="SpringCloud_ç»„ä»¶åŸºæœ¬ä½¿ç”¨_Sentinel">SpringCloud_ç»„ä»¶åŸºæœ¬ä½¿ç”¨_Sentinel</a></li><li><a href="/2023/12/01/SpringCloud_%E7%BB%84%E4%BB%B6%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8_Sleuth+Zipkin/" title="SpringCloud_ç»„ä»¶åŸºæœ¬ä½¿ç”¨_Zipkin">SpringCloud_ç»„ä»¶åŸºæœ¬ä½¿ç”¨_Zipkin</a></li></ul><h3 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h3><ul><li><a href="/2023/11/17/Docker%E5%85%A5%E9%97%A8_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/" title="Dokcerå…¥é—¨_åŸºç¡€æ¦‚å¿µ">Dokcerå…¥é—¨_åŸºç¡€æ¦‚å¿µ</a></li><li><a href="/2024/01/12/Docker%E5%85%A5%E9%97%A8_Docker%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/" title="Dockerå…¥é—¨_Dockerçš„åŸºæœ¬ä½¿ç”¨">Dockerå…¥é—¨_Dockerçš„åŸºæœ¬ä½¿ç”¨</a></li></ul><h3 id="å‰ç«¯å­¦ä¹ "><a href="#å‰ç«¯å­¦ä¹ " class="headerlink" title="å‰ç«¯å­¦ä¹ "></a>å‰ç«¯å­¦ä¹ </h3><p>Vue</p><ul><li><a href="/2023/11/26/Vue%E5%AD%A6%E4%B9%A0_%E5%9F%BA%E7%A1%80%E5%86%85%E5%AE%B9/" title="Vueå­¦ä¹ _åŸºç¡€å†…å®¹">Vueå­¦ä¹ _åŸºç¡€å†…å®¹</a></li></ul><p>Node</p><ul><li><a href="/2023/11/17/node%E5%AE%89%E8%A3%85%E5%92%8C%E4%B8%8B%E8%BD%BD/" title="nodeå®‰è£…å’Œä¸‹è½½">nodeå®‰è£…å’Œä¸‹è½½</a></li></ul><p>Nginx</p><ul><li><a href="/2023/11/20/Nginx_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/" title="Nginx_åŸºç¡€æ¦‚å¿µ">Nginx_åŸºç¡€æ¦‚å¿µ</a></li></ul><h3 id="é¡¹ç›®å­¦ä¹ "><a href="#é¡¹ç›®å­¦ä¹ " class="headerlink" title="é¡¹ç›®å­¦ä¹ "></a>é¡¹ç›®å­¦ä¹ </h3><p>ä½¿ç”¨å·¥å…·</p><ul><li><a href="/2023/11/26/%E4%B8%AA%E4%BA%BA%E5%9C%A8%E7%BA%BF%E7%BD%91%E7%9B%98_ZFile/" title="ä¸ªäººåœ¨çº¿ç½‘ç›˜_ZFile">ä¸ªäººåœ¨çº¿ç½‘ç›˜_ZFile</a></li><li><a href="/2023/12/01/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E5%B7%A5%E5%85%B7Neutrino-Proxy/" title="å†…ç½‘ç©¿é€å·¥å…·Neutrino-Proxy">å†…ç½‘ç©¿é€å·¥å…·Neutrino-Proxy</a></li></ul><p>è˜‘è‡åšå®¢</p><ul><li><a href="/2023/11/23/%E8%98%91%E8%8F%87%E5%8D%9A%E5%AE%A2%E9%A1%B9%E7%9B%AE_Day01/" title="è˜‘è‡åšå®¢é¡¹ç›®_Day01">è˜‘è‡åšå®¢é¡¹ç›®_Day01</a></li><li><a href="/2023/12/11/%E8%98%91%E8%8F%87%E5%8D%9A%E5%AE%A2%E9%A1%B9%E7%9B%AE_Day02/" title="è˜‘è‡åšå®¢é¡¹ç›®_Day02">è˜‘è‡åšå®¢é¡¹ç›®_Day02</a></li><li><a href="/2023/12/12/%E8%98%91%E8%8F%87%E5%8D%9A%E5%AE%A2%E9%A1%B9%E7%9B%AE_Day03/" title="è˜‘è‡åšå®¢é¡¹ç›®_Day03">è˜‘è‡åšå®¢é¡¹ç›®_Day03</a></li><li><a href="/2023/12/13/%E8%98%91%E8%8F%87%E5%8D%9A%E5%AE%A2%E9%A1%B9%E7%9B%AE_Day04/" title="è˜‘è‡åšå®¢é¡¹ç›®_Day04">è˜‘è‡åšå®¢é¡¹ç›®_Day04</a></li></ul><h3 id="æŠ€æœ¯é€‰å‹"><a href="#æŠ€æœ¯é€‰å‹" class="headerlink" title="æŠ€æœ¯é€‰å‹"></a>æŠ€æœ¯é€‰å‹</h3><ul><li><a href="/2023/12/11/%E4%B8%9A%E5%8A%A1%E5%9C%BA%E6%99%AF%E5%92%8C%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B/" title="ä¸šåŠ¡åœºæ™¯å’ŒæŠ€æœ¯é€‰å‹">ä¸šåŠ¡åœºæ™¯å’ŒæŠ€æœ¯é€‰å‹</a></li></ul><h3 id="è¿ç»´å·¥å…·å’Œé¡¹ç›®æ„å»º"><a href="#è¿ç»´å·¥å…·å’Œé¡¹ç›®æ„å»º" class="headerlink" title="è¿ç»´å·¥å…·å’Œé¡¹ç›®æ„å»º"></a>è¿ç»´å·¥å…·å’Œé¡¹ç›®æ„å»º</h3><p>Maven</p><ul><li><a href="/2023/11/24/Maven%E5%B7%A5%E5%85%B7_%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/" title="Mavenå·¥å…·_åŸºç¡€ä½¿ç”¨">Mavenå·¥å…·_åŸºç¡€ä½¿ç”¨</a></li></ul><p>Linux</p><ul><li><a href="/2023/12/03/linux%E7%B3%BB%E7%BB%9F%E4%B8%8BJava%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E7%9A%84%E9%85%8D%E7%BD%AE/" title="linuxç³»ç»Ÿä¸‹ javaç¯å¢ƒå˜é‡çš„é…ç½®">linuxç³»ç»Ÿä¸‹ javaç¯å¢ƒå˜é‡çš„é…ç½®</a></li><li><a href="/2024/01/12/centos7%E7%B3%BB%E7%BB%9F_%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/" title="centos7ç³»ç»Ÿ_å¸¸ç”¨æ“ä½œ">centos7ç³»ç»Ÿ_å¸¸ç”¨æ“ä½œ</a></li><li><a href="/2023/12/03/centos7%E5%AE%89%E8%A3%85nacos%E6%93%8D%E4%BD%9C/" title="centos7 å®‰è£… nacos æ“ä½œ">centos7 å®‰è£… nacos æ“ä½œ</a></li><li><a href="/2023/11/29/vim%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/" title="vimå¸¸ç”¨æ“ä½œ">vimå¸¸ç”¨æ“ä½œ</a></li></ul><p>Windows</p><ul><li><a href="/2023/11/30/windows%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/" title="windowså¸¸ç”¨æ“ä½œ">windowså¸¸ç”¨æ“ä½œ</a></li></ul>]]></content>
    
    
    
    <tags>
      
      <tag>index</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaé›†åˆ_ArrayList å­¦ä¹ </title>
    <link href="/2023/11/14/Java%E9%9B%86%E5%90%88_ArrayList%E5%AD%A6%E4%B9%A0/"/>
    <url>/2023/11/14/Java%E9%9B%86%E5%90%88_ArrayList%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h3 id="1ã€åŸºç¡€æ¦‚å¿µ"><a href="#1ã€åŸºç¡€æ¦‚å¿µ" class="headerlink" title="1ã€åŸºç¡€æ¦‚å¿µ"></a>1ã€åŸºç¡€æ¦‚å¿µ</h3><p>ArrayList æ˜¯ List çš„ä¸»è¦å®ç°ç±»ï¼Œå†…éƒ¨åŸºäºåŠ¨æ€æ•°ç»„å®ç°ï¼Œæ”¯æŒæ’å…¥ã€åˆ é™¤ã€éå†ç­‰å¸¸è§æ“ä½œï¼Œå¹¶ä¸”æä¾›äº†ä¸°å¯Œçš„ API æ“ä½œæ–¹æ³•ï¼Œæ¯”å¦‚ <code>add()</code>ã€<code>remove()</code>ç­‰ã€‚</p><p><code>ArrayList</code> ä¸­å¯ä»¥å­˜å‚¨ä»»ä½•ç±»å‹çš„å¯¹è±¡ï¼ŒåŒ…æ‹¬ <code>null</code> å€¼ã€‚ä¸è¿‡ä¸å»ºè®®å‘<code>ArrayList</code> ä¸­æ·»åŠ  <code>null</code> å€¼ï¼Œ <code>null</code> å€¼æ— æ„ä¹‰ã€‚</p><p><code>ArrayList</code> ä¸­åªèƒ½å­˜å‚¨å¯¹è±¡ã€‚å¯¹äºåŸºæœ¬ç±»å‹æ•°æ®ï¼Œéœ€è¦ä½¿ç”¨å…¶å¯¹åº”çš„åŒ…è£…ç±»ï¼ˆå¦‚ Integerã€Double ç­‰ï¼‰ã€‚</p><p><code>ArrayList</code>åˆ›å»ºæ—¶ä¸éœ€è¦æŒ‡å®šå¤§å°ï¼Œä¸‹é¢æ˜¯å¸¸ç”¨æ–¹æ³•ç¤ºä¾‹ä»£ç ï¼š</p><p>ArrayList</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-comment">// åˆå§‹åŒ–ä¸€ä¸ª String ç±»å‹çš„ ArrayList</span><br> ArrayList&lt;String&gt; stringList = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;(Arrays.asList(<span class="hljs-string">&quot;hello&quot;</span>, <span class="hljs-string">&quot;world&quot;</span>, <span class="hljs-string">&quot;!&quot;</span>));<br><span class="hljs-comment">// æ·»åŠ å…ƒç´ åˆ° ArrayList ä¸­</span><br> stringList.<span class="hljs-keyword">add</span>(<span class="hljs-string">&quot;goodbye&quot;</span>);<br> System.<span class="hljs-keyword">out</span>.println(stringList);<span class="hljs-comment">// [hello, world, !, goodbye]</span><br> <span class="hljs-comment">// ä¿®æ”¹ ArrayList ä¸­çš„å…ƒç´ </span><br> stringList.<span class="hljs-keyword">set</span>(<span class="hljs-number">0</span>, <span class="hljs-string">&quot;hi&quot;</span>);<br> System.<span class="hljs-keyword">out</span>.println(stringList);<span class="hljs-comment">// [hi, world, !, goodbye]</span><br> <span class="hljs-comment">// åˆ é™¤ ArrayList ä¸­çš„å…ƒç´ </span><br> stringList.<span class="hljs-keyword">remove</span>(<span class="hljs-number">0</span>);<br> System.<span class="hljs-keyword">out</span>.println(stringList); <span class="hljs-comment">// [world, !, goodbye]</span><br></code></pre></td></tr></table></figure><h3 id="2ã€ArrayList-æ‰©å®¹æœºåˆ¶"><a href="#2ã€ArrayList-æ‰©å®¹æœºåˆ¶" class="headerlink" title="2ã€ArrayList æ‰©å®¹æœºåˆ¶"></a>2ã€ArrayList æ‰©å®¹æœºåˆ¶</h3><p>ä»¥æ— å‚æ„é€ å‡½æ•°åˆ›å»ºçš„ ArrayList ä¸ºä¾‹åˆ†æ, ï¼ˆJDK8ï¼‰</p><h4 id="add-æ–¹æ³•"><a href="#add-æ–¹æ³•" class="headerlink" title="add æ–¹æ³•"></a>add æ–¹æ³•</h4><p>æˆ‘ä»¬æ¥çœ‹ add æ–¹æ³•</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs arduino"><span class="hljs-keyword">private</span> <span class="hljs-type">int</span> size;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * å°†æŒ‡å®šçš„å…ƒç´ è¿½åŠ åˆ°æ­¤åˆ—è¡¨çš„æœ«å°¾ã€‚</span><br><span class="hljs-comment"> */</span> <br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title">add</span><span class="hljs-params">(E e)</span> </span>&#123; <br><span class="hljs-comment">//æ·»åŠ å…ƒç´ ä¹‹å‰ï¼Œå…ˆè°ƒç”¨ensureCapacityInternal æ–¹æ³•</span><br>    <span class="hljs-built_in">ensureCapacityInternal</span>(size + <span class="hljs-number">1</span>);  <span class="hljs-comment">// Increments modCount!!  </span><br>    <span class="hljs-comment">//è¿™é‡Œçœ‹åˆ°ArrayListæ·»åŠ å…ƒç´ çš„å®è´¨å°±ç›¸å½“äºä¸ºæ•°ç»„èµ‹å€¼</span><br>    elementData[size++] = e;  <br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;  <br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p><strong>æ³¨æ„</strong>ï¼šJDK11 ç§»é™¤äº† <code>ensureCapacityInternal()</code> å’Œ <code>ensureExplicitCapacity()</code> æ–¹æ³•</p></blockquote><h4 id="ensureCapacityInternal-æ–¹æ³•"><a href="#ensureCapacityInternal-æ–¹æ³•" class="headerlink" title="ensureCapacityInternal æ–¹æ³•"></a>ensureCapacityInternal æ–¹æ³•</h4><p>è¿›å…¥ ensureCapacityInternal æ–¹æ³•</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-comment">//å¾—åˆ°æœ€å°æ‰©å®¹é‡</span><br><span class="hljs-keyword">private</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">ensureCapacityInternal</span>(<span class="hljs-params">int minCapacity</span>) &#123;  <br>    <span class="hljs-keyword">if</span> (elementData == <span class="hljs-variable constant_">DEFAULTCAPACITY_EMPTY_ELEMENTDATA</span>) &#123;  <br>    <span class="hljs-comment">// è·å–é»˜è®¤çš„å®¹é‡å’Œä¼ å…¥å‚æ•°çš„æ¯”è¾ƒæœ€å¤§å€¼</span><br>        minCapacity = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-variable constant_">DEFAULT_CAPACITY</span>, minCapacity);  <br>    &#125;  <br>  <br>    <span class="hljs-title function_">ensureExplicitCapacity</span>(minCapacity);  <br>&#125;<br></code></pre></td></tr></table></figure><p><code>add</code> æ–¹æ³• é¦–å…ˆè°ƒç”¨äº†<code>ensureCapacityInternal(size + 1)</code>,  ArrayList çš„é»˜è®¤å®¹é‡æ˜¯ 10ï¼›</p><p>å½“ è¦ add è¿›ç¬¬ 1 ä¸ªå…ƒç´ æ—¶ï¼ŒminCapacity ä¸º 1ï¼Œåœ¨ Math.max( )æ–¹æ³•æ¯”è¾ƒåï¼ŒminCapacity ä¸º 10ã€‚</p><h4 id="ensureExplicitCapacity-æ–¹æ³•"><a href="#ensureExplicitCapacity-æ–¹æ³•" class="headerlink" title="ensureExplicitCapacity() æ–¹æ³•"></a><code>ensureExplicitCapacity()</code> æ–¹æ³•</h4><p>è¿›å…¥åˆ° <code>ensureExplicitCapacity()</code> æ–¹æ³•</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-comment">//åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹</span><br>private void <span class="hljs-built_in">ensureExplicitCapacity</span>(int minCapacity) &#123;  <br>    modCount++;  <br>  <br>    <span class="hljs-comment">// overflow-conscious code  </span><br>    if (minCapacity - elementData.length &gt; <span class="hljs-number">0</span>)  <br>    <span class="hljs-comment">//è°ƒç”¨growæ–¹æ³•è¿›è¡Œæ‰©å®¹ï¼Œè°ƒç”¨æ­¤æ–¹æ³•ä»£è¡¨å·²ç»å¼€å§‹æ‰©å®¹äº†</span><br>        <span class="hljs-built_in">grow</span>(minCapacity);  <br>&#125;<br></code></pre></td></tr></table></figure><ul><li>å½“ add æ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ åˆ° ArrayList æ—¶ï¼Œ<ul><li>elementData.length ä¸º 0 ï¼ˆæ­¤æ—¶è¿˜æ˜¯ä¸€ä¸ªç©ºçš„ listï¼‰ï¼›</li><li>æ‰§è¡Œ <code>ensureCapacityInternal()</code> æ–¹æ³• ï¼Œ minCapacity æ­¤æ—¶ä¸º 10ã€‚</li><li>æ­¤æ—¶ï¼Œ<code>minCapacity - elementData.length &gt; 0</code>æˆç«‹ï¼Œä¼šè¿›å…¥ <code>grow(minCapacity)</code> æ–¹æ³•ã€‚</li></ul></li><li>å½“ add ç¬¬ 2 ä¸ªå…ƒç´ æ—¶ï¼Œ<ul><li>minCapacity ä¸º 2ï¼Œæ­¤æ—¶ elementData.length(å®¹é‡)åœ¨æ·»åŠ ç¬¬ä¸€ä¸ªå…ƒç´ åæ‰©å®¹æˆ 10 äº†ã€‚</li><li>æ­¤æ—¶ï¼Œ<code>minCapacity - elementData.length &gt; 0</code> ä¸æˆç«‹ï¼Œæ‰€ä»¥ä¸ä¼šè¿›å…¥ ï¼ˆæ‰§è¡Œï¼‰<code>grow(minCapacity)</code> æ–¹æ³•ã€‚</li></ul></li><li>æ·»åŠ ç¬¬ 3ã€4Â·Â·Â·åˆ°ç¬¬ 10 ä¸ªå…ƒç´ æ—¶ï¼Œä¾ç„¶ä¸ä¼šæ‰§è¡Œ grow æ–¹æ³•ï¼Œæ•°ç»„å®¹é‡éƒ½ä¸º 10ã€‚</li></ul><p>ç›´åˆ°æ·»åŠ ç¬¬ 11 ä¸ªå…ƒç´ ï¼ŒminCapacity(ä¸º 11)æ¯” elementData.lengthï¼ˆä¸º 10ï¼‰è¦å¤§ã€‚è¿›å…¥ grow æ–¹æ³•è¿›è¡Œæ‰©å®¹ã€‚</p><h4 id="grow-æ–¹æ³•"><a href="#grow-æ–¹æ³•" class="headerlink" title="grow æ–¹æ³•"></a><code>grow æ–¹æ³•</code></h4><p>è¿›å…¥åˆ° <code>grow æ–¹æ³•</code></p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs haxe"><span class="hljs-comment">//è¦åˆ†é…çš„æœ€å¤§æ•°ç»„å¤§å°</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> int MAX_ARRAY_SIZE = Integer.MAX_VALUE - <span class="hljs-number">8</span>;<br><br><br><span class="hljs-comment">/**  </span><br><span class="hljs-comment"> * Increases the capacity to ensure that it can hold at least the number of elements specified by the minimum capacity argument. </span><br><span class="hljs-comment"> * @param minCapacity - the desired minimum capacity  </span><br><span class="hljs-comment"> * ArrayListæ‰©å®¹çš„æ ¸å¿ƒæ–¹æ³•ã€‚</span><br><span class="hljs-comment">*/</span><br> <span class="hljs-keyword">private</span> void grow(int minCapacity) &#123;  <br>    <span class="hljs-comment">// overflow-conscious code  </span><br>    <span class="hljs-comment">// oldCapacityä¸ºæ—§å®¹é‡ï¼ŒnewCapacityä¸ºæ–°å®¹é‡</span><br>    int oldCapacity = elementData.length;  <br>    <span class="hljs-comment">//å°†oldCapacity å³ç§»ä¸€ä½ï¼Œå…¶æ•ˆæœç›¸å½“äºoldCapacity /2ï¼Œ</span><br>    <span class="hljs-comment">//ä½è¿ç®—çš„é€Ÿåº¦è¿œè¿œå¿«äºæ•´é™¤è¿ç®—ï¼Œæ•´å¥è¿ç®—å¼çš„ç»“æœå°±æ˜¯å°†æ–°å®¹é‡æ›´æ–°ä¸ºæ—§å®¹é‡çš„1.5å€ï¼Œ</span><br>    int <span class="hljs-keyword">new</span><span class="hljs-type">Capacity</span> = oldCapacity + (oldCapacity &gt;&gt; <span class="hljs-number">1</span>);  <br>    <span class="hljs-comment">//æ£€æŸ¥æ–°å®¹é‡æ˜¯å¦å¤§äºæœ€å°éœ€è¦å®¹é‡ï¼Œè‹¥è¿˜æ˜¯å°äºæœ€å°éœ€è¦å®¹é‡ï¼Œé‚£ä¹ˆå°±æŠŠæœ€å°éœ€è¦å®¹é‡å½“ä½œæ•°ç»„çš„æ–°å®¹é‡ï¼Œ</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">new</span><span class="hljs-type">Capacity</span> - minCapacity &lt; <span class="hljs-number">0</span>)  <br>        <span class="hljs-keyword">new</span><span class="hljs-type">Capacity</span> = minCapacity;  <br>    <span class="hljs-comment">// å¦‚æœæ–°å®¹é‡å¤§äº MAX_ARRAY_SIZE,è¿›å…¥(æ‰§è¡Œ) `hugeCapacity()` æ–¹æ³•æ¥æ¯”è¾ƒ minCapacity å’Œ MAX_ARRAY_SIZEï¼Œ</span><br>    <span class="hljs-comment">//å¦‚æœminCapacityå¤§äºæœ€å¤§å®¹é‡ï¼Œåˆ™æ–°å®¹é‡åˆ™ä¸º`Integer.MAX_VALUE`ï¼Œå¦åˆ™ï¼Œæ–°å®¹é‡å¤§å°åˆ™ä¸º MAX_ARRAY_SIZE å³ä¸º `Integer.MAX_VALUE - 8`ã€‚</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">new</span><span class="hljs-type">Capacity</span> - MAX_ARRAY_SIZE &gt; <span class="hljs-number">0</span>)  <br>        <span class="hljs-keyword">new</span><span class="hljs-type">Capacity</span> = hugeCapacity(minCapacity);  <br>    <span class="hljs-comment">// minCapacity is usually close to size, so this is a win:  </span><br>    elementData = Arrays.copyOf(elementData, <span class="hljs-keyword">new</span><span class="hljs-type">Capacity</span>);  <br>&#125;<br></code></pre></td></tr></table></figure><ul><li>å½“ add ç¬¬ 1 ä¸ªå…ƒç´ æ—¶ï¼Œ<ul><li>oldCapacity ä¸º 0ï¼Œç»æ¯”è¾ƒåç¬¬ä¸€ä¸ª if åˆ¤æ–­æˆç«‹ï¼Œ**newCapacity &#x3D; minCapacity(ä¸º 10)**ã€‚</li><li>ä½†æ˜¯ç¬¬äºŒä¸ª if åˆ¤æ–­ä¸ä¼šæˆç«‹ï¼Œå³ newCapacity ä¸æ¯” MAX_ARRAY_SIZE å¤§ï¼Œåˆ™ä¸ä¼šè¿›å…¥ <code>hugeCapacity</code> æ–¹æ³•ã€‚</li><li>æ•°ç»„å®¹é‡ä¸º 10ï¼Œadd æ–¹æ³•ä¸­ return true, </li><li>size å¢ä¸º 1ã€‚ã€elementData[size++] &#x3D; e;  ã€‘</li></ul></li><li>å½“ add ç¬¬ 11 ä¸ªå…ƒç´ è¿›å…¥ grow æ–¹æ³•æ—¶ï¼Œ<ul><li>newCapacity ä¸º 15ï¼Œæ¯” minCapacityï¼ˆä¸º 11ï¼‰å¤§ï¼Œç¬¬ä¸€ä¸ª if åˆ¤æ–­ä¸æˆç«‹ã€‚</li><li>æ–°å®¹é‡æ²¡æœ‰å¤§äºæ•°ç»„æœ€å¤§ sizeï¼Œä¸ä¼šè¿›å…¥ hugeCapacity æ–¹æ³•ã€‚æ•°ç»„å®¹é‡æ‰©ä¸º 15ï¼Œ</li><li>add æ–¹æ³•ä¸­ return true,  size å¢ä¸º 11ã€‚</li></ul></li><li>ä»¥æ­¤ç±»æ¨Â·Â·Â·Â·Â·Â·</li></ul><h4 id="hugeCapacity-æ–¹æ³•"><a href="#hugeCapacity-æ–¹æ³•" class="headerlink" title="hugeCapacity() æ–¹æ³•"></a><code>hugeCapacity()</code> æ–¹æ³•</h4><p>å¦‚æœæ–°å®¹é‡å¤§äº MAX_ARRAY_SIZE,è¿›å…¥(æ‰§è¡Œ) <code>hugeCapacity()</code> æ–¹æ³•</p><p>å¦‚æœ minCapacity å¤§äºæœ€å¤§å®¹é‡ï¼Œåˆ™æ–°å®¹é‡åˆ™ä¸º<code>Integer.MAX_VALUE</code>ï¼Œå¦åˆ™ï¼Œæ–°å®¹é‡å¤§å°åˆ™ä¸º MAX_ARRAY_SIZE å³ä¸º <code>Integer.MAX_VALUE - 8</code>ã€‚</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs arduino"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-type">static</span> <span class="hljs-type">int</span> <span class="hljs-title">hugeCapacity</span><span class="hljs-params">(<span class="hljs-type">int</span> minCapacity)</span> </span>&#123;  <br>    <span class="hljs-keyword">if</span> (minCapacity &lt; <span class="hljs-number">0</span>) <span class="hljs-comment">// overflow  </span><br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">OutOfMemoryError</span>();  <br><span class="hljs-comment">//å¯¹minCapacityå’ŒMAX_ARRAY_SIZEè¿›è¡Œæ¯”è¾ƒ</span><br><span class="hljs-comment">//è‹¥minCapacityå¤§ï¼Œå°†Integer.MAX_VALUEä½œä¸ºæ–°æ•°ç»„çš„å¤§å°</span><br><span class="hljs-comment">//è‹¥MAX_ARRAY_SIZEå¤§ï¼Œå°†MAX_ARRAY_SIZEä½œä¸ºæ–°æ•°ç»„çš„å¤§å°</span><br><span class="hljs-comment">//MAX_ARRAY_SIZE = Integer.MAX_VALUE - 8;</span><br>    <span class="hljs-keyword">return</span> (minCapacity &gt; MAX_ARRAY_SIZE) ?  <br>        Integer.MAX_VALUE :  <br>        MAX_ARRAY_SIZE;  <br>&#125;<br></code></pre></td></tr></table></figure><p>æµç¨‹å›¾è¾“å‡ºï¼š</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311151356624.png" alt="image.png"></p><h3 id="3ã€ç›¸å…³å†…å®¹"><a href="#3ã€ç›¸å…³å†…å®¹" class="headerlink" title="3ã€ç›¸å…³å†…å®¹"></a>3ã€ç›¸å…³å†…å®¹</h3><h4 id="å…³äº-oldCapacity-oldCapacity-1-çš„è¯´æ˜ï¼š"><a href="#å…³äº-oldCapacity-oldCapacity-1-çš„è¯´æ˜ï¼š" class="headerlink" title="å…³äº oldCapacity + (oldCapacity &gt;&gt; 1) çš„è¯´æ˜ï¼š"></a>å…³äº oldCapacity + (oldCapacity &gt;&gt; 1) çš„è¯´æ˜ï¼š</h4><p><strong>int newCapacity &#x3D; oldCapacity + (oldCapacity &gt;&gt; 1),æ‰€ä»¥ ArrayList æ¯æ¬¡æ‰©å®¹ä¹‹åå®¹é‡éƒ½ä¼šå˜ä¸ºåŸæ¥çš„ 1.5 å€å·¦å³ï¼ˆoldCapacity ä¸ºå¶æ•°å°±æ˜¯ 1.5 å€ï¼Œå¦åˆ™æ˜¯ 1.5 å€å·¦å³ï¼‰ï¼</strong> å¥‡å¶ä¸åŒï¼Œæ¯”å¦‚ï¼š10+10&#x2F;2 &#x3D; 15, 33+33&#x2F;2&#x3D;49ã€‚å¦‚æœæ˜¯å¥‡æ•°çš„è¯ä¼šä¸¢æ‰å°æ•°.</p><blockquote><p>â€œ&gt;&gt;â€ï¼ˆç§»ä½è¿ç®—ç¬¦ï¼‰ï¼š&gt;&gt;1 å³ç§»ä¸€ä½ç›¸å½“äºé™¤ 2ï¼Œå³ç§» n ä½ç›¸å½“äºé™¤ä»¥ 2 çš„ n æ¬¡æ–¹ã€‚è¿™é‡Œ oldCapacity æ˜æ˜¾å³ç§»äº† 1 ä½æ‰€ä»¥ç›¸å½“äº oldCapacity &#x2F;2ã€‚å¯¹äºå¤§æ•°æ®çš„ 2 è¿›åˆ¶è¿ç®—,ä½ç§»è¿ç®—ç¬¦æ¯”é‚£äº›æ™®é€šè¿ç®—ç¬¦çš„è¿ç®—è¦å¿«å¾ˆå¤š,å› ä¸ºç¨‹åºä»…ä»…ç§»åŠ¨ä¸€ä¸‹è€Œå·²,ä¸å»è®¡ç®—,è¿™æ ·æé«˜äº†æ•ˆç‡,èŠ‚çœäº†èµ„æº</p></blockquote><h4 id="å…³äº-Arrays-copyOf-æ–¹æ³•"><a href="#å…³äº-Arrays-copyOf-æ–¹æ³•" class="headerlink" title="å…³äº Arrays.copyOf()æ–¹æ³•"></a>å…³äº <code>Arrays.copyOf()</code>æ–¹æ³•</h4><p>æºç ï¼š</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs haxe"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T,U&gt; T[] copyOf(U[] original, int <span class="hljs-keyword">new</span><span class="hljs-type">Length</span>, Class&lt;? extends T[]&gt; <span class="hljs-keyword">new</span><span class="hljs-type">Type</span>) &#123;  <br><span class="hljs-comment">// ç”³è¯·ä¸€ä¸ªæ–°çš„æ•°ç»„</span><br>    <span class="hljs-meta">@SuppressWarnings</span>(<span class="hljs-string">&quot;unchecked&quot;</span>)  <br>    T[] copy = ((Object)<span class="hljs-keyword">new</span><span class="hljs-type">Type</span> == (Object)Object[].class)  <br>        ? (T[]) <span class="hljs-keyword">new</span> <span class="hljs-type">Object</span>[<span class="hljs-keyword">new</span><span class="hljs-type">Length</span>]  <br>        : <span class="hljs-type"></span>(T[]) <span class="hljs-keyword">Array</span>.<span class="hljs-keyword">new</span><span class="hljs-type">Instance</span>(<span class="hljs-keyword">new</span><span class="hljs-type">Type</span>.getComponentType(), <span class="hljs-keyword">new</span><span class="hljs-type">Length</span>); <br>    <span class="hljs-comment">// è°ƒç”¨System.arraycopy,å°†æºæ•°ç»„ä¸­çš„æ•°æ®è¿›è¡Œæ‹·è´,å¹¶è¿”å›æ–°çš„æ•°ç»„     </span><br>    System.arraycopy(original, <span class="hljs-number">0</span>, copy, <span class="hljs-number">0</span>,  <br>                     Math.min(original.length, <span class="hljs-keyword">new</span><span class="hljs-type">Length</span>));  <br>    <span class="hljs-keyword">return</span> copy;  <br>&#125;<br></code></pre></td></tr></table></figure><p><code>System.arraycopy()</code> æ–¹æ³•</p><p>æºç ï¼š</p><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs aspectj"><span class="hljs-comment">// arraycopy æ˜¯ä¸€ä¸ª native æ–¹æ³•,æ¥ä¸‹æ¥è§£é‡Šä¸€ä¸‹å„ä¸ªå‚æ•°çš„å…·ä½“æ„ä¹‰</span><br><span class="hljs-comment">/**</span><br><span class="hljs-comment">*   å¤åˆ¶æ•°ç»„</span><br><span class="hljs-comment">* <span class="hljs-doctag">@param</span> src æºæ•°ç»„</span><br><span class="hljs-comment">* <span class="hljs-doctag">@param</span> srcPos æºæ•°ç»„ä¸­çš„èµ·å§‹ä½ç½®</span><br><span class="hljs-comment">* <span class="hljs-doctag">@param</span> dest ç›®æ ‡æ•°ç»„</span><br><span class="hljs-comment">* <span class="hljs-doctag">@param</span> destPos ç›®æ ‡æ•°ç»„ä¸­çš„èµ·å§‹ä½ç½®</span><br><span class="hljs-comment">* <span class="hljs-doctag">@param</span> length è¦å¤åˆ¶çš„æ•°ç»„å…ƒç´ çš„æ•°é‡</span><br><span class="hljs-comment">*/</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">native</span> <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">arraycopy</span><span class="hljs-params">(Object src,  <span class="hljs-keyword">int</span>  srcPos,</span></span><br><span class="hljs-params"><span class="hljs-function">                                    Object dest, <span class="hljs-keyword">int</span> destPos,</span></span><br><span class="hljs-params"><span class="hljs-function">                                    <span class="hljs-keyword">int</span> length)</span></span>;<br></code></pre></td></tr></table></figure><hr><p>å‚è€ƒï¼š</p><ul><li><a href="https://javaguide.cn/java/collection/arraylist-source-code.html">https://javaguide.cn/java/collection/arraylist-source-code.html</a></li><li><a href="https://blog.csdn.net/czxlylc/article/details/106892156">https://blog.csdn.net/czxlylc/article/details/106892156</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
      <category>é›†åˆ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>é›†åˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaé›†åˆ_ç›¸å…³é—®é¢˜</title>
    <link href="/2023/11/14/Java%E9%9B%86%E5%90%88_%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
    <url>/2023/11/14/Java%E9%9B%86%E5%90%88_%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h4 id="1ã€Seté›†åˆæ˜¯å¦‚ä½•ä¿è¯å¯¹è±¡ä¸é‡å¤çš„ï¼Ÿ"><a href="#1ã€Seté›†åˆæ˜¯å¦‚ä½•ä¿è¯å¯¹è±¡ä¸é‡å¤çš„ï¼Ÿ" class="headerlink" title="1ã€Seté›†åˆæ˜¯å¦‚ä½•ä¿è¯å¯¹è±¡ä¸é‡å¤çš„ï¼Ÿ"></a>1ã€Seté›†åˆæ˜¯å¦‚ä½•ä¿è¯å¯¹è±¡ä¸é‡å¤çš„ï¼Ÿ</h4><p>HashSet çš„åº•å±‚é‡‡ç”¨HashMapæ¥å­˜æ”¾æ•°æ®,  ä»–æ‰§è¡Œæ·»åŠ å…ƒç´ æ“ä½œçš„æ—¶å€™æ˜¯å°†å…ƒç´ ä½œä¸º Map çš„Keyï¼›</p><p>HashMapä¿è¯keyçš„ä¸é‡å¤æ€§ï¼Œå¯¹äºé‡å¤çš„keyï¼ŒHashMapä¼šæ ¹æ®å‚æ•°onlyIfAbsentçš„è®¾ç½®å’ŒåŸvalueæ˜¯å¦ä¸ºç©ºä¸¤ä¸ªæ¡ä»¶æ¥<strong>åˆ¤æ–­æ˜¯å¦æ›¿æ¢æ–°value</strong>ï¼Œ</p><p>ä½†è¦æ³¨æ„çš„æ˜¯ï¼Œå¯¹äºHashSetï¼Œè¿™ä¸ªvalueåªæ˜¯ä¸ªç©ºçš„Objectç±»çš„å¯¹è±¡ï¼Œæ²¡æœ‰ä»»ä½•å®é™…ä½œç”¨ï¼ŒHashSetä¸­çš„å…ƒç´ å®é™…ä¸Šæ˜¯å­˜å‚¨åœ¨keyä¸Šçš„ã€‚é’ˆå¯¹é‡å¤çš„keyï¼Œ<strong>HashMapåªæœ‰å¯¹äºvalueçš„å¤„ç†ï¼Œå¹¶ä¸ä¼šæ›¿æ¢key</strong>ï¼Œå› æ­¤åœ¨HashSetä¸­åŠ å…¥ç›¸åŒå…ƒç´ ä¸ä¼šè¦†ç›–ã€‚</p><p>æºç ç›¸å…³å†…å®¹ï¼š</p><p>HashSet çš„æ·»åŠ æ–¹æ³•</p><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs processing"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-built_in">add</span>(E e) &#123;  <br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">map</span>.<span class="hljs-property">put</span>(e, PRESENT)==<span class="hljs-literal">null</span>;  <br>&#125;<br></code></pre></td></tr></table></figure><p>hashmap çš„ put æ–¹æ³•</p><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs processing"><span class="hljs-keyword">public</span> V <span class="hljs-title function_">put</span>(K <span class="hljs-built_in">key</span>, V value) &#123;<br>      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">key</span> == <span class="hljs-literal">null</span>)<br>          <span class="hljs-keyword">return</span> <span class="hljs-title function_">putForNullKey</span>(value);<br>      <span class="hljs-type">int</span> hash = <span class="hljs-title function_">hash</span>(<span class="hljs-built_in">key</span>.<span class="hljs-property">hashCode</span>());<span class="hljs-comment">//----------1----------</span><br>      <span class="hljs-type">int</span> i = <span class="hljs-title function_">indexFor</span>(hash, table.<span class="hljs-property">length</span>);<span class="hljs-comment">//-----------2---------</span><br>      <span class="hljs-keyword">for</span> (Entry e = table[i]; e != <span class="hljs-literal">null</span>; e = e.<span class="hljs-property">next</span>) &#123;<span class="hljs-comment">//-----------3---------</span><br>          <span class="hljs-built_in">Object</span> k;<br>          <span class="hljs-keyword">if</span> (e.<span class="hljs-property">hash</span> == hash &amp;&amp; ((k = e.<span class="hljs-property">key</span>) == <span class="hljs-built_in">key</span> || <span class="hljs-built_in">key</span>.<span class="hljs-property">equals</span>(k))) &#123;<br>              V oldValue = e.<span class="hljs-property">value</span>;<br>              e.<span class="hljs-property">value</span> = value;<br>              e.<span class="hljs-property">recordAccess</span>(<span class="hljs-variable">this</span>);<br>              <span class="hljs-keyword">return</span> oldValue;<br>          &#125;<br>      &#125;<span class="hljs-comment">//------------------4--------------------</span><br>      modCount++;<br>      <span class="hljs-title function_">addEntry</span>(hash, <span class="hljs-built_in">key</span>, value, i);<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>  &#125;<br></code></pre></td></tr></table></figure><p>å½“å‘HashMapä¸­æ·»åŠ å…ƒç´ çš„æ—¶å€™ï¼Œ</p><ul><li><strong>é¦–å…ˆè®¡ç®—å…ƒç´ çš„hashcodeå€¼</strong>ï¼Œç„¶åæ ¹æ®1å¤„çš„ä»£ç è®¡ç®—å‡ºHashcodeçš„å€¼ï¼Œ</li><li>å†æ ¹æ®2å¤„çš„ä»£ç è®¡ç®—å‡ºè¿™ä¸ªå…ƒç´ çš„å­˜å‚¨ä½ç½®ï¼Œ<ul><li>å¦‚æœ<strong>è¿™ä¸ªä½ç½®ä¸ºç©ºï¼Œå°±å°†å…ƒç´ æ·»åŠ è¿›å»</strong>ï¼›</li><li>å¦‚æœä¸ä¸ºç©ºï¼Œåˆ™çœ‹3-4çš„ä»£ç ï¼Œéå†ç´¢å¼•ä¸ºiçš„é“¾ä¸Šçš„å…ƒç´ ï¼Œ<strong>å¦‚æœkeyé‡å¤ï¼Œåˆ™æ›¿æ¢å¹¶è¿”å›oldValueå€¼ã€‚</strong></li></ul></li></ul><p><strong>æ€»ç»“</strong>ï¼šç»“æœå‘HashSetä¸­åŠ å…¥ç›¸åŒå…ƒç´ ä¸ä¼šè¿›è¡Œè¦†ç›–ã€‚å› ä¸ºHashSetåº•å±‚ä½¿ç”¨HashMapå®ç°ï¼Œå…ƒç´ å­˜åœ¨HashMapçš„keyä¸­ã€‚åœ¨HashMapä¸­ï¼Œå¤šæ¬¡putç›¸åŒçš„keyï¼Œåªä¼šè¦†ç›–valueï¼Œè€Œä¸å­˜åœ¨keyçš„æƒ…å†µã€‚</p><h4 id="2ã€ä½¿ç”¨forå¾ªç¯åˆ é™¤å…ƒç´ é™·é˜±"><a href="#2ã€ä½¿ç”¨forå¾ªç¯åˆ é™¤å…ƒç´ é™·é˜±" class="headerlink" title="2ã€ä½¿ç”¨forå¾ªç¯åˆ é™¤å…ƒç´ é™·é˜±"></a>2ã€ä½¿ç”¨forå¾ªç¯åˆ é™¤å…ƒç´ é™·é˜±</h4><p>å…ˆæ¥çœ‹çœ‹ä¸‹é¢è¿™ä¸ªç¨‹åºï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> &#123;<br> <br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] args</span>)</span> &#123;<br>List&lt;String&gt; list = <span class="hljs-keyword">new</span> LinkedList&lt;String&gt;();<br>list.<span class="hljs-keyword">add</span>(<span class="hljs-string">&quot;A&quot;</span>);<br>list.<span class="hljs-keyword">add</span>(<span class="hljs-string">&quot;B&quot;</span>);<br>list.<span class="hljs-keyword">add</span>(<span class="hljs-string">&quot;C&quot;</span>);<br><br><span class="hljs-keyword">for</span>(<span class="hljs-built_in">int</span> i=<span class="hljs-number">0</span>; i&lt;list.size(); i++)&#123;<br>list.<span class="hljs-keyword">remove</span>(i);<br>&#125;<br><br><span class="hljs-keyword">for</span>(String item:list)&#123;<br>System.<span class="hljs-keyword">out</span>.println(item);<br>&#125;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥å…ˆçŒœçŒœè¿™ä¸ªç¨‹åºè¾“å‡ºä»€ä¹ˆï¼Ÿ</p><p>æŒ‰æˆ‘ä»¬çš„æ€è·¯ï¼Œåº”è¯¥æ˜¯è¾“ä¸å‡ºä»€ä¹ˆï¼Œ<strong>ä½†æ˜¯æ‰§è¡Œå®ƒï¼Œè¾“å‡ºçš„å´æ˜¯ï¼šB</strong>ã€‚</p><p>åˆ†æä¸‹è¿™ä¸ªç¨‹åºï¼Œå½“ç¬¬ä¸€æ­¥removeå®Œåï¼Œé›†åˆå†…è¿˜å‰©2ä¸ªå…ƒç´ ï¼Œæ­¤æ—¶iä¸º1ï¼Œè€Œlist.size()çš„å€¼ä¸º2ï¼Œä»0å¼€å§‹çš„è¯ï¼Œiä¸º1æ—¶ï¼Œæ­£å¥½æŒ‡å‘ç¬¬äºŒä¸ªå…ƒç´ ï¼Œä¹Ÿå°±æ˜¯è¯´å½“removeå®ŒAåï¼Œç›´æ¥å°±è·³åˆ°Cï¼Œå°†Bæ¼äº†ã€‚</p><p>è§£å†³åŠæ³•ï¼š</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> &#123;<br> <br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] args</span>)</span> &#123;<br>List&lt;String&gt; list = <span class="hljs-keyword">new</span> LinkedList&lt;String&gt;();<br>list.<span class="hljs-keyword">add</span>(<span class="hljs-string">&quot;A&quot;</span>);<br>list.<span class="hljs-keyword">add</span>(<span class="hljs-string">&quot;B&quot;</span>);<br>list.<span class="hljs-keyword">add</span>(<span class="hljs-string">&quot;C&quot;</span>);<br><br><span class="hljs-keyword">for</span>(<span class="hljs-built_in">int</span> i=<span class="hljs-number">0</span>; i&lt;list.size(); i++)&#123;<br>list.<span class="hljs-keyword">remove</span>(i);<br>i -= <span class="hljs-number">1</span>;<span class="hljs-comment">//æ¯æ¬¡åˆ é™¤å®Œåï¼Œiå‡å°‘1</span><br>&#125;<br><br><span class="hljs-keyword">for</span>(String item:list)&#123;<br>System.<span class="hljs-keyword">out</span>.println(item);<br>&#125;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="3ã€è®²è¿°ä¸€ä¸‹-lengthã€length-ã€size-çš„åŒºåˆ«ã€‚"><a href="#3ã€è®²è¿°ä¸€ä¸‹-lengthã€length-ã€size-çš„åŒºåˆ«ã€‚" class="headerlink" title="3ã€è®²è¿°ä¸€ä¸‹ lengthã€length()ã€size() çš„åŒºåˆ«ã€‚"></a>3ã€è®²è¿°ä¸€ä¸‹ lengthã€length()ã€size() çš„åŒºåˆ«ã€‚</h4><ul><li>java ä¸­çš„ <code>length</code>å±æ€§æ˜¯é’ˆå¯¹æ•°ç»„è¯´çš„,æ¯”å¦‚è¯´ä½ å£°æ˜äº†ä¸€ä¸ªæ•°ç»„,æƒ³çŸ¥é“è¿™ä¸ªæ•°ç»„çš„é•¿åº¦åˆ™ç”¨åˆ°äº† length è¿™ä¸ªå±æ€§.</li><li>java ä¸­çš„ <code>length()</code> æ–¹æ³•æ˜¯é’ˆå¯¹å­—ç¬¦ä¸²è¯´çš„,å¦‚æœæƒ³çœ‹è¿™ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦åˆ™ç”¨åˆ° <code>length()</code> è¿™ä¸ªæ–¹æ³•.</li><li>java ä¸­çš„ <code>size()</code> æ–¹æ³•æ˜¯é’ˆå¯¹æ³›å‹é›†åˆè¯´çš„,å¦‚æœæƒ³çœ‹è¿™ä¸ªæ³›å‹æœ‰å¤šå°‘ä¸ªå…ƒç´ ,å°±è°ƒç”¨æ­¤æ–¹æ³•æ¥æŸ¥çœ‹!</li></ul><h4 id="4ã€åœ¨-HashMap-ä¸­ï¼Œä¸ºä»€ä¹ˆä¸ä¸€ä¸‹å­æŠŠæ•´ä¸ªé“¾è¡¨å˜ä¸ºçº¢é»‘æ ‘å‘¢"><a href="#4ã€åœ¨-HashMap-ä¸­ï¼Œä¸ºä»€ä¹ˆä¸ä¸€ä¸‹å­æŠŠæ•´ä¸ªé“¾è¡¨å˜ä¸ºçº¢é»‘æ ‘å‘¢" class="headerlink" title="4ã€åœ¨ HashMap ä¸­ï¼Œä¸ºä»€ä¹ˆä¸ä¸€ä¸‹å­æŠŠæ•´ä¸ªé“¾è¡¨å˜ä¸ºçº¢é»‘æ ‘å‘¢"></a>4ã€åœ¨ HashMap ä¸­ï¼Œä¸ºä»€ä¹ˆä¸ä¸€ä¸‹å­æŠŠæ•´ä¸ªé“¾è¡¨å˜ä¸ºçº¢é»‘æ ‘å‘¢</h4><p>ä¸ºä»€ä¹ˆéè¦ç­‰åˆ°é“¾è¡¨çš„é•¿åº¦å¤§äºç­‰äº8çš„æ—¶å€™ï¼Œæ‰è½¬å˜æˆçº¢é»‘æ ‘ï¼Ÿ</p><p>ï¼ˆ1ï¼‰æ„é€ çº¢é»‘æ ‘è¦æ¯”æ„é€ é“¾è¡¨å¤æ‚ï¼Œåœ¨é“¾è¡¨çš„èŠ‚ç‚¹ä¸å¤šçš„æ—¶å€™ï¼Œä»æ•´ä½“çš„æ€§èƒ½çœ‹æ¥ï¼Œ æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘çš„ç»“æ„å¯èƒ½ä¸ä¸€å®šæ¯”æ•°ç»„+é“¾è¡¨çš„ç»“æ„æ€§èƒ½é«˜ã€‚å°±å¥½æ¯”æ€é¸¡ç„‰ç”¨ç‰›åˆ€çš„æ„æ€ã€‚</p><p>ï¼ˆ2ï¼‰HashMapé¢‘ç¹çš„æ‰©å®¹ï¼Œä¼šé€ æˆåº•éƒ¨çº¢é»‘æ ‘ä¸æ–­çš„è¿›è¡Œæ‹†åˆ†å’Œé‡ç»„ï¼Œè¿™æ˜¯éå¸¸è€—æ—¶çš„ã€‚å› æ­¤ï¼Œä¹Ÿå°±æ˜¯é“¾è¡¨é•¿åº¦æ¯”è¾ƒé•¿çš„æ—¶å€™è½¬å˜æˆçº¢é»‘æ ‘æ‰ä¼š<strong>æ˜¾è‘—æé«˜æ•ˆç‡</strong>ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
      <category>é›†åˆ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Java é›†åˆ_è¿›é˜¶å†…å®¹</title>
    <link href="/2023/11/14/Java%E9%9B%86%E5%90%88_%E8%BF%9B%E9%98%B6%E5%86%85%E5%AE%B9/"/>
    <url>/2023/11/14/Java%E9%9B%86%E5%90%88_%E8%BF%9B%E9%98%B6%E5%86%85%E5%AE%B9/</url>
    
    <content type="html"><![CDATA[<h4 id="1ã€ä»€ä¹ˆæ˜¯-fail-fastæœºåˆ¶ï¼Œè®²è¿°ä¸€ä¸‹ä»–å’Œ-fail-safe-çš„å¼‚åŒã€‚"><a href="#1ã€ä»€ä¹ˆæ˜¯-fail-fastæœºåˆ¶ï¼Œè®²è¿°ä¸€ä¸‹ä»–å’Œ-fail-safe-çš„å¼‚åŒã€‚" class="headerlink" title="1ã€ä»€ä¹ˆæ˜¯ fail-fastæœºåˆ¶ï¼Œè®²è¿°ä¸€ä¸‹ä»–å’Œ fail-safe çš„å¼‚åŒã€‚"></a>1ã€ä»€ä¹ˆæ˜¯ fail-fastæœºåˆ¶ï¼Œè®²è¿°ä¸€ä¸‹ä»–å’Œ fail-safe çš„å¼‚åŒã€‚</h4><p>é”™è¯¯æ£€æŸ¥æœºåˆ¶</p><ul><li>å¿«é€Ÿå¤±è´¥ fail-fast<ul><li>å½“æ–¹æ³•æ£€æµ‹åˆ°å¯¹è±¡çš„å¹¶å‘ä¿®æ”¹ï¼Œä½†ä¸å…è®¸è¿™ç§ä¿®æ”¹æ—¶å°±æŠ›å‡ºè¯¥å¼‚å¸¸</li></ul></li><li>fail-safe æœºåˆ¶<ul><li>fail-safe ä»»ä½•å¯¹é›†åˆç»“æ„çš„ä¿®æ”¹éƒ½ä¼šåœ¨ä¸€ä¸ªå¤åˆ¶çš„é›†åˆä¸Šè¿›è¡Œï¼Œå› æ­¤ä¸ä¼šæŠ›å‡ºConcurrentModificationException</li></ul></li></ul><p><strong>fail-fast è§£å†³æ–¹æ³•</strong></p><ul><li>æ–¹æ¡ˆä¸€ï¼šåœ¨éå†è¿‡ç¨‹ä¸­æ‰€æœ‰æ¶‰åŠåˆ°æ”¹å˜modCount å€¼çš„åœ°æ–¹å…¨éƒ¨åŠ ä¸Šsynchronized æˆ–è€…ç›´æ¥ä½¿ç”¨ Collection  synchronizedListï¼Œè¿™æ ·å°±å¯ä»¥è§£å†³é—®é¢˜ï¼Œä½†æ˜¯ä¸æ¨èï¼Œå› ä¸ºå¢åˆ é€ æˆçš„åŒæ­¥é”å¯èƒ½ä¼šé˜»å¡éå†æ“ä½œã€‚</li><li>æ–¹æ¡ˆäºŒï¼šä½¿ç”¨CopyOnWriteArrayList æ›¿æ¢ ArrayLIstï¼Œæ¨èä½¿ç”¨è¯¥æ–¹æ¡ˆï¼ˆå³fail-safeï¼‰ã€‚</li></ul><p><strong>fail-fastå’Œ fail-safe çš„åŒºåˆ«</strong></p><table><thead><tr><th></th><th>Fail Fast Iterator</th><th>Fail Safe Iterator</th></tr></thead><tbody><tr><td>Throw ConcurrentModification Exception</td><td>Yes</td><td>No</td></tr><tr><td>Clone object</td><td>No</td><td>Yes</td></tr><tr><td>Memory Overhead</td><td>No</td><td>Yes</td></tr><tr><td>Examples</td><td>HashMap,Vector,ArrayList,HashSet</td><td>CopyOnWriteArrayList,  <br>ConcurrentHashMap</td></tr><tr><td></td><td></td><td></td></tr></tbody></table><h4 id="2ã€é€šè¿‡å®ç°-Comparable-æˆ–è€…-Comparator-æ¥å£æ¥è¿›è¡Œæ’åº"><a href="#2ã€é€šè¿‡å®ç°-Comparable-æˆ–è€…-Comparator-æ¥å£æ¥è¿›è¡Œæ’åº" class="headerlink" title="2ã€é€šè¿‡å®ç° Comparable æˆ–è€… Comparator æ¥å£æ¥è¿›è¡Œæ’åº"></a>2ã€é€šè¿‡å®ç° Comparable æˆ–è€… Comparator æ¥å£æ¥è¿›è¡Œæ’åº</h4><p><strong>ä¸€ç§æƒ…å†µæ˜¯é›†åˆç±»æœ¬èº«è‡ªå¸¦æ’åºåŠŸèƒ½</strong>ï¼Œå¦‚å‰é¢è¯´è¿‡çš„TreeSetã€SortedSetã€SortedMapç­‰ï¼Œ</p><p>å¦ä¸€ç§å°±æ˜¯æœ¬èº«ä¸å¸¦æ’åºåŠŸèƒ½ï¼Œæˆ‘ä»¬é€šè¿‡ä¸ºéœ€è¦æ’åºçš„ç±»å®ç° Comparable æˆ–è€… Comparator æ¥å£æ¥å®ç°ã€‚</p><p>å…ˆæ¥çœ‹ä¸¤ä¸ªä¾‹å­ï¼Œä¸€ä¸ªæ˜¯å®ç°Comparableçš„ï¼Œä¸€ä¸ªæ˜¯å®ç° Comparator çš„</p><p>ï¼ˆ1ï¼‰å®ç°Comparableçš„ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xtfggef.list.test;<br> <br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.Arrays;<br><span class="hljs-keyword">import</span> java.util.Collections;<br><span class="hljs-keyword">import</span> java.util.List;<br> <br><span class="hljs-meta">@SuppressWarnings(&quot;unchecked&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ComparableTest</span> &#123;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;  <br>    List&lt;User&gt; users = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>();  <br>    users.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">&quot;egg&quot;</span>, <span class="hljs-number">23</span>));  <br>    users.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">&quot;niu&quot;</span>, <span class="hljs-number">22</span>));  <br>    users.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">&quot;qing&quot;</span>, <span class="hljs-number">28</span>));  <br>  <br>    Collections.sort(users);  <br>    <span class="hljs-keyword">for</span> (User user : users) &#123;  <br>        System.out.println(user.getName() + <span class="hljs-string">&quot; &quot;</span> + user.getAge());  <br>    &#125;  <br>&#125;<br>&#125;<br> <br><span class="hljs-meta">@SuppressWarnings(&quot;unchecked&quot;)</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Comparable</span> &#123;<br><span class="hljs-keyword">private</span> String name;<br><span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;<br> <br><span class="hljs-keyword">public</span> <span class="hljs-title function_">User</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> age)</span> &#123;<br><span class="hljs-built_in">super</span>();<br><span class="hljs-built_in">this</span>.name = name;<br><span class="hljs-built_in">this</span>.age = age;<br>&#125;<br> <br><span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">return</span> name;<br>&#125;<br> <br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> &#123;<br><span class="hljs-built_in">this</span>.name = name;<br>&#125;<br> <br><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAge</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-keyword">return</span> age;<br>&#125;<br> <br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAge</span><span class="hljs-params">(<span class="hljs-type">int</span> age)</span> &#123;<br><span class="hljs-built_in">this</span>.age = age;<br>&#125;<br> <br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compareTo</span><span class="hljs-params">(Object o)</span> &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.age - ((User) o).getAge();<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰ä¸‹é¢æ˜¯å®ç°Comparatoræ¥å£çš„ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.xtfggef.comparator.test;<br> <br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.Collections;<br><span class="hljs-keyword">import</span> java.util.Comparator;<br><span class="hljs-keyword">import</span> java.util.List;<br> <br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ComparatorTest</span> &#123;  <br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;  <br>        List&lt;User&gt; users = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>();  <br>        users.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">&quot;egg&quot;</span>, <span class="hljs-number">21</span>));  <br>        users.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">&quot;niu&quot;</span>, <span class="hljs-number">22</span>));  <br>        users.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">&quot;gg&quot;</span>, <span class="hljs-number">29</span>));  <br>        <span class="hljs-type">UserComparator</span> <span class="hljs-variable">comparator</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserComparator</span>();  <br>        Collections.sort(users, comparator);  <br>        <span class="hljs-keyword">for</span> (User user : users) &#123;  <br>            System.out.println(user.getUsername() + <span class="hljs-string">&quot; &quot;</span> + user.getAge());  <br>        &#125;  <br>    &#125;  <br>  <br>&#125;  <br><span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> &#123;  <br>    <span class="hljs-keyword">private</span> String username;  <br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;  <br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">User</span><span class="hljs-params">(String username, <span class="hljs-type">int</span> age)</span> &#123;  <br>        <span class="hljs-built_in">super</span>();  <br>        <span class="hljs-built_in">this</span>.username = username;  <br>        <span class="hljs-built_in">this</span>.age = age;  <br>    &#125;  <br>  <br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getUsername</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> username;  <br>    &#125;  <br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setUsername</span><span class="hljs-params">(String username)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.username = username;  <br>    &#125;  <br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAge</span><span class="hljs-params">()</span> &#123;  <br>        <span class="hljs-keyword">return</span> age;  <br>    &#125;  <br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAge</span><span class="hljs-params">(<span class="hljs-type">int</span> age)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.age = age;  <br>    &#125;  <br>&#125;  <br>  <br>  <br><span class="hljs-keyword">class</span> <span class="hljs-title class_">UserComparator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Comparator</span>&lt;User&gt; &#123;  <br>    <span class="hljs-meta">@Override</span>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compare</span><span class="hljs-params">(User user1, User user2)</span> &#123;  <br>        <span class="hljs-type">int</span> <span class="hljs-variable">age1</span> <span class="hljs-operator">=</span> user1.getAge();  <br>        <span class="hljs-type">int</span> <span class="hljs-variable">age2</span> <span class="hljs-operator">=</span> user2.getAge();  <br>        <span class="hljs-keyword">if</span> (age1 &lt; age2) &#123;  <br>            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;  <br>        &#125;  <br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;  <br>    &#125;  <br>&#125;<br></code></pre></td></tr></table></figure><p>ğŸ‘† ä¸Šé¢è¿™ç§ Comparator å®ç°è¿™ä¸ªæ¥å£çš„æ—¶å€™ï¼Œ ğŸ‘‰ Comparatoræ˜¯ä¸€ä¸ªæ³›å‹æ¥å£ï¼Œæ‰€ä»¥åœ¨å®ç°Comparatoræ¥å£æ—¶ï¼Œç±»çš„æ³›å‹ç±»å‹éœ€è¦æŒ‡å®šå…·ä½“ç±»å‹ï¼Œä»¥é¿å…ç±»å‹æ“¦é™¤å¸¦æ¥çš„é—®é¢˜ã€‚</p><hr><p>é€šè¿‡ä¸Šé¢çš„è¿™ä¸¤ä¸ªå°ä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼ŒComparatorå’ŒComparableç”¨äºä¸åŒçš„åœºæ™¯ï¼Œå®ç°å¯¹å¯¹è±¡çš„æ¯”è¾ƒä»è€Œè¿›è¡Œæ’åºã€‚</p><p>æ€»ç»“ä¸ºï¼š</p><p><strong>ç›¸åŒç‚¹ï¼š</strong> äºŒè€…éƒ½å¯ä»¥å®ç°å¯¹è±¡çš„æ’åºï¼Œä¸è®ºç”¨ Arraysçš„æ–¹æ³•è¿˜æ˜¯ç”¨ Collectionsçš„sort()æ–¹æ³•ã€‚</p><p><strong>ä¸åŒç‚¹ï¼š</strong></p><p>ï¼ˆ1ï¼‰å®ç°Comparableæ¥å£çš„ç±»ï¼Œä¼¼ä¹æ˜¯<strong>é¢„å…ˆçŸ¥é“è¯¥ç±»å°†è¦è¿›è¡Œæ’åº</strong>ï¼Œéœ€è¦æ’åºçš„ç±»å®ç°Comparableæ¥å£ï¼Œæ˜¯ä¸€ç§â€œé™æ€ç»‘å®šæ’åºâ€ã€‚</p><p>ï¼ˆ2ï¼‰å®ç°Comparatorçš„ç±»ä¸éœ€è¦ï¼Œè®¾è®¡è€…æ— éœ€äº‹å…ˆä¸ºéœ€è¦æ’åºçš„ç±»å®ç°ä»»ä½•æ¥å£ã€‚</p><p>ï¼ˆ3ï¼‰Comparatoræ¥å£é‡Œæœ‰ä¸¤ä¸ªæŠ½è±¡æ–¹æ³•compare()å’Œequals()ï¼Œ<strong>è€ŒComparableæ¥å£é‡Œåªæœ‰ä¸€ä¸ªæ–¹æ³•</strong>ï¼šcompareTo()ã€‚</p><p>ï¼ˆ4ï¼‰Comparatoræ¥å£æ— éœ€æ”¹å˜æ’åºç±»çš„å†…éƒ¨ï¼Œä¹Ÿå°±æ˜¯è¯´å®ç°ç®—æ³•å’Œæ•°æ®åˆ†ç¦»ï¼Œæ˜¯ä¸€ä¸ªè‰¯å¥½çš„è®¾è®¡ï¼Œæ˜¯ä¸€ç§â€œåŠ¨æ€ç»‘å®šæ’åºâ€ã€‚</p><p>ï¼ˆ5ï¼‰Comparatoræ¥å£å¯ä»¥ä½¿ç”¨å¤šç§æ’åºæ ‡å‡†ï¼Œæ¯”å¦‚å‡åºã€é™åºç­‰ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
      <category>é›†åˆ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ—¥è®°_20231114</title>
    <link href="/2023/11/14/%E6%97%A5%E8%AE%B0_%E8%BF%91%E6%9C%9F%E8%AE%A1%E5%88%9220231127/"/>
    <url>/2023/11/14/%E6%97%A5%E8%AE%B0_%E8%BF%91%E6%9C%9F%E8%AE%A1%E5%88%9220231127/</url>
    
    <content type="html"><![CDATA[<p>è¿‘æœŸè®¡åˆ’</p><ul><li><input checked="" disabled="" type="checkbox"> Javaé›†åˆã€Javaå¤šçº¿ç¨‹ã€MySQLæ•°æ®åº“ã€Spring è¿›è¡Œå¤ä¹ </li><li><input checked="" disabled="" type="checkbox"> Redisã€MQ </li><li><input checked="" disabled="" type="checkbox"> å¾®æœåŠ¡ SpringCloud Alibaba å­¦ä¹ </li><li><input checked="" disabled="" type="checkbox"> <del>å­¦æˆåœ¨çº¿é¡¹ç›®è¿›è¡Œï¼ˆæ”¾å¼ƒï¼‰</del></li><li><input disabled="" type="checkbox"> é¡¹ç›®ï¼šè˜‘è‡åšå®¢çš„å­¦ä¹ ï¼ˆä¸ªäººä¸€ç›´è¶‹å‘å­¦ä¹ è¿™ä¸ªé¡¹ç›®ï¼Œè¶è¿™æ®µæ—¶é—´æœ‰ç©ºï¼Œå­¦ä¹ ä¸€ä¸‹ï¼‰</li><li><input disabled="" type="checkbox"> è€ƒç ”æ•°å­¦</li></ul><hr>]]></content>
    
    
    <categories>
      
      <category>Diary</category>
      
    </categories>
    
    
    <tags>
      
      <tag>blog</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Java é›†åˆ_åŸºç¡€æ¦‚å¿µ</title>
    <link href="/2023/11/14/Java%E9%9B%86%E5%90%88_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/"/>
    <url>/2023/11/14/Java%E9%9B%86%E5%90%88_%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/</url>
    
    <content type="html"><![CDATA[<h4 id="1ã€æˆå‘˜å…³ç³»"><a href="#1ã€æˆå‘˜å…³ç³»" class="headerlink" title="1ã€æˆå‘˜å…³ç³»"></a>1ã€æˆå‘˜å…³ç³»</h4><p>Java é›†åˆç›¸å…³çš„æˆå‘˜å…³ç³»å›¾<br><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311141122413.png" alt="image.png"></p><ul><li>Collection<ul><li>Set<ul><li>HashSet<ul><li>LinkedHashSet</li></ul></li><li>SortedSet<ul><li>TreeSet</li></ul></li></ul></li><li>List<ul><li>ArrayList</li><li>Vector<ul><li>Stack</li></ul></li><li>LinkedList</li></ul></li><li>Queue<ul><li>Deque<ul><li>ArrayDeque</li></ul></li><li>PriorityQueue</li></ul></li></ul></li><li>Map<ul><li>HashMap<ul><li>LinkedHashMap</li></ul></li><li>Hashtable</li><li>SortedMap<ul><li>TreeMap</li></ul></li></ul></li></ul><p>é€šè¿‡ä¸‹é¢è¡¨æ ¼å¯è¯´æ˜ä¹‹é—´éƒ¨åˆ†çš„åŒºåˆ«å’Œè”ç³»</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311141123120.png" alt="image.png"><br><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311141123036.png" alt="image.png"></p><h4 id="2ã€åŸºç¡€æ¦‚å¿µ"><a href="#2ã€åŸºç¡€æ¦‚å¿µ" class="headerlink" title="2ã€åŸºç¡€æ¦‚å¿µ"></a>2ã€åŸºç¡€æ¦‚å¿µ</h4><h5 id="Collection"><a href="#Collection" class="headerlink" title="Collection"></a>Collection</h5><p>Collectionæ¥å£ï¼šæœ€åŸºæœ¬çš„é›†åˆæ¥å£ï¼Œæ‰€ä»£è¡¨çš„æ˜¯ä¸€ç§è§„åˆ™ï¼Œå®ƒæ‰€åŒ…å«çš„å…ƒç´ éƒ½å¿…é¡»éµå¾ªä¸€æ¡æˆ–è€…å¤šæ¡è§„åˆ™ã€‚å¦‚æœ‰äº›å…è®¸é‡å¤è€Œæœ‰äº›åˆ™ä¸èƒ½é‡å¤ã€æœ‰äº›å¿…é¡»è¦æŒ‰ç…§é¡ºåºæ’å…¥è€Œæœ‰äº›åˆ™æ˜¯æ•£åˆ—ï¼Œæœ‰äº›æ”¯æŒæ’åºä½†æ˜¯æœ‰äº›åˆ™ä¸æ”¯æŒã€‚</p><p>åœ¨Javaä¸­æ‰€æœ‰å®ç°äº†Collectionæ¥å£çš„ç±»éƒ½å¿…é¡»æä¾›ä¸¤å¥—æ ‡å‡†çš„æ„é€ å‡½æ•°ï¼Œä¸€ä¸ªæ˜¯æ— å‚ï¼Œç”¨äºåˆ›å»ºä¸€ä¸ªç©ºçš„Collectionï¼Œä¸€ä¸ªæ˜¯å¸¦æœ‰Collectionå‚æ•°çš„æœ‰å‚æ„é€ å‡½æ•°ï¼Œç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„Collectionï¼Œè¿™ä¸ªæ–°çš„Collectionä¸ä¼ å…¥è¿›æ¥çš„Collectionå…·å¤‡ç›¸åŒçš„å…ƒç´ ã€‚</p><h5 id="List"><a href="#List" class="headerlink" title="List"></a>List</h5><p>Listæ¥å£ï¼šæœ‰åºçš„Collectionï¼Œç”¨æŸç§ç‰¹å®šçš„æ’å…¥é¡ºåºæ¥ç»´æŠ¤å…ƒç´ é¡ºåºï¼›ç”¨æˆ·å¯ä»¥å¯¹åˆ—è¡¨ä¸­æ¯ä¸ªå…ƒç´ çš„æ’å…¥ä½ç½®è¿›è¡Œç²¾ç¡®åœ°æ§åˆ¶ï¼ŒåŒæ—¶å¯ä»¥æ ¹æ®å…ƒç´ çš„æ•´æ•°ç´¢å¼•ï¼ˆåœ¨åˆ—è¡¨ä¸­çš„ä½ç½®ï¼‰è®¿é—®å…ƒç´ ï¼Œå¹¶æœç´¢åˆ—è¡¨ä¸­çš„å…ƒç´ ã€‚</p><p>å®ç°Listæ¥å£çš„é›†åˆä¸»è¦æœ‰ï¼šArrayListã€LinkedListã€Vectorã€Stackã€‚</p><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311141634443.png" alt="image.png"></p><h5 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h5><p>Mapæ¥å£ï¼šç”±ä¸€ç³»åˆ—é”®å€¼å¯¹ç»„æˆçš„é›†åˆï¼Œæä¾›äº†keyåˆ°Valueçš„æ˜ å°„ã€‚åŒæ—¶å®ƒæ²¡æœ‰ç»§æ‰¿Collectionï¼›å®ƒä¿è¯äº†keyä¸valueä¹‹é—´çš„ä¸€ä¸€å¯¹åº”å…³ç³»ï¼Œä¸€ä¸ªkeyå¯¹åº”ä¸€ä¸ªvalueï¼Œå®ƒä¸èƒ½å­˜åœ¨ç›¸åŒçš„keyå€¼ï¼Œvalueå€¼å¯ä»¥ç›¸åŒã€‚</p><p>å®ç°mapçš„æœ‰ï¼šHashMapã€TreeMapã€HashTableã€Propertiesã€EnumMapã€‚</p><ul><li>HashMapï¼ˆJDK1.8åŠä»¥ä¸Šï¼‰<ul><li>åŸºäºå“ˆå¸Œè¡¨çš„Mapæ¥å£çš„éåŒæ­¥å®ç°</li><li>å…è®¸ä½¿ç”¨ null å€¼å’Œ null é”®</li><li>æ•°æ®ç»“æ„å¯ä»¥çœ‹æˆæ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘</li><li>é‡‡ç”¨äº†Fail-  Fastæœºåˆ¶</li></ul></li><li>Hashtable<ul><li>åŸºäºå“ˆå¸Œè¡¨çš„Mapæ¥å£çš„åŒæ­¥å®ç°, ä½¿ç”¨synchronizedå®ç°çº¿ç¨‹å®‰å…¨</li><li>ä¸å…è®¸ä½¿ç”¨nullå€¼å’Œnullé”®</li><li>åº•å±‚ä½¿ç”¨æ•°ç»„å®ç°ï¼Œæ•°ç»„ä¸­æ¯ä¸€é¡¹æ˜¯ä¸ªå•é“¾è¡¨ï¼Œå³æ•°ç»„å’Œé“¾è¡¨çš„ç»“åˆä½“</li></ul></li><li>ConcurrentHashMapï¼ˆJDK1.7ç‰ˆæœ¬ï¼‰<ul><li>é‡‡ç”¨æ•°ç»„+åˆ†æ®µé”çš„æ–¹å¼å®ç°</li><li>æ•°æ®ç»“æ„ï¼šSegment æ•°ç»„ + HashEntry æ•°ç»„ + é“¾è¡¨</li></ul></li><li>ConcurrentHashMapï¼ˆJDK1.8ç‰ˆæœ¬ï¼‰<ul><li>æ•°æ®ç»“æ„ï¼šNode æ•°ç»„ + é“¾è¡¨ &#x2F; çº¢é»‘æ ‘ã€‚</li><li>å½“å†²çªé“¾è¡¨è¾¾åˆ°ä¸€å®šé•¿åº¦æ—¶ï¼Œé“¾è¡¨ä¼šè½¬æ¢æˆçº¢é»‘æ ‘ã€‚</li></ul></li><li>TreeMap<ul><li>å®ç°äº†SortedMapæ¥å£ï¼Œé”®ä»¥æŸç§æ’åºè§„åˆ™æ’åº</li><li>å†…éƒ¨ä»¥red-blackï¼ˆçº¢-é»‘ï¼‰æ ‘æ•°æ®ç»“æ„å®ç°</li></ul></li><li>LinkedHashMap<ul><li>ç»§æ‰¿äºHashMap</li><li>éåŒæ­¥ï¼Œå…è®¸ä½¿ç”¨nullå€¼å’Œnullé”®</li><li>åº•å±‚ä½¿ç”¨å“ˆå¸Œè¡¨å’ŒåŒå‘é“¾è¡¨æ¥ä¿å­˜æ‰€æœ‰å…ƒç´ </li></ul></li><li>WeakHashMap<ul><li>æ”¯æŒnullå€¼å’Œnullé”®ï¼Œfast-failæœºåˆ¶ï¼Œä¸å…è®¸é‡å¤</li><li>keyåªä¿ç•™å¯¹å®é™…å¯¹è±¡çš„å¼±å¼•ç”¨ï¼Œå½“keyæ‰€å¼•ç”¨çš„å¯¹è±¡æ²¡æœ‰è¢«å…¶ä»–å¼ºå¼•ç”¨å˜é‡æ‰€å¼•ç”¨ï¼Œåˆ™è¿™äº›keyæ‰€å¼•ç”¨çš„å¯¹è±¡å¯èƒ½è¢«åƒåœ¾å›æ”¶ï¼ŒWeakHashMapä¹Ÿå¯èƒ½è‡ªåŠ¨åˆ é™¤è¿™äº›keyæ‰€å¯¹åº”çš„key-valueå¯¹ã€‚</li></ul></li><li>IdentifyHashMap<ul><li>åœ¨IdentityHashMapä¸­ï¼Œå½“ä¸”ä»…å½“ä¸¤ä¸ªkeyä¸¥æ ¼ç›¸ç­‰ï¼ˆkey1&#x3D;&#x3D; key2ï¼‰æ—¶ï¼ŒIdentityHashMapæ‰è®¤ä¸ºä¸¤ä¸ªkeyç›¸ç­‰ï¼›ç›¸å¯¹äºæ™®é€šHashMapè€Œè¨€ï¼Œåªè¦key1å’Œkey2é€šè¿‡equals()æ–¹æ³•è¿”å›trueï¼Œä¸”å®ƒä»¬çš„hashCodeå€¼ç›¸ç­‰å³å¯ã€‚</li></ul></li><li>EnumMap<ul><li>EnumMapæ˜¯ä¸€ä¸ªä¸æšä¸¾ç±»ä¸€èµ·ä½¿ç”¨çš„Mapå®ç°ï¼ŒEnumMapä¸­çš„æ‰€æœ‰keyéƒ½å¿…é¡»æ˜¯å•ä¸ªæšä¸¾ç±»çš„æšä¸¾å€¼ã€‚åˆ›å»ºEnumMapæ—¶å¿…é¡»æ˜¾ç¤ºæˆ–éšå¼çš„æŒ‡å®šå®ƒå¯¹åº”çš„æšä¸¾ç±»ã€‚</li></ul></li></ul><h5 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h5><p>Set æ¥å£ï¼šä¸åŒ…æ‹¬é‡å¤å…ƒç´ çš„Collectionï¼ŒåŒæ ·å…è®¸ nullçš„å­˜åœ¨ä½†æ˜¯ä»…æœ‰ä¸€ä¸ª</p><p>å®ç°äº†Setæ¥å£çš„é›†åˆæœ‰ï¼šEnumSetã€HashSetã€TreeSetã€‚</p><ul><li>HashSet<ul><li>åŸºäºHashMapå®ç°ï¼ŒAPI å¯¹ HashMapçš„è¡Œä¸ºè¿›è¡Œäº†å°è£…</li><li>å…è®¸ä½¿ç”¨nullå…ƒç´ </li></ul></li><li>LinkedHashSet<ul><li>ç»§æ‰¿äº HashSetã€åˆåŸºäºLinkedHashMapæ¥å®ç°</li><li>åº•å±‚ä½¿ç”¨LinkedHashMapæ¥ä¿å­˜æ‰€æœ‰å…ƒç´ ï¼Œå®ƒç»§æ‰¿äºHashSetï¼Œå…¶æ‰€æœ‰çš„æ–¹æ³•æ“ä½œä¸Šä¸HashSetç›¸åŒ</li></ul></li><li>TreeSet<ul><li>åŸºäºTreeMapï¼Œç”Ÿæˆä¸€ä¸ªæ€»æ˜¯å¤„äºæ’åºçŠ¶æ€çš„setï¼Œå†…éƒ¨ä»¥TreeMapæ¥å®ç°ã€‚</li><li>ä½¿ç”¨å…ƒç´ çš„è‡ªç„¶é¡ºåºå¯¹å…ƒç´ è¿›è¡Œæ’åºï¼Œæˆ–è€…æ ¹æ®åˆ›å»ºSet æ—¶æä¾›çš„  <code>Comparator</code> è¿›è¡Œæ’åº</li></ul></li><li>EnumSet<ul><li>æšä¸¾çš„ä¸“ç”¨Setã€‚æ‰€æœ‰çš„å…ƒç´ éƒ½æ˜¯æšä¸¾ç±»å‹</li></ul></li></ul><h5 id="Queue"><a href="#Queue" class="headerlink" title="Queue"></a>Queue</h5><p>é˜Ÿåˆ—ï¼Œä¸»è¦åˆ†ä¸ºä¸¤å¤§ç±»ï¼Œ</p><p>ä¸€ç±»æ˜¯é˜»å¡å¼é˜Ÿåˆ—ï¼Œé˜Ÿåˆ—æ»¡äº†ä»¥åå†æ’å…¥å…ƒç´ åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œä¸»è¦åŒ…æ‹¬ArrayBlockQueueã€PriorityBlockingQueueã€LinkedBlockingQueueã€‚</p><p>å¦ä¸€ç§é˜Ÿåˆ—åˆ™æ˜¯åŒç«¯é˜Ÿåˆ—ï¼Œæ”¯æŒåœ¨å¤´ã€å°¾ä¸¤ç«¯æ’å…¥å’Œç§»é™¤å…ƒç´ ï¼Œä¸»è¦åŒ…æ‹¬ï¼šArrayDequeã€LinkedBlockingDequeã€LinkedListã€‚</p><hr><p>å‚è€ƒ</p><ul><li><a href="https://javaguide.cn/java/collection/java-collection-questions-01.html">https://javaguide.cn/java/collection/java-collection-questions-01.html</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>JavaåŸºç¡€</category>
      
      <category>é›†åˆ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>é›†åˆ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Git é…ç½® SSH è¿æ¥</title>
    <link href="/2023/11/13/Git%20%E9%85%8D%E7%BD%AE%20SSH%20%E8%BF%9E%E6%8E%A5/"/>
    <url>/2023/11/13/Git%20%E9%85%8D%E7%BD%AE%20SSH%20%E8%BF%9E%E6%8E%A5/</url>
    
    <content type="html"><![CDATA[<h3 id="é…ç½®-SSH-è¿æ¥"><a href="#é…ç½®-SSH-è¿æ¥" class="headerlink" title="é…ç½® SSH è¿æ¥"></a>é…ç½® SSH è¿æ¥</h3><p>å›åˆ°Git Bashä¸­ï¼Œé…ç½®Githubè´¦æˆ·ä¿¡æ¯ï¼ˆ<code>ç”¨æˆ·å</code>â€‹å’Œ<code>é‚®ç®±</code>â€‹éƒ½æ›¿æ¢æˆä½ è‡ªå·±Githubä¸Šçš„ï¼‰ï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs text">git config --global user.name &quot;`ç”¨æˆ·å`&quot;<br>git config --global user.email &quot;é‚®ç®±&quot;<br></code></pre></td></tr></table></figure><p>åœ¨Git Bashä¸­è¾“å…¥ï¼š<code>ssh-keygen -t rsa -C &quot;ä½ çš„Githubé‚®ç®±&quot;</code>â€‹ ç”Ÿæˆssh</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">ssh-keygen -t rsa -C &quot;é‚®ç®±&quot;<br></code></pre></td></tr></table></figure><p>ç„¶åæŒ‰Git Bashç»™å‡ºçš„è·¯å¾„<code>(C:\Users\Lete.ssh)</code>â€‹æ‰¾åˆ°<code>id_rsa.pub</code>â€‹æ–‡ä»¶ å¹¶å¤åˆ¶å…¶ä¸­çš„å†…å®¹</p><p>è¿›åˆ°æ–°å»ºçš„Githubä»“åº“ ç‚¹å‡»å³ä¸Šè§’<code>setting</code>â€‹è¿›å…¥è®¾ç½®æ‰¾åˆ°<code>Deploykeys</code>â€‹é€‰æ‹© <code>Add Deploy keys</code>â€‹ <code>Title</code>â€‹éšä¾¿å¡«å†™ <code>Key</code>â€‹çš„å†…å®¹å¡«åˆšæ‰<code>id_rsa.pub</code>â€‹æ–‡ä»¶ä¸­å¤åˆ¶çš„å†…å®¹</p><p>â€<br>ä¿®æ”¹æœ¬åœ°Gité…ç½®ï¼Œè®¾ç½®ä½¿ç”¨SSHåè®®è¿æ¥GitHubã€‚ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä¿®æ”¹æœ¬åœ°Gité…ç½®ï¼š</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scss">git config <span class="hljs-attr">--global</span> url.&quot;git<span class="hljs-keyword">@github</span>.<span class="hljs-attribute">com</span>:<span class="hljs-string">&quot;.insteadOf &quot;</span><span class="hljs-attribute">https</span>://github.com/<span class="hljs-string">&quot;</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸ªå‘½ä»¤ä¼šå°†Gité…ç½®ä¸­çš„ <code>https://github.com/</code>â€‹ æ›¿æ¢ä¸º <code>git@github.com:</code>â€‹ï¼Œä»è€Œä½¿ç”¨SSHåè®®è¿æ¥GitHubã€‚</p><p>é…ç½®åå†éƒ¨ç½²æäº¤</p><h3 id="å¸¸ç”¨çš„ä¸€äº›å‘½ä»¤"><a href="#å¸¸ç”¨çš„ä¸€äº›å‘½ä»¤" class="headerlink" title="å¸¸ç”¨çš„ä¸€äº›å‘½ä»¤"></a>å¸¸ç”¨çš„ä¸€äº›å‘½ä»¤</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">æŸ¥çœ‹ç”¨æˆ·åÂ ï¼šgit config <span class="hljs-keyword">user</span>.name<br><br>æŸ¥çœ‹å¯†ç ï¼šÂ git config <span class="hljs-keyword">user</span>.<span class="hljs-keyword">password</span><br><br>æŸ¥çœ‹é‚®ç®±ï¼šgit config <span class="hljs-keyword">user</span>.email<br><br>æŸ¥çœ‹é…ç½®ä¿¡æ¯ï¼š $ git config <span class="hljs-comment">--list</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>éƒ¨ç½²</category>
      
    </categories>
    
    
    <tags>
      
      <tag>git</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Gitå…¥é—¨_åŸºæœ¬æ“ä½œ</title>
    <link href="/2023/11/13/Git%E5%85%A5%E9%97%A8_%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/"/>
    <url>/2023/11/13/Git%E5%85%A5%E9%97%A8_%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/</url>
    
    <content type="html"><![CDATA[<h3 id="1ã€å°†æŸä¸ªç›®å½•æ–‡ä»¶ä¸Šä¼ åˆ°-Github-æŸä¸ªä»“åº“"><a href="#1ã€å°†æŸä¸ªç›®å½•æ–‡ä»¶ä¸Šä¼ åˆ°-Github-æŸä¸ªä»“åº“" class="headerlink" title="1ã€å°†æŸä¸ªç›®å½•æ–‡ä»¶ä¸Šä¼ åˆ° Github æŸä¸ªä»“åº“"></a>1ã€å°†æŸä¸ªç›®å½•æ–‡ä»¶ä¸Šä¼ åˆ° Github æŸä¸ªä»“åº“</h3><p>è¦å°†æŸä¸ªç›®å½•æ–‡ä»¶ä¸Šä¼ åˆ°GithubæŸä¸ªä»“åº“ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œæ“ä½œï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs undefined"># åˆå§‹åŒ–ä»“åº“<br>git init<br># æäº¤åˆ°æœ¬åœ°gitä»“åº“ å°†æ–‡ä»¶å¤¹ä¸­çš„å†…å®¹æ·»åŠ åˆ°gitä»“åº“<br>git add .<br># æäº¤åˆ°æœ¬åœ°gitä»“åº“,å¹¶æ·»åŠ ä¸€æ¡æäº¤ä¿¡æ¯<br>git commit -m &quot;Initial commit&quot;<br>#åœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå°†æœ¬åœ°gitä»“åº“ä¸Githubä¸Šçš„ä»“åº“è¿›è¡Œå…³è”<br>git remote add origin &lt;Githubä»“åº“URL&gt;<br># è¿›è¡Œæ¨é€<br>git push -u origin master<br># å¦‚æœç›®æ ‡ä»“åº“å’Œæœ¬åœ°ç›®å½•æ–‡ä»¶å†²çªï¼Œå¯ä»¥å…ˆæ‹‰å»æœ€æ–°ä»“åº“ä»£ç å†è¿›è¡Œæ¨é€<br>git pull origin master<br># æˆ–è€…ç›´æ¥å¼ºåˆ¶æ¨é€ï¼ˆä¼šç›´æ¥è¦†ç›–è¿œç¨‹ä»“åº“å†…å®¹ï¼‰ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¼ºåˆ¶æ¨é€å¯èƒ½ä¼šè¦†ç›–å…¶ä»–äººæäº¤çš„ä»£ç ï¼Œå› æ­¤éœ€è¦è°¨æ…ä½¿ç”¨ã€‚<br>git push --force origin master<br></code></pre></td></tr></table></figure><p>â€</p><blockquote><p>Gitçš„å·¥ä½œæµç¨‹æ ¸å¿ƒ</p></blockquote><ul><li>0ã€<strong>å‡†å¤‡ä»“åº“</strong>ï¼šåˆ›å»ºæˆ–ä»æœåŠ¡ç«¯å…‹éš†ä¸€ä¸ªä»“åº“ã€‚</li><li>1ã€<strong>æ¬ç –</strong>ï¼šåœ¨å·¥ä½œç›®å½•ä¸­æ·»åŠ ã€ä¿®æ”¹ä»£ç ã€‚</li><li>2ã€<strong>æš‚å­˜</strong>ï¼ˆgit addï¼‰ï¼šå°†éœ€è¦è¿›è¡Œç‰ˆæœ¬ç®¡ç†çš„æ–‡ä»¶æ”¾å…¥æš‚å­˜åŒºåŸŸã€‚</li><li>3ã€<strong>æäº¤</strong>ï¼ˆgit commitï¼‰ï¼šå°†æš‚å­˜åŒºåŸŸçš„æ–‡ä»¶æäº¤åˆ°Gitä»“åº“ã€‚</li><li>4ã€<strong>æ¨é€</strong>ï¼ˆgit pushï¼‰ï¼šå°†æœ¬åœ°ä»“åº“æ¨é€åˆ°è¿œç¨‹ä»“åº“ï¼ŒåŒæ­¥ç‰ˆæœ¬åº“ã€‚</li><li>5ã€<strong>è·å–æ›´æ–°</strong>ï¼ˆfetch&#x2F;pullï¼‰ï¼šä»æœåŠ¡ç«¯æ›´æ–°åˆ°æœ¬åœ°ï¼Œè·å–ä»–äººæ¨é€çš„æ›´æ–°ï¼Œä¸ä»–äººåä½œã€å…±äº«ã€‚</li></ul><p><img src="https://obsidian-picture.oss-cn-shenzhen.aliyuncs.com/luoblog/202311250040140.png" alt="image.png"></p><ul><li><code>git commit -a</code>æŒ‡ä»¤çœç•¥äº†<code>add</code>åˆ°æš‚å­˜åŒºçš„æ­¥éª¤ï¼Œç›´æ¥æäº¤å·¥ä½œåŒºçš„ä¿®æ”¹å†…å®¹åˆ°ç‰ˆæœ¬åº“ï¼Œä¸åŒ…æ‹¬æ–°å¢çš„æ–‡ä»¶ã€‚</li><li><code>git fetch</code>ã€<code>git pull</code>Â éƒ½æ˜¯ä»è¿œç¨‹æœåŠ¡ç«¯è·å–æœ€æ–°è®°å½•ï¼ŒåŒºåˆ«æ˜¯<code>git pull</code>å¤šäº†ä¸€ä¸ªæ­¥éª¤ï¼Œå°±æ˜¯è‡ªåŠ¨åˆå¹¶æ›´æ–°å·¥ä½œåŒºã€‚</li><li><code>git checkout .</code>ã€<code>git checkout [file]</code>Â ä¼šæ¸…é™¤å·¥ä½œåŒºä¸­æœªæ·»åŠ åˆ°æš‚å­˜åŒºçš„ä¿®æ”¹ï¼Œç”¨æš‚å­˜åŒºå†…å®¹æ›¿æ¢å·¥ä½œåŒºã€‚</li><li><code>git checkout HEAD .</code>ã€Â <code>git checkout HEAD [file]</code>Â ä¼šæ¸…é™¤å·¥ä½œåŒºã€æš‚å­˜åŒºçš„ä¿®æ”¹ï¼Œç”¨HEADæŒ‡å‘çš„å½“å‰åˆ†æ”¯æœ€æ–°ç‰ˆæœ¬æ›¿æ¢æš‚å­˜åŒºã€å·¥ä½œåŒºã€‚</li><li><code>git diff</code>Â ç”¨æ¥å¯¹æ¯”ä¸åŒéƒ¨åˆ†ä¹‹é—´çš„åŒºåˆ«ï¼Œå¦‚æš‚å­˜åŒºã€å·¥ä½œåŒºï¼Œæœ€æ–°ç‰ˆæœ¬ä¸æœªæäº¤å†…å®¹ï¼Œä¸åŒç‰ˆæœ¬ä¹‹é—´ç­‰ã€‚</li><li><code>git reset</code>æ˜¯ä¸“é—¨ç”¨æ¥æ’¤é”€ä¿®æ”¹ã€å›é€€ç‰ˆæœ¬çš„æŒ‡ä»¤ï¼Œæ›¿ä»£ä¸Šé¢<code>checkout</code>çš„æ’¤é”€åŠŸèƒ½ã€‚</li></ul><hr><p>å‚è€ƒ</p><ul><li><a href="https://www.cnblogs.com/anding/p/16987769.html">https://www.cnblogs.com/anding/p/16987769.html</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>éƒ¨ç½²</category>
      
    </categories>
    
    
    <tags>
      
      <tag>git</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
